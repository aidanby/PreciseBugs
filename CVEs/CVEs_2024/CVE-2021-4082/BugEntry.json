{"buggy_code": ["<?php\n\n/**\n * Pimcore\n *\n * This source file is available under two different licenses:\n * - GNU General Public License version 3 (GPLv3)\n * - Pimcore Commercial License (PCL)\n * Full copyright and license information is available in\n * LICENSE.md which is distributed with this source code.\n *\n *  @copyright  Copyright (c) Pimcore GmbH (http://www.pimcore.org)\n *  @license    http://www.pimcore.org/license     GPLv3 and PCL\n */\n\nnamespace Pimcore\\Bundle\\AdminBundle\\Controller\\Admin;\n\nuse Pimcore\\Bundle\\AdminBundle\\Controller\\AdminController;\nuse Pimcore\\Bundle\\AdminBundle\\Controller\\BruteforceProtectedControllerInterface;\nuse Pimcore\\Bundle\\AdminBundle\\Security\\BruteforceProtectionHandler;\nuse Pimcore\\Bundle\\AdminBundle\\Security\\CsrfProtectionHandler;\nuse Pimcore\\Config;\nuse Pimcore\\Controller\\KernelControllerEventInterface;\nuse Pimcore\\Controller\\KernelResponseEventInterface;\nuse Pimcore\\Event\\Admin\\Login\\LoginRedirectEvent;\nuse Pimcore\\Event\\Admin\\Login\\LostPasswordEvent;\nuse Pimcore\\Event\\AdminEvents;\nuse Pimcore\\Extension\\Bundle\\PimcoreBundleManager;\nuse Pimcore\\Http\\ResponseHelper;\nuse Pimcore\\Logger;\nuse Pimcore\\Model\\User;\nuse Pimcore\\Tool;\nuse Pimcore\\Tool\\Authentication;\nuse Symfony\\Component\\HttpFoundation\\RedirectResponse;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\HttpKernel\\Event\\ControllerEvent;\nuse Symfony\\Component\\HttpKernel\\Event\\ResponseEvent;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse Symfony\\Component\\Routing\\Generator\\UrlGeneratorInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\AuthenticationException;\nuse Symfony\\Component\\Security\\Core\\Security;\nuse Symfony\\Component\\Security\\Core\\User\\UserInterface;\nuse Symfony\\Contracts\\EventDispatcher\\EventDispatcherInterface;\n\n/**\n * @internal\n */\nclass LoginController extends AdminController implements BruteforceProtectedControllerInterface, KernelControllerEventInterface, KernelResponseEventInterface\n{\n    /**\n     * @var ResponseHelper\n     */\n    protected $reponseHelper;\n\n    public function __construct(ResponseHelper $responseHelper)\n    {\n        $this->reponseHelper = $responseHelper;\n    }\n\n    /**\n     * @param ControllerEvent $event\n     */\n    public function onKernelControllerEvent(ControllerEvent $event)\n    {\n        // use browser language for login page if possible\n        $locale = 'en';\n\n        $availableLocales = Tool\\Admin::getLanguages();\n        foreach ($event->getRequest()->getLanguages() as $userLocale) {\n            if (in_array($userLocale, $availableLocales)) {\n                $locale = $userLocale;\n\n                break;\n            }\n        }\n\n        $this->get('translator')->setLocale($locale);\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    public function onKernelResponseEvent(ResponseEvent $event)\n    {\n        $response = $event->getResponse();\n        $response->headers->set('X-Frame-Options', 'deny', true);\n        $this->reponseHelper->disableCache($response, true);\n    }\n\n    /**\n     * @Route(\"/login\", name=\"pimcore_admin_login\")\n     * @Route(\"/login/\", name=\"pimcore_admin_login_fallback\")\n     */\n    public function loginAction(Request $request, CsrfProtectionHandler $csrfProtection, Config $config)\n    {\n        if ($request->get('_route') === 'pimcore_admin_login_fallback') {\n            return $this->redirectToRoute('pimcore_admin_login', $request->query->all(), Response::HTTP_MOVED_PERMANENTLY);\n        }\n\n        $csrfProtection->regenerateCsrfToken();\n\n        $user = $this->getAdminUser();\n        if ($user instanceof UserInterface) {\n            return $this->redirectToRoute('pimcore_admin_index');\n        }\n\n        $params = $this->buildLoginPageViewParams($config);\n\n        $session_gc_maxlifetime = ini_get('session.gc_maxlifetime');\n        if (empty($session_gc_maxlifetime)) {\n            $session_gc_maxlifetime = 120;\n        }\n\n        $params['csrfTokenRefreshInterval'] = ((int)$session_gc_maxlifetime - 60) * 1000;\n\n        if ($request->get('auth_failed')) {\n            $params['error'] = 'error_auth_failed';\n        }\n        if ($request->get('session_expired')) {\n            $params['error'] = 'error_session_expired';\n        }\n        if ($request->get('deeplink')) {\n            $params['deeplink'] = true;\n        }\n\n        $params['browserSupported'] = $this->detectBrowser();\n        $params['debug'] = \\Pimcore::inDebugMode();\n\n        return $this->render('@PimcoreAdmin/Admin/Login/login.html.twig', $params);\n    }\n\n    /**\n     * @Route(\"/login/csrf-token\", name=\"pimcore_admin_login_csrf_token\")\n     */\n    public function csrfTokenAction(Request $request, CsrfProtectionHandler $csrfProtection)\n    {\n        if (!$this->getAdminUser()) {\n            $csrfProtection->regenerateCsrfToken();\n        }\n\n        return $this->json([\n           'csrfToken' => $csrfProtection->getCsrfToken(),\n        ]);\n    }\n\n    /**\n     * @Route(\"/logout\", name=\"pimcore_admin_logout\")\n     */\n    public function logoutAction()\n    {\n        // this route will never be matched, but will be handled by the logout handler\n    }\n\n    /**\n     * Dummy route used to check authentication\n     *\n     * @Route(\"/login/login\", name=\"pimcore_admin_login_check\")\n     *\n     * @see AdminAuthenticator for the security implementation\n     */\n    public function loginCheckAction()\n    {\n        // just in case the authenticator didn't redirect\n        return new RedirectResponse($this->generateUrl('pimcore_admin_login'));\n    }\n\n    /**\n     * @Route(\"/login/lostpassword\", name=\"pimcore_admin_login_lostpassword\")\n     */\n    public function lostpasswordAction(Request $request, BruteforceProtectionHandler $bruteforceProtectionHandler, CsrfProtectionHandler $csrfProtection, Config $config, EventDispatcherInterface $eventDispatcher)\n    {\n        $params = $this->buildLoginPageViewParams($config);\n        $error = null;\n\n        if ($request->getMethod() === 'POST' && $username = $request->get('username')) {\n            $user = User::getByName($username);\n\n            if ($user instanceof User) {\n                if (!$user->isActive()) {\n                    $error = 'user_inactive';\n                }\n\n                if (!$user->getEmail()) {\n                    $error = 'user_no_email_address';\n                }\n\n                if (!$user->getPassword()) {\n                    $error = 'user_no_password';\n                }\n            } else {\n                $error = 'user_unknown';\n            }\n\n            if (!$error && $user instanceof User) {\n                $token = Authentication::generateToken($user->getName());\n\n                $loginUrl = $this->generateUrl('pimcore_admin_login_check', [\n                    'token' => $token,\n                    'reset' => 'true',\n                ], UrlGeneratorInterface::ABSOLUTE_URL);\n\n                try {\n                    $event = new LostPasswordEvent($user, $loginUrl);\n                    $eventDispatcher->dispatch($event, AdminEvents::LOGIN_LOSTPASSWORD);\n\n                    // only send mail if it wasn't prevented in event\n                    if ($event->getSendMail()) {\n                        $mail = Tool::getMail([$user->getEmail()], 'Pimcore lost password service');\n                        $mail->setIgnoreDebugMode(true);\n                        $mail->text(\"Login to pimcore and change your password using the following link. This temporary login link will expire in 24 hours: \\r\\n\\r\\n\" . $loginUrl);\n                        $mail->send();\n                    }\n\n                    // directly return event response\n                    if ($event->hasResponse()) {\n                        return $event->getResponse();\n                    }\n                } catch (\\Exception $e) {\n                    Logger::error('Error sending password recovery email: ' . $e->getMessage());\n                    $error = 'lost_password_email_error';\n                }\n            }\n\n            if ($error) {\n                Logger::error('Lost password service: ' . $error);\n                $bruteforceProtectionHandler->addEntry($request->get('username'), $request);\n            }\n        }\n\n        $csrfProtection->regenerateCsrfToken();\n\n        return $this->render('@PimcoreAdmin/Admin/Login/lostpassword.html.twig', $params);\n    }\n\n    /**\n     * @Route(\"/login/deeplink\", name=\"pimcore_admin_login_deeplink\")\n     */\n    public function deeplinkAction(Request $request, EventDispatcherInterface $eventDispatcher)\n    {\n        // check for deeplink\n        $queryString = $_SERVER['QUERY_STRING'];\n\n        if (preg_match('/(document|asset|object)_([0-9]+)_([a-z]+)/', $queryString, $deeplink)) {\n            $deeplink = $deeplink[0];\n            $perspective = strip_tags($request->get('perspective'));\n\n            if (strpos($queryString, 'token')) {\n                $event = new LoginRedirectEvent('pimcore_admin_login', [\n                    'deeplink' => $deeplink,\n                    'perspective' => $perspective,\n                ]);\n                $eventDispatcher->dispatch($event, AdminEvents::LOGIN_REDIRECT);\n\n                $url = $this->generateUrl($event->getRouteName(), $event->getRouteParams());\n                $url .= '&' . $queryString;\n\n                return $this->redirect($url);\n            } elseif ($queryString) {\n                $event = new LoginRedirectEvent('pimcore_admin_login', [\n                    'deeplink' => 'true',\n                    'perspective' => $perspective,\n                ]);\n                $eventDispatcher->dispatch($event, AdminEvents::LOGIN_REDIRECT);\n\n                return $this->render('@PimcoreAdmin/Admin/Login/deeplink.html.twig', [\n                    'tab' => $deeplink,\n                    'redirect' => $this->generateUrl($event->getRouteName(), $event->getRouteParams()),\n                ]);\n            }\n        }\n    }\n\n    protected function buildLoginPageViewParams(Config $config): array\n    {\n        $bundleManager = $this->get(PimcoreBundleManager::class);\n\n        return [\n            'config' => $config,\n            'pluginCssPaths' => $bundleManager->getCssPaths(),\n        ];\n    }\n\n    /**\n     * @Route(\"/login/2fa\", name=\"pimcore_admin_2fa\")\n     */\n    public function twoFactorAuthenticationAction(Request $request, BruteforceProtectionHandler $bruteforceProtectionHandler, Config $config)\n    {\n        $params = $this->buildLoginPageViewParams($config);\n\n        if ($request->hasSession()) {\n\n            // we have to call the check here manually, because BruteforceProtectionListener uses the 'username' from the request\n            $bruteforceProtectionHandler->checkProtection($this->getAdminUser()->getName(), $request);\n\n            $session = $request->getSession();\n            $authException = $session->get(Security::AUTHENTICATION_ERROR);\n            if ($authException instanceof AuthenticationException) {\n                $session->remove(Security::AUTHENTICATION_ERROR);\n\n                $params['error'] = $authException->getMessage();\n\n                $bruteforceProtectionHandler->addEntry($this->getAdminUser()->getName(), $request);\n            }\n        } else {\n            $params['error'] = 'No session available, it either timed out or cookies are not enabled.';\n        }\n\n        return $this->render('@PimcoreAdmin/Admin/Login/twoFactorAuthentication.html.twig', $params);\n    }\n\n    /**\n     * @Route(\"/login/2fa-verify\", name=\"pimcore_admin_2fa-verify\")\n     *\n     * @param Request $request\n     */\n    public function twoFactorAuthenticationVerifyAction(Request $request)\n    {\n    }\n\n    /**\n     * @return bool\n     */\n    public function detectBrowser()\n    {\n        $supported = false;\n        $browser = new \\Browser();\n        $browserVersion = (int)$browser->getVersion();\n\n        if ($browser->getBrowser() == \\Browser::BROWSER_FIREFOX && $browserVersion >= 72) {\n            $supported = true;\n        }\n        if ($browser->getBrowser() == \\Browser::BROWSER_CHROME && $browserVersion >= 84) {\n            $supported = true;\n        }\n        if ($browser->getBrowser() == \\Browser::BROWSER_SAFARI && $browserVersion >= 13.1) {\n            $supported = true;\n        }\n        if ($browser->getBrowser() == \\Browser::BROWSER_EDGE && $browserVersion >= 90) {\n            $supported = true;\n        }\n\n        return $supported;\n    }\n}\n", "{% set language = app.request.locale %}\n{# @var  \\Pimcore\\Bundle\\AdminBundle\\Security\\User\\User #}\n{% set userProxy = app.user %}\n{% set user = userProxy.user %}\n\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"robots\" content=\"noindex, nofollow\"/>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"/>\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\"/>\n\n    <link rel=\"icon\" type=\"image/png\" href=\"/bundles/pimcoreadmin/img/favicon/favicon-32x32.png\"/>\n    <meta name=\"google\" value=\"notranslate\">\n\n    <style type=\"text/css\">\n        body {\n            margin: 0;\n            padding: 0;\n            background: #fff;\n        }\n\n        #pimcore_loading {\n            margin: 0 auto;\n            width: 300px;\n            padding: 300px 0 0 0;\n            text-align: center;\n        }\n\n        .spinner {\n            margin: 100px auto 0;\n            width: 70px;\n            text-align: center;\n        }\n\n        .spinner > div {\n            width: 18px;\n            height: 18px;\n            background-color: #3d3d3d;\n\n            border-radius: 100%;\n            display: inline-block;\n            -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n            animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n        }\n\n        .spinner .bounce1 {\n            -webkit-animation-delay: -0.32s;\n            animation-delay: -0.32s;\n        }\n\n        .spinner .bounce2 {\n            -webkit-animation-delay: -0.16s;\n            animation-delay: -0.16s;\n        }\n\n        @-webkit-keyframes sk-bouncedelay {\n            0%, 80%, 100% {\n                -webkit-transform: scale(0)\n            }\n            40% {\n                -webkit-transform: scale(1.0)\n            }\n        }\n\n        @keyframes sk-bouncedelay {\n            0%, 80%, 100% {\n                -webkit-transform: scale(0);\n                transform: scale(0);\n            }\n            40% {\n                -webkit-transform: scale(1.0);\n                transform: scale(1.0);\n            }\n        }\n\n        #pimcore_panel_tabs-body {\n            background-image: url({{ path('pimcore_settings_display_custom_logo') }});\n            background-repeat: no-repeat;\n            background-position: center center;\n            background-size: 500px auto;\n        }\n    </style>\n\n    <title>{{ settings.hostname }} :: Pimcore</title>\n\n    <script>\n        var pimcore = {}; // namespace\n\n        // hide symfony toolbar by default\n        var symfonyToolbarKey = 'symfony/profiler/toolbar/displayState';\n        if(!window.localStorage.getItem(symfonyToolbarKey)) {\n            window.localStorage.setItem(symfonyToolbarKey, 'none');\n        }\n    </script>\n\n    <script src=\"{{ asset('bundles/fosjsrouting/js/router.js') }}\"></script>\n    <script src=\"{{ path('fos_js_routing_js', {'callback' : 'fos.Router.setData'}) }}\"></script>\n</head>\n\n<body class=\"pimcore_version_10\" data-app-env=\"{{ app.environment }}\">\n\n<div id=\"pimcore_loading\">\n    <div class=\"spinner\">\n        <div class=\"bounce1\"></div>\n        <div class=\"bounce2\"></div>\n        <div class=\"bounce3\"></div>\n    </div>\n</div>\n{% set runtimePerspective = perspectiveConfig.getRuntimePerspective(user) %}\n\n<div id=\"pimcore_sidebar\">\n    <div id=\"pimcore_navigation\" style=\"display:none;\">\n        <ul>\n            {% set navigations = {\n                'file': {'label': 'file', 'icon': 'file'},\n                'extras': {'label': 'tools', 'icon': 'build'},\n                'marketing': {'label': 'marketing', 'icon': 'bar_chart'},\n                'settings': {'label': 'settings', 'icon': 'settings'},\n                'ecommerce': {'label': 'bundle_ecommerce_mainmenu', 'icon': 'shopping_cart', 'extraAttr': 'style=\"display: none;\"'},\n                'search': {'label': 'search', 'icon': 'search'}\n            } %}\n\n            {% set extraAttr = {'ecommerce': 'style=\"display: none;\"'} %}\n\n            {% for navKey,navData in navigations %}\n                {% if config.inPerspective(runtimePerspective, navKey) %}\n                    <li id=\"pimcore_menu_{{ navKey }}\" data-menu-tooltip=\"{{ navData[\"label\"]|trans([],'admin') }}\" class=\"pimcore_menu_item pimcore_menu_needs_children\" {{ navData[\"extraAttr\"] ?? '' }}>\n                        <img src=\"/bundles/pimcoreadmin/img/material-icons/outline-{{ navData[\"icon\"] }}-24px.svg\">\n                    </li>\n                {% endif %}\n            {% endfor %}\n            <li id=\"pimcore_menu_maintenance\" data-menu-tooltip=\"{{ \"deactivate_maintenance\"|trans([], 'admin') }}\" class=\"pimcore_menu_item \" style=\"display:none;\"></li>\n        </ul>\n    </div>\n\n    <div id=\"pimcore_status\"></div>\n\n    <div id=\"pimcore_notification\" data-menu-tooltip=\"{{ \"notifications\"|trans([],'admin') }}\" class=\"pimcore_icon_comments\">\n        <img src=\"/bundles/pimcoreadmin/img/material-icons/outline-sms-24px.svg\">\n        <span id=\"notification_value\" style=\"display:none;\"></span>\n    </div>\n\n    <div id=\"pimcore_avatar\" style=\"display:none;\">\n        <img src=\"{{ path('pimcore_admin_user_getimage') }}\" data-menu-tooltip=\"{{ user.name }} | {{ 'my_profile'|trans([],'admin') }}\"/>\n    </div>\n    <a id=\"pimcore_logout\" data-menu-tooltip=\"{{ \"logout\"|trans([],'admin') }}\" href=\"{{ path('pimcore_admin_logout') }}\" style=\"display: none\">\n        <img src=\"/bundles/pimcoreadmin/img/material-icons/outline-logout-24px.svg\">\n    </a>\n    <div id=\"pimcore_signet\" data-menu-tooltip=\"Pimcore Platform ({{ settings.version }}|{{ settings.build }})\" style=\"text-indent: -10000px\">\n        BE RESPECTFUL AND HONOR OUR WORK FOR FREE & OPEN SOURCE SOFTWARE BY NOT REMOVING OUR LOGO.\n        WE OFFER YOU THE POSSIBILITY TO ADDITIONALLY ADD YOUR OWN LOGO IN PIMCORE'S SYSTEM SETTINGS. THANK YOU!\n    </div>\n</div>\n\n<div id=\"pimcore_tooltip\" style=\"display: none;\"></div>\n<div id=\"pimcore_quicksearch\"></div>\n\n{# define stylesheets #}\n\n{% set styles = [\n        path('pimcore_admin_misc_admincss'),\n        \"/bundles/pimcoreadmin/css/icons.css\",\n        \"/bundles/pimcoreadmin/js/lib/leaflet/leaflet.css\",\n        \"/bundles/pimcoreadmin/js/lib/leaflet.draw/leaflet.draw.css\",\n        \"/bundles/pimcoreadmin/extjs/css/PimcoreApp-all_1.css\",\n        \"/bundles/pimcoreadmin/extjs/css/PimcoreApp-all_2.css\",\n        \"/bundles/pimcoreadmin/css/admin.css\"\n    ]\n%}\n\n<!-- stylesheets -->\n<style type=\"text/css\">\n    {#\n     # use @import here, because if IE9 CSS file limitations (31 files)\n     # see also: http://blogs.telerik.com/blogs/posts/10-05-03/internet-explorer-css-limits.aspx\n     # @import bypasses this problem in an elegant way\n    #}\n    {% for style in styles %}\n        @import url(\"{{ style }}?_dc={{ settings.build }}\");\n    {% endfor %}\n</style>\n\n{# define scripts #}\n\n{% set debugSuffix = '' %}\n{% if settings.disableMinifyJs %}\n    {% set debugSuffix = \"-debug\" %}\n{% endif %}\n\n{# SCRIPT LIBRARIES #}\n\n{% set scriptLibs = [\n    \"lib/class.js\",\n    \"../extjs/js/ext-all\" ~ debugSuffix ~ \".js\",\n    \"lib/ext-plugins/portlet/PortalDropZone.js\",\n    \"lib/ext-plugins/portlet/Portlet.js\",\n    \"lib/ext-plugins/portlet/PortalColumn.js\",\n    \"lib/ext-plugins/portlet/PortalPanel.js\",\n    \"lib/ckeditor/ckeditor.js\",\n    \"lib/leaflet/leaflet.js\",\n    \"lib/leaflet.draw/leaflet.draw.js\",\n    \"lib/vrview/build/vrview.min.js\",\n    \"lib/ace/src-min-noconflict/ace.js\",\n    \"lib/ace/src-min-noconflict/ext-modelist.js\"\n] %}\n{% if pimcore_file_exists(constant('PIMCORE_WEB_ROOT') ~ '/bundles/pimcoreadmin/js/lib/ext-locale/locale-' ~ language ~ '.js') %}\n    {% set scriptLibs = scriptLibs|merge(['lib/ext-locale/locale-' ~ language ~ '.js']) %}\n{% endif %}\n\n{# PIMCORE SCRIPTS #}\n\n{% set scripts = [\n\n\n    \"pimcore/functions.js\",\n    \"pimcore/common.js\",\n    \"pimcore/elementservice.js\",\n    \"pimcore/helpers.js\",\n    \"pimcore/error.js\",\n\n    \"pimcore/treenodelocator.js\",\n    \"pimcore/helpers/generic-grid.js\",\n    \"pimcore/helpers/quantityValue.js\",\n    \"pimcore/overrides.js\",\n\n    \"pimcore/perspective.js\",\n    \"pimcore/user.js\",\n\n\n    \"pimcore/tool/paralleljobs.js\",\n    \"pimcore/tool/genericiframewindow.js\",\n\n\n    \"pimcore/settings/user/panels/abstract.js\",\n    \"pimcore/settings/user/panel.js\",\n\n    \"pimcore/settings/user/usertab.js\",\n    \"pimcore/settings/user/editorSettings.js\",\n    \"pimcore/settings/user/websiteTranslationSettings.js\",\n    \"pimcore/settings/user/role/panel.js\",\n    \"pimcore/settings/user/role/tab.js\",\n    \"pimcore/settings/user/user/objectrelations.js\",\n    \"pimcore/settings/user/user/settings.js\",\n    \"pimcore/settings/user/user/keyBindings.js\",\n    \"pimcore/settings/user/workspaces.js\",\n    \"pimcore/settings/user/workspace/asset.js\",\n    \"pimcore/settings/user/workspace/document.js\",\n    \"pimcore/settings/user/workspace/object.js\",\n    \"pimcore/settings/user/workspace/customlayouts.js\",\n    \"pimcore/settings/user/workspace/language.js\",\n    \"pimcore/settings/user/workspace/special.js\",\n    \"pimcore/settings/user/role/settings.js\",\n    \"pimcore/settings/profile/panel.js\",\n    \"pimcore/settings/profile/twoFactorSettings.js\",\n    \"pimcore/settings/thumbnail/item.js\",\n    \"pimcore/settings/thumbnail/panel.js\",\n    \"pimcore/settings/videothumbnail/item.js\",\n    \"pimcore/settings/videothumbnail/panel.js\",\n    \"pimcore/settings/translations.js\",\n    \"pimcore/settings/translationEditor.js\",\n    \"pimcore/settings/translation/website.js\",\n    \"pimcore/settings/translation/admin.js\",\n    \"pimcore/settings/translation/translationmerger.js\",\n    \"pimcore/settings/translation/xliff.js\",\n    \"pimcore/settings/translation/word.js\",\n    \"pimcore/settings/translation/translationSettingsTab.js\",\n    \"pimcore/settings/metadata/predefined.js\",\n    \"pimcore/settings/properties/predefined.js\",\n    \"pimcore/settings/docTypes.js\",\n    \"pimcore/settings/system.js\",\n    \"pimcore/settings/web2print.js\",\n    \"pimcore/settings/website.js\",\n    \"pimcore/settings/staticroutes.js\",\n    \"pimcore/settings/redirects.js\",\n    \"pimcore/settings/glossary.js\",\n    \"pimcore/settings/recyclebin.js\",\n    \"pimcore/settings/fileexplorer/file.js\",\n    \"pimcore/settings/fileexplorer/explorer.js\",\n    \"pimcore/settings/maintenance.js\",\n    \"pimcore/settings/robotstxt.js\",\n    \"pimcore/settings/httpErrorLog.js\",\n    \"pimcore/settings/email/log.js\",\n    \"pimcore/settings/email/blacklist.js\",\n    \"pimcore/settings/targeting/condition/abstract.js\",\n    \"pimcore/settings/targeting/conditions.js\",\n    \"pimcore/settings/targeting/action/abstract.js\",\n    \"pimcore/settings/targeting/actions.js\",\n    \"pimcore/settings/targeting/rules/panel.js\",\n    \"pimcore/settings/targeting/rules/item.js\",\n    \"pimcore/settings/targeting/targetGroups/panel.js\",\n    \"pimcore/settings/targeting/targetGroups/item.js\",\n    \"pimcore/settings/targeting_toolbar.js\",\n\n    \"pimcore/settings/gdpr/gdprPanel.js\",\n    \"pimcore/settings/gdpr/dataproviders/assets.js\",\n    \"pimcore/settings/gdpr/dataproviders/dataObjects.js\",\n    \"pimcore/settings/gdpr/dataproviders/sentMail.js\",\n    \"pimcore/settings/gdpr/dataproviders/pimcoreUsers.js\",\n\n\n    \"pimcore/element/abstract.js\",\n    \"pimcore/element/selector/selector.js\",\n    \"pimcore/element/selector/abstract.js\",\n    \"pimcore/element/selector/document.js\",\n    \"pimcore/element/selector/asset.js\",\n    \"pimcore/element/properties.js\",\n    \"pimcore/element/scheduler.js\",\n    \"pimcore/element/dependencies.js\",\n    \"pimcore/element/metainfo.js\",\n    \"pimcore/element/history.js\",\n    \"pimcore/element/notes.js\",\n    \"pimcore/element/note_details.js\",\n    \"pimcore/element/workflows.js\",\n    \"pimcore/element/tag/imagecropper.js\",\n    \"pimcore/element/tag/imagehotspotmarkereditor.js\",\n    \"pimcore/element/replace_assignments.js\",\n    \"pimcore/element/permissionchecker.js\",\n    \"pimcore/element/gridexport/abstract.js\",\n    \"pimcore/element/helpers/gridColumnConfig.js\",\n    \"pimcore/element/helpers/gridConfigDialog.js\",\n    \"pimcore/element/helpers/gridCellEditor.js\",\n    \"pimcore/element/helpers/gridTabAbstract.js\",\n    \"pimcore/object/helpers/grid.js\",\n    \"pimcore/object/helpers/gridConfigDialog.js\",\n    \"pimcore/object/helpers/classTree.js\",\n    \"pimcore/object/helpers/gridTabAbstract.js\",\n    \"pimcore/object/helpers/metadataMultiselectEditor.js\",\n    \"pimcore/object/helpers/customLayoutEditor.js\",\n    \"pimcore/object/helpers/optionEditor.js\",\n    \"pimcore/object/helpers/imageGalleryDropZone.js\",\n    \"pimcore/object/helpers/imageGalleryPanel.js\",\n    \"pimcore/element/selector/object.js\",\n    \"pimcore/element/tag/configuration.js\",\n    \"pimcore/element/tag/assignment.js\",\n    \"pimcore/element/tag/tree.js\",\n    \"pimcore/asset/helpers/metadataTree.js\",\n    \"pimcore/asset/helpers/gridConfigDialog.js\",\n    \"pimcore/asset/helpers/gridTabAbstract.js\",\n    \"pimcore/asset/helpers/grid.js\",\n\n\n    \"pimcore/document/properties.js\",\n    \"pimcore/document/document.js\",\n    \"pimcore/document/page_snippet.js\",\n    \"pimcore/document/edit.js\",\n    \"pimcore/document/versions.js\",\n    \"pimcore/document/settings_abstract.js\",\n    \"pimcore/document/pages/settings.js\",\n    \"pimcore/document/pages/preview.js\",\n    \"pimcore/document/snippets/settings.js\",\n    \"pimcore/document/emails/settings.js\",\n    \"pimcore/document/newsletters/settings.js\",\n    \"pimcore/document/newsletters/sendingPanel.js\",\n    \"pimcore/document/newsletters/plaintextPanel.js\",\n    \"pimcore/document/newsletters/addressSourceAdapters/default.js\",\n    \"pimcore/document/newsletters/addressSourceAdapters/csvList.js\",\n    \"pimcore/document/newsletters/addressSourceAdapters/report.js\",\n    \"pimcore/document/link.js\",\n    \"pimcore/document/hardlink.js\",\n    \"pimcore/document/folder.js\",\n    \"pimcore/document/tree.js\",\n    \"pimcore/document/snippet.js\",\n    \"pimcore/document/email.js\",\n    \"pimcore/document/newsletter.js\",\n    \"pimcore/document/page.js\",\n    \"pimcore/document/printpages/pdf_preview.js\",\n    \"pimcore/document/printabstract.js\",\n    \"pimcore/document/printpage.js\",\n    \"pimcore/document/printcontainer.js\",\n    \"pimcore/document/seopanel.js\",\n    \"pimcore/document/document_language_overview.js\",\n    \"pimcore/document/customviews/tree.js\",\n\n\n    \"pimcore/asset/metadata/data/data.js\",\n    \"pimcore/asset/metadata/data/input.js\",\n    \"pimcore/asset/metadata/data/textarea.js\",\n    \"pimcore/asset/metadata/data/asset.js\",\n    \"pimcore/asset/metadata/data/document.js\",\n    \"pimcore/asset/metadata/data/object.js\",\n    \"pimcore/asset/metadata/data/date.js\",\n    \"pimcore/asset/metadata/data/checkbox.js\",\n    \"pimcore/asset/metadata/data/select.js\",\n\n    \"pimcore/asset/metadata/tags/abstract.js\",\n    \"pimcore/asset/metadata/tags/checkbox.js\",\n    \"pimcore/asset/metadata/tags/date.js\",\n    \"pimcore/asset/metadata/tags/input.js\",\n    \"pimcore/asset/metadata/tags/manyToOneRelation.js\",\n    \"pimcore/asset/metadata/tags/asset.js\",\n    \"pimcore/asset/metadata/tags/document.js\",\n    \"pimcore/asset/metadata/tags/object.js\",\n    \"pimcore/asset/metadata/tags/select.js\",\n    \"pimcore/asset/metadata/tags/textarea.js\",\n    \"pimcore/asset/asset.js\",\n    \"pimcore/asset/unknown.js\",\n    \"pimcore/asset/embedded_meta_data.js\",\n    \"pimcore/asset/image.js\",\n    \"pimcore/asset/document.js\",\n    \"pimcore/asset/archive.js\",\n    \"pimcore/asset/video.js\",\n    \"pimcore/asset/audio.js\",\n    \"pimcore/asset/text.js\",\n    \"pimcore/asset/folder.js\",\n    \"pimcore/asset/listfolder.js\",\n    \"pimcore/asset/versions.js\",\n    \"pimcore/asset/metadata/dataProvider.js\",\n    \"pimcore/asset/metadata/grid.js\",\n    \"pimcore/asset/metadata/editor.js\",\n    \"pimcore/asset/tree.js\",\n    \"pimcore/asset/customviews/tree.js\",\n    \"pimcore/asset/gridexport/csv.js\",\n    \"pimcore/asset/gridexport/xlsx.js\",\n\n\n    \"pimcore/object/helpers/edit.js\",\n    \"pimcore/object/helpers/layout.js\",\n    \"pimcore/object/classes/class.js\",\n    \"pimcore/object/class.js\",\n    \"pimcore/object/bulk-base.js\",\n    \"pimcore/object/bulk-export.js\",\n    \"pimcore/object/bulk-import.js\",\n    \"pimcore/object/classes/data/data.js\",\n    \"pimcore/object/classes/data/block.js\",\n    \"pimcore/object/classes/data/classificationstore.js\",\n    \"pimcore/object/classes/data/rgbaColor.js\",\n    \"pimcore/object/classes/data/date.js\",\n    \"pimcore/object/classes/data/datetime.js\",\n    \"pimcore/object/classes/data/encryptedField.js\",\n    \"pimcore/object/classes/data/time.js\",\n    \"pimcore/object/classes/data/manyToOneRelation.js\",\n    \"pimcore/object/classes/data/image.js\",\n    \"pimcore/object/classes/data/externalImage.js\",\n    \"pimcore/object/classes/data/hotspotimage.js\",\n    \"pimcore/object/classes/data/imagegallery.js\",\n    \"pimcore/object/classes/data/video.js\",\n    \"pimcore/object/classes/data/input.js\",\n    \"pimcore/object/classes/data/numeric.js\",\n    \"pimcore/object/classes/data/manyToManyObjectRelation.js\",\n    \"pimcore/object/classes/data/advancedManyToManyRelation.js\",\n    \"pimcore/object/classes/data/advancedManyToManyObjectRelation.js\",\n    \"pimcore/object/classes/data/reverseObjectRelation.js\",\n    \"pimcore/object/classes/data/booleanSelect.js\",\n    \"pimcore/object/classes/data/select.js\",\n    \"pimcore/object/classes/data/urlSlug.js\",\n    \"pimcore/object/classes/data/user.js\",\n    \"pimcore/object/classes/data/textarea.js\",\n    \"pimcore/object/classes/data/wysiwyg.js\",\n    \"pimcore/object/classes/data/checkbox.js\",\n    \"pimcore/object/classes/data/consent.js\",\n    \"pimcore/object/classes/data/slider.js\",\n    \"pimcore/object/classes/data/manyToManyRelation.js\",\n    \"pimcore/object/classes/data/table.js\",\n    \"pimcore/object/classes/data/structuredTable.js\",\n    \"pimcore/object/classes/data/country.js\",\n    \"pimcore/object/classes/data/geo/abstract.js\",\n    \"pimcore/object/classes/data/geopoint.js\",\n    \"pimcore/object/classes/data/geobounds.js\",\n    \"pimcore/object/classes/data/geopolygon.js\",\n    \"pimcore/object/classes/data/geopolyline.js\",\n    \"pimcore/object/classes/data/language.js\",\n    \"pimcore/object/classes/data/password.js\",\n    \"pimcore/object/classes/data/multiselect.js\",\n    \"pimcore/object/classes/data/link.js\",\n    \"pimcore/object/classes/data/fieldcollections.js\",\n    \"pimcore/object/classes/data/objectbricks.js\",\n    \"pimcore/object/classes/data/localizedfields.js\",\n    \"pimcore/object/classes/data/countrymultiselect.js\",\n    \"pimcore/object/classes/data/languagemultiselect.js\",\n    \"pimcore/object/classes/data/firstname.js\",\n    \"pimcore/object/classes/data/lastname.js\",\n    \"pimcore/object/classes/data/email.js\",\n    \"pimcore/object/classes/data/gender.js\",\n    \"pimcore/object/classes/data/newsletterActive.js\",\n    \"pimcore/object/classes/data/newsletterConfirmed.js\",\n    \"pimcore/object/classes/data/targetGroup.js\",\n    \"pimcore/object/classes/data/targetGroupMultiselect.js\",\n    \"pimcore/object/classes/data/quantityValue.js\",\n    \"pimcore/object/classes/data/inputQuantityValue.js\",\n    \"pimcore/object/classes/data/calculatedValue.js\",\n    \"pimcore/object/classes/layout/layout.js\",\n    \"pimcore/object/classes/layout/accordion.js\",\n    \"pimcore/object/classes/layout/fieldset.js\",\n    \"pimcore/object/classes/layout/fieldcontainer.js\",\n    \"pimcore/object/classes/layout/panel.js\",\n    \"pimcore/object/classes/layout/region.js\",\n    \"pimcore/object/classes/layout/tabpanel.js\",\n    \"pimcore/object/classes/layout/button.js\",\n    \"pimcore/object/classes/layout/iframe.js\",\n    \"pimcore/object/fieldlookup/filterdialog.js\",\n    \"pimcore/object/fieldlookup/helper.js\",\n    \"pimcore/object/classes/layout/text.js\",\n    \"pimcore/object/fieldcollection.js\",\n    \"pimcore/object/fieldcollections/field.js\",\n    \"pimcore/object/gridcolumn/Abstract.js\",\n    \"pimcore/object/gridcolumn/operator/IsEqual.js\",\n    \"pimcore/object/gridcolumn/operator/Text.js\",\n    \"pimcore/object/gridcolumn/operator/Anonymizer.js\",\n    \"pimcore/object/gridcolumn/operator/AnyGetter.js\",\n    \"pimcore/object/gridcolumn/operator/AssetMetadataGetter.js\",\n    \"pimcore/object/gridcolumn/operator/Arithmetic.js\",\n    \"pimcore/object/gridcolumn/operator/Boolean.js\",\n    \"pimcore/object/gridcolumn/operator/BooleanFormatter.js\",\n    \"pimcore/object/gridcolumn/operator/CaseConverter.js\",\n    \"pimcore/object/gridcolumn/operator/CharCounter.js\",\n    \"pimcore/object/gridcolumn/operator/Concatenator.js\",\n    \"pimcore/object/gridcolumn/operator/DateFormatter.js\",\n    \"pimcore/object/gridcolumn/operator/ElementCounter.js\",\n    \"pimcore/object/gridcolumn/operator/Iterator.js\",\n    \"pimcore/object/gridcolumn/operator/JSON.js\",\n    \"pimcore/object/gridcolumn/operator/LocaleSwitcher.js\",\n    \"pimcore/object/gridcolumn/operator/Merge.js\",\n    \"pimcore/object/gridcolumn/operator/ObjectFieldGetter.js\",\n    \"pimcore/object/gridcolumn/operator/PHP.js\",\n    \"pimcore/object/gridcolumn/operator/PHPCode.js\",\n    \"pimcore/object/gridcolumn/operator/Base64.js\",\n    \"pimcore/object/gridcolumn/operator/TranslateValue.js\",\n    \"pimcore/object/gridcolumn/operator/PropertyGetter.js\",\n    \"pimcore/object/gridcolumn/operator/RequiredBy.js\",\n    \"pimcore/object/gridcolumn/operator/StringContains.js\",\n    \"pimcore/object/gridcolumn/operator/StringReplace.js\",\n    \"pimcore/object/gridcolumn/operator/Substring.js\",\n    \"pimcore/object/gridcolumn/operator/LFExpander.js\",\n    \"pimcore/object/gridcolumn/operator/Trimmer.js\",\n    \"pimcore/object/gridcolumn/operator/Alias.js\",\n    \"pimcore/object/gridcolumn/operator/WorkflowState.js\",\n    \"pimcore/object/gridcolumn/value/DefaultValue.js\",\n    \"pimcore/object/gridcolumn/operator/GeopointRenderer.js\",\n    \"pimcore/object/gridcolumn/operator/ImageRenderer.js\",\n    \"pimcore/object/gridcolumn/operator/HotspotimageRenderer.js\",\n    \"pimcore/object/importcolumn/Abstract.js\",\n    \"pimcore/object/importcolumn/operator/Base64.js\",\n    \"pimcore/object/importcolumn/operator/Ignore.js\",\n    \"pimcore/object/importcolumn/operator/Iterator.js\",\n    \"pimcore/object/importcolumn/operator/LocaleSwitcher.js\",\n    \"pimcore/object/importcolumn/operator/ObjectBrickSetter.js\",\n    \"pimcore/object/importcolumn/operator/PHPCode.js\",\n    \"pimcore/object/importcolumn/operator/Published.js\",\n    \"pimcore/object/importcolumn/operator/Splitter.js\",\n    \"pimcore/object/importcolumn/operator/Unserialize.js\",\n    \"pimcore/object/importcolumn/value/DefaultValue.js\",\n    \"pimcore/object/objectbrick.js\",\n    \"pimcore/object/objectbricks/field.js\",\n    \"pimcore/object/tags/abstract.js\",\n    \"pimcore/object/tags/abstractRelations.js\",\n    \"pimcore/object/tags/block.js\",\n    \"pimcore/object/tags/rgbaColor.js\",\n    \"pimcore/object/tags/date.js\",\n    \"pimcore/object/tags/datetime.js\",\n    \"pimcore/object/tags/time.js\",\n    \"pimcore/object/tags/manyToOneRelation.js\",\n    \"pimcore/object/tags/image.js\",\n    \"pimcore/object/tags/encryptedField.js\",\n    \"pimcore/object/tags/externalImage.js\",\n    \"pimcore/object/tags/hotspotimage.js\",\n    \"pimcore/object/tags/imagegallery.js\",\n    \"pimcore/object/tags/video.js\",\n    \"pimcore/object/tags/input.js\",\n    \"pimcore/object/tags/classificationstore.js\",\n    \"pimcore/object/tags/numeric.js\",\n    \"pimcore/object/tags/manyToManyObjectRelation.js\",\n    \"pimcore/object/tags/advancedManyToManyRelation.js\",\n    \"pimcore/object/gridcolumn/operator/FieldCollectionGetter.js\",\n    \"pimcore/object/tags/advancedManyToManyObjectRelation.js\",\n    \"pimcore/object/tags/reverseObjectRelation.js\",\n    \"pimcore/object/tags/urlSlug.js\",\n    \"pimcore/object/tags/booleanSelect.js\",\n    \"pimcore/object/tags/select.js\",\n    \"pimcore/object/tags/user.js\",\n    \"pimcore/object/tags/checkbox.js\",\n    \"pimcore/object/tags/consent.js\",\n    \"pimcore/object/tags/textarea.js\",\n    \"pimcore/object/tags/wysiwyg.js\",\n    \"pimcore/object/tags/slider.js\",\n    \"pimcore/object/tags/manyToManyRelation.js\",\n    \"pimcore/object/tags/table.js\",\n    \"pimcore/object/tags/structuredTable.js\",\n    \"pimcore/object/tags/country.js\",\n    \"pimcore/object/tags/geo/abstract.js\",\n    \"pimcore/object/tags/geobounds.js\",\n    \"pimcore/object/tags/geopoint.js\",\n    \"pimcore/object/tags/geopolygon.js\",\n    \"pimcore/object/tags/geopolyline.js\",\n    \"pimcore/object/tags/language.js\",\n    \"pimcore/object/tags/password.js\",\n    \"pimcore/object/tags/multiselect.js\",\n    \"pimcore/object/tags/link.js\",\n    \"pimcore/object/tags/fieldcollections.js\",\n    \"pimcore/object/tags/localizedfields.js\",\n    \"pimcore/object/tags/countrymultiselect.js\",\n    \"pimcore/object/tags/languagemultiselect.js\",\n    \"pimcore/object/tags/objectbricks.js\",\n    \"pimcore/object/tags/firstname.js\",\n    \"pimcore/object/tags/lastname.js\",\n    \"pimcore/object/tags/email.js\",\n    \"pimcore/object/tags/gender.js\",\n    \"pimcore/object/tags/newsletterActive.js\",\n    \"pimcore/object/tags/newsletterConfirmed.js\",\n    \"pimcore/object/tags/targetGroup.js\",\n    \"pimcore/object/tags/targetGroupMultiselect.js\",\n    \"pimcore/object/tags/quantityValue.js\",\n    \"pimcore/object/tags/inputQuantityValue.js\",\n    \"pimcore/object/tags/calculatedValue.js\",\n    \"pimcore/object/preview.js\",\n    \"pimcore/object/versions.js\",\n    \"pimcore/object/variantsTab.js\",\n    \"pimcore/object/folder/search.js\",\n    \"pimcore/object/edit.js\",\n    \"pimcore/object/abstract.js\",\n    \"pimcore/object/object.js\",\n    \"pimcore/object/folder.js\",\n    \"pimcore/object/variant.js\",\n    \"pimcore/object/tree.js\",\n    \"pimcore/object/layout/iframe.js\",\n    \"pimcore/object/customviews/tree.js\",\n    \"pimcore/object/quantityvalue/unitsettings.js\",\n    \"pimcore/object/gridexport/csv.js\",\n    \"pimcore/object/gridexport/xlsx.js\",\n\n\n    \"pimcore/plugin/broker.js\",\n    \"pimcore/plugin/plugin.js\",\n\n    \"pimcore/event-dispatcher.js\",\n\n\n    \"pimcore/report/panel.js\",\n    \"pimcore/report/broker.js\",\n    \"pimcore/report/abstract.js\",\n    \"pimcore/report/settings.js\",\n    \"pimcore/report/analytics/settings.js\",\n    \"pimcore/report/analytics/elementoverview.js\",\n    \"pimcore/report/analytics/elementexplorer.js\",\n    \"pimcore/report/webmastertools/settings.js\",\n    \"pimcore/report/tagmanager/settings.js\",\n    \"pimcore/report/custom/item.js\",\n    \"pimcore/report/custom/panel.js\",\n    \"pimcore/report/custom/settings.js\",\n    \"pimcore/report/custom/report.js\",\n    \"pimcore/report/custom/definitions/sql.js\",\n    \"pimcore/report/custom/definitions/analytics.js\",\n    \"pimcore/report/custom/toolbarenricher.js\",\n\n    \"pimcore/extensionmanager/admin.js\",\n\n\n    \"pimcore/log/admin.js\",\n    \"pimcore/log/detailwindow.js\",\n\n\n    \"pimcore/layout/portal.js\",\n    \"pimcore/layout/portlets/abstract.js\",\n    \"pimcore/layout/portlets/modifiedDocuments.js\",\n    \"pimcore/layout/portlets/modifiedObjects.js\",\n    \"pimcore/layout/portlets/modifiedAssets.js\",\n    \"pimcore/layout/portlets/modificationStatistic.js\",\n    \"pimcore/layout/portlets/analytics.js\",\n    \"pimcore/layout/portlets/customreports.js\",\n\n    \"pimcore/layout/toolbar.js\",\n    \"pimcore/layout/treepanelmanager.js\",\n    \"pimcore/document/seemode.js\",\n\n\n    \"pimcore/object/classificationstore/groupsPanel.js\",\n    \"pimcore/object/classificationstore/propertiesPanel.js\",\n    \"pimcore/object/classificationstore/collectionsPanel.js\",\n    \"pimcore/object/classificationstore/keyDefinitionWindow.js\",\n    \"pimcore/object/classificationstore/keySelectionWindow.js\",\n    \"pimcore/object/classificationstore/relationSelectionWindow.js\",\n    \"pimcore/object/classificationstore/storeConfiguration.js\",\n    \"pimcore/object/classificationstore/storeTree.js\",\n    \"pimcore/object/classificationstore/columnConfigDialog.js\",\n\n\n    \"pimcore/workflow/transitionPanel.js\",\n    \"pimcore/workflow/transitions.js\",\n    \"pimcore/workflow/transitions.js\",\n\n\n    \"pimcore/colorpicker-overrides.js\",\n\n\n    \"pimcore/notification/helper.js\",\n    \"pimcore/notification/panel.js\",\n    \"pimcore/notification/modal.js\",\n]\n%}\n\n<!-- some javascript -->\n{# pimcore constants #}\n<script>\n    pimcore.settings = {{(settings|json_encode(constant('JSON_PRETTY_PRINT'))|raw)}};\n</script>\n\n<script src=\"{{ path('pimcore_admin_misc_jsontranslationssystem', {'language': language, '_dc': settings.build }) }}\"></script>\n<script src=\"{{ path('pimcore_admin_user_getcurrentuser', {'_dc': settings.build }) }}\"></script>\n<script src=\"{{ path('pimcore_admin_misc_availablelanguages', {'_dc': settings.build }) }}\"></script>\n\n<!-- library scripts -->\n{% for scriptUrl in scriptLibs %}\n    <script src=\"/bundles/pimcoreadmin/js/{{ scriptUrl }}?_dc={{ settings.build }}\"></script>\n{% endfor %}\n\n<!-- internal scripts -->\n{% if settings.disableMinifyJs %}\n    {% for scriptUrl in scripts %}\n        <script src=\"/bundles/pimcoreadmin/js/{{ scriptUrl }}?_dc={{ settings.build }}\"></script>\n    {% endfor %}\n{% else %}\n    {{ pimcore_minimize_scripts(scripts)|raw }}\n{% endif %}\n\n{# load plugin scripts #}\n\n{# // only add the timestamp if the devmode is not activated, otherwise it is very hard to develop and debug plugins,\n # // because the filename changes on every reload and therefore breakpoints, ... are resetted on every reload\n#}\n\n{% set pluginDcValue = \"now\"|date('U') %}\n{% if settings.disableMinifyJs %}\n    {% set pluginDcValue = 1 %}\n{% endif %}\n\n<!-- bundle scripts -->\n{% if settings.disableMinifyJs %}\n    {% for pluginJsPath in pluginJsPaths %}\n        <script src=\"{{ pluginJsPath }}?_dc={{ pluginDcValue }}\"></script>\n    {% endfor %}\n{% else %}\n    {{ pimcore_minimize_scripts(pluginJsPaths)|raw }}\n{% endif %}\n\n{% for pluginCssPath in pluginCssPaths %}\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"{{ pluginCssPath }}?_dc={{ pluginDcValue }}\"/>\n{% endfor %}\n\n{#  MUST BE THE LAST LINE  #}\n<script src=\"/bundles/pimcoreadmin/js/pimcore/startup.js?_dc={{ settings.build }}\"></script>\n</body>\n</html>\n", "{% extends '@PimcoreAdmin/Admin/Login/layout.html.twig' %}\n\n{% block content %}\n    {% if error is defined %}\n        <div class=\"text error\">\n            {{ error|trans([],'admin')|raw }}\n        </div>\n    {% else %}\n        <div class=\"text info\">\n            {{ 'Enter your verification code'|trans([],'admin') }}\n        </div>\n    {% endif %}\n\n    <form method=\"post\" action=\"{{ path('pimcore_admin_2fa-verify') }}\">\n        <input name=\"_auth_code\" id=\"_auth_code\" autocomplete=\"one-time-code\" type=\"password\" placeholder=\"{{ '2fa_code'|trans([],'admin') }}\" required autofocus>\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken() }}\">\n\n        <button type=\"submit\">{{ 'Login'|trans([],'admin') }}</button>\n    </form>\n\n    <a href=\"{{ path('pimcore_admin_logout') }}\">{{ 'Back to Login'|trans([],'admin') }}</a>\n\n    {{ pimcore_breach_attack_random_content() }}\n{% endblock %}\n\n\n\n"], "fixing_code": ["<?php\n\n/**\n * Pimcore\n *\n * This source file is available under two different licenses:\n * - GNU General Public License version 3 (GPLv3)\n * - Pimcore Commercial License (PCL)\n * Full copyright and license information is available in\n * LICENSE.md which is distributed with this source code.\n *\n *  @copyright  Copyright (c) Pimcore GmbH (http://www.pimcore.org)\n *  @license    http://www.pimcore.org/license     GPLv3 and PCL\n */\n\nnamespace Pimcore\\Bundle\\AdminBundle\\Controller\\Admin;\n\nuse Pimcore\\Bundle\\AdminBundle\\Controller\\AdminController;\nuse Pimcore\\Bundle\\AdminBundle\\Controller\\BruteforceProtectedControllerInterface;\nuse Pimcore\\Bundle\\AdminBundle\\Security\\BruteforceProtectionHandler;\nuse Pimcore\\Bundle\\AdminBundle\\Security\\CsrfProtectionHandler;\nuse Pimcore\\Config;\nuse Pimcore\\Controller\\KernelControllerEventInterface;\nuse Pimcore\\Controller\\KernelResponseEventInterface;\nuse Pimcore\\Event\\Admin\\Login\\LoginRedirectEvent;\nuse Pimcore\\Event\\Admin\\Login\\LostPasswordEvent;\nuse Pimcore\\Event\\AdminEvents;\nuse Pimcore\\Extension\\Bundle\\PimcoreBundleManager;\nuse Pimcore\\Http\\ResponseHelper;\nuse Pimcore\\Logger;\nuse Pimcore\\Model\\User;\nuse Pimcore\\Tool;\nuse Pimcore\\Tool\\Authentication;\nuse Symfony\\Component\\HttpFoundation\\RedirectResponse;\nuse Symfony\\Component\\HttpFoundation\\Request;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\HttpKernel\\Event\\ControllerEvent;\nuse Symfony\\Component\\HttpKernel\\Event\\ResponseEvent;\nuse Symfony\\Component\\Routing\\Annotation\\Route;\nuse Symfony\\Component\\Routing\\Generator\\UrlGeneratorInterface;\nuse Symfony\\Component\\Security\\Core\\Exception\\AuthenticationException;\nuse Symfony\\Component\\Security\\Core\\Security;\nuse Symfony\\Component\\Security\\Core\\User\\UserInterface;\nuse Symfony\\Contracts\\EventDispatcher\\EventDispatcherInterface;\n\n/**\n * @internal\n */\nclass LoginController extends AdminController implements BruteforceProtectedControllerInterface, KernelControllerEventInterface, KernelResponseEventInterface\n{\n    /**\n     * @var ResponseHelper\n     */\n    protected $reponseHelper;\n\n    public function __construct(ResponseHelper $responseHelper)\n    {\n        $this->reponseHelper = $responseHelper;\n    }\n\n    /**\n     * @param ControllerEvent $event\n     */\n    public function onKernelControllerEvent(ControllerEvent $event)\n    {\n        // use browser language for login page if possible\n        $locale = 'en';\n\n        $availableLocales = Tool\\Admin::getLanguages();\n        foreach ($event->getRequest()->getLanguages() as $userLocale) {\n            if (in_array($userLocale, $availableLocales)) {\n                $locale = $userLocale;\n\n                break;\n            }\n        }\n\n        $this->get('translator')->setLocale($locale);\n    }\n\n    /**\n     * {@inheritdoc}\n     */\n    public function onKernelResponseEvent(ResponseEvent $event)\n    {\n        $response = $event->getResponse();\n        $response->headers->set('X-Frame-Options', 'deny', true);\n        $this->reponseHelper->disableCache($response, true);\n    }\n\n    /**\n     * @Route(\"/login\", name=\"pimcore_admin_login\")\n     * @Route(\"/login/\", name=\"pimcore_admin_login_fallback\")\n     */\n    public function loginAction(Request $request, CsrfProtectionHandler $csrfProtection, Config $config)\n    {\n        if ($request->get('_route') === 'pimcore_admin_login_fallback') {\n            return $this->redirectToRoute('pimcore_admin_login', $request->query->all(), Response::HTTP_MOVED_PERMANENTLY);\n        }\n\n        $csrfProtection->regenerateCsrfToken();\n\n        $user = $this->getAdminUser();\n        if ($user instanceof UserInterface) {\n            return $this->redirectToRoute('pimcore_admin_index');\n        }\n\n        $params = $this->buildLoginPageViewParams($config);\n\n        $session_gc_maxlifetime = ini_get('session.gc_maxlifetime');\n        if (empty($session_gc_maxlifetime)) {\n            $session_gc_maxlifetime = 120;\n        }\n\n        $params['csrfTokenRefreshInterval'] = ((int)$session_gc_maxlifetime - 60) * 1000;\n\n        if ($request->get('auth_failed')) {\n            $params['error'] = 'error_auth_failed';\n        }\n        if ($request->get('session_expired')) {\n            $params['error'] = 'error_session_expired';\n        }\n        if ($request->get('deeplink')) {\n            $params['deeplink'] = true;\n        }\n\n        $params['browserSupported'] = $this->detectBrowser();\n        $params['debug'] = \\Pimcore::inDebugMode();\n\n        return $this->render('@PimcoreAdmin/Admin/Login/login.html.twig', $params);\n    }\n\n    /**\n     * @Route(\"/login/csrf-token\", name=\"pimcore_admin_login_csrf_token\")\n     */\n    public function csrfTokenAction(Request $request, CsrfProtectionHandler $csrfProtection)\n    {\n        if (!$this->getAdminUser()) {\n            $csrfProtection->regenerateCsrfToken();\n        }\n\n        return $this->json([\n           'csrfToken' => $csrfProtection->getCsrfToken(),\n        ]);\n    }\n\n    /**\n     * @Route(\"/logout\", name=\"pimcore_admin_logout\" , methods={\"POST\"})\n     */\n    public function logoutAction()\n    {\n        // this route will never be matched, but will be handled by the logout handler\n    }\n\n    /**\n     * Dummy route used to check authentication\n     *\n     * @Route(\"/login/login\", name=\"pimcore_admin_login_check\")\n     *\n     * @see AdminAuthenticator for the security implementation\n     */\n    public function loginCheckAction()\n    {\n        // just in case the authenticator didn't redirect\n        return new RedirectResponse($this->generateUrl('pimcore_admin_login'));\n    }\n\n    /**\n     * @Route(\"/login/lostpassword\", name=\"pimcore_admin_login_lostpassword\")\n     */\n    public function lostpasswordAction(Request $request, BruteforceProtectionHandler $bruteforceProtectionHandler, CsrfProtectionHandler $csrfProtection, Config $config, EventDispatcherInterface $eventDispatcher)\n    {\n        $params = $this->buildLoginPageViewParams($config);\n        $error = null;\n\n        if ($request->getMethod() === 'POST' && $username = $request->get('username')) {\n            $user = User::getByName($username);\n\n            if ($user instanceof User) {\n                if (!$user->isActive()) {\n                    $error = 'user_inactive';\n                }\n\n                if (!$user->getEmail()) {\n                    $error = 'user_no_email_address';\n                }\n\n                if (!$user->getPassword()) {\n                    $error = 'user_no_password';\n                }\n            } else {\n                $error = 'user_unknown';\n            }\n\n            if (!$error && $user instanceof User) {\n                $token = Authentication::generateToken($user->getName());\n\n                $loginUrl = $this->generateUrl('pimcore_admin_login_check', [\n                    'token' => $token,\n                    'reset' => 'true',\n                ], UrlGeneratorInterface::ABSOLUTE_URL);\n\n                try {\n                    $event = new LostPasswordEvent($user, $loginUrl);\n                    $eventDispatcher->dispatch($event, AdminEvents::LOGIN_LOSTPASSWORD);\n\n                    // only send mail if it wasn't prevented in event\n                    if ($event->getSendMail()) {\n                        $mail = Tool::getMail([$user->getEmail()], 'Pimcore lost password service');\n                        $mail->setIgnoreDebugMode(true);\n                        $mail->text(\"Login to pimcore and change your password using the following link. This temporary login link will expire in 24 hours: \\r\\n\\r\\n\" . $loginUrl);\n                        $mail->send();\n                    }\n\n                    // directly return event response\n                    if ($event->hasResponse()) {\n                        return $event->getResponse();\n                    }\n                } catch (\\Exception $e) {\n                    Logger::error('Error sending password recovery email: ' . $e->getMessage());\n                    $error = 'lost_password_email_error';\n                }\n            }\n\n            if ($error) {\n                Logger::error('Lost password service: ' . $error);\n                $bruteforceProtectionHandler->addEntry($request->get('username'), $request);\n            }\n        }\n\n        $csrfProtection->regenerateCsrfToken();\n\n        return $this->render('@PimcoreAdmin/Admin/Login/lostpassword.html.twig', $params);\n    }\n\n    /**\n     * @Route(\"/login/deeplink\", name=\"pimcore_admin_login_deeplink\")\n     */\n    public function deeplinkAction(Request $request, EventDispatcherInterface $eventDispatcher)\n    {\n        // check for deeplink\n        $queryString = $_SERVER['QUERY_STRING'];\n\n        if (preg_match('/(document|asset|object)_([0-9]+)_([a-z]+)/', $queryString, $deeplink)) {\n            $deeplink = $deeplink[0];\n            $perspective = strip_tags($request->get('perspective'));\n\n            if (strpos($queryString, 'token')) {\n                $event = new LoginRedirectEvent('pimcore_admin_login', [\n                    'deeplink' => $deeplink,\n                    'perspective' => $perspective,\n                ]);\n                $eventDispatcher->dispatch($event, AdminEvents::LOGIN_REDIRECT);\n\n                $url = $this->generateUrl($event->getRouteName(), $event->getRouteParams());\n                $url .= '&' . $queryString;\n\n                return $this->redirect($url);\n            } elseif ($queryString) {\n                $event = new LoginRedirectEvent('pimcore_admin_login', [\n                    'deeplink' => 'true',\n                    'perspective' => $perspective,\n                ]);\n                $eventDispatcher->dispatch($event, AdminEvents::LOGIN_REDIRECT);\n\n                return $this->render('@PimcoreAdmin/Admin/Login/deeplink.html.twig', [\n                    'tab' => $deeplink,\n                    'redirect' => $this->generateUrl($event->getRouteName(), $event->getRouteParams()),\n                ]);\n            }\n        }\n    }\n\n    protected function buildLoginPageViewParams(Config $config): array\n    {\n        $bundleManager = $this->get(PimcoreBundleManager::class);\n\n        return [\n            'config' => $config,\n            'pluginCssPaths' => $bundleManager->getCssPaths(),\n        ];\n    }\n\n    /**\n     * @Route(\"/login/2fa\", name=\"pimcore_admin_2fa\")\n     */\n    public function twoFactorAuthenticationAction(Request $request, BruteforceProtectionHandler $bruteforceProtectionHandler, Config $config)\n    {\n        $params = $this->buildLoginPageViewParams($config);\n\n        if ($request->hasSession()) {\n\n            // we have to call the check here manually, because BruteforceProtectionListener uses the 'username' from the request\n            $bruteforceProtectionHandler->checkProtection($this->getAdminUser()->getName(), $request);\n\n            $session = $request->getSession();\n            $authException = $session->get(Security::AUTHENTICATION_ERROR);\n            if ($authException instanceof AuthenticationException) {\n                $session->remove(Security::AUTHENTICATION_ERROR);\n\n                $params['error'] = $authException->getMessage();\n\n                $bruteforceProtectionHandler->addEntry($this->getAdminUser()->getName(), $request);\n            }\n        } else {\n            $params['error'] = 'No session available, it either timed out or cookies are not enabled.';\n        }\n\n        return $this->render('@PimcoreAdmin/Admin/Login/twoFactorAuthentication.html.twig', $params);\n    }\n\n    /**\n     * @Route(\"/login/2fa-verify\", name=\"pimcore_admin_2fa-verify\")\n     *\n     * @param Request $request\n     */\n    public function twoFactorAuthenticationVerifyAction(Request $request)\n    {\n    }\n\n    /**\n     * @return bool\n     */\n    public function detectBrowser()\n    {\n        $supported = false;\n        $browser = new \\Browser();\n        $browserVersion = (int)$browser->getVersion();\n\n        if ($browser->getBrowser() == \\Browser::BROWSER_FIREFOX && $browserVersion >= 72) {\n            $supported = true;\n        }\n        if ($browser->getBrowser() == \\Browser::BROWSER_CHROME && $browserVersion >= 84) {\n            $supported = true;\n        }\n        if ($browser->getBrowser() == \\Browser::BROWSER_SAFARI && $browserVersion >= 13.1) {\n            $supported = true;\n        }\n        if ($browser->getBrowser() == \\Browser::BROWSER_EDGE && $browserVersion >= 90) {\n            $supported = true;\n        }\n\n        return $supported;\n    }\n}\n", "{% set language = app.request.locale %}\n{# @var  \\Pimcore\\Bundle\\AdminBundle\\Security\\User\\User #}\n{% set userProxy = app.user %}\n{% set user = userProxy.user %}\n\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <meta name=\"robots\" content=\"noindex, nofollow\"/>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"/>\n    <meta name=\"apple-mobile-web-app-capable\" content=\"yes\"/>\n\n    <link rel=\"icon\" type=\"image/png\" href=\"/bundles/pimcoreadmin/img/favicon/favicon-32x32.png\"/>\n    <meta name=\"google\" value=\"notranslate\">\n\n    <style type=\"text/css\">\n        body {\n            margin: 0;\n            padding: 0;\n            background: #fff;\n        }\n\n        #pimcore_loading {\n            margin: 0 auto;\n            width: 300px;\n            padding: 300px 0 0 0;\n            text-align: center;\n        }\n\n        .spinner {\n            margin: 100px auto 0;\n            width: 70px;\n            text-align: center;\n        }\n\n        .spinner > div {\n            width: 18px;\n            height: 18px;\n            background-color: #3d3d3d;\n\n            border-radius: 100%;\n            display: inline-block;\n            -webkit-animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n            animation: sk-bouncedelay 1.4s infinite ease-in-out both;\n        }\n\n        .spinner .bounce1 {\n            -webkit-animation-delay: -0.32s;\n            animation-delay: -0.32s;\n        }\n\n        .spinner .bounce2 {\n            -webkit-animation-delay: -0.16s;\n            animation-delay: -0.16s;\n        }\n\n        @-webkit-keyframes sk-bouncedelay {\n            0%, 80%, 100% {\n                -webkit-transform: scale(0)\n            }\n            40% {\n                -webkit-transform: scale(1.0)\n            }\n        }\n\n        @keyframes sk-bouncedelay {\n            0%, 80%, 100% {\n                -webkit-transform: scale(0);\n                transform: scale(0);\n            }\n            40% {\n                -webkit-transform: scale(1.0);\n                transform: scale(1.0);\n            }\n        }\n\n        #pimcore_panel_tabs-body {\n            background-image: url({{ path('pimcore_settings_display_custom_logo') }});\n            background-repeat: no-repeat;\n            background-position: center center;\n            background-size: 500px auto;\n        }\n    </style>\n\n    <title>{{ settings.hostname }} :: Pimcore</title>\n\n    <script>\n        var pimcore = {}; // namespace\n\n        // hide symfony toolbar by default\n        var symfonyToolbarKey = 'symfony/profiler/toolbar/displayState';\n        if(!window.localStorage.getItem(symfonyToolbarKey)) {\n            window.localStorage.setItem(symfonyToolbarKey, 'none');\n        }\n    </script>\n\n    <script src=\"{{ asset('bundles/fosjsrouting/js/router.js') }}\"></script>\n    <script src=\"{{ path('fos_js_routing_js', {'callback' : 'fos.Router.setData'}) }}\"></script>\n</head>\n\n<body class=\"pimcore_version_10\" data-app-env=\"{{ app.environment }}\">\n\n<div id=\"pimcore_loading\">\n    <div class=\"spinner\">\n        <div class=\"bounce1\"></div>\n        <div class=\"bounce2\"></div>\n        <div class=\"bounce3\"></div>\n    </div>\n</div>\n{% set runtimePerspective = perspectiveConfig.getRuntimePerspective(user) %}\n\n<div id=\"pimcore_sidebar\">\n    <div id=\"pimcore_navigation\" style=\"display:none;\">\n        <ul>\n            {% set navigations = {\n                'file': {'label': 'file', 'icon': 'file'},\n                'extras': {'label': 'tools', 'icon': 'build'},\n                'marketing': {'label': 'marketing', 'icon': 'bar_chart'},\n                'settings': {'label': 'settings', 'icon': 'settings'},\n                'ecommerce': {'label': 'bundle_ecommerce_mainmenu', 'icon': 'shopping_cart', 'extraAttr': 'style=\"display: none;\"'},\n                'search': {'label': 'search', 'icon': 'search'}\n            } %}\n\n            {% set extraAttr = {'ecommerce': 'style=\"display: none;\"'} %}\n\n            {% for navKey,navData in navigations %}\n                {% if config.inPerspective(runtimePerspective, navKey) %}\n                    <li id=\"pimcore_menu_{{ navKey }}\" data-menu-tooltip=\"{{ navData[\"label\"]|trans([],'admin') }}\" class=\"pimcore_menu_item pimcore_menu_needs_children\" {{ navData[\"extraAttr\"] ?? '' }}>\n                        <img src=\"/bundles/pimcoreadmin/img/material-icons/outline-{{ navData[\"icon\"] }}-24px.svg\">\n                    </li>\n                {% endif %}\n            {% endfor %}\n            <li id=\"pimcore_menu_maintenance\" data-menu-tooltip=\"{{ \"deactivate_maintenance\"|trans([], 'admin') }}\" class=\"pimcore_menu_item \" style=\"display:none;\"></li>\n        </ul>\n    </div>\n\n    <div id=\"pimcore_status\"></div>\n\n    <div id=\"pimcore_notification\" data-menu-tooltip=\"{{ \"notifications\"|trans([],'admin') }}\" class=\"pimcore_icon_comments\">\n        <img src=\"/bundles/pimcoreadmin/img/material-icons/outline-sms-24px.svg\">\n        <span id=\"notification_value\" style=\"display:none;\"></span>\n    </div>\n\n    <div id=\"pimcore_avatar\" style=\"display:none;\">\n        <img src=\"{{ path('pimcore_admin_user_getimage') }}\" data-menu-tooltip=\"{{ user.name }} | {{ 'my_profile'|trans([],'admin') }}\"/>\n    </div>\n\n    <form id=\"pimcore_logout_form\" method=\"post\" action=\"{{ path('pimcore_admin_logout') }}\">\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken() }}\">\n\n        <a id=\"pimcore_logout\" data-menu-tooltip=\"{{ \"logout\"|trans([],'admin') }}\"\n           href=\"#\" onclick=\"document.getElementById('pimcore_logout_form').submit();\" style=\"display: none\">\n            <img src=\"/bundles/pimcoreadmin/img/material-icons/outline-logout-24px.svg\">\n        </a>\n    </form>\n    <div id=\"pimcore_signet\" data-menu-tooltip=\"Pimcore Platform ({{ settings.version }}|{{ settings.build }})\" style=\"text-indent: -10000px\">\n        BE RESPECTFUL AND HONOR OUR WORK FOR FREE & OPEN SOURCE SOFTWARE BY NOT REMOVING OUR LOGO.\n        WE OFFER YOU THE POSSIBILITY TO ADDITIONALLY ADD YOUR OWN LOGO IN PIMCORE'S SYSTEM SETTINGS. THANK YOU!\n    </div>\n</div>\n\n<div id=\"pimcore_tooltip\" style=\"display: none;\"></div>\n<div id=\"pimcore_quicksearch\"></div>\n\n{# define stylesheets #}\n\n{% set styles = [\n        path('pimcore_admin_misc_admincss'),\n        \"/bundles/pimcoreadmin/css/icons.css\",\n        \"/bundles/pimcoreadmin/js/lib/leaflet/leaflet.css\",\n        \"/bundles/pimcoreadmin/js/lib/leaflet.draw/leaflet.draw.css\",\n        \"/bundles/pimcoreadmin/extjs/css/PimcoreApp-all_1.css\",\n        \"/bundles/pimcoreadmin/extjs/css/PimcoreApp-all_2.css\",\n        \"/bundles/pimcoreadmin/css/admin.css\"\n    ]\n%}\n\n<!-- stylesheets -->\n<style type=\"text/css\">\n    {#\n     # use @import here, because if IE9 CSS file limitations (31 files)\n     # see also: http://blogs.telerik.com/blogs/posts/10-05-03/internet-explorer-css-limits.aspx\n     # @import bypasses this problem in an elegant way\n    #}\n    {% for style in styles %}\n        @import url(\"{{ style }}?_dc={{ settings.build }}\");\n    {% endfor %}\n</style>\n\n{# define scripts #}\n\n{% set debugSuffix = '' %}\n{% if settings.disableMinifyJs %}\n    {% set debugSuffix = \"-debug\" %}\n{% endif %}\n\n{# SCRIPT LIBRARIES #}\n\n{% set scriptLibs = [\n    \"lib/class.js\",\n    \"../extjs/js/ext-all\" ~ debugSuffix ~ \".js\",\n    \"lib/ext-plugins/portlet/PortalDropZone.js\",\n    \"lib/ext-plugins/portlet/Portlet.js\",\n    \"lib/ext-plugins/portlet/PortalColumn.js\",\n    \"lib/ext-plugins/portlet/PortalPanel.js\",\n    \"lib/ckeditor/ckeditor.js\",\n    \"lib/leaflet/leaflet.js\",\n    \"lib/leaflet.draw/leaflet.draw.js\",\n    \"lib/vrview/build/vrview.min.js\",\n    \"lib/ace/src-min-noconflict/ace.js\",\n    \"lib/ace/src-min-noconflict/ext-modelist.js\"\n] %}\n{% if pimcore_file_exists(constant('PIMCORE_WEB_ROOT') ~ '/bundles/pimcoreadmin/js/lib/ext-locale/locale-' ~ language ~ '.js') %}\n    {% set scriptLibs = scriptLibs|merge(['lib/ext-locale/locale-' ~ language ~ '.js']) %}\n{% endif %}\n\n{# PIMCORE SCRIPTS #}\n\n{% set scripts = [\n\n\n    \"pimcore/functions.js\",\n    \"pimcore/common.js\",\n    \"pimcore/elementservice.js\",\n    \"pimcore/helpers.js\",\n    \"pimcore/error.js\",\n\n    \"pimcore/treenodelocator.js\",\n    \"pimcore/helpers/generic-grid.js\",\n    \"pimcore/helpers/quantityValue.js\",\n    \"pimcore/overrides.js\",\n\n    \"pimcore/perspective.js\",\n    \"pimcore/user.js\",\n\n\n    \"pimcore/tool/paralleljobs.js\",\n    \"pimcore/tool/genericiframewindow.js\",\n\n\n    \"pimcore/settings/user/panels/abstract.js\",\n    \"pimcore/settings/user/panel.js\",\n\n    \"pimcore/settings/user/usertab.js\",\n    \"pimcore/settings/user/editorSettings.js\",\n    \"pimcore/settings/user/websiteTranslationSettings.js\",\n    \"pimcore/settings/user/role/panel.js\",\n    \"pimcore/settings/user/role/tab.js\",\n    \"pimcore/settings/user/user/objectrelations.js\",\n    \"pimcore/settings/user/user/settings.js\",\n    \"pimcore/settings/user/user/keyBindings.js\",\n    \"pimcore/settings/user/workspaces.js\",\n    \"pimcore/settings/user/workspace/asset.js\",\n    \"pimcore/settings/user/workspace/document.js\",\n    \"pimcore/settings/user/workspace/object.js\",\n    \"pimcore/settings/user/workspace/customlayouts.js\",\n    \"pimcore/settings/user/workspace/language.js\",\n    \"pimcore/settings/user/workspace/special.js\",\n    \"pimcore/settings/user/role/settings.js\",\n    \"pimcore/settings/profile/panel.js\",\n    \"pimcore/settings/profile/twoFactorSettings.js\",\n    \"pimcore/settings/thumbnail/item.js\",\n    \"pimcore/settings/thumbnail/panel.js\",\n    \"pimcore/settings/videothumbnail/item.js\",\n    \"pimcore/settings/videothumbnail/panel.js\",\n    \"pimcore/settings/translations.js\",\n    \"pimcore/settings/translationEditor.js\",\n    \"pimcore/settings/translation/website.js\",\n    \"pimcore/settings/translation/admin.js\",\n    \"pimcore/settings/translation/translationmerger.js\",\n    \"pimcore/settings/translation/xliff.js\",\n    \"pimcore/settings/translation/word.js\",\n    \"pimcore/settings/translation/translationSettingsTab.js\",\n    \"pimcore/settings/metadata/predefined.js\",\n    \"pimcore/settings/properties/predefined.js\",\n    \"pimcore/settings/docTypes.js\",\n    \"pimcore/settings/system.js\",\n    \"pimcore/settings/web2print.js\",\n    \"pimcore/settings/website.js\",\n    \"pimcore/settings/staticroutes.js\",\n    \"pimcore/settings/redirects.js\",\n    \"pimcore/settings/glossary.js\",\n    \"pimcore/settings/recyclebin.js\",\n    \"pimcore/settings/fileexplorer/file.js\",\n    \"pimcore/settings/fileexplorer/explorer.js\",\n    \"pimcore/settings/maintenance.js\",\n    \"pimcore/settings/robotstxt.js\",\n    \"pimcore/settings/httpErrorLog.js\",\n    \"pimcore/settings/email/log.js\",\n    \"pimcore/settings/email/blacklist.js\",\n    \"pimcore/settings/targeting/condition/abstract.js\",\n    \"pimcore/settings/targeting/conditions.js\",\n    \"pimcore/settings/targeting/action/abstract.js\",\n    \"pimcore/settings/targeting/actions.js\",\n    \"pimcore/settings/targeting/rules/panel.js\",\n    \"pimcore/settings/targeting/rules/item.js\",\n    \"pimcore/settings/targeting/targetGroups/panel.js\",\n    \"pimcore/settings/targeting/targetGroups/item.js\",\n    \"pimcore/settings/targeting_toolbar.js\",\n\n    \"pimcore/settings/gdpr/gdprPanel.js\",\n    \"pimcore/settings/gdpr/dataproviders/assets.js\",\n    \"pimcore/settings/gdpr/dataproviders/dataObjects.js\",\n    \"pimcore/settings/gdpr/dataproviders/sentMail.js\",\n    \"pimcore/settings/gdpr/dataproviders/pimcoreUsers.js\",\n\n\n    \"pimcore/element/abstract.js\",\n    \"pimcore/element/selector/selector.js\",\n    \"pimcore/element/selector/abstract.js\",\n    \"pimcore/element/selector/document.js\",\n    \"pimcore/element/selector/asset.js\",\n    \"pimcore/element/properties.js\",\n    \"pimcore/element/scheduler.js\",\n    \"pimcore/element/dependencies.js\",\n    \"pimcore/element/metainfo.js\",\n    \"pimcore/element/history.js\",\n    \"pimcore/element/notes.js\",\n    \"pimcore/element/note_details.js\",\n    \"pimcore/element/workflows.js\",\n    \"pimcore/element/tag/imagecropper.js\",\n    \"pimcore/element/tag/imagehotspotmarkereditor.js\",\n    \"pimcore/element/replace_assignments.js\",\n    \"pimcore/element/permissionchecker.js\",\n    \"pimcore/element/gridexport/abstract.js\",\n    \"pimcore/element/helpers/gridColumnConfig.js\",\n    \"pimcore/element/helpers/gridConfigDialog.js\",\n    \"pimcore/element/helpers/gridCellEditor.js\",\n    \"pimcore/element/helpers/gridTabAbstract.js\",\n    \"pimcore/object/helpers/grid.js\",\n    \"pimcore/object/helpers/gridConfigDialog.js\",\n    \"pimcore/object/helpers/classTree.js\",\n    \"pimcore/object/helpers/gridTabAbstract.js\",\n    \"pimcore/object/helpers/metadataMultiselectEditor.js\",\n    \"pimcore/object/helpers/customLayoutEditor.js\",\n    \"pimcore/object/helpers/optionEditor.js\",\n    \"pimcore/object/helpers/imageGalleryDropZone.js\",\n    \"pimcore/object/helpers/imageGalleryPanel.js\",\n    \"pimcore/element/selector/object.js\",\n    \"pimcore/element/tag/configuration.js\",\n    \"pimcore/element/tag/assignment.js\",\n    \"pimcore/element/tag/tree.js\",\n    \"pimcore/asset/helpers/metadataTree.js\",\n    \"pimcore/asset/helpers/gridConfigDialog.js\",\n    \"pimcore/asset/helpers/gridTabAbstract.js\",\n    \"pimcore/asset/helpers/grid.js\",\n\n\n    \"pimcore/document/properties.js\",\n    \"pimcore/document/document.js\",\n    \"pimcore/document/page_snippet.js\",\n    \"pimcore/document/edit.js\",\n    \"pimcore/document/versions.js\",\n    \"pimcore/document/settings_abstract.js\",\n    \"pimcore/document/pages/settings.js\",\n    \"pimcore/document/pages/preview.js\",\n    \"pimcore/document/snippets/settings.js\",\n    \"pimcore/document/emails/settings.js\",\n    \"pimcore/document/newsletters/settings.js\",\n    \"pimcore/document/newsletters/sendingPanel.js\",\n    \"pimcore/document/newsletters/plaintextPanel.js\",\n    \"pimcore/document/newsletters/addressSourceAdapters/default.js\",\n    \"pimcore/document/newsletters/addressSourceAdapters/csvList.js\",\n    \"pimcore/document/newsletters/addressSourceAdapters/report.js\",\n    \"pimcore/document/link.js\",\n    \"pimcore/document/hardlink.js\",\n    \"pimcore/document/folder.js\",\n    \"pimcore/document/tree.js\",\n    \"pimcore/document/snippet.js\",\n    \"pimcore/document/email.js\",\n    \"pimcore/document/newsletter.js\",\n    \"pimcore/document/page.js\",\n    \"pimcore/document/printpages/pdf_preview.js\",\n    \"pimcore/document/printabstract.js\",\n    \"pimcore/document/printpage.js\",\n    \"pimcore/document/printcontainer.js\",\n    \"pimcore/document/seopanel.js\",\n    \"pimcore/document/document_language_overview.js\",\n    \"pimcore/document/customviews/tree.js\",\n\n\n    \"pimcore/asset/metadata/data/data.js\",\n    \"pimcore/asset/metadata/data/input.js\",\n    \"pimcore/asset/metadata/data/textarea.js\",\n    \"pimcore/asset/metadata/data/asset.js\",\n    \"pimcore/asset/metadata/data/document.js\",\n    \"pimcore/asset/metadata/data/object.js\",\n    \"pimcore/asset/metadata/data/date.js\",\n    \"pimcore/asset/metadata/data/checkbox.js\",\n    \"pimcore/asset/metadata/data/select.js\",\n\n    \"pimcore/asset/metadata/tags/abstract.js\",\n    \"pimcore/asset/metadata/tags/checkbox.js\",\n    \"pimcore/asset/metadata/tags/date.js\",\n    \"pimcore/asset/metadata/tags/input.js\",\n    \"pimcore/asset/metadata/tags/manyToOneRelation.js\",\n    \"pimcore/asset/metadata/tags/asset.js\",\n    \"pimcore/asset/metadata/tags/document.js\",\n    \"pimcore/asset/metadata/tags/object.js\",\n    \"pimcore/asset/metadata/tags/select.js\",\n    \"pimcore/asset/metadata/tags/textarea.js\",\n    \"pimcore/asset/asset.js\",\n    \"pimcore/asset/unknown.js\",\n    \"pimcore/asset/embedded_meta_data.js\",\n    \"pimcore/asset/image.js\",\n    \"pimcore/asset/document.js\",\n    \"pimcore/asset/archive.js\",\n    \"pimcore/asset/video.js\",\n    \"pimcore/asset/audio.js\",\n    \"pimcore/asset/text.js\",\n    \"pimcore/asset/folder.js\",\n    \"pimcore/asset/listfolder.js\",\n    \"pimcore/asset/versions.js\",\n    \"pimcore/asset/metadata/dataProvider.js\",\n    \"pimcore/asset/metadata/grid.js\",\n    \"pimcore/asset/metadata/editor.js\",\n    \"pimcore/asset/tree.js\",\n    \"pimcore/asset/customviews/tree.js\",\n    \"pimcore/asset/gridexport/csv.js\",\n    \"pimcore/asset/gridexport/xlsx.js\",\n\n\n    \"pimcore/object/helpers/edit.js\",\n    \"pimcore/object/helpers/layout.js\",\n    \"pimcore/object/classes/class.js\",\n    \"pimcore/object/class.js\",\n    \"pimcore/object/bulk-base.js\",\n    \"pimcore/object/bulk-export.js\",\n    \"pimcore/object/bulk-import.js\",\n    \"pimcore/object/classes/data/data.js\",\n    \"pimcore/object/classes/data/block.js\",\n    \"pimcore/object/classes/data/classificationstore.js\",\n    \"pimcore/object/classes/data/rgbaColor.js\",\n    \"pimcore/object/classes/data/date.js\",\n    \"pimcore/object/classes/data/datetime.js\",\n    \"pimcore/object/classes/data/encryptedField.js\",\n    \"pimcore/object/classes/data/time.js\",\n    \"pimcore/object/classes/data/manyToOneRelation.js\",\n    \"pimcore/object/classes/data/image.js\",\n    \"pimcore/object/classes/data/externalImage.js\",\n    \"pimcore/object/classes/data/hotspotimage.js\",\n    \"pimcore/object/classes/data/imagegallery.js\",\n    \"pimcore/object/classes/data/video.js\",\n    \"pimcore/object/classes/data/input.js\",\n    \"pimcore/object/classes/data/numeric.js\",\n    \"pimcore/object/classes/data/manyToManyObjectRelation.js\",\n    \"pimcore/object/classes/data/advancedManyToManyRelation.js\",\n    \"pimcore/object/classes/data/advancedManyToManyObjectRelation.js\",\n    \"pimcore/object/classes/data/reverseObjectRelation.js\",\n    \"pimcore/object/classes/data/booleanSelect.js\",\n    \"pimcore/object/classes/data/select.js\",\n    \"pimcore/object/classes/data/urlSlug.js\",\n    \"pimcore/object/classes/data/user.js\",\n    \"pimcore/object/classes/data/textarea.js\",\n    \"pimcore/object/classes/data/wysiwyg.js\",\n    \"pimcore/object/classes/data/checkbox.js\",\n    \"pimcore/object/classes/data/consent.js\",\n    \"pimcore/object/classes/data/slider.js\",\n    \"pimcore/object/classes/data/manyToManyRelation.js\",\n    \"pimcore/object/classes/data/table.js\",\n    \"pimcore/object/classes/data/structuredTable.js\",\n    \"pimcore/object/classes/data/country.js\",\n    \"pimcore/object/classes/data/geo/abstract.js\",\n    \"pimcore/object/classes/data/geopoint.js\",\n    \"pimcore/object/classes/data/geobounds.js\",\n    \"pimcore/object/classes/data/geopolygon.js\",\n    \"pimcore/object/classes/data/geopolyline.js\",\n    \"pimcore/object/classes/data/language.js\",\n    \"pimcore/object/classes/data/password.js\",\n    \"pimcore/object/classes/data/multiselect.js\",\n    \"pimcore/object/classes/data/link.js\",\n    \"pimcore/object/classes/data/fieldcollections.js\",\n    \"pimcore/object/classes/data/objectbricks.js\",\n    \"pimcore/object/classes/data/localizedfields.js\",\n    \"pimcore/object/classes/data/countrymultiselect.js\",\n    \"pimcore/object/classes/data/languagemultiselect.js\",\n    \"pimcore/object/classes/data/firstname.js\",\n    \"pimcore/object/classes/data/lastname.js\",\n    \"pimcore/object/classes/data/email.js\",\n    \"pimcore/object/classes/data/gender.js\",\n    \"pimcore/object/classes/data/newsletterActive.js\",\n    \"pimcore/object/classes/data/newsletterConfirmed.js\",\n    \"pimcore/object/classes/data/targetGroup.js\",\n    \"pimcore/object/classes/data/targetGroupMultiselect.js\",\n    \"pimcore/object/classes/data/quantityValue.js\",\n    \"pimcore/object/classes/data/inputQuantityValue.js\",\n    \"pimcore/object/classes/data/calculatedValue.js\",\n    \"pimcore/object/classes/layout/layout.js\",\n    \"pimcore/object/classes/layout/accordion.js\",\n    \"pimcore/object/classes/layout/fieldset.js\",\n    \"pimcore/object/classes/layout/fieldcontainer.js\",\n    \"pimcore/object/classes/layout/panel.js\",\n    \"pimcore/object/classes/layout/region.js\",\n    \"pimcore/object/classes/layout/tabpanel.js\",\n    \"pimcore/object/classes/layout/button.js\",\n    \"pimcore/object/classes/layout/iframe.js\",\n    \"pimcore/object/fieldlookup/filterdialog.js\",\n    \"pimcore/object/fieldlookup/helper.js\",\n    \"pimcore/object/classes/layout/text.js\",\n    \"pimcore/object/fieldcollection.js\",\n    \"pimcore/object/fieldcollections/field.js\",\n    \"pimcore/object/gridcolumn/Abstract.js\",\n    \"pimcore/object/gridcolumn/operator/IsEqual.js\",\n    \"pimcore/object/gridcolumn/operator/Text.js\",\n    \"pimcore/object/gridcolumn/operator/Anonymizer.js\",\n    \"pimcore/object/gridcolumn/operator/AnyGetter.js\",\n    \"pimcore/object/gridcolumn/operator/AssetMetadataGetter.js\",\n    \"pimcore/object/gridcolumn/operator/Arithmetic.js\",\n    \"pimcore/object/gridcolumn/operator/Boolean.js\",\n    \"pimcore/object/gridcolumn/operator/BooleanFormatter.js\",\n    \"pimcore/object/gridcolumn/operator/CaseConverter.js\",\n    \"pimcore/object/gridcolumn/operator/CharCounter.js\",\n    \"pimcore/object/gridcolumn/operator/Concatenator.js\",\n    \"pimcore/object/gridcolumn/operator/DateFormatter.js\",\n    \"pimcore/object/gridcolumn/operator/ElementCounter.js\",\n    \"pimcore/object/gridcolumn/operator/Iterator.js\",\n    \"pimcore/object/gridcolumn/operator/JSON.js\",\n    \"pimcore/object/gridcolumn/operator/LocaleSwitcher.js\",\n    \"pimcore/object/gridcolumn/operator/Merge.js\",\n    \"pimcore/object/gridcolumn/operator/ObjectFieldGetter.js\",\n    \"pimcore/object/gridcolumn/operator/PHP.js\",\n    \"pimcore/object/gridcolumn/operator/PHPCode.js\",\n    \"pimcore/object/gridcolumn/operator/Base64.js\",\n    \"pimcore/object/gridcolumn/operator/TranslateValue.js\",\n    \"pimcore/object/gridcolumn/operator/PropertyGetter.js\",\n    \"pimcore/object/gridcolumn/operator/RequiredBy.js\",\n    \"pimcore/object/gridcolumn/operator/StringContains.js\",\n    \"pimcore/object/gridcolumn/operator/StringReplace.js\",\n    \"pimcore/object/gridcolumn/operator/Substring.js\",\n    \"pimcore/object/gridcolumn/operator/LFExpander.js\",\n    \"pimcore/object/gridcolumn/operator/Trimmer.js\",\n    \"pimcore/object/gridcolumn/operator/Alias.js\",\n    \"pimcore/object/gridcolumn/operator/WorkflowState.js\",\n    \"pimcore/object/gridcolumn/value/DefaultValue.js\",\n    \"pimcore/object/gridcolumn/operator/GeopointRenderer.js\",\n    \"pimcore/object/gridcolumn/operator/ImageRenderer.js\",\n    \"pimcore/object/gridcolumn/operator/HotspotimageRenderer.js\",\n    \"pimcore/object/importcolumn/Abstract.js\",\n    \"pimcore/object/importcolumn/operator/Base64.js\",\n    \"pimcore/object/importcolumn/operator/Ignore.js\",\n    \"pimcore/object/importcolumn/operator/Iterator.js\",\n    \"pimcore/object/importcolumn/operator/LocaleSwitcher.js\",\n    \"pimcore/object/importcolumn/operator/ObjectBrickSetter.js\",\n    \"pimcore/object/importcolumn/operator/PHPCode.js\",\n    \"pimcore/object/importcolumn/operator/Published.js\",\n    \"pimcore/object/importcolumn/operator/Splitter.js\",\n    \"pimcore/object/importcolumn/operator/Unserialize.js\",\n    \"pimcore/object/importcolumn/value/DefaultValue.js\",\n    \"pimcore/object/objectbrick.js\",\n    \"pimcore/object/objectbricks/field.js\",\n    \"pimcore/object/tags/abstract.js\",\n    \"pimcore/object/tags/abstractRelations.js\",\n    \"pimcore/object/tags/block.js\",\n    \"pimcore/object/tags/rgbaColor.js\",\n    \"pimcore/object/tags/date.js\",\n    \"pimcore/object/tags/datetime.js\",\n    \"pimcore/object/tags/time.js\",\n    \"pimcore/object/tags/manyToOneRelation.js\",\n    \"pimcore/object/tags/image.js\",\n    \"pimcore/object/tags/encryptedField.js\",\n    \"pimcore/object/tags/externalImage.js\",\n    \"pimcore/object/tags/hotspotimage.js\",\n    \"pimcore/object/tags/imagegallery.js\",\n    \"pimcore/object/tags/video.js\",\n    \"pimcore/object/tags/input.js\",\n    \"pimcore/object/tags/classificationstore.js\",\n    \"pimcore/object/tags/numeric.js\",\n    \"pimcore/object/tags/manyToManyObjectRelation.js\",\n    \"pimcore/object/tags/advancedManyToManyRelation.js\",\n    \"pimcore/object/gridcolumn/operator/FieldCollectionGetter.js\",\n    \"pimcore/object/tags/advancedManyToManyObjectRelation.js\",\n    \"pimcore/object/tags/reverseObjectRelation.js\",\n    \"pimcore/object/tags/urlSlug.js\",\n    \"pimcore/object/tags/booleanSelect.js\",\n    \"pimcore/object/tags/select.js\",\n    \"pimcore/object/tags/user.js\",\n    \"pimcore/object/tags/checkbox.js\",\n    \"pimcore/object/tags/consent.js\",\n    \"pimcore/object/tags/textarea.js\",\n    \"pimcore/object/tags/wysiwyg.js\",\n    \"pimcore/object/tags/slider.js\",\n    \"pimcore/object/tags/manyToManyRelation.js\",\n    \"pimcore/object/tags/table.js\",\n    \"pimcore/object/tags/structuredTable.js\",\n    \"pimcore/object/tags/country.js\",\n    \"pimcore/object/tags/geo/abstract.js\",\n    \"pimcore/object/tags/geobounds.js\",\n    \"pimcore/object/tags/geopoint.js\",\n    \"pimcore/object/tags/geopolygon.js\",\n    \"pimcore/object/tags/geopolyline.js\",\n    \"pimcore/object/tags/language.js\",\n    \"pimcore/object/tags/password.js\",\n    \"pimcore/object/tags/multiselect.js\",\n    \"pimcore/object/tags/link.js\",\n    \"pimcore/object/tags/fieldcollections.js\",\n    \"pimcore/object/tags/localizedfields.js\",\n    \"pimcore/object/tags/countrymultiselect.js\",\n    \"pimcore/object/tags/languagemultiselect.js\",\n    \"pimcore/object/tags/objectbricks.js\",\n    \"pimcore/object/tags/firstname.js\",\n    \"pimcore/object/tags/lastname.js\",\n    \"pimcore/object/tags/email.js\",\n    \"pimcore/object/tags/gender.js\",\n    \"pimcore/object/tags/newsletterActive.js\",\n    \"pimcore/object/tags/newsletterConfirmed.js\",\n    \"pimcore/object/tags/targetGroup.js\",\n    \"pimcore/object/tags/targetGroupMultiselect.js\",\n    \"pimcore/object/tags/quantityValue.js\",\n    \"pimcore/object/tags/inputQuantityValue.js\",\n    \"pimcore/object/tags/calculatedValue.js\",\n    \"pimcore/object/preview.js\",\n    \"pimcore/object/versions.js\",\n    \"pimcore/object/variantsTab.js\",\n    \"pimcore/object/folder/search.js\",\n    \"pimcore/object/edit.js\",\n    \"pimcore/object/abstract.js\",\n    \"pimcore/object/object.js\",\n    \"pimcore/object/folder.js\",\n    \"pimcore/object/variant.js\",\n    \"pimcore/object/tree.js\",\n    \"pimcore/object/layout/iframe.js\",\n    \"pimcore/object/customviews/tree.js\",\n    \"pimcore/object/quantityvalue/unitsettings.js\",\n    \"pimcore/object/gridexport/csv.js\",\n    \"pimcore/object/gridexport/xlsx.js\",\n\n\n    \"pimcore/plugin/broker.js\",\n    \"pimcore/plugin/plugin.js\",\n\n    \"pimcore/event-dispatcher.js\",\n\n\n    \"pimcore/report/panel.js\",\n    \"pimcore/report/broker.js\",\n    \"pimcore/report/abstract.js\",\n    \"pimcore/report/settings.js\",\n    \"pimcore/report/analytics/settings.js\",\n    \"pimcore/report/analytics/elementoverview.js\",\n    \"pimcore/report/analytics/elementexplorer.js\",\n    \"pimcore/report/webmastertools/settings.js\",\n    \"pimcore/report/tagmanager/settings.js\",\n    \"pimcore/report/custom/item.js\",\n    \"pimcore/report/custom/panel.js\",\n    \"pimcore/report/custom/settings.js\",\n    \"pimcore/report/custom/report.js\",\n    \"pimcore/report/custom/definitions/sql.js\",\n    \"pimcore/report/custom/definitions/analytics.js\",\n    \"pimcore/report/custom/toolbarenricher.js\",\n\n    \"pimcore/extensionmanager/admin.js\",\n\n\n    \"pimcore/log/admin.js\",\n    \"pimcore/log/detailwindow.js\",\n\n\n    \"pimcore/layout/portal.js\",\n    \"pimcore/layout/portlets/abstract.js\",\n    \"pimcore/layout/portlets/modifiedDocuments.js\",\n    \"pimcore/layout/portlets/modifiedObjects.js\",\n    \"pimcore/layout/portlets/modifiedAssets.js\",\n    \"pimcore/layout/portlets/modificationStatistic.js\",\n    \"pimcore/layout/portlets/analytics.js\",\n    \"pimcore/layout/portlets/customreports.js\",\n\n    \"pimcore/layout/toolbar.js\",\n    \"pimcore/layout/treepanelmanager.js\",\n    \"pimcore/document/seemode.js\",\n\n\n    \"pimcore/object/classificationstore/groupsPanel.js\",\n    \"pimcore/object/classificationstore/propertiesPanel.js\",\n    \"pimcore/object/classificationstore/collectionsPanel.js\",\n    \"pimcore/object/classificationstore/keyDefinitionWindow.js\",\n    \"pimcore/object/classificationstore/keySelectionWindow.js\",\n    \"pimcore/object/classificationstore/relationSelectionWindow.js\",\n    \"pimcore/object/classificationstore/storeConfiguration.js\",\n    \"pimcore/object/classificationstore/storeTree.js\",\n    \"pimcore/object/classificationstore/columnConfigDialog.js\",\n\n\n    \"pimcore/workflow/transitionPanel.js\",\n    \"pimcore/workflow/transitions.js\",\n    \"pimcore/workflow/transitions.js\",\n\n\n    \"pimcore/colorpicker-overrides.js\",\n\n\n    \"pimcore/notification/helper.js\",\n    \"pimcore/notification/panel.js\",\n    \"pimcore/notification/modal.js\",\n]\n%}\n\n<!-- some javascript -->\n{# pimcore constants #}\n<script>\n    pimcore.settings = {{(settings|json_encode(constant('JSON_PRETTY_PRINT'))|raw)}};\n</script>\n\n<script src=\"{{ path('pimcore_admin_misc_jsontranslationssystem', {'language': language, '_dc': settings.build }) }}\"></script>\n<script src=\"{{ path('pimcore_admin_user_getcurrentuser', {'_dc': settings.build }) }}\"></script>\n<script src=\"{{ path('pimcore_admin_misc_availablelanguages', {'_dc': settings.build }) }}\"></script>\n\n<!-- library scripts -->\n{% for scriptUrl in scriptLibs %}\n    <script src=\"/bundles/pimcoreadmin/js/{{ scriptUrl }}?_dc={{ settings.build }}\"></script>\n{% endfor %}\n\n<!-- internal scripts -->\n{% if settings.disableMinifyJs %}\n    {% for scriptUrl in scripts %}\n        <script src=\"/bundles/pimcoreadmin/js/{{ scriptUrl }}?_dc={{ settings.build }}\"></script>\n    {% endfor %}\n{% else %}\n    {{ pimcore_minimize_scripts(scripts)|raw }}\n{% endif %}\n\n{# load plugin scripts #}\n\n{# // only add the timestamp if the devmode is not activated, otherwise it is very hard to develop and debug plugins,\n # // because the filename changes on every reload and therefore breakpoints, ... are resetted on every reload\n#}\n\n{% set pluginDcValue = \"now\"|date('U') %}\n{% if settings.disableMinifyJs %}\n    {% set pluginDcValue = 1 %}\n{% endif %}\n\n<!-- bundle scripts -->\n{% if settings.disableMinifyJs %}\n    {% for pluginJsPath in pluginJsPaths %}\n        <script src=\"{{ pluginJsPath }}?_dc={{ pluginDcValue }}\"></script>\n    {% endfor %}\n{% else %}\n    {{ pimcore_minimize_scripts(pluginJsPaths)|raw }}\n{% endif %}\n\n{% for pluginCssPath in pluginCssPaths %}\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"{{ pluginCssPath }}?_dc={{ pluginDcValue }}\"/>\n{% endfor %}\n\n{#  MUST BE THE LAST LINE  #}\n<script src=\"/bundles/pimcoreadmin/js/pimcore/startup.js?_dc={{ settings.build }}\"></script>\n</body>\n</html>\n", "{% extends '@PimcoreAdmin/Admin/Login/layout.html.twig' %}\n\n{% block content %}\n    {% if error is defined %}\n        <div class=\"text error\">\n            {{ error|trans([],'admin')|raw }}\n        </div>\n    {% else %}\n        <div class=\"text info\">\n            {{ 'Enter your verification code'|trans([],'admin') }}\n        </div>\n    {% endif %}\n\n    <form method=\"post\" action=\"{{ path('pimcore_admin_2fa-verify') }}\">\n        <input name=\"_auth_code\" id=\"_auth_code\" autocomplete=\"one-time-code\" type=\"password\" placeholder=\"{{ '2fa_code'|trans([],'admin') }}\" required autofocus>\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken() }}\">\n\n        <button type=\"submit\">{{ 'Login'|trans([],'admin') }}</button>\n    </form>\n\n    <form id=\"pimcore_logout_form\" method=\"post\" action=\"{{ path('pimcore_admin_logout') }}\">\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken() }}\">\n        <a href=\"#\" onclick=\"document.getElementById('pimcore_logout_form').submit();\">{{ 'Back to Login'|trans([],'admin') }}</a>\n    </form>\n\n\n\n    {{ pimcore_breach_attack_random_content() }}\n{% endblock %}\n\n\n\n"], "filenames": ["bundles/AdminBundle/Controller/Admin/LoginController.php", "bundles/AdminBundle/Resources/views/Admin/Index/index.html.twig", "bundles/AdminBundle/Resources/views/Admin/Login/twoFactorAuthentication.html.twig"], "buggy_code_start_loc": [148, 148, 21], "buggy_code_end_loc": [149, 151, 22], "fixing_code_start_loc": [148, 148, 21], "fixing_code_end_loc": [149, 157, 27], "type": "CWE-352", "message": "pimcore is vulnerable to Cross-Site Request Forgery (CSRF)", "other": {"cve": {"id": "CVE-2021-4082", "sourceIdentifier": "security@huntr.dev", "published": "2021-12-10T11:15:07.693", "lastModified": "2021-12-13T20:01:36.237", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "pimcore is vulnerable to Cross-Site Request Forgery (CSRF)"}, {"lang": "es", "value": "pimcore es vulnerable a un ataque de tipo Cross-Site Request Forgery (CSRF)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pimcore:pimcore:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.2.6", "matchCriteriaId": "E8D98DAD-EBC5-470A-9F38-2A963406010F"}]}]}], "references": [{"url": "https://github.com/pimcore/pimcore/commit/3088cec7dc3cbc5a8b26f1269e398e799ee7ee28", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/81838575-e170-41fb-b451-92c1c8aab092", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/pimcore/pimcore/commit/3088cec7dc3cbc5a8b26f1269e398e799ee7ee28"}}