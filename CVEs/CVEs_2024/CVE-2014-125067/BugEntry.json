{"buggy_code": ["# See https://help.github.com/articles/ignoring-files for more about ignoring files.\n#\n# If you find yourself ignoring temporary files generated by your text editor\n# or operating system, you probably want to add a global ignore instead:\n#   git config --global core.excludesfile '~/.gitignore_global'\n\n# Ignore bundler config.\n/.bundle\n\n# Ignore the default SQLite database.\n/db/*.sqlite3\n/db/*.sqlite3-journal\n\n# Ignore all logfiles and tempfiles.\n/log/*.log\n/tmp\n.env\n", "class ImageController < ApplicationController\n  def show\n    @images = Image.where(sol: params[:sol])\n  end\n\n  def index\n    # find the martial solar date of the most recent image taken\n    # @most_recent = Image.all.sort_by { |hash| -hash[:sol].to_i }.first[:sol]\n    @image_count = Image.count\n    @most_recent = Image.maximum(:sol)\n  end\nend\n", "<div class='row'>\n  <div class='small 6'>\n    <p>\n      These photos were captured by Curiosity on sol <%= params[:sol] %> of its mission on Mars. They come from its eight cameras: the front hazard avoidance camera (FHAZ), read hazard avoidance camera (RHAZ), left and right navigation cameras (NAVCAM), chemistry camera (CHEMCAM), Mars descent imager (MARDI), Mars hand lens imager (MAHLI), and mast camera (Mastcam).\n    </p>\n  </div>\n</div>\n\n<% @images.each do |image| %>\n  <div class=\"row\">\n    <div class='small-8 columns centered'>\n      <div><%= image[:camera] %></div>\n      <a href='<%= image[:img_src] %>'><img src='<%= image[:img_src] %>'/></a>\n    </div>\n  </div>\n<% end %>\n"], "fixing_code": ["# See https://help.github.com/articles/ignoring-files for more about ignoring files.\n#\n# If you find yourself ignoring temporary files generated by your text editor\n# or operating system, you probably want to add a global ignore instead:\n#   git config --global core.excludesfile '~/.gitignore_global'\n\n# Ignore bundler config.\n/.bundle\n\n# Ignore the default SQLite database.\n/db/*.sqlite3\n/db/*.sqlite3-journal\n\n# Ignore all logfiles and tempfiles.\n/log/*.log\n/tmp\n.env\nimages.rb\n", "class ImageController < ApplicationController\n  def show\n    @images = Image.where(:sol => params[:sol])\n  end\n\n  def index\n    # find the martian solar date of the most recent image taken\n    @image_count = Image.count\n    @most_recent = Image.maximum(:sol)\n  end\nend\n", "<div class='row'>\n  <div class='small 6'>\n    <p>\n      These photos were captured by Curiosity on sol <%=h params[:sol] %> of its mission on Mars. They come from its eight cameras: the front hazard avoidance camera (FHAZ), read hazard avoidance camera (RHAZ), left and right navigation cameras (NAVCAM), chemistry camera (CHEMCAM), Mars descent imager (MARDI), Mars hand lens imager (MAHLI), and mast camera (Mastcam).\n    </p>\n  </div>\n</div>\n\n<% @images.each do |image| %>\n  <div class=\"row\">\n    <div class='small-8 columns centered'>\n      <div><%= image[:camera] %></div>\n      <a href='<%= image[:img_src] %>'><img src='<%= image[:img_src] %>'/></a>\n    </div>\n  </div>\n<% end %>\n"], "filenames": [".gitignore", "app/controllers/image_controller.rb", "app/views/image/show.html.erb"], "buggy_code_start_loc": [17, 3, 4], "buggy_code_end_loc": [17, 9, 5], "fixing_code_start_loc": [18, 3, 4], "fixing_code_end_loc": [19, 8, 5], "type": "CWE-89", "message": "A vulnerability classified as critical was found in corincerami curiosity. Affected by this vulnerability is an unknown functionality of the file app/controllers/image_controller.rb. The manipulation of the argument sol leads to sql injection. The name of the patch is d64fddd74ca72714e73f4efe24259ca05c8190eb. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217639.", "other": {"cve": {"id": "CVE-2014-125067", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-08T10:15:11.433", "lastModified": "2023-01-12T17:27:08.113", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as critical was found in corincerami curiosity. Affected by this vulnerability is an unknown functionality of the file app/controllers/image_controller.rb. The manipulation of the argument sol leads to sql injection. The name of the patch is d64fddd74ca72714e73f4efe24259ca05c8190eb. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217639."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:curiosity_project:curiosity:*:*:*:*:*:*:*:*", "versionEndExcluding": "12-07-2014", "matchCriteriaId": "A3174365-DEE6-4EA9-BEC4-56152EFB7B00"}]}]}], "references": [{"url": "https://github.com/corincerami/curiosity/commit/d64fddd74ca72714e73f4efe24259ca05c8190eb", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217639", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217639", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/corincerami/curiosity/commit/d64fddd74ca72714e73f4efe24259ca05c8190eb"}}