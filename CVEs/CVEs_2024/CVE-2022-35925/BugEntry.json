{"buggy_code": ["include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen 80;\n\n    location / {\n        proxy_pass http://web;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host;\n        proxy_redirect off;\n    }\n\n    location /images/ {\n        alias /app/images/;\n    }\n\n    location /static/ {\n        alias /app/static/;\n    }\n}\n", "include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen [::]:80;\n    listen 80;\n\n    server_name your-domain.com www.your-domain.com;\n\n    location ~ /.well-known/acme-challenge {\n        allow all;\n        root /var/www/certbot;\n    }\n\n#     # redirect http to https\n#     return 301 https://your-domain.com$request_uri;\n}\n\n#\n# server {\n#     listen [::]:443 ssl http2;\n#     listen 443 ssl http2;\n#\n#     server_name your-domain.com;\n#\n#     client_max_body_size 3M;\n#\n#     if ($host != \"your-domain.com\") {\n#         return 301 $scheme://your-domain.com$request_uri;\n#     }\n#\n#     # SSL code\n#     ssl_certificate /etc/nginx/ssl/live/your-domain.com/fullchain.pem;\n#     ssl_certificate_key /etc/nginx/ssl/live/your-domain.com/privkey.pem;\n#\n#     location ~ /.well-known/acme-challenge {\n#         allow all;\n#         root /var/www/certbot;\n#     }\n#\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n#\n#     location /images/ {\n#         alias /app/images/;\n#     }\n#\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n\n# Reverse-Proxy server\n# server {\n#     listen [::]:8001;\n#     listen 8001;\n\n#     server_name your-domain.com www.your-domain.com;\n\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n\n#     location /images/ {\n#         alias /app/images/;\n#     }\n\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n", "client_max_body_size 10m;\n"], "fixing_code": ["include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen 80;\n\n    location ~ ^/(login|password-reset|resend-link) {\n        limit_req zone=loginlimit;\n\n        proxy_pass http://web;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host;\n        proxy_redirect off;\n    }\n\n    location / {\n        proxy_pass http://web;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host;\n        proxy_redirect off;\n    }\n\n    location /images/ {\n        alias /app/images/;\n    }\n\n    location /static/ {\n        alias /app/static/;\n    }\n}\n", "include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen [::]:80;\n    listen 80;\n\n    server_name your-domain.com www.your-domain.com;\n\n    location ~ /.well-known/acme-challenge {\n        allow all;\n        root /var/www/certbot;\n    }\n\n#     # redirect http to https\n#     return 301 https://your-domain.com$request_uri;\n}\n\n#\n# server {\n#     listen [::]:443 ssl http2;\n#     listen 443 ssl http2;\n#\n#     server_name your-domain.com;\n#\n#     client_max_body_size 3M;\n#\n#     if ($host != \"your-domain.com\") {\n#         return 301 $scheme://your-domain.com$request_uri;\n#     }\n#\n#     # SSL code\n#     ssl_certificate /etc/nginx/ssl/live/your-domain.com/fullchain.pem;\n#     ssl_certificate_key /etc/nginx/ssl/live/your-domain.com/privkey.pem;\n#\n#     location ~ /.well-known/acme-challenge {\n#         allow all;\n#         root /var/www/certbot;\n#     }\n#\n#     location ~ ^/(login|password-reset|resend-link) {\n#         limit_req zone=loginlimit;\n#\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n#\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n#\n#     location /images/ {\n#         alias /app/images/;\n#     }\n#\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n\n# Reverse-Proxy server\n# server {\n#     listen [::]:8001;\n#     listen 8001;\n\n#     server_name your-domain.com www.your-domain.com;\n\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n\n#     location /images/ {\n#         alias /app/images/;\n#     }\n\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n", "client_max_body_size 10m;\nlimit_req_zone $binary_remote_addr zone=loginlimit:10m rate=1r/s;\n"], "filenames": ["nginx/development", "nginx/production", "nginx/server_config"], "buggy_code_start_loc": [8, 43, 1], "buggy_code_end_loc": [8, 43, 1], "fixing_code_start_loc": [9, 44, 2], "fixing_code_end_loc": [18, 53, 3], "type": "CWE-287", "message": "BookWyrm is a social network for tracking reading. Versions prior to 0.4.5 were found to lack rate limiting on authentication views which allows brute-force attacks. This issue has been patched in version 0.4.5. Admins with existing instances will need to update their `nginx.conf` file that was created when the instance was set up. Users are advised advised to upgrade. Users unable to upgrade may update their nginx.conf files with the changes manually.", "other": {"cve": {"id": "CVE-2022-35925", "sourceIdentifier": "security-advisories@github.com", "published": "2022-08-02T21:15:08.177", "lastModified": "2022-08-08T19:52:49.520", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "BookWyrm is a social network for tracking reading. Versions prior to 0.4.5 were found to lack rate limiting on authentication views which allows brute-force attacks. This issue has been patched in version 0.4.5. Admins with existing instances will need to update their `nginx.conf` file that was created when the instance was set up. Users are advised advised to upgrade. Users unable to upgrade may update their nginx.conf files with the changes manually."}, {"lang": "es", "value": "BookWyrm es una red social de seguimiento de la lectura. Se ha detectado que las versiones anteriores a 0.4.5 carecen de limitaci\u00f3n de velocidad en las visualizaciones de autenticaci\u00f3n, lo que permite ataques de fuerza bruta. Este problema ha sido parcheado en versi\u00f3n 0.4.5. Los administradores con instancias existentes tendr\u00e1n que actualizar su archivo \"nginx.conf\" que fue creado cuando fue configurada la instancia. Es recomendado a usuarios actualizar. Los usuarios que no puedan actualizar, pueden actualizar sus archivos nginx.conf con los cambios manualmente"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:joinbookwyrm:bookwyrm:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.4.5", "matchCriteriaId": "D72588D8-BF2B-42A3-8DD6-FE4381B2C502"}]}]}], "references": [{"url": "https://github.com/bookwyrm-social/bookwyrm/security/advisories/GHSA-jvp3-mqv8-5rjw", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/ebee593d-3fd0-4985-bf5e-7e7927e08bf6/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.github.com/bookwyrm-social/bookwyrm/commit/7bbe42fb30a79a26115524d18b697d895563c92f", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://www.github.com/bookwyrm-social/bookwyrm/commit/7bbe42fb30a79a26115524d18b697d895563c92f"}}