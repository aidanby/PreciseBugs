{"buggy_code": ["<div class='col-lg-12'>\n    <div class='pagetitle h3'><?php eT('Confirm uploaded plugin'); ?></div>\n\n    <?php // Only show config summary if config could be found. ?>\n    <?php if (isset($config)): ?>\n\n        <?php echo CHtml::form(\n            Yii::app()->getController()->createUrl(\n                '/admin/pluginmanager',\n                [\n                    'sa'       => 'installUploadedPlugin'\n                ]\n            ),\n            'post'\n        ); ?>\n\n            <input type=\"hidden\" name=\"isUpdate\" value=\"<?php echo json_encode($isUpdate); ?>\" />\n\n            <?php if ($isUpdate): ?>\n                <div class='alert alert-info'>\n                    <p>\n                        <i class='fa fa-info'></i>&nbsp;\n                        <?php eT('The following plugin will be updated. Please click \"Update\" to update the plugin, or \"Abort\" to abort.'); ?>\n                    </p>\n                </div>\n            <?php else: ?>\n                <div class='alert alert-info'>\n                    <p>\n                        <i class='fa fa-info'></i>&nbsp;\n                        <?php eT('The following plugin will be installed. Please click \"Install\" to install the plugin, or \"Abort\" to abort. Aborting will remove the files from the file system.'); ?>\n                    </p>\n                </div>\n            <?php endif; ?>\n\n            <!-- Name -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Name:\"); ?></label>\n                <div class=\"col-sm-4\"><?php echo $config->getName(); ?></div>\n            </div>\n\n            <!-- Description -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Description:\"); ?></label>\n                <div class=\"col-sm-8\"><?php echo $config->getDescription(); ?></div>\n            </div>\n\n            <!-- Version -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Version:\"); ?></label>\n                <div class=\"col-sm-4\"><?php echo $config->getVersion(); ?></div>\n            </div>\n\n            <!-- Author -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Author:\"); ?></label>\n                <div class=\"col-sm-4\"><?php echo $config->getAuthor(); ?></div>\n            </div>\n\n            <!-- Compatible -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Compatible\"); ?></label>\n                <?php if ($config->isCompatible()): ?>\n                    <div class=\"col-sm-4\"><span class=\"fa fa-check text-success\"></span></div>\n                <?php else: ?>\n                    <div class=\"col-sm-4\"><span class=\"fa fa-times text-warning\"></span></div>\n                <?php endif; ?>\n            </div>\n\n            <!-- Buttons -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"></label>\n                <div class=\"col-sm-4\">\n                    <?php if ($isUpdate): ?>\n                        <input type=\"submit\" class=\"btn btn-success\" value=\"<?php eT(\"Update\");?>\" />\n                    <?php else: ?>\n                        <input type=\"submit\" class=\"btn btn-success\" value=\"<?php eT(\"Install\");?>\" />\n                    <?php endif; ?>\n                    <a href=\"<?php echo $abortUrl; ?>\" class=\"btn btn-warning\" data-dismiss=\"modal\"><?php eT(\"Abort\");?></a>\n                </div>\n            </div>\n\n        </form>\n\n    <?php else: ?>\n\n        <div class='alert alert-warning'>\n            <p>\n            <i class='fa fa-warning'></i>&nbsp;\n            <?php eT('Error: Found no configuration for plugin. Please contact the plugin author.'); ?>\n            </p>\n        </div>\n\n    <?php endif; ?>\n</div>\n"], "fixing_code": ["<div class='col-lg-12'>\n    <div class='pagetitle h3'><?php eT('Confirm uploaded plugin'); ?></div>\n\n    <?php // Only show config summary if config could be found. ?>\n    <?php if (isset($config)) : ?>\n        <?php echo CHtml::form(\n            Yii::app()->getController()->createUrl(\n                '/admin/pluginmanager',\n                [\n                    'sa'       => 'installUploadedPlugin'\n                ]\n            ),\n            'post'\n        ); ?>\n\n            <input type=\"hidden\" name=\"isUpdate\" value=\"<?php echo json_encode($isUpdate); ?>\" />\n\n            <?php if ($isUpdate) : ?>\n                <div class='alert alert-info'>\n                    <p>\n                        <i class='fa fa-info'></i>&nbsp;\n                        <?php eT('The following plugin will be updated. Please click \"Update\" to update the plugin, or \"Abort\" to abort.'); ?>\n                    </p>\n                </div>\n            <?php else : ?>\n                <div class='alert alert-info'>\n                    <p>\n                        <i class='fa fa-info'></i>&nbsp;\n                        <?php eT('The following plugin will be installed. Please click \"Install\" to install the plugin, or \"Abort\" to abort. Aborting will remove the files from the file system.'); ?>\n                    </p>\n                </div>\n            <?php endif; ?>\n\n            <!-- Name -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Name:\"); ?></label>\n                <div class=\"col-sm-4\"><?=htmlentities($config->getName()); ?></div>\n            </div>\n\n            <!-- Description -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Description:\"); ?></label>\n                <div class=\"col-sm-8\"><?=htmlentities($config->getDescription()); ?></div>\n            </div>\n\n            <!-- Version -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Version:\"); ?></label>\n                <div class=\"col-sm-4\"><?=htmlentities($config->getVersion()); ?></div>\n            </div>\n\n            <!-- Author -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Author:\"); ?></label>\n                <div class=\"col-sm-4\"><?=htmlentities($config->getAuthor()); ?></div>\n            </div>\n\n            <!-- Compatible -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"><?php eT(\"Compatible\"); ?></label>\n                <?php if ($config->isCompatible()) : ?>\n                    <div class=\"col-sm-4\"><span class=\"fa fa-check text-success\"></span></div>\n                <?php else : ?>\n                    <div class=\"col-sm-4\"><span class=\"fa fa-times text-warning\"></span></div>\n                <?php endif; ?>\n            </div>\n\n            <!-- Buttons -->\n            <div class=\"form-group col-sm-12\">\n                <label class=\"col-sm-4 control-label\"></label>\n                <div class=\"col-sm-4\">\n                    <?php if ($isUpdate) : ?>\n                        <input type=\"submit\" class=\"btn btn-success\" value=\"<?php eT(\"Update\");?>\" />\n                    <?php else : ?>\n                        <input type=\"submit\" class=\"btn btn-success\" value=\"<?php eT(\"Install\");?>\" />\n                    <?php endif; ?>\n                    <a href=\"<?php echo $abortUrl; ?>\" class=\"btn btn-warning\" data-dismiss=\"modal\"><?php eT(\"Abort\");?></a>\n                </div>\n            </div>\n\n        </form>\n\n    <?php else : ?>\n        <div class='alert alert-warning'>\n            <p>\n            <i class='fa fa-warning'></i>&nbsp;\n            <?php eT('Error: Found no configuration for plugin. Please contact the plugin author.'); ?>\n            </p>\n        </div>\n\n    <?php endif; ?>\n</div>\n"], "filenames": ["application/views/admin/pluginmanager/uploadConfirm.php"], "buggy_code_start_loc": [5], "buggy_code_end_loc": [86], "fixing_code_start_loc": [5], "fixing_code_end_loc": [84], "type": "CWE-79", "message": "A cross-site scripting (XSS) vulnerability in uploadConfirm.php of LimeSurvey v5.3.9 and below allows attackers to execute arbitrary web scripts or HTML via a crafted plugin.", "other": {"cve": {"id": "CVE-2022-29710", "sourceIdentifier": "cve@mitre.org", "published": "2022-05-25T01:15:07.363", "lastModified": "2022-06-13T14:19:26.757", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A cross-site scripting (XSS) vulnerability in uploadConfirm.php of LimeSurvey v5.3.9 and below allows attackers to execute arbitrary web scripts or HTML via a crafted plugin."}, {"lang": "es", "value": "Una vulnerabilidad de tipo cross-site scripting (XSS) en el archivo uploadConfirm.php de LimeSurvey versiones v5.3.9 y anteriores, permite a atacantes ejecutar scripts web o HTML arbitrarios por medio de un plugin dise\u00f1ado"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:limesurvey:limesurvey:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.3.9", "matchCriteriaId": "15EE1E51-1BC1-44BB-AB86-2EB2410E7F87"}]}]}], "references": [{"url": "https://github.com/LimeSurvey/LimeSurvey/commit/f7b35619a1c4b0893754594c7d5870fd599a0f9c", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/LimeSurvey/LimeSurvey/commit/f7b35619a1c4b0893754594c7d5870fd599a0f9c"}}