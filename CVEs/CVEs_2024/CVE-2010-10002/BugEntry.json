{"buggy_code": ["<?php\n\n$this->data['header'] = 'OpenID Login';\n$this->data['autofocus'] = 'openid-identifier';\n$this->includeAtTemplateBase('includes/header.php');\n\n?>\n<style>\ninput.openid-identifier {\n   background: url(http://stat.livejournal.com/img/openid-inputicon.gif) no-repeat;\n/*   background-color: #fff; */\n\tborder-left: 1px solid #ccc;\n\tborder-right: 1px solid #aaa;\n\tborder-top: 1px solid #aaa;\n\tborder-bottom: 1px solid #ccc;\n\tcolor: #555;\n   background-position: 0 50%;\n   padding-left: 18px;\n}\nfieldset {\n\tborder-left: 1px solid #aaa;\n\tborder-right: 1px solid #ccc;\n\tborder-top: 1px solid #ccc;\n\tborder-bottom: 1px solid #aaa;\n\tpadding: 1em;\n}\nlegend {\n\tpadding-left: .3em;\n\tpadding-right: .3em;\n\tcolor: #555;\n}\n\ndiv.error {\n\tpadding: 1em; margin: 1em;\n\tbackground: red;\n\tcolor: white;\n\tborder: 1px solid #600;\n}\n</style>\n\n\n    <?php if (isset($this->data['error'])) { print \"<div class=\\\"error\\\">\" . $this->data['error'] . \"</div>\"; } ?>\n\n\n\n\t<form method=\"get\" action=\"consumer.php\">\n\t\t<fieldset>\n\t\t\t<legend>OpenID Login</legend>\n\n\t\t\tIdentity&nbsp;URL:\n\t\t\t<input type=\"hidden\" name=\"action\" value=\"verify\" />\n\t\t\t<input id=\"openid-identifier\" class=\"openid-identifier\" type=\"text\" name=\"openid_url\" value=\"http://\" />\n\t\t\t<input type=\"hidden\" name=\"AuthState\" value=\"<?php echo $this->data['AuthState']; ?>\" />\n\t\t\t<input type=\"submit\" value=\"Login with OpenID\" />\n\t\t</fieldset>\n\t</form>\n\n    <p style=\"margin-top: 2em\">\n       OpenID is a free and easy way to use a single digital identity across the Internet. Enter your OpenID identity URL in the box above to authenticate.\n    </p>\n\n\n<?php\n$this->includeAtTemplateBase('includes/footer.php');\n?>"], "fixing_code": ["<?php\n\n$this->data['header'] = 'OpenID Login';\n$this->data['autofocus'] = 'openid-identifier';\n$this->includeAtTemplateBase('includes/header.php');\n\n?>\n<style>\ninput.openid-identifier {\n   background: url(http://stat.livejournal.com/img/openid-inputicon.gif) no-repeat;\n/*   background-color: #fff; */\n\tborder-left: 1px solid #ccc;\n\tborder-right: 1px solid #aaa;\n\tborder-top: 1px solid #aaa;\n\tborder-bottom: 1px solid #ccc;\n\tcolor: #555;\n   background-position: 0 50%;\n   padding-left: 18px;\n}\nfieldset {\n\tborder-left: 1px solid #aaa;\n\tborder-right: 1px solid #ccc;\n\tborder-top: 1px solid #ccc;\n\tborder-bottom: 1px solid #aaa;\n\tpadding: 1em;\n}\nlegend {\n\tpadding-left: .3em;\n\tpadding-right: .3em;\n\tcolor: #555;\n}\n\ndiv.error {\n\tpadding: 1em; margin: 1em;\n\tbackground: red;\n\tcolor: white;\n\tborder: 1px solid #600;\n}\n</style>\n\n\n    <?php if (isset($this->data['error'])) { print \"<div class=\\\"error\\\">\" . $this->data['error'] . \"</div>\"; } ?>\n\n\n\n\t<form method=\"get\" action=\"consumer.php\">\n\t\t<fieldset>\n\t\t\t<legend>OpenID Login</legend>\n\n\t\t\tIdentity&nbsp;URL:\n\t\t\t<input type=\"hidden\" name=\"action\" value=\"verify\" />\n\t\t\t<input id=\"openid-identifier\" class=\"openid-identifier\" type=\"text\" name=\"openid_url\" value=\"http://\" />\n\t\t\t<input type=\"hidden\" name=\"AuthState\" value=\"<?php echo htmlspecialchars($this->data['AuthState']); ?>\" />\n\t\t\t<input type=\"submit\" value=\"Login with OpenID\" />\n\t\t</fieldset>\n\t</form>\n\n    <p style=\"margin-top: 2em\">\n       OpenID is a free and easy way to use a single digital identity across the Internet. Enter your OpenID identity URL in the box above to authenticate.\n    </p>\n\n\n<?php\n$this->includeAtTemplateBase('includes/footer.php');\n?>"], "filenames": ["templates/consumer.php"], "buggy_code_start_loc": [53], "buggy_code_end_loc": [54], "fixing_code_start_loc": [53], "fixing_code_end_loc": [54], "type": "CWE-79", "message": "** UNSUPPPORTED WHEN ASSIGNED **** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in SimpleSAMLphp simplesamlphp-module-openid. Affected is an unknown function of the file templates/consumer.php of the component OpenID Handler. The manipulation of the argument AuthState leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.0 is able to address this issue. The name of the patch is d652d41ccaf8c45d5707e741c0c5d82a2365a9a3. It is recommended to upgrade the affected component. VDB-217170 is the identifier assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.", "other": {"cve": {"id": "CVE-2010-10002", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-01T17:15:09.963", "lastModified": "2023-01-09T17:44:17.257", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "** UNSUPPPORTED WHEN ASSIGNED **** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in SimpleSAMLphp simplesamlphp-module-openid. Affected is an unknown function of the file templates/consumer.php of the component OpenID Handler. The manipulation of the argument AuthState leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.0 is able to address this issue. The name of the patch is d652d41ccaf8c45d5707e741c0c5d82a2365a9a3. It is recommended to upgrade the affected component. VDB-217170 is the identifier assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.1, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 2.6}, "baseSeverity": "LOW", "exploitabilityScore": 4.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:simplesamlphp:simplesamlphp-module-openid:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.0", "matchCriteriaId": "0D5D67A7-A89A-44F1-9023-20FC728C12A8"}]}]}], "references": [{"url": "https://github.com/simplesamlphp/simplesamlphp-module-openid/commit/d652d41ccaf8c45d5707e741c0c5d82a2365a9a3", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/simplesamlphp/simplesamlphp-module-openid/releases/tag/v1.0", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217170", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217170", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/simplesamlphp/simplesamlphp-module-openid/commit/d652d41ccaf8c45d5707e741c0c5d82a2365a9a3"}}