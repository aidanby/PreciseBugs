{"buggy_code": ["<?php\n/*\nPlugin Name: Secure Files\nPlugin URI: http://www.almosteffortless.com/wordpress/\nDescription: This plugin allows you to upload and download files from outside of your web document root for security purposes. When used in conjunction with a plugin that requires a user to be logged in to see your site, you can restrict file downloads to users that are logged in. It can be found in Manage -> Secure Files.\nAuthor: Trevor Turk\nVersion: 1.1\nAuthor URI: http://www.almosteffortless.com/\n*/ \n\n/*  Copyright 2005  Trevor Turk  (email : trevorturk@yahoo.com)\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program; if not, write to the Free Software\n    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n*/\n\n\t// setting options\n\tfunction sf_options() {\n\t\tif ( isset($_POST['sf_directory']) ) {\n\t\t\t$sf_directory = $_POST['sf_directory'];\n\t\t\tupdate_option('sf_directory', $sf_directory, '','');\n\t\t}\n\t\tif ( isset($_POST['sf_prefix']) ) {\n\t\t\t$sf_prefix = $_POST['sf_prefix'];\n\t\t\tupdate_option('sf_prefix', $sf_prefix, '','');\n\t\t}\n\t\n\t}\n\t\t\n\t// uploading files\n\tfunction sf_uploads() {\n\t\tif ( isset($_FILES['sf_upload']) ) {\n\t\t\t$sf_directory = get_option('sf_directory');\n\t\t\t$sf_prefix = get_option('sf_prefix');\n\t\t\t$uploadfile = $sf_directory . $_FILES['sf_upload']['name'];\n\t\t\t$file = $_FILES['sf_upload']['name'];\n\t\t\t\tif (@move_uploaded_file($_FILES['sf_upload']['tmp_name'], $uploadfile)) {\n\t\t\t\t\t@chmod($uploadfile, 0777);\n\t\t\t\t\techo '<div class=\"updated\">';\n\t\t\t\t\techo '<p>The file <b>'. $_FILES['sf_upload']['name'] .'</b> was uploaded successfully.</p>';\n\t\t\t\t\techo \"<p><small>You can link to it like so: <code>&lt;a href=\\\"?$sf_prefix=$file\\\"&gt;$file&lt;/a&gt;</code></small></p>\";\n\t\t\t\t\techo \"<p><small>If this is an image, you can do this: <code>&lt;img src=\\\"?$sf_prefix=$file\\\" alt=\\\"$file\\\" /&gt;</code></small></p>\";\n\t\t\t\t\techo '</div>';\n\t\t\t\t}\n\t\t\telse {\n\t\t\t\techo '<div class=\"updated\">';\n\t\t\t\techo '<p>Sorry, there was an error uploading <b>'. $_FILES['sf_upload']['name'] .'</b>. Please check your <b>Options</b> and the file you want to upload before trying again.</p>';\n\t\t\t\techo '</div>';\n\t\t\t}\n\t\t}\n\t}\n\t\n\t// downloading files\n\tfunction sf_downloads() {\n\t\t$sf_prefix = get_option('sf_prefix');\n\t\tif (isset($_GET[\"$sf_prefix\"])) {\n\t\t\t$downloadfile = $_GET[\"$sf_prefix\"];\n\t\t\t$sf_directory = get_option('sf_directory');\n\t\t\t$downloadfile = $sf_directory . $downloadfile;\n\t\t\tif (is_file($downloadfile)) {\n\t\t\t\theader('Content-Description: File Transfer'); \n\t\t\t\theader('Content-Type: application/force-download'); \n\t\t\t\theader('Content-Length: ' . filesize($downloadfile)); \n\t\t\t\theader('Content-Disposition: attachment; filename=\"' . basename($downloadfile).'\"'); \n\t\t\t\t@readfile($downloadfile);\n\t\t\t}\n\t\t\telse {\n\t\t\t\techo 'File not found';\n\t\t\t}\n\t\t\texit;\n\t\t}\n\t}\n\n\t// add javascript toggle to the admin head\n\tfunction sf_admin_head_js() {\n\t\techo '<script type=\"text/javascript\">function toggle(idname) { if (document.getElementById(idname).style.display == \"\") { document.getElementById(idname).style.display = \"none\" } document.getElementById(idname).style.display = (document.getElementById(idname).style.display == \"none\") ? \"block\" : \"none\"; }</script>';\n\t}\n\n\t// for adding a entry to the wordpress options table for your secure file directory (outside of the web root)\n\tadd_option('sf_directory', '/a/directory/outside/of/your/web/document/root/', 'Choose a directory outside of your web document root for file storage', $autoload);\n\n\t// for adding a entry to the wordpress options table for your secure file directory (outside of the web root)\n\tadd_option('sf_prefix', 'file_id', 'Choose a prefix to use when downloading your secure files', $autoload);\n\t\t\n\t// for adding an admin menu under Manage -> Secure Files\n\tfunction sf_add_pages() {\n\t\tadd_management_page('Secure Files', 'Secure Files', 8, __FILE__, 'sf_manage_page');\n\t\t}\n\t\t\t\n\t// Manage -> Secure Files admin subtab content\n\tfunction sf_manage_page() {\n\t\t\n\t\tsf_options();\n\t\tsf_uploads();\n\t\t\n\t\t$site_url = get_bloginfo('url');\n\t\t\n\t\t// get the secure files directory via get_option() if it has been updated via POST\n\t\tif ( isset($_POST['sf_directory']) ) {\n\t\t\t$sf_directory = $_POST['sf_directory'];\n\t\t}\n\t\telse {\n\t\t\t$sf_directory = get_option('sf_directory');\n\t\t}\n\t\t\n\t\t// get the secure files prefix via get_option() if it has been updated via POST\n\t\tif ( isset($_POST['sf_prefix']) ) {\n\t\t\t$sf_prefix = $_POST['sf_prefix'];\n\t\t}\n\t\telse {\n\t\t\t$sf_prefix = get_option('sf_prefix');\n\t\t}\n\t\n\t\t// show options update message\n\t\tif ( (isset($_POST['sf_directory'])) || (isset($_POST['sf_prefix'])) ) {\n\t\t\techo '<div class=\"updated\">';\n\t\t\techo '<p>Secure Files Options have been updated.</p>';\n\t\t\techo '</div>';\n\t\t}\n\t\t\t\t\n\t\t// check that secure files directory is writable (and exists)\n\t\tif (($sf_directory != '') && (!is_writable($sf_directory))) {\n\t\t\techo '<div class=\"updated\">';\n\t\t\techo '<p><b>Warning</b>: The Secure Files Directory is not writable or does not exist. Please update your <b>Options</b> below.</p>';\n\t\t\techo '</div>';\n\t\t}\n\t\t\n\t\techo '<div class=\"wrap\">';\n\t\t\n\t\techo '<h2>Upload</h2>';\n\t\t\n\t\techo '<form name=\"sf_upload\" action=\"\" method=\"post\" enctype=\"multipart/form-data\">';\n\t\techo '<table width=\"100%\" cellspacing=\"2\" cellpadding=\"5\" class=\"editform\"><tr>';\n\t\techo '<th width=\"20%\" valign=\"top\" scope=\"row\">Upload a File: </th><td>';\n\t\techo '<input type=\"file\" name=\"sf_upload\" id=\"sf_upload\" size=\"35\" class=\"uploadform\" />';\n\t\techo '<p><small>Choose a file to upload to your Secure Files Directory. Alternatively, you can upload files into your Secure Files Directory via <a href=\"http://codex.wordpress.org/FTP_Clients\">FTP</a> and they will become available for download. <b>Warning</b>: If a file with the same name already exists, it will automatically be replaced.</small></p>';\n\t\techo '</tr></table>';\n\t\techo '<p class=\"submit\"><input type=\"submit\" name=\"Submit\" value=\"Upload File &raquo;\" /></p>';\n\t\techo '</form>';\n\t\t\n\t\techo '<h2>Download</h2>';\n\t\t\n\t\techo '<table width=\"100%\" cellspacing=\"2\" cellpadding=\"5\" class=\"editform\"><tr>';\n\t\techo '<th width=\"20%\" valign=\"top\" scope=\"row\">Available Files: </th><td>';\n\t\t\n\t\t// get files in the secure directory\n\t\tif (is_dir($sf_directory)) {\n\t\t\tif ($handle = opendir($sf_directory)) {\n\t\t\t\techo '<ul style=\"margin:0;padding:0;\">';\n\t\t\t\twhile (false !== ($file = readdir($handle))) {\n\t\t\t\t\tif ($file != \".\" && $file != \"..\") {\n\t\t\t\t\t\techo \"<li style='list-style-type:none;'><a href='$site_url/?$sf_prefix=$file'>$file</a>\";\n\t\t\t\t\t\techo \"&nbsp;&nbsp;<a href=\\\"javascript:toggle('sf_toggle_$file')\\\" style='color:gray;'>&raquo</a>\";\n\t\t\t\t\t\techo \"<ul id=\\\"sf_toggle_$file\\\" style='display:none;list-style-type:none;color:gray;padding-top:6px;'><li><small>Download Link: &lt;a href=\\\"?$sf_prefix=$file\\\"&gt;$file&lt;/a&gt;</small></li>\";\n\t\t\t\t\t\techo \"<li><small>Display Image: &lt;img src=\\\"?$sf_prefix=$file\\\" alt=\\\"$file\\\" /&gt;</small></li></ul></li>\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\techo '</ul>';\n\t\t\tclosedir($handle);\n\t\t\t}\n\t\t}\n\t\t\n\t\techo '</td></tr></table>';\t\n\t\techo '<br /><h2>Options</h2>';\n\t\t\n\t\techo '<form name=\"sf_options\" action=\"\" method=\"post\">';\n\t\techo '<table width=\"100%\" cellspacing=\"2\" cellpadding=\"5\" class=\"editform\">';\n\t\techo '<tr><th width=\"20%\" valign=\"top\" scope=\"row\">Secure Files Directory: </th><td>';\n\t\techo '<input name=\"sf_directory\" id=\"sf_directory\" type=\"text\" value=\"'.$sf_directory.'\" size=\"50\" /> ';\n\t\techo '<p><small>Choose a directory <b>outside of your web document root</b> for storing your Secure Files. You will have to <a href=\"http://codex.wordpress.org/Uploading_WordPress_to_a_remote_host\">create</a> this directory, and ensure that it is <a href=\"http://codex.wordpress.org/Make_a_Directory_Writable\">writable</a>. If your site was located at <code>/home/users/myname/mydomain.com/</code> then you might want to use the directory <code>/home/users/myname/mydomain.com_files/</code> or something to that effect. To give you a starting point, your <b>insecure</b> Wordpress directory is located at <code>'.ABSPATH.'</code> and your Secure Directory should be <b>at least one level above this</b> and most likely more. Choose this directory carefully, because if it isn\\'t outside of your web document root, your files will <b>NOT</b> be secure.</small></p>';\n\t\techo '</td></tr>';\n\t\techo '<tr><th width=\"20%\" valign=\"top\" scope=\"row\">Secure Files Prefix: </th><td>';\n\t\techo '<input name=\"sf_prefix\" id=\"sf_prefix\" type=\"text\" value=\"'.$sf_prefix.'\" size=\"20\" /> ';\n\t\techo '<p><small>Choose a prefix to use when downloading your Secure Files from your site. The default is <code>file_id</code> and you\\'ll have to update any links you\\'ve already put on your site if you change it. Click the <span style=\"color:gray;\">&raquo</span> links to learn how to link to these files or include them as images in a Post or Page.</small></p>';\n\t\techo '</td></tr>';\n\t\techo '</table>';\n\t\techo '<p class=\"submit\"><input type=\"submit\" name=\"Submit\" value=\"Update Options &raquo;\" /></p>';\n\t\techo '</form>';\n\t\t\n\t\techo '</div>';\n\t\t\n\t}\n\n\t// wordpress hooks\n\tadd_action('admin_menu', 'sf_add_pages');\n\tadd_action('admin_head', 'sf_admin_head_js');\n\tadd_action('template_redirect', 'sf_downloads');\n\n?>"], "fixing_code": ["<?php\n/*\nPlugin Name: Secure Files\nPlugin URI: http://www.almosteffortless.com/wordpress/\nDescription: This plugin allows you to upload and download files from outside of your web document root for security purposes. When used in conjunction with a plugin that requires a user to be logged in to see your site, you can restrict file downloads to users that are logged in. It can be found in Manage -> Secure Files.\nAuthor: Trevor Turk\nVersion: 1.2\nAuthor URI: http://www.almosteffortless.com/\n*/ \n\n/*  Copyright 2005  Trevor Turk  (email : trevorturk@yahoo.com)\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program; if not, write to the Free Software\n    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n*/\n\n\t// setting options\n\tfunction sf_options() {\n\t\tif ( isset($_POST['sf_directory']) ) {\n\t\t\t$sf_directory = $_POST['sf_directory'];\n\t\t\tupdate_option('sf_directory', $sf_directory, '','');\n\t\t}\n\t\tif ( isset($_POST['sf_prefix']) ) {\n\t\t\t$sf_prefix = $_POST['sf_prefix'];\n\t\t\tupdate_option('sf_prefix', $sf_prefix, '','');\n\t\t}\n\t\n\t}\n\t\t\n\t// uploading files\n\tfunction sf_uploads() {\n\t\tif ( isset($_FILES['sf_upload']) ) {\n\t\t\t$sf_directory = get_option('sf_directory');\n\t\t\t$sf_prefix = get_option('sf_prefix');\n\t\t\t$uploadfile = $sf_directory . $_FILES['sf_upload']['name'];\n\t\t\t$file = $_FILES['sf_upload']['name'];\n\t\t\t\tif (@move_uploaded_file($_FILES['sf_upload']['tmp_name'], $uploadfile)) {\n\t\t\t\t\t@chmod($uploadfile, 0777);\n\t\t\t\t\techo '<div class=\"updated\">';\n\t\t\t\t\techo '<p>The file <b>'. $_FILES['sf_upload']['name'] .'</b> was uploaded successfully.</p>';\n\t\t\t\t\techo \"<p><small>You can link to it like so: <code>&lt;a href=\\\"?$sf_prefix=$file\\\"&gt;$file&lt;/a&gt;</code></small></p>\";\n\t\t\t\t\techo \"<p><small>If this is an image, you can do this: <code>&lt;img src=\\\"?$sf_prefix=$file\\\" alt=\\\"$file\\\" /&gt;</code></small></p>\";\n\t\t\t\t\techo '</div>';\n\t\t\t\t}\n\t\t\telse {\n\t\t\t\techo '<div class=\"updated\">';\n\t\t\t\techo '<p>Sorry, there was an error uploading <b>'. $_FILES['sf_upload']['name'] .'</b>. Please check your <b>Options</b> and the file you want to upload before trying again.</p>';\n\t\t\t\techo '</div>';\n\t\t\t}\n\t\t}\n\t}\n\t\n\t// downloading files\n\tfunction sf_downloads() {\n\t\t$sf_prefix = get_option('sf_prefix');\n\t\tif (isset($_GET[\"$sf_prefix\"])) {\n\t\t\t$downloadfile = $_GET[\"$sf_prefix\"];\n\t\t\t$sf_directory = get_option('sf_directory');\n\t\t\t$downloadfile = $sf_directory . basename($downloadfile);\n\t\t\tif (is_file($downloadfile)) {\n\t\t\t\theader('Content-Description: File Transfer'); \n\t\t\t\theader('Content-Type: application/force-download'); \n\t\t\t\theader('Content-Length: ' . filesize($downloadfile)); \n\t\t\t\theader('Content-Disposition: attachment; filename=\"' . basename($downloadfile).'\"'); \n\t\t\t\t@readfile($downloadfile);\n\t\t\t}\n\t\t\telse {\n\t\t\t\techo 'File not found';\n\t\t\t}\n\t\t\texit;\n\t\t}\n\t}\n\n\t// add javascript toggle to the admin head\n\tfunction sf_admin_head_js() {\n\t\techo '<script type=\"text/javascript\">function toggle(idname) { if (document.getElementById(idname).style.display == \"\") { document.getElementById(idname).style.display = \"none\" } document.getElementById(idname).style.display = (document.getElementById(idname).style.display == \"none\") ? \"block\" : \"none\"; }</script>';\n\t}\n\n\t// for adding a entry to the wordpress options table for your secure file directory (outside of the web root)\n\tadd_option('sf_directory', '/a/directory/outside/of/your/web/document/root/', 'Choose a directory outside of your web document root for file storage', $autoload);\n\n\t// for adding a entry to the wordpress options table for your secure file directory (outside of the web root)\n\tadd_option('sf_prefix', 'file_id', 'Choose a prefix to use when downloading your secure files', $autoload);\n\t\t\n\t// for adding an admin menu under Manage -> Secure Files\n\tfunction sf_add_pages() {\n\t\tadd_management_page('Secure Files', 'Secure Files', 8, __FILE__, 'sf_manage_page');\n\t\t}\n\t\t\t\n\t// Manage -> Secure Files admin subtab content\n\tfunction sf_manage_page() {\n\t\t\n\t\tsf_options();\n\t\tsf_uploads();\n\t\t\n\t\t$site_url = get_bloginfo('url');\n\t\t\n\t\t// get the secure files directory via get_option() if it has been updated via POST\n\t\tif ( isset($_POST['sf_directory']) ) {\n\t\t\t$sf_directory = $_POST['sf_directory'];\n\t\t}\n\t\telse {\n\t\t\t$sf_directory = get_option('sf_directory');\n\t\t}\n\t\t\n\t\t// get the secure files prefix via get_option() if it has been updated via POST\n\t\tif ( isset($_POST['sf_prefix']) ) {\n\t\t\t$sf_prefix = $_POST['sf_prefix'];\n\t\t}\n\t\telse {\n\t\t\t$sf_prefix = get_option('sf_prefix');\n\t\t}\n\t\n\t\t// show options update message\n\t\tif ( (isset($_POST['sf_directory'])) || (isset($_POST['sf_prefix'])) ) {\n\t\t\techo '<div class=\"updated\">';\n\t\t\techo '<p>Secure Files Options have been updated.</p>';\n\t\t\techo '</div>';\n\t\t}\n\t\t\t\t\n\t\t// check that secure files directory is writable (and exists)\n\t\tif (($sf_directory != '') && (!is_writable($sf_directory))) {\n\t\t\techo '<div class=\"updated\">';\n\t\t\techo '<p><b>Warning</b>: The Secure Files Directory is not writable or does not exist. Please update your <b>Options</b> below.</p>';\n\t\t\techo '</div>';\n\t\t}\n\t\t\n\t\techo '<div class=\"wrap\">';\n\t\t\n\t\techo '<h2>Upload</h2>';\n\t\t\n\t\techo '<form name=\"sf_upload\" action=\"\" method=\"post\" enctype=\"multipart/form-data\">';\n\t\techo '<table width=\"100%\" cellspacing=\"2\" cellpadding=\"5\" class=\"editform\"><tr>';\n\t\techo '<th width=\"20%\" valign=\"top\" scope=\"row\">Upload a File: </th><td>';\n\t\techo '<input type=\"file\" name=\"sf_upload\" id=\"sf_upload\" size=\"35\" class=\"uploadform\" />';\n\t\techo '<p><small>Choose a file to upload to your Secure Files Directory. Alternatively, you can upload files into your Secure Files Directory via <a href=\"http://codex.wordpress.org/FTP_Clients\">FTP</a> and they will become available for download. <b>Warning</b>: If a file with the same name already exists, it will automatically be replaced.</small></p>';\n\t\techo '</tr></table>';\n\t\techo '<p class=\"submit\"><input type=\"submit\" name=\"Submit\" value=\"Upload File &raquo;\" /></p>';\n\t\techo '</form>';\n\t\t\n\t\techo '<h2>Download</h2>';\n\t\t\n\t\techo '<table width=\"100%\" cellspacing=\"2\" cellpadding=\"5\" class=\"editform\"><tr>';\n\t\techo '<th width=\"20%\" valign=\"top\" scope=\"row\">Available Files: </th><td>';\n\t\t\n\t\t// get files in the secure directory\n\t\tif (is_dir($sf_directory)) {\n\t\t\tif ($handle = opendir($sf_directory)) {\n\t\t\t\techo '<ul style=\"margin:0;padding:0;\">';\n\t\t\t\twhile (false !== ($file = readdir($handle))) {\n\t\t\t\t\tif ($file != \".\" && $file != \"..\") {\n\t\t\t\t\t\techo \"<li style='list-style-type:none;'><a href='$site_url/?$sf_prefix=$file'>$file</a>\";\n\t\t\t\t\t\techo \"&nbsp;&nbsp;<a href=\\\"javascript:toggle('sf_toggle_$file')\\\" style='color:gray;'>&raquo</a>\";\n\t\t\t\t\t\techo \"<ul id=\\\"sf_toggle_$file\\\" style='display:none;list-style-type:none;color:gray;padding-top:6px;'><li><small>Download Link: &lt;a href=\\\"?$sf_prefix=$file\\\"&gt;$file&lt;/a&gt;</small></li>\";\n\t\t\t\t\t\techo \"<li><small>Display Image: &lt;img src=\\\"?$sf_prefix=$file\\\" alt=\\\"$file\\\" /&gt;</small></li></ul></li>\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\techo '</ul>';\n\t\t\tclosedir($handle);\n\t\t\t}\n\t\t}\n\t\t\n\t\techo '</td></tr></table>';\t\n\t\techo '<br /><h2>Options</h2>';\n\t\t\n\t\techo '<form name=\"sf_options\" action=\"\" method=\"post\">';\n\t\techo '<table width=\"100%\" cellspacing=\"2\" cellpadding=\"5\" class=\"editform\">';\n\t\techo '<tr><th width=\"20%\" valign=\"top\" scope=\"row\">Secure Files Directory: </th><td>';\n\t\techo '<input name=\"sf_directory\" id=\"sf_directory\" type=\"text\" value=\"'.$sf_directory.'\" size=\"50\" /> ';\n\t\techo '<p><small>Choose a directory <b>outside of your web document root</b> for storing your Secure Files. You will have to <a href=\"http://codex.wordpress.org/Uploading_WordPress_to_a_remote_host\">create</a> this directory, and ensure that it is <a href=\"http://codex.wordpress.org/Make_a_Directory_Writable\">writable</a>. If your site was located at <code>/home/users/myname/mydomain.com/</code> then you might want to use the directory <code>/home/users/myname/mydomain.com_files/</code> or something to that effect. To give you a starting point, your <b>insecure</b> Wordpress directory is located at <code>'.ABSPATH.'</code> and your Secure Directory should be <b>at least one level above this</b> and most likely more. Choose this directory carefully, because if it isn\\'t outside of your web document root, your files will <b>NOT</b> be secure.</small></p>';\n\t\techo '</td></tr>';\n\t\techo '<tr><th width=\"20%\" valign=\"top\" scope=\"row\">Secure Files Prefix: </th><td>';\n\t\techo '<input name=\"sf_prefix\" id=\"sf_prefix\" type=\"text\" value=\"'.$sf_prefix.'\" size=\"20\" /> ';\n\t\techo '<p><small>Choose a prefix to use when downloading your Secure Files from your site. The default is <code>file_id</code> and you\\'ll have to update any links you\\'ve already put on your site if you change it. Click the <span style=\"color:gray;\">&raquo</span> links to learn how to link to these files or include them as images in a Post or Page.</small></p>';\n\t\techo '</td></tr>';\n\t\techo '</table>';\n\t\techo '<p class=\"submit\"><input type=\"submit\" name=\"Submit\" value=\"Update Options &raquo;\" /></p>';\n\t\techo '</form>';\n\t\t\n\t\techo '</div>';\n\t\t\n\t}\n\n\t// wordpress hooks\n\tadd_action('admin_menu', 'sf_add_pages');\n\tadd_action('admin_head', 'sf_admin_head_js');\n\tadd_action('template_redirect', 'sf_downloads');\n\n?>"], "filenames": ["secure-files.php"], "buggy_code_start_loc": [7], "buggy_code_end_loc": [71], "fixing_code_start_loc": [7], "fixing_code_end_loc": [71], "type": "CWE-22", "message": "A vulnerability, which was classified as critical, was found in almosteffortless secure-files Plugin up to 1.1 on WordPress. Affected is the function sf_downloads of the file secure-files.php. The manipulation of the argument downloadfile leads to path traversal. Upgrading to version 1.2 is able to address this issue. The name of the patch is cab025e5fc2bcdad8032d833ebc38e6bd2a13c92. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-243804.", "other": {"cve": {"id": "CVE-2005-10002", "sourceIdentifier": "cna@vuldb.com", "published": "2023-10-29T15:15:42.073", "lastModified": "2024-02-29T01:05:55.423", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as critical, was found in almosteffortless secure-files Plugin up to 1.1 on WordPress. Affected is the function sf_downloads of the file secure-files.php. The manipulation of the argument downloadfile leads to path traversal. Upgrading to version 1.2 is able to address this issue. The name of the patch is cab025e5fc2bcdad8032d833ebc38e6bd2a13c92. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-243804."}, {"lang": "es", "value": "Una vulnerabilidad clasificada como cr\u00edtica fue encontrada en el complemento almosteffortless secure-files hasta 1.1 en WordPress. La funci\u00f3n sf_downloads del archivo Secure-files.php es afectada por la vulnerabilidad. La manipulaci\u00f3n del argumento downloadfile conduce a path traversal. La actualizaci\u00f3n a la versi\u00f3n 1.2 puede solucionar este problema. El nombre del parche es cab025e5fc2bcdad8032d833ebc38e6bd2a13c92. Se recomienda actualizar el componente afectado. El identificador de esta vulnerabilidad es VDB-243804."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:wp-plugins:secure_files:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.2", "matchCriteriaId": "31D60C64-164B-4CB4-8D08-FB1A2DDDF2BC"}]}]}], "references": [{"url": "https://github.com/wp-plugins/secure-files/commit/cab025e5fc2bcdad8032d833ebc38e6bd2a13c92", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.243804", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.243804", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/secure-files/commit/cab025e5fc2bcdad8032d833ebc38e6bd2a13c92"}}