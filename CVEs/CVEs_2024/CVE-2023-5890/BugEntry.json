{"buggy_code": ["/**\n * @defgroup js_controllers_grid_users_stageParticipant_form\n */\n/**\n * @file js/controllers/AdvancedReviewerSearchHandler.js\n *\n * Copyright (c) 2014-2021 Simon Fraser University\n * Copyright (c) 2000-2021 John Willinsky\n * Distributed under the GNU GPL v3. For full terms see the file docs/COPYING.\n *\n * @class AdvancedReviewerSearchHandler\n * @ingroup js_controllers\n *\n * @brief Handle the advanced reviewer search tab in the add reviewer modal.\n */\n(function($) {\n\n\t/** @type {Object} */\n\t$.pkp.controllers.grid.users.reviewer =\n\t\t\t$.pkp.controllers.grid.users.reviewer || {};\n\n\n\n\t/**\n\t * @constructor\n\t *\n\t * @extends $.pkp.classes.Handler\n\t *\n\t * @param {jQueryObject} $container the wrapped page element.\n\t * @param {Object} options handler options.\n\t */\n\t$.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler =\n\t\t\tfunction($container, options) {\n\t\tthis.parent($container, options);\n\n\t\t$container.find('.button').button();\n\n\t\tpkp.eventBus.$on('selected:reviewer', function(reviewer) {\n\t\t\t$('#reviewerId').val(reviewer.id);\n\t\t\t$('[id^=\"selectedReviewerName\"]').html(reviewer.fullName);\n\t\t\t$('#searchGridAndButton').hide();\n\t\t\t$('#regularReviewerForm').show();\n\t\t});\n\n\t\t$('#regularReviewerForm').hide();\n\n\t\tthis.bind('refreshForm', this.handleRefresh_);\n\t};\n\t$.pkp.classes.Helper.inherits(\n\t\t\t$.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler,\n\t\t\t$.pkp.classes.Handler);\n\n\n\t//\n\t// Private helper methods.\n\t//\n\t/**\n\t * Handle the form refresh event.\n\t * @private\n\t * @param {HTMLElement} sourceElement The element that issued the event.\n\t * @param {Event} event The triggering event.\n\t * @param {string} content HTML contents to replace element contents.\n\t */\n\t$.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler.prototype.\n\t\t\thandleRefresh_ = function(sourceElement, event, content) {\n\n\t\tif (content) {\n\t\t\tthis.replaceWith(content);\n\t\t}\n\t};\n\n\n}(jQuery));\n"], "fixing_code": ["/**\n * @defgroup js_controllers_grid_users_stageParticipant_form\n */\n/**\n * @file js/controllers/AdvancedReviewerSearchHandler.js\n *\n * Copyright (c) 2014-2021 Simon Fraser University\n * Copyright (c) 2000-2021 John Willinsky\n * Distributed under the GNU GPL v3. For full terms see the file docs/COPYING.\n *\n * @class AdvancedReviewerSearchHandler\n * @ingroup js_controllers\n *\n * @brief Handle the advanced reviewer search tab in the add reviewer modal.\n */\n(function($) {\n\n\t/** @type {Object} */\n\t$.pkp.controllers.grid.users.reviewer =\n\t\t\t$.pkp.controllers.grid.users.reviewer || {};\n\n\n\n\t/**\n\t * @constructor\n\t *\n\t * @extends $.pkp.classes.Handler\n\t *\n\t * @param {jQueryObject} $container the wrapped page element.\n\t * @param {Object} options handler options.\n\t */\n\t$.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler =\n\t\t\tfunction($container, options) {\n\t\tthis.parent($container, options);\n\n\t\t$container.find('.button').button();\n\n\t\tpkp.eventBus.$on('selected:reviewer', function(reviewer) {\n\t\t\t$('#reviewerId').val(reviewer.id);\n\t\t\t$('[id^=\"selectedReviewerName\"]').text(reviewer.fullName);\n\t\t\t$('#searchGridAndButton').hide();\n\t\t\t$('#regularReviewerForm').show();\n\t\t});\n\n\t\t$('#regularReviewerForm').hide();\n\n\t\tthis.bind('refreshForm', this.handleRefresh_);\n\t};\n\t$.pkp.classes.Helper.inherits(\n\t\t\t$.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler,\n\t\t\t$.pkp.classes.Handler);\n\n\n\t//\n\t// Private helper methods.\n\t//\n\t/**\n\t * Handle the form refresh event.\n\t * @private\n\t * @param {HTMLElement} sourceElement The element that issued the event.\n\t * @param {Event} event The triggering event.\n\t * @param {string} content HTML contents to replace element contents.\n\t */\n\t$.pkp.controllers.grid.users.reviewer.AdvancedReviewerSearchHandler.prototype.\n\t\t\thandleRefresh_ = function(sourceElement, event, content) {\n\n\t\tif (content) {\n\t\t\tthis.replaceWith(content);\n\t\t}\n\t};\n\n\n}(jQuery));\n"], "filenames": ["js/controllers/grid/users/reviewer/AdvancedReviewerSearchHandler.js"], "buggy_code_start_loc": [40], "buggy_code_end_loc": [41], "fixing_code_start_loc": [40], "fixing_code_end_loc": [41], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository pkp/pkp-lib prior to 3.3.0-16.", "other": {"cve": {"id": "CVE-2023-5890", "sourceIdentifier": "security@huntr.dev", "published": "2023-11-01T01:15:07.497", "lastModified": "2023-11-09T00:02:57.837", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository pkp/pkp-lib prior to 3.3.0-16."}, {"lang": "es", "value": "Cross-site Scripting (XSS): almacenado en el repositorio de GitHub pkp/pkp-lib anterior a 3.3.0-16."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 2.5}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sfu:pkp_web_application_library:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.3.0-16", "matchCriteriaId": "60CE0E67-FCF5-4A26-A91E-514946B97D99"}]}]}], "references": [{"url": "https://github.com/pkp/pkp-lib/commit/a868f1cdd98a4f1255a70fd6d8320511e0083f38", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.com/bounties/b60e6e1f-e44d-4b11-acf8-b0548b915686", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/pkp/pkp-lib/commit/a868f1cdd98a4f1255a70fd6d8320511e0083f38"}}