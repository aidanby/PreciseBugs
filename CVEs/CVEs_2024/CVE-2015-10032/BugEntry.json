{"buggy_code": ["<?php\n\t// Some DB info - users use the HMTest user\n\t// and tests are done on the testdb database\n\t$servername = \"localhost\";\n\t$username = \"HMTest\";\n\t$password = \"comp490\";\n\t$dbname = \"testdb\";\n\n\t// Create connection\n\t$conn = new mysqli($servername, $username, $password, $dbname);\n\n\t// Check connection\n\tif ($conn->connect_error) {\n\t\tdie(\"Connection failed: \" . $conn->connect_error);\n\t}\n\t\n\t// Remove after debug\n\techo \"Connected successfully\";\n\t\n\t// Adds a new user account with form data into the physician table of the database\n\t// -- To do: form checking (e.g., username already exists, etc.)\n\t$sql = \"INSERT INTO physician (group_id, username, password, first_name, last_name, company, phone) VALUES (1, '\".$_POST['username'].\"', '\".$_POST['password'].\"', '\".$_POST['firstN'].\"', '\".$_POST['lastN'].\"', '\".$_POST['company'].\"', '\".$_POST['phone'].\"')\";\n\t\n\t// Probably keep even after debug\n\tif ($conn->query($sql) === TRUE) {\n\t\techo \"Account created successfully.\";\n\t} else {\n\t\techo \"Error: \" . $sql . \"<br />\" . $conn->error;\n\t}\n\t\n\t$conn->close();\n?>", "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"\n\t\"http://www.w3.org/TR/html4/loose.dtd\">\n<html>\n\t<head>\n\t\t<title>Create an Account</title>\n\t</head>\n\t<body>\n\t\t<h1>HealthMate Physician Login</h1>\n\t\t<form action=\"createaccount.php\" method=\"post\">\n\t\t<p>First name: <input type=\"text\" name=\"firstN\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Last name: <input type=\"text\" name=\"lastN\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Username: <input type=\"text\" name=\"username\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Password: <input type=\"password\" name=\"password\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Confirm Password: <input type=\"password\" name=\"confirm\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Company: <input type=\"text\" name=\"company\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Phone Number: <input type=\"text\" name=\"phone\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<input type=\"submit\" value=\"Submit\" />\n\t</body>\n</html>"], "fixing_code": ["<?php\n\t// Some DB info - users use the HMTest user\n\t// and tests are done on the testdb database\n\t$servername = \"localhost\";\n\t$username = \"HMTest\";\n\t$password = \"comp490\";\n\t$dbname = \"testdb\";\n\n\t// Create connection\n\t$conn = new mysqli($servername, $username, $password, $dbname);\n\n\t// Check connection\n\tif ($conn->connect_error) {\n\t\tdie(\"Connection failed: \" . $conn->connect_error);\n\t}\n\t\n\t// Remove after debug\n\techo \"<p>Connected successfully</p>\";\n\t\n\t// Placeholders for variables from form\n\t$username = $password = $first_name = $last_name = $company = $phone = \"\";\n\t\n\t// Prevent XSS hacks / exploits by stripping the data\n\tif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n\t\t$username = test_input($_POST[\"username\"]);\n\t\t$password = test_input($_POST[\"password\"]);\n\t\t$first_name = test_input($_POST[\"first_name\"]);\n\t\t$last_name = test_input($_POST[\"last_name\"]);\n\t\t$company = test_input($_POST[\"company\"]);\n\t\t$phone = test_input($_POST[\"phone\"]);\n\t}\n\t\n\t// Removes unwanted and potentially malicious characters\n\t// from the form data\n\tfunction test_input($data) {\n\t\t$data = trim($data);\n\t\t$data = stripslashes($data);\n\t\t$data = htmlspecialchars($data);\n\t\treturn $data;\n\t}\n\t\n\t// Adds a new user account with form data into the physician table of the database\n\t// -- To do: form checking (e.g., username already exists, security, etc.)\n\t$sql = \"INSERT INTO physician (group_id, username, password, first_name, last_name, company, phone) VALUES (1, '\".$username.\"', '\".$password.\"', '\".$first_name.\"', '\".$last_name.\"', '\".$company.\"', '\".$phone.\"')\";\n\t\n\t// Probably keep even after debug\n\tif ($conn->query($sql) === TRUE) {\n\t\techo \"<p>Account created successfully.</p>\";\n\t} else {\n\t\techo \"Error: \" . $sql . \"<br />\" . $conn->error;\n\t}\n\t\n\t// Peace out\n\t$conn->close();\n?>", "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"\n\t\"http://www.w3.org/TR/html4/loose.dtd\">\n<html>\n\t<head>\n\t\t<title>Create an Account</title>\n\t</head>\n\t<body>\n\t\t<h1>HealthMate Physician Login</h1>\n\t\t<form action=\"createaccount.php\" method=\"post\">\n\t\t<p>First name: <input type=\"text\" name=\"first_name\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Last name: <input type=\"text\" name=\"last_name\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Username: <input type=\"text\" name=\"username\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Password: <input type=\"password\" name=\"password\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Confirm Password: <input type=\"password\" name=\"confirm\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Company: <input type=\"text\" name=\"company\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<p>Phone Number: <input type=\"text\" name=\"phone\" size=\"16\" maxlength=\"16\" /></p>\n\t\t<input type=\"submit\" value=\"Submit\" />\n\t</body>\n</html>"], "filenames": ["createaccount.php", "newaccount.html"], "buggy_code_start_loc": [18, 10], "buggy_code_end_loc": [30, 12], "fixing_code_start_loc": [18, 10], "fixing_code_end_loc": [54, 12], "type": "CWE-79", "message": "A vulnerability was found in HealthMateWeb. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file createaccount.php. The manipulation of the argument username/password/first_name/last_name/company/phone leads to cross site scripting. The attack can be launched remotely. The name of the patch is 472776c25b1046ecaf962c46fed7c713c72c28e3. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217663.", "other": {"cve": {"id": "CVE-2015-10032", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-09T09:15:09.757", "lastModified": "2023-01-12T20:50:26.213", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in HealthMateWeb. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file createaccount.php. The manipulation of the argument username/password/first_name/last_name/company/phone leads to cross site scripting. The attack can be launched remotely. The name of the patch is 472776c25b1046ecaf962c46fed7c713c72c28e3. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-217663."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:healthmateweb_project:healthmateweb:*:*:*:*:*:android:*:*", "versionEndExcluding": "2015-02-14", "matchCriteriaId": "41A40402-14AA-415C-9CB0-9614F22AD6D7"}]}]}], "references": [{"url": "https://github.com/StevenElberger/HealthMateWeb/commit/472776c25b1046ecaf962c46fed7c713c72c28e3", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217663", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.217663", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/StevenElberger/HealthMateWeb/commit/472776c25b1046ecaf962c46fed7c713c72c28e3"}}