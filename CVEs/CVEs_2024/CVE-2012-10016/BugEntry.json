{"buggy_code": ["<?php\r\n/**\r\n * Plugin name: Simple Download Button Shortcode\r\n * Plugin URI: http://tech.halulu.org/?p=849\r\n * Author: <a href=\"http://www.halulu.tech/\">Halulu</a>\r\n * Author URI: http://tech.halulu.org/?p=849\r\n * Version: 1.0\r\n * Description:\u30b7\u30e7\u30fc\u30c8\u30b3\u30fc\u30c9\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\u3092\u8868\u793a\u3002DL\u30d7\u30ed\u30b0\u30e9\u30e0\u4ed8\u304d\u3067\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3084\u753b\u50cf\u3082\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002Display CSS3 dwonload bottons by simple Shortcode. This plugin comes with a downloading program that let site visitors donwload source code and images, such as html, php and jpeg.\r\n */\r\n\r\n /*  Copyright 2012 Halulu (email : info@halulu.org)\r\n\r\n    This program is free software; you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License, version 2, as \r\n    published by the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program; if not, write to the Free Software\r\n    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\r\n*/\r\n\r\nfunction disp_downloadButton($atts) {\r\n\r\n\t// set the download program php\r\n\t$plugin_url = plugins_url( basename(dirname(__FILE__))). '/simple-download-button_dl.php'; \r\n\t$html = '';\r\n\r\n\t$style \t\t\t= '';\r\n\t$label\t\t\t= '';\r\n\t\r\n\t/* Shortcode Settings */\r\n\textract(shortcode_atts(array(\r\n\t\t\"file\" => '',\r\n\t\t\"label\" => get_option('label'),\r\n\t\t\"btn\" => get_option('btn_type')\r\n\t), $atts));\r\n\t\r\n\tif(!$label){ $label = 'DOWNLOAD'; }\r\n\r\n\t// button style\r\n\tswitch ($btn) {\r\n\t\tcase 1:\r\n\t\t\t$style = 'class=\"minimal\"';\r\n\t\t\tbreak;\r\n\t\tcase 2:\r\n\t\t\t$style = 'class=\"clean-gray\"';\r\n\t\t\tbreak;\r\n\t\tcase 3:\r\n\t\t\t$style = 'class=\"cupid-green\"';\r\n\t\t\tbreak;\r\n\t\tcase 4:\r\n\t\t\t$style = 'class=\"cupid-blue\"';\r\n\t\t\tbreak;\r\n\t\tcase 5:\r\n\t\t\t$style = 'class=\"blue-pill\"';\r\n\t\t\tbreak;\r\n\t\tcase 6:\r\n\t\t\t$style = 'class=\"thoughtbot\"';\r\n\t\t\tbreak;\r\n\t\tcase 7:\r\n\t\t\t$style = 'class=\"punch\"';\r\n\t\t\tbreak;\r\n\t\tcase 8:\r\n\t\t\t$style = 'class=\"purple-candy\"';\r\n\t\t\tbreak;\r\n\t\tcase 9:\r\n\t\t\t$style = 'class=\"shiny-blue\"';\r\n\t\t\tbreak;\r\n\t\tcase 10:\r\n\t\t\t$style = 'class=\"skip\"';\r\n\t\t\tbreak;\r\n\t\tcase 11:\r\n\t\t\t$style = 'class=\"download-itunes\"';\r\n\t\t\tbreak;\r\n\t\tdefault;\r\n\t\t\tbreak; // keep it empty.\t\t\t\r\n\t}\r\n\r\n\t$html .= str_replace(\r\n\t\tarray(\r\n\t\t\t'%style%',\r\n\t\t\t'%plugin_url%',\r\n\t\t\t'%file%',\r\n\t\t\t'%label%',\r\n\t\t\t'%name%',\r\n\t\t\t'%download_dir%'\r\n\t\t),\r\n\t\tarray(\r\n\t\t\t$style,\r\n\t\t\t$plugin_url,\r\n\t\t\t$file,\r\n\t\t\t$label,\r\n\t\t\t$download_dir\r\n\t\t),\r\n\t\t'<div id=\"simple-download-button\"><button %style% onclick=\"location.href=\\'%plugin_url%?file=%file%&download_dir=%download_dir%\\'\"><b>%label%</b></button></div>'\r\n\t);\t\r\n\t\r\n\treturn $html;\r\n}\r\n\r\n/**\r\n * Shortcode hock\r\n */\r\nadd_shortcode('dlbt', 'disp_downloadButton');\r\n\r\n/**\r\n * plugin init\r\n */\r\nfunction downloadbutton_init() {\r\n load_plugin_textdomain('sm-downloadbutton', false, basename( dirname( __FILE__ ) ) . '/languages' );  \r\n}\r\nadd_action('init', 'downloadbutton_init');\r\n\r\n/**\r\n * add stylesheet for the plugin\r\n */\r\nfunction add_downloadbutton_css() {\r\n\t$cssPath = plugin_dir_path( __FILE__ ). '/style.css';\r\n\tif(file_exists($cssPath)){\r\n\t  wp_register_style('style', plugins_url('style.css', __FILE__));\r\n\t  wp_register_style('buttons', plugins_url('buttons.css', __FILE__) );\r\n\t  wp_enqueue_style('style');\r\n\t  wp_enqueue_style('buttons');\r\n\t}\r\n}\r\nadd_action('wp_print_styles', 'add_downloadbutton_css');\r\n\r\n\r\n/**\r\n * Register plugin options page\r\n */\r\nadd_action('admin_init', 'downloadbutton_admin_init' );\r\nadd_action('admin_menu', 'downloadbutton_menu');\r\n\r\n/* Add stylesheet to the option page. */\r\nfunction downloadbutton_admin_init() {\r\n   wp_register_style( 'style', plugins_url('style.css', __FILE__) );\r\n   wp_register_style( 'buttons', plugins_url('buttons.css', __FILE__) );\r\n}\r\nfunction downloadbutton_menu() {\r\n\t$page = add_options_page('Plugin Options', 'Download Button', 8, __FILE__, 'downloadbutton_options');\r\n\tadd_action( 'admin_print_styles-' . $page, 'downloadbutton_admin_styles' );\r\n}\r\nfunction downloadbutton_admin_styles() {\r\n   wp_enqueue_style( 'style' );\r\n   wp_enqueue_style( 'buttons' );\r\n}\r\n\r\n/**\r\n * plugin options page\r\n */\r\nfunction downloadbutton_options() {\r\n\r\n?> \r\n    <div class=\"wrap\">\r\n\t<div id=\"simple-download-button\">\r\n        <h2>Simple Download Button Options</h2>\r\n        <form method=\"post\" action=\"options.php\">\r\n            <?php wp_nonce_field('update-options'); ?>\r\n            <div class=\"box2\">\r\n\t\t\t<h3><?php _e('Absolute path to download file containing directory', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<p><?php _e('your-wordpress-home', 'sm-downloadbutton') ?>/wp-content/plugins/simple-download-button/download/</p>\r\n\t\t\t<p><font color=\"red\"><?php _e('ATTENTION: All user downloads have to be uploaded to the directory indicated above.', 'sm-downloadbutton') ?></font></p>\r\n\t\t\t<h3><?php _e('Short Code Parameters', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<ul>\r\n\t\t\t<li><strong>file</strong> = <?php _e('user download file name with its extention (must given)', 'sm-downloadbutton') ?></li>\r\n\t\t\t<li><strong>label</strong> = <?php _e('letters to display on the donwload button (optional)', 'sm-downloadbutton') ?></li>\r\n\t\t\t<li><strong>btn</strong> = <?php _e('button design number 0 to 11 (optional) *see the design option', 'sm-downloadbutton') ?></li>\t\r\n\t\t\t</ul>\r\n\t\t\t<p>\r\n\t\t\t<br />[dlbt file=sample.html]\r\n\t\t\t<br />[dlbt file=sample.html label=<?php _e('SAMPLE', 'sm-downloadbutton') ?>]\r\n\t\t\t<br />[dlbt file=sample.html label=<?php _e('SAMPLE', 'sm-downloadbutton') ?> btn=10]</p>\r\n\t\t\t</div>\r\n            <div class=\"box\">\r\n\t\t\t<h3><?php _e('Label on the button (option)', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<p><?php _e('letters to display on the donwload button.', 'sm-downloadbutton') ?></p>\r\n\t\t\t<p><?php _e('Default', 'sm-downloadbutton') ?>: DOWNLOAD</p>\r\n\t\t\t<input type=\"text\" size=\"50\" name=\"label\" value=\"<?php echo get_option('label'); ?>\" />\r\n\t\t\t</div>\r\n            <div class=\"box\">\r\n\t\t\t<h3><?php _e('Design for download button (option)', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<table>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"0\" <?php if (!get_option('btn_type')) : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('no style', 'sm-downloadbutton') ?><?php _e(' (default)', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><a>DOWNLOAD</a></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"1\" <?php if (get_option('btn_type')=='1') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style1', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"minimal\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"2\" <?php if (get_option('btn_type')=='2') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style2', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"clean-gray\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"3\" <?php if (get_option('btn_type')=='3') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style3', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"cupid-green\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"4\" <?php if (get_option('btn_type')=='4') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style4', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"cupid-blue\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"5\" <?php if (get_option('btn_type')=='5') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style5', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"blue-pill\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"6\" <?php if (get_option('btn_type')=='6') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style6', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"thoughtbot\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"7\" <?php if (get_option('btn_type')=='7') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style7', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"punch\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"8\" <?php if (get_option('btn_type')=='8') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style8', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"purple-candy\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"9\" <?php if (get_option('btn_type')=='9') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style9', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"shiny-blue\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"10\" <?php if (get_option('btn_type')=='10') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style10', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"skip\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"11\" <?php if (get_option('btn_type')=='11') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style11', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"download-itunes\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n\t\t\t</table>\r\n\t\t\t<p>*All buttons are designed & shared by <a href=\"http://hellohappy.org/css3-buttons/\" target=\"_blank\">Chad Mazzola</a>.</p>\r\n\t\t\t</div>\r\n            <input type=\"hidden\" name=\"action\" value=\"update\" />\r\n            <input type=\"hidden\" name=\"page_options\" value=\"path,label,btn_type\" />\r\n            <p class=\"submit\">\r\n                <input type=\"submit\" class=\"button-primary\" value=\"<?php _e('Save Changes') ?>\" />\r\n            </p>\r\n        </form>\r\n    </div>\r\n    </div>\r\n<p><?php _e('To send feedback, requests or find more about the plugin, visit <a href=\"tech.halulu.org\" target=\"_blank\">here</a> or feel free to <a href=\"mailto:info@halulu.org\">email</a> me. Thank you!', 'sm-downloadbutton') ?><p>\r\n<?php\r\n}\r\n?>\r\n", "<?php\r\n\t/* Admin Settings*/\r\n\t// download files containing dir\t\r\n\t$download_dir\t= dirname(__FILE__). '/download/';\r\n\r\n\t/* GET param */\r\n\t$filename = $_GET['file'];\r\n\tif(!$filename){ die(\"ERROR: a file name to download is not set!\"); }\r\n\t\r\n\t$download_filepath = $download_dir. $filename;\r\n\t\r\n\t// set a file name showed in the dialog box.\r\n\tif(!$dispname){$dispname = $filename;}\r\n\tmb_convert_encoding($dispname, \"UTF-8\");\r\n\r\n\t/* set the Content-type depends on the extention */\r\n\tif (!file_exists($download_filepath)) {\r\n\t\tdie(\"ERROR: There is not shuch file. Please hit the back button to return.\");\r\n\t}else{\r\n\t\t$file_info = pathinfo($download_filepath);\r\n\t\t$ext = strtolower($file_info[\"extension\"]);\r\n\t\tswitch ($ext) {\r\n\t\t\tcase \"pdf\":\r\n\t\t\t\theader(\"Content-type: application/pdf\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"txt\":\r\n\t\t\t\theader(\"Content-type: text/plain\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"csv\":\r\n\t\t\t\theader(\"Content-type: text/csv\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"doc\":\r\n\t\t\t\theader(\"Content-type: application/msword\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"xls\":\r\n\t\t\t\theader(\"Content-type: application/vnd.ms-excel\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"html\":\r\n\t\t\tcase \"htm\":\r\n\t\t\t\theader(\"Content-type: text/html\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"css\":\r\n\t\t\t\theader(\"Content-type: text/css\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"js\":\r\n\t\t\t\theader(\"Content-type: text/javascript\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"jpg\":\r\n\t\t\tcase \"jpeg\":\r\n\t\t\t\theader(\"Content-type: image/jpeg\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"png\":\r\n\t\t\t\theader(\"Content-type: image/png\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"gif\":\r\n\t\t\t\theader(\"Content-type: image/gif\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"zip\":\r\n\t\t\t\theader(\"Content-type: application/zip\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"lha\":\r\n\t\t\tcase \"lzh\":\r\n\t\t\t\theader(\"Content-type: application/x-lzh\");\r\n\t\t\t\tbreak;\r\n\t\t\tdefault;\r\n\t\t\theader(\"Content-type: application/octet-stream\");\r\n\t\t}\r\n\t\theader(\"Content-Disposition: attachment; filename=$filename\");\r\n\t\theader('Content-Length: '.filesize($download_filepath));\r\n\r\n\t\treadfile($download_filepath);\r\n\t\texit;\r\n\t}\r\n?>\r\n"], "fixing_code": ["<?php\r\n/**\r\n * Plugin name: Simple Download Button Shortcode\r\n * Plugin URI: http://tech.halulu.org/?p=849\r\n * Author: <a href=\"http://www.halulu.tech/\">Halulu</a>\r\n * Author URI: http://tech.halulu.org/?p=849\r\n * Version: 1.1\r\n * Description:\u30b7\u30e7\u30fc\u30c8\u30b3\u30fc\u30c9\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\u3092\u8868\u793a\u3002DL\u30d7\u30ed\u30b0\u30e9\u30e0\u4ed8\u304d\u3067\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3084\u753b\u50cf\u3082\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002Display CSS3 dwonload bottons by simple Shortcode. This plugin comes with a downloading program that let site visitors donwload source code and images, such as html, php and jpeg.\r\n */\r\n\r\n /*  Copyright 2012 Halulu (email : info@halulu.org)\r\n\r\n    This program is free software; you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License, version 2, as \r\n    published by the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program; if not, write to the Free Software\r\n    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\r\n*/\r\n\r\nfunction disp_downloadButton($atts) {\r\n\r\n\t// set the download program php\r\n\t$plugin_url = plugins_url( basename(dirname(__FILE__))). '/simple-download-button_dl.php'; \r\n\t$html = '';\r\n\r\n\t$style \t\t\t= '';\r\n\t$label\t\t\t= '';\r\n\t\r\n\t/* Shortcode Settings */\r\n\textract(shortcode_atts(array(\r\n\t\t\"file\" => '',\r\n\t\t\"label\" => get_option('label'),\r\n\t\t\"btn\" => get_option('btn_type')\r\n\t), $atts));\r\n\t\r\n\tif(!$label){ $label = 'DOWNLOAD'; }\r\n\r\n\t// button style\r\n\tswitch ($btn) {\r\n\t\tcase 1:\r\n\t\t\t$style = 'class=\"minimal\"';\r\n\t\t\tbreak;\r\n\t\tcase 2:\r\n\t\t\t$style = 'class=\"clean-gray\"';\r\n\t\t\tbreak;\r\n\t\tcase 3:\r\n\t\t\t$style = 'class=\"cupid-green\"';\r\n\t\t\tbreak;\r\n\t\tcase 4:\r\n\t\t\t$style = 'class=\"cupid-blue\"';\r\n\t\t\tbreak;\r\n\t\tcase 5:\r\n\t\t\t$style = 'class=\"blue-pill\"';\r\n\t\t\tbreak;\r\n\t\tcase 6:\r\n\t\t\t$style = 'class=\"thoughtbot\"';\r\n\t\t\tbreak;\r\n\t\tcase 7:\r\n\t\t\t$style = 'class=\"punch\"';\r\n\t\t\tbreak;\r\n\t\tcase 8:\r\n\t\t\t$style = 'class=\"purple-candy\"';\r\n\t\t\tbreak;\r\n\t\tcase 9:\r\n\t\t\t$style = 'class=\"shiny-blue\"';\r\n\t\t\tbreak;\r\n\t\tcase 10:\r\n\t\t\t$style = 'class=\"skip\"';\r\n\t\t\tbreak;\r\n\t\tcase 11:\r\n\t\t\t$style = 'class=\"download-itunes\"';\r\n\t\t\tbreak;\r\n\t\tdefault;\r\n\t\t\tbreak; // keep it empty.\t\t\t\r\n\t}\r\n\r\n\t$html .= str_replace(\r\n\t\tarray(\r\n\t\t\t'%style%',\r\n\t\t\t'%plugin_url%',\r\n\t\t\t'%file%',\r\n\t\t\t'%label%',\r\n\t\t\t'%name%'\r\n\t\t),\r\n\t\tarray(\r\n\t\t\t$style,\r\n\t\t\t$plugin_url,\r\n\t\t\t$file,\r\n\t\t\t$label\r\n\t\t),\r\n\t\t'<div id=\"simple-download-button\"><button %style% onclick=\"location.href=\\'%plugin_url%?file=%file%\\'\"><b>%label%</b></button></div>'\r\n\t);\t\r\n\t\r\n\treturn $html;\r\n}\r\n\r\n/**\r\n * Shortcode hock\r\n */\r\nadd_shortcode('dlbt', 'disp_downloadButton');\r\n\r\n/**\r\n * plugin init\r\n */\r\nfunction downloadbutton_init() {\r\n load_plugin_textdomain('sm-downloadbutton', false, basename( dirname( __FILE__ ) ) . '/languages' );  \r\n}\r\nadd_action('init', 'downloadbutton_init');\r\n\r\n/**\r\n * add stylesheet for the plugin\r\n */\r\nfunction add_downloadbutton_css() {\r\n\t$cssPath = plugin_dir_path( __FILE__ ). '/style.css';\r\n\tif(file_exists($cssPath)){\r\n\t  wp_register_style('style', plugins_url('style.css', __FILE__));\r\n\t  wp_register_style('buttons', plugins_url('buttons.css', __FILE__) );\r\n\t  wp_enqueue_style('style');\r\n\t  wp_enqueue_style('buttons');\r\n\t}\r\n}\r\nadd_action('wp_print_styles', 'add_downloadbutton_css');\r\n\r\n\r\n/**\r\n * Register plugin options page\r\n */\r\nadd_action('admin_init', 'downloadbutton_admin_init' );\r\nadd_action('admin_menu', 'downloadbutton_menu');\r\n\r\n/* Add stylesheet to the option page. */\r\nfunction downloadbutton_admin_init() {\r\n   wp_register_style( 'style', plugins_url('style.css', __FILE__) );\r\n   wp_register_style( 'buttons', plugins_url('buttons.css', __FILE__) );\r\n}\r\nfunction downloadbutton_menu() {\r\n\t$page = add_options_page('Plugin Options', 'Download Button', 8, __FILE__, 'downloadbutton_options');\r\n\tadd_action( 'admin_print_styles-' . $page, 'downloadbutton_admin_styles' );\r\n}\r\nfunction downloadbutton_admin_styles() {\r\n   wp_enqueue_style( 'style' );\r\n   wp_enqueue_style( 'buttons' );\r\n}\r\n\r\n/**\r\n * plugin options page\r\n */\r\nfunction downloadbutton_options() {\r\n\r\n?> \r\n    <div class=\"wrap\">\r\n\t<div id=\"simple-download-button\">\r\n        <h2>Simple Download Button Options</h2>\r\n        <form method=\"post\" action=\"options.php\">\r\n            <?php wp_nonce_field('update-options'); ?>\r\n            <div class=\"box2\">\r\n\t\t\t<h3><?php _e('Absolute path to download file containing directory', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<p><?php _e('your-wordpress-home', 'sm-downloadbutton') ?>/wp-content/plugins/simple-download-button/download/</p>\r\n\t\t\t<p><font color=\"red\"><?php _e('ATTENTION: All user downloads have to be uploaded to the directory indicated above.', 'sm-downloadbutton') ?></font></p>\r\n\t\t\t<h3><?php _e('Short Code Parameters', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<ul>\r\n\t\t\t<li><strong>file</strong> = <?php _e('user download file name with its extention (must given)', 'sm-downloadbutton') ?></li>\r\n\t\t\t<li><strong>label</strong> = <?php _e('letters to display on the donwload button (optional)', 'sm-downloadbutton') ?></li>\r\n\t\t\t<li><strong>btn</strong> = <?php _e('button design number 0 to 11 (optional) *see the design option', 'sm-downloadbutton') ?></li>\t\r\n\t\t\t</ul>\r\n\t\t\t<p>\r\n\t\t\t<br />[dlbt file=sample.html]\r\n\t\t\t<br />[dlbt file=sample.html label=<?php _e('SAMPLE', 'sm-downloadbutton') ?>]\r\n\t\t\t<br />[dlbt file=sample.html label=<?php _e('SAMPLE', 'sm-downloadbutton') ?> btn=10]</p>\r\n\t\t\t</div>\r\n            <div class=\"box\">\r\n\t\t\t<h3><?php _e('Label on the button (option)', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<p><?php _e('letters to display on the donwload button.', 'sm-downloadbutton') ?></p>\r\n\t\t\t<p><?php _e('Default', 'sm-downloadbutton') ?>: DOWNLOAD</p>\r\n\t\t\t<input type=\"text\" size=\"50\" name=\"label\" value=\"<?php echo get_option('label'); ?>\" />\r\n\t\t\t</div>\r\n            <div class=\"box\">\r\n\t\t\t<h3><?php _e('Design for download button (option)', 'sm-downloadbutton') ?></h3>\r\n\t\t\t<table>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"0\" <?php if (!get_option('btn_type')) : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('no style', 'sm-downloadbutton') ?><?php _e(' (default)', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><a>DOWNLOAD</a></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"1\" <?php if (get_option('btn_type')=='1') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style1', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"minimal\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"2\" <?php if (get_option('btn_type')=='2') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style2', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"clean-gray\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"3\" <?php if (get_option('btn_type')=='3') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style3', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"cupid-green\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"4\" <?php if (get_option('btn_type')=='4') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style4', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"cupid-blue\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"5\" <?php if (get_option('btn_type')=='5') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style5', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"blue-pill\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"6\" <?php if (get_option('btn_type')=='6') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style6', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"thoughtbot\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"7\" <?php if (get_option('btn_type')=='7') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style7', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"punch\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"8\" <?php if (get_option('btn_type')=='8') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style8', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"purple-candy\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"9\" <?php if (get_option('btn_type')=='9') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style9', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"shiny-blue\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"10\" <?php if (get_option('btn_type')=='10') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style10', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"skip\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n                <tr valign=\"top\">\r\n                    <td><input type=\"radio\" name=\"btn_type\" value=\"11\" <?php if (get_option('btn_type')=='11') : ?>checked<?php endif; ?> /></td>\r\n\t\t\t\t\t<td><?php _e('style11', 'sm-downloadbutton') ?></td>\r\n\t\t\t\t\t<td><button class=\"download-itunes\" onclick=\"return false;\">DOWNLOAD</button></td>\r\n                </tr>\r\n\t\t\t</table>\r\n\t\t\t<p>*All buttons are designed & shared by <a href=\"http://hellohappy.org/css3-buttons/\" target=\"_blank\">Chad Mazzola</a>.</p>\r\n\t\t\t</div>\r\n            <input type=\"hidden\" name=\"action\" value=\"update\" />\r\n            <input type=\"hidden\" name=\"page_options\" value=\"path,label,btn_type\" />\r\n            <p class=\"submit\">\r\n                <input type=\"submit\" class=\"button-primary\" value=\"<?php _e('Save Changes') ?>\" />\r\n            </p>\r\n        </form>\r\n    </div>\r\n    </div>\r\n<p><?php _e('To send feedback, requests or find more about the plugin, visit <a href=\"tech.halulu.org\" target=\"_blank\">here</a> or feel free to <a href=\"mailto:info@halulu.org\">email</a> me. Thank you!', 'sm-downloadbutton') ?><p>\r\n<?php\r\n}\r\n?>\r\n", "<?php\r\n\t/* Admin Settings*/\r\n\t// download files containing dir\t\r\n\t$download_dir\t= dirname(__FILE__). '/download/';\r\n\r\n\t/* GET param */\r\n\t$filename = $_GET['file'];\r\n\t\t\r\n\t/* Verify file parameter */\r\n\t$fileinfo =\tpathinfo($filename);\t\r\n\tif(!$fileinfo['filename']){\r\n\t\tdie(\"ERROR: Downloading filename is not set. Please set the name. the short code should be wriiten like [dlbt file=dummy.html] \");\r\n\t}elseif(!$fileinfo['extension']){\r\n\t\tdie(\"ERROR: Unappropriate downloading filename: $filename: no extention.\");\t\t\r\n\t}\r\n\tif(!preg_match('/^[a-zA-Z0-9_-]/',$fileinfo['filename'])) {\r\n\t\tdie(\"ERROR: Unappropriate downloading filename: $filename: filename can contains only 'a-z', 'A-Z' '0-9', '-' and '_'\");\t\t\r\n\t}\r\n\t// making file path\t\t\r\n\t$download_filepath = $download_dir. $fileinfo['filename']. '.'. $fileinfo['extension'];\r\n\t\r\n\t// set a file name showed in the dialog box.\r\n\tif(!$dispname){$dispname = $filename;}\r\n\tmb_convert_encoding($dispname, \"UTF-8\");\r\n\r\n\t/* set the Content-type depends on the extention */\r\n\tif (!file_exists($download_filepath)) {\r\n\t\tdie(\"ERROR: There is not shuch file at $download_filepath.\");\r\n\t}else{\r\n\t\t$file_info = pathinfo($download_filepath);\r\n\t\t$ext = strtolower($file_info[\"extension\"]);\r\n\t\tswitch ($ext) {\r\n\t\t\tcase \"pdf\":\r\n\t\t\t\theader(\"Content-type: application/pdf\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"txt\":\r\n\t\t\t\theader(\"Content-type: text/plain\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"csv\":\r\n\t\t\t\theader(\"Content-type: text/csv\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"doc\":\r\n\t\t\t\theader(\"Content-type: application/msword\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"xls\":\r\n\t\t\t\theader(\"Content-type: application/vnd.ms-excel\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"html\":\r\n\t\t\tcase \"htm\":\r\n\t\t\t\theader(\"Content-type: text/html\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"css\":\r\n\t\t\t\theader(\"Content-type: text/css\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"js\":\r\n\t\t\t\theader(\"Content-type: text/javascript\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"jpg\":\r\n\t\t\tcase \"jpeg\":\r\n\t\t\t\theader(\"Content-type: image/jpeg\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"png\":\r\n\t\t\t\theader(\"Content-type: image/png\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"gif\":\r\n\t\t\t\theader(\"Content-type: image/gif\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"zip\":\r\n\t\t\t\theader(\"Content-type: application/zip\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"lha\":\r\n\t\t\tcase \"lzh\":\r\n\t\t\t\theader(\"Content-type: application/x-lzh\");\r\n\t\t\t\tbreak;\r\n\t\t\tdefault;\r\n\t\t\theader(\"Content-type: application/octet-stream\");\r\n\t\t}\r\n\t\theader(\"Content-Disposition: attachment; filename=$filename\");\r\n\t\theader('Content-Length: '.filesize($download_filepath));\r\n\r\n\t\treadfile($download_filepath);\r\n\t\texit;\r\n\t}\r\n?>\r\n"], "filenames": ["simple-download-button.php", "simple-download-button_dl.php"], "buggy_code_start_loc": [7, 8], "buggy_code_end_loc": [101, 19], "fixing_code_start_loc": [7, 8], "fixing_code_end_loc": [99, 29], "type": "NVD-CWE-noinfo", "message": "A vulnerability classified as problematic has been found in Halulu simple-download-button-shortcode Plugin 1.0 on WordPress. Affected is an unknown function of the file simple-download-button_dl.php of the component Download Handler. The manipulation of the argument file leads to information disclosure. It is possible to launch the attack remotely. Upgrading to version 1.1 is able to address this issue. The patch is identified as e648a8706818297cf02a665ae0bae1c069dea5f1. It is recommended to upgrade the affected component. VDB-242190 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2012-10016", "sourceIdentifier": "cna@vuldb.com", "published": "2023-10-17T00:15:10.603", "lastModified": "2024-02-29T01:12:28.427", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic has been found in Halulu simple-download-button-shortcode Plugin 1.0 on WordPress. Affected is an unknown function of the file simple-download-button_dl.php of the component Download Handler. The manipulation of the argument file leads to information disclosure. It is possible to launch the attack remotely. Upgrading to version 1.1 is able to address this issue. The patch is identified as e648a8706818297cf02a665ae0bae1c069dea5f1. It is recommended to upgrade the affected component. VDB-242190 is the identifier assigned to this vulnerability."}, {"lang": "es", "value": "Una vulnerabilidad ha sido encontrada en Halulu simple-download-button-shortcode Plugin 1.0 de WordPress y clasificada como problem\u00e1tica. Una funci\u00f3n desconocida del archivo simple-download-button_dl.php del componente Download Handler es afectada por esta vulnerabilidad. La manipulaci\u00f3n del archivo de argumentos conduce a la divulgaci\u00f3n de informaci\u00f3n. Es posible lanzar el ataque de forma remota. La actualizaci\u00f3n a la versi\u00f3n 1.1 puede solucionar este problema. El parche se identifica como e648a8706818297cf02a665ae0bae1c069dea5f1. Se recomienda actualizar el componente afectado. VDB-242190 es el identificador asignado a esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:halulu:simple-download-button-shortcode:1.0:*:*:*:*:wordpress:*:*", "matchCriteriaId": "32AD9DB1-C290-4DAF-9DF2-B90916CB7AE6"}]}]}], "references": [{"url": "https://github.com/wp-plugins/simple-download-button-shortcode/commit/e648a8706818297cf02a665ae0bae1c069dea5f1", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.242190", "source": "cna@vuldb.com", "tags": ["Permissions Required"]}, {"url": "https://vuldb.com/?id.242190", "source": "cna@vuldb.com", "tags": ["Permissions Required"]}]}, "github_commit_url": "https://github.com/wp-plugins/simple-download-button-shortcode/commit/e648a8706818297cf02a665ae0bae1c069dea5f1"}}