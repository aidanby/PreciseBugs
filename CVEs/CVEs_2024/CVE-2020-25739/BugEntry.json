{"buggy_code": ["language: ruby\nsudo: false\nenv:\n  - \"RABL_GEM=rabl\"\n  - \"RABL_GEM=rabl-rails\"\n\nrvm:\n  - 2.2.10\n  - 2.3.7\n  - 2.4.4\n  - 2.5.1\n  - ruby-head\n", "# CHANGELOG\n\n## [Unreleased]\n\n## [6.3.2] - 2019-11-18\n### Security\n- Restrict possibility of vulnerable i18n legacy verision (0.3.6.pre)\n  installation\n\n## [6.3.1] - 2019-11-18\n### Changed\n- ActionView::Base and ActionController::Base should be loaded inside\n  ActiveSupport.on_load hook. Thanks to @amatsuda\n- Require Ruby >= 2.2.2 (activesupport). Thanks to @nicolasleger\n- Update old_rails.rb to reflect GonHelpers -> ControllerHelpers name change.\n  Thanks to @etipton\n\n## [6.2.1] - 2018-07-11\n### Changed\n- Update README: correct spelling mistake. Thanks to @EdwardBetts\n- Autoload test classes only in test env. Thanks to @wilddima\n\n### Fixed\n- Fix keys cache. Thanks to @ertrzyiks\n- fixing tests by running with rabl and rabl-rails separately. Thanks to\n  @dsalahutdinov\n\n## [6.2.0] - 2017-10-04\n### Added\n- Introduce keys cache. Thanks to @vlazar\n- Add possibleErrorCallback to watch params. Thanks to @etagwerker\n\n### Changed\n- Update readme with PhoenixGon hex link. Thanks to @khusnetdinov\n- Fix code highlighting in README. Thanks to @ojab\n- Refactoring: use attr_reader\n\n### Removed\n- Remove unnecessary json dependency.\n- Remove rubysl and rubinius-developer_tools gem.\n\n## [6.1.0] - 2016-07-11\n### Deprecated\n- env is deprecated and will be removed from Rails 5.0. Thanks to @dlupu\n\n### Fixed\n- fix merging routes bug. Thanks to @strikyflo\n- Show what method was used in public methods error.\n\n### Changed\n- Use 'need_tag' as option name to prevent calling 'tag' method. Thanks to\n  @june29\n- Update README; comment out gon.clear from sample code. Thanks to\n  @speee-nakajima\n- Update README; Replace the include_gon method with render_data method.\n- Refactoring: use attr_accessor method.\n- Refactoring: use attr_reader method.\n\n## [6.0.1] - 2015-07-22\n### Changed\n- Free dependencies\n\n## [6.0.0] - 2015-07-22\n### Added\n- nonce option. Thanks to @joeljackson\n\n### Changed\n- Refactoring\n- Included rails url_helpers into jbuilder. Thanks to @razum2um\n\n## [5.2.3] - 2014-11-03\n### Added\n- Coffescript implementation of watch.js. Thanks to @willcosgrove\n- unwatchAll function in watch.js. Thanks to @willcosgrove\n\n## [5.2.2] - 2014-10-31\n### Added\n- support for controller helper methods in jbuilder\n\n## [5.2.1] - 2014-10-28\n### Added\n- merge variable feature (for merge hash-like variables instead of overriding\n  them). Thanks to @jalkoby\n\n### Fixed\n- fix for jbuilder module. Thanks to @jankovy\n\n## [5.2.0] - 2014-08-26\n### Added\n- namespace_check option. Thanks to @tommyh\n- AMD compatible version of including gon. Thanks to @vijoc\n\n### Changed\n- Only inject gon into ActionController::Base-like object in spec_helper. Thanks\n  to @kevinoconnor7\n\n### Fixed\n- fix issue where include_gon would raise exception if the controller did not\n  assign any gon variables. Thanks to @asalme\n\n## [5.1.2] - 2014-07-22\n### Changed\n- Clarifying helpers, dump gon#watch content to safe json before render. Thanks\n  to @Strech\n\n## [5.1.1] - 2014-07-17\n### Added\n- global_root option. Thanks to @rafaelliu\n- MultiJson support. Thanks to @Strech\n\n## [5.1.0] - 2014-06-29\n### Fixed\n- Many fixes. Thanks to @Silex, @kilefritz, @irobayna, @kyrylo, @randoum,\n  @jackquack, @tuvistavie, @Strech for awesome commits and help!\n\n## [5.0.4] - 2014-02-13\n### Fixed\n- Fix check for get and assign variables for Gon.global\n\n## [5.0.3] - 2014-02-12\n### Removed\n- Revert changes in gemspec\n\n## [5.0.2] - 2014-02-12\n### Fixed\n- Fix issue when there is no gon object for current thread and rendering\n  include_gon (#108 part) (wasn't fixed) (@gregmolnar)\n\n## [5.0.1] - 2013-12-30\n### Fixed\n- Fix issue when there is no gon object for current thread and rendering\n  include_gon (#108 part)\n\n## [5.0.0] - 2013-12-26\n### Changed\n- Gon is threadsafe now! (@razum2um)\n- Camelcasing with depth (@MaxSchmeling)\n- Optional CDATA and style refactoring (@torbjon)\n- jBuilder supports not only String and Hash types of locals (@steakchaser)\n- Using ActionDispatch::Request#uuid instead of ActionDispatch::Request#id\n  (@sharshenov)\n\n## [4.1.1] - 2013-06-04\n### Fixed\n- Fixed critical XSS vulnerability https://github.com/gazay/gon/issues/84\n  (@vadimr & @Hebo)\n\n## [4.1.0] - 2013-04-14\n### Added\n- rabl-rails support (@jtherrell)\n\n### Changed\n- Refactored script tag generation (@toothrot)\n- Stop support for MRI 1.8.7\n- Accepting locals in jbuilder templates\n\n## [4.0.3] - 2013-04-14\n!!!IMPORTANT!!! Last version with compatibility for MRI 1.8.7\n\n### Added\n- new method `Gon#push` for assign variables through Hash-like objects (@topdev)\n### Changed\n- Fixes for 1.8.7 compatibility.\n\n## [4.0.2] - 2012-12-17\n### Fixed\n- Fixed gon.watch in JS without callback and options\n\n## [4.0.1] - 2012-10-25\n### Added\n- option :locals to gon.rabl functionality\n\n### Changed\n- Gon#set_variable and Gon#get_variable moved to public scope\n\n### Removed\n- BlankSlate requirement (@phoet)\n\n## [4.0.0] - 2012-07-23\n### Added\n- gon.watch functionality (thanks to @brainopia and @kossnocorp)\n- Compatibility with jbuilder paths for partial! method\n\n### Changed\n- Little bit refactoring - Gon now is a class\n\n### Fixed\n- Fixed some bugs\n\n## [3.0.5] - 2012-06-22\n### Added\n- type text/javascript option (@torbjon)\n\n### Changed\n- A litlle bit refactoring\n- Made compatible with active support json encoding for escaping script tags\n\n### Fixed\n- bug for init option\n- clear if init true (@torbjon)\n\n## [3.0.4] - 2012-06-02\n### Fixed\n- Fix bug with gon clear with global variables, bump version\n\n## [3.0.3] - 2012-05-22\n### Added\n- init option (@torbjon)\n\n### Changed\n- Include ActionView::Helpers into Gon::JBuilder\n\n## [3.0.2] - 2012-04-28\n### Added\n- need_tag option (@afa)\n\n## [3.0.0] - 2012-04-17\n### Added\n- Added Gon.global for using gon everywhere\n\n### Changed\n- Almost all code refactored\n- Included ActionView::Helpers into Rabl::Engine\n\n## [2.3.0] - 2012-04-09\n### Changed\n- Don't really remember what was before this version\n\n[Unreleased]: https://github.com/gazay/gon/compare/v6.3.2...master\n[6.3.2]: https://github.com/gazay/gon/compare/v6.3.1...v6.3.2\n[6.3.1]: https://github.com/gazay/gon/compare/v6.2.1...v6.3.1\n[6.2.1]: https://github.com/gazay/gon/compare/v6.2.0...v6.2.1\n[6.2.0]: https://github.com/gazay/gon/compare/v6.1.0...v6.2.0\n[6.1.0]: https://github.com/gazay/gon/compare/v6.0.1...v6.1.0\n[6.0.1]: https://github.com/gazay/gon/compare/v6.0.0...v6.0.1\n[6.0.0]: https://github.com/gazay/gon/compare/v5.2.3...v6.0.0\n[5.2.3]: https://github.com/gazay/gon/compare/v5.2.2...v5.2.3\n[5.2.2]: https://github.com/gazay/gon/compare/v5.2.1...v5.2.2\n[5.2.1]: https://github.com/gazay/gon/compare/v5.2.0...v5.2.1\n[5.2.0]: https://github.com/gazay/gon/compare/v5.1.2...v5.2.0\n[5.1.2]: https://github.com/gazay/gon/compare/v5.1.1...v5.1.2\n[5.1.1]: https://github.com/gazay/gon/compare/v5.1.0...v5.1.1\n[5.1.0]: https://github.com/gazay/gon/compare/v5.0.4...v5.1.0\n[5.0.4]: https://github.com/gazay/gon/compare/v5.0.3...v5.0.4\n[5.0.3]: https://github.com/gazay/gon/compare/v5.0.2...v5.0.3\n[5.0.2]: https://github.com/gazay/gon/compare/v5.0.1...v5.0.2\n[5.0.1]: https://github.com/gazay/gon/compare/v5.0.0...v5.0.1\n[5.0.0]: https://github.com/gazay/gon/compare/v4.1.1...v5.0.0\n[4.1.1]: https://github.com/gazay/gon/compare/v4.1.0...v4.1.1\n[4.1.0]: https://github.com/gazay/gon/compare/v4.0.3...v4.1.0\n[4.0.3]: https://github.com/gazay/gon/compare/v4.0.2...v4.0.3\n[4.0.2]: https://github.com/gazay/gon/compare/v4.0.1...v4.0.2\n[4.0.1]: https://github.com/gazay/gon/compare/v4.0.0...v4.0.1\n[4.0.0]: https://github.com/gazay/gon/compare/v3.0.5...v4.0.0\n[3.0.5]: https://github.com/gazay/gon/compare/v3.0.4...v3.0.5\n[3.0.4]: https://github.com/gazay/gon/compare/v3.0.3...v3.0.4\n[3.0.3]: https://github.com/gazay/gon/compare/v3.0.2...v3.0.3\n[3.0.2]: https://github.com/gazay/gon/compare/v3.0.0...v3.0.2\n[3.0.0]: https://github.com/gazay/gon/compare/v2.3.0...v3.0.0\n[2.3.0]: https://github.com/gazay/gon/releases/tag/v2.3.0\n", "lib = File.expand_path('../lib', __FILE__)\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\nrequire 'gon/version'\n\nGem::Specification.new do |s|\n  s.name        = 'gon'\n  s.version     = Gon::VERSION\n  s.platform    = Gem::Platform::RUBY\n  s.authors     = ['gazay']\n  s.licenses    = ['MIT']\n  s.email       = ['alex.gaziev@gmail.com']\n  s.homepage    = 'https://github.com/gazay/gon'\n  s.summary     = %q{Get your Rails variables in your JS}\n  s.description = %q{If you need to send some data to your js files and you don't want to do this with long way trough views and parsing - use this force!}\n\n  s.files         = `git ls-files`.split(\"\\n\")\n  s.require_paths = ['lib']\n  s.required_ruby_version = '>= 2.2.0'\n  s.add_dependency 'actionpack', '>= 3.0.20'\n  s.add_dependency 'i18n', '>= 0.7'\n  s.add_dependency 'request_store', '>= 1.0'\n  s.add_dependency 'multi_json'\n  s.add_development_dependency 'rabl', '0.11.3'\n  s.add_development_dependency 'rabl-rails'\n  s.add_development_dependency 'rspec', '>= 3.0'\n  s.add_development_dependency 'jbuilder'\n  s.add_development_dependency 'railties', '>= 3.0.20'\n  s.add_development_dependency 'rake'\n  s.add_development_dependency 'pry'\nend\n", "class Gon\n  module JsonDumper\n    def self.dump(object)\n      MultiJson.dump object,\n        mode: :compat, escape_mode: :xss_safe, time_format: :ruby\n    end\n  end\nend\n", "class Gon\n  VERSION = '6.3.2'\nend\n"], "fixing_code": ["language: ruby\nsudo: false\nenv:\n  - \"RABL_GEM=rabl\"\n  - \"RABL_GEM=rabl-rails\"\n\nrvm:\n  - 2.2.10\n  - 2.3.8\n  - 2.4.10\n  - 2.5.8\n  - 2.6.6\n  - 2.7.1\n  - ruby-head\n", "# CHANGELOG\n\n## [Unreleased]\n\n## [6.4.0] - 2020-09-18\n### Security\n- CVE-2020-25739: Enforce HTML entities escaping in gon output\n\n## [6.3.2] - 2019-11-18\n### Security\n- Restrict possibility of vulnerable i18n legacy verision (0.3.6.pre)\n  installation\n\n## [6.3.1] - 2019-11-18\n### Changed\n- ActionView::Base and ActionController::Base should be loaded inside\n  ActiveSupport.on_load hook. Thanks to @amatsuda\n- Require Ruby >= 2.2.2 (activesupport). Thanks to @nicolasleger\n- Update old_rails.rb to reflect GonHelpers -> ControllerHelpers name change.\n  Thanks to @etipton\n\n## [6.2.1] - 2018-07-11\n### Changed\n- Update README: correct spelling mistake. Thanks to @EdwardBetts\n- Autoload test classes only in test env. Thanks to @wilddima\n\n### Fixed\n- Fix keys cache. Thanks to @ertrzyiks\n- fixing tests by running with rabl and rabl-rails separately. Thanks to\n  @dsalahutdinov\n\n## [6.2.0] - 2017-10-04\n### Added\n- Introduce keys cache. Thanks to @vlazar\n- Add possibleErrorCallback to watch params. Thanks to @etagwerker\n\n### Changed\n- Update readme with PhoenixGon hex link. Thanks to @khusnetdinov\n- Fix code highlighting in README. Thanks to @ojab\n- Refactoring: use attr_reader\n\n### Removed\n- Remove unnecessary json dependency.\n- Remove rubysl and rubinius-developer_tools gem.\n\n## [6.1.0] - 2016-07-11\n### Deprecated\n- env is deprecated and will be removed from Rails 5.0. Thanks to @dlupu\n\n### Fixed\n- fix merging routes bug. Thanks to @strikyflo\n- Show what method was used in public methods error.\n\n### Changed\n- Use 'need_tag' as option name to prevent calling 'tag' method. Thanks to\n  @june29\n- Update README; comment out gon.clear from sample code. Thanks to\n  @speee-nakajima\n- Update README; Replace the include_gon method with render_data method.\n- Refactoring: use attr_accessor method.\n- Refactoring: use attr_reader method.\n\n## [6.0.1] - 2015-07-22\n### Changed\n- Free dependencies\n\n## [6.0.0] - 2015-07-22\n### Added\n- nonce option. Thanks to @joeljackson\n\n### Changed\n- Refactoring\n- Included rails url_helpers into jbuilder. Thanks to @razum2um\n\n## [5.2.3] - 2014-11-03\n### Added\n- Coffescript implementation of watch.js. Thanks to @willcosgrove\n- unwatchAll function in watch.js. Thanks to @willcosgrove\n\n## [5.2.2] - 2014-10-31\n### Added\n- support for controller helper methods in jbuilder\n\n## [5.2.1] - 2014-10-28\n### Added\n- merge variable feature (for merge hash-like variables instead of overriding\n  them). Thanks to @jalkoby\n\n### Fixed\n- fix for jbuilder module. Thanks to @jankovy\n\n## [5.2.0] - 2014-08-26\n### Added\n- namespace_check option. Thanks to @tommyh\n- AMD compatible version of including gon. Thanks to @vijoc\n\n### Changed\n- Only inject gon into ActionController::Base-like object in spec_helper. Thanks\n  to @kevinoconnor7\n\n### Fixed\n- fix issue where include_gon would raise exception if the controller did not\n  assign any gon variables. Thanks to @asalme\n\n## [5.1.2] - 2014-07-22\n### Changed\n- Clarifying helpers, dump gon#watch content to safe json before render. Thanks\n  to @Strech\n\n## [5.1.1] - 2014-07-17\n### Added\n- global_root option. Thanks to @rafaelliu\n- MultiJson support. Thanks to @Strech\n\n## [5.1.0] - 2014-06-29\n### Fixed\n- Many fixes. Thanks to @Silex, @kilefritz, @irobayna, @kyrylo, @randoum,\n  @jackquack, @tuvistavie, @Strech for awesome commits and help!\n\n## [5.0.4] - 2014-02-13\n### Fixed\n- Fix check for get and assign variables for Gon.global\n\n## [5.0.3] - 2014-02-12\n### Removed\n- Revert changes in gemspec\n\n## [5.0.2] - 2014-02-12\n### Fixed\n- Fix issue when there is no gon object for current thread and rendering\n  include_gon (#108 part) (wasn't fixed) (@gregmolnar)\n\n## [5.0.1] - 2013-12-30\n### Fixed\n- Fix issue when there is no gon object for current thread and rendering\n  include_gon (#108 part)\n\n## [5.0.0] - 2013-12-26\n### Changed\n- Gon is threadsafe now! (@razum2um)\n- Camelcasing with depth (@MaxSchmeling)\n- Optional CDATA and style refactoring (@torbjon)\n- jBuilder supports not only String and Hash types of locals (@steakchaser)\n- Using ActionDispatch::Request#uuid instead of ActionDispatch::Request#id\n  (@sharshenov)\n\n## [4.1.1] - 2013-06-04\n### Fixed\n- Fixed critical XSS vulnerability https://github.com/gazay/gon/issues/84\n  (@vadimr & @Hebo)\n\n## [4.1.0] - 2013-04-14\n### Added\n- rabl-rails support (@jtherrell)\n\n### Changed\n- Refactored script tag generation (@toothrot)\n- Stop support for MRI 1.8.7\n- Accepting locals in jbuilder templates\n\n## [4.0.3] - 2013-04-14\n!!!IMPORTANT!!! Last version with compatibility for MRI 1.8.7\n\n### Added\n- new method `Gon#push` for assign variables through Hash-like objects (@topdev)\n### Changed\n- Fixes for 1.8.7 compatibility.\n\n## [4.0.2] - 2012-12-17\n### Fixed\n- Fixed gon.watch in JS without callback and options\n\n## [4.0.1] - 2012-10-25\n### Added\n- option :locals to gon.rabl functionality\n\n### Changed\n- Gon#set_variable and Gon#get_variable moved to public scope\n\n### Removed\n- BlankSlate requirement (@phoet)\n\n## [4.0.0] - 2012-07-23\n### Added\n- gon.watch functionality (thanks to @brainopia and @kossnocorp)\n- Compatibility with jbuilder paths for partial! method\n\n### Changed\n- Little bit refactoring - Gon now is a class\n\n### Fixed\n- Fixed some bugs\n\n## [3.0.5] - 2012-06-22\n### Added\n- type text/javascript option (@torbjon)\n\n### Changed\n- A litlle bit refactoring\n- Made compatible with active support json encoding for escaping script tags\n\n### Fixed\n- bug for init option\n- clear if init true (@torbjon)\n\n## [3.0.4] - 2012-06-02\n### Fixed\n- Fix bug with gon clear with global variables, bump version\n\n## [3.0.3] - 2012-05-22\n### Added\n- init option (@torbjon)\n\n### Changed\n- Include ActionView::Helpers into Gon::JBuilder\n\n## [3.0.2] - 2012-04-28\n### Added\n- need_tag option (@afa)\n\n## [3.0.0] - 2012-04-17\n### Added\n- Added Gon.global for using gon everywhere\n\n### Changed\n- Almost all code refactored\n- Included ActionView::Helpers into Rabl::Engine\n\n## [2.3.0] - 2012-04-09\n### Changed\n- Don't really remember what was before this version\n\n[Unreleased]: https://github.com/gazay/gon/compare/v6.3.2...master\n[6.3.2]: https://github.com/gazay/gon/compare/v6.3.1...v6.3.2\n[6.3.1]: https://github.com/gazay/gon/compare/v6.2.1...v6.3.1\n[6.2.1]: https://github.com/gazay/gon/compare/v6.2.0...v6.2.1\n[6.2.0]: https://github.com/gazay/gon/compare/v6.1.0...v6.2.0\n[6.1.0]: https://github.com/gazay/gon/compare/v6.0.1...v6.1.0\n[6.0.1]: https://github.com/gazay/gon/compare/v6.0.0...v6.0.1\n[6.0.0]: https://github.com/gazay/gon/compare/v5.2.3...v6.0.0\n[5.2.3]: https://github.com/gazay/gon/compare/v5.2.2...v5.2.3\n[5.2.2]: https://github.com/gazay/gon/compare/v5.2.1...v5.2.2\n[5.2.1]: https://github.com/gazay/gon/compare/v5.2.0...v5.2.1\n[5.2.0]: https://github.com/gazay/gon/compare/v5.1.2...v5.2.0\n[5.1.2]: https://github.com/gazay/gon/compare/v5.1.1...v5.1.2\n[5.1.1]: https://github.com/gazay/gon/compare/v5.1.0...v5.1.1\n[5.1.0]: https://github.com/gazay/gon/compare/v5.0.4...v5.1.0\n[5.0.4]: https://github.com/gazay/gon/compare/v5.0.3...v5.0.4\n[5.0.3]: https://github.com/gazay/gon/compare/v5.0.2...v5.0.3\n[5.0.2]: https://github.com/gazay/gon/compare/v5.0.1...v5.0.2\n[5.0.1]: https://github.com/gazay/gon/compare/v5.0.0...v5.0.1\n[5.0.0]: https://github.com/gazay/gon/compare/v4.1.1...v5.0.0\n[4.1.1]: https://github.com/gazay/gon/compare/v4.1.0...v4.1.1\n[4.1.0]: https://github.com/gazay/gon/compare/v4.0.3...v4.1.0\n[4.0.3]: https://github.com/gazay/gon/compare/v4.0.2...v4.0.3\n[4.0.2]: https://github.com/gazay/gon/compare/v4.0.1...v4.0.2\n[4.0.1]: https://github.com/gazay/gon/compare/v4.0.0...v4.0.1\n[4.0.0]: https://github.com/gazay/gon/compare/v3.0.5...v4.0.0\n[3.0.5]: https://github.com/gazay/gon/compare/v3.0.4...v3.0.5\n[3.0.4]: https://github.com/gazay/gon/compare/v3.0.3...v3.0.4\n[3.0.3]: https://github.com/gazay/gon/compare/v3.0.2...v3.0.3\n[3.0.2]: https://github.com/gazay/gon/compare/v3.0.0...v3.0.2\n[3.0.0]: https://github.com/gazay/gon/compare/v2.3.0...v3.0.0\n[2.3.0]: https://github.com/gazay/gon/releases/tag/v2.3.0\n", "lib = File.expand_path('../lib', __FILE__)\n$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)\nrequire 'gon/version'\n\nGem::Specification.new do |s|\n  s.name        = 'gon'\n  s.version     = Gon::VERSION\n  s.platform    = Gem::Platform::RUBY\n  s.authors     = ['gazay']\n  s.licenses    = ['MIT']\n  s.email       = ['alex.gaziev@gmail.com']\n  s.homepage    = 'https://github.com/gazay/gon'\n  s.summary     = %q{Get your Rails variables in your JS}\n  s.description = %q{If you need to send some data to your js files and you don't want to do this with long way trough views and parsing - use this force!}\n\n  s.files         = `git ls-files`.split(\"\\n\")\n  s.require_paths = ['lib']\n  s.required_ruby_version = '>= 2.2.0'\n  s.add_dependency 'actionpack', '>= 3.0.20'\n  s.add_dependency 'i18n', '>= 0.7'\n  s.add_dependency 'request_store', '>= 1.0'\n  s.add_dependency 'multi_json'\n  s.add_development_dependency 'rabl', '0.11.3'\n  s.add_development_dependency 'rabl-rails'\n  s.add_development_dependency 'rspec', '>= 3.0'\n  s.add_development_dependency 'jbuilder'\n  s.add_development_dependency 'railties', '>= 3.0.20'\n  s.add_development_dependency 'rake'\n  s.add_development_dependency 'pry'\n  s.add_development_dependency 'pry-byebug'\nend\n", "class Gon\n  module JsonDumper\n    # Taken from ERB::Util\n    JSON_ESCAPE_REGEXP\t=\t/[\\u2028\\u2029&><]/u\n    JSON_ESCAPE\t=\t{\n      \"&\" => '\\u0026',\n      \">\" => '\\u003e',\n      \"<\" => '\\u003c',\n      \"\\u2028\" => '\\u2028',\n      \"\\u2029\" => '\\u2029'\n    }\n\n    def self.dump(object)\n      dumped_json = MultiJson.dump object,\n        mode: :compat, escape_mode: :xss_safe, time_format: :ruby\n      escape(dumped_json)\n    end\n\n    def self.escape(json)\n      json.gsub(JSON_ESCAPE_REGEXP, JSON_ESCAPE)\n    end\n  end\nend\n", "class Gon\n  VERSION = '6.4.0'\nend\n"], "filenames": [".travis.yml", "CHANGELOG.md", "gon.gemspec", "lib/gon/json_dumper.rb", "lib/gon/version.rb"], "buggy_code_start_loc": [9, 3, 29, 2, 2], "buggy_code_end_loc": [12, 3, 29, 5, 3], "fixing_code_start_loc": [9, 4, 30, 3, 2], "fixing_code_end_loc": [14, 8, 31, 21, 3], "type": "CWE-79", "message": "An issue was discovered in the gon gem before gon-6.4.0 for Ruby. MultiJson does not honor the escape_mode parameter to escape fields as an XSS protection mechanism. To mitigate, json_dumper.rb in gon now does escaping for XSS by default without relying on MultiJson.", "other": {"cve": {"id": "CVE-2020-25739", "sourceIdentifier": "cve@mitre.org", "published": "2020-09-23T14:15:12.947", "lastModified": "2023-01-31T21:14:45.767", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in the gon gem before gon-6.4.0 for Ruby. MultiJson does not honor the escape_mode parameter to escape fields as an XSS protection mechanism. To mitigate, json_dumper.rb in gon now does escaping for XSS by default without relying on MultiJson."}, {"lang": "es", "value": "Se detect\u00f3 un problema en la gema gon versiones anteriores a gon-6.4.0 para Ruby.&#xa0;MultiJson, no respeta el par\u00e1metro escape_mode para escapar de los campos como mecanismo de protecci\u00f3n XSS.&#xa0;Para mitigar, el archivo json_dumper.rb en gon ahora escapa para un ataque de tipo XSS por defecto sin depender de MultiJson"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gon_project:gon:*:*:*:*:*:ruby:*:*", "versionEndExcluding": "6.4.0", "matchCriteriaId": "4384547B-8EE3-412A-B8C0-305991A8070C"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*", "matchCriteriaId": "23A7C53F-B80F-4E6A-AFA9-58EEA84BE11D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}], "references": [{"url": "https://github.com/gazay/gon/commit/fe3c7b2191a992386dc9edd37de5447a4e809bc7", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/09/msg00018.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4560-1/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/gazay/gon/commit/fe3c7b2191a992386dc9edd37de5447a4e809bc7"}}