{"buggy_code": ["var icms = icms || {};\n\nicms.files = (function ($) {\n\n    this.url_delete = '';\n\n    this.onDocumentReady = function(){\n        $('.custom-file-input').on('change',function(){\n            $(this).next('.custom-file-label').html($(this).val().replace('C:\\\\fakepath\\\\', ''));\n        });\n    };\n\n    this.remove = function(file_id){\n\n        $('#f_'+file_id+' #file_'+file_id).remove();\n        $('#f_'+file_id+' #file_'+file_id+'_upload').show();\n        $('#f_'+file_id+' input:hidden[name='+file_id+']').val('1');\n\n        icms.events.run('icms_files_remove', file_id);\n\n    };\n\n    this.deleteByPath = function(path){\n        $.post(this.url_delete, {path: path, csrf_token: icms.forms.getCsrfToken()}, function(result){\n            if (result.error){\n                alert(result.message);\n                return false;\n            }\n        }, 'json');\n    };\n\n\treturn this;\n\n}).call(icms.files || {},jQuery);"], "fixing_code": ["var icms = icms || {};\n\nicms.files = (function ($) {\n\n    this.url_delete = '';\n\n    this.onDocumentReady = function(){\n        $('.custom-file-input').on('change',function(){\n            $(this).next('.custom-file-label').text($(this).val().replace('C:\\\\fakepath\\\\', ''));\n        });\n    };\n\n    this.remove = function(file_id){\n\n        $('#f_'+file_id+' #file_'+file_id).remove();\n        $('#f_'+file_id+' #file_'+file_id+'_upload').show();\n        $('#f_'+file_id+' input:hidden[name='+file_id+']').val('1');\n\n        icms.events.run('icms_files_remove', file_id);\n\n    };\n\n    this.deleteByPath = function(path){\n        $.post(this.url_delete, {path: path, csrf_token: icms.forms.getCsrfToken()}, function(result){\n            if (result.error){\n                alert(result.message);\n                return false;\n            }\n        }, 'json');\n    };\n\n\treturn this;\n\n}).call(icms.files || {},jQuery);"], "filenames": ["templates/modern/js/files.js"], "buggy_code_start_loc": [9], "buggy_code_end_loc": [10], "fixing_code_start_loc": [9], "fixing_code_end_loc": [10], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Reflected in GitHub repository instantsoft/icms2 prior to 2.16.1.", "other": {"cve": {"id": "CVE-2023-4655", "sourceIdentifier": "security@huntr.dev", "published": "2023-08-31T01:15:10.740", "lastModified": "2023-09-01T18:39:47.187", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Reflected in GitHub repository instantsoft/icms2 prior to 2.16.1."}, {"lang": "es", "value": "Se ha encontrado una vulnerabilidad de Cross-Site Scripting (XSS) reflejado en el repositorio de GitHub instantsoft/icms2 anterior a la versi\u00f3n 2.16.1."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:instantcms:instantcms:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.16.1", "matchCriteriaId": "56EF3F9B-6CDB-4568-AF80-EEF6D72B72F6"}]}]}], "references": [{"url": "https://github.com/instantsoft/icms2/commit/a6a30e7bc96cd2081707388046c0259870533da6", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/e2189ad5-b665-4ba5-b6c4-112e58ae9a97", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/instantsoft/icms2/commit/a6a30e7bc96cd2081707388046c0259870533da6"}}