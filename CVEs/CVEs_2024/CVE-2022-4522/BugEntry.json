{"buggy_code": ["<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n"], "fixing_code": ["<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) { \r\n   var req = createXMLHTTPObject(); \r\n   if (!req) return; \r\n   var method = (postData) ? \"POST\" : \"GET\"; \r\n   req.open(method,url,true); \r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0'); \r\n   if (postData) \r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded'); \r\n   req.onreadystatechange = function () { \r\n      if (req.readyState != 4) return; \r\n      if (req.status != 200 && req.status != 304) return; \r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   } \r\n   if (req.readyState == 4) return; \r\n   req.send(postData); \r\n}\r\n\r\nfunction fCallback(req) { \r\n   eval(req.responseText); \r\n}\r\n \r\nvar XMLHttpFactories = [ \r\n   function () {return new XMLHttpRequest()}, \r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")}, \r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")} \r\n]; \r\n\r\nfunction createXMLHTTPObject() { \r\n   var xmlhttp = false; \r\n   for (var i=0;i<XMLHttpFactories.length;i++) { \r\n      try { \r\n         xmlhttp = XMLHttpFactories[i](); \r\n      } \r\n      catch (e) { \r\n         continue; \r\n      } \r\n      break; \r\n   } \r\n   return xmlhttp;\r\n} \r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar cw=giCellWidth<0?Math.floor(((IE4?gfSelf.parentElement.offsetWidth:gfSelf.parentNode.offsetWidth)-(giWeekCol>=0?giWeekWidth:0))/7)-6:giCellWidth;\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear,w;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\ta.push(\"<td class='CalHead'><div style='position:relative;width:\",cw,\"px;height:\",giHeadHeight,\"px;top:\",giHeadTop,\"px;'>\",sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tw=fDate2W(y,12,31);\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Calendar</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t\tif (gRange.length>0) fRepaint();\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script type='text/javascript'>\r\nif (gTheme[3]) eval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\nif (NS6) {fInitRange();fRepaint();}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>FlatCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31],g445=[1,5,9,14,18,22,27,31,35,40,44,48,53];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, gb445=false, giFirstMonth=1;\r\nvar _nn4_UseSpacer=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,gcTemp,giSat,giSun,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (!_noBound){if (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);}\r\n\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n\tif (fIsOutRange(gCurMonth[0],gCurMonth[1]))\r\n\t\tfSetCal(gRange[2][0],gRange[2][1],0);\r\n\telse fRepaint();\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tvar dow=fGetDOW(yy,giFirstMonth,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(yy,giFirstMonth-1,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,giFirstMonth,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(Date.UTC(y,giFirstMonth-1,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tvar yy=m<giFirstMonth?y-1:y;\r\n\tif (w==0) {\r\n\t\tvar dt=new Date(yy,giFirstMonth-1,0);\r\n\t\tw=fGetWeekNo(dt.getFullYear(),dt.getMonth()+1,dt.getDate());\r\n\t}\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(yy+1,giFirstMonth,1);\r\n\t\tif (w1>0) {yy++; w=w1;}\r\n\t}\r\n\treturn [yy,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1),wk=fDate2W(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1, wi=0;\r\n\tvar period=(m-giFirstMonth+12)%12, w445=g445[period];\r\n\r\n\tif (gb445&&wk[1]==w445+1) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=m-1;\r\n\t\t\t__cal[wi][d][1]=iLast-7+d;\r\n\t\t}\r\n\t\twi++;\r\n\t}\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[wi][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[wi][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tif (!(gb445&&(wk[1]<w445)))\r\n\t\twi++;\r\n\tfor (var w=1;wi<6;wi++,w++) {\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[wi][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[wi][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar weekDays=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+weekDays[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+weekDays[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\tw=fDate2W(y,__cal[0][0][0],__cal[0][0][1]);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\tw=fDate2W(y,12,31);\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<15;\r\n\t\tvar e445=gb445&&((m-giFirstMonth+1)%3!=0&&week>3||week>4&&!(m==12&&w[1]==53));\r\n\t\tif ((ex||e445)&&gbShrink2fit) break;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex||e445?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=w[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=e445?null:fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n\r\nfunction fGetSpacer(doc,sname) {\r\n\tvar pc=doc.anchors;\r\n\tfor (var i=0; i<pc.length; i++)\r\n\t\tif (pc[i].name==sname) return [pc[i].x,pc[i].y];\r\n\tfor (var i=0; i<doc.layers.length; i++) {\r\n\t\tvar lyr=doc.layers[i];\r\n\t\tif (lyr.visibility==\"hide\") continue;\r\n\t\tvar sp=fGetSpacer(lyr.document,sname);\r\n\t\tif (sp!=null) return [sp[0]+lyr.left,sp[1]+lyr.top];\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction fRelocate() {\r\n\tvar sname=(gTheme[3]?gTheme[3]:\"\")+\"_spacer\";\r\n\tvar sp=fGetSpacer(gContainer.document,sname);\r\n\tif (sp!=null) { gfSelf.left=sp[0]; gfSelf.top=sp[1]; gfSelf.visibility=\"show\"; }\r\n\telse gfSelf.visibility=\"hide\"\r\n\treturn sp;\r\n}\r\n\r\n</script>\r\n<script>\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\nif (gTheme[3]) eval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nif (!self._nn4_loaded) {\r\n\tfInitRange();\r\n\tif (_nn4_UseSpacer) fRelocate();\r\n\tif(fOnload) fOnload();\r\n}\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<script type='text/javascript'>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar KO=ua.match(/konqueror\\/(\\d+)/),KO3=KO&&KO[1]==3,SA=ua.match(/safari\\/(\\d+)/),SA1=SA&&SA[1]<86; KO=!!KO; SA=!!SA;\r\nvar MAC=/mac/.test(ua),OP=!!self.opera,WEBTV=/webtv/.test(ua),IE=/msie/.test(ua)&&!OP&&!WEBTV&&!SA&&!KO,GK=/gecko/.test(ua),OP8=/opera 8/.test(ua)&&OP;\r\nvar NN4=false,NS6=ua.indexOf(\"netscape6/6.0\")!=-1,IE4=IE&&!document.getElementById,IE5=IE&&![].push&&!IE4;\r\nvar gfSelf=fGetById(parent.document,self.name);\r\nvar gTheme=self.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(self.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = self.name;\r\n    // Set default values for subsequent script tags\r\n    self.name=\"gToday:normal:agenda.js\";\r\n    gTheme=self.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=parent,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[], _charset=gTheme[5]?\" charset='\"+gTheme[5]+\"' \":\"\";\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true, _cl=false;\r\nif (![].push) Array.prototype.push=function () {\r\n\tfor (var i=0; i<arguments.length; i++)\r\n\t\tthis[this.length]=arguments[i];\r\n\treturn this.length;\r\n}\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fGetById(doc, id) {\r\n\tif (IE4) return doc.all(id);\r\n\telse return doc.getElementById(id);\r\n}\r\n\r\nfunction fLoadScript(url,callback,postData) {\r\n   var req = createXMLHTTPObject();\r\n   if (!req) return;\r\n   var method = (postData) ? \"POST\" : \"GET\";\r\n   req.open(method,url,true);\r\n   req.setRequestHeader('User-Agent','XMLHTTP/1.0');\r\n   if (postData)\r\n      req.setRequestHeader('Content-type','application/x-www-form-urlencoded');\r\n   req.onreadystatechange = function () {\r\n      if (req.readyState != 4) return;\r\n      if (req.status != 200 && req.status != 304) return;\r\n\t  if (callback) callback(req);\r\n\t  else fCallback(req);\r\n   }\r\n   if (req.readyState == 4) return;\r\n   req.send(postData);\r\n}\r\n\r\nfunction fCallback(req) {\r\n   eval(req.responseText);\r\n}\r\n\r\nvar XMLHttpFactories = [\r\n   function () {return new XMLHttpRequest()},\r\n   function () {return new ActiveXObject(\"Msxml2.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Msxml3.XMLHTTP\")},\r\n   function () {return new ActiveXObject(\"Microsoft.XMLHTTP\")}\r\n];\r\n\r\nfunction createXMLHTTPObject() {\r\n   var xmlhttp = false;\r\n   for (var i=0;i<XMLHttpFactories.length;i++) {\r\n      try {\r\n         xmlhttp = XMLHttpFactories[i]();\r\n      }\r\n      catch (e) {\r\n         continue;\r\n      }\r\n      break;\r\n   }\r\n   return xmlhttp;\r\n}\r\n\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nvar __lastDrag=null;\r\nfunction fShowCal(xx,yy,isUp) {\r\n\twith (gfSelf.style) {\r\n\t\tif (_animPop) clip=\"rect(0px auto 0px auto)\";\r\n\t\tleft=xx+\"px\"; top=yy+\"px\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(\"fAnimPop(\"+yy+\",\"+fGetById(document,\"outerTable\").offsetHeight+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n\tif (gfSelf.focus) gfSelf.focus();\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.style.top=\"-500px\";\r\n\t__lastDrag=null;\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.offsetTop>-100;\r\n}\r\n\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 hspace=0 vspace=0 onload=\"fInitRange();if(fOnload)fOnload()\" onselectstart=\"return false\" ondraggesture=\"return false\" ondragstart=\"return false\" oncontextmenu=\"return false\" onmouseup=\"fDragIt(0,0,0,2,event)\">\r\n<script type='text/javascript'>\r\nvar gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\nwith (document) {\r\n\twrite(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n\twrite(\"<lin\"+\"k rel='stylesheet' type='text/css' \"+_charset+\" href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nif (fOnDrag&&!(IE&&MAC||OP)) {\r\n\tvar __om=IE4||IE5?gContainer.document.onmouseover:gContainer.document.onmouseup;\r\n\tif (IE4||IE5) gContainer.document.onmouseover=fOm;\r\n\telse gContainer.document.onmouseup=fOm;\r\n}\r\nfunction fOm(e){\r\n\tif(!e)e=gContainer.event;var t=e.target?e.target:e.srcElement;\r\n\tif(t.name!=self.name)__lastDrag=null;if(__om)__om(e)\r\n}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\tif (!fOnDrag||!(__lastDrag&&aStat>0||aStat==0)) return false;\r\n\tvar dt=[y,m,d];\r\n\tif (aStat==1&&__lastDrag+''==dt+'') return false;\r\n\t__lastDrag=aStat==2||IE&&MAC||OP?null:dt;\r\n\treturn fOnDrag(dt[0],dt[1],dt[2],aStat,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,posCtrl,posOffset) {\r\n\tvar dc=dateCtrl;\r\n\tvar pc=posCtrl?posCtrl:dc;\r\n\tif (gdCtrl!=dc) {fHideCal(); gdCtrl=dc;}\r\n\telse if (fIsShown()) {if (gbAutoClose) fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=-1;\r\n\t} else {\r\n\t\tp=fGetXY(pc,posOffset?posOffset:gPosOffset);\r\n\t\tif (posLayerId) {\r\n\t\t\tvar lyr=fGetById(parent.document,posLayerId);\r\n\t\t\tif (lyr&&lyr.tagName.toUpperCase()==\"IFRAME\") {\r\n\t\t\t\tvar pl=fGetXY(lyr);\r\n\t\t\t\tvar p2=fGetWinSize(parent.frames[posLayerId]).slice(2);\r\n\t\t\t\tp[0]+=pl[0]-p2[0];\r\n\t\t\t\tp[1]+=pl[1]-p2[1];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oh=pc.offsetHeight,ptb=fGetById(document,\"outerTable\"),h=ptb.offsetHeight,w=ptb.offsetWidth;\r\n\t\th=(h?h:gfSelf.height)+oh;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar ws=fGetWinSize(parent);\r\n\t\t\tvar tmp=ws[0]+ws[2]-(w?w:gfSelf.width);\r\n\t\t\tp[0]=p[0]<ws[2]?ws[2]+2:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=ws[1]+ws[3]-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-ws[3]+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-ws[3]+oh<h) p[1]=ws[3]-1-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=oh>0?h+2:h+25;\r\n\t}\r\n\tfShowCal(p[0],p[1]+oh+1,isUp);\r\n}\r\n\r\nfunction fGetWinSize(w) {\r\n\tif (w.innerWidth)\r\n\t\treturn [w.innerWidth-16,w.innerHeight,w.pageXOffset,w.pageYOffset];\r\n\telse if (w.document.compatMode=='CSS1Compat')\r\n\t\twith (w.document.documentElement) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n\telse\r\n\t\twith (w.document.body) return [clientWidth,clientHeight,scrollLeft,scrollTop];\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\th=h?h:gfSelf.height; __strips+=20;\r\n\twith (gfSelf.style)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t \tclip=\"rect(\"+(u?\"auto\":d+\"px\")+\" auto \"+(u?h-d+\"px\":\"auto\")+\" auto)\";\r\n\t\ttop=(u?t+d:t-d)+\"px\";\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip=\"rect(auto auto auto auto)\";\r\n\t\ttop=t+\"px\";\r\n\t}\r\n}\r\n\r\nfunction fGetXY(a,offset) {\r\n\tvar p=offset?offset.slice(0):[0,0],tn;\r\n\twhile(a) {\r\n\t\ttn=a.tagName.toUpperCase();\r\n\t\tp[0]+=a.offsetLeft-(!KO3&&tn==\"DIV\"&&a.scrollLeft?a.scrollLeft:0);\r\n\t\tp[1]+=a.offsetTop-(!KO3&&tn==\"DIV\"&&a.scrollTop?a.scrollTop:0);\r\n\t\tif (tn==\"BODY\") break;\r\n\t\ta=a.offsetParent;\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (gcbYear) {\r\n\t \tfor(var i=0;i+rb[0]<=re[0];i++) gcbYear.options[i]=new Option(i+rb[0],i+rb[0]);\r\n \t\tfor(var j=gcbYear.options.length-1;j>=i;j--) gcbYear.options[j]=null;\r\n\t}\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\nfunction fToggleNavs(y,m) {\r\n\tvar n=fGetById(document,\"navPrev\"); if(n)n.style.visibility=fBfRange(y,m)?\"hidden\":\"visible\";\r\n\tn=fGetById(document,\"navNext\"); if(n)n.style.visibility=fAfRange(y,m)?\"hidden\":\"visible\";\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tstopShowMon();\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options.selectedIndex=gCurMonth[1]-1;\r\n\t\tif (gcbYear) gcbYear.options.selectedIndex=gCurMonth[0]-gcbYear.options[0].value;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tvar htmStr=fDrawCal(y,m);\r\n\tif (!gbHideCalMiddle){\r\n\t\tvar iDiv=fGetById(document,\"innerDiv\");\r\n\t\tfGetById(document,\"innerDiv\").innerHTML=htmStr;\r\n\t}\r\n\tif (gcbMon) gcbMon.options.selectedIndex=m-1;\r\n\tif (gcbYear&&y-gcbYear.options[0].value<gcbYear.options.length) gcbYear.options.selectedIndex=y-gcbYear.options[0].value;\r\n\tif (!gbHideTop&&giDCStyle>0) fGetById(document,\"calTitle\").innerHTML=eval(gsCalTitle)+\"\\n\";\r\n\tfToggleNavs(y,m);\r\n\tgcTemp=null;\r\n\tsetTimeout(\"fResize()\",giInitDelay+giResizeDelay);\r\n\treturn true;\r\n}\r\n\r\nfunction fResize() {\r\n\tif (fOnResize) fOnResize();\r\n\tgiInitDelay=0;\r\n\tvar ptb=fGetById(document,\"outerTable\");\r\n\tif (!ptb) return;\r\n\tvar ow=ptb.offsetWidth;\r\n\tvar oh=ptb.offsetHeight;\r\n\tif (ow) gfSelf.style.width=ow+\"px\";\r\n\tif (oh) gfSelf.style.height=oh+\"px\";\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tif (!__stub[1]&&fPrevMonth()&&!fBfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fPrevMonth()\", giShowInterval);\r\n}\r\nfunction showNextMon() {\r\n\tif (!__stub[1]&&fNextMonth()&&!fAfRange(gCurMonth[0],gCurMonth[1])) __stub[1]=setInterval(\"fNextMonth()\", giShowInterval);\r\n}\r\nfunction stopShowMon() {\r\n\tclearInterval(__stub[1]); __stub[1]=null;\r\n}\r\n\r\nfunction fMouseOver(t) {\r\n\tif (!gbFocus) return;\r\n\tgcTemp=t.style.backgroundColor;\r\n\tt.style.backgroundColor=gcToggle;\r\n}\r\n\r\nfunction fMouseOut(t) {\r\n\tif (!gbFocus||gcTemp==null) return;\r\n\tt.style.backgroundColor=gcTemp?gcTemp:\"transparent\";\r\n}\r\n\r\nfunction fHint(t,id) {\r\n\tt.title=__tis[id];\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=\"<td class='WeekHead'><div style='position:relative;width:\"+giWeekWidth+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sCH=\"<td class='CalHead'><div style='position:relative;width:\"+giCellWidth+\"px;height:\"+giHeadHeight+\"px;top:\"+giHeadTop+\"px;'>\",\r\n__sWC=\"<td class='WeekCol'><div style='position:relative;width:100%;top:\"+giWeekTop+\"px;'>\",\r\n__sCC=\" class='CalCol'><div class='CalCell' style='position:relative;width:100%;height:\"+giCellHeight+\"px;\",\r\n__sDIVTD=\"</div></td>\",\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tvar a=[\"<TABLE width='100%' \",gsInnerTable,\"><tr>\"];\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tfor (var wd=0,i=0; i<8; i++)\r\n\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sDIVTD);\r\n\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\ta.push(__sCH,sDoW,__sDIVTD); wd++;\r\n\t\t}\r\n\ta.push(\"</tr>\");\r\n\tif (giWeekCol>=0) {\r\n\t\tvar w=fDate2W(y,m,1);\r\n\t\tweekYear=w[0];\r\n\t\tweekNo=w[1];\r\n\t}\r\n\tfor (var week=0; week<6; week++) {\r\n\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\tif (gbShrink2fit&&ex) continue;\r\n\t\ta.push(\"<tr>\");\r\n\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\tif (i==giWeekCol) {\r\n\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,__sDIVTD);\r\n\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t}\r\n\t\t\t\tweekNo++;\r\n\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\tvar hs=ag&&ag[1]!=null?\";cursor:pointer\":\";cursor:default\";\r\n\t\t\t\tif (ag==null) {\r\n\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\tcbg=null; bo=false; __tis[tid]=td=htm=\"\"; bfb=gbFlatBorder; c=c1=gcOtherDayBG;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\tbfb=gbFlatBorder&&c1!=gcCellBG;\r\n\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\ttd=ag[1]==null&&_lineThru?\";text-decoration:line-through\":\"\";\r\n\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t}\r\n\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\tif (gbInvertBorder) bfb=!bfb;\r\n\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\ta.push(\"<td valign='top'\");if(c)a.push(\" bgcolor='\",c,\"'\");if(bfb)a.push(\" style='border-style:solid;border-color:\",c1,\"'\");a.push(__sCC,hs);if(c1)a.push(\";background-color:\",c1);\r\n\t\t\t\tif(cbg)a.push(\";background-image:url(\",cbg,\")\");if(dc==\"\")a.push(\"' ><span class='CellAnchor'>&nbsp;</span>\",__sDIVTD);else{\r\n\t\t\t\tif(!_mcafee)a.push(\"' onmouseover='fHint(this,\",tid,\");fMouseOver(this);fDragIt(\",sCellDate,\",1,event);return true' onmouseout='fMouseOut(this)' onmousedown='fDragIt(\",sCellDate,\",0,event)' onmouseup='fDragIt(\",sCellDate,\",2,event)\");\r\n\t\t\t\ta.push(\"' onclick='fSetDate(\",sCellDate,\",true,event)'><A href='javascript:void(0)' class='CellAnchor' style='color:\",dc,hs);\r\n\t\t\t\tif(bo)a.push(\";font-weight:bold\");a.push(td,\"' onmouseover='fHint(this,\",tid,\")' >\",eval(gsDays),\"</A>\",htm,__sDIVTD);}\r\n\t\t\t\tag=null;\r\n\t\t\t}\r\n\t\ta.push(\"</tr>\");\r\n\t}\r\n\ta.push(\"</TABLE>\\n\");\r\n\treturn a.join('');\r\n}\r\n\r\nwith (document) {\r\n\tbody.bgColor=gcCalBG;\r\n\tvar a=[\"<TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm' style='margin:0;padding:0'>\"];\r\n\tif (!gbHideTop)\r\n\tif (giDCStyle==2)\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN id='calTitle' class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\telse if (giDCStyle==1){\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr><TD align='left' nowrap>\",gsNavPrev,\"</TD><TD class='CalTitle' nowrap><SPAN id='calTitle'>\");\r\n\t\ta.push(eval(gsCalTitle));\r\n\t\ta.push(\"</SPAN></TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t} else {\r\n\t\ta.push(\"<TR><TD class='CalTop' nowrap>\",gsNavPrev,\" \");\r\n\t\tvar mstr=[\"<SELECT id='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor (var i=0; i<12; i++) mstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\tmstr.push(\"</SELECT>\"); mstr=mstr.join('');\r\n\t\tvar ystr=[\"<SELECT id='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.value, gcbMon.value,0,true,event)'>\"];\r\n\t\tfor(var i=gBegin[0];i<=gEnd[0];i++)\r\n\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",i,\"</OPTION>\");\r\n\t\tystr.push(\"</SELECT>\"); ystr=ystr.join('');\r\n\t\tif (gbDCSeq) a.push(mstr,ystr);\r\n\t\telse a.push(ystr,mstr);\r\n\t\ta.push(\" \",gsNavNext,\"</TD></TR>\");\r\n\t}\r\n\ta.push(\"</FORM>\");\r\n\tif (!gbHideCalMiddle) a.push(\"<TR><TD class='CalMiddle'><DIV id='innerDiv' style='background:\",gcCalFrame,guCalBG?\" url(\"+guCalBG+\") \":\"\",\";'></DIV></TD></TR>\");\r\n\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm' style='margin:0;padding:0'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\ta.push(\"</TABLE>\");\r\n\tfor (var i=0;i<giFreeDiv;i++)\r\n\t\ta.push(\"<DIV class='FreeDiv' id='freeDiv\",i,\"' style='position:absolute;visibility:hidden;z-index:500'></DIV>\");\r\n\twrite(a.join(''));\r\n\tclose();\r\n}\r\n</script>\r\n<script type='text/javascript'>\r\nif (giDCStyle==0) {\r\n\tgcbMon=fGetById(document,\"MonSelect\");\r\n\tgcbYear=fGetById(document,\"YearSelect\");\r\n}\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nfunction fAgReady(ctxName) {\r\n\tvar ctx=eval(\"gContainer.\"+ctxName);\r\n\tif (ctx) {\r\n\t\tclearInterval(__stub[0]);\r\n\t\tfHoliday=ctx.fHoliday;\r\n\t}\r\n}\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) __stub[0]=setInterval(\"fAgReady('\"+gTheme[2].split('[')[1].split(']')[0]+\"')\",350);\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' \"+_charset+\" src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<a href=\"http://www.calendarxp.net\" style=\"display:none\">JavaScript Date Picker</a><a href=\"http://www.idemfactor.com\" style=\"display:none\">Idemfactor Solutions Inc.</a>\r\n<script type='text/javascript'>\r\nvar __omd=gContainer.document.onmousedown?gContainer.document.onmousedown:null;\r\ngContainer.document.onmousedown=function(e){\r\n  var n=!e?gContainer.event.srcElement:e.target;\r\n  if (!(/PopcalTrigger/i.test(n.className)||/popcal/i.test(n.name))) fHideCal();\r\n  if (__omd) __omd(e);\r\n}\r\nvar __okd=gContainer.document.onkeydown?gContainer.document.onkeydown:null;\r\ngContainer.document.onkeydown=function(e){var evt=e?e:gContainer.event;if(evt.keyCode==27)fHideCal();if(__okd)__okd(e);}\r\nvar __okd1=document.onkeydown?document.onkeydown:null;\r\ndocument.onkeydown=function(e){var evt=e?e:event;if(evt.keyCode==27)fHideCal();if(__okd1)__okd1(e);}\r\neval(\"parent.\"+gTheme[3]+\"=parent.frames[self.name]\");\r\n</script>\r\n</body>\r\n</html>\r\n", "<html>\r\n<head>\r\n<title>PopCalendarXP 10.0.1 - Copyright Idemfactor Solutions, Inc.</title>\r\n<style type=\"text/css\">\r\n.cxpNS {text-align:left;}\r\n.cxpLT {text-decoration:line-through;}\r\n.cxpLTB {text-decoration:line-through; font-weight:bold;}\r\n.cxpFB {font-weight:bold;}\r\n</style>\r\n<script>\r\nvar gd=new Date(), gToday=[gd.getFullYear(),gd.getMonth()+1,gd.getDate()];\r\nvar ua=navigator.userAgent.toLowerCase();\r\nvar MAC=ua.indexOf('mac')!=-1,NN4=true,OP=NS6=IE5=IE4=IE=KO3=KO=SA=SA1=GK=OP8=false;\r\nvar gfSelf=this;\r\nvar gTheme=this.name.split(\":\");\r\nif (/[\\\\'(\"`;\\r\\n]/.test(gfSelf.name) \r\n    || /[\\.]/.test(gTheme[0]) \r\n    || (gTheme[2]&&gTheme[2].substring(0,6)==\"share[\" && /[\\.]/.test(gTheme[2]))\r\n    || /[\\.]/.test(gTheme[3])) {\r\n    var offendingName = gfSelf.name;\r\n    // Set default values for subsequent script tags\r\n    gfSelf.name=\"gToday:normal:agenda.js\";\r\n    gTheme=gfSelf.name.split(\":\");\r\n    var err = (\"This version of CalendarXP tries to avoid malicious XSS input but may fail passing benign parameters.\" \r\n        + \"\\n******** Offending iframe name: ********\\n\" + offendingName + \"\\n************************\\n\");\r\n    console.log(err);\r\n    alert(err);\r\n    throw new Error(err);\r\n}\r\nvar gCurMonth=eval(gTheme[0]); gCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\nvar gContainer=self,gDays=[31,31,28,31,30,31,30,31,31,30,31,30,31];\r\nvar fOnResize,fRepaint,fHoliday,fOnChange,fAfterSelected,fOnDrag,gcOtherDayBG,fOnWeekClick,fIsSelected,fParseInput,fFormatInput,fOnDoWClick,fOnload;\r\nvar __agenda=[], __stub=[];\r\nvar MILLIDAY=86400000, giInitDelay=200, _lineThru=true, _noBound=false, _mcafee=false, _animPop=NN4||IE&&!IE4&&!MAC, _animInt=20, _preferOOR=true, gbHideCalMiddle=false, _cacheOther=true;\r\n\r\n\r\nfunction fCalibrate(y,m) {\r\n\tif (m<1) { y--; m+=12; }\r\n\telse if (m>12) { y++; m-=12; }\r\n\treturn [y,m];\r\n}\r\n\r\nfunction fLoadScript(url) {}\r\n\r\nfunction fFilterNull(str) {\r\n\treturn str==null||str==\"null\"?null:str;\r\n}\r\n\r\nfunction fAddEvent(y,m,d,message,action,bgcolor,fgcolor,bgimg,boxit,html,etc) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=[message,fFilterNull(action),fFilterNull(bgcolor),fFilterNull(fgcolor),fFilterNull(bgimg),fFilterNull(boxit),fFilterNull(html),etc];\r\n}\r\n\r\nfunction fGetEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda, id=y+\"-\"+m+\"-\"+d;\r\n\treturn ag[id]?ag[id].slice(0):null;\r\n}\r\n\r\nfunction fRemoveEvent(y,m,d) {\r\n\tvar ag=gbShareAgenda?eval(gsAgShared):__agenda;\r\n\tag[y+\"-\"+m+\"-\"+d]=null;\r\n}\r\n\r\nfunction fWeekOffset(dow) {\r\n\treturn dow<=3?1:0;\r\n}\r\n\r\nfunction fGetDays(y) {\r\n\tgDays[2]=y%4==0&&y%100!=0||y%400==0?29:28;\r\n\treturn gDays;\r\n}\r\n\r\nfunction fShowCal(xx,yy,isUp) {\r\n\tfToggle(self.document, \"show\");\r\n\twith (gfSelf) {\r\n\t\tvar h=clip.height;\r\n\t\tif (_animPop) clip.bottom=0;\r\n\t\tpageX=xx; pageY=yy;\r\n\t\tfToggle(self.document, \"hide\");\r\n\t\tvisibility=\"show\";\r\n\t}\r\n\tif (_animPop) {\r\n\t\t__strips=0;\r\n\t\t__stub[2]=setInterval(gTheme[3]+\".fAnimPop(\"+yy+\",\"+h+\",\"+isUp+\")\",_animInt);\r\n\t}\r\n}\r\n\r\nfunction fHideCal() {\r\n\tgfSelf.visibility=\"hide\";\r\n\tfToggle(self.document, \"show\");\r\n\tif (__stub[2]) clearInterval(__stub[2]);\r\n}\r\n\r\nfunction fIsShown() {\r\n\treturn gfSelf.visibility==\"show\";\r\n}\r\n\r\nvar _nn4_css=[\"CalHead\",\"CalCol\",\"CalCell\",\"CellAnchor\",\"WeekHead\",\"WeekCol\",\"MonthNav\",\"CalTop\",\r\n\"CalMiddle\",\"CalBottom\",\"CalTitle\",\"FreeDiv\",\"BottomAnchor\",\"PopAnchor\",\"PopMenu\",\"PopMenuItem\"];\r\nvar _nn4_ids=[\"outerTable\",\"innerDiv\"];\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[1]+\".js?\"+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n</head>\r\n<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0>\r\n<script>\r\nvar gLay,gdBegin,gdEnd,gcbMon,gcbYear,giSat,giSun,gdCtrl=new Object(),gcTemp,gRange=[],__cal=[];\r\nfor (var i=0;i<6;i++) { __cal[i]=[]; for (var j=0;j<7;j++) __cal[i][j]=[]; }\r\ndocument.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+(gTheme[4]?gTheme[4]+(/\\?/.test(gTheme[4])?\"&\":\"?\"):\"plugins.js?\")+(_cacheOther?0:gd.getTime())+\"'></scr\"+\"ipt>\");</script>\r\n<script>\r\nfor (var i=0; i<_nn4_css.length; i++) {\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.borderWidths=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.paddings=function(){}\");\r\n\teval(\"document.classes.\"+_nn4_css[i]+\".all.margins=function(){}\");\r\n}\r\nfor (var i=0; i<_nn4_ids.length; i++) {\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".borderWidths=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".paddings=function(){}\");\r\n\teval(\"document.ids.\"+_nn4_ids[i]+\".margins=function(){}\");\r\n}\r\n</script>\r\n<script>document.write(\"<lin\"+\"k rel='stylesheet' type='text/css' href='\"+gTheme[1]+\".css?\"+(_cacheOther?0:gd.getTime())+\"'>\");</script>\r\n<script>\r\ngiSat=(6-giFirstDOW)%7;\r\ngiSun=(7-giFirstDOW)%7;\r\nvar __gdos=gdSelect.slice(0); // keep the initial selected date\r\ngCurMonth=fCalibrate(gCurMonth[0],gCurMonth[1]);\r\ngdSelect=gdSelect.slice(0); gBegin=gBegin.slice(0); gEnd=gEnd.slice(0);\r\nif (gCurMonth[0]>gEnd[0]||gCurMonth[0]==gEnd[0]&&gCurMonth[1]>gEnd[1]) gCurMonth=gEnd.slice(0);\r\nif (gCurMonth[0]<gBegin[0]||gCurMonth[0]==gBegin[0]&&gCurMonth[1]<gBegin[1]) gCurMonth=gBegin.slice(0);\r\nif (gsSplit==\"\") {giMonthMode=0; gbPadZero=true;}\r\ngWeekDay=gWeekDay.slice(giFirstDOW).concat(gWeekDay.slice(0,giFirstDOW));\r\n\r\nif (!fIsSelected)\r\n\tfIsSelected=function(y,m,d) {\r\n\t\treturn gdSelect[2]==d&&gdSelect[1]==m&&gdSelect[0]==y;\r\n\t}\r\nif (!fParseInput)\r\n\tfParseInput=function(str) {\r\n\t\treturn fParseDate(str);\r\n\t}\r\nif (!fFormatInput)\r\n\tfFormatInput=function(y,m,d) {\r\n\t\treturn fFormatDate(y,m,d);\r\n\t}\r\n\r\nfunction fDragIt(y,m,d,aStat,e) {\r\n\treturn fOnDrag&&fOnDrag(y,m,d,0,e);\r\n}\r\n\r\nfunction fRepaint() {\r\n\tfSetCal(gCurMonth[0],gCurMonth[1],0,false,null);\r\n}\r\n\r\nfunction fUpdSelect(y,m,d,bDoNotReformat) {\r\n\tgdSelect[0]=y; gdSelect[1]=m; gdSelect[2]=d;\r\n\tif (!bDoNotReformat) gdCtrl.value=d==0?\"\":fFormatInput(y,m,d);\r\n}\r\n\r\nfunction fPopCalendar(dateCtrl,range,posLayerId,dummy,posOffset) {\r\n\tgLay=posLayerId?eval(\"self.document.\"+posLayerId):null;\r\n\tif (gdCtrl!=dateCtrl) {fHideCal(); gdCtrl=dateCtrl;}\r\n\telse if (fIsShown()) {fHideCal(); return;}\r\n\tvar s=fParseInput(gdCtrl.value);\r\n\tvar b=false;\r\n\tif (s==null)\r\n\t\tif (__gdos[2]==0) {\r\n\t\t\tb=true; s=eval(gTheme[0]); s=[s[0],s[1],0];\r\n\t\t} else s=__gdos;\r\n\tfUpdSelect(s[0],s[1],s[2],b);\r\n\tfInitRange(range);\r\n\tif (gRange[2]&&fIsOutRange(s[0],s[1])) {\r\n\t\tif (!gbHideTop) fUpdSelect(0,0,0);\r\n\t\ts=gRange[2];\r\n\t}\r\n\tif (!fSetCal(s[0],s[1],0,true,null)) {\r\n\t\tfUpdSelect(0,0,0);\r\n\t\treturn;\r\n\t}\r\n\tgfSelf.visibility=\"hide\";\r\n\tvar p,oh,isFixed=posOffset?posOffset[2]:gbFixedPos,isUp;\r\n\tif (isFixed) {\r\n\t\tp=posOffset?posOffset:gPosOffset;\r\n\t\toh=0;\r\n\t} else {\r\n\t\tvar pc=gLay?gLay.document.anchors:self.document.anchors;\r\n\t\tvar aname=gdCtrl.name+\"dummy\";\r\n\t\tfor (var i=0;i<pc.length;i++)\r\n\t\t\tif (pc[i].name.split(\":\")[0]==aname) break;\r\n\t\tif (i==pc.length) { alert(\"NN4 localizer <a name='\"+aname+\":27'> </a> not found!\"); return; }\r\n\t\tvar a=pc[i];\r\n\t\tp=[a.x+(gLay?gLay.left:0),a.y+(gLay?gLay.top:0)];\r\n\t\tp[0]+=posOffset?posOffset[0]:gPosOffset[0];\r\n\t\tp[1]+=posOffset?posOffset[1]:gPosOffset[1];\r\n\t\toh=parseInt(a.name.split(\":\")[1],10);\r\n\t\tvar h=oh+gfSelf.clip.height;\r\n\t\tif (gbAutoPos) {\r\n\t\t\tvar xo=self.pageXOffset;\r\n\t\t\tvar yo=self.pageYOffset;\r\n\t\t\tvar tmp=self.innerWidth-gfSelf.clip.width+xo-16;\r\n\t\t\tp[0]=p[0]<xo?xo+1:p[0]>tmp?tmp:p[0];\r\n\t\t\ttmp=self.innerHeight+yo-h;\r\n\t\t\tisUp=p[1]>tmp&&p[1]-yo+oh>=h;\r\n\t\t\tif (p[1]>tmp&&p[1]-yo+oh<h) p[1]=yo-oh;\r\n\t\t} else isUp=!gbPopDown;\r\n\t\tif (isUp) p[1]-=h;\r\n\t}\r\n\tfShowCal(p[0],oh+p[1],isUp);\r\n}\r\n\r\nfunction fAnimPop(t,h,u) {\r\n\t__strips+=20;\r\n\twith (gfSelf)\r\n\tif (__strips<=h){\r\n\t\tvar d=h-__strips;\r\n\t\tif (!u) clip.top=d;\r\n\t\telse clip.bottom=h-d;\r\n\t\ttop=u?t+d:t-d;\r\n\t}\r\n\telse {\r\n\t\tclearInterval(__stub[2]);\r\n\t\tclip.top=0; clip.bottom=h; top=t;\r\n\t}\r\n}\r\n\r\nfunction fToggle(doc, stat) {\r\n\tvar ls=doc.layers;\r\n\tfor (var i=0; i<ls.length; i++)\r\n\t\tif (ls[i].name.substring(0,6)==\"toggle\")\r\n\t\t\tls[i].visibility=stat;\r\n\t\telse if (ls[i].layers.length)\r\n\t\t\tfToggle(ls[i], stat);\r\n}\r\n\r\nfunction fInitRange(r) {\r\n\tgRange=r?r:[];\r\n\tvar rb=gRange[0]?r[0]:gBegin;\r\n\tgdBegin=new Date(rb[0],rb[1]-1,rb[2]);\r\n\tgRange[0]=rb;\r\n\tvar re=gRange[1]?r[1]:gEnd;\r\n\tgdEnd=new Date(re[0],re[1]-1,re[2]);\r\n\tgRange[1]=re;\r\n\r\n\tif (!gRange[2]) gRange[2]=rb.slice(0);\r\n}\r\n\r\nfunction fParseDate(ds) {\r\n\tvar i,r=null,pd=[];\r\n\tif (!ds) return r;\r\n\tif (gsSplit.length>0) {\r\n\t\tpd=ds.split(gsSplit);\r\n\t} else {\r\n\t\tvar yl=gbShortYear?2:4;\r\n\t\tif (giDatePos==2) { pd[0]=ds.substring(0,yl);pd[1]=ds.substring(yl,yl+2);pd[2]=ds.substring(yl+2,yl+4); }\r\n\t\telse { pd[0]=ds.substring(0,2);pd[1]=ds.substring(2,4);pd[2]=ds.substring(4,4+yl); }\r\n\t}\r\n\tif (pd.length==3) {\r\n\t\tvar m=pd[giDatePos==1?0:1], ml=giMonthMode>1?giMonthMode:3;\r\n\t\tfor (i=0; (i<12)&&(gMonths[i].substring(0,ml).toLowerCase()!=m.substring(0,ml).toLowerCase())&&(i+1!=m); i++);\r\n\t\tif (i<12) {\r\n\t\t\tvar y=parseInt(pd[giDatePos==2?0:2].substring(0,4),10);\r\n\t\t\tvar pf=Math.floor(gEnd[0]/100)*100;\r\n\t\t\tr=[y<100?y>gEnd[0]%100?pf-100+y:pf+y:y,i+1,parseInt(pd[giDatePos],10)];\r\n\t\t} else return null;\r\n\t} else return null;\r\n\tvar td=new Date(r[0],r[1]-1,r[2]);\r\n\tif (isNaN(td)||td.getMonth()!=r[1]-1) return null;\r\n\treturn r;\r\n}\r\n\r\nfunction fFormatDate(y,m,d){\r\n\tvar M=giMonthMode==0?gbPadZero&&m<10?\"0\"+m:m:giMonthMode==1?gMonths[m-1]:gMonths[m-1].substring(0,giMonthMode);\r\n\tvar D=gbPadZero&&d<10?\"0\"+d:d;\r\n\tvar sy=y%100;\r\n\tvar Y=gbShortYear?sy<10?\"0\"+sy:sy:y;\r\n\tswitch (giDatePos) {\r\n\t\tcase 0: return D+gsSplit+M+gsSplit+Y;\r\n\t\tcase 1: return M+gsSplit+D+gsSplit+Y;\r\n\t\tcase 2: return Y+gsSplit+M+gsSplit+D;\r\n\t}\r\n}\r\n\r\nfunction fGetAgenda(y,m,d,taint) {\r\n\tvar s=fCalibrate(y,m),cm=gCurMonth;\r\n\tvar def=[\"\",gsAction,gcCellBG,null,guCellBGImg,false,gsCellHTML];\r\n\tif (taint) if ((giShowOther&4)&&(s[0]<cm[0]||s[0]==cm[0]&&s[1]<cm[1])||(giShowOther&8)&&(s[0]>cm[0]||s[0]==cm[0]&&s[1]>cm[1]))\r\n\t\treturn null;\r\n\tvar ag=fHoliday?fHoliday(s[0],s[1],d):fGetEvent(y,m,d);\r\n\tif (ag==null) ag=def;\r\n\telse {\r\n\t\tfor (var i=0;i<7;i++) {\r\n\t\t\tif (gAgendaMask[i]!=-1) ag[i]=gAgendaMask[i];\r\n\t\t\tif (ag[i]==null&&i!=1) ag[i]=def[i];\r\n\t\t}\r\n\t\tif (taint&&s[1]!=cm[1]&&!(giShowOther&1)) {\r\n\t\t\tdef[0]=ag[0]; def[1]=ag[1]; ag=null; ag=def;\r\n\t\t}\r\n\t}\r\n\tif (taint&&s[1]!=cm[1]) {\r\n\t\tif (gcOtherDayBG&&ag[2]==gcCellBG) ag[2]=gcOtherDayBG;\r\n\t\tag[3]=gcOtherDay;\r\n\t}\r\n\tif (!fValidRange(s[0],s[1],d)) {\r\n\t\tag[1]=null;\r\n\t\tif (_preferOOR&&gsOutOfRange) ag[0]=gsOutOfRange;\r\n\t\tif (_preferOOR&&guOutOfRange) ag[4]=guOutOfRange;\r\n\t}\r\n\treturn ag;\r\n}\r\n\r\nfunction fGetDOW(y,m,d) {\r\n\treturn (7+(new Date(y,m-1,d).getDay())-giFirstDOW)%7;\r\n}\r\n\r\nfunction fGetWeekNo(y,m,d) {\r\n\tvar dow=fGetDOW(y,1,1);\r\n\treturn Math.ceil(((Date.UTC(y,m-1,d)-Date.UTC(y,0,1))/MILLIDAY+dow-6)/7)+fWeekOffset(dow);\r\n}\r\n\r\nfunction fW2Date(y,w,wd) { // w > 0, wd > 0\r\n\tvar dow=fGetDOW(y,1,1);\r\n\tw-=fWeekOffset(dow);\r\n\tvar date=new Date(new Date(y,0,1)-0+(w*7+wd-dow-1)*MILLIDAY);\r\n\treturn [date.getFullYear(),date.getMonth()+1,date.getDate()];\r\n}\r\n\r\nfunction fDate2W(y,m,d) {\r\n\tvar w=fGetWeekNo(y,m,d), wd=fGetDOW(y,m,d)+1;\r\n\tif (w==0) { y--; w=fGetWeekNo(y,12,31); }\r\n\telse if (w>52) {\r\n\t\tvar w1=fGetWeekNo(y+1,1,1);\r\n\t\tif (w1>0) { y++; w=w1; }\r\n\t}\r\n\treturn [y,w,wd];\r\n}\r\n\r\nfunction fGetDateByDOW(y,m,q,dow) { // q: 1-5; dow: 0-6\r\n\tvar dom=new Date(y,m-1,1).getDay();\r\n\tvar d=7*q-6+dow-dom;\r\n\tif (dom>dow) d+=7;\r\n\tif (d>fGetDays(y)[m]) d-=7;\r\n\treturn d;\t// 1-31\r\n}\r\n\r\nfunction fValidRange(y,m,d) {\r\n\tfor (var i=3; i<gRange.length; i++)\r\n\t\tif (gRange[i][2]==d&&gRange[i][1]==m&&gRange[i][0]==y)\r\n\t\t\treturn false;\r\n\tvar dt=new Date(y,m-1,d);\r\n\treturn (dt>=gdBegin)&&(dt<=gdEnd);\r\n}\r\n\r\nfunction fBuildCal(y,m) {\r\n\tvar days=fGetDays(y),iDay1=fGetDOW(y,m,1);\r\n\tvar iLast=days[m-1]-iDay1+1,iDate=1,iNext=1;\r\n\tfor (var d=0;d<7;d++) {\r\n\t\t__cal[0][d][0]=d<iDay1?m-1:m;\r\n\t\t__cal[0][d][1]=d<iDay1?iLast+d:iDate++;\r\n\t}\r\n\tfor (var w=1;w<6;w++)\r\n\t\tfor (var d=0;d<7;d++) {\r\n\t\t\t__cal[w][d][0]=iDate<=days[m]?m:m+1;\r\n\t\t\t__cal[w][d][1]=iDate<=days[m]?iDate++:iNext++;\r\n\t\t}\r\n}\r\n\r\nfunction fIsOutRange(y,m) {\r\n\treturn (y>gRange[1][0]||y<gRange[0][0]||y==gRange[0][0]&&m<gRange[0][1]||y==gRange[1][0]&&m>gRange[1][1]);\r\n}\r\nfunction fBfRange(y,m) {\r\n\treturn y<gRange[0][0]||y==gRange[0][0]&&m<=gRange[0][1];\r\n}\r\nfunction fAfRange(y,m) {\r\n\treturn y>gRange[1][0]||y==gRange[1][0]&&m>=gRange[1][1];\r\n}\r\n\r\nfunction fCheckRange(y,m) {\r\n\tif (!_noBound&&fIsOutRange(y,m)) {\r\n\t\tif (gsOutOfRange!=\"\") alert(gsOutOfRange);\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction fSetCal(y,m,d,bTriggerOnChg,e) {\r\n\tvar t=fCalibrate(parseInt(y,10),parseInt(m,10));\r\n\ty=t[0];\tm=t[1];\r\n\tif (!fCheckRange(y,m)||bTriggerOnChg&&fOnChange&&fOnChange(y,m,d,e)) {\r\n\t\tif (gcbMon) gcbMon.options[gCurMonth[1]-1].selected=true;\r\n\t\tif (gcbYear) gcbYear.options[gCurMonth[0]-gcbYear.options[0].value].selected=true;\r\n\t\treturn false;\r\n\t}\r\n\tif (d>0) fUpdSelect(y,m,d);\r\n\tfDrawCal(y,m);\r\n\tif (fOnResize) fOnResize();\r\n\treturn true;\r\n}\r\n\r\nfunction fSetDate(y,m,d,taint,e) {\r\n\tvar ag=fGetAgenda(y,m,d,taint);\r\n\tif (ag==null||ag[1]==null) return false;\r\n\tif (!fSetCal(y,m,d,true,e)) return false;\r\n\teval(ag[1].replace(/\\n/g,\"\\\\n\"));\r\n\tif (fAfterSelected) fAfterSelected(y,m,d,e);\r\n\tif (gbAutoClose) fHideCal();\r\n\treturn true;\r\n}\r\n\r\nfunction fPrevMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]-1,0,true,e);\r\n}\r\nfunction fNextMonth(e) {\r\n\treturn fSetCal(gCurMonth[0],gCurMonth[1]+1,0,true,e);\r\n}\r\nfunction showPrevMon() {\r\n\tfPrevMonth();\r\n}\r\nfunction showNextMon() {\r\n\tfNextMonth();\r\n}\r\nfunction stopShowMon() {}\r\n\r\nfunction fHint(id) {\r\n\tgContainer.status=__tis[id];\r\n}\r\n\r\nvar __sWH=document.classes.WeekHead.all.backgroundColor,__sCH=document.classes.CalHead.all.backgroundColor;\r\nvar __sLyr=\"' height='\"+(giHeadHeight-giHeadTop)+\"' top='\"+giHeadTop+\"'>\",\r\n__sWH=\"<TD \"+(__sWH?\"bgcolor=\"+__sWH:\"\")+\"><ilayer><layer class='WeekHead' width='\"+giWeekWidth+__sLyr,\r\n__sCH=\"<TD \"+(__sCH?\"bgcolor=\"+__sCH:\"\")+\"><ilayer><layer class='CalHead' width='\"+giCellWidth+__sLyr,\r\n__sWC=\"<TD class='WeekCol'>\",\r\n__sLyrTD=\"</layer></ilayer></TD>\",\r\n__ss=[\"<TD valign=top\",\r\n\" bgcolor='\",\r\n\" class='CalCol'><ilayer><layer class='CalCell' width='\"+giCellWidth+\"' height='\"+giCellHeight+\"' \",\r\n\"background='\",\r\n\" onmouseover='if(gbFocus){gcTemp=this.bgColor;this.bgColor=gcToggle;}fHint(\",\r\n\")' onmouseout='if(gbFocus)this.bgColor=gcTemp' \",\r\n\" ><A class='CellAnchor' href='javascript:void(0)' onmouseover='fHint(\",\r\n\");return true' onmousedown='fDragIt(\",\r\n\",0,event);fSetDate(\",\r\n\",true,event);return false' ><FONT color='\",\r\n\" class='cxpLTB'\",\r\n\" class='cxpLT'\",\r\n\" class='cxpFB'\",\r\n\"</FONT></A>\"],\r\n__tis=[];\r\n\r\nfunction fDrawCal(y,m) {\r\n\tvar td,htm,bo,ag,i,c,c1,dayNo,dc,cbg,isT,isS,weekNo,cd,ex,bfb,sCellDate,sWkCol,weekYear;\r\n\tvar ms=giMarkSelected,ht=giMarkToday;\r\n\tgCurMonth[0]=y; gCurMonth[1]=m;\r\n\tfBuildCal(y,m);\r\n\tgfSelf.visibility=\"hide\";\r\n\twith (document) {\r\n\t\tclear(); open();\r\n\t\tvar a=[this.background.src?\"<BASE href='\"+this.background.src+\"'>\":\"\",\"<BODY leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 bgcolor='\",gcCalBG,\"'><TABLE id='outerTable' \",gsOuterTable,\"><FORM name='cxpTopForm'>\"];\r\n\t\tif (!gbHideTop)\r\n\t\tif (giDCStyle==2)\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><SPAN class='CalTitle'>\",eval(gsCalTitle),\"</SPAN></TD></TR>\");\r\n\t\telse {\r\n\t\t\ta.push(\"<TR><TD class='CalTop' nowrap><table border=0 cellspacing=0 cellpadding=0 width='100%'><tr>\");\r\n\t\t\tif (giDCStyle==1) {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD><TD align='center' class='CalTitle' nowrap>\");\r\n\t\t\t\ta.push(eval(gsCalTitle));\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t} else {\r\n\t\t\t\ta.push(\"<TD align='left' nowrap>\",gsNavPrev,\"</TD>\");\r\n\t\t\t\tvar mstr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='MonSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor (i=0;i<12;i++) {\r\n\t\t\t\t\tmstr.push(\"<OPTION value='\",i+1,\"'>\",gMonths[i],\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tmstr.push(\"</SELECT></TD>\"); mstr=mstr.join('');\r\n\t\t\t\tvar ystr=[\"<TD class='CalTitle' align='center' nowrap><SELECT name='YearSelect' class='CalTitle' onchange='fSetCal(gcbYear.options[gcbYear.selectedIndex].value,gcbMon.options[gcbMon.selectedIndex].value,0,true,event)'>\"];\r\n\t\t\t\tfor(i=gdBegin.getFullYear();i<=gdEnd.getFullYear();i++) {\r\n\t\t\t\t\tystr.push(\"<OPTION value='\",i,\"'>\",eval(gsYearInBox),\"</OPTION>\");\r\n\t\t\t\t}\r\n\t\t\t\tystr.push(\"</SELECT></TD>\"); ystr=ystr.join('');\r\n\t\t\t\tif (gbDCSeq)\r\n\t\t\t\t\ta.push(mstr,ystr);\r\n\t\t\t\telse\r\n\t\t\t\t\ta.push(ystr,mstr);\r\n\t\t\t\ta.push(\"</TD><TD align='right' nowrap>\",gsNavNext,\"</TD></tr></table></TD></TR>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\ta.push(\"</FORM>\");\r\n\t\tif (!gbHideCalMiddle){\r\n\t\t\ta.push(\"<TR class='CalMiddle'><TD class='cxpNS'><ilayer><layer id='innerDiv' \");\r\n\t\t\tif(guCalBG)a.push(\"background='\",guCalBG,\"'\");\r\n\t\t\ta.push(\" bgColor='\",gcCalFrame,\"'><TABLE width='100%' \",gsInnerTable,\" ><TR>\");\r\n\t\t\tfor (var wd=0,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) a.push(__sWH,gsWeekHead,__sLyrTD);\r\n\t\t\t\telse if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tvar sDoW=fOnDoWClick?\"<a class='DoWAnchor' href='javascript:void(0)' onclick='fOnDoWClick(\"\r\n\t       +y+\",\"+m+\",\"+(giFirstDOW+wd)%7+\");return false;'>\"+gWeekDay[wd]+\"</a>\":\"<span class='DoWAnchor'>\"+gWeekDay[wd]+\"</span>\"\r\n\t\t\t\t\ta.push(__sCH,sDoW,__sLyrTD); wd++;\r\n\t\t\t\t}\r\n\t\t\ta.push(\"</TR>\");\r\n\t\t\tif (giWeekCol>=0) {\r\n\t\t\t\tvar w=fDate2W(y,m,1);\r\n\t\t\t\tweekYear=w[0];\r\n\t\t\t\tweekNo=w[1];\r\n\t\t\t}\r\n\t\t\tfor (var week=0; week<6; week++) {\r\n\t\t\t\tex=week>3&&__cal[week][0][1]<20;\r\n\t\t\t\tif (gbShrink2fit&&ex) continue;\r\n\t\t\t\ta.push(\"<TR>\");\r\n\t\t\t\tfor (var day=-1,i=0; i<8; i++)\r\n\t\t\t\tif (i==giWeekCol) {\r\n\t\t\t\t\tsWkCol=fOnWeekClick?\"<a class='WeekAnchor' href='javascript:void(0)' onclick='fOnWeekClick(\"+weekYear+\",\"\r\n\t       +weekNo+\");return false;'>\"+eval(gsWeeks)+\"</a>\":\"<span class='WeekAnchor'>\"+eval(gsWeeks)+\"</span>\";\r\n\t\t\t\t\ta.push(__sWC,(giShowOther&8)&&!(giShowOther&16)&&ex?\"<span class='WeekAnchor'>&nbsp;</span>\":sWkCol,\"</TD>\");\r\n\t\t\t\t\tif (m==1&&weekNo>50||m==12&&weekNo>=52&&weekNo>=fDate2W(y,12,31)[1]) {\r\n\t\t\t\t\t\tweekNo=0; weekYear++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tweekNo++;\r\n\t\t\t\t} else if (i!=7||giWeekCol>=0) {\r\n\t\t\t\t\tday++; dayNo=__cal[week][day][1];\r\n\t\t\t\t\tvar tid=week*10+day;\r\n\t\t\t\t\tcd=fCalibrate(y,__cal[week][day][0]);\r\n\t\t\t\t\tisT=gToday[2]==dayNo&&gToday[1]==cd[1]&&gToday[0]==cd[0];\r\n\t\t\t\t\tag=fGetAgenda(cd[0],cd[1],dayNo,true);\r\n\t\t\t\t\tif (ag==null) {\r\n\t\t\t\t\t\tdc=giShowOther&16&&(week<2&&(giShowOther&4)||week>3&&(giShowOther&8))?gcOtherDay:\"\";\r\n\t\t\t\t\t\tcbg=null; bo=td=false; __tis[tid]=htm=\"\"; c=c1=gcOtherDayBG;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tisS=fIsSelected(cd[0],cd[1],dayNo)&&ag[1]!=null;\r\n\t\t\t\t\t\tvar bt=ag[5]+\"\"==\"true\";\r\n\t\t\t\t\t\tif (cd[1]==m||(giShowOther&2)) {\r\n\t\t\t\t\t\t\tc=isS&&(ms&2)?gcBGSelected:ag[5]?bt?ag[2]:ag[5]:ag[2]==gcCellBG&&isT&&(ht&3)?gcBGToday:ag[2];\r\n\t\t\t\t\t\t\tc1=isS&&(ms&1)&&gcBGSelected?gcBGSelected:ag[2]==gcCellBG||bt?isT&&(ht&1)&&gcBGToday?gcBGToday:gcCellBG:ag[2];\r\n\t\t\t\t\t\t\tbo=isS&&(ms&4)||isT&&(ht&4);\r\n\t\t\t\t\t\t\tdc=isS&&(ms&8)?gcFGSelected:ag[3]==null&&isT&&(ht&8)?gcFGToday:ag[3];\r\n\t\t\t\t\t\t\tcbg=isS&&(ms&16)?guSelectedBGImg:ag[4]==guCellBGImg&&isT&&(ht&16)?guTodayBGImg:ag[4];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbo=false; c=ag[5]&&!bt?ag[5]:ag[2]; c1=bt?gcCellBG:ag[2]; dc=ag[3]; cbg=ag[4];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbo=gbBoldAgenda&&ag[0]&&ag[0]!=gsOutOfRange||bo;\r\n\t\t\t\t\t\thtm=ag[6]?ag[6]:\"\";\r\n\t\t\t\t\t\ttd=ag[1]==null&&_lineThru;\r\n\t\t\t\t\t\t__tis[tid]=isS&&gsSelectedTip?gsSelectedTip:ag[0]?ag[0]:isT&&gsTodayTip?gsTodayTip:\"\";\r\n\t\t\t\t\t\tif (day==giSun&&gcSunBG){c1=c1==gcCellBG?gcSunBG:c1; c=c==gcCellBG?gcSunBG:c;}\r\n\t\t\t\t\t\tif (day==giSat&&gcSatBG){c1=c1==gcCellBG?gcSatBG:c1; c=c==gcCellBG?gcSatBG:c;}\r\n\t\t\t\t\t\tif (dc==null) dc=day==giSun?gcSun:day==giSat?gcSat:gcWorkday;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (gbInvertBold) bo=!bo;\r\n\t\t\t\t\tsCellDate=cd[0]+\",\"+cd[1]+\",\"+dayNo;\r\n\t\t\t\t\ta.push(__ss[0]);if(c)a.push(__ss[1]+c+\"'\");a.push(__ss[2]);if(c1)a.push(__ss[1]+c1+\"'\");\r\n\t\t\t\t\tif(cbg)a.push(__ss[3]+cbg+\"'\");if(dc==\"\")a.push(\" onmouseover='fHint(\",tid,\")'><font class='CellAnchor'>&nbsp;</font>\",__sLyrTD);else{a.push(__ss[4],tid,__ss[5]);\r\n\t\t\t\t\ta.push(__ss[6],tid,__ss[7],sCellDate,__ss[8],sCellDate,__ss[9],dc,\"'\",td?bo?__ss[10]:__ss[11]:bo?__ss[12]:\"\",\">\",eval(gsDays),__ss[13],htm,__sLyrTD);}\r\n\t\t\t\t\tag=null;\r\n\t\t\t\t}\r\n\t\t\t\ta.push(\"</TR>\");\r\n\t\t\t}\r\n\t\t\ta.push(\"</TABLE></layer></ilayer></TD></TR>\");\r\n\t\t}\r\n\t\tif (!gbHideBottom) a.push(\"<FORM name='cxpBottomForm'><TR><TD class='CalBottom' nowrap>\",gsBottom,\"</TD></TR></FORM>\");\r\n\t\ta.push(\"</TABLE>\");\r\n\t\tfor (i=0;i<giFreeDiv;i++)\r\n\t\t\ta.push(\"<layer class='FreeDiv' id='freeDiv\",i,\"' visibility='hide'></layer>\");\r\n\t\ta.push(\"</BODY>\");\r\n\t\twrite(a.join(''));\r\n\t\tif (giDCStyle==0) {\r\n\t\t\tgcbMon=document.forms[\"cxpTopForm\"].MonSelect;\r\n\t\t\tgcbYear=document.forms[\"cxpTopForm\"].YearSelect;\r\n\t\t\tgcbMon.options[m-1].selected=true;\r\n\t\t\tgcbYear.options[y-gcbYear.options[0].value].selected=true;\r\n\t\t}\r\n\t\tclose();\r\n\t}\r\n\tgfSelf.visibility=\"show\";\r\n}\r\n</script>\r\n<script>\r\nif (!gTheme[3]) gTheme[3]=\"gfPop\";\r\nvar __isAS=gTheme[2]&&gTheme[2].substring(0,6)==\"share[\";\r\nif (gbShareAgenda==true) {\r\n\tif (!eval(gsAgShared)) eval(gsAgShared+\"=[]\");\r\n\tif (__isAS) fHoliday=eval(gTheme[2].split('[')[1].split(']')[0]).fHoliday;\r\n}\r\nif (gTheme[2]&&!__isAS) document.write(\"<scr\"+\"ipt type='text/javascript' src='./\"+gTheme[2]+(gbCacheAgenda?\"\":(/\\?/.test(gTheme[2])?\"&\":\"?\")+gd.getTime())+\"'></scr\"+\"ipt>\");\r\n</script>\r\n<script>\r\neval(\"self.\"+gTheme[3]+\"=gfSelf\");\r\nfInitRange();\r\nif(fOnload) fOnload();\r\n</script>\r\n</body>\r\n</html>\r\n"], "filenames": ["FlatCalXP/demos/Classic/iflateng.htm", "FlatCalXP/demos/Classic/nflateng.htm", "FlatCalXP/demos/Fin445/iflateng.htm", "FlatCalXP/demos/Fin445/nflateng.htm", "FlatCalXP/demos/Fullsized/iflateng.htm", "FlatCalXP/demos/Fullsized/nflateng.htm", "FlatCalXP/demos/HelloWorld/iflateng.htm", "FlatCalXP/demos/HelloWorld/nflateng.htm", "FlatCalXP/demos/MockupSibling/iflateng.htm", "FlatCalXP/demos/MockupSibling/nflateng.htm", "FlatCalXP/demos/MultiPicker/iflateng.htm", "FlatCalXP/demos/MultiPicker/nflateng.htm", "FlatCalXP/demos/Popup/iflateng.htm", "FlatCalXP/demos/Popup/nflateng.htm", "FlatCalXP/demos/RangePicker/iflateng.htm", "FlatCalXP/demos/RangePicker/nflateng.htm", "FlatCalXP/demos/RestrictedRange/iflateng.htm", "FlatCalXP/demos/RestrictedRange/nflateng.htm", "FlatCalXP/demos/SchedulePicker/iflateng.htm", "FlatCalXP/demos/SchedulePicker/nflateng.htm", "FlatCalXP/demos/Tileup/iflateng.htm", "FlatCalXP/demos/Tileup/nflateng.htm", "FlatCalXP/engines/iflateng.htm", "FlatCalXP/engines/nflateng.htm", "FlatCalXP/themes/Contrast/iflateng.htm", "FlatCalXP/themes/Contrast/nflateng.htm", "FlatCalXP/themes/Decent/iflateng.htm", "FlatCalXP/themes/Decent/nflateng.htm", "FlatCalXP/themes/Fancy/iflateng.htm", "FlatCalXP/themes/Fancy/nflateng.htm", "FlatCalXP/themes/Mac/iflateng.htm", "FlatCalXP/themes/Mac/nflateng.htm", "FlatCalXP/themes/Mini/iflateng.htm", "FlatCalXP/themes/Mini/nflateng.htm", "FlatCalXP/themes/Mockup/iflateng.htm", "FlatCalXP/themes/Mockup/nflateng.htm", "FlatCalXP/themes/Normal/iflateng.htm", "FlatCalXP/themes/Normal/nflateng.htm", "FlatCalXP/themes/Outlook/iflateng.htm", "FlatCalXP/themes/Outlook/nflateng.htm", "FlatCalXP/themes/OutlookTwin/iflateng.htm", "FlatCalXP/themes/OutlookTwin/nflateng.htm", "FlatCalXP/themes/Supermini/iflateng.htm", "FlatCalXP/themes/Supermini/nflateng.htm", "FlatCalXP/themes/Triplex/iflateng.htm", "FlatCalXP/themes/Triplex/nflateng.htm", "FlatCalXP/themes/xp/iflateng.htm", "FlatCalXP/themes/xp/nflateng.htm", "PopCalXP/demos/Classic/ipopeng.htm", "PopCalXP/demos/Classic/npopeng.htm", "PopCalXP/demos/CrossFrame/ipopeng.htm", "PopCalXP/demos/CrossFrame/npopeng.htm", "PopCalXP/demos/DateRange/ipopeng.htm", "PopCalXP/demos/DateRange/npopeng.htm", "PopCalXP/demos/HelloWorld/ipopeng.htm", "PopCalXP/demos/HelloWorld/npopeng.htm", "PopCalXP/demos/Netscape4/ipopeng.htm", "PopCalXP/demos/Netscape4/npopeng.htm", "PopCalXP/demos/RangePicker/ipopeng.htm", "PopCalXP/demos/RangePicker/npopeng.htm", "PopCalXP/demos/WeekPicker/ipopeng.htm", "PopCalXP/demos/WeekPicker/npopeng.htm", "PopCalXP/engines/ipopeng.htm", "PopCalXP/engines/npopeng.htm", "PopCalXP/themes/Contrast/ipopeng.htm", "PopCalXP/themes/Contrast/npopeng.htm", "PopCalXP/themes/DateTime/ipopeng.htm", "PopCalXP/themes/DateTime/npopeng.htm", "PopCalXP/themes/Double/ipopeng.htm", "PopCalXP/themes/Double/npopeng.htm", "PopCalXP/themes/Fancy/ipopeng.htm", "PopCalXP/themes/Fancy/npopeng.htm", "PopCalXP/themes/Mac/ipopeng.htm", "PopCalXP/themes/Mac/npopeng.htm", "PopCalXP/themes/Mini/ipopeng.htm", "PopCalXP/themes/Mini/npopeng.htm", "PopCalXP/themes/Normal/ipopeng.htm", "PopCalXP/themes/Normal/npopeng.htm", "PopCalXP/themes/Outlook/ipopeng.htm", "PopCalXP/themes/Outlook/npopeng.htm", "PopCalXP/themes/OutlookTriplexVertical/ipopeng.htm", "PopCalXP/themes/OutlookTriplexVertical/npopeng.htm", "PopCalXP/themes/OutlookTwin/ipopeng.htm", "PopCalXP/themes/OutlookTwin/npopeng.htm", "PopCalXP/themes/Supermini/ipopeng.htm", "PopCalXP/themes/Supermini/npopeng.htm", "PopCalXP/themes/xp/ipopeng.htm", "PopCalXP/themes/xp/npopeng.htm"], "buggy_code_start_loc": [120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101], "buggy_code_end_loc": [546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581], "fixing_code_start_loc": [120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 120, 77, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101, 143, 101], "fixing_code_end_loc": [546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 546, 478, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581, 666, 581], "type": "CWE-707", "message": "A vulnerability classified as problematic was found in CalendarXP up to 10.0.1. This vulnerability affects unknown code. The manipulation leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 10.0.2 is able to address this issue. The name of the patch is e3715b2228ddefe00113296069969f9e184836da. It is recommended to upgrade the affected component. VDB-215902 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2022-4522", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-15T21:15:12.853", "lastModified": "2022-12-20T21:33:10.720", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic was found in CalendarXP up to 10.0.1. This vulnerability affects unknown code. The manipulation leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 10.0.2 is able to address this issue. The name of the patch is e3715b2228ddefe00113296069969f9e184836da. It is recommended to upgrade the affected component. VDB-215902 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:calendarxp:calendarxp:*:*:*:*:*:*:*:*", "versionEndIncluding": "10.0.1", "matchCriteriaId": "979CC2AF-F128-4B4A-B192-8F08BBCBECEF"}]}]}], "references": [{"url": "https://github.com/victorwon/calendarxp/commit/e3715b2228ddefe00113296069969f9e184836da", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/victorwon/calendarxp/releases/tag/10.0.2", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.215902", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/victorwon/calendarxp/commit/e3715b2228ddefe00113296069969f9e184836da"}}