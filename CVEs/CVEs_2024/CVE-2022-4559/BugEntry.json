{"buggy_code": ["<?php\n    /** @var Foil\\Template\\Template $t */\n    /** @var $t->active */\n    $this->layout( 'layouts/ixpv4' );\n?>\n\n<?php $this->section( 'page-header-preamble' ) ?>\n    <?= ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ?> / List\n<?php $this->append() ?>\n\n<?php $this->section( 'page-header-postamble' ) ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <a id=\"btn-filter-options\" class=\"btn btn-white\" href=\"<?= route( 'customer@list', [ 'current-only' => $t->showCurrentOnly ? '0' : '1' ] ) ?>\">\n            <?= $t->showCurrentOnly ? ( \"Show All \" . ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ) : ( \"Show Current \" . ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ) ?>\n        </a>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= $t->state ? 'State: ' . \\IXP\\Models\\Customer::$CUST_STATUS_TEXT[ $t->state ] : \"Limit to state...\" ?>\n            </button>\n            <div class=\"dropdown-menu\">\n                <a class=\"dropdown-item  <?= $t->state ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'state' => 0 ] ) ?>\">\n                    All States\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n\n                <?php foreach( \\IXP\\Models\\Customer::$CUST_STATUS_TEXT as $state => $text ): ?>\n                    <a class=\"dropdown-item <?= (int)$t->state !== $state ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'state' => $state ] ) ?>\">\n                        <?= $text ?>\n                    </a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= $t->type ? 'Type: ' . \\IXP\\Models\\Customer::$CUST_TYPES_TEXT[ $t->type ] : \"Limit to type...\" ?>\n            </button>\n            <ul class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item <?= $t->type ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'type' => 0 ] ) ?>\">\n                    All Types\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <?php foreach( \\IXP\\Models\\Customer::$CUST_TYPES_TEXT as $type => $text ): ?>\n                    <a class=\"dropdown-item <?= (int)$t->type !== $type ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'type' => $type ] ) ?>\">\n                        <?= $text ?>\n                    </a>\n                <?php endforeach; ?>\n            </ul>\n        </div>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white btn-xs dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= $t->tag ? 'Tag: ' . $t->tags[ $t->tag ][ 'display_as' ] : \"Limit to tag...\" ?>\n            </button>\n\n            <ul class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item <?= $t->tag ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'tag' => 0 ] ) ?>\">\n                    All Tags\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <?php foreach( $t->tags as $tag ): ?>\n                    <a class=\"dropdown-item <?= $t->tag !== $tag[ 'id' ] ?: \"active\" ?>\"href=\"<?= route( 'customer@list' , [ 'tag' => $tag[ 'id' ] ] ) ?>\">\n                        <?= $tag[ 'display_as' ] ?>\n                    </a>\n                <?php endforeach; ?>\n            </ul>\n        </div>\n\n        <a class=\"btn btn-white\" href=\"<?= route( 'customer@create' ) ?>\">\n            <span class=\"fa fa-plus\"></span>\n        </a>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <?= $t->alerts() ?>\n        <table id='customer-list' class=\"table collapse table-striped no-wrap responsive tw-shadow-md w-100\" >\n            <thead class=\"thead-dark\">\n                <tr>\n                    <th>\n                        Name\n                    </th>\n                    <th>\n                        AS\n                    </th>\n                    <th>\n                        Peering Policy\n                    </th>\n                    <th>\n                        Reseller\n                    </th>\n                    <th>\n                        Type\n                    </th>\n                    <th>\n                        Status\n                    </th>\n                    <th>\n                        Joined\n                    </th>\n                    <th>\n                        Action\n                    </th>\n                </tr>\n            <thead>\n            <tbody>\n            <?php foreach( $t->custs as $c ):\n                /** @var \\IXP\\Models\\Customer $c */\n                ?>\n                <tr>\n                    <td>\n                        <a href=\"<?= route( \"customer@overview\" , [ 'cust' => $c->id ] ) ?>\">\n                            <?= $t->ee( $c->name ) ?>\n                        </a>\n                    </td>\n                    <td>\n                        <?php if( $c->autsys ): ?>\n                            <a href=\"#\">\n                                <?=  $t->asNumber( $c->autsys ) ?>\n                            </a>\n                        <?php endif; ?>\n                    </td>\n                    <td>\n                        <?= $t->ee( $c->peeringpolicy ) ?>\n                    </td>\n                    <td>\n                        <?= $c->reseller ? \"Yes\" : \"No\" ?>\n                    </td>\n                    <td>\n                        <?= $t->insert( 'customer/list-type',   [ 'cust' => $c ] ) ?>\n                    </td>\n                    <td>\n                        <?= $t->insert( 'customer/list-status', [ 'cust' => $c ] ) ?>\n                    </td>\n                    <td>\n                        <?= \\Carbon\\Carbon::instance( $c->datejoin )->format( 'Y-m-d' ) ?>\n                    </td>\n                    <td>\n                        <div class=\"btn-group btn-group-sm\" role=\"group\">\n                            <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\" , [ 'cust' => $c->id ] ) ?>\" title=\"Overview\">\n                                <i class=\"fa fa-eye\"></i>\n                            </a>\n                            <a class=\"btn btn-white\" href=\"<?= route ( \"customer@delete-recap\", [ \"cust\" => $c->id ] )   ?>\" title=\"Delete\">\n                                <i class=\"fa fa-trash\"></i>\n                            </a>\n                        </div>\n                    </td>\n                </tr>\n            <?php endforeach;?>\n            <tbody>\n        </table>\n<?php $this->append() ?>\n\n<?php $this->section( 'scripts' ) ?>\n    <script>\n        $(document).ready( function() {\n            $('#customer-list').dataTable( {\n                responsive: true,\n                stateSave: true,\n                stateDuration : DATATABLE_STATE_DURATION,\n                columnDefs: [\n                    { responsivePriority: 1, targets: 0 },\n                    { responsivePriority: 2, targets: -1 }\n                ],\n            } ).show();\n        });\n    </script>\n<?php $this->append() ?>"], "fixing_code": ["<?php\n    /** @var Foil\\Template\\Template $t */\n    /** @var $t->active */\n    $this->layout( 'layouts/ixpv4' );\n?>\n\n<?php $this->section( 'page-header-preamble' ) ?>\n    <?= ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ?> / List\n<?php $this->append() ?>\n\n<?php $this->section( 'page-header-postamble' ) ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <a id=\"btn-filter-options\" class=\"btn btn-white\" href=\"<?= route( 'customer@list', [ 'current-only' => $t->showCurrentOnly ? '0' : '1' ] ) ?>\">\n            <?= $t->showCurrentOnly ? ( \"Show All \" . ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ) : ( \"Show Current \" . ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ) ?>\n        </a>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= $t->state ? 'State: ' . \\IXP\\Models\\Customer::$CUST_STATUS_TEXT[ $t->state ] : \"Limit to state...\" ?>\n            </button>\n            <div class=\"dropdown-menu\">\n                <a class=\"dropdown-item  <?= $t->state ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'state' => 0 ] ) ?>\">\n                    All States\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n\n                <?php foreach( \\IXP\\Models\\Customer::$CUST_STATUS_TEXT as $state => $text ): ?>\n                    <a class=\"dropdown-item <?= (int)$t->state !== $state ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'state' => $state ] ) ?>\">\n                        <?= $text ?>\n                    </a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= $t->type ? 'Type: ' . \\IXP\\Models\\Customer::$CUST_TYPES_TEXT[ $t->type ] : \"Limit to type...\" ?>\n            </button>\n            <ul class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item <?= $t->type ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'type' => 0 ] ) ?>\">\n                    All Types\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <?php foreach( \\IXP\\Models\\Customer::$CUST_TYPES_TEXT as $type => $text ): ?>\n                    <a class=\"dropdown-item <?= (int)$t->type !== $type ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'type' => $type ] ) ?>\">\n                        <?= $text ?>\n                    </a>\n                <?php endforeach; ?>\n            </ul>\n        </div>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white btn-xs dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= $t->tag ? 'Tag: ' . $t->ee( $t->tags[ $t->tag ][ 'display_as' ] ) : \"Limit to tag...\" ?>\n            </button>\n\n            <ul class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item <?= $t->tag ?: \"active\" ?>\" href=\"<?= route( 'customer@list', [ 'tag' => 0 ] ) ?>\">\n                    All Tags\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <?php foreach( $t->tags as $tag ): ?>\n                    <a class=\"dropdown-item <?= $t->tag !== $tag[ 'id' ] ?: \"active\" ?>\"href=\"<?= route( 'customer@list' , [ 'tag' => $tag[ 'id' ] ] ) ?>\">\n                        <?= $t->ee( $tag[ 'display_as' ] ) ?>\n                    </a>\n                <?php endforeach; ?>\n            </ul>\n        </div>\n\n        <a class=\"btn btn-white\" href=\"<?= route( 'customer@create' ) ?>\">\n            <span class=\"fa fa-plus\"></span>\n        </a>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <?= $t->alerts() ?>\n        <table id='customer-list' class=\"table collapse table-striped no-wrap responsive tw-shadow-md w-100\" >\n            <thead class=\"thead-dark\">\n                <tr>\n                    <th>\n                        Name\n                    </th>\n                    <th>\n                        AS\n                    </th>\n                    <th>\n                        Peering Policy\n                    </th>\n                    <th>\n                        Reseller\n                    </th>\n                    <th>\n                        Type\n                    </th>\n                    <th>\n                        Status\n                    </th>\n                    <th>\n                        Joined\n                    </th>\n                    <th>\n                        Action\n                    </th>\n                </tr>\n            <thead>\n            <tbody>\n            <?php foreach( $t->custs as $c ):\n                /** @var \\IXP\\Models\\Customer $c */\n                ?>\n                <tr>\n                    <td>\n                        <a href=\"<?= route( \"customer@overview\" , [ 'cust' => $c->id ] ) ?>\">\n                            <?= $t->ee( $c->name ) ?>\n                        </a>\n                    </td>\n                    <td>\n                        <?php if( $c->autsys ): ?>\n                            <a href=\"#\">\n                                <?=  $t->asNumber( $c->autsys ) ?>\n                            </a>\n                        <?php endif; ?>\n                    </td>\n                    <td>\n                        <?= $t->ee( $c->peeringpolicy ) ?>\n                    </td>\n                    <td>\n                        <?= $c->reseller ? \"Yes\" : \"No\" ?>\n                    </td>\n                    <td>\n                        <?= $t->insert( 'customer/list-type',   [ 'cust' => $c ] ) ?>\n                    </td>\n                    <td>\n                        <?= $t->insert( 'customer/list-status', [ 'cust' => $c ] ) ?>\n                    </td>\n                    <td>\n                        <?= \\Carbon\\Carbon::instance( $c->datejoin )->format( 'Y-m-d' ) ?>\n                    </td>\n                    <td>\n                        <div class=\"btn-group btn-group-sm\" role=\"group\">\n                            <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\" , [ 'cust' => $c->id ] ) ?>\" title=\"Overview\">\n                                <i class=\"fa fa-eye\"></i>\n                            </a>\n                            <a class=\"btn btn-white\" href=\"<?= route ( \"customer@delete-recap\", [ \"cust\" => $c->id ] )   ?>\" title=\"Delete\">\n                                <i class=\"fa fa-trash\"></i>\n                            </a>\n                        </div>\n                    </td>\n                </tr>\n            <?php endforeach;?>\n            <tbody>\n        </table>\n<?php $this->append() ?>\n\n<?php $this->section( 'scripts' ) ?>\n    <script>\n        $(document).ready( function() {\n            $('#customer-list').dataTable( {\n                responsive: true,\n                stateSave: true,\n                stateDuration : DATATABLE_STATE_DURATION,\n                columnDefs: [\n                    { responsivePriority: 1, targets: 0 },\n                    { responsivePriority: 2, targets: -1 }\n                ],\n            } ).show();\n        });\n    </script>\n<?php $this->append() ?>"], "filenames": ["resources/views/customer/list.foil.php"], "buggy_code_start_loc": [56], "buggy_code_end_loc": [68], "fixing_code_start_loc": [56], "fixing_code_end_loc": [68], "type": "CWE-707", "message": "A vulnerability was found in INEX IPX-Manager up to 6.2.0. It has been declared as problematic. This vulnerability affects unknown code of the file resources/views/customer/list.foil.php. The manipulation leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 6.3.0 is able to address this issue. The name of the patch is bc9b14c6f70cccdb89b559e8bc3a7318bfe9c243. It is recommended to upgrade the affected component. VDB-215962 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2022-4559", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-16T17:15:08.953", "lastModified": "2022-12-21T18:24:56.963", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in INEX IPX-Manager up to 6.2.0. It has been declared as problematic. This vulnerability affects unknown code of the file resources/views/customer/list.foil.php. The manipulation leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 6.3.0 is able to address this issue. The name of the patch is bc9b14c6f70cccdb89b559e8bc3a7318bfe9c243. It is recommended to upgrade the affected component. VDB-215962 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:inex:ixp_manager:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.3.0", "matchCriteriaId": "CBA538CB-677F-4BD0-87A2-306B634FBCD6"}]}]}], "references": [{"url": "https://github.com/inex/IXP-Manager/commit/bc9b14c6f70cccdb89b559e8bc3a7318bfe9c243", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/inex/IXP-Manager/releases/tag/v6.3.0", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.215962", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/inex/IXP-Manager/commit/bc9b14c6f70cccdb89b559e8bc3a7318bfe9c243"}}