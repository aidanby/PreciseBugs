{"buggy_code": ["/*\n * Copyright IBM Corp. 1999, 2010\n *\n *   Author(s):\tHartmut Penner <hp@de.ibm.com>\n *\t\tMartin Schwidefsky <schwidefsky@de.ibm.com>\n *\t\tRob van der Heij <rvdhei@iae.nl>\n *\t\tHeiko Carstens <heiko.carstens@de.ibm.com>\n *\n */\n\n#include <linux/init.h>\n#include <linux/linkage.h>\n#include <asm/asm-offsets.h>\n#include <asm/thread_info.h>\n#include <asm/page.h>\n\n__HEAD\nENTRY(startup_continue)\n\tlarl\t%r1,sched_clock_base_cc\n\tmvc\t0(8,%r1),__LC_LAST_UPDATE_CLOCK\n\tlarl\t%r13,.LPG1\t\t# get base\n\tlctlg\t%c0,%c15,.Lctl-.LPG1(%r13)\t# load control registers\n\tlg\t%r12,.Lparmaddr-.LPG1(%r13)\t# pointer to parameter area\n\t\t\t\t\t# move IPL device to lowcore\n\tlghi\t%r0,__LC_PASTE\n\tstg\t%r0,__LC_VDSO_PER_CPU\n#\n# Setup stack\n#\n\tlarl\t%r15,init_thread_union\n\tstg\t%r15,__LC_THREAD_INFO\t# cache thread info in lowcore\n\tlg\t%r14,__TI_task(%r15)\t# cache current in lowcore\n\tstg\t%r14,__LC_CURRENT\n\taghi\t%r15,1<<(PAGE_SHIFT+THREAD_ORDER) # init_task_union + THREAD_SIZE\n\tstg\t%r15,__LC_KERNEL_STACK\t# set end of kernel stack\n\taghi\t%r15,-160\n#\n# Save ipl parameters, clear bss memory, initialize storage key for kernel pages,\n# and create a kernel NSS if the SAVESYS= parm is defined\n#\n\tbrasl\t%r14,startup_init\n\tlpswe\t.Lentry-.LPG1(13)\t# jump to _stext in primary-space,\n\t\t\t\t\t# virtual and never return ...\n\t.align\t16\n.LPG1:\n.Lentry:.quad\t0x0000000180000000,_stext\n.Lctl:\t.quad\t0x04040000\t\t# cr0: AFP registers & secondary space\n\t.quad\t0\t\t\t# cr1: primary space segment table\n\t.quad\t.Lduct\t\t\t# cr2: dispatchable unit control table\n\t.quad\t0\t\t\t# cr3: instruction authorization\n\t.quad\t0\t\t\t# cr4: instruction authorization\n\t.quad\t.Lduct\t\t\t# cr5: primary-aste origin\n\t.quad\t0\t\t\t# cr6:\tI/O interrupts\n\t.quad\t0\t\t\t# cr7:\tsecondary space segment table\n\t.quad\t0\t\t\t# cr8:\taccess registers translation\n\t.quad\t0\t\t\t# cr9:\ttracing off\n\t.quad\t0\t\t\t# cr10: tracing off\n\t.quad\t0\t\t\t# cr11: tracing off\n\t.quad\t0\t\t\t# cr12: tracing off\n\t.quad\t0\t\t\t# cr13: home space segment table\n\t.quad\t0xc0000000\t\t# cr14: machine check handling off\n\t.quad\t0\t\t\t# cr15: linkage stack operations\n.Lpcmsk:.quad\t0x0000000180000000\n.L4malign:.quad 0xffffffffffc00000\n.Lscan2g:.quad\t0x80000000 + 0x20000 - 8\t# 2GB + 128K - 8\n.Lnop:\t.long\t0x07000700\n.Lparmaddr:\n\t.quad\tPARMAREA\n\t.align\t64\n.Lduct: .long\t0,0,0,0,.Lduald,0,0,0\n\t.long\t0,0,0,0,0,0,0,0\n\t.align\t128\n.Lduald:.rept\t8\n\t.long\t0x80000000,0,0,0\t# invalid access-list entries\n\t.endr\n\nENTRY(_ehead)\n\n\t.org\t0x100000 - 0x11000\t# head.o ends at 0x11000\n#\n# startup-code, running in absolute addressing mode\n#\nENTRY(_stext)\n\tbasr\t%r13,0\t\t\t# get base\n.LPG3:\n# check control registers\n\tstctg\t%c0,%c15,0(%r15)\n\toi\t6(%r15),0x60\t\t# enable sigp emergency & external call\n\toi\t4(%r15),0x10\t\t# switch on low address proctection\n\tlctlg\t%c0,%c15,0(%r15)\n\n\tlam\t0,15,.Laregs-.LPG3(%r13)\t# load acrs needed by uaccess\n\tbrasl\t%r14,start_kernel\t# go to C code\n#\n# We returned from start_kernel ?!? PANIK\n#\n\tbasr\t%r13,0\n\tlpswe\t.Ldw-.(%r13)\t\t# load disabled wait psw\n\n\t.align\t8\n.Ldw:\t.quad\t0x0002000180000000,0x0000000000000000\n.Laregs:.long\t0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\n"], "fixing_code": ["/*\n * Copyright IBM Corp. 1999, 2010\n *\n *   Author(s):\tHartmut Penner <hp@de.ibm.com>\n *\t\tMartin Schwidefsky <schwidefsky@de.ibm.com>\n *\t\tRob van der Heij <rvdhei@iae.nl>\n *\t\tHeiko Carstens <heiko.carstens@de.ibm.com>\n *\n */\n\n#include <linux/init.h>\n#include <linux/linkage.h>\n#include <asm/asm-offsets.h>\n#include <asm/thread_info.h>\n#include <asm/page.h>\n\n__HEAD\nENTRY(startup_continue)\n\tlarl\t%r1,sched_clock_base_cc\n\tmvc\t0(8,%r1),__LC_LAST_UPDATE_CLOCK\n\tlarl\t%r13,.LPG1\t\t# get base\n\tlctlg\t%c0,%c15,.Lctl-.LPG1(%r13)\t# load control registers\n\tlg\t%r12,.Lparmaddr-.LPG1(%r13)\t# pointer to parameter area\n\t\t\t\t\t# move IPL device to lowcore\n\tlghi\t%r0,__LC_PASTE\n\tstg\t%r0,__LC_VDSO_PER_CPU\n#\n# Setup stack\n#\n\tlarl\t%r15,init_thread_union\n\tstg\t%r15,__LC_THREAD_INFO\t# cache thread info in lowcore\n\tlg\t%r14,__TI_task(%r15)\t# cache current in lowcore\n\tstg\t%r14,__LC_CURRENT\n\taghi\t%r15,1<<(PAGE_SHIFT+THREAD_ORDER) # init_task_union + THREAD_SIZE\n\tstg\t%r15,__LC_KERNEL_STACK\t# set end of kernel stack\n\taghi\t%r15,-160\n#\n# Save ipl parameters, clear bss memory, initialize storage key for kernel pages,\n# and create a kernel NSS if the SAVESYS= parm is defined\n#\n\tbrasl\t%r14,startup_init\n\tlpswe\t.Lentry-.LPG1(13)\t# jump to _stext in primary-space,\n\t\t\t\t\t# virtual and never return ...\n\t.align\t16\n.LPG1:\n.Lentry:.quad\t0x0000000180000000,_stext\n.Lctl:\t.quad\t0x04040000\t\t# cr0: AFP registers & secondary space\n\t.quad\t0\t\t\t# cr1: primary space segment table\n\t.quad\t.Lduct\t\t\t# cr2: dispatchable unit control table\n\t.quad\t0\t\t\t# cr3: instruction authorization\n\t.quad\t0\t\t\t# cr4: instruction authorization\n\t.quad\t.Lduct\t\t\t# cr5: primary-aste origin\n\t.quad\t0\t\t\t# cr6:\tI/O interrupts\n\t.quad\t0\t\t\t# cr7:\tsecondary space segment table\n\t.quad\t0\t\t\t# cr8:\taccess registers translation\n\t.quad\t0\t\t\t# cr9:\ttracing off\n\t.quad\t0\t\t\t# cr10: tracing off\n\t.quad\t0\t\t\t# cr11: tracing off\n\t.quad\t0\t\t\t# cr12: tracing off\n\t.quad\t0\t\t\t# cr13: home space segment table\n\t.quad\t0xc0000000\t\t# cr14: machine check handling off\n\t.quad\t.Llinkage_stack\t\t# cr15: linkage stack operations\n.Lpcmsk:.quad\t0x0000000180000000\n.L4malign:.quad 0xffffffffffc00000\n.Lscan2g:.quad\t0x80000000 + 0x20000 - 8\t# 2GB + 128K - 8\n.Lnop:\t.long\t0x07000700\n.Lparmaddr:\n\t.quad\tPARMAREA\n\t.align\t64\n.Lduct: .long\t0,.Laste,.Laste,0,.Lduald,0,0,0\n\t.long\t0,0,0,0,0,0,0,0\n.Laste:\t.quad\t0,0xffffffffffffffff,0,0,0,0,0,0\n\t.align\t128\n.Lduald:.rept\t8\n\t.long\t0x80000000,0,0,0\t# invalid access-list entries\n\t.endr\n.Llinkage_stack:\n\t.long\t0,0,0x89000000,0,0,0,0x8a000000,0\n\nENTRY(_ehead)\n\n\t.org\t0x100000 - 0x11000\t# head.o ends at 0x11000\n#\n# startup-code, running in absolute addressing mode\n#\nENTRY(_stext)\n\tbasr\t%r13,0\t\t\t# get base\n.LPG3:\n# check control registers\n\tstctg\t%c0,%c15,0(%r15)\n\toi\t6(%r15),0x60\t\t# enable sigp emergency & external call\n\toi\t4(%r15),0x10\t\t# switch on low address proctection\n\tlctlg\t%c0,%c15,0(%r15)\n\n\tlam\t0,15,.Laregs-.LPG3(%r13)\t# load acrs needed by uaccess\n\tbrasl\t%r14,start_kernel\t# go to C code\n#\n# We returned from start_kernel ?!? PANIK\n#\n\tbasr\t%r13,0\n\tlpswe\t.Ldw-.(%r13)\t\t# load disabled wait psw\n\n\t.align\t8\n.Ldw:\t.quad\t0x0002000180000000,0x0000000000000000\n.Laregs:.long\t0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0\n"], "filenames": ["arch/s390/kernel/head64.S"], "buggy_code_start_loc": [62], "buggy_code_end_loc": [75], "fixing_code_start_loc": [62], "fixing_code_end_loc": [79], "type": "CWE-20", "message": "arch/s390/kernel/head64.S in the Linux kernel before 3.13.5 on the s390 platform does not properly handle attempted use of the linkage stack, which allows local users to cause a denial of service (system crash) by executing a crafted instruction.", "other": {"cve": {"id": "CVE-2014-2039", "sourceIdentifier": "secalert@redhat.com", "published": "2014-02-28T06:18:54.633", "lastModified": "2023-02-13T00:38:40.030", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "arch/s390/kernel/head64.S in the Linux kernel before 3.13.5 on the s390 platform does not properly handle attempted use of the linkage stack, which allows local users to cause a denial of service (system crash) by executing a crafted instruction."}, {"lang": "es", "value": "arch/s390/kernel/head64.S en el kernel de Linux anterior a 3.13.5 en la plataforma s390 no maneja debidamente intentos de uso de la pila de vinculaci\u00f3n, lo que permite a usuarios locales causar una denegaci\u00f3n de servicio (ca\u00edda de sistema) mediante la ejecuci\u00f3n de una instrucci\u00f3n manipulada."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 4.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.13.5", "matchCriteriaId": "3E693631-6574-496A-9CD3-B980B67CACBB"}]}]}], "references": [{"url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=8d7f6690cedb83456edd41c9bd583783f0703bf0", "source": "secalert@redhat.com"}, {"url": "http://linux.oracle.com/errata/ELSA-2014-0771.html", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.13.5", "source": "secalert@redhat.com", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2014/02/20/14", "source": "secalert@redhat.com", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/65700", "source": "secalert@redhat.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1067558", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/torvalds/linux/commit/8d7f6690cedb83456edd41c9bd583783f0703bf0", "source": "secalert@redhat.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/torvalds/linux/commit/8d7f6690cedb83456edd41c9bd583783f0703bf0"}}