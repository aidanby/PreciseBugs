{"buggy_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <parent>\n    <groupId>org.xwiki.platform</groupId>\n    <artifactId>xwiki-platform-vfs</artifactId>\n    <version>15.0-SNAPSHOT</version>\n  </parent>\n  <artifactId>xwiki-platform-vfs-ui</artifactId>\n  <name>XWiki Platform - VFS - UI</name>\n  <packaging>xar</packaging>\n  <description>Provides a VFS Tree Macro</description>\n  <properties>\n    <!-- Name to display by the Extension Manager -->\n    <xwiki.extension.name>VFS Tree Macro</xwiki.extension.name>\n  </properties>\n  <dependencies>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-vfs-api</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-macro-velocity</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-tree-macro</artifactId>\n      <version>${project.version}</version>\n      <type>xar</type>\n      <scope>runtime</scope>\n    </dependency>\n    <!-- Needed for Wiki Macros -->\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-wikimacro-store</artifactId>\n      <version>${project.version}</version>\n    </dependency>\n  </dependencies>\n</project>\n", "<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.5\" reference=\"Macros.VFSTreeMacro\" locale=\"\">\n  <web>Macros</web>\n  <name>VFSTreeMacro</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>Macros.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>VFS Tree Macro</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content/>\n  <object>\n    <name>Macros.VFSTreeMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroClass</className>\n    <guid>bbbe967b-c3b1-4986-9186-34ee221747c6</guid>\n    <class>\n      <name>XWiki.WikiMacroClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>13</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>14</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.parameters=Request parameters|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>12</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <code>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>code</name>\n        <number>10</number>\n        <prettyName>Macro code</prettyName>\n        <rows>20</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentDescription>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>contentDescription</name>\n        <number>9</number>\n        <prettyName>Content description (Not applicable for \"No content\" type)</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </contentDescription>\n      <contentJavaType>\n        <cache>0</cache>\n        <defaultValue>Unknown</defaultValue>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText>allowed</freeText>\n        <largeStorage>1</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentJavaType</name>\n        <number>8</number>\n        <picker>1</picker>\n        <prettyName>Macro content type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Unknown|Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentJavaType>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>7</number>\n        <prettyName>Macro content availability</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Optional|Mandatory|No content</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <defaultCategories>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>defaultCategories</name>\n        <number>4</number>\n        <prettyName>Default categories</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values/>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </defaultCategories>\n      <description>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>description</name>\n        <number>3</number>\n        <prettyName>Macro description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <id>\n        <disabled>0</disabled>\n        <name>id</name>\n        <number>1</number>\n        <prettyName>Macro id</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </id>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>2</number>\n        <prettyName>Macro name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <priority>\n        <disabled>0</disabled>\n        <name>priority</name>\n        <number>11</number>\n        <numberType>integer</numberType>\n        <prettyName>Priority</prettyName>\n        <size>10</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.NumberClass</classType>\n      </priority>\n      <supportsInlineMode>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>supportsInlineMode</name>\n        <number>5</number>\n        <prettyName>Supports inline mode</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </supportsInlineMode>\n      <visibility>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>visibility</name>\n        <number>6</number>\n        <prettyName>Macro visibility</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Current User|Current Wiki|Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </visibility>\n    </class>\n    <property>\n      <async_cached>0</async_cached>\n    </property>\n    <property>\n      <async_context/>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <code>{{velocity}}\n{{tree root=\"$xcontext.macro.params.root\" reference=\"path:$xwiki.getURL($doc.getDocumentReference(), 'get', 'sheet=Macros.VFSTreeJSON&amp;outputSyntax=plain')\" links=\"true\"/}}\n{{/velocity}}</code>\n    </property>\n    <property>\n      <contentDescription/>\n    </property>\n    <property>\n      <contentJavaType/>\n    </property>\n    <property>\n      <contentType>No content</contentType>\n    </property>\n    <property>\n      <defaultCategories>\n        <value>Navigation</value>\n      </defaultCategories>\n    </property>\n    <property>\n      <description>Displays a tree explorer for the passed archive</description>\n    </property>\n    <property>\n      <id>vfsTree</id>\n    </property>\n    <property>\n      <name>VFS Tree</name>\n    </property>\n    <property>\n      <priority/>\n    </property>\n    <property>\n      <supportsInlineMode>0</supportsInlineMode>\n    </property>\n    <property>\n      <visibility>Current Wiki</visibility>\n    </property>\n  </object>\n  <object>\n    <name>Macros.VFSTreeMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>3ba59568-c3b1-47fb-a931-f4e1128b9e21</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <type>\n        <disabled>0</disabled>\n        <name>type</name>\n        <number>5</number>\n        <prettyName>Parameter type</prettyName>\n        <size>60</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </type>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>The reference to the file in an attachment archive (e.g. \"attach:space.page@attachment/my/file.txt\")</description>\n    </property>\n    <property>\n      <mandatory>1</mandatory>\n    </property>\n    <property>\n      <name>root</name>\n    </property>\n    <property>\n      <type/>\n    </property>\n  </object>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <parent>\n    <groupId>org.xwiki.platform</groupId>\n    <artifactId>xwiki-platform-vfs</artifactId>\n    <version>15.0-SNAPSHOT</version>\n  </parent>\n  <artifactId>xwiki-platform-vfs-ui</artifactId>\n  <name>XWiki Platform - VFS - UI</name>\n  <packaging>xar</packaging>\n  <description>Provides a VFS Tree Macro</description>\n  <properties>\n    <!-- Name to display by the Extension Manager -->\n    <xwiki.extension.name>VFS Tree Macro</xwiki.extension.name>\n  </properties>\n  <dependencies>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-vfs-api</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-macro-velocity</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-tree-macro</artifactId>\n      <version>${project.version}</version>\n      <type>xar</type>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <!-- Needed for Wiki Macros -->\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-wikimacro-store</artifactId>\n      <version>${project.version}</version>\n    </dependency>\n  </dependencies>\n</project>\n", "<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.5\" reference=\"Macros.VFSTreeMacro\" locale=\"\">\n  <web>Macros</web>\n  <name>VFSTreeMacro</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>Macros.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>VFS Tree Macro</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content/>\n  <object>\n    <name>Macros.VFSTreeMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroClass</className>\n    <guid>bbbe967b-c3b1-4986-9186-34ee221747c6</guid>\n    <class>\n      <name>XWiki.WikiMacroClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>13</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>14</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.parameters=Request parameters|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>12</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <code>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>code</name>\n        <number>10</number>\n        <prettyName>Macro code</prettyName>\n        <rows>20</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentDescription>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>contentDescription</name>\n        <number>9</number>\n        <prettyName>Content description (Not applicable for \"No content\" type)</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </contentDescription>\n      <contentJavaType>\n        <cache>0</cache>\n        <defaultValue>Unknown</defaultValue>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText>allowed</freeText>\n        <largeStorage>1</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentJavaType</name>\n        <number>8</number>\n        <picker>1</picker>\n        <prettyName>Macro content type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Unknown|Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentJavaType>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>7</number>\n        <prettyName>Macro content availability</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Optional|Mandatory|No content</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <defaultCategories>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>defaultCategories</name>\n        <number>4</number>\n        <prettyName>Default categories</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values/>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </defaultCategories>\n      <description>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>description</name>\n        <number>3</number>\n        <prettyName>Macro description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <id>\n        <disabled>0</disabled>\n        <name>id</name>\n        <number>1</number>\n        <prettyName>Macro id</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </id>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>2</number>\n        <prettyName>Macro name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <priority>\n        <disabled>0</disabled>\n        <name>priority</name>\n        <number>11</number>\n        <numberType>integer</numberType>\n        <prettyName>Priority</prettyName>\n        <size>10</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.NumberClass</classType>\n      </priority>\n      <supportsInlineMode>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>supportsInlineMode</name>\n        <number>5</number>\n        <prettyName>Supports inline mode</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </supportsInlineMode>\n      <visibility>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>visibility</name>\n        <number>6</number>\n        <prettyName>Macro visibility</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Current User|Current Wiki|Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </visibility>\n    </class>\n    <property>\n      <async_cached>0</async_cached>\n    </property>\n    <property>\n      <async_context/>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <code>{{velocity}}\n#set ($root = $services.rendering.escape($xcontext.macro.params.root, 'xwiki/2.1'))\n#set ($reference = $services.rendering.escape(\"path:$xwiki.getURL($doc.getDocumentReference(), 'get', 'sheet=Macros.VFSTreeJSON&amp;outputSyntax=plain')\", 'xwiki/2.1'))\n{{tree root=\"$root\" reference=\"$reference\" links=\"true\"/}}\n{{/velocity}}</code>\n    </property>\n    <property>\n      <contentDescription/>\n    </property>\n    <property>\n      <contentJavaType/>\n    </property>\n    <property>\n      <contentType>No content</contentType>\n    </property>\n    <property>\n      <defaultCategories>\n        <value>Navigation</value>\n      </defaultCategories>\n    </property>\n    <property>\n      <description>Displays a tree explorer for the passed archive</description>\n    </property>\n    <property>\n      <id>vfsTree</id>\n    </property>\n    <property>\n      <name>VFS Tree</name>\n    </property>\n    <property>\n      <priority/>\n    </property>\n    <property>\n      <supportsInlineMode>0</supportsInlineMode>\n    </property>\n    <property>\n      <visibility>Current Wiki</visibility>\n    </property>\n  </object>\n  <object>\n    <name>Macros.VFSTreeMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>3ba59568-c3b1-47fb-a931-f4e1128b9e21</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <type>\n        <disabled>0</disabled>\n        <name>type</name>\n        <number>5</number>\n        <prettyName>Parameter type</prettyName>\n        <size>60</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </type>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>The reference to the file in an attachment archive (e.g. \"attach:space.page@attachment/my/file.txt\")</description>\n    </property>\n    <property>\n      <mandatory>1</mandatory>\n    </property>\n    <property>\n      <name>root</name>\n    </property>\n    <property>\n      <type/>\n    </property>\n  </object>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-vfs/xwiki-platform-vfs-ui/pom.xml", "xwiki-platform-core/xwiki-platform-vfs/xwiki-platform-vfs-ui/src/main/resources/Macros/VFSTreeMacro.xml"], "buggy_code_start_loc": [57, 253], "buggy_code_end_loc": [57, 254], "fixing_code_start_loc": [58, 253], "fixing_code_end_loc": [64, 256], "type": "CWE-74", "message": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Any user with view rights can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of `Macro.VFSTreeMacro`. This page is not installed by default.This vulnerability has been patched in XWiki 15.0-rc-1, 14.10.2, 14.4.8, 13.10.11. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "other": {"cve": {"id": "CVE-2023-29521", "sourceIdentifier": "security-advisories@github.com", "published": "2023-04-19T00:15:08.823", "lastModified": "2023-04-28T18:09:46.150", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Any user with view rights can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of `Macro.VFSTreeMacro`. This page is not installed by default.This vulnerability has been patched in XWiki 15.0-rc-1, 14.10.2, 14.4.8, 13.10.11. Users are advised to upgrade. There are no known workarounds for this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 8.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionEndExcluding": "13.10.11", "matchCriteriaId": "A3CD7FFB-D491-4B7D-839D-D567B0C00E59"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.0", "versionEndExcluding": "14.4.8", "matchCriteriaId": "AD2B185D-F8A6-49EB-B485-744F234B8730"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.5", "versionEndExcluding": "14.10.2", "matchCriteriaId": "E472CD99-824B-4235-B9AB-2740FB40F601"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/fad02328f5ec7ab7fe5b932ffb5bc5c1ba7a5b12", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p67q-h88v-5jgr", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-20260", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/fad02328f5ec7ab7fe5b932ffb5bc5c1ba7a5b12"}}