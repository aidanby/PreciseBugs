{"buggy_code": ["<%--\n/**\n * Copyright (c) 2000-present Liferay, Inc. All rights reserved.\n *\n * This library is free software; you can redistribute it and/or modify it under\n * the terms of the GNU Lesser General Public License as published by the Free\n * Software Foundation; either version 2.1 of the License, or (at your option)\n * any later version.\n *\n * This library is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more\n * details.\n */\n--%>\n\n<%@ include file=\"/journal_article/init.jsp\" %>\n\n<liferay-util:dynamic-include key=\"com.liferay.journal.taglib#/journal_article/page.jsp#pre\" />\n\n<%\nJournalArticleDisplay articleDisplay = (JournalArticleDisplay)request.getAttribute(\"liferay-journal:journal-article:articleDisplay\");\nboolean showTitle = GetterUtil.getBoolean((String)request.getAttribute(\"liferay-journal:journal-article:showTitle\"));\nString wrapperCssClass = (String)request.getAttribute(\"liferay-journal:journal-article:wrapperCssClass\");\n%>\n\n<div class=\"journal-content-article <%= Validator.isNotNull(wrapperCssClass) ? wrapperCssClass : StringPool.BLANK %>\" data-analytics-asset-id=\"<%= articleDisplay.getArticleId() %>\" data-analytics-asset-title=\"<%= HtmlUtil.escapeAttribute(articleDisplay.getTitle()) %>\" data-analytics-asset-type=\"web-content\">\n\t<c:if test=\"<%= showTitle %>\">\n\t\t<%= articleDisplay.getTitle() %>\n\t</c:if>\n\n\t<%= articleDisplay.getContent() %>\n</div>\n\n<%\nList<AssetTag> assetTags = AssetTagLocalServiceUtil.getTags(JournalArticleDisplay.class.getName(), articleDisplay.getResourcePrimKey());\n\nPortalUtil.setPageKeywords(ListUtil.toString(assetTags, AssetTag.NAME_ACCESSOR), request);\n%>\n\n<liferay-util:dynamic-include key=\"com.liferay.journal.taglib#/journal_article/page.jsp#post\" />"], "fixing_code": ["<%--\n/**\n * Copyright (c) 2000-present Liferay, Inc. All rights reserved.\n *\n * This library is free software; you can redistribute it and/or modify it under\n * the terms of the GNU Lesser General Public License as published by the Free\n * Software Foundation; either version 2.1 of the License, or (at your option)\n * any later version.\n *\n * This library is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more\n * details.\n */\n--%>\n\n<%@ include file=\"/journal_article/init.jsp\" %>\n\n<liferay-util:dynamic-include key=\"com.liferay.journal.taglib#/journal_article/page.jsp#pre\" />\n\n<%\nJournalArticleDisplay articleDisplay = (JournalArticleDisplay)request.getAttribute(\"liferay-journal:journal-article:articleDisplay\");\nboolean showTitle = GetterUtil.getBoolean((String)request.getAttribute(\"liferay-journal:journal-article:showTitle\"));\nString wrapperCssClass = (String)request.getAttribute(\"liferay-journal:journal-article:wrapperCssClass\");\n%>\n\n<div class=\"journal-content-article <%= Validator.isNotNull(wrapperCssClass) ? wrapperCssClass : StringPool.BLANK %>\" data-analytics-asset-id=\"<%= articleDisplay.getArticleId() %>\" data-analytics-asset-title=\"<%= HtmlUtil.escapeAttribute(articleDisplay.getTitle()) %>\" data-analytics-asset-type=\"web-content\">\n\t<c:if test=\"<%= showTitle %>\">\n\t\t<%= HtmlUtil.escape(articleDisplay.getTitle()) %>\n\t</c:if>\n\n\t<%= articleDisplay.getContent() %>\n</div>\n\n<%\nList<AssetTag> assetTags = AssetTagLocalServiceUtil.getTags(JournalArticleDisplay.class.getName(), articleDisplay.getResourcePrimKey());\n\nPortalUtil.setPageKeywords(ListUtil.toString(assetTags, AssetTag.NAME_ACCESSOR), request);\n%>\n\n<liferay-util:dynamic-include key=\"com.liferay.journal.taglib#/journal_article/page.jsp#post\" />"], "filenames": ["modules/apps/journal/journal-taglib/src/main/resources/META-INF/resources/journal_article/page.jsp"], "buggy_code_start_loc": [29], "buggy_code_end_loc": [30], "fixing_code_start_loc": [29], "fixing_code_end_loc": [30], "type": "CWE-79", "message": "Liferay Portal through 7.2.0 GA1 allows XSS via a journal article title to journal_article/page.jsp in journal/journal-taglib.", "other": {"cve": {"id": "CVE-2019-16147", "sourceIdentifier": "cve@mitre.org", "published": "2019-09-09T21:15:11.077", "lastModified": "2019-09-10T17:34:49.150", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Liferay Portal through 7.2.0 GA1 allows XSS via a journal article title to journal_article/page.jsp in journal/journal-taglib."}, {"lang": "es", "value": "Liferay Portal versiones hasta 7.2.0 GA1, permite un ataque de tipo XSS por medio de un t\u00edtulo de art\u00edculo de revista en el archivo journal_article/page.jsp en journal/journal-taglib."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:*:*:*:*:*:*:*:*", "versionEndExcluding": "7.2.0", "matchCriteriaId": "73595C28-A21B-4C48-A326-33B0159B37A1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:alpha1:*:*:*:*:*:*", "matchCriteriaId": "88F1EED2-D198-4C40-9807-731796074FCF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:beta1:*:*:*:*:*:*", "matchCriteriaId": "EB4A5FD6-845A-4C41-B98E-C74468DA438F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:beta2:*:*:*:*:*:*", "matchCriteriaId": "86834E33-4C24-4AD0-9C9E-E3C49C0B7578"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:beta3:*:*:*:*:*:*", "matchCriteriaId": "07B30D08-AB09-401D-8409-A6EFF0E1B494"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:ga1:*:*:*:*:*:*", "matchCriteriaId": "EA3A09FF-63B3-4EFA-A905-F46F767F7E56"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:milestone2:*:*:*:*:*:*", "matchCriteriaId": "FA711ED3-549B-45A3-9368-BE0B4AB7747D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:rc2:*:*:*:*:*:*", "matchCriteriaId": "A93620D5-5283-4A89-B90D-F956BC6FD574"}, {"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:7.2.0:rc3:*:*:*:*:*:*", "matchCriteriaId": "F32A70F1-BDFC-4B2C-9963-4CF5B263FFC5"}]}]}], "references": [{"url": "https://github.com/liferay/liferay-portal/commit/7e063aed70f947a92bb43a4471e0c4e650fe8f7f", "source": "cve@mitre.org", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/liferay/liferay-portal/commit/7e063aed70f947a92bb43a4471e0c4e650fe8f7f"}}