{"buggy_code": ["/*\r\n * Constant.cs\r\n * \r\n * Copyright \u00a9 2007 Michael Schwarz (http://www.ajaxpro.info).\r\n * All Rights Reserved.\r\n * \r\n * Permission is hereby granted, free of charge, to any person \r\n * obtaining a copy of this software and associated documentation \r\n * files (the \"Software\"), to deal in the Software without \r\n * restriction, including without limitation the rights to use, \r\n * copy, modify, merge, publish, distribute, sublicense, and/or \r\n * sell copies of the Software, and to permit persons to whom the \r\n * Software is furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be \r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, \r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES \r\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR \r\n * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF \r\n * CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN \r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/*\r\n * MS\t06-03-10\tchanged assembly version to correct version from assembly info\r\n * MS\t06-04-04\tfixed if external version is using different assembly name\r\n * \r\n * \r\n */\r\nusing System;\r\n\r\nnamespace AjaxPro\r\n{\r\n\tpublic sealed class Constant\r\n\t{\r\n\t\t/// <summary>\r\n\t\t/// The AjaxID used to save objects using a unnique key in IDictionary objects.\r\n\t\t/// </summary>\r\n\t\tpublic const string AjaxID = \"AjaxPro\";\r\n\r\n\t\t/// <summary>\r\n\t\t/// The assembly name to get embedded resources\r\n\t\t/// </summary>\r\n#if(NET20external)\r\n\t\tinternal const string AssemblyName = \"AjaxPro.2\";\r\n#else\r\n\t\tinternal const string AssemblyName = \"AjaxPro\";\r\n#endif\r\n\r\n        /// <summary>\r\n\t\t/// The assembly version.\r\n\t\t/// </summary>\r\n        public const string AssemblyVersion = \"21.12.21.2\";\r\n\t}\r\n}\r\n", "Object.extend(Function.prototype, {\r\n\tgetArguments: function () {\r\n\t\tvar args = [];\r\n\t\tfor (var i = 0; i < this.arguments.length; i++) {\r\n\t\t\targs.push(this.arguments[i]);\r\n\t\t}\r\n\t\treturn args;\r\n\t}\r\n}, false);\r\n\r\nvar MS = { \"Browser\": {} };\r\n\r\nObject.extend(MS.Browser, {\r\n\tisIE: navigator.userAgent.indexOf('MSIE') != -1,\r\n\tisFirefox: navigator.userAgent.indexOf('Firefox') != -1,\r\n\tisOpera: window.opera != null\r\n}, false);\r\n\r\nvar AjaxPro = {};\r\n\r\nAjaxPro.IFrameXmlHttp = function () { };\r\nAjaxPro.IFrameXmlHttp.prototype = {\r\n\tonreadystatechange: null, headers: [], method: \"POST\", url: null, async: true, iframe: null,\r\n\tstatus: 0, readyState: 0, responseText: null,\r\n\tabort: function () {\r\n\t},\r\n\treadystatechanged: function () {\r\n\t\tvar doc = this.iframe.contentDocument || this.iframe.document;\r\n\t\tif (doc != null && doc.readyState == \"complete\" && doc.body != null && doc.body.res != null) {\r\n\t\t\tthis.status = 200;\r\n\t\t\tthis.statusText = \"OK\";\r\n\t\t\tthis.readyState = 4;\r\n\t\t\tthis.responseText = doc.body.res;\r\n\t\t\tthis.onreadystatechange();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetTimeout(this.readystatechanged.bind(this), 10);\r\n\t},\r\n\topen: function (method, url, async) {\r\n\t\tif (async == false) {\r\n\t\t\talert(\"Synchronous call using IFrameXMLHttp is not supported.\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.iframe == null) {\r\n\t\t\tvar iframeID = \"hans\";\r\n\t\t\tif (document.createElement && document.documentElement &&\r\n\t\t\t\t(window.opera || navigator.userAgent.indexOf('MSIE 5.0') == -1)) {\r\n\t\t\t\tvar ifr = document.createElement('iframe');\r\n\t\t\t\tifr.setAttribute('id', iframeID);\r\n\t\t\t\tifr.style.visibility = 'hidden';\r\n\t\t\t\tifr.style.position = 'absolute';\r\n\t\t\t\tifr.style.width = ifr.style.height = ifr.borderWidth = '0px';\r\n\r\n\t\t\t\tthis.iframe = document.getElementsByTagName('body')[0].appendChild(ifr);\r\n\t\t\t}\r\n\t\t\telse if (document.body && document.body.insertAdjacentHTML) {\r\n\t\t\t\tdocument.body.insertAdjacentHTML('beforeEnd', '<iframe name=\"' + iframeID + '\" id=\"' + iframeID + '\" style=\"border:1px solid black;display:none\"></iframe>');\r\n\t\t\t}\r\n\t\t\tif (window.frames && window.frames[iframeID]) {\r\n\t\t\t\tthis.iframe = window.frames[iframeID];\r\n\t\t\t}\r\n\t\t\tthis.iframe.name = iframeID;\r\n\t\t\tthis.iframe.document.open();\r\n\t\t\tthis.iframe.document.write(\"<\" + \"html><\" + \"body></\" + \"body></\" + \"html>\");\r\n\t\t\tthis.iframe.document.close();\r\n\t\t}\r\n\t\tthis.method = method;\r\n\t\tthis.url = url;\r\n\t\tthis.async = async;\r\n\t},\r\n\tsetRequestHeader: function (name, value) {\r\n\t\tfor (var i = 0; i < this.headers.length; i++) {\r\n\t\t\tif (this.headers[i].name == name) {\r\n\t\t\t\tthis.headers[i].value = value;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.headers.push({ \"name\": name, \"value\": value });\r\n\t},\r\n\tgetResponseHeader: function (name, value) {\r\n\t\treturn null;\r\n\t},\r\n\taddInput: function (doc, form, name, value) {\r\n\t\tvar ele;\r\n\t\tvar tag = \"input\";\r\n\t\tif (value.indexOf(\"\\n\") >= 0) {\r\n\t\t\ttag = \"textarea\";\r\n\t\t}\r\n\r\n\t\tif (doc.all) {\r\n\t\t\tele = doc.createElement(\"<\" + tag + \" name=\\\"\" + name + \"\\\" />\");\r\n\t\t} else {\r\n\t\t\tele = doc.createElement(tag);\r\n\t\t\tele.setAttribute(\"name\", name);\r\n\t\t}\r\n\t\tele.setAttribute(\"value\", value);\r\n\t\tform.appendChild(ele);\r\n\t\tele = null;\r\n\t},\r\n\tsend: function (data) {\r\n\t\tif (this.iframe == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar doc = this.iframe.contentDocument || this.iframe.document;\r\n\t\tvar form = doc.createElement(\"form\");\r\n\r\n\t\tdoc.body.appendChild(form);\r\n\r\n\t\tform.setAttribute(\"action\", this.url);\r\n\t\tform.setAttribute(\"method\", this.method);\r\n\t\tform.setAttribute(\"enctype\", \"application/x-www-form-urlencoded\");\r\n\r\n\t\tfor (var i = 0; i < this.headers.length; i++) {\r\n\t\t\tswitch (this.headers[i].name.toLowerCase()) {\r\n\t\t\t\tcase \"content-length\":\r\n\t\t\t\tcase \"accept-encoding\":\r\n\t\t\t\tcase \"content-type\":\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.addInput(doc, form, this.headers[i].name, this.headers[i].value);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.addInput(doc, form, \"data\", data);\r\n\t\tform.submit();\r\n\r\n\t\tsetTimeout(this.readystatechanged.bind(this), 0);\r\n\t}\r\n};\r\n\r\nvar progids = [\"Msxml2.XMLHTTP.6.0\", \"Msxml2.XMLHTTP.3.0\", \"MSXML2.XMLHTTP\", \"Microsoft.XMLHTTP\"];\r\nvar progid = null;\r\n\r\nif (typeof ActiveXObject != \"undefined\") {\r\n\tvar ie7xmlhttp = false;\r\n\tif (typeof XMLHttpRequest == \"object\") {\r\n\t\ttry { var o = new XMLHttpRequest(); ie7xmlhttp = true; } catch (e) { }\r\n\t}\r\n\tif (typeof XMLHttpRequest == \"undefined\" || !ie7xmlhttp) {\r\n\t\tXMLHttpRequest = function () {\r\n\t\t\tvar xmlHttp = null;\r\n\t\t\tif (!AjaxPro.noActiveX) {\r\n\t\t\t\tif (progid != null) {\r\n\t\t\t\t\treturn new ActiveXObject(progid);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0; i < progids.length && xmlHttp == null; i++) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\txmlHttp = new ActiveXObject(progids[i]);\r\n\t\t\t\t\t\tprogid = progids[i];\r\n\r\n\t\t\t\t\t} catch (e) { }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (xmlHttp == null && MS.Browser.isIE) {\r\n\t\t\t\treturn new AjaxPro.IFrameXmlHttp();\r\n\t\t\t}\r\n\t\t\treturn xmlHttp;\r\n\t\t};\r\n\t}\r\n}\r\n\r\nObject.extend(AjaxPro, {\r\n\tnoOperation: function () { },\r\n\tonLoading: function () { },\r\n\tonError: function () { },\r\n\tonTimeout: function () { return true; },\r\n\tonStateChanged: function () { },\r\n\tcryptProvider: null,\r\n\tqueue: null,\r\n\ttoken: \"\",\r\n\tversion: \"{AssemblyVersion}\",\r\n\tID: \"AjaxPro\",\r\n\tnoActiveX: false,\r\n\ttimeoutPeriod: 15 * 1000,\r\n\tqueue: null,\r\n\tnoUtcTime: false,\r\n\tregExDate: function (str, p1, p2, offset, s) {\r\n\t\tvar date = str.substring(1).replace('\"', '');\r\n\t\tif (date.substring(0, 7) == \"\\\\\\/Date(\") {\r\n\t\t\tvar d = date.match(/Date\\((.*?)\\)/)[1];\r\n\t\t\treturn \"new Date(\" + parseInt(d) + \")\";\r\n\t\t}\r\n\t\telse { // ISO Date 2007-12-31T23:59:59Z                                     \r\n\t\t\tvar matches = date.split(/[-,:,T,Z]/);\r\n\t\t\tif (matches.length == 7) {\r\n\t\t\t\tmatches[1] = (parseInt(matches[1], 0) - 1).toString();\r\n\t\t\t\tvar isDate = true;\r\n\t\t\t\tvar s = \"\";\r\n\t\t\t\tfor (var i = 0; i < matches.length; i++) {\r\n\t\t\t\t\tif (isNaN(parseInt(matches[i], 10))) {\r\n\t\t\t\t\t\tisDate = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (i > 0) {\r\n\t\t\t\t\t\ts += \",\";\r\n                    }\r\n\t\t\t\t\ts += parseInt(matches[i], 10);\r\n\t\t\t\t}\r\n\t\t\t\tif (isDate) {\r\n\t\t\t\t\treturn \"new Date(Date.UTC(\" + s + \"))\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn str;\r\n\t},\r\n\tparse: function (text) {\r\n\t\t// not yet possible as we still return new type() JSON\r\n\t\t//\t\tif (!(!(/[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]/.test(\r\n\t\t//\t\ttext.replace(/\"(\\\\.|[^\"\\\\])*\"/g, '')))  ))\r\n\t\t//\t\t\tthrow new Error(\"Invalid characters in JSON parse string.\");                 \r\n\t\tvar regEx = /(\\\"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}.*?\\\")|(\\\"\\\\\\/Date\\(.*?\\)\\\\\\/\")/g;\r\n\t\ttext = text.replace(regEx, this.regExDate);\r\n\t\treturn eval('(' + text + ')');\r\n\t},\r\n\tm: {\r\n\t\t'\\b': '\\\\b',\r\n\t\t'\\t': '\\\\t',\r\n\t\t'\\n': '\\\\n',\r\n\t\t'\\f': '\\\\f',\r\n\t\t'\\r': '\\\\r',\r\n\t\t'\"': '\\\\\"',\r\n\t\t'\\\\': '\\\\\\\\'\r\n\t},\r\n\ttoJSON: function (o) {\r\n\t\tif (o == null) {\r\n\t\t\treturn \"null\";\r\n\t\t}\r\n\t\tvar v = [];\r\n\t\tvar i;\r\n\t\tvar c = o.constructor;\r\n\t\tif (c == Number) {\r\n\t\t\treturn isFinite(o) ? o.toString() : AjaxPro.toJSON(null);\r\n\t\t} else if (c == Boolean) {\r\n\t\t\treturn o.toString();\r\n\t\t} else if (c == String) {\r\n\t\t\tif (/[\"\\\\\\x00-\\x1f]/.test(o)) {\r\n\t\t\t\to = o.replace(/([\\x00-\\x1f\\\\\"])/g, function (a, b) {\r\n\t\t\t\t\tvar c = AjaxPro.m[b];\r\n\t\t\t\t\tif (c) {\r\n\t\t\t\t\t\treturn c;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tc = b.charCodeAt();\r\n\t\t\t\t\treturn '\\\\u00' +\r\n\t\t\t\t\t\tMath.floor(c / 16).toString(16) +\r\n\t\t\t\t\t\t(c % 16).toString(16);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn '\"' + o + '\"';\r\n\t\t} else if (c == Array) {\r\n\t\t\tfor (i = 0; i < o.length; i++) {\r\n\t\t\t\tv.push(AjaxPro.toJSON(o[i]));\r\n\t\t\t}\r\n\t\t\treturn \"[\" + v.join(\",\") + \"]\";\r\n\t\t} else if (c == Date) {\r\n\t\t\treturn AjaxPro.toJSON(\"/Date(\" + new Date(Date.UTC(o.getUTCFullYear(), o.getUTCMonth(), o.getUTCDate(), o.getUTCHours(), o.getUTCMinutes(), o.getUTCSeconds(), o.getUTCMilliseconds())).getTime() + \")/\");\r\n\t\t}\r\n\t\tif (typeof o.toJSON == \"function\") {\r\n\t\t\treturn o.toJSON();\r\n\t\t}\r\n\t\tif (typeof o == \"object\") {\r\n\t\t\tfor (var attr in o) {\r\n\t\t\t\tif (typeof o[attr] != \"function\") {\r\n\t\t\t\t\tv.push('\"' + attr + '\":' + AjaxPro.toJSON(o[attr]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (v.length > 0) {\r\n\t\t\t\treturn \"{\" + v.join(\",\") + \"}\";\r\n\t\t\t}\r\n\t\t\treturn \"{}\";\r\n\t\t}\r\n\t\treturn o.toString();\r\n\t},\r\n\tdispose: function () {\r\n\t\tif (AjaxPro.queue != null) {\r\n\t\t\tAjaxPro.queue.dispose();\r\n\t\t}\r\n\t}\r\n}, false);\r\n\r\naddEvent(window, \"unload\", AjaxPro.dispose);\r\n\r\nAjaxPro.Request = function (url) {\r\n\tthis.url = url;\r\n\tthis.xmlHttp = null;\r\n};\r\n\r\nAjaxPro.Request.prototype = {\r\n\turl: null,\r\n\tcallback: null,\r\n\tonLoading: null,\r\n\tonError: null,\r\n\tonTimeout: null,\r\n\tonStateChanged: null,\r\n\targs: null,\r\n\tcontext: null,\r\n\tisRunning: false,\r\n\tabort: function () {\r\n\t\tif (this.timeoutTimer != null) {\r\n\t\t\tclearTimeout(this.timeoutTimer);\r\n\t\t}\r\n\t\tif (this.xmlHttp) {\r\n\t\t\tthis.xmlHttp.onreadystatechange = AjaxPro.noOperation;\r\n\t\t\tthis.xmlHttp.abort();\r\n\t\t}\r\n\t\tif (this.isRunning) {\r\n\t\t\tthis.isRunning = false;\r\n\t\t\tthis.onLoading(false);\r\n\t\t}\r\n\t},\r\n\tdispose: function () {\r\n\t\tthis.abort();\r\n\t},\r\n\tgetEmptyRes: function () {\r\n\t\treturn {\r\n\t\t\terror: null,\r\n\t\t\tvalue: null,\r\n\t\t\trequest: { method: this.method, args: this.args },\r\n\t\t\tcontext: this.context,\r\n\t\t\tduration: this.duration\r\n\t\t};\r\n\t},\r\n\tendRequest: function (res) {\r\n\t\tthis.abort();\r\n\t\tif (res.error != null) {\r\n\t\t\tthis.onError(res.error, this);\r\n\t\t}\r\n\r\n\t\tif (typeof this.callback == \"function\") {\r\n\t\t\tthis.callback(res, this);\r\n\t\t}\r\n\t},\r\n\tmozerror: function () {\r\n\t\tif (this.timeoutTimer != null) {\r\n\t\t\tclearTimeout(this.timeoutTimer);\r\n\t\t}\r\n\t\tvar res = this.getEmptyRes();\r\n\t\tres.error = { Message: \"Unknown\", Type: \"ConnectFailure\", Status: 0 };\r\n\t\tthis.endRequest(res);\r\n\t},\r\n\tdoStateChange: function () {\r\n\t\tthis.onStateChanged(this.xmlHttp.readyState, this);\r\n\t\tif (this.xmlHttp.readyState != 4 || !this.isRunning) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.duration = new Date().getTime() - this.__start;\r\n\t\tif (this.timeoutTimer != null) {\r\n\t\t\tclearTimeout(this.timeoutTimer);\r\n\t\t}\r\n\t\tvar res = this.getEmptyRes();\r\n\t\t//Ignore empty statustext to be http2 compatible\r\n\t\tif (this.xmlHttp.status == 200 && this.xmlHttp.statusText == \"OK\" || !this.xmlHttp.statusText) {\r\n\t\t\tres = this.createResponse(res);\r\n\t\t} else {\r\n\t\t\tres = this.createResponse(res, true);\r\n\t\t\tres.error = { Message: this.xmlHttp.statusText, Type: \"ConnectFailure\", Status: this.xmlHttp.status };\r\n\t\t}\r\n\r\n\t\tthis.endRequest(res);\r\n\t},\r\n\tcreateResponse: function (r, noContent) {\r\n\t\tif (!noContent) {\r\n\t\t\tif (typeof (this.xmlHttp.responseText) == \"unknown\") {\r\n\t\t\t\tr.error = { Message: \"XmlHttpRequest error reading property responseText.\", Type: \"XmlHttpRequestException\" };\r\n\t\t\t\treturn r;\r\n\t\t\t}\r\n\r\n\t\t\tvar responseText = \"\" + this.xmlHttp.responseText;\r\n\r\n\t\t\tif (AjaxPro.cryptProvider != null && typeof AjaxPro.cryptProvider.decrypt == \"function\") {\r\n\t\t\t\tresponseText = AjaxPro.cryptProvider.decrypt(responseText);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.xmlHttp.getResponseHeader(\"Content-Type\") == \"text/xml\") {\r\n\t\t\t\tr.value = this.xmlHttp.responseXML;\r\n\t\t\t} else {\r\n\t\t\t\tif (responseText != null && responseText.trim().length > 0) {\r\n\t\t\t\t\tr.json = responseText;\r\n\t\t\t\t\tvar v = null;\r\n\t\t\t\t\tv = AjaxPro.parse(responseText);\r\n\t\t\t\t\tif (v != null) {\r\n\t\t\t\t\t\tif (typeof v.value != \"undefined\") r.value = v.value;\r\n\t\t\t\t\t\telse if (typeof v.error != \"undefined\") r.error = v.error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* if(this.xmlHttp.getResponseHeader(\"X-\" + AjaxPro.ID + \"-Cache\") == \"server\") {\r\n\t\t\tr.isCached = true;\r\n\t\t} */\r\n\t\treturn r;\r\n\t},\r\n\ttimeout: function () {\r\n\t\tthis.duration = new Date().getTime() - this.__start;\r\n\t\tvar r = this.onTimeout(this.duration, this);\r\n\t\tif (typeof r == \"undefined\" || r != false) {\r\n\t\t\tthis.abort();\r\n\t\t} else {\r\n\t\t\tthis.timeoutTimer = setTimeout(this.timeout.bind(this), AjaxPro.timeoutPeriod);\r\n\t\t}\r\n\t},\r\n\tinvoke: function (method, args, callback, context) {\r\n\t\tthis.__start = new Date().getTime();\r\n\r\n\t\t// if(this.xmlHttp == null) {\r\n\t\tthis.xmlHttp = new XMLHttpRequest();\r\n\t\t// }\r\n\r\n\t\tthis.isRunning = true;\r\n\t\tthis.method = method;\r\n\t\tthis.args = args;\r\n\t\tthis.callback = callback;\r\n\t\tthis.context = context;\r\n\r\n\t\tvar async = typeof (callback) == \"function\" && callback != AjaxPro.noOperation;\r\n\r\n\t\tif (async) {\r\n\t\t\tif (MS.Browser.isIE) {\r\n\t\t\t\tthis.xmlHttp.onreadystatechange = this.doStateChange.bind(this);\r\n\t\t\t} else {\r\n\t\t\t\tthis.xmlHttp.onload = this.doStateChange.bind(this);\r\n\t\t\t\tthis.xmlHttp.onerror = this.mozerror.bind(this);\r\n\t\t\t}\r\n\t\t\tthis.onLoading(true);\r\n\t\t}\r\n\r\n\t\tvar json = AjaxPro.toJSON(args) + \"\";\r\n\t\tif (AjaxPro.cryptProvider != null && typeof AjaxPro.cryptProvider.encrypt == \"function\") {\r\n\t\t\tjson = AjaxPro.cryptProvider.encrypt(json);\r\n\t\t}\r\n\r\n\t\tthis.xmlHttp.open(\"POST\", this.url, async);\r\n\t\tthis.xmlHttp.setRequestHeader(\"Content-Type\", \"text/plain; charset=utf-8\");\r\n\t\tthis.xmlHttp.setRequestHeader(\"X-\" + AjaxPro.ID + \"-Method\", method);\r\n\r\n\t\tif (AjaxPro.token != null && AjaxPro.token.length > 0) {\r\n\t\t\tthis.xmlHttp.setRequestHeader(\"X-\" + AjaxPro.ID + \"-Token\", AjaxPro.token);\r\n\t\t}\r\n\r\n\t\t/* if(!MS.Browser.isIE) {\r\n\t\t\tthis.xmlHttp.setRequestHeader(\"Connection\", \"close\");\r\n\t\t} */\r\n\r\n\t\tthis.timeoutTimer = setTimeout(this.timeout.bind(this), AjaxPro.timeoutPeriod);\r\n\r\n\t\ttry { this.xmlHttp.send(json); } catch (e) { }\t// IE offline exception\r\n\r\n\t\tif (!async) {\r\n\t\t\treturn this.createResponse({ error: null, value: null });\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n};\r\n\r\nAjaxPro.RequestQueue = function (conc) {\r\n\tthis.queue = [];\r\n\tthis.requests = [];\r\n\tthis.timer = null;\r\n\r\n\tif (isNaN(conc)) { conc = 2; }\r\n\r\n\tfor (var i = 0; i < conc; i++) {\t\t// max 2 http connections\r\n\t\tthis.requests[i] = new AjaxPro.Request();\r\n\t\tthis.requests[i].callback = function (res) {\r\n\t\t\tvar r = res.context;\r\n\t\t\tres.context = r[3][1];\r\n\r\n\t\t\tr[3][0](res, this);\r\n\t\t};\r\n\t\tthis.requests[i].callbackHandle = this.requests[i].callback.bind(this.requests[i]);\r\n\t}\r\n\r\n\tthis.processHandle = this.process.bind(this);\r\n};\r\n\r\nAjaxPro.RequestQueue.prototype = {\r\n\tprocess: function () {\r\n\t\tthis.timer = null;\r\n\t\tif (this.queue.length == 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (var i = 0; i < this.requests.length && this.queue.length > 0; i++) {\r\n\t\t\tif (this.requests[i].isRunning == false) {\r\n\t\t\t\tvar r = this.queue.shift();\r\n\r\n\t\t\t\tthis.requests[i].url = r[0];\r\n\t\t\t\tthis.requests[i].onLoading = r[3].length > 2 && r[3][2] != null && typeof r[3][2] == \"function\" ? r[3][2] : AjaxPro.onLoading;\r\n\t\t\t\tthis.requests[i].onError = r[3].length > 3 && r[3][3] != null && typeof r[3][3] == \"function\" ? r[3][3] : AjaxPro.onError;\r\n\t\t\t\tthis.requests[i].onTimeout = r[3].length > 4 && r[3][4] != null && typeof r[3][4] == \"function\" ? r[3][4] : AjaxPro.onTimeout;\r\n\t\t\t\tthis.requests[i].onStateChanged = r[3].length > 5 && r[3][5] != null && typeof r[3][5] == \"function\" ? r[3][5] : AjaxPro.onStateChanged;\r\n\r\n\t\t\t\tthis.requests[i].invoke(r[1], r[2], this.requests[i].callbackHandle, r);\r\n\t\t\t\tr = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.queue.length > 0 && this.timer == null) {\r\n\t\t\tthis.timer = setTimeout(this.processHandle, 0);\r\n\t\t}\r\n\t},\r\n\tadd: function (url, method, args, e) {\r\n\t\tthis.queue.push([url, method, args, e]);\r\n\t\tif (this.timer == null) {\r\n\t\t\tthis.timer = setTimeout(this.processHandle, 0);\r\n\t\t}\r\n\t\t// this.process();\r\n\t},\r\n\tabort: function () {\r\n\t\tthis.queue.length = 0;\r\n\t\tif (this.timer != null) {\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t}\r\n\t\tthis.timer = null;\r\n\t\tfor (var i = 0; i < this.requests.length; i++) {\r\n\t\t\tif (this.requests[i].isRunning == true) {\r\n\t\t\t\tthis.requests[i].abort();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdispose: function () {\r\n\t\tfor (var i = 0; i < this.requests.length; i++) {\r\n\t\t\tvar r = this.requests[i];\r\n\t\t\tr.dispose();\r\n\t\t}\r\n\t\tthis.requests.clear();\r\n\t}\r\n};\r\n\r\nAjaxPro.queue = new AjaxPro.RequestQueue(2);\t// 2 http connections\r\n\r\nAjaxPro.AjaxClass = function (url) {\r\n\tthis.url = url;\r\n};\r\n\r\nAjaxPro.AjaxClass.prototype = {\r\n\tinvoke: function (method, args, e) {\r\n\r\n\t\tif (e != null) {\r\n\t\t\tif (e.length != 6) {\r\n\t\t\t\tfor (; e.length < 6;) { e.push(null); }\r\n\t\t\t}\r\n\t\t\tif (e[0] != null && typeof (e[0]) == \"function\") {\r\n\t\t\t\treturn AjaxPro.queue.add(this.url, method, args, e);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar r = new AjaxPro.Request();\r\n\t\tr.url = this.url;\r\n\t\treturn r.invoke(method, args);\r\n\t}\r\n};\r\n"], "fixing_code": ["/*\r\n * Constant.cs\r\n * \r\n * Copyright \u00a9 2007 Michael Schwarz (http://www.ajaxpro.info).\r\n * All Rights Reserved.\r\n * \r\n * Permission is hereby granted, free of charge, to any person \r\n * obtaining a copy of this software and associated documentation \r\n * files (the \"Software\"), to deal in the Software without \r\n * restriction, including without limitation the rights to use, \r\n * copy, modify, merge, publish, distribute, sublicense, and/or \r\n * sell copies of the Software, and to permit persons to whom the \r\n * Software is furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be \r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, \r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES \r\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR \r\n * ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF \r\n * CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN \r\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/*\r\n * MS\t06-03-10\tchanged assembly version to correct version from assembly info\r\n * MS\t06-04-04\tfixed if external version is using different assembly name\r\n * \r\n * \r\n */\r\nusing System;\r\n\r\nnamespace AjaxPro\r\n{\r\n\tpublic sealed class Constant\r\n\t{\r\n\t\t/// <summary>\r\n\t\t/// The AjaxID used to save objects using a unnique key in IDictionary objects.\r\n\t\t/// </summary>\r\n\t\tpublic const string AjaxID = \"AjaxPro\";\r\n\r\n\t\t/// <summary>\r\n\t\t/// The assembly name to get embedded resources\r\n\t\t/// </summary>\r\n#if(NET20external)\r\n\t\tinternal const string AssemblyName = \"AjaxPro.2\";\r\n#else\r\n\t\tinternal const string AssemblyName = \"AjaxPro\";\r\n#endif\r\n\r\n        /// <summary>\r\n\t\t/// The assembly version.\r\n\t\t/// </summary>\r\n        public const string AssemblyVersion = \"21.12.22.1\";\r\n\t}\r\n}\r\n", "Object.extend(Function.prototype, {\r\n\tgetArguments: function () {\r\n\t\tvar args = [];\r\n\t\tfor (var i = 0; i < this.arguments.length; i++) {\r\n\t\t\targs.push(this.arguments[i]);\r\n\t\t}\r\n\t\treturn args;\r\n\t}\r\n}, false);\r\n\r\nvar MS = { \"Browser\": {} };\r\n\r\nObject.extend(MS.Browser, {\r\n\tisIE: navigator.userAgent.indexOf('MSIE') != -1,\r\n\tisFirefox: navigator.userAgent.indexOf('Firefox') != -1,\r\n\tisOpera: window.opera != null\r\n}, false);\r\n\r\nvar AjaxPro = {};\r\n\r\nAjaxPro.IFrameXmlHttp = function () { };\r\nAjaxPro.IFrameXmlHttp.prototype = {\r\n\tonreadystatechange: null, headers: [], method: \"POST\", url: null, async: true, iframe: null,\r\n\tstatus: 0, readyState: 0, responseText: null,\r\n\tabort: function () {\r\n\t},\r\n\treadystatechanged: function () {\r\n\t\tvar doc = this.iframe.contentDocument || this.iframe.document;\r\n\t\tif (doc != null && doc.readyState == \"complete\" && doc.body != null && doc.body.res != null) {\r\n\t\t\tthis.status = 200;\r\n\t\t\tthis.statusText = \"OK\";\r\n\t\t\tthis.readyState = 4;\r\n\t\t\tthis.responseText = doc.body.res;\r\n\t\t\tthis.onreadystatechange();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsetTimeout(this.readystatechanged.bind(this), 10);\r\n\t},\r\n\topen: function (method, url, async) {\r\n\t\tif (async == false) {\r\n\t\t\talert(\"Synchronous call using IFrameXMLHttp is not supported.\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.iframe == null) {\r\n\t\t\tvar iframeID = \"hans\";\r\n\t\t\tif (document.createElement && document.documentElement &&\r\n\t\t\t\t(window.opera || navigator.userAgent.indexOf('MSIE 5.0') == -1)) {\r\n\t\t\t\tvar ifr = document.createElement('iframe');\r\n\t\t\t\tifr.setAttribute('id', iframeID);\r\n\t\t\t\tifr.style.visibility = 'hidden';\r\n\t\t\t\tifr.style.position = 'absolute';\r\n\t\t\t\tifr.style.width = ifr.style.height = ifr.borderWidth = '0px';\r\n\r\n\t\t\t\tthis.iframe = document.getElementsByTagName('body')[0].appendChild(ifr);\r\n\t\t\t}\r\n\t\t\telse if (document.body && document.body.insertAdjacentHTML) {\r\n\t\t\t\tdocument.body.insertAdjacentHTML('beforeEnd', '<iframe name=\"' + iframeID + '\" id=\"' + iframeID + '\" style=\"border:1px solid black;display:none\"></iframe>');\r\n\t\t\t}\r\n\t\t\tif (window.frames && window.frames[iframeID]) {\r\n\t\t\t\tthis.iframe = window.frames[iframeID];\r\n\t\t\t}\r\n\t\t\tthis.iframe.name = iframeID;\r\n\t\t\tthis.iframe.document.open();\r\n\t\t\tthis.iframe.document.write(\"<\" + \"html><\" + \"body></\" + \"body></\" + \"html>\");\r\n\t\t\tthis.iframe.document.close();\r\n\t\t}\r\n\t\tthis.method = method;\r\n\t\tthis.url = url;\r\n\t\tthis.async = async;\r\n\t},\r\n\tsetRequestHeader: function (name, value) {\r\n\t\tfor (var i = 0; i < this.headers.length; i++) {\r\n\t\t\tif (this.headers[i].name == name) {\r\n\t\t\t\tthis.headers[i].value = value;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.headers.push({ \"name\": name, \"value\": value });\r\n\t},\r\n\tgetResponseHeader: function (name, value) {\r\n\t\treturn null;\r\n\t},\r\n\taddInput: function (doc, form, name, value) {\r\n\t\tvar ele;\r\n\t\tvar tag = \"input\";\r\n\t\tif (value.indexOf(\"\\n\") >= 0) {\r\n\t\t\ttag = \"textarea\";\r\n\t\t}\r\n\r\n\t\tif (doc.all) {\r\n\t\t\tele = doc.createElement(\"<\" + tag + \" name=\\\"\" + name + \"\\\" />\");\r\n\t\t} else {\r\n\t\t\tele = doc.createElement(tag);\r\n\t\t\tele.setAttribute(\"name\", name);\r\n\t\t}\r\n\t\tele.setAttribute(\"value\", value);\r\n\t\tform.appendChild(ele);\r\n\t\tele = null;\r\n\t},\r\n\tsend: function (data) {\r\n\t\tif (this.iframe == null) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar doc = this.iframe.contentDocument || this.iframe.document;\r\n\t\tvar form = doc.createElement(\"form\");\r\n\r\n\t\tdoc.body.appendChild(form);\r\n\r\n\t\tform.setAttribute(\"action\", this.url);\r\n\t\tform.setAttribute(\"method\", this.method);\r\n\t\tform.setAttribute(\"enctype\", \"application/x-www-form-urlencoded\");\r\n\r\n\t\tfor (var i = 0; i < this.headers.length; i++) {\r\n\t\t\tswitch (this.headers[i].name.toLowerCase()) {\r\n\t\t\t\tcase \"content-length\":\r\n\t\t\t\tcase \"accept-encoding\":\r\n\t\t\t\tcase \"content-type\":\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.addInput(doc, form, this.headers[i].name, this.headers[i].value);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.addInput(doc, form, \"data\", data);\r\n\t\tform.submit();\r\n\r\n\t\tsetTimeout(this.readystatechanged.bind(this), 0);\r\n\t}\r\n};\r\n\r\nvar progids = [\"Msxml2.XMLHTTP.6.0\", \"Msxml2.XMLHTTP.3.0\", \"MSXML2.XMLHTTP\", \"Microsoft.XMLHTTP\"];\r\nvar progid = null;\r\n\r\nif (typeof ActiveXObject != \"undefined\") {\r\n\tvar ie7xmlhttp = false;\r\n\tif (typeof XMLHttpRequest == \"object\") {\r\n\t\ttry { var o = new XMLHttpRequest(); ie7xmlhttp = true; } catch (e) { }\r\n\t}\r\n\tif (typeof XMLHttpRequest == \"undefined\" || !ie7xmlhttp) {\r\n\t\tXMLHttpRequest = function () {\r\n\t\t\tvar xmlHttp = null;\r\n\t\t\tif (!AjaxPro.noActiveX) {\r\n\t\t\t\tif (progid != null) {\r\n\t\t\t\t\treturn new ActiveXObject(progid);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i = 0; i < progids.length && xmlHttp == null; i++) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\txmlHttp = new ActiveXObject(progids[i]);\r\n\t\t\t\t\t\tprogid = progids[i];\r\n\r\n\t\t\t\t\t} catch (e) { }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (xmlHttp == null && MS.Browser.isIE) {\r\n\t\t\t\treturn new AjaxPro.IFrameXmlHttp();\r\n\t\t\t}\r\n\t\t\treturn xmlHttp;\r\n\t\t};\r\n\t}\r\n}\r\n\r\nObject.extend(AjaxPro, {\r\n\tnoOperation: function () { },\r\n\tonLoading: function () { },\r\n\tonError: function () { },\r\n\tonTimeout: function () { return true; },\r\n\tonStateChanged: function () { },\r\n\tcryptProvider: null,\r\n\tqueue: null,\r\n\ttoken: \"\",\r\n\tversion: \"{AssemblyVersion}\",\r\n\tID: \"AjaxPro\",\r\n\tnoActiveX: false,\r\n\ttimeoutPeriod: 15 * 1000,\r\n\tqueue: null,\r\n\tnoUtcTime: false,\r\n\tregExDate: function (str, p1, p2, offset, s) {\r\n\t\tvar date = str.substring(1).replace('\"', '');\r\n\t\tif (date.substring(0, 7) == \"\\\\\\/Date(\") {\r\n\t\t\tvar d = date.match(/Date\\((.*?)\\)/)[1];\r\n\t\t\treturn \"new Date(\" + parseInt(d) + \")\";\r\n\t\t}\r\n\t\t/*else { // ISO Date 2007-12-31T23:59:59Z\r\n\t\t\tvar matches = date.split(/[-,:,T,Z]/);\r\n\t\t\tif (matches.length == 7) {\r\n\t\t\t\tmatches[1] = (parseInt(matches[1], 0) - 1).toString();\r\n\t\t\t\tvar isDate = true;\r\n\t\t\t\tvar s = \"\";\r\n\t\t\t\tfor (var i = 0; i < matches.length; i++) {\r\n\t\t\t\t\tif (isNaN(parseInt(matches[i], 10))) {\r\n\t\t\t\t\t\tisDate = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (i > 0) {\r\n\t\t\t\t\t\ts += \",\";\r\n                    }\r\n\t\t\t\t\ts += parseInt(matches[i], 10);\r\n\t\t\t\t\tconsole.log(s);\r\n\t\t\t\t}\r\n\t\t\t\tif (isDate) {\r\n\t\t\t\t\treturn \"new Date(Date.UTC(\" + s + \"))\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}*/\r\n\t\treturn str;\r\n\t},\r\n\tparse: function (text) {\r\n\t\ttext = text.replace(/(\\\"\\\\\\/Date\\(\\d+\\)\\\\\\/\")/g, this.regExDate);\r\n\t\treturn eval('(' + text + ')');\r\n\t},\r\n\tm: {\r\n\t\t'\\b': '\\\\b',\r\n\t\t'\\t': '\\\\t',\r\n\t\t'\\n': '\\\\n',\r\n\t\t'\\f': '\\\\f',\r\n\t\t'\\r': '\\\\r',\r\n\t\t'\"': '\\\\\"',\r\n\t\t'\\\\': '\\\\\\\\'\r\n\t},\r\n\ttoJSON: function (o) {\r\n\t\tif (o == null) {\r\n\t\t\treturn \"null\";\r\n\t\t}\r\n\t\tvar v = [];\r\n\t\tvar i;\r\n\t\tvar c = o.constructor;\r\n\t\tif (c == Number) {\r\n\t\t\treturn isFinite(o) ? o.toString() : AjaxPro.toJSON(null);\r\n\t\t} else if (c == Boolean) {\r\n\t\t\treturn o.toString();\r\n\t\t} else if (c == String) {\r\n\t\t\tif (/[\"\\\\\\x00-\\x1f]/.test(o)) {\r\n\t\t\t\to = o.replace(/([\\x00-\\x1f\\\\\"])/g, function (a, b) {\r\n\t\t\t\t\tvar c = AjaxPro.m[b];\r\n\t\t\t\t\tif (c) {\r\n\t\t\t\t\t\treturn c;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tc = b.charCodeAt();\r\n\t\t\t\t\treturn '\\\\u00' +\r\n\t\t\t\t\t\tMath.floor(c / 16).toString(16) +\r\n\t\t\t\t\t\t(c % 16).toString(16);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn '\"' + o + '\"';\r\n\t\t} else if (c == Array) {\r\n\t\t\tfor (i = 0; i < o.length; i++) {\r\n\t\t\t\tv.push(AjaxPro.toJSON(o[i]));\r\n\t\t\t}\r\n\t\t\treturn \"[\" + v.join(\",\") + \"]\";\r\n\t\t} else if (c == Date) {\r\n\t\t\treturn AjaxPro.toJSON(\"/Date(\" + new Date(Date.UTC(o.getUTCFullYear(), o.getUTCMonth(), o.getUTCDate(), o.getUTCHours(), o.getUTCMinutes(), o.getUTCSeconds(), o.getUTCMilliseconds())).getTime() + \")/\");\r\n\t\t}\r\n\t\tif (typeof o.toJSON == \"function\") {\r\n\t\t\treturn o.toJSON();\r\n\t\t}\r\n\t\tif (typeof o == \"object\") {\r\n\t\t\tfor (var attr in o) {\r\n\t\t\t\tif (typeof o[attr] != \"function\") {\r\n\t\t\t\t\tv.push('\"' + attr + '\":' + AjaxPro.toJSON(o[attr]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (v.length > 0) {\r\n\t\t\t\treturn \"{\" + v.join(\",\") + \"}\";\r\n\t\t\t}\r\n\t\t\treturn \"{}\";\r\n\t\t}\r\n\t\treturn o.toString();\r\n\t},\r\n\tdispose: function () {\r\n\t\tif (AjaxPro.queue != null) {\r\n\t\t\tAjaxPro.queue.dispose();\r\n\t\t}\r\n\t}\r\n}, false);\r\n\r\naddEvent(window, \"unload\", AjaxPro.dispose);\r\n\r\nAjaxPro.Request = function (url) {\r\n\tthis.url = url;\r\n\tthis.xmlHttp = null;\r\n};\r\n\r\nAjaxPro.Request.prototype = {\r\n\turl: null,\r\n\tcallback: null,\r\n\tonLoading: null,\r\n\tonError: null,\r\n\tonTimeout: null,\r\n\tonStateChanged: null,\r\n\targs: null,\r\n\tcontext: null,\r\n\tisRunning: false,\r\n\tabort: function () {\r\n\t\tif (this.timeoutTimer != null) {\r\n\t\t\tclearTimeout(this.timeoutTimer);\r\n\t\t}\r\n\t\tif (this.xmlHttp) {\r\n\t\t\tthis.xmlHttp.onreadystatechange = AjaxPro.noOperation;\r\n\t\t\tthis.xmlHttp.abort();\r\n\t\t}\r\n\t\tif (this.isRunning) {\r\n\t\t\tthis.isRunning = false;\r\n\t\t\tthis.onLoading(false);\r\n\t\t}\r\n\t},\r\n\tdispose: function () {\r\n\t\tthis.abort();\r\n\t},\r\n\tgetEmptyRes: function () {\r\n\t\treturn {\r\n\t\t\terror: null,\r\n\t\t\tvalue: null,\r\n\t\t\trequest: { method: this.method, args: this.args },\r\n\t\t\tcontext: this.context,\r\n\t\t\tduration: this.duration\r\n\t\t};\r\n\t},\r\n\tendRequest: function (res) {\r\n\t\tthis.abort();\r\n\t\tif (res.error != null) {\r\n\t\t\tthis.onError(res.error, this);\r\n\t\t}\r\n\r\n\t\tif (typeof this.callback == \"function\") {\r\n\t\t\tthis.callback(res, this);\r\n\t\t}\r\n\t},\r\n\tmozerror: function () {\r\n\t\tif (this.timeoutTimer != null) {\r\n\t\t\tclearTimeout(this.timeoutTimer);\r\n\t\t}\r\n\t\tvar res = this.getEmptyRes();\r\n\t\tres.error = { Message: \"Unknown\", Type: \"ConnectFailure\", Status: 0 };\r\n\t\tthis.endRequest(res);\r\n\t},\r\n\tdoStateChange: function () {\r\n\t\tthis.onStateChanged(this.xmlHttp.readyState, this);\r\n\t\tif (this.xmlHttp.readyState != 4 || !this.isRunning) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.duration = new Date().getTime() - this.__start;\r\n\t\tif (this.timeoutTimer != null) {\r\n\t\t\tclearTimeout(this.timeoutTimer);\r\n\t\t}\r\n\t\tvar res = this.getEmptyRes();\r\n\t\t//Ignore empty statustext to be http2 compatible\r\n\t\tif (this.xmlHttp.status == 200 && this.xmlHttp.statusText == \"OK\" || !this.xmlHttp.statusText) {\r\n\t\t\tres = this.createResponse(res);\r\n\t\t} else {\r\n\t\t\tres = this.createResponse(res, true);\r\n\t\t\tres.error = { Message: this.xmlHttp.statusText, Type: \"ConnectFailure\", Status: this.xmlHttp.status };\r\n\t\t}\r\n\r\n\t\tthis.endRequest(res);\r\n\t},\r\n\tcreateResponse: function (r, noContent) {\r\n\t\tif (!noContent) {\r\n\t\t\tif (typeof (this.xmlHttp.responseText) == \"unknown\") {\r\n\t\t\t\tr.error = { Message: \"XmlHttpRequest error reading property responseText.\", Type: \"XmlHttpRequestException\" };\r\n\t\t\t\treturn r;\r\n\t\t\t}\r\n\r\n\t\t\tvar responseText = \"\" + this.xmlHttp.responseText;\r\n\r\n\t\t\tif (AjaxPro.cryptProvider != null && typeof AjaxPro.cryptProvider.decrypt == \"function\") {\r\n\t\t\t\tresponseText = AjaxPro.cryptProvider.decrypt(responseText);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.xmlHttp.getResponseHeader(\"Content-Type\") == \"text/xml\") {\r\n\t\t\t\tr.value = this.xmlHttp.responseXML;\r\n\t\t\t} else {\r\n\t\t\t\tif (responseText != null && responseText.trim().length > 0) {\r\n\t\t\t\t\tr.json = responseText;\r\n\t\t\t\t\tvar v = null;\r\n\t\t\t\t\tv = AjaxPro.parse(responseText);\r\n\t\t\t\t\tif (v != null) {\r\n\t\t\t\t\t\tif (typeof v.value != \"undefined\") r.value = v.value;\r\n\t\t\t\t\t\telse if (typeof v.error != \"undefined\") r.error = v.error;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* if(this.xmlHttp.getResponseHeader(\"X-\" + AjaxPro.ID + \"-Cache\") == \"server\") {\r\n\t\t\tr.isCached = true;\r\n\t\t} */\r\n\t\treturn r;\r\n\t},\r\n\ttimeout: function () {\r\n\t\tthis.duration = new Date().getTime() - this.__start;\r\n\t\tvar r = this.onTimeout(this.duration, this);\r\n\t\tif (typeof r == \"undefined\" || r != false) {\r\n\t\t\tthis.abort();\r\n\t\t} else {\r\n\t\t\tthis.timeoutTimer = setTimeout(this.timeout.bind(this), AjaxPro.timeoutPeriod);\r\n\t\t}\r\n\t},\r\n\tinvoke: function (method, args, callback, context) {\r\n\t\tthis.__start = new Date().getTime();\r\n\r\n\t\t// if(this.xmlHttp == null) {\r\n\t\tthis.xmlHttp = new XMLHttpRequest();\r\n\t\t// }\r\n\r\n\t\tthis.isRunning = true;\r\n\t\tthis.method = method;\r\n\t\tthis.args = args;\r\n\t\tthis.callback = callback;\r\n\t\tthis.context = context;\r\n\r\n\t\tvar async = typeof (callback) == \"function\" && callback != AjaxPro.noOperation;\r\n\r\n\t\tif (async) {\r\n\t\t\tif (MS.Browser.isIE) {\r\n\t\t\t\tthis.xmlHttp.onreadystatechange = this.doStateChange.bind(this);\r\n\t\t\t} else {\r\n\t\t\t\tthis.xmlHttp.onload = this.doStateChange.bind(this);\r\n\t\t\t\tthis.xmlHttp.onerror = this.mozerror.bind(this);\r\n\t\t\t}\r\n\t\t\tthis.onLoading(true);\r\n\t\t}\r\n\r\n\t\tvar json = AjaxPro.toJSON(args) + \"\";\r\n\t\tif (AjaxPro.cryptProvider != null && typeof AjaxPro.cryptProvider.encrypt == \"function\") {\r\n\t\t\tjson = AjaxPro.cryptProvider.encrypt(json);\r\n\t\t}\r\n\r\n\t\tthis.xmlHttp.open(\"POST\", this.url, async);\r\n\t\tthis.xmlHttp.setRequestHeader(\"Content-Type\", \"text/plain; charset=utf-8\");\r\n\t\tthis.xmlHttp.setRequestHeader(\"X-\" + AjaxPro.ID + \"-Method\", method);\r\n\r\n\t\tif (AjaxPro.token != null && AjaxPro.token.length > 0) {\r\n\t\t\tthis.xmlHttp.setRequestHeader(\"X-\" + AjaxPro.ID + \"-Token\", AjaxPro.token);\r\n\t\t}\r\n\r\n\t\t/* if(!MS.Browser.isIE) {\r\n\t\t\tthis.xmlHttp.setRequestHeader(\"Connection\", \"close\");\r\n\t\t} */\r\n\r\n\t\tthis.timeoutTimer = setTimeout(this.timeout.bind(this), AjaxPro.timeoutPeriod);\r\n\r\n\t\ttry { this.xmlHttp.send(json); } catch (e) { }\t// IE offline exception\r\n\r\n\t\tif (!async) {\r\n\t\t\treturn this.createResponse({ error: null, value: null });\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n};\r\n\r\nAjaxPro.RequestQueue = function (conc) {\r\n\tthis.queue = [];\r\n\tthis.requests = [];\r\n\tthis.timer = null;\r\n\r\n\tif (isNaN(conc)) { conc = 2; }\r\n\r\n\tfor (var i = 0; i < conc; i++) {\t\t// max 2 http connections\r\n\t\tthis.requests[i] = new AjaxPro.Request();\r\n\t\tthis.requests[i].callback = function (res) {\r\n\t\t\tvar r = res.context;\r\n\t\t\tres.context = r[3][1];\r\n\r\n\t\t\tr[3][0](res, this);\r\n\t\t};\r\n\t\tthis.requests[i].callbackHandle = this.requests[i].callback.bind(this.requests[i]);\r\n\t}\r\n\r\n\tthis.processHandle = this.process.bind(this);\r\n};\r\n\r\nAjaxPro.RequestQueue.prototype = {\r\n\tprocess: function () {\r\n\t\tthis.timer = null;\r\n\t\tif (this.queue.length == 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (var i = 0; i < this.requests.length && this.queue.length > 0; i++) {\r\n\t\t\tif (this.requests[i].isRunning == false) {\r\n\t\t\t\tvar r = this.queue.shift();\r\n\r\n\t\t\t\tthis.requests[i].url = r[0];\r\n\t\t\t\tthis.requests[i].onLoading = r[3].length > 2 && r[3][2] != null && typeof r[3][2] == \"function\" ? r[3][2] : AjaxPro.onLoading;\r\n\t\t\t\tthis.requests[i].onError = r[3].length > 3 && r[3][3] != null && typeof r[3][3] == \"function\" ? r[3][3] : AjaxPro.onError;\r\n\t\t\t\tthis.requests[i].onTimeout = r[3].length > 4 && r[3][4] != null && typeof r[3][4] == \"function\" ? r[3][4] : AjaxPro.onTimeout;\r\n\t\t\t\tthis.requests[i].onStateChanged = r[3].length > 5 && r[3][5] != null && typeof r[3][5] == \"function\" ? r[3][5] : AjaxPro.onStateChanged;\r\n\r\n\t\t\t\tthis.requests[i].invoke(r[1], r[2], this.requests[i].callbackHandle, r);\r\n\t\t\t\tr = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.queue.length > 0 && this.timer == null) {\r\n\t\t\tthis.timer = setTimeout(this.processHandle, 0);\r\n\t\t}\r\n\t},\r\n\tadd: function (url, method, args, e) {\r\n\t\tthis.queue.push([url, method, args, e]);\r\n\t\tif (this.timer == null) {\r\n\t\t\tthis.timer = setTimeout(this.processHandle, 0);\r\n\t\t}\r\n\t\t// this.process();\r\n\t},\r\n\tabort: function () {\r\n\t\tthis.queue.length = 0;\r\n\t\tif (this.timer != null) {\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t}\r\n\t\tthis.timer = null;\r\n\t\tfor (var i = 0; i < this.requests.length; i++) {\r\n\t\t\tif (this.requests[i].isRunning == true) {\r\n\t\t\t\tthis.requests[i].abort();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdispose: function () {\r\n\t\tfor (var i = 0; i < this.requests.length; i++) {\r\n\t\t\tvar r = this.requests[i];\r\n\t\t\tr.dispose();\r\n\t\t}\r\n\t\tthis.requests.clear();\r\n\t}\r\n};\r\n\r\nAjaxPro.queue = new AjaxPro.RequestQueue(2);\t// 2 http connections\r\n\r\nAjaxPro.AjaxClass = function (url) {\r\n\tthis.url = url;\r\n};\r\n\r\nAjaxPro.AjaxClass.prototype = {\r\n\tinvoke: function (method, args, e) {\r\n\r\n\t\tif (e != null) {\r\n\t\t\tif (e.length != 6) {\r\n\t\t\t\tfor (; e.length < 6;) { e.push(null); }\r\n\t\t\t}\r\n\t\t\tif (e[0] != null && typeof (e[0]) == \"function\") {\r\n\t\t\t\treturn AjaxPro.queue.add(this.url, method, args, e);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar r = new AjaxPro.Request();\r\n\t\tr.url = this.url;\r\n\t\treturn r.invoke(method, args);\r\n\t}\r\n};\r\n"], "filenames": ["AjaxPro/Utilities/Constant.cs", "AjaxPro/core.js"], "buggy_code_start_loc": [55, 182], "buggy_code_end_loc": [56, 212], "fixing_code_start_loc": [55, 182], "fixing_code_end_loc": [56, 208], "type": "CWE-79", "message": "Ajax.NET Professional (AjaxPro) is an AJAX framework for Microsoft ASP.NET which will create proxy JavaScript classes that are used on client-side to invoke methods on the web server. Affected versions of this package are vulnerable cross site scripting attacks. Releases before version 21.12.22.1 are affected. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "other": {"cve": {"id": "CVE-2023-49289", "sourceIdentifier": "security-advisories@github.com", "published": "2023-12-05T00:15:08.967", "lastModified": "2023-12-08T17:25:37.173", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Ajax.NET Professional (AjaxPro) is an AJAX framework for Microsoft ASP.NET which will create proxy JavaScript classes that are used on client-side to invoke methods on the web server. Affected versions of this package are vulnerable cross site scripting attacks. Releases before version 21.12.22.1 are affected. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "Ajax.NET Professional (AjaxPro) es un framework AJAX para Microsoft ASP.NET que crear\u00e1 clases de JavaScript proxy que se utilizan en el lado del cliente para invocar m\u00e9todos en el servidor web. Las versiones afectadas de este paquete son ataques vulnerables de cross site scripting. Las versiones anteriores a la versi\u00f3n 21.12.22.1 se ven afectadas. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.5}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:michaelschwarz:ajax.net_professional:*:*:*:*:*:asp.net:*:*", "versionEndExcluding": "21.12.22.1", "matchCriteriaId": "A26A2313-1FB9-4489-BB02-9176E6002074"}]}]}], "references": [{"url": "https://github.com/michaelschwarz/Ajax.NET-Professional/commit/c89e39b9679fcb8ab6644fe21cc7e652cb615e2b", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/michaelschwarz/Ajax.NET-Professional/security/advisories/GHSA-8v6j-gc74-fmpp", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://www.nuget.org/packages/AjaxNetProfessional/", "source": "security-advisories@github.com", "tags": ["Product"]}]}, "github_commit_url": "https://github.com/michaelschwarz/Ajax.NET-Professional/commit/c89e39b9679fcb8ab6644fe21cc7e652cb615e2b"}}