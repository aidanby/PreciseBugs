{"buggy_code": ["\n<%import>\n    com.pugh.sockso.Constants;\n    com.pugh.sockso.Utils;\n    com.pugh.sockso.Properties;\n    com.pugh.sockso.music.Track;\n    com.pugh.sockso.music.Playlist;\n    com.pugh.sockso.resources.Locale;\n    com.pugh.sockso.web.User;\n    java.util.Vector;\n</%import>\n\n<%implements>\n    com.pugh.sockso.web.PageTemplate;\n</%implements>\n\n<%args>\n    Properties properties = null;\n    Vector<Track> tracks = null;\n    Playlist playlist = null;\n    User user = null;\n    Locale locale = null;\n    Vector<User> recentUsers = null;\n</%args>\n\n<& ../IHeader; properties=properties; title=\"Playlist: \" + playlist.getName(); user=user; locale=locale; &>\n\n<h2>\n    <div class=\"links\">\n        <% Utils.u2e(playlist.getName()) #n %>\n        <div class=\"links\">\n            <& IMusicLinks; type=\"pl\"; id=playlist.getId(); name=playlist.getName(); shareLink=true; playRandomLink=true; locale=locale; properties=properties; &>\n        </div>\n    </div>\n</h2>\n\n<br />\n\n<ul class=\"musiclist\">\n<%if tracks.size() > 0 %>\n    <%for Track track : tracks %>\n        <li class=\"track\">\n            <& IMusicLinks; type=\"tr\"; id=track.getId(); name=track.getName(); locale=locale; properties=properties; &>\n            <a href=\"<% properties.getUrl(\"/browse/artist/\"+track.getArtist().getId()) #n %>\"><% Utils.u2e(track.getArtist().getName()) #n %></a> -\n            <a href=\"<% properties.getUrl(\"/browse/album/\"+track.getAlbum().getId()) #n %>\"><% Utils.u2e(track.getAlbum().getName()) #n %></a> -\n            <span class=\"link\"><% Utils.u2e(track.getName()) #n %></span>\n        </li>\n    </%for>\n<%else>\n    <li class=\"empty\"><% locale.getString(\"www.text.noResults\") %></li>\n</%if>\n</ul>\n\n<& ../IFooter; user=user; locale=locale; properties=properties; recentUsers=recentUsers; &>\n", "\n<%import>\n    com.pugh.sockso.Constants;\n    com.pugh.sockso.Utils;\n    com.pugh.sockso.Properties;\n    com.pugh.sockso.music.Playlist;\n    com.pugh.sockso.web.User;\n    com.pugh.sockso.resources.Locale;\n    java.util.Vector;\n</%import>\n\n<%implements>\n    com.pugh.sockso.web.PageTemplate;\n</%implements>\n\n<%args>\n    Properties properties = null;\n    Vector<Playlist> sitePlaylists = null;\n    Vector<Playlist> userPlaylists = null;\n    User user = null;\n    Locale locale = null;\n    Vector<User> recentUsers = null;\n</%args>\n\n<& ../IHeader; properties=properties; title=\"Playlists\"; user=user; locale=locale; &>\n\n<div class=\"section\">\n\n    <h2><% locale.getString(\"www.title.sitePlaylists\") %></h2>\n\n    <ul class=\"musiclist\">\n    <%if sitePlaylists.size() > 0 %>\n        <%for Playlist playlist : sitePlaylists %>\n            <li class=\"playlist\">\n                <& IMusicLinks; type=\"pl\"; id=playlist.getId(); name=playlist.getName(); locale=locale; properties=properties; &>\n                <span class=\"link\"><a href=\"<% properties.getUrl(\"/browse/playlist/\"+playlist.getId()) #n %>\"><% Utils.u2e(playlist.getName()) #n %></a></span>\n                <span class=\"info\">(<% playlist.getTrackCount() %> track<%if playlist.getTrackCount() != 1 %>s</%if>)</span>\n            </li>\n        </%for>\n    <%else>\n        <li class=\"empty\"><% locale.getString(\"www.text.noResults\") %></li>\n    </%if>\n    </ul>\n\n</div>\n\n<div class=\"section\">\n\n    <h2><% locale.getString(\"www.title.userPlaylists\") %></h2>\n\n    <ul id=\"userPlaylists\" class=\"musiclist\">\n    <%if userPlaylists.size() > 0 %>\n        <%for Playlist playlist : userPlaylists %>\n            <li class=\"playlist\" id=\"userPlaylist<% playlist.getId() %>\">\n                <& IMusicLinks; type=\"pl\"; id=playlist.getId(); name=playlist.getName(); locale=locale; properties=properties; &>\n                <a href=\"<% properties.getUrl(\"/browse/playlist/\"+playlist.getId()) #n %>\"><% Utils.u2e(playlist.getName()) #n %></a>\n                by\n                <%if user != null && (user.getId() == playlist.getUser().getId()) %>\n                    <b>you</b>\n                <%else>\n                    <% Utils.u2e(playlist.getUser().getName()) #n %>\n                </%if>\n                (<% playlist.getTrackCount() %> track<%if playlist.getTrackCount() != 1 %>s</%if>)\n                <%if user != null && (playlist.getUser().getId() == user.getId()) %>\n                    <a href=\"javascript:;\" class=\"delete\" onclick=\"deletePlaylist('<% playlist.getId() %>');return false;\"><img\n                        src=\"<% properties.getUrl(\"/<skin>/images/remove.png\") #n %>\" title=\"<% locale.getString(\"www.label.deletePlaylist\") %>\" /></a>\n                </%if>\n            </li>\n        </%for>\n    <%else>\n        <li class=\"empty\"><% locale.getString(\"www.text.noResults\") %></li>\n    </%if>\n    </ul>\n\n</div>\n\n<& ../IFooter; user=user; locale=locale; properties=properties; recentUsers=recentUsers; &>\n"], "fixing_code": ["\n<%import>\n    com.pugh.sockso.Constants;\n    com.pugh.sockso.Utils;\n    com.pugh.sockso.Properties;\n    com.pugh.sockso.music.Track;\n    com.pugh.sockso.music.Playlist;\n    com.pugh.sockso.resources.Locale;\n    com.pugh.sockso.web.User;\n    java.util.Vector;\n</%import>\n\n<%implements>\n    com.pugh.sockso.web.PageTemplate;\n</%implements>\n\n<%args>\n    Properties properties = null;\n    Vector<Track> tracks = null;\n    Playlist playlist = null;\n    User user = null;\n    Locale locale = null;\n    Vector<User> recentUsers = null;\n</%args>\n\n<& ../IHeader; properties=properties; title=\"Playlist: \" + Utils.XMLEncode(playlist.getName()); user=user; locale=locale; &>\n\n<h2>\n    <div class=\"links\">\n        <% Utils.XMLEncode(playlist.getName()) #n %>\n        <div class=\"links\">\n            <& IMusicLinks; type=\"pl\"; id=playlist.getId(); name=playlist.getName(); shareLink=true; playRandomLink=true; locale=locale; properties=properties; &>\n        </div>\n    </div>\n</h2>\n\n<br />\n\n<ul class=\"musiclist\">\n<%if tracks.size() > 0 %>\n    <%for Track track : tracks %>\n        <li class=\"track\">\n            <& IMusicLinks; type=\"tr\"; id=track.getId(); name=track.getName(); locale=locale; properties=properties; &>\n            <a href=\"<% properties.getUrl(\"/browse/artist/\"+track.getArtist().getId()) #n %>\"><% Utils.u2e(track.getArtist().getName()) #n %></a> -\n            <a href=\"<% properties.getUrl(\"/browse/album/\"+track.getAlbum().getId()) #n %>\"><% Utils.u2e(track.getAlbum().getName()) #n %></a> -\n            <span class=\"link\"><% Utils.u2e(track.getName()) #n %></span>\n        </li>\n    </%for>\n<%else>\n    <li class=\"empty\"><% locale.getString(\"www.text.noResults\") %></li>\n</%if>\n</ul>\n\n<& ../IFooter; user=user; locale=locale; properties=properties; recentUsers=recentUsers; &>\n", "\n<%import>\n    com.pugh.sockso.Constants;\n    com.pugh.sockso.Utils;\n    com.pugh.sockso.Properties;\n    com.pugh.sockso.music.Playlist;\n    com.pugh.sockso.web.User;\n    com.pugh.sockso.resources.Locale;\n    java.util.Vector;\n</%import>\n\n<%implements>\n    com.pugh.sockso.web.PageTemplate;\n</%implements>\n\n<%args>\n    Properties properties = null;\n    Vector<Playlist> sitePlaylists = null;\n    Vector<Playlist> userPlaylists = null;\n    User user = null;\n    Locale locale = null;\n    Vector<User> recentUsers = null;\n</%args>\n\n<& ../IHeader; properties=properties; title=\"Playlists\"; user=user; locale=locale; &>\n\n<div class=\"section\">\n\n    <h2><% locale.getString(\"www.title.sitePlaylists\") %></h2>\n\n    <ul class=\"musiclist\">\n    <%if sitePlaylists.size() > 0 %>\n        <%for Playlist playlist : sitePlaylists %>\n            <li class=\"playlist\">\n                <& IMusicLinks; type=\"pl\"; id=playlist.getId(); name=playlist.getName(); locale=locale; properties=properties; &>\n                <span class=\"link\"><a href=\"<% properties.getUrl(\"/browse/playlist/\"+playlist.getId()) #n %>\"><% Utils.u2e(playlist.getName()) #n %></a></span>\n                <span class=\"info\">(<% playlist.getTrackCount() %> track<%if playlist.getTrackCount() != 1 %>s</%if>)</span>\n            </li>\n        </%for>\n    <%else>\n        <li class=\"empty\"><% locale.getString(\"www.text.noResults\") %></li>\n    </%if>\n    </ul>\n\n</div>\n\n<div class=\"section\">\n\n    <h2><% locale.getString(\"www.title.userPlaylists\") %></h2>\n\n    <ul id=\"userPlaylists\" class=\"musiclist\">\n    <%if userPlaylists.size() > 0 %>\n        <%for Playlist playlist : userPlaylists %>\n            <li class=\"playlist\" id=\"userPlaylist<% playlist.getId() %>\">\n                <& IMusicLinks; type=\"pl\"; id=playlist.getId(); name=playlist.getName(); locale=locale; properties=properties; &>\n                <a href=\"<% properties.getUrl(\"/browse/playlist/\"+playlist.getId()) #n %>\"><% Utils.XMLEncode(playlist.getName()) #n %></a>\n                by\n                <%if user != null && (user.getId() == playlist.getUser().getId()) %>\n                    <b>you</b>\n                <%else>\n                    <% Utils.XMLEncode(playlist.getUser().getName()) #n %>\n                </%if>\n                (<% playlist.getTrackCount() %> track<%if playlist.getTrackCount() != 1 %>s</%if>)\n                <%if user != null && (playlist.getUser().getId() == user.getId()) %>\n                    <a href=\"javascript:;\" class=\"delete\" onclick=\"deletePlaylist('<% playlist.getId() %>');return false;\"><img\n                        src=\"<% properties.getUrl(\"/<skin>/images/remove.png\") #n %>\" title=\"<% locale.getString(\"www.label.deletePlaylist\") %>\" /></a>\n                </%if>\n            </li>\n        </%for>\n    <%else>\n        <li class=\"empty\"><% locale.getString(\"www.text.noResults\") %></li>\n    </%if>\n    </ul>\n\n</div>\n\n<& ../IFooter; user=user; locale=locale; properties=properties; recentUsers=recentUsers; &>\n"], "filenames": ["templates/com/pugh/sockso/templates/web/browse/TPlaylist.jamon", "templates/com/pugh/sockso/templates/web/browse/TPlaylists.jamon"], "buggy_code_start_loc": [26, 56], "buggy_code_end_loc": [31, 62], "fixing_code_start_loc": [26, 56], "fixing_code_end_loc": [31, 62], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in user/register in Sockso 1.5 and earlier allows remote attackers to inject arbitrary web script or HTML via the name parameter.", "other": {"cve": {"id": "CVE-2012-4267", "sourceIdentifier": "cve@mitre.org", "published": "2012-08-13T22:55:01.240", "lastModified": "2012-08-14T04:00:00.000", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in user/register in Sockso 1.5 and earlier allows remote attackers to inject arbitrary web script or HTML via the name parameter."}, {"lang": "es", "value": "Una vulnerabilidad de ejecuci\u00f3n de comandos en sitios cruzados (XSS) en user/register en Sockso v1.5 y versiones anteriores permite a atacantes remotos inyectar secuencias de comandos web o HTML a trav\u00e9s del par\u00e1metro name.\r\n"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.5", "matchCriteriaId": "CC8B07BE-48DB-4B31-AC72-11D2110D9511"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1:*:*:*:*:*:*:*", "matchCriteriaId": "0057C683-975A-4FEF-A4F7-8542D8C00C44"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "D3FE34CB-940F-4151-948F-DCDF4C323C6B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "9CF94E42-470C-4913-8999-8B0C5BE80ACD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "7A2EE0A1-2985-4F94-893D-049C432EFD0F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "48837FB7-2340-4C4B-953C-073006EB8EE6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "9145C81A-7BBB-430F-8750-F186AF0E06E8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "12D1180C-C485-4BCF-BB09-D190BD4BE214"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.7:*:*:*:*:*:*:*", "matchCriteriaId": "E5D91033-C64D-4A08-B873-93C32ED61C19"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.1.8:*:*:*:*:*:*:*", "matchCriteriaId": "76963120-C187-4B0D-B354-E25AF0713EFB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2:*:*:*:*:*:*:*", "matchCriteriaId": "2353AC56-56EB-4146-B725-14AF107A0832"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "2F91289F-2C58-4ACC-AA2D-4848E42C3E94"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2.2:*:*:*:*:*:*:*", "matchCriteriaId": "A7CC56A4-CD83-4E6B-8B99-4C5553075C53"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "6018A9BD-B64D-4954-B93C-3514000794AA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2.4:*:*:*:*:*:*:*", "matchCriteriaId": "0C0B2B45-C28F-424B-B562-437CE6DDDFCA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2.5:*:*:*:*:*:*:*", "matchCriteriaId": "2B40BCB5-AFE1-479B-89C5-2282117D4AF2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2.6:*:*:*:*:*:*:*", "matchCriteriaId": "33B1F055-7664-48B2-B581-BF84A33D0C2D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.2.7:*:*:*:*:*:*:*", "matchCriteriaId": "AC4E7D45-2D10-474A-B2B3-3066AF1A11CA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.3:*:*:*:*:*:*:*", "matchCriteriaId": "FD7DC3A1-5339-45C5-B8A4-0458FAB4B9B1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.3.1:*:*:*:*:*:*:*", "matchCriteriaId": "E4FB26E7-0712-4513-AF61-1ACFADA6FCB0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.3.2:*:*:*:*:*:*:*", "matchCriteriaId": "8055EF8A-B92A-4676-A382-D3567FC3FC3C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.3.3:*:*:*:*:*:*:*", "matchCriteriaId": "87D53EE8-F75D-4954-920E-73D5CA0722E8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.3.4:*:*:*:*:*:*:*", "matchCriteriaId": "3AF41FA0-DC88-4416-BE14-ABE4EB5D1497"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.3.5:*:*:*:*:*:*:*", "matchCriteriaId": "91C54106-BB0F-45AB-BA2D-7D7278A8B893"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.4:*:*:*:*:*:*:*", "matchCriteriaId": "34C344BA-4CAD-4CA4-9DDB-0C6DFD97C5E1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "56F0065D-BA9A-498B-BDEE-8CE89F575E38"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pu-gh:sockso:1.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "EEDEF3E8-A155-4C60-BA66-77BF6AA5A2F2"}]}]}], "references": [{"url": "http://smwyg.com/blog/#sockso-persistant-xss-attack", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "http://www.exploit-db.com/exploits/18868", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://github.com/rodnaph/sockso/commit/fe2d895ea8eb8b8ccad5a3319f472e45d6ba5136", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}, {"url": "https://github.com/rodnaph/sockso/issues/93", "source": "cve@mitre.org"}, {"url": "https://github.com/rodnaph/sockso/pull/99/files", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/rodnaph/sockso/commit/fe2d895ea8eb8b8ccad5a3319f472e45d6ba5136"}}