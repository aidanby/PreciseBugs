{"buggy_code": ["<?php\n/**\n * Local variables.\n * \n * @var string $active_menu\n * @var string $company_logo\n */\n?>\n\n<nav id=\"header\" class=\"navbar navbar-expand-md navbar-dark\">\n    <div id=\"header-logo\" class=\"navbar-brand\">\n        <img src=\"<?= base_url('assets/img/logo.png') ?>\" alt=\"logo\">\n        <h6>EASY!APPOINTMENTS</h6>\n        <small>Online Appointment Scheduler</small>\n    </div>\n\n    <button type=\"button\" class=\"navbar-toggler\" data-bs-toggle=\"collapse\" data-bs-target=\"#header-menu\">\n        <span class=\"sr-only\">Toggle navigation</span>\n        <span class=\"navbar-toggler-icon\"></span>\n    </button>\n\n    <div id=\"header-menu\" class=\"collapse navbar-collapse flex-row-reverse px-2\">\n        <ul class=\"navbar-nav\">\n            <?php $hidden = can('view', PRIV_APPOINTMENTS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_APPOINTMENTS ? 'active' : '' ?>\n            <li class=\"nav-item <?= $active . $hidden ?>\">\n                <a href=\"<?= site_url('calendar' . (vars('calendar_view') === CALENDAR_VIEW_TABLE ? '?view=table' : '')) ?>\" class=\"nav-link\"\n                   data-tippy-content=\"<?= lang('manage_appointment_record_hint') ?>\">\n                    <i class=\"fas fa-calendar-alt me-2\"></i>\n                    <?= lang('calendar') ?>\n                </a>\n            </li>\n\n            <?php $hidden = can('view', PRIV_CUSTOMERS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_CUSTOMERS ? 'active' : '' ?>\n            <li class=\"nav-item <?= $active . $hidden ?>\">\n                <a href=\"<?= site_url('customers') ?>\" class=\"nav-link\"\n                   data-tippy-content=\"<?= lang('manage_customers_hint') ?>\">\n                    <i class=\"fas fa-user-friends me-2\"></i>\n                    <?= lang('customers') ?>\n                </a>\n            </li>\n\n            <?php $hidden = can('view', PRIV_SERVICES) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_SERVICES ? 'active' : '' ?>\n            <li class=\"nav-item dropdown <?= $active . $hidden ?>\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" data-bs-toggle=\"dropdown\"\n                   data-tippy-content=\"<?= lang('manage_services_hint') ?>\">\n                    <i class=\"fas fa-business-time me-2\"></i>\n                    <?= lang('services') ?>\n                </a>\n                <div class=\"dropdown-menu dropdown-menu-end\">\n                    <a class=\"dropdown-item\" href=\"<?= site_url('services') ?>\">\n                        <?= lang('services') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('categories') ?>\">\n                        <?= lang('categories') ?>\n                    </a>\n                </div>\n            </li>\n\n            <?php $hidden = can('view', PRIV_USERS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_USERS ? 'active' : '' ?>\n            <li class=\"nav-item dropdown <?= $active . $hidden ?>\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" data-bs-toggle=\"dropdown\"\n                   data-tippy-content=\"<?= lang('manage_users_hint') ?>\">\n                    <i class=\"fas fa-users me-2\"></i>\n                    <?= lang('users') ?>\n                </a>\n                <div class=\"dropdown-menu dropdown-menu-end\">\n                    <a class=\"dropdown-item\" href=\"<?= site_url('providers') ?>\">\n                        <?= lang('providers') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('secretaries') ?>\">\n                        <?= lang('secretaries') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('admins') ?>\">\n                        <?= lang('admins') ?>\n                    </a>\n                </div>\n            </li>\n\n            <?php $hidden = can('view', PRIV_SYSTEM_SETTINGS) || can('view', PRIV_USER_SETTINGS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_SYSTEM_SETTINGS ? 'active' : '' ?>\n            <li class=\"nav-item dropdown <?= $active . $hidden ?>\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" data-bs-toggle=\"dropdown\"\n                   data-tippy-content=\"<?= lang('settings_hint') ?>\">\n                    <i class=\"fas fa-user me-2\"></i>\n                    <?= vars('user_display_name') ?>\n                </a>\n                <div class=\"dropdown-menu dropdown-menu-end\">\n                    <?php if (can('view', PRIV_SYSTEM_SETTINGS)): ?>\n                        <a class=\"dropdown-item\" href=\"<?= site_url('general_settings') ?>\">\n                            <?= lang('settings') ?>\n                        </a>\n                    <?php endif ?>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('account') ?>\">\n                        <?= lang('account') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('about') ?>\">\n                        <?= lang('about') ?>\n                    </a>\n                    <div class=\"dropdown-divider\"></div>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('logout') ?>\">\n                        <?= lang('log_out') ?>\n                    </a>\n                </div>\n            </li>\n        </ul>\n    </div>\n</nav>\n\n<div id=\"notification\" style=\"display: none;\"></div>\n\n<div id=\"loading\" style=\"display: none;\">\n    <div class=\"any-element animation is-loading\">\n        &nbsp;\n    </div>\n</div>\n"], "fixing_code": ["<?php\n/**\n * Local variables.\n * \n * @var string $active_menu\n * @var string $company_logo\n */\n?>\n\n<nav id=\"header\" class=\"navbar navbar-expand-md navbar-dark\">\n    <div id=\"header-logo\" class=\"navbar-brand\">\n        <img src=\"<?= base_url('assets/img/logo.png') ?>\" alt=\"logo\">\n        <h6>EASY!APPOINTMENTS</h6>\n        <small>Online Appointment Scheduler</small>\n    </div>\n\n    <button type=\"button\" class=\"navbar-toggler\" data-bs-toggle=\"collapse\" data-bs-target=\"#header-menu\">\n        <span class=\"sr-only\">Toggle navigation</span>\n        <span class=\"navbar-toggler-icon\"></span>\n    </button>\n\n    <div id=\"header-menu\" class=\"collapse navbar-collapse flex-row-reverse px-2\">\n        <ul class=\"navbar-nav\">\n            <?php $hidden = can('view', PRIV_APPOINTMENTS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_APPOINTMENTS ? 'active' : '' ?>\n            <li class=\"nav-item <?= $active . $hidden ?>\">\n                <a href=\"<?= site_url('calendar' . (vars('calendar_view') === CALENDAR_VIEW_TABLE ? '?view=table' : '')) ?>\" class=\"nav-link\"\n                   data-tippy-content=\"<?= lang('manage_appointment_record_hint') ?>\">\n                    <i class=\"fas fa-calendar-alt me-2\"></i>\n                    <?= lang('calendar') ?>\n                </a>\n            </li>\n\n            <?php $hidden = can('view', PRIV_CUSTOMERS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_CUSTOMERS ? 'active' : '' ?>\n            <li class=\"nav-item <?= $active . $hidden ?>\">\n                <a href=\"<?= site_url('customers') ?>\" class=\"nav-link\"\n                   data-tippy-content=\"<?= lang('manage_customers_hint') ?>\">\n                    <i class=\"fas fa-user-friends me-2\"></i>\n                    <?= lang('customers') ?>\n                </a>\n            </li>\n\n            <?php $hidden = can('view', PRIV_SERVICES) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_SERVICES ? 'active' : '' ?>\n            <li class=\"nav-item dropdown <?= $active . $hidden ?>\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" data-bs-toggle=\"dropdown\"\n                   data-tippy-content=\"<?= lang('manage_services_hint') ?>\">\n                    <i class=\"fas fa-business-time me-2\"></i>\n                    <?= lang('services') ?>\n                </a>\n                <div class=\"dropdown-menu dropdown-menu-end\">\n                    <a class=\"dropdown-item\" href=\"<?= site_url('services') ?>\">\n                        <?= lang('services') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('categories') ?>\">\n                        <?= lang('categories') ?>\n                    </a>\n                </div>\n            </li>\n\n            <?php $hidden = can('view', PRIV_USERS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_USERS ? 'active' : '' ?>\n            <li class=\"nav-item dropdown <?= $active . $hidden ?>\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" data-bs-toggle=\"dropdown\"\n                   data-tippy-content=\"<?= lang('manage_users_hint') ?>\">\n                    <i class=\"fas fa-users me-2\"></i>\n                    <?= lang('users') ?>\n                </a>\n                <div class=\"dropdown-menu dropdown-menu-end\">\n                    <a class=\"dropdown-item\" href=\"<?= site_url('providers') ?>\">\n                        <?= lang('providers') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('secretaries') ?>\">\n                        <?= lang('secretaries') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('admins') ?>\">\n                        <?= lang('admins') ?>\n                    </a>\n                </div>\n            </li>\n\n            <?php $hidden = can('view', PRIV_SYSTEM_SETTINGS) || can('view', PRIV_USER_SETTINGS) ? '' : 'd-none' ?>\n            <?php $active = $active_menu == PRIV_SYSTEM_SETTINGS ? 'active' : '' ?>\n            <li class=\"nav-item dropdown <?= $active . $hidden ?>\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" data-bs-toggle=\"dropdown\"\n                   data-tippy-content=\"<?= lang('settings_hint') ?>\">\n                    <i class=\"fas fa-user me-2\"></i>\n                    <?= e(vars('user_display_name')) ?>\n                </a>\n                <div class=\"dropdown-menu dropdown-menu-end\">\n                    <?php if (can('view', PRIV_SYSTEM_SETTINGS)): ?>\n                        <a class=\"dropdown-item\" href=\"<?= site_url('general_settings') ?>\">\n                            <?= lang('settings') ?>\n                        </a>\n                    <?php endif ?>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('account') ?>\">\n                        <?= lang('account') ?>\n                    </a>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('about') ?>\">\n                        <?= lang('about') ?>\n                    </a>\n                    <div class=\"dropdown-divider\"></div>\n                    <a class=\"dropdown-item\" href=\"<?= site_url('logout') ?>\">\n                        <?= lang('log_out') ?>\n                    </a>\n                </div>\n            </li>\n        </ul>\n    </div>\n</nav>\n\n<div id=\"notification\" style=\"display: none;\"></div>\n\n<div id=\"loading\" style=\"display: none;\">\n    <div class=\"any-element animation is-loading\">\n        &nbsp;\n    </div>\n</div>\n"], "filenames": ["application/views/components/backend_header.php"], "buggy_code_start_loc": [89], "buggy_code_end_loc": [90], "fixing_code_start_loc": [89], "fixing_code_end_loc": [90], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository alextselegidis/easyappointments prior to 1.5.0.", "other": {"cve": {"id": "CVE-2023-2102", "sourceIdentifier": "security@huntr.dev", "published": "2023-04-15T13:15:45.140", "lastModified": "2023-04-24T18:59:54.250", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository alextselegidis/easyappointments prior to 1.5.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 5.3}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:easyappointments:easyappointments:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.5.0", "matchCriteriaId": "063BC3E9-AA71-49D6-9CEE-F2E7E7B9D687"}]}]}], "references": [{"url": "https://github.com/alextselegidis/easyappointments/commit/bddc5cbeb7ff237a72943b304dcb01c653781767", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/dd7c04a7-a984-4387-9ac4-24596e7ece44", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/alextselegidis/easyappointments/commit/bddc5cbeb7ff237a72943b304dcb01c653781767"}}