{"buggy_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright       Copyright (c) baserCMS Users Community\n * @link            https://basercms.net baserCMS Project\n * @package            Uploader.View\n * @since           baserCMS v 3.0.10\n * @license         https://basercms.net/license/index.html\n */\n$url = $this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name']));\n?>\n\n\n<p class=\"url\">\n\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo FULL_BASE_URL . $url ?></a>\n</p>\n<p class=\"image\">\n\t<a href=\"<?php echo $url ?>\"\n\t   target=\"_blank\"><?php echo $this->Uploader->file($file, ['size' => $size, 'alt' => $file['UploaderFile']['name']]) ?></a>\n</p>\n", "<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright       Copyright (c) baserCMS Users Community\n * @link            https://basercms.net baserCMS Project\n * @package         Uploader.View\n * @since           baserCMS v 3.0.10\n * @license         https://basercms.net/license/index.html\n */\n$url = $this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name']));\n?>\n\n\n<p class=\"url\">\n\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo FULL_BASE_URL . $url ?></a>\n</p>\n<p class=\"image\">\n\t<a href=\"<?php echo $url ?>\"\n\t   target=\"_blank\"><?php echo $this->Uploader->file($file, ['size' => $size, 'alt' => $file['UploaderFile']['name']]) ?></a>\n</p>\n"], "fixing_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright       Copyright (c) baserCMS Users Community\n * @link            https://basercms.net baserCMS Project\n * @package         Uploader.View\n * @since           baserCMS v 3.0.10\n * @license         https://basercms.net/license/index.html\n */\n\n/**\n * @var BcAppView $this\n * @var array $file\n * @var string $size\n */\n$url = h($this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name'])));\n?>\n\n\n<p class=\"url\">\n\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo Router::url($url, true) ?></a>\n</p>\n<p class=\"image\">\n\t<a href=\"<?php echo $url ?>\"\n\t   target=\"_blank\"><?php echo $this->Uploader->file($file, ['size' => $size, 'alt' => $file['UploaderFile']['name']]) ?></a>\n</p>\n", "<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright       Copyright (c) baserCMS Users Community\n * @link            https://basercms.net baserCMS Project\n * @package         Uploader.View\n * @since           baserCMS v 3.0.10\n * @license         https://basercms.net/license/index.html\n */\n\n/**\n * @var BcAppView $this\n * @var array $file\n * @var string $size\n */\n$url = h($this->BcBaser->getUrl($this->Uploader->getFileUrl($file['UploaderFile']['name'])));\n?>\n\n\n<p class=\"url\">\n\t<a href=\"<?php echo $url ?>\" target=\"_blank\"><?php echo Router::url($url, true) ?></a>\n</p>\n<p class=\"image\">\n\t<a href=\"<?php echo $url ?>\"\n\t   target=\"_blank\"><?php echo $this->Uploader->file($file, ['size' => $size, 'alt' => $file['UploaderFile']['name']]) ?></a>\n</p>\n"], "filenames": ["app/webroot/theme/admin-third/UploaderFiles/admin/ajax_image.php", "lib/Baser/Plugin/Uploader/View/UploaderFiles/admin/ajax_image.php"], "buggy_code_start_loc": [8, 12], "buggy_code_end_loc": [18, 18], "fixing_code_start_loc": [8, 12], "fixing_code_end_loc": [24, 24], "type": "CWE-79", "message": "baserCMS is an open source content management system with a focus on Japanese language support. In affected versions there is a cross-site scripting vulnerability in the file upload function of the management system of baserCMS. Users are advised to update as soon as possible. No workaround are available to mitigate this issue.", "other": {"cve": {"id": "CVE-2021-39136", "sourceIdentifier": "security-advisories@github.com", "published": "2021-08-25T18:15:07.177", "lastModified": "2021-08-30T17:45:19.047", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "baserCMS is an open source content management system with a focus on Japanese language support. In affected versions there is a cross-site scripting vulnerability in the file upload function of the management system of baserCMS. Users are advised to update as soon as possible. No workaround are available to mitigate this issue."}, {"lang": "es", "value": "baserCMS es un sistema de administraci\u00f3n de contenidos de c\u00f3digo abierto centrado en el soporte del idioma Japon\u00e9s. En las versiones afectadas se presenta una vulnerabilidad de tipo cross-site scripting en la funci\u00f3n file upload del sistema de administraci\u00f3n de baserCMS. Se recomienda a usuarios que actualicen lo antes posible. No se presentan soluciones disponibles para mitigar este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:basercms:basercms:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.5.1", "matchCriteriaId": "A7E59D36-01FB-4FA5-A518-9D586B5274C8"}]}]}], "references": [{"url": "http://jvn.jp/en/jp/JVN14134801/index.html", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://basercms.net/security/JVN_14134801", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/baserproject/basercms/commit/568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/baserproject/basercms/security/advisories/GHSA-hgjr-632x-qpp3", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/baserproject/basercms/commit/568d4cab5ba1cdee7bbf0133c676d02a98f6d7bc"}}