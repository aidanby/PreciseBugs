{"buggy_code": ["# Default REST security configuration.\n# \n# By default this configuration locks down every rest call. The following is an example of a more\n# lax configuration in which read only (GET) access is allowed anonymously:\n# \n#/**;GET=IS_AUTHENTICATED_ANONYMOUSLY\n#/**;POST,DELETE,PUT=ADMIN\n#\n# The following is an example of a configuration that could be used with the restconfig plugin in \n# which only configuration in a specific workspace is restricted:\n#\n#/rest/workspaces/topp*;GET=ADMIN\n#/rest/workspaces/topp/**;GET=ADMIN\n#/**;POST,DELETE,PUT=ADMIN\n#\n/rest/br/**;GET,POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n/rest/geofence/**;GET,POST,DELETE,PUT=ROLE_ADMINISTRATOR\n/rest/imports/**;GET,POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n/rest/layers/**;GET,POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n/rest/printing/**;GET,POST=IS_AUTHENTICATED_ANONYMOUSLY\n/rest/sldservice/capabilities.json;GET=IS_AUTHENTICATED_ANONYMOUSLY\n/rest/sldservice/**;GET=IS_AUTHENTICATED_FULLY\n/rest/styles/**;GET,POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n/rest/styles.xml;GET=IS_AUTHENTICATED_FULLY\n/rest/workspaces/**;GET,POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n/rest/workspaces.xml;GET=IS_AUTHENTICATED_FULLY\n\n/gwc/rest/layers/**;GET=IS_AUTHENTICATED_FULLY\n\n/**;GET,POST,DELETE,PUT=ROLE_ADMINISTRATOR\n"], "fixing_code": ["# Default REST security configuration.\n# \n# By default this configuration locks down every rest call. The following is an example of a more\n# lax configuration in which read only (GET) access is allowed anonymously:\n# \n#/**;GET=IS_AUTHENTICATED_ANONYMOUSLY\n#/**;POST,DELETE,PUT=ADMIN\n#\n# The following is an example of a configuration that could be used with the restconfig plugin in \n# which only configuration in a specific workspace is restricted:\n#\n#/rest/workspaces/topp*;GET=ADMIN\n#/rest/workspaces/topp/**;GET=ADMIN\n#/**;POST,DELETE,PUT=ADMIN\n#\n/rest/security/**;GET,POST,DELETE,PUT=ROLE_ADMINISTRATOR\n/rest/monitor/**;GET=ROLE_ADMINISTRATOR\n\n/rest/geofence/**;GET,POST,DELETE,PUT=ROLE_ADMINISTRATOR\n/rest/resource/**;GET,POST,DELETE,PUT=ROLE_ADMINISTRATOR\n\n/rest/imports/**;GET,POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n/rest/br/**;GET,POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n\n/rest/process/batchdownload/download/**;GET=IS_AUTHENTICATED_ANONYMOUSLY\n/rest/printing/**;GET,POST=IS_AUTHENTICATED_ANONYMOUSLY\n\n/rest/about/**;GET,POST,DELETE,PUT=ROLE_ADMINISTRATOR\n\n/**;GET=IS_AUTHENTICATED_ANONYMOUSLY\n/**;POST,DELETE,PUT=IS_AUTHENTICATED_FULLY\n"], "filenames": ["data/security/rest.properties"], "buggy_code_start_loc": [15], "buggy_code_end_loc": [31], "fixing_code_start_loc": [16], "fixing_code_end_loc": [32], "type": "CWE-200", "message": "GeoNode is an open source platform that facilitates the creation, sharing, and collaborative use of geospatial data. Prior to versions 2.20.6, 2.19.6, and 2.18.7, anonymous users can obtain sensitive information about GeoNode configurations from the response of the `/geoserver/rest/about/status` Geoserver REST API endpoint. The Geoserver endpoint is secured by default, but the configuration of Geoserver for GeoNode opens a list of REST endpoints to support some of its public-facing services. The vulnerability impacts both GeoNode 3 and GeoNode 4 instances. Geoserver security configuration is provided by `geoserver-geonode-ext`. A patch for 2.20.7 has been released which blocks access to the affected endpoint. The patch has been backported to branches 2.20.6, 2.19.7, 2.19.6, and 2.18.7. All the published artifacts and Docker images have been updated accordingly. A more advanced patch has been applied to the master and development versions, which require some changes to GeoNode code. They will be available with the next 4.1.0 release. The patched configuration only has an effect on new deployments. For existing setups, the patch must be applied manually inside the Geoserver data directory. The patched file must replace the existing `<geoserver_datadir>/security/rest.properties` file.", "other": {"cve": {"id": "CVE-2023-28442", "sourceIdentifier": "security-advisories@github.com", "published": "2023-03-24T00:15:15.463", "lastModified": "2023-03-31T13:09:05.413", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "GeoNode is an open source platform that facilitates the creation, sharing, and collaborative use of geospatial data. Prior to versions 2.20.6, 2.19.6, and 2.18.7, anonymous users can obtain sensitive information about GeoNode configurations from the response of the `/geoserver/rest/about/status` Geoserver REST API endpoint. The Geoserver endpoint is secured by default, but the configuration of Geoserver for GeoNode opens a list of REST endpoints to support some of its public-facing services. The vulnerability impacts both GeoNode 3 and GeoNode 4 instances. Geoserver security configuration is provided by `geoserver-geonode-ext`. A patch for 2.20.7 has been released which blocks access to the affected endpoint. The patch has been backported to branches 2.20.6, 2.19.7, 2.19.6, and 2.18.7. All the published artifacts and Docker images have been updated accordingly. A more advanced patch has been applied to the master and development versions, which require some changes to GeoNode code. They will be available with the next 4.1.0 release. The patched configuration only has an effect on new deployments. For existing setups, the patch must be applied manually inside the Geoserver data directory. The patched file must replace the existing `<geoserver_datadir>/security/rest.properties` file."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:geosolutionsgroup:geonode:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.18.7", "matchCriteriaId": "027B75CC-42A5-4AB6-A6EB-A7C4C36EE44E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:geosolutionsgroup:geonode:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.19.0", "versionEndExcluding": "2.19.6", "matchCriteriaId": "2FC6FBE2-67E1-4014-9439-478911E7C56E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:geosolutionsgroup:geonode:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.20.0", "versionEndExcluding": "2.20.6", "matchCriteriaId": "769D448E-E1E4-4C36-853C-8E24CDDB74FA"}]}]}], "references": [{"url": "https://github.com/GeoNode/geonode/security/advisories/GHSA-87mh-vw7c-5v6w", "source": "security-advisories@github.com", "tags": ["Mitigation", "Patch", "Vendor Advisory"]}, {"url": "https://github.com/GeoNode/geoserver-geonode-ext/blob/2.20.7/data/security/rest.properties", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/GeoNode/geoserver-geonode-ext/commit/f44cb074d8361c0f4e625013675bdd7bd8203df6", "source": "security-advisories@github.com", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/GeoNode/geoserver-geonode-ext/commit/f44cb074d8361c0f4e625013675bdd7bd8203df6"}}