{"buggy_code": ["/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* style common to all pages in the site */\n\n/* for the fixed navbar make sure content stops short of page top*/\nbody {\n  padding-top: 50px;\n}\n\n.navbar-inner .container {\n  background: url(../images/navbar_disco.png) no-repeat;\n}\n\n/* used for icons in sidebar search buttons */\n.nd_navbar-icon {\n  vertical-align: sub;\n  margin-top: 4px !important;\n  margin-right: 7px !important;\n  cursor: pointer;\n}\n\n/* careful align of navbar search button and menu */\n.nd_navbar-search-group {\n  margin-top: 0px !important;\n}\n.nd_navbar-search-icon {\n  color: #999;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n.nd_navbar-search-caret {\n  padding-top: 10px !important;\n  padding-left: 5px !important;\n  padding-right: 5px !important;\n}\n\n/* for the \"logged in as...\" text */\n.nd_navbar-text {\n  color: #666;\n  padding-top: 11px;\n}\n\n/* on both main content and sidebar, default is hidden */\n.tab-content {\n  overflow: visible;\n}\n\n/* ajax results should fill all available */\n.tab-content table {\n  width: 100%;\n}\n\n/* results table header should have a background, for floatThead */\ndiv.content > div.tab-content table.nd_floatinghead thead {\n  background-color: floralWhite;\n}\n\n/* jquery ui autocomplete scrollable */\n.ui-autocomplete {\n  max-height: 200px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n/* jstree scrollable */\n\n.nd_scrollable {\n    height: 85vh;\n    overflow: auto;\n}\n\n#snmpPartialSearch {\n  margin-top: -3px;\n}\n\n/* fake looks for form submit buttons embedded in bootstrap dropdowns */\n.nd_btn-link {\n  display: block;\n  padding: 2px 20px;\n  clear: both;\n  font-weight: normal;\n  line-height: 18px;\n  color: #333333;\n  white-space: nowrap;\n  text-decoration: none;\n  margin-top: 0px !important;\n  width: 100%;\n  text-align: left;\n  margin-left: -1px;\n}\n\n.nd_btn-link:hover, .nd_btn-link:focus {\n  text-decoration: none;\n  color: #ffffff;\n  background-color: #0081c2;\n  background-repeat: repeat-x;\n  text-shadow: none;\n}\n\n/* to be added to qtip-bootstrap class */\n.nd_qtip-unconstrained {\n  min-width: 0;\n  max-width: none;\n}\n\n.qtip-content {\n  padding-bottom: 0px;\n  line-height: 8px;\n}\n\n/* for where min-width is set but we don't want it */\n.nd_no-min-width {\n  min-width: 0px;\n}\n\n/* for when hidden modals interfere with mouse actions on higher elements */\n.nd_deep-horizon {\n  z-index: -1000;\n}\n\n/* for when we pinch h4 styling but don't want bold */\n.nd_unbolden {\n  font-weight: normal;\n}\n\n/* for System Information bar */\n.nd_sysinfo-heading {\n  background-color: #eeeeee;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles to adjust the hero box used for homepage + login */\n\n/* space between hero box and navbar */\n.nd_hero-row {\n  margin-top: 50px;\n}\n\n/* alter proportions of hero unit to make it \"tighter\" on content */\n.hero-unit {\n  padding: 30px 60px 40px 90px;\n}\n\n/* push user/pass/login form down+away from the Netdisco banner text */\n.nd_login-form {\n  margin-top: 15px;\n  margin-bottom: 0px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for device inventory */\n\n.nd_inventory-table-head {\n  text-align: center;\n  color: lightSlateGray;\n  margin-top: 6px;\n  margin-bottom: 3px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for links in results tables */\n\n/* make the whole cell become a hyperlink in results table */\n.nd_linkcell {\n  display: block;\n  padding: 0px;\n  height: 100%;\n}\n\n/* still a link, but styled like normal text */\n.nd_stealth-link {\n  text-decoration: none !important;\n  color: #404040;\n}\n\n/* make room for the port log icon */\n.nd_this-port-only {\n  margin-right: 15px;\n}\n/* nudge cell content to the right when port_control controls are enabled */\n.nd_editable-cell > .nd_this-port-only {\n  margin-left: 14px;\n  margin-right: 60px;\n}\n.nd_editable-cell > .nd_port-only-first {\n  margin-left: 5px;\n}\n\n.nd_editable-cell > .nd_editable-cell-content {\n  margin-right: 25px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles to position table cell content */\n\n.table td {\n  vertical-align: baseline;\n}\n\n.table .nd_center-cell {\n  text-align: center;\n}\n\ntd.nd_devport-icon i {\n  line-height: 18px;\n}\n\n/* undo nd_center-cell when in a modial dialog (which lives in table cell) */\n.table .nd_center-cell .modal-body {\n  text-align: left;\n}\n\n/* fix layout of form fields inside the (topology) table */\ntd div.input-append {\n  margin-bottom: 0px;\n}\n\n/* admin buttons in the device details view */\ntd > form.nd_inline-form {\n  margin-bottom: 2px;\n}\n\n/* pull right admin buttons in the device details view */\n.nd_pull-right-admin-button {\n  margin-right: 4px;\n}\n\n/* fix layout of form fields inside the (pseudo devices) table */\n.nd_center-cell input {\n  margin-bottom: 0px;\n}\n\n/* with two forms inside one cell, make the submit buttons side-by-side */\n.nd_inline-form {\n  display: inline;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for \"tabs\" and surrounding content */\n\n\n/* add a small bottom margin (gutter) below all pages */\n#nd_search-results {\n  margin-bottom: 10px;\n}\n\n/* for any label which we want to appear alongside tabs, floated to the right */\n#nd_device-name {\n  float: right;\n  margin-bottom: 0px;\n  margin-top: 9px;\n  font-weight: bold;\n  color: #6D5720;\n}\n\n/* reset to normal weight for the download as CSV icon */\n#nd_csv-download {\n  font-weight: normal;\n}\n\n#nd_csv-download:hover, #nd_sidebar-reset-link:hover {\n  text-decoration: none;\n}\n\n/* badge for pseudo devices layer three toggle */\n.nd_layer-three-link {\n  text-decoration: none !important;\n  display: inline-block;\n  margin-left: -4px;\n}\n\n/* for the job control admin page play/pause links */\n#nd_countdown-refresh:hover, #nd_countdown-control:hover {\n  text-decoration: none;\n}\n\n/* when there's only one tab (report, task etc) change the text color */\n.nd_single-tab {\n  color: rgb(187,112,0) !important;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* style for port_control controls */\n\n/* edit icon in details tab is in the label (not content) cell so nudge to RHS*/\n.nd_device-details-edit {\n  float: right !important;\n  font-size: 14px;\n}\n\n/* port admin up/down control */\n.nd_edit-icon, .nd_hand-icon {\n  cursor: pointer;\n  float: right;\n  display: none;\n}\n\n.nd_hand-icon {\n  position: relative;\n  margin-right: 4px;\n}\n\n/* port admin log view */\n.nd_log-icon {\n  cursor: pointer;\n  color: black;\n  float: right;\n  padding-left: 10px;\n  margin-top: 2px;\n  position: relative;\n}\n.nd_log-icon:hover, .nd_log-icon:focus {\n  text-decoration: none;\n  color: black;\n}\n\n/* port power control */\n.nd_power-icon {\n  cursor: pointer;\n}\n\n/* the port power icon, whether it's on or off */\n.icon-off {\n  vertical-align: middle;\n  color: darkRed;\n}\n\n/* change color of icon from default of red (which is OK for power-off) */\n.nd_power-on {\n  color: darkGreen;\n}\n\n/* style of editable content in any table - yellow background */\n[contenteditable]:focus {\n  background: #FFFFD3 !important;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for collapsing lists - sidebar or main table cell content */\n\n/* sidebar collapser is clickable and deep grey */\n.nd_collapser {\n  cursor: pointer;\n  color: #0088CC;\n}\n\n/* vlans collapser also clickable and deep grey but with no link styling */\n.nd_collapse-vlans {\n  cursor: pointer;\n  color: #0088CC;\n  text-decoration: none !important;\n}\n\n/* set default state of collapsible lists as collapsed (hidden) */\n.nd_collapse-pre-hidden {\n  display: none;\n}\n\n/* for the tagged vlans total when hiding the full list */\n.nd_vlan-total {\n  float: right;\n}\n\n/* little up/down chevron to the right of some collapsed list */\n.nd_arrow-up-down-right {\n  float: right;\n  margin-top: 1px;\n  margin-right: 1px;\n  color: #555;\n}\n\n/* little up arrow to the left of a label for collapsed list */\n.nd_arrow-up-down-left {\n  float: left;\n  margin-right: 6px;\n  color: #555;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for sidebar placement and sizing */\n\n/* make the sidebar fixed on the screen */\n.container-fluid > .nd_sidebar {\n  position: absolute;\n  right: 20px;\n  width: 205px;\n  left: auto;\n}\n\n/* nudge content in the sidebar closer to the left */\n.nd_sidebar-form {\n  padding-left: 0px;\n  margin-top: -9px;\n  margin-bottom: 0px;\n}\n\n/* reduce padding at the bottom of the sidebar content */\n.container-fluid > .nd_sidebar > .well {\n  padding-bottom: 15px;\n}\n\n/* pull tab content away from the sidebar */\n.container-fluid > .content {\n  margin-right: 215px;\n  margin-left: 0px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for sidebar position controls (collapse, pin) */\n\n.nd_sidebar-pinned {\n  position: fixed !important;\n}\n\n.nd_sidebar-pin-clicked {\n  color: rgba(255,0,0,0.8) !important;\n}\n\n.nd_sidebar-pin {\n  float: left;\n  margin-top: 8px;\n  margin-left: -16px;\n  font-size: 15px;\n  color: #555;\n  cursor: pointer;\n}\n\n.nd_sidebar-reset {\n  float: left;\n  margin-top: 27px;\n  margin-left: -16px;\n  font-size: 15px;\n  color: #555;\n  cursor: pointer;\n}\n\n#nd_sidebar-toggle-img-in {\n  float: left;\n  margin-top: -10px;\n  margin-left: -16px;\n  font-size: 15px;\n  color: #555;\n  cursor: pointer;\n}\n\n#nd_sidebar-toggle-img-out {\n  position: fixed;\n  top: 60px;\n  right: 7px;\n  z-index: 1;\n  color: #555;\n  cursor: pointer;\n  display: none;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* style customization for many items which appear in the sidebar */\n\n/* horizontal rule */\n.nd_sidebar-hr {\n  color: black;\n  background-color: black;\n  height: 2px;\n  margin: 12px 0px 12px 0px;\n}\n\n/* text in the sidebar */\n.nd_sidebar-title {\n  margin-left: 10px;\n  margin-top: 6px;\n  margin-bottom: 12px;\n}\n\n/* labels in netmap sidebar (not in a collapser) */\n.nd_sidebar-label {\n  margin-left: 7px;\n}\n\n/* to allow display of tooltip on a disabled control\n   http://jsfiddle.net/cSSUA/209/ */\n.tooltip-wrapper {\n  display: inline-block;\n}\n.tooltip-wrapper .input[disabled] {\n  pointer-events: none;\n}\n\n/* vlan entry box for netmap */\n#nd_vlan-label {\n  margin-left: 5px;\n  margin-bottom: -7px;\n}\n#nd_vlan-label-text {\n  vertical-align: text-bottom;\n}\n#nd_vlan-entry {\n  width: 45px;\n}\n\n/* netmap maximise icon */\n#nd2_netmap-fullscreen {\n  fill: black;\n  font-size: 15px;\n}\n\n/* netmap link labels */\n.nd_netmap-linklabel {\n  pointer-events: none;\n  font-weight: bold;\n}\n\n/* netmap tooltip box */\n#netmap_pane_tooltip {\n  width: unset;\n}\n\n/* pretty toggles have no height on first load - bug? */\ndiv.toggle.btn-small {\n  height: 18px !important;\n}\n\n/* fixup for prepended checkbox in sidebar */\n.nd_searchcheckbox {\n  width: 121px;\n  padding-left: 8px;\n  cursor: pointer;\n}\n\n/* fixup for prepended partial port name checkbox in sidebar */\n.nd_port-partial-checkbox {\n  width: 84px;\n  padding: 0px 0px 0px 5px !important;\n  cursor: pointer;\n}\n\n.nd_port-partial-label {\n  padding: 0px !important;\n}\n\n.nd_port-partial {\n  margin-left: 5px !important;\n  margin-top: -5px;\n  margin-bottom: 5px !important;\n}\n\n/* fixup for prepended invert port name checkbox in sidebar */\n.nd_port-invert-checkbox {\n  width: 30px;\n  padding: 0px 0px 0px 5px !important;\n  cursor: pointer;\n}\n\n.nd_port-invert-label {\n  padding: 0px !important;\n  /* for some reason only .add-on:first-child gets these */\n  -webkit-border-radius: 4px 0 0 4px !important;\n  -moz-border-radius: 4px 0 0 4px !important;\n  border-radius: 4px 0 0 4px !important;\n}\n\n.nd_port-invert {\n  margin-left: 5px !important;\n  margin-top: -5px;\n  margin-bottom: 5px !important;\n}\n\n/* fixup for prepended checkbox in sidebar */\n.nd_sidebar .input-prepend {\n  margin-left: -2px;\n  margin-bottom: 0px;\n}\n\n/* for some reason bootstrap 2.1.0 displays add-on as block - no check supprt? */\n.nd_checkboxlabel {\n  display: inline;\n}\n\n/* placement of form field in sidebar */\n.nd_side-input {\n  margin-left: -3px;\n  width: 151px;\n}\n\n/* placement of form field in sidebar */\n.nd_side-select {\n  margin-left: -3px;\n  width: 165px;\n}\n\n/* nudge the port name/vlan filter over a little (as compared to nd_side-select) */\n#nd_port-query {\n  margin-left: 5px !important;\n  width: 152px;\n}\n.nd_sidebar-topinput {\n  margin-left: 5px !important;\n  width: 152px;\n}\n\n/* set the day/mon/year drop-down width */\n#nd_days-select {\n  margin-top: 4px;\n  width: 56px;\n}\n\n/* set the day/mon/year drop-down width */\n#nd_age-select {\n  margin-top: 4px;\n  width: 95px;\n}\n\n/* set the port state select width */\n#nd_port-state-select {\n  margin-left: -3px;\n  width: 158px;\n}\n\n/* set the MAC format drop-down width */\n#nd_mac-format {\n  margin-top: 4px;\n  width: 155px;\n}\n\n/* set the MAC format drop-down width */\n#nd_node-mac-format {\n  margin-left: -3px;\n  margin-bottom: 4px;\n  width: 165px;\n}\n\n/* sidebar submit button width and spacing */\n\n.nd_netmap-pin-controls {\n  text-align: center;\n}\n\n.nd_netmap-pin-controls button {\n  width: 100%;\n}\n\n.nd_netmap-pin-controls-top-row {\n  padding-bottom: 5px;\n}\n\n#nd_colorby {\n  width: 107px;\n}\n#nd_colorby-label-text {\n  vertical-align: bottom;\n  line-height: 2;\n}\n\n/* when the sidebar submit button DOES NOT HAVE a dropdown */\n.nd_sidebar button:not(.nd_sidebar-btn-drop):not(.nd_sidebar-btn-drop-drop):not(.nd_sidebar-btn-netmap) {\n  margin-top: 9px;\n  margin-left: -2px;\n  width: 165px;\n}\n\n/* FIXME when the sidebar submit button HAS a dropdown */\n.nd_sidebar-btn-drop {\n  width: 138px;\n}\n.nd_sidebar-btn-drop-drop {\n  height: 28px;\n  width: 28px;\n}\n\n/* little icon inside of search input fields */\n.nd_field-clear-icon, .nd_field-copy-icon {\n  position: absolute;\n  margin-left: 140px;\n  margin-top: 5px;\n  z-index: 1;\n  padding: 0px;\n  cursor: pointer;\n}\n\n/* little icon inside of search input fields */\n.nd_field-copy-icon {\n  color: #999;\n}\n\n/* little icon inside of search input fields */\n.nd_field-clear-icon {\n  background-color: #A9DBA9;\n  color: #3A87AD;\n}\n\n /* same for the ports form, but the positioning is slightly different */\n#ports_form .nd_field-clear-icon {\n  margin-left: 149px;\n  margin-top: 5px;\n}\n\n/* change bg color for form fields which are being used in a search */\nform .clearfix.success select {\n  background-color: #A9DBA9;\n}\nform .clearfix.success input {\n  background-color: #A9DBA9;\n}\n\n/* bring sidebar items closer together */\n.nd_inputs-list label {\n  margin-bottom: 1px;\n}\n\n/* nudge content closer to the header labels in the sidebar */\n.nd_inputs-list li:first-child {\n  padding-top: 3px !important;\n}\n\n.nd_sidebar-legend {\n  margin-bottom: 9px;\n}\n\n.nd_netmap-sidebar {\n  margin-top: 0px;\n  margin-left: -5px;\n}\n\n.nd_netmap-sidebar > .input-prepend {\n  margin-left: 5px;\n}\n\n.nd_netmap-sidebar-help {\n  margin-left: 32px;\n}\n\n.icons-ul {\n  margin-left: 22px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* D3 SVG */\n\n/*\n.node circle {\n  fill: #fff;\n  stroke: steelblue;\n  stroke-width: 1.5px;\n}\n\n.node {\n  font: 10px sans-serif;\n}\n\n.link {\n  fill: none;\n  stroke: #eee;\n  stroke-width: 1.5px;\n}\n\n.neighbor {\n  fill: none;\n  stroke: #aaa;\n  stroke-width: 2px;\n  display: none;\n}\n*/\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* dataTables */\n\ndiv.nd_datatables-pager {\n  float: left;\n  margin-left: 50px;\n}\n\ntd.nd_nowrap {\n  white-space: nowrap;\n}\n", "[% IF NOT results.size %]\n<div class=\"span2 alert alert-info\">The job queue is empty.</div>\n[% ELSE %]\n<table class=\"table table-bordered table-condensed table-hover nd_floatinghead\">\n  <thead>\n    <tr>\n      <th class=\"nd_center-cell\">Entered</th>\n      <th class=\"nd_center-cell\">Action</th>\n      <th class=\"nd_center-cell\">Status</th>\n      <th class=\"nd_center-cell\">Device</th>\n      <th class=\"nd_center-cell\">Port</th>\n      <th class=\"nd_center-cell\">Param</th>\n      <th class=\"nd_center-cell\">User</th>\n      <th class=\"nd_center-cell\">Started</th>\n      <th class=\"nd_center-cell\">Finished</th>\n      <th class=\"nd_center-cell\">Action</th>\n    </tr>\n  </thead>\n  <tbody>\n    [% FOREACH row IN results %]\n    <tr\n      [% ' class=\"nd_jobqueueitem success\"' IF row.status == 'done' %]\n      [% ' class=\"nd_jobqueueitem error\"'   IF row.status == 'error' %]\n      [% ' class=\"nd_jobqueueitem info\"'    IF row.status.search('^queued-') %]\n      data-content=\"<pre>[% row.log | html_entity %]</pre>\"\n    >\n      <td class=\"nd_center-cell\">[% row.entered_stamp | html_entity %]</td>\n      <td class=\"nd_center-cell\">\n        [% FOREACH word IN row.action.split('_') %]\n        [% word.ucfirst | html_entity %]&nbsp;\n        [% END %]\n      </td>\n      [% IF row.status.search('^queued-') %]\n      <td class=\"nd_center-cell\">Running on &quot;[% row.status.remove('^queued-') | html_entity %]&quot;</td>\n      [% ELSE %]\n      <td class=\"nd_center-cell\">[% row.status.ucfirst | html_entity %]</td>\n      [% END %]\n      <td class=\"nd_center-cell\">\n        [% IF row.action == 'discover' AND row.status == 'error' %]\n        <a href=\"[% uri_for('/') | none %]?device=[% row.device | uri %]\">[% row.device | html_entity %]</a>\n        [% ELSE %]\n        <a href=\"[% uri_for('/device') | none %]?q=[% row.device | uri %]\">[% row.target.dns || row.device | html_entity %]</a>\n        [% END %]\n      </td>\n      <td class=\"nd_center-cell\">[% row.port | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.subaction | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.username | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.started_stamp | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.finished_stamp | html_entity %]</td>\n      <td class=\"nd_center-cell\">\n        <input data-form=\"del\" name=\"job\" type=\"hidden\" value=\"[% row.job | html_entity %]\">\n        <button class=\"btn nd_adminbutton\" name=\"del\" type=\"submit\"><i class=\"icon-trash text-error\"></i></button>\n      </td>\n    </tr>\n    [% END %]\n  </tbody>\n</table>\n[% END %]\n\n", "  // used by the tabbing interface to make sure the correct\n  // ajax content is loaded\n  var path = 'admin';\n\n  // keep track of timers so we can kill them\n  var nd_timers  = new Array();\n  var timermax   = [% settings.jobqueue_refresh || 5 | html_entity %];\n  var timercache = timermax - 1;\n\n  // this is called by do_search to support local code\n  // which might need to act on the newly inserted content\n  // but which cannot use jQuery delegation via .on()\n  function inner_view_processing(tab) {\n\n    // reload this table every 5 seconds\n    if (tab == 'jobqueue'\n        && $('#nd_countdown-control-icon').hasClass('icon-play')) {\n\n        $('#nd_countdown').text(timermax);\n\n        // add new timers\n        for (var i = timercache; i > 0; i--) {\n          nd_timers.push(setTimeout(function() {\n            $('#nd_countdown').text(timercache);\n            timercache = timercache - 1;\n          }, ((timermax * 1000) - (i * 1000)) ));\n        }\n\n        nd_timers.push(setTimeout(function() {\n          // clear any running timers\n          for (var i = 0; i < nd_timers.length; i++) {\n              clearTimeout(nd_timers[i]);\n          }\n\n          // reset the timer cache\n          timercache = timermax - 1;\n\n          // reload the tab content in...\n          $('#' + tab + '_form').trigger('submit');\n        }, (timermax * 1000)));\n    }\n\n    // activate typeahead on the topo boxes\n    $('.nd_topo_dev').autocomplete({\n      source: uri_base + '/ajax/data/deviceip/typeahead'\n      ,delay: 150\n      ,minLength: 0\n    });\n\n    // activate typeahead on the topo boxes\n    $('.nd_topo_port.nd_topo_dev1').autocomplete({\n      source: function (request, response)  {\n        var query = $('.nd_topo_dev1').serialize();\n        return $.get( uri_base + '/ajax/data/port/typeahead', query, function (data) {\n          return response(data);\n        });\n      }\n      ,delay: 150\n      ,minLength: 0\n    });\n\n    // activate typeahead on the topo boxes\n    $('.nd_topo_port.nd_topo_dev2').autocomplete({\n      source: function (request, response)  {\n        var query = $('.nd_topo_dev2').serialize();\n        return $.get( uri_base + '/ajax/data/port/typeahead', query, function (data) {\n          return response(data);\n        });\n      }\n      ,delay: 150\n      ,minLength: 0\n    });\n\n    // activate modals and tooltips\n    $('.nd_modal').modal({show: false});\n    $(\"[rel=tooltip]\").tooltip({live: true});\n  }\n\n  // on load, establish global delegations for now and future\n  $(document).ready(function() {\n    var tab = '[% task.tag | html_entity %]'\n    var target = '#' + tab + '_pane';\n\n    // get all devices on device input focus\n    $(target).on('focus', '.nd_topo_dev', function(e) {\n      $(this).autocomplete('search', '%') });\n    $(target).on('click', '.nd_topo_dev_caret', function(e) {\n      $(this).siblings('.nd_topo_dev').autocomplete('search', '%') });\n\n    // get all ports on port input focus\n    $(target).on('focus', '.nd_topo_port', function(e) {\n      $(this).autocomplete('search') });\n    $(target).on('click', '.nd_topo_port_caret', function(e) {\n      $(this).siblings('.nd_topo_port').val('');\n      $(this).siblings('.nd_topo_port').autocomplete('search');\n    });\n\n    // job control refresh icon should reload the page\n    $('#nd_countdown-refresh').click(function(event) {\n      event.preventDefault();\n      for (var i = 0; i < nd_timers.length; i++) {\n          clearTimeout(nd_timers[i]);\n      }\n      $('#' + tab + '_form').trigger('submit');\n    });\n\n    // job control pause/play icon switcheroo\n    $('#nd_countdown-control').click(function(event) {\n      event.preventDefault();\n      var icon = $('#nd_countdown-control-icon');\n      icon.toggleClass('icon-pause icon-play text-error text-success');\n\n      if (icon.hasClass('icon-pause')) {\n        for (var i = 0; i < nd_timers.length; i++) {\n            clearTimeout(nd_timers[i]);\n        }\n        $('#nd_countdown').text('0');\n      }\n      else {\n        $('#' + tab + '_form').trigger('submit');\n      }\n    });\n\n    // activity for admin task tables\n    // dynamically bind to all forms in the table\n    $('.content').on('click', '.nd_adminbutton', function(event) {\n      // stop form from submitting normally\n      event.preventDefault();\n\n      // clear any running timers\n      for (var i = 0; i < nd_timers.length; i++) {\n          clearTimeout(nd_timers[i]);\n      }\n\n      // what purpose - add/update/del\n      var mode = $(this).attr('name');\n\n      // submit the query and put results into the tab pane\n      $.ajax({\n        type: 'POST'\n        ,async: true\n        ,dataType: 'html'\n        ,url: uri_base + '/ajax/control/admin/' + tab + '/' + mode\n        ,data: $(this).closest('tr').find('input[data-form=\"' + mode + '\"],select[data-form=\"' + mode + '\"]').serializeArray()\n        ,beforeSend: function() {\n          if (mode == 'add' || mode == 'delete') {\n            $(target).html(\n              '<div class=\"span2 alert\">Request submitted...</div>'\n            );\n          }\n        }\n        ,success: function() {\n          if (mode == 'add') {\n            toastr.success('Added record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else if (mode == 'delete') {\n            toastr.success('Deleted record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else {\n            toastr.success('Updated record');\n          }\n        }\n        // TODO: fix sanity_ok in Netdisco Web\n        ,error: function() {\n          if (mode == 'add') {\n            toastr.error('Failed to add record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else if (mode == 'delete') {\n            toastr.error('Failed to delete record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else {\n            toastr.error('Failed to update record');\n          }\n        }\n      });\n    });\n\n    // bind qtip2 to show the event log output\n    $(target).on('mouseover', '.nd_jobqueueitem', function(event) {\n      $(this).qtip({\n        overwrite: false,\n        content: {\n          attr: 'data-content'\n        },\n        show: {\n          event: event.type,\n          ready: true,\n          delay: 100\n        },\n        position: {\n          my: 'top center',\n          at: 'bottom center',\n          target: false\n        },\n        style: {\n          classes: 'qtip-cluetip qtip-rounded nd_qtip-unconstrained'\n        }\n      });\n    });\n  });\n"], "fixing_code": ["/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* style common to all pages in the site */\n\n/* for the fixed navbar make sure content stops short of page top*/\nbody {\n  padding-top: 50px;\n}\n\n.navbar-inner .container {\n  background: url(../images/navbar_disco.png) no-repeat;\n}\n\n/* used for icons in sidebar search buttons */\n.nd_navbar-icon {\n  vertical-align: sub;\n  margin-top: 4px !important;\n  margin-right: 7px !important;\n  cursor: pointer;\n}\n\n/* careful align of navbar search button and menu */\n.nd_navbar-search-group {\n  margin-top: 0px !important;\n}\n.nd_navbar-search-icon {\n  color: #999;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n.nd_navbar-search-caret {\n  padding-top: 10px !important;\n  padding-left: 5px !important;\n  padding-right: 5px !important;\n}\n\n/* for the \"logged in as...\" text */\n.nd_navbar-text {\n  color: #666;\n  padding-top: 11px;\n}\n\n/* on both main content and sidebar, default is hidden */\n.tab-content {\n  overflow: visible;\n}\n\n/* ajax results should fill all available */\n.tab-content table {\n  width: 100%;\n}\n\n/* results table header should have a background, for floatThead */\ndiv.content > div.tab-content table.nd_floatinghead thead {\n  background-color: floralWhite;\n}\n\n/* jquery ui autocomplete scrollable */\n.ui-autocomplete {\n  max-height: 200px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n\n/* jstree scrollable */\n\n.nd_scrollable {\n    height: 85vh;\n    overflow: auto;\n}\n\n#snmpPartialSearch {\n  margin-top: -3px;\n}\n\n/* fake looks for form submit buttons embedded in bootstrap dropdowns */\n.nd_btn-link {\n  display: block;\n  padding: 2px 20px;\n  clear: both;\n  font-weight: normal;\n  line-height: 18px;\n  color: #333333;\n  white-space: nowrap;\n  text-decoration: none;\n  margin-top: 0px !important;\n  width: 100%;\n  text-align: left;\n  margin-left: -1px;\n}\n\n.nd_btn-link:hover, .nd_btn-link:focus {\n  text-decoration: none;\n  color: #ffffff;\n  background-color: #0081c2;\n  background-repeat: repeat-x;\n  text-shadow: none;\n}\n\n/* to be added to qtip-bootstrap class */\n.nd_qtip-unconstrained {\n  min-width: 0;\n  max-width: none;\n}\n\n.qtip-content {\n  font-size: 15px;\n  font-family: monospace;\n  white-space: pre;\n}\n\n/* for where min-width is set but we don't want it */\n.nd_no-min-width {\n  min-width: 0px;\n}\n\n/* for when hidden modals interfere with mouse actions on higher elements */\n.nd_deep-horizon {\n  z-index: -1000;\n}\n\n/* for when we pinch h4 styling but don't want bold */\n.nd_unbolden {\n  font-weight: normal;\n}\n\n/* for System Information bar */\n.nd_sysinfo-heading {\n  background-color: #eeeeee;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles to adjust the hero box used for homepage + login */\n\n/* space between hero box and navbar */\n.nd_hero-row {\n  margin-top: 50px;\n}\n\n/* alter proportions of hero unit to make it \"tighter\" on content */\n.hero-unit {\n  padding: 30px 60px 40px 90px;\n}\n\n/* push user/pass/login form down+away from the Netdisco banner text */\n.nd_login-form {\n  margin-top: 15px;\n  margin-bottom: 0px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for device inventory */\n\n.nd_inventory-table-head {\n  text-align: center;\n  color: lightSlateGray;\n  margin-top: 6px;\n  margin-bottom: 3px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for links in results tables */\n\n/* make the whole cell become a hyperlink in results table */\n.nd_linkcell {\n  display: block;\n  padding: 0px;\n  height: 100%;\n}\n\n/* still a link, but styled like normal text */\n.nd_stealth-link {\n  text-decoration: none !important;\n  color: #404040;\n}\n\n/* make room for the port log icon */\n.nd_this-port-only {\n  margin-right: 15px;\n}\n/* nudge cell content to the right when port_control controls are enabled */\n.nd_editable-cell > .nd_this-port-only {\n  margin-left: 14px;\n  margin-right: 60px;\n}\n.nd_editable-cell > .nd_port-only-first {\n  margin-left: 5px;\n}\n\n.nd_editable-cell > .nd_editable-cell-content {\n  margin-right: 25px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles to position table cell content */\n\n.table td {\n  vertical-align: baseline;\n}\n\n.table .nd_center-cell {\n  text-align: center;\n}\n\ntd.nd_devport-icon i {\n  line-height: 18px;\n}\n\n/* undo nd_center-cell when in a modial dialog (which lives in table cell) */\n.table .nd_center-cell .modal-body {\n  text-align: left;\n}\n\n/* fix layout of form fields inside the (topology) table */\ntd div.input-append {\n  margin-bottom: 0px;\n}\n\n/* admin buttons in the device details view */\ntd > form.nd_inline-form {\n  margin-bottom: 2px;\n}\n\n/* pull right admin buttons in the device details view */\n.nd_pull-right-admin-button {\n  margin-right: 4px;\n}\n\n/* fix layout of form fields inside the (pseudo devices) table */\n.nd_center-cell input {\n  margin-bottom: 0px;\n}\n\n/* with two forms inside one cell, make the submit buttons side-by-side */\n.nd_inline-form {\n  display: inline;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for \"tabs\" and surrounding content */\n\n\n/* add a small bottom margin (gutter) below all pages */\n#nd_search-results {\n  margin-bottom: 10px;\n}\n\n/* for any label which we want to appear alongside tabs, floated to the right */\n#nd_device-name {\n  float: right;\n  margin-bottom: 0px;\n  margin-top: 9px;\n  font-weight: bold;\n  color: #6D5720;\n}\n\n/* reset to normal weight for the download as CSV icon */\n#nd_csv-download {\n  font-weight: normal;\n}\n\n#nd_csv-download:hover, #nd_sidebar-reset-link:hover {\n  text-decoration: none;\n}\n\n/* badge for pseudo devices layer three toggle */\n.nd_layer-three-link {\n  text-decoration: none !important;\n  display: inline-block;\n  margin-left: -4px;\n}\n\n/* for the job control admin page play/pause links */\n#nd_countdown-refresh:hover, #nd_countdown-control:hover {\n  text-decoration: none;\n}\n\n/* when there's only one tab (report, task etc) change the text color */\n.nd_single-tab {\n  color: rgb(187,112,0) !important;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* style for port_control controls */\n\n/* edit icon in details tab is in the label (not content) cell so nudge to RHS*/\n.nd_device-details-edit {\n  float: right !important;\n  font-size: 14px;\n}\n\n/* port admin up/down control */\n.nd_edit-icon, .nd_hand-icon {\n  cursor: pointer;\n  float: right;\n  display: none;\n}\n\n.nd_hand-icon {\n  position: relative;\n  margin-right: 4px;\n}\n\n/* port admin log view */\n.nd_log-icon {\n  cursor: pointer;\n  color: black;\n  float: right;\n  padding-left: 10px;\n  margin-top: 2px;\n  position: relative;\n}\n.nd_log-icon:hover, .nd_log-icon:focus {\n  text-decoration: none;\n  color: black;\n}\n\n/* port power control */\n.nd_power-icon {\n  cursor: pointer;\n}\n\n/* the port power icon, whether it's on or off */\n.icon-off {\n  vertical-align: middle;\n  color: darkRed;\n}\n\n/* change color of icon from default of red (which is OK for power-off) */\n.nd_power-on {\n  color: darkGreen;\n}\n\n/* style of editable content in any table - yellow background */\n[contenteditable]:focus {\n  background: #FFFFD3 !important;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for collapsing lists - sidebar or main table cell content */\n\n/* sidebar collapser is clickable and deep grey */\n.nd_collapser {\n  cursor: pointer;\n  color: #0088CC;\n}\n\n/* vlans collapser also clickable and deep grey but with no link styling */\n.nd_collapse-vlans {\n  cursor: pointer;\n  color: #0088CC;\n  text-decoration: none !important;\n}\n\n/* set default state of collapsible lists as collapsed (hidden) */\n.nd_collapse-pre-hidden {\n  display: none;\n}\n\n/* for the tagged vlans total when hiding the full list */\n.nd_vlan-total {\n  float: right;\n}\n\n/* little up/down chevron to the right of some collapsed list */\n.nd_arrow-up-down-right {\n  float: right;\n  margin-top: 1px;\n  margin-right: 1px;\n  color: #555;\n}\n\n/* little up arrow to the left of a label for collapsed list */\n.nd_arrow-up-down-left {\n  float: left;\n  margin-right: 6px;\n  color: #555;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for sidebar placement and sizing */\n\n/* make the sidebar fixed on the screen */\n.container-fluid > .nd_sidebar {\n  position: absolute;\n  right: 20px;\n  width: 205px;\n  left: auto;\n}\n\n/* nudge content in the sidebar closer to the left */\n.nd_sidebar-form {\n  padding-left: 0px;\n  margin-top: -9px;\n  margin-bottom: 0px;\n}\n\n/* reduce padding at the bottom of the sidebar content */\n.container-fluid > .nd_sidebar > .well {\n  padding-bottom: 15px;\n}\n\n/* pull tab content away from the sidebar */\n.container-fluid > .content {\n  margin-right: 215px;\n  margin-left: 0px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* styles for sidebar position controls (collapse, pin) */\n\n.nd_sidebar-pinned {\n  position: fixed !important;\n}\n\n.nd_sidebar-pin-clicked {\n  color: rgba(255,0,0,0.8) !important;\n}\n\n.nd_sidebar-pin {\n  float: left;\n  margin-top: 8px;\n  margin-left: -16px;\n  font-size: 15px;\n  color: #555;\n  cursor: pointer;\n}\n\n.nd_sidebar-reset {\n  float: left;\n  margin-top: 27px;\n  margin-left: -16px;\n  font-size: 15px;\n  color: #555;\n  cursor: pointer;\n}\n\n#nd_sidebar-toggle-img-in {\n  float: left;\n  margin-top: -10px;\n  margin-left: -16px;\n  font-size: 15px;\n  color: #555;\n  cursor: pointer;\n}\n\n#nd_sidebar-toggle-img-out {\n  position: fixed;\n  top: 60px;\n  right: 7px;\n  z-index: 1;\n  color: #555;\n  cursor: pointer;\n  display: none;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* style customization for many items which appear in the sidebar */\n\n/* horizontal rule */\n.nd_sidebar-hr {\n  color: black;\n  background-color: black;\n  height: 2px;\n  margin: 12px 0px 12px 0px;\n}\n\n/* text in the sidebar */\n.nd_sidebar-title {\n  margin-left: 10px;\n  margin-top: 6px;\n  margin-bottom: 12px;\n}\n\n/* labels in netmap sidebar (not in a collapser) */\n.nd_sidebar-label {\n  margin-left: 7px;\n}\n\n/* to allow display of tooltip on a disabled control\n   http://jsfiddle.net/cSSUA/209/ */\n.tooltip-wrapper {\n  display: inline-block;\n}\n.tooltip-wrapper .input[disabled] {\n  pointer-events: none;\n}\n\n/* vlan entry box for netmap */\n#nd_vlan-label {\n  margin-left: 5px;\n  margin-bottom: -7px;\n}\n#nd_vlan-label-text {\n  vertical-align: text-bottom;\n}\n#nd_vlan-entry {\n  width: 45px;\n}\n\n/* netmap maximise icon */\n#nd2_netmap-fullscreen {\n  fill: black;\n  font-size: 15px;\n}\n\n/* netmap link labels */\n.nd_netmap-linklabel {\n  pointer-events: none;\n  font-weight: bold;\n}\n\n/* netmap tooltip box */\n#netmap_pane_tooltip {\n  width: unset;\n}\n\n/* pretty toggles have no height on first load - bug? */\ndiv.toggle.btn-small {\n  height: 18px !important;\n}\n\n/* fixup for prepended checkbox in sidebar */\n.nd_searchcheckbox {\n  width: 121px;\n  padding-left: 8px;\n  cursor: pointer;\n}\n\n/* fixup for prepended partial port name checkbox in sidebar */\n.nd_port-partial-checkbox {\n  width: 84px;\n  padding: 0px 0px 0px 5px !important;\n  cursor: pointer;\n}\n\n.nd_port-partial-label {\n  padding: 0px !important;\n}\n\n.nd_port-partial {\n  margin-left: 5px !important;\n  margin-top: -5px;\n  margin-bottom: 5px !important;\n}\n\n/* fixup for prepended invert port name checkbox in sidebar */\n.nd_port-invert-checkbox {\n  width: 30px;\n  padding: 0px 0px 0px 5px !important;\n  cursor: pointer;\n}\n\n.nd_port-invert-label {\n  padding: 0px !important;\n  /* for some reason only .add-on:first-child gets these */\n  -webkit-border-radius: 4px 0 0 4px !important;\n  -moz-border-radius: 4px 0 0 4px !important;\n  border-radius: 4px 0 0 4px !important;\n}\n\n.nd_port-invert {\n  margin-left: 5px !important;\n  margin-top: -5px;\n  margin-bottom: 5px !important;\n}\n\n/* fixup for prepended checkbox in sidebar */\n.nd_sidebar .input-prepend {\n  margin-left: -2px;\n  margin-bottom: 0px;\n}\n\n/* for some reason bootstrap 2.1.0 displays add-on as block - no check supprt? */\n.nd_checkboxlabel {\n  display: inline;\n}\n\n/* placement of form field in sidebar */\n.nd_side-input {\n  margin-left: -3px;\n  width: 151px;\n}\n\n/* placement of form field in sidebar */\n.nd_side-select {\n  margin-left: -3px;\n  width: 165px;\n}\n\n/* nudge the port name/vlan filter over a little (as compared to nd_side-select) */\n#nd_port-query {\n  margin-left: 5px !important;\n  width: 152px;\n}\n.nd_sidebar-topinput {\n  margin-left: 5px !important;\n  width: 152px;\n}\n\n/* set the day/mon/year drop-down width */\n#nd_days-select {\n  margin-top: 4px;\n  width: 56px;\n}\n\n/* set the day/mon/year drop-down width */\n#nd_age-select {\n  margin-top: 4px;\n  width: 95px;\n}\n\n/* set the port state select width */\n#nd_port-state-select {\n  margin-left: -3px;\n  width: 158px;\n}\n\n/* set the MAC format drop-down width */\n#nd_mac-format {\n  margin-top: 4px;\n  width: 155px;\n}\n\n/* set the MAC format drop-down width */\n#nd_node-mac-format {\n  margin-left: -3px;\n  margin-bottom: 4px;\n  width: 165px;\n}\n\n/* sidebar submit button width and spacing */\n\n.nd_netmap-pin-controls {\n  text-align: center;\n}\n\n.nd_netmap-pin-controls button {\n  width: 100%;\n}\n\n.nd_netmap-pin-controls-top-row {\n  padding-bottom: 5px;\n}\n\n#nd_colorby {\n  width: 107px;\n}\n#nd_colorby-label-text {\n  vertical-align: bottom;\n  line-height: 2;\n}\n\n/* when the sidebar submit button DOES NOT HAVE a dropdown */\n.nd_sidebar button:not(.nd_sidebar-btn-drop):not(.nd_sidebar-btn-drop-drop):not(.nd_sidebar-btn-netmap) {\n  margin-top: 9px;\n  margin-left: -2px;\n  width: 165px;\n}\n\n/* FIXME when the sidebar submit button HAS a dropdown */\n.nd_sidebar-btn-drop {\n  width: 138px;\n}\n.nd_sidebar-btn-drop-drop {\n  height: 28px;\n  width: 28px;\n}\n\n/* little icon inside of search input fields */\n.nd_field-clear-icon, .nd_field-copy-icon {\n  position: absolute;\n  margin-left: 140px;\n  margin-top: 5px;\n  z-index: 1;\n  padding: 0px;\n  cursor: pointer;\n}\n\n/* little icon inside of search input fields */\n.nd_field-copy-icon {\n  color: #999;\n}\n\n/* little icon inside of search input fields */\n.nd_field-clear-icon {\n  background-color: #A9DBA9;\n  color: #3A87AD;\n}\n\n /* same for the ports form, but the positioning is slightly different */\n#ports_form .nd_field-clear-icon {\n  margin-left: 149px;\n  margin-top: 5px;\n}\n\n/* change bg color for form fields which are being used in a search */\nform .clearfix.success select {\n  background-color: #A9DBA9;\n}\nform .clearfix.success input {\n  background-color: #A9DBA9;\n}\n\n/* bring sidebar items closer together */\n.nd_inputs-list label {\n  margin-bottom: 1px;\n}\n\n/* nudge content closer to the header labels in the sidebar */\n.nd_inputs-list li:first-child {\n  padding-top: 3px !important;\n}\n\n.nd_sidebar-legend {\n  margin-bottom: 9px;\n}\n\n.nd_netmap-sidebar {\n  margin-top: 0px;\n  margin-left: -5px;\n}\n\n.nd_netmap-sidebar > .input-prepend {\n  margin-left: 5px;\n}\n\n.nd_netmap-sidebar-help {\n  margin-left: 32px;\n}\n\n.icons-ul {\n  margin-left: 22px;\n}\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* D3 SVG */\n\n/*\n.node circle {\n  fill: #fff;\n  stroke: steelblue;\n  stroke-width: 1.5px;\n}\n\n.node {\n  font: 10px sans-serif;\n}\n\n.link {\n  fill: none;\n  stroke: #eee;\n  stroke-width: 1.5px;\n}\n\n.neighbor {\n  fill: none;\n  stroke: #aaa;\n  stroke-width: 2px;\n  display: none;\n}\n*/\n\n/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */\n/* dataTables */\n\ndiv.nd_datatables-pager {\n  float: left;\n  margin-left: 50px;\n}\n\ntd.nd_nowrap {\n  white-space: nowrap;\n}\n", "[% IF NOT results.size %]\n<div class=\"span2 alert alert-info\">The job queue is empty.</div>\n[% ELSE %]\n<table class=\"table table-bordered table-condensed table-hover nd_floatinghead\">\n  <thead>\n    <tr>\n      <th class=\"nd_center-cell\">Entered</th>\n      <th class=\"nd_center-cell\">Action</th>\n      <th class=\"nd_center-cell\">Status</th>\n      <th class=\"nd_center-cell\">Device</th>\n      <th class=\"nd_center-cell\">Port</th>\n      <th class=\"nd_center-cell\">Param</th>\n      <th class=\"nd_center-cell\">User</th>\n      <th class=\"nd_center-cell\">Started</th>\n      <th class=\"nd_center-cell\">Finished</th>\n      <th class=\"nd_center-cell\">Action</th>\n    </tr>\n  </thead>\n  <tbody>\n    [% FOREACH row IN results %]\n    <tr\n      [% ' class=\"nd_jobqueueitem success\"' IF row.status == 'done' %]\n      [% ' class=\"nd_jobqueueitem error\"'   IF row.status == 'error' %]\n      [% ' class=\"nd_jobqueueitem info\"'    IF row.status.search('^queued-') %]\n      data-content=\"[% row.log | html_entity %]\"\n    >\n      <td class=\"nd_center-cell\">[% row.entered_stamp | html_entity %]</td>\n      <td class=\"nd_center-cell\">\n        [% FOREACH word IN row.action.split('_') %]\n        [% word.ucfirst | html_entity %]&nbsp;\n        [% END %]\n      </td>\n      [% IF row.status.search('^queued-') %]\n      <td class=\"nd_center-cell\">Running on &quot;[% row.status.remove('^queued-') | html_entity %]&quot;</td>\n      [% ELSE %]\n      <td class=\"nd_center-cell\">[% row.status.ucfirst | html_entity %]</td>\n      [% END %]\n      <td class=\"nd_center-cell\">\n        [% IF row.action == 'discover' AND row.status == 'error' %]\n        <a href=\"[% uri_for('/') | none %]?device=[% row.device | uri %]\">[% row.device | html_entity %]</a>\n        [% ELSE %]\n        <a href=\"[% uri_for('/device') | none %]?q=[% row.device | uri %]\">[% row.target.dns || row.device | html_entity %]</a>\n        [% END %]\n      </td>\n      <td class=\"nd_center-cell\">[% row.port | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.subaction | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.username | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.started_stamp | html_entity %]</td>\n      <td class=\"nd_center-cell\">[% row.finished_stamp | html_entity %]</td>\n      <td class=\"nd_center-cell\">\n        <input data-form=\"del\" name=\"job\" type=\"hidden\" value=\"[% row.job | html_entity %]\">\n        <button class=\"btn nd_adminbutton\" name=\"del\" type=\"submit\"><i class=\"icon-trash text-error\"></i></button>\n      </td>\n    </tr>\n    [% END %]\n  </tbody>\n</table>\n[% END %]\n\n", "  // used by the tabbing interface to make sure the correct\n  // ajax content is loaded\n  var path = 'admin';\n\n  // keep track of timers so we can kill them\n  var nd_timers  = new Array();\n  var timermax   = [% settings.jobqueue_refresh || 5 | html_entity %];\n  var timercache = timermax - 1;\n\n  // this is called by do_search to support local code\n  // which might need to act on the newly inserted content\n  // but which cannot use jQuery delegation via .on()\n  function inner_view_processing(tab) {\n\n    // reload this table every 5 seconds\n    if (tab == 'jobqueue'\n        && $('#nd_countdown-control-icon').hasClass('icon-play')) {\n\n        $('#nd_countdown').text(timermax);\n\n        // add new timers\n        for (var i = timercache; i > 0; i--) {\n          nd_timers.push(setTimeout(function() {\n            $('#nd_countdown').text(timercache);\n            timercache = timercache - 1;\n          }, ((timermax * 1000) - (i * 1000)) ));\n        }\n\n        nd_timers.push(setTimeout(function() {\n          // clear any running timers\n          for (var i = 0; i < nd_timers.length; i++) {\n              clearTimeout(nd_timers[i]);\n          }\n\n          // reset the timer cache\n          timercache = timermax - 1;\n\n          // reload the tab content in...\n          $('#' + tab + '_form').trigger('submit');\n        }, (timermax * 1000)));\n    }\n\n    // activate typeahead on the topo boxes\n    $('.nd_topo_dev').autocomplete({\n      source: uri_base + '/ajax/data/deviceip/typeahead'\n      ,delay: 150\n      ,minLength: 0\n    });\n\n    // activate typeahead on the topo boxes\n    $('.nd_topo_port.nd_topo_dev1').autocomplete({\n      source: function (request, response)  {\n        var query = $('.nd_topo_dev1').serialize();\n        return $.get( uri_base + '/ajax/data/port/typeahead', query, function (data) {\n          return response(data);\n        });\n      }\n      ,delay: 150\n      ,minLength: 0\n    });\n\n    // activate typeahead on the topo boxes\n    $('.nd_topo_port.nd_topo_dev2').autocomplete({\n      source: function (request, response)  {\n        var query = $('.nd_topo_dev2').serialize();\n        return $.get( uri_base + '/ajax/data/port/typeahead', query, function (data) {\n          return response(data);\n        });\n      }\n      ,delay: 150\n      ,minLength: 0\n    });\n\n    // activate modals and tooltips\n    $('.nd_modal').modal({show: false});\n    $(\"[rel=tooltip]\").tooltip({live: true});\n  }\n\n  // on load, establish global delegations for now and future\n  $(document).ready(function() {\n    var tab = '[% task.tag | html_entity %]'\n    var target = '#' + tab + '_pane';\n\n    // get all devices on device input focus\n    $(target).on('focus', '.nd_topo_dev', function(e) {\n      $(this).autocomplete('search', '%') });\n    $(target).on('click', '.nd_topo_dev_caret', function(e) {\n      $(this).siblings('.nd_topo_dev').autocomplete('search', '%') });\n\n    // get all ports on port input focus\n    $(target).on('focus', '.nd_topo_port', function(e) {\n      $(this).autocomplete('search') });\n    $(target).on('click', '.nd_topo_port_caret', function(e) {\n      $(this).siblings('.nd_topo_port').val('');\n      $(this).siblings('.nd_topo_port').autocomplete('search');\n    });\n\n    // job control refresh icon should reload the page\n    $('#nd_countdown-refresh').click(function(event) {\n      event.preventDefault();\n      for (var i = 0; i < nd_timers.length; i++) {\n          clearTimeout(nd_timers[i]);\n      }\n      $('#' + tab + '_form').trigger('submit');\n    });\n\n    // job control pause/play icon switcheroo\n    $('#nd_countdown-control').click(function(event) {\n      event.preventDefault();\n      var icon = $('#nd_countdown-control-icon');\n      icon.toggleClass('icon-pause icon-play text-error text-success');\n\n      if (icon.hasClass('icon-pause')) {\n        for (var i = 0; i < nd_timers.length; i++) {\n            clearTimeout(nd_timers[i]);\n        }\n        $('#nd_countdown').text('0');\n      }\n      else {\n        $('#' + tab + '_form').trigger('submit');\n      }\n    });\n\n    // activity for admin task tables\n    // dynamically bind to all forms in the table\n    $('.content').on('click', '.nd_adminbutton', function(event) {\n      // stop form from submitting normally\n      event.preventDefault();\n\n      // clear any running timers\n      for (var i = 0; i < nd_timers.length; i++) {\n          clearTimeout(nd_timers[i]);\n      }\n\n      // what purpose - add/update/del\n      var mode = $(this).attr('name');\n\n      // submit the query and put results into the tab pane\n      $.ajax({\n        type: 'POST'\n        ,async: true\n        ,dataType: 'html'\n        ,url: uri_base + '/ajax/control/admin/' + tab + '/' + mode\n        ,data: $(this).closest('tr').find('input[data-form=\"' + mode + '\"],select[data-form=\"' + mode + '\"]').serializeArray()\n        ,beforeSend: function() {\n          if (mode == 'add' || mode == 'delete') {\n            $(target).html(\n              '<div class=\"span2 alert\">Request submitted...</div>'\n            );\n          }\n        }\n        ,success: function() {\n          if (mode == 'add') {\n            toastr.success('Added record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else if (mode == 'delete') {\n            toastr.success('Deleted record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else {\n            toastr.success('Updated record');\n          }\n        }\n        // TODO: fix sanity_ok in Netdisco Web\n        ,error: function() {\n          if (mode == 'add') {\n            toastr.error('Failed to add record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else if (mode == 'delete') {\n            toastr.error('Failed to delete record');\n            $('#' + tab + '_form').trigger('submit');\n          }\n          else {\n            toastr.error('Failed to update record');\n          }\n        }\n      });\n    });\n\n    // bind qtip2 to show the event log output\n    $(target).on('mouseover', '.nd_jobqueueitem', function(event) {\n      $(this).qtip({\n        overwrite: false,\n        content: {\n          text: $('<span/>').text( $(this).attr(\"data-content\") ).html()\n        },\n        show: {\n          event: event.type,\n          ready: true,\n          delay: 100\n        },\n        position: {\n          my: 'top center',\n          at: 'bottom center',\n          target: false\n        },\n        style: {\n          classes: 'qtip-cluetip qtip-rounded nd_qtip-unconstrained'\n        }\n      });\n    });\n  });\n"], "filenames": ["share/public/css/netdisco.css", "share/views/ajax/admintask/jobqueue.tt", "share/views/js/admintask.js"], "buggy_code_start_loc": [106, 25, 187], "buggy_code_end_loc": [108, 26, 188], "fixing_code_start_loc": [106, 25, 187], "fixing_code_end_loc": [109, 26, 188], "type": "CWE-79", "message": "Netdisco before v2.063000 was discovered to contain a cross-site scripting (XSS) vulnerability via the component /Web/TypeAhead.pm.", "other": {"cve": {"id": "CVE-2023-37623", "sourceIdentifier": "cve@mitre.org", "published": "2023-07-26T20:15:12.670", "lastModified": "2023-08-02T00:30:17.953", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Netdisco before v2.063000 was discovered to contain a cross-site scripting (XSS) vulnerability via the component /Web/TypeAhead.pm."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:netdisco:netdisco:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.063000", "matchCriteriaId": "49A130E0-9B38-4DA0-82CD-4B2B3376A38F"}]}]}], "references": [{"url": "https://github.com/benjaminpsinclair/Netdisco-2023-Advisory", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://github.com/benjaminpsinclair/Netdisco-CVE", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://github.com/netdisco/netdisco/commit/39562e0633a2472d50f7f33e69c36da4ad1fbfa3", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/netdisco/netdisco/commit/9f4401f2fb00c84210cd551b97c8ad60e78c71e0", "source": "cve@mitre.org", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/netdisco/netdisco/commit/39562e0633a2472d50f7f33e69c36da4ad1fbfa3"}}