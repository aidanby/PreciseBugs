{"buggy_code": ["<?php\n\n/**\n * ---------------------------------------------------------------------\n *\n * GLPI - Gestionnaire Libre de Parc Informatique\n *\n * http://glpi-project.org\n *\n * @copyright 2015-2022 Teclib' and contributors.\n * @copyright 2003-2014 by the INDEPNET Development Team.\n * @licence   https://www.gnu.org/licenses/gpl-3.0.html\n *\n * ---------------------------------------------------------------------\n *\n * LICENSE\n *\n * This file is part of GLPI.\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n *\n * ---------------------------------------------------------------------\n */\n\n/**\n * @since 0.84\n */\n\ninclude('../inc/includes.php');\n\nSession::checkRight(\"config\", UPDATE);\n\n$plugin = new Plugin();\n\nif (\n    isset($_POST['action'])\n    && isset($_POST['id'])\n) {\n    if (method_exists($plugin, $_POST['action'])) {\n        call_user_func([$plugin, $_POST['action']], $_POST['id']);\n    } else {\n        echo \"Action \" . $_POST['action'] . \" undefined\";\n    }\n    Html::back();\n}\n\nHtml::displayErrorAndDie('Lost');\n"], "fixing_code": ["<?php\n\n/**\n * ---------------------------------------------------------------------\n *\n * GLPI - Gestionnaire Libre de Parc Informatique\n *\n * http://glpi-project.org\n *\n * @copyright 2015-2022 Teclib' and contributors.\n * @copyright 2003-2014 by the INDEPNET Development Team.\n * @licence   https://www.gnu.org/licenses/gpl-3.0.html\n *\n * ---------------------------------------------------------------------\n *\n * LICENSE\n *\n * This file is part of GLPI.\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n *\n * ---------------------------------------------------------------------\n */\n\n/**\n * @since 0.84\n */\n\ninclude('../inc/includes.php');\n\nSession::checkRight(\"config\", UPDATE);\n\n$plugin = new Plugin();\n\n$id     = isset($_POST['id']) && is_numeric($_POST['id']) ? (int)$_POST['id'] : null;\n$action = $id > 0 && isset($_POST['action']) ? $_POST['action'] : null;\n\nswitch ($action) {\n    case 'install':\n        $plugin->install($id);\n        break;\n    case 'activate':\n        $plugin->activate($id);\n        break;\n    case 'unactivate':\n        $plugin->unactivate($id);\n        break;\n    case 'uninstall':\n        $plugin->uninstall($id);\n        break;\n    case 'clean':\n        $plugin->clean($id);\n        break;\n    default:\n        Html::displayErrorAndDie('Lost');\n        break;\n}\n\nHtml::back();\n"], "filenames": ["front/plugin.form.php"], "buggy_code_start_loc": [46], "buggy_code_end_loc": [59], "fixing_code_start_loc": [46], "fixing_code_end_loc": [71], "type": "CWE-89", "message": "GLPI stands for Gestionnaire Libre de Parc Informatique and is a Free Asset and IT Management Software package, that provides ITIL Service Desk features, licenses tracking and software auditing. In affected versions request input is not properly validated in the plugin controller and can be used to access low-level API of Plugin class. An attacker can, for instance, alter database data. Attacker must have \"General setup\" update rights to be able to perform this attack. Users are advised to upgrade to version 10.0.3. Users unable to upgrade should remove the `front/plugin.form.php` script.", "other": {"cve": {"id": "CVE-2022-35946", "sourceIdentifier": "security-advisories@github.com", "published": "2022-09-14T18:15:10.563", "lastModified": "2022-09-19T14:19:34.773", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "GLPI stands for Gestionnaire Libre de Parc Informatique and is a Free Asset and IT Management Software package, that provides ITIL Service Desk features, licenses tracking and software auditing. In affected versions request input is not properly validated in the plugin controller and can be used to access low-level API of Plugin class. An attacker can, for instance, alter database data. Attacker must have \"General setup\" update rights to be able to perform this attack. Users are advised to upgrade to version 10.0.3. Users unable to upgrade should remove the `front/plugin.form.php` script."}, {"lang": "es", "value": "GLPI son las siglas de Gestionnaire Libre de Parc Informatique y es un paquete de software de administraci\u00f3n de activos y TI gratuito, que proporciona funciones de Service Desk de ITIL, seguimiento de licencias y auditor\u00eda de software. En las versiones afectadas, la entrada de peticiones no es comprobada apropiadamente en el controlador del plugin y puede usarse para acceder a la API de bajo nivel de la clase del plugin. Un atacante puede, por ejemplo, alterar los datos de la base de datos. El atacante debe tener derechos de actualizaci\u00f3n \"General setup\" para poder llevar a cabo este ataque. Es recomendado a usuarios actualizar a versi\u00f3n 10.0.3. Los usuarios que no puedan actualizar deber\u00e1n eliminar el script \"front/plugin.form\""}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 5.2}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 4.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:glpi-project:glpi:*:*:*:*:*:*:*:*", "versionEndExcluding": "10.0.3", "matchCriteriaId": "F1118A51-CFED-4D17-8344-EA94C8F77EAD"}]}]}], "references": [{"url": "https://github.com/glpi-project/glpi/commit/f542ec8378afbd8038aeca5975b15eca3f0574c8", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/glpi-project/glpi/security/advisories/GHSA-92q5-pfr8-r9r2", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/glpi-project/glpi/commit/f542ec8378afbd8038aeca5975b15eca3f0574c8"}}