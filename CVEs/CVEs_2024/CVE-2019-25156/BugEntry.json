{"buggy_code": ["<?php\n/*\n<LICENSE>\n\nThis file is part of AGENCY.\n\nAGENCY is Copyright (c) 2003-2017 by Ken Tanzer and Downtown Emergency\nService Center (DESC).\n\nAll rights reserved.\n\nFor more information about AGENCY, see http://agency-software.org/\nFor more information about DESC, see http://www.desc.org/.\n\nAGENCY is free software: you can redistribute it and/or modify\nit under the terms of version 3 of the GNU General Public License\nas published by the Free Software Foundation.\n\nAGENCY is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with AGENCY.  If not, see <http://www.gnu.org/licenses/>.\n\nFor additional information, see the README.copyright file that\nshould be included in this distribution.\n\n</LICENSE>\n*/\n\n$quiet = 'Y';\ninclude 'includes.php';\n$qs_type = $_REQUEST['QSType'];\n\n$tmp_searches = array_keys($AG_QUICK_SEARCHES);\narray_push($tmp_searches,'news');\n\nif (!in_array($qs_type,$tmp_searches)) {\n\tagency_top_header();\n\tout(alert_mark('Unknown Quick Search Type: '.$qs_type));\n\tpage_close();\n\texit;\n}\n\nswitch ($qs_type) {\n\t//custom type handling here\n default :\n\t$func=$qs_type.'_search';\n\tif (function_exists($func)) {\n\t\t$out = $func();\n\t} else {\n\t\t$out = object_quick_search($qs_type,$_REQUEST['QuickSearch']);\n\t}\n}\n\nagency_top_header();\nout(html_heading_1('Search Results') .$out);\npage_close();\n\n?>\n"], "fixing_code": ["<?php\n/*\n<LICENSE>\n\nThis file is part of AGENCY.\n\nAGENCY is Copyright (c) 2003-2017 by Ken Tanzer and Downtown Emergency\nService Center (DESC).\n\nAll rights reserved.\n\nFor more information about AGENCY, see http://agency-software.org/\nFor more information about DESC, see http://www.desc.org/.\n\nAGENCY is free software: you can redistribute it and/or modify\nit under the terms of version 3 of the GNU General Public License\nas published by the Free Software Foundation.\n\nAGENCY is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with AGENCY.  If not, see <http://www.gnu.org/licenses/>.\n\nFor additional information, see the README.copyright file that\nshould be included in this distribution.\n\n</LICENSE>\n*/\n\n$quiet = 'Y';\ninclude 'includes.php';\n$qs_type = strip_tags($_REQUEST['QSType']);\n$qs_text = strip_tags($_REQUEST['QuickSearch']);\n\n$tmp_searches = array_keys($AG_QUICK_SEARCHES);\narray_push($tmp_searches,'news');\n\nif (!in_array($qs_type,$tmp_searches)) {\n\tagency_top_header();\n\tout(alert_mark(webify('Unknown Quick Search Type: '.$qs_type)));\n\tpage_close();\n\texit;\n}\n\nswitch ($qs_type) {\n\t//custom type handling here\n default :\n\t$func=$qs_type.'_search';\n\tif (function_exists($func)) {\n\t\t$out = $func();\n\t} else {\n\t\t$out = object_quick_search($qs_type,$qs_text);\n\t}\n}\n\nagency_top_header();\nout(html_heading_1('Search Results') .$out);\npage_close();\n\n?>\n"], "filenames": ["search.php"], "buggy_code_start_loc": [35], "buggy_code_end_loc": [55], "fixing_code_start_loc": [35], "fixing_code_end_loc": [56], "type": "CWE-79", "message": "A vulnerability classified as problematic was found in dstar2018 Agency up to 61. Affected by this vulnerability is an unknown functionality of the file search.php. The manipulation of the argument QSType/QuickSearch leads to cross site scripting. The attack can be launched remotely. The patch is named 975b56953efabb434519d9feefcc53685fb8d0ab. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-244495.", "other": {"cve": {"id": "CVE-2019-25156", "sourceIdentifier": "cna@vuldb.com", "published": "2023-11-07T06:15:07.783", "lastModified": "2024-02-29T01:25:41.840", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic was found in dstar2018 Agency up to 61. Affected by this vulnerability is an unknown functionality of the file search.php. The manipulation of the argument QSType/QuickSearch leads to cross site scripting. The attack can be launched remotely. The patch is named 975b56953efabb434519d9feefcc53685fb8d0ab. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-244495."}, {"lang": "es", "value": "Una vulnerabilidad ha sido encontrada en dstar2018 Agency hasta 61 y clasificada como problem\u00e1tica. Una funci\u00f3n desconocida del archivo search.php es afectada por esta vulnerabilidad. La manipulaci\u00f3n del argumento QSType/QuickSearch conduce a Cross-Site Scripting (XSS). El ataque se puede lanzar de forma remota. El parche se llama 975b56953efabb434519d9feefcc53685fb8d0ab. Se recomienda aplicar un parche para solucionar este problema. El identificador asociado de esta vulnerabilidad es VDB-244495."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dstar2018:agency:*:*:*:*:*:*:*:*", "versionEndExcluding": "2019-01-15", "matchCriteriaId": "5876788B-2CAB-489C-AC15-D75EF0532766"}]}]}], "references": [{"url": "https://github.com/dstar2018/agency-code-repo/commit/975b56953efabb434519d9feefcc53685fb8d0ab", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.244495", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.244495", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/dstar2018/agency-code-repo/commit/975b56953efabb434519d9feefcc53685fb8d0ab"}}