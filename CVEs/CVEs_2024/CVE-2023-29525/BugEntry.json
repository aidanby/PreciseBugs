{"buggy_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.5\" reference=\"XWiki.Notifications.Code.LegacyNotificationAdministration\" locale=\"\">\n  <web>XWiki.Notifications.Code</web>\n  <name>LegacyNotificationAdministration</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Legacy Notification Administration</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity output=\"false\"}}\n$services.localization.use('document', 'XWiki.Notifications.Code.LegacyNotificationAdministrationTranslations')\n\n#if ($request.migrate)\n  #if ($request.mode == 'since')\n    #set($since = $request.since)\n    #if ($since)\n      #set($since = $datetool.toDate('yyyy-MM-dd', $since))\n    #end\n  #end\n  $services.eventstream.startLegacyMigration($since)\n#end\n{{/velocity}}\n\n{{translation key=\"legacy.event.migration.description\"/}}\n\n{{velocity}}\n{{info}}\n  {{translation key=\"legacy.event.count.store\"/}}: **$services.eventstream.eventCount**\n  {{translation key=\"legacy.event.count.legacy\"/}}: **$services.eventstream.legacyEventCount**\n{{/info}}\n\n{{html}}\n&lt;form id=\"migrate\" action=\"$escapetool.xml($xwiki.relativeRequestURL)\" method=\"post\" class=\"xform third\"&gt;\n  &lt;div&gt;\n    &lt;input type=\"radio\" id=\"mode_alltime\" name=\"mode\" value=\"alltime\"#if($request.mode != 'since')checked#end/&gt;\n    &lt;label for=\"mode_alltime\"&gt;$services.localization.render('legacy.event.migration.alltime')&lt;/label&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n    &lt;input type=\"radio\" id=\"mode_since\" name=\"mode\" value=\"since\"#if($request.mode == 'since')checked#end/&gt;\n    &lt;label for=\"mode_since\"&gt;$escapetool.html($services.localization.render('legacy.event.migration.since'))&lt;/label&gt;\n    &lt;input type=\"date\" id=\"since\" name=\"since\" value=\"$!request.since\" max=\"$datetool.format('yyyy-MM-dd', $datetool.date)\"/&gt;\n  &lt;/div&gt;\n  &lt;div class=\"buttons\"&gt;&lt;span class=\"buttonwrapper\"&gt;&lt;input type=\"submit\" value=\"$escapetool.xml($services.localization.render('legacy.event.migration.start'))\" name=\"migrate\" class=\"button\"/&gt;&lt;/span&gt;&lt;/div&gt;\n&lt;/form&gt;\n\n#set($jobStatus = $services.eventstream.getLegacyMigrationStatus())\n#if ($jobStatus)\n  #template(\"job_macros.vm\")\n  #displayJobStatus($jobStatus)\n#end\n{{/html}}\n\n#set ($showCompleteStepButton = true)\n{{/velocity}}</content>\n  <object>\n    <name>XWiki.Notifications.Code.LegacyNotificationAdministration</name>\n    <number>0</number>\n    <className>XWiki.ConfigurableClass</className>\n    <guid>b103c77e-28df-4834-acb5-f97a1c75e7d1</guid>\n    <class>\n      <name>XWiki.ConfigurableClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <categoryIcon>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>categoryIcon</name>\n        <number>11</number>\n        <picker>0</picker>\n        <prettyName>categoryIcon</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </categoryIcon>\n      <codeToExecute>\n        <contenttype>VelocityWiki</contenttype>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <editor>---</editor>\n        <hint/>\n        <name>codeToExecute</name>\n        <number>7</number>\n        <picker>0</picker>\n        <prettyName>codeToExecute</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </codeToExecute>\n      <configurationClass>\n        <cache>0</cache>\n        <classname/>\n        <customDisplay/>\n        <defaultValue/>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText/>\n        <hint/>\n        <idField/>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>configurationClass</name>\n        <number>3</number>\n        <picker>1</picker>\n        <prettyName>configurationClass</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators/>\n        <size>30</size>\n        <sort>none</sort>\n        <sql/>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <valueField/>\n        <classType>com.xpn.xwiki.objects.classes.PageClass</classType>\n      </configurationClass>\n      <displayBeforeCategory>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>displayBeforeCategory</name>\n        <number>10</number>\n        <picker>0</picker>\n        <prettyName>displayBeforeCategory</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </displayBeforeCategory>\n      <displayInCategory>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>displayInCategory</name>\n        <number>9</number>\n        <picker>0</picker>\n        <prettyName>displayInCategory</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </displayInCategory>\n      <displayInSection>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>displayInSection</name>\n        <number>1</number>\n        <picker>0</picker>\n        <prettyName>displayInSection</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </displayInSection>\n      <heading>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>heading</name>\n        <number>2</number>\n        <picker>0</picker>\n        <prettyName>heading</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </heading>\n      <iconAttachment>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>iconAttachment</name>\n        <number>8</number>\n        <picker>0</picker>\n        <prettyName>iconAttachment</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </iconAttachment>\n      <linkPrefix>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>linkPrefix</name>\n        <number>5</number>\n        <picker>0</picker>\n        <prettyName>linkPrefix</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </linkPrefix>\n      <propertiesToShow>\n        <cache>0</cache>\n        <customDisplay/>\n        <defaultValue/>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText/>\n        <hint/>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>propertiesToShow</name>\n        <number>6</number>\n        <picker>0</picker>\n        <prettyName>propertiesToShow</prettyName>\n        <relationalStorage>1</relationalStorage>\n        <separator> </separator>\n        <separators> ,|</separators>\n        <size>20</size>\n        <sort>none</sort>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <values/>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </propertiesToShow>\n      <scope>\n        <cache>0</cache>\n        <customDisplay/>\n        <defaultValue/>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText/>\n        <hint/>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>12</number>\n        <picker>1</picker>\n        <prettyName>scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <sort/>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <values>WIKI|SPACE|ALL_SPACES|WIKI+ALL_SPACES</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n      <sectionOrder>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>sectionOrder</name>\n        <number>12</number>\n        <numberType>integer</numberType>\n        <prettyName>sectionOrder</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.NumberClass</classType>\n      </sectionOrder>\n    </class>\n    <property>\n      <categoryIcon>link</categoryIcon>\n    </property>\n    <property>\n      <codeToExecute>{{display reference=\"XWiki.Notifications.Code.LegacyNotificationAdministration\"/}}</codeToExecute>\n    </property>\n    <property>\n      <configurationClass/>\n    </property>\n    <property>\n      <displayBeforeCategory>other</displayBeforeCategory>\n    </property>\n    <property>\n      <displayInCategory>social</displayInCategory>\n    </property>\n    <property>\n      <displayInSection>Notifications</displayInSection>\n    </property>\n    <property>\n      <heading>$services.localization.render('platform.extension.distributionWizard.eventmigrationStepTitle')</heading>\n    </property>\n    <property>\n      <iconAttachment/>\n    </property>\n    <property>\n      <linkPrefix/>\n    </property>\n    <property>\n      <propertiesToShow/>\n    </property>\n    <property>\n      <scope>WIKI</scope>\n    </property>\n    <property>\n      <sectionOrder>500</sectionOrder>\n    </property>\n  </object>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.5\" reference=\"XWiki.Notifications.Code.LegacyNotificationAdministration\" locale=\"\">\n  <web>XWiki.Notifications.Code</web>\n  <name>LegacyNotificationAdministration</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Legacy Notification Administration</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity output=\"false\"}}\n$services.localization.use('document', 'XWiki.Notifications.Code.LegacyNotificationAdministrationTranslations')\n\n#if ($request.migrate)\n  #if ($request.mode == 'since')\n    #set($since = $request.since)\n    #if ($since)\n      #set($since = $datetool.toDate('yyyy-MM-dd', $since))\n    #end\n  #end\n  $services.eventstream.startLegacyMigration($since)\n#end\n{{/velocity}}\n\n{{translation key=\"legacy.event.migration.description\"/}}\n\n{{velocity}}\n{{info}}\n  {{translation key=\"legacy.event.count.store\"/}}: **$services.eventstream.eventCount**\n  {{translation key=\"legacy.event.count.legacy\"/}}: **$services.eventstream.legacyEventCount**\n{{/info}}\n\n{{html}}\n&lt;form id=\"migrate\" action=\"$escapetool.xml($xwiki.relativeRequestURL)\" method=\"post\" class=\"xform third\"&gt;\n  &lt;div&gt;\n    &lt;input type=\"radio\" id=\"mode_alltime\" name=\"mode\" value=\"alltime\"#if($request.mode != 'since')checked#end/&gt;\n    &lt;label for=\"mode_alltime\"&gt;$services.localization.render('legacy.event.migration.alltime')&lt;/label&gt;\n  &lt;/div&gt;\n  &lt;div&gt;\n    &lt;input type=\"radio\" id=\"mode_since\" name=\"mode\" value=\"since\"#if($request.mode == 'since')checked#end/&gt;\n    &lt;label for=\"mode_since\"&gt;$escapetool.html($services.localization.render('legacy.event.migration.since'))&lt;/label&gt;\n    &lt;input type=\"date\" id=\"since\" name=\"since\"#if($request.since) value=\"$escapetool.xml($request.since)\"#end max=\"$datetool.format('yyyy-MM-dd', $datetool.date)\"/&gt;\n  &lt;/div&gt;\n  &lt;div class=\"buttons\"&gt;&lt;span class=\"buttonwrapper\"&gt;&lt;input type=\"submit\" value=\"$escapetool.xml($services.localization.render('legacy.event.migration.start'))\" name=\"migrate\" class=\"button\"/&gt;&lt;/span&gt;&lt;/div&gt;\n&lt;/form&gt;\n\n#set($jobStatus = $services.eventstream.getLegacyMigrationStatus())\n#if ($jobStatus)\n  #template(\"job_macros.vm\")\n  #displayJobStatus($jobStatus)\n#end\n{{/html}}\n\n#set ($showCompleteStepButton = true)\n{{/velocity}}</content>\n  <object>\n    <name>XWiki.Notifications.Code.LegacyNotificationAdministration</name>\n    <number>0</number>\n    <className>XWiki.ConfigurableClass</className>\n    <guid>b103c77e-28df-4834-acb5-f97a1c75e7d1</guid>\n    <class>\n      <name>XWiki.ConfigurableClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <categoryIcon>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>categoryIcon</name>\n        <number>11</number>\n        <picker>0</picker>\n        <prettyName>categoryIcon</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </categoryIcon>\n      <codeToExecute>\n        <contenttype>VelocityWiki</contenttype>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <editor>---</editor>\n        <hint/>\n        <name>codeToExecute</name>\n        <number>7</number>\n        <picker>0</picker>\n        <prettyName>codeToExecute</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </codeToExecute>\n      <configurationClass>\n        <cache>0</cache>\n        <classname/>\n        <customDisplay/>\n        <defaultValue/>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText/>\n        <hint/>\n        <idField/>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>configurationClass</name>\n        <number>3</number>\n        <picker>1</picker>\n        <prettyName>configurationClass</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators/>\n        <size>30</size>\n        <sort>none</sort>\n        <sql/>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <valueField/>\n        <classType>com.xpn.xwiki.objects.classes.PageClass</classType>\n      </configurationClass>\n      <displayBeforeCategory>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>displayBeforeCategory</name>\n        <number>10</number>\n        <picker>0</picker>\n        <prettyName>displayBeforeCategory</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </displayBeforeCategory>\n      <displayInCategory>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>displayInCategory</name>\n        <number>9</number>\n        <picker>0</picker>\n        <prettyName>displayInCategory</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </displayInCategory>\n      <displayInSection>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>displayInSection</name>\n        <number>1</number>\n        <picker>0</picker>\n        <prettyName>displayInSection</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </displayInSection>\n      <heading>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>heading</name>\n        <number>2</number>\n        <picker>0</picker>\n        <prettyName>heading</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </heading>\n      <iconAttachment>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>iconAttachment</name>\n        <number>8</number>\n        <picker>0</picker>\n        <prettyName>iconAttachment</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </iconAttachment>\n      <linkPrefix>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>linkPrefix</name>\n        <number>5</number>\n        <picker>0</picker>\n        <prettyName>linkPrefix</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </linkPrefix>\n      <propertiesToShow>\n        <cache>0</cache>\n        <customDisplay/>\n        <defaultValue/>\n        <disabled>0</disabled>\n        <displayType>input</displayType>\n        <freeText/>\n        <hint/>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>propertiesToShow</name>\n        <number>6</number>\n        <picker>0</picker>\n        <prettyName>propertiesToShow</prettyName>\n        <relationalStorage>1</relationalStorage>\n        <separator> </separator>\n        <separators> ,|</separators>\n        <size>20</size>\n        <sort>none</sort>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <values/>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </propertiesToShow>\n      <scope>\n        <cache>0</cache>\n        <customDisplay/>\n        <defaultValue/>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText/>\n        <hint/>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>12</number>\n        <picker>1</picker>\n        <prettyName>scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <sort/>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <values>WIKI|SPACE|ALL_SPACES|WIKI+ALL_SPACES</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n      <sectionOrder>\n        <customDisplay/>\n        <disabled>0</disabled>\n        <hint/>\n        <name>sectionOrder</name>\n        <number>12</number>\n        <numberType>integer</numberType>\n        <prettyName>sectionOrder</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <classType>com.xpn.xwiki.objects.classes.NumberClass</classType>\n      </sectionOrder>\n    </class>\n    <property>\n      <categoryIcon>link</categoryIcon>\n    </property>\n    <property>\n      <codeToExecute>{{display reference=\"XWiki.Notifications.Code.LegacyNotificationAdministration\"/}}</codeToExecute>\n    </property>\n    <property>\n      <configurationClass/>\n    </property>\n    <property>\n      <displayBeforeCategory>other</displayBeforeCategory>\n    </property>\n    <property>\n      <displayInCategory>social</displayInCategory>\n    </property>\n    <property>\n      <displayInSection>Notifications</displayInSection>\n    </property>\n    <property>\n      <heading>$services.localization.render('platform.extension.distributionWizard.eventmigrationStepTitle')</heading>\n    </property>\n    <property>\n      <iconAttachment/>\n    </property>\n    <property>\n      <linkPrefix/>\n    </property>\n    <property>\n      <propertiesToShow/>\n    </property>\n    <property>\n      <scope>WIKI</scope>\n    </property>\n    <property>\n      <sectionOrder>500</sectionOrder>\n    </property>\n  </object>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-legacy/xwiki-platform-legacy-events-hibernate/xwiki-platform-legacy-events-hibernate-ui/src/main/resources/XWiki/Notifications/Code/LegacyNotificationAdministration.xml"], "buggy_code_start_loc": [70], "buggy_code_end_loc": [71], "fixing_code_start_loc": [70], "fixing_code_end_loc": [71], "type": "CWE-74", "message": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Affected versions of xwiki are subject to code injection in the `since` parameter of the `/xwiki/bin/view/XWiki/Notifications/Code/LegacyNotificationAdministration` endpoint. This provides an XWiki syntax injection attack via the since-parameter, allowing privilege escalation from view to programming rights and subsequent code execution privilege. The vulnerability has been patched in XWiki 15.0-rc-1, 14.10.3, 14.4.8 and 14.10.3. Users are advised to upgrade. Users unable to upgrade may modify the page `XWiki.Notifications.Code.LegacyNotificationAdministration` to add the missing escaping. For versions < 14.6-rc-1 a workaround is to modify the file `<xwikiwebapp>/templates/distribution/eventmigration.wiki` to add the missing escaping.", "other": {"cve": {"id": "CVE-2023-29525", "sourceIdentifier": "security-advisories@github.com", "published": "2023-04-19T00:15:09.127", "lastModified": "2023-05-01T17:27:32.133", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Affected versions of xwiki are subject to code injection in the `since` parameter of the `/xwiki/bin/view/XWiki/Notifications/Code/LegacyNotificationAdministration` endpoint. This provides an XWiki syntax injection attack via the since-parameter, allowing privilege escalation from view to programming rights and subsequent code execution privilege. The vulnerability has been patched in XWiki 15.0-rc-1, 14.10.3, 14.4.8 and 14.10.3. Users are advised to upgrade. Users unable to upgrade may modify the page `XWiki.Notifications.Code.LegacyNotificationAdministration` to add the missing escaping. For versions < 14.6-rc-1 a workaround is to modify the file `<xwikiwebapp>/templates/distribution/eventmigration.wiki` to add the missing escaping."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionEndExcluding": "14.4.8", "matchCriteriaId": "18312249-9E74-4967-B376-EDD80C07233B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.5", "versionEndExcluding": "14.10.3", "matchCriteriaId": "4472030C-B32C-42AD-B137-2FA730A29836"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/6d74e2e4aa03d19f0be385ab63ae9e0f0e90a766", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwiki/xwiki-platform/commit/8e7c7f90f2ddaf067cb5b83b181af41513028754#diff-4e13f4ee4a42938bf1201b7ee71ca32edeacba22559daf0bcb89d534e0225949R70", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-jgg7-w2rj-58cj", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-20287", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/6d74e2e4aa03d19f0be385ab63ae9e0f0e90a766"}}