{"buggy_code": ["# frozen_string_literal: true\n\nrequire_relative \"lib/encoded_id/rails/version\"\n\nGem::Specification.new do |spec|\n  spec.name = \"encoded_id-rails\"\n  spec.version = EncodedId::Rails::VERSION\n  spec.authors = [\"Stephen Ierodiaconou\"]\n  spec.email = [\"stevegeek@gmail.com\"]\n\n  spec.summary = \"Use `encoded_id` with ActiveRecord models\"\n  spec.description = \"ActiveRecord concern to use EncodedID to turn IDs into reversible and human friendly obfuscated strings.\"\n  spec.homepage = \"https://github.com/stevegeek/encoded_id-rails\"\n  spec.license = \"MIT\"\n  spec.required_ruby_version = \">= 2.6.0\"\n\n  spec.metadata[\"homepage_uri\"] = spec.homepage\n  spec.metadata[\"source_code_uri\"] = \"https://github.com/stevegeek/encoded_id-rails\"\n  spec.metadata[\"changelog_uri\"] = \"https://github.com/stevegeek/encoded_id-rails/blob/master/CHANGELOG.md\"\n\n  # Specify which files should be added to the gem when it is released.\n  # The `git ls-files -z` loads the files in the RubyGem that have been added into git.\n  spec.files = Dir.chdir(__dir__) do\n    `git ls-files -z`.split(\"\\x0\").reject do |f|\n      (f == __FILE__) || f.match(%r{\\A(?:(?:bin|test|spec|features)/|\\.(?:git|travis|circleci)|appveyor)})\n    end\n  end\n  spec.bindir = \"exe\"\n  spec.executables = spec.files.grep(%r{\\Aexe/}) { |f| File.basename(f) }\n  spec.require_paths = [\"lib\"]\n\n  # Uncomment to register a new dependency of your gem\n  spec.add_dependency \"activesupport\", \">= 6.0\", \"< 8.0\"\n  spec.add_dependency \"activerecord\", \">= 6.0\", \"< 8.0\"\n  spec.add_dependency \"encoded_id\", \"~> 1.0.0.rc2\"\n\n  # For more information and examples about making a new gem, check out our\n  # guide at: https://bundler.io/guides/creating_gem.html\nend\n"], "fixing_code": ["# frozen_string_literal: true\n\nrequire_relative \"lib/encoded_id/rails/version\"\n\nGem::Specification.new do |spec|\n  spec.name = \"encoded_id-rails\"\n  spec.version = EncodedId::Rails::VERSION\n  spec.authors = [\"Stephen Ierodiaconou\"]\n  spec.email = [\"stevegeek@gmail.com\"]\n\n  spec.summary = \"Use `encoded_id` with ActiveRecord models\"\n  spec.description = \"ActiveRecord concern to use EncodedID to turn IDs into reversible and human friendly obfuscated strings.\"\n  spec.homepage = \"https://github.com/stevegeek/encoded_id-rails\"\n  spec.license = \"MIT\"\n  spec.required_ruby_version = \">= 2.6.0\"\n\n  spec.metadata[\"homepage_uri\"] = spec.homepage\n  spec.metadata[\"source_code_uri\"] = \"https://github.com/stevegeek/encoded_id-rails\"\n  spec.metadata[\"changelog_uri\"] = \"https://github.com/stevegeek/encoded_id-rails/blob/master/CHANGELOG.md\"\n\n  # Specify which files should be added to the gem when it is released.\n  # The `git ls-files -z` loads the files in the RubyGem that have been added into git.\n  spec.files = Dir.chdir(__dir__) do\n    `git ls-files -z`.split(\"\\x0\").reject do |f|\n      (f == __FILE__) || f.match(%r{\\A(?:(?:bin|test|spec|features)/|\\.(?:git|travis|circleci)|appveyor)})\n    end\n  end\n  spec.bindir = \"exe\"\n  spec.executables = spec.files.grep(%r{\\Aexe/}) { |f| File.basename(f) }\n  spec.require_paths = [\"lib\"]\n\n  # Uncomment to register a new dependency of your gem\n  spec.add_dependency \"activesupport\", \">= 6.0\", \"< 8.0\"\n  spec.add_dependency \"activerecord\", \">= 6.0\", \"< 8.0\"\n  spec.add_dependency \"encoded_id\", \"~> 1.0.0.rc3\"\n\n  # For more information and examples about making a new gem, check out our\n  # guide at: https://bundler.io/guides/creating_gem.html\nend\n"], "filenames": ["encoded_id-rails.gemspec"], "buggy_code_start_loc": [35], "buggy_code_end_loc": [36], "fixing_code_start_loc": [35], "fixing_code_end_loc": [36], "type": "CWE-770", "message": "encoded_id-rails versions before 1.0.0.beta2 are affected by an uncontrolled resource consumption vulnerability. A remote and unauthenticated attacker might cause a denial of service condition by sending an HTTP request with an extremely long \"id\" parameter.\n\n", "other": {"cve": {"id": "CVE-2024-0241", "sourceIdentifier": "disclosure@vulncheck.com", "published": "2024-01-04T21:15:09.267", "lastModified": "2024-01-10T15:11:15.457", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "encoded_id-rails versions before 1.0.0.beta2 are affected by an uncontrolled resource consumption vulnerability. A remote and unauthenticated attacker might cause a denial of service condition by sending an HTTP request with an extremely long \"id\" parameter.\n\n"}, {"lang": "es", "value": "Las versiones de encoded_id-rails anteriores a 1.0.0.beta2 se ven afectadas por una vulnerabilidad de consumo de recursos incontrolado. Un atacante remoto y no autenticado podr\u00eda provocar una condici\u00f3n de denegaci\u00f3n de servicio enviando una solicitud HTTP con un par\u00e1metro \"id\" extremadamente largo."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-770"}]}, {"source": "disclosure@vulncheck.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-400"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:diaconou:encodedid\\:\\:rails:*:*:*:*:*:ruby:*:*", "versionEndExcluding": "1.0.0", "matchCriteriaId": "0E952EED-8C83-4839-9648-B77A49E76AAF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:diaconou:encodedid\\:\\:rails:1.0.0:-:*:*:*:ruby:*:*", "matchCriteriaId": "C9886262-80F5-4465-B2A1-867060F8B378"}, {"vulnerable": true, "criteria": "cpe:2.3:a:diaconou:encodedid\\:\\:rails:1.0.0:beta1:*:*:*:ruby:*:*", "matchCriteriaId": "CB04E949-0F60-4AB8-B16E-D06E7B02FDBA"}]}]}], "references": [{"url": "https://github.com/advisories/GHSA-3px7-jm2p-6h2c", "source": "disclosure@vulncheck.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/stevegeek/encoded_id-rails/commit/afa495a77b8a21ad582611f9cdc2081dc4018b91", "source": "disclosure@vulncheck.com", "tags": ["Patch"]}, {"url": "https://github.com/stevegeek/encoded_id-rails/security/advisories/GHSA-3px7-jm2p-6h2c", "source": "disclosure@vulncheck.com", "tags": ["Exploit", "Vendor Advisory"]}, {"url": "https://vulncheck.com/advisories/vc-advisory-GHSA-3px7-jm2p-6h2c", "source": "disclosure@vulncheck.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/stevegeek/encoded_id-rails/commit/afa495a77b8a21ad582611f9cdc2081dc4018b91"}}