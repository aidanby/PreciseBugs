{"buggy_code": ["{% extends \"./layout/default\" %}\n\n{% block breadcrumbs %}\n    {{ Breadcrumbs.render(Route.getCurrentRoute.getName, accountIds, start, end) }}\n{% endblock %}\n\n{% block content %}\n\n<div class=\"row no-print\">\n    <div class=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n        <div class=\"box\" id=\"optionsBox\">\n            <div class=\"box-header with-border\">\n                <h3 class=\"box-title\">{{ 'options'|_ }}</h3>\n            </div>\n            <div class=\"box-body\">\n                <ul class=\"list-inline\">\n                    {% for hide in hideable %}\n                        <li><input\n                                    {% if hide in defaultShow %}checked{% endif %}\n                                    type=\"checkbox\" class=\"audit-option-checkbox\" name=\"option[]\" value=\"{{ hide }}\" id=\"option_{{ hide }}\"/> <label\n                                    for=\"option_{{ hide }}\" style=\"font-weight:normal;\">{{ trans('list.'~hide) }}</label></li>\n                    {% endfor %}\n\n                </ul>\n            </div>\n        </div>\n    </div>\n</div>\n\n\n{% for account in accounts %}\n<div class=\"row\">\n    <div class=\"col-lg-12 col-md-12 col-sm-12\">\n        <div class=\"box\">\n            <div class=\"box-header with-border\">\n                <h3 class=\"box-title\">{{ account.name }}</h3>\n            </div>\n            {% set url = route('accounts.show',account.id) %}\n            {% if not auditData[account.id].exists %}\n            <div class=\"box-body\">\n\n                <em>\n                    {{ trans('firefly.no_audit_activity',\n                        {\n                            account_name: account.name,\n                            url: url,\n                            start: start.formatLocalized(monthAndDayFormat),\n                            end: end.formatLocalized(monthAndDayFormat),\n                        })|raw }}\n                </em>\n            </div>\n            {% else %}\n            <div class=\"box-body table-responsive no-padding\">\n                <p style=\"padding:10px;\">\n\n                    {{ trans('firefly.audit_end_balance',\n                        {\n                            account_name: account.name,\n                            url: url,\n                            end: auditData[account.id].end,\n                            balance: formatAmountByAccount(account,auditData[account.id].endBalance)\n                        })|raw }}\n                </p>\n                {% include 'reports.partials.journals-audit'  with {'journals': auditData[account.id].journals,'account':account} %}\n                <p style=\"padding:10px;\">\n                    {{ trans('firefly.audit_end_balance',\n                        {\n                            account_name: account.name,\n                            url: url,\n                            end: auditData[account.id].dayBefore,\n                            balance: formatAmountByAccount(account, auditData[account.id].dayBeforeBalance)\n                        })|raw }}\n                </p>\n            </div>\n            {% endif %}\n        </div>\n    </div>\n</div>\n{% endfor %}\n\n{% endblock %}\n{% block styles %}\n{% endblock %}\n{% block scripts %}\n    <script type=\"text/javascript\">\n        var hideable = {{ hideable|json_encode|raw }};\n    </script>\n    <script type=\"text/javascript\" src=\"v1/js/ff/reports/all.js?v={{ FF_VERSION }}\"></script>\n    <script type=\"text/javascript\" src=\"v1/js/ff/reports/audit/all.js?v={{ FF_VERSION }}\"></script>\n{% endblock %}\n"], "fixing_code": ["{% extends \"./layout/default\" %}\n\n{% block breadcrumbs %}\n    {{ Breadcrumbs.render(Route.getCurrentRoute.getName, accountIds, start, end) }}\n{% endblock %}\n\n{% block content %}\n\n<div class=\"row no-print\">\n    <div class=\"col-lg-12 col-md-12 col-sm-12 col-xs-12\">\n        <div class=\"box\" id=\"optionsBox\">\n            <div class=\"box-header with-border\">\n                <h3 class=\"box-title\">{{ 'options'|_ }}</h3>\n            </div>\n            <div class=\"box-body\">\n                <ul class=\"list-inline\">\n                    {% for hide in hideable %}\n                        <li><input\n                                    {% if hide in defaultShow %}checked{% endif %}\n                                    type=\"checkbox\" class=\"audit-option-checkbox\" name=\"option[]\" value=\"{{ hide }}\" id=\"option_{{ hide }}\"/> <label\n                                    for=\"option_{{ hide }}\" style=\"font-weight:normal;\">{{ trans('list.'~hide) }}</label></li>\n                    {% endfor %}\n\n                </ul>\n            </div>\n        </div>\n    </div>\n</div>\n\n\n{% for account in accounts %}\n<div class=\"row\">\n    <div class=\"col-lg-12 col-md-12 col-sm-12\">\n        <div class=\"box\">\n            <div class=\"box-header with-border\">\n                <h3 class=\"box-title\">{{ account.name }}</h3>\n            </div>\n            {% set url = route('accounts.show',account.id) %}\n            {% if not auditData[account.id].exists %}\n            <div class=\"box-body\">\n\n                <em>\n                    {{ trans('firefly.no_audit_activity',\n                        {\n                            account_name: account.name|escape,\n                            url: url,\n                            start: start.formatLocalized(monthAndDayFormat),\n                            end: end.formatLocalized(monthAndDayFormat),\n                        })|raw }}\n                </em>\n            </div>\n            {% else %}\n            <div class=\"box-body table-responsive no-padding\">\n                <p style=\"padding:10px;\">\n\n                    {{ trans('firefly.audit_end_balance',\n                        {\n                            account_name: account.name|escape,\n                            url: url,\n                            end: auditData[account.id].end,\n                            balance: formatAmountByAccount(account,auditData[account.id].endBalance)\n                        })|raw }}\n                </p>\n                {% include 'reports.partials.journals-audit'  with {'journals': auditData[account.id].journals,'account':account} %}\n                <p style=\"padding:10px;\">\n                    {{ trans('firefly.audit_end_balance',\n                        {\n                            account_name: account.name|escape,\n                            url: url,\n                            end: auditData[account.id].dayBefore,\n                            balance: formatAmountByAccount(account, auditData[account.id].dayBeforeBalance)\n                        })|raw }}\n                </p>\n            </div>\n            {% endif %}\n        </div>\n    </div>\n</div>\n{% endfor %}\n\n{% endblock %}\n{% block styles %}\n{% endblock %}\n{% block scripts %}\n    <script type=\"text/javascript\">\n        var hideable = {{ hideable|json_encode|raw }};\n    </script>\n    <script type=\"text/javascript\" src=\"v1/js/ff/reports/all.js?v={{ FF_VERSION }}\"></script>\n    <script type=\"text/javascript\" src=\"v1/js/ff/reports/audit/all.js?v={{ FF_VERSION }}\"></script>\n{% endblock %}\n"], "filenames": ["resources/views/v1/reports/audit/report.twig"], "buggy_code_start_loc": [45], "buggy_code_end_loc": [69], "fixing_code_start_loc": [45], "fixing_code_end_loc": [69], "type": "CWE-79", "message": "Firefly III 4.7.17.3 is vulnerable to stored XSS due to the lack of filtration of user-supplied data in the asset account name. The JavaScript code is executed during a visit to the audit account statistics page.", "other": {"cve": {"id": "CVE-2019-14669", "sourceIdentifier": "cve@mitre.org", "published": "2019-08-05T20:15:12.047", "lastModified": "2020-12-16T17:00:14.417", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Firefly III 4.7.17.3 is vulnerable to stored XSS due to the lack of filtration of user-supplied data in the asset account name. The JavaScript code is executed during a visit to the audit account statistics page."}, {"lang": "es", "value": "Firefly III versi\u00f3n 4.7.17.3, es vulnerable a una ataque de tipo XSS almacenado debido a la falta de filtraci\u00f3n de datos suministrados por el usuario en el nombre de cuenta del activo. El c\u00f3digo JavaScript es ejecutado durante una visita a la p\u00e1gina de estad\u00edsticas de la cuenta de auditor\u00eda."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:firefly-iii:firefly_iii:4.7.17.3:*:*:*:*:*:*:*", "matchCriteriaId": "07608727-1384-457D-A9E9-76A9DE166635"}]}]}], "references": [{"url": "https://github.com/firefly-iii/firefly-iii/commit/2ddf48f15cbdbb475221c299872420f625c3bc3f", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/firefly-iii/firefly-iii/issues/2366", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/firefly-iii/firefly-iii/commit/2ddf48f15cbdbb475221c299872420f625c3bc3f"}}