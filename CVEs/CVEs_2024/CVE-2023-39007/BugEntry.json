{"buggy_code": ["<?php\n\n/**\n *    Copyright (C) 2015 Deciso B.V.\n *\n *    All rights reserved.\n *\n *    Redistribution and use in source and binary forms, with or without\n *    modification, are permitted provided that the following conditions are met:\n *\n *    1. Redistributions of source code must retain the above copyright notice,\n *       this list of conditions and the following disclaimer.\n *\n *    2. Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *\n *    THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *    INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY\n *    AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n *    AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,\n *    OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n *    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n *    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n *    CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *    POSSIBILITY OF SUCH DAMAGE.\n *\n */\n\nnamespace OPNsense\\Cron;\n\n/**\n * Class ItemController\n * @package OPNsense\\Cron\n */\nclass ItemController extends \\OPNsense\\Base\\IndexController\n{\n    /**\n     * open cron form with selected item\n     * @param null $uuid cron item to open\n     * @throws \\Exception\n     */\n    public function openAction($uuid = null)\n    {\n        $this->view->selected_uuid = $uuid;\n        // include dialog form definitions\n        $this->view->formDialogEdit = $this->getForm(\"dialogEdit\");\n        $this->view->pick('OPNsense/Cron/index');\n    }\n}\n"], "fixing_code": ["<?php\n\n/**\n *    Copyright (C) 2015 Deciso B.V.\n *\n *    All rights reserved.\n *\n *    Redistribution and use in source and binary forms, with or without\n *    modification, are permitted provided that the following conditions are met:\n *\n *    1. Redistributions of source code must retain the above copyright notice,\n *       this list of conditions and the following disclaimer.\n *\n *    2. Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *\n *    THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,\n *    INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY\n *    AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n *    AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,\n *    OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n *    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n *    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n *    CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *    POSSIBILITY OF SUCH DAMAGE.\n *\n */\n\nnamespace OPNsense\\Cron;\n\n/**\n * Class ItemController\n * @package OPNsense\\Cron\n */\nclass ItemController extends \\OPNsense\\Base\\IndexController\n{\n    /**\n     * open cron form with selected item\n     * @param null $uuid cron item to open\n     * @throws \\Exception\n     */\n    public function openAction($uuid = null)\n    {\n        $this->view->selected_uuid = htmlspecialchars($uuid, ENT_QUOTES | ENT_HTML401);\n        // include dialog form definitions\n        $this->view->formDialogEdit = $this->getForm(\"dialogEdit\");\n        $this->view->pick('OPNsense/Cron/index');\n    }\n}\n"], "filenames": ["src/opnsense/mvc/app/controllers/OPNsense/Cron/ItemController.php"], "buggy_code_start_loc": [46], "buggy_code_end_loc": [47], "fixing_code_start_loc": [46], "fixing_code_end_loc": [47], "type": "CWE-79", "message": "/ui/cron/item/open in the Cron component of OPNsense Community Edition before 23.7 and Business Edition before 23.4.2 allows XSS via openAction in app/controllers/OPNsense/Cron/ItemController.php.", "other": {"cve": {"id": "CVE-2023-39007", "sourceIdentifier": "cve@mitre.org", "published": "2023-08-09T19:15:15.207", "lastModified": "2023-10-10T23:15:10.710", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "/ui/cron/item/open in the Cron component of OPNsense Community Edition before 23.7 and Business Edition before 23.4.2 allows XSS via openAction in app/controllers/OPNsense/Cron/ItemController.php."}, {"lang": "es", "value": "/ui/cron/item/open en el componente Cron de OPNsense Community Edition antes de 23.7 y Business Edition antes de 23.4.2 permite XSS a trav\u00e9s de openAction en app/controllers/OPNsense/Cron/ItemController.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:opnsense:opnsense:*:*:*:*:*:*:*:*", "versionEndExcluding": "23.7", "matchCriteriaId": "E4C1BDFF-B6E1-4F82-9957-1FFA069E2EDC"}]}]}], "references": [{"url": "https://github.com/opnsense/core/commit/5edff49db1cd8b5078611e2f542d91c02af2b25c", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/opnsense/core/compare/23.1.11...23.7", "source": "cve@mitre.org"}, {"url": "https://logicaltrust.net/blog/2023/08/opnsense.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/opnsense/core/commit/5edff49db1cd8b5078611e2f542d91c02af2b25c"}}