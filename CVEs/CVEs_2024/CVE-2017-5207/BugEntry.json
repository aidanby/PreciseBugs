{"buggy_code": ["firejail (0.9.45) baseline; urgency=low\n  * development version, work in progress\n  * security: disabled --allow-debuggers when running on kernel\n    versions prior to 4.8; a kernel bug in ptrace system call\n    allows a full bypass of seccomp filter; problem reported by Lizzie Dixon\n  * security: overwrite /etc/resolv.conf found by Martin Carpenter\n  * secuirty: TOCTOU exploit for --get and --put found by Daniel Hodson\n  * security: invalid environment exploit found by Martin Carpenter\n  * security: split most of networking code in a separate executable\n  * security: split seccomp filter code configuration in a separate executable\n  * security: split file copying in private option in a separate executable\n  * security: root exploit found by Sebastian Krahmer\n  * feature: disable gnupg and systemd directories under /run/user\n  * feature: allow root user access to /dev/shm (--noblacklist=/dev/shm)\n  * feature: AppImage type 2 support\n  * feature: test coverage (gcov) support\n  * feature: private /opt directory (--private-opt, profile support)\n  * feature: private /srv directory (--private-srv, profile support)\n  * feature: spoof machine-id\n  * feature: config support for firejail prompt in terminals\n  * feature: pass command line arguments to appimages\n  * feature: --allow-private-blacklist option\n  * feature: allow non-seccomp setup for OverlayFS sandboxes\n  * feature: added a number o Python scripts for handling sandboxes\n  * new profiles: xiphos, Tor Browser Bundle, display (imagemagik), Wire,\n  * new profiles: mumble, zoom, Guayadeque, qemu, keypass2, xed, pluma,\n  * new profiles: Cryptocat, Bless, Gnome 2048, Gnome Calculator,\n  * new profiles: Gnome Contacts, JD-GUI, Lollypop, MultiMC5, PDFSam, Pithos,\n  * new profies: Xonotic, wireshark, keepassx2, QupZilla, FossaMail\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sun, 23 Oct 2016 08:00:00 -0500\n\nfirejail (0.9.44) baseline; urgency=low\n  * CVE-2016-7545 submitted by Aleksey Manevich\n  * modifs: removed man firejail-config\n  * modifs: --private-tmp whitelists /tmp/.X11-unix directory\n  * modifs: Nvidia drivers added to --private-dev\n  * modifs: /srv supported by --whitelist\n  * feature: allow user access to /sys/fs (--noblacklist=/sys/fs)\n  * feature: support starting/joining sandbox is a single command\n    (--join-or-start)\n  * feature: X11 detection support for --audit\n  * feature: assign a name to the interface connected to the bridge\n    (--veth-name)\n  * feature: all user home directories are visible (--allusers)\n  * feature: add files to sandbox container (--put)\n  * feature: blocking x11 (--x11=block)\n  * feature: X11 security extension (--x11=xorg)\n  * feature: disable 3D hardware acceleration (--no3d)\n  * feature: x11 xpra, x11 xephyr, x11 block, allusers, no3d profile commands\n  * feature: move files in sandbox (--put)\n  * feature: accept wildcard patterns in user  name field of restricted\n    shell login feature\n  * new profiles: qpdfview, mupdf, Luminance HDR, Synfig Studio, Gimp, Inkscape\n  * new profiles: feh, ranger, zathura, 7z, keepass, keepassx,\n  * new profiles: claws-mail, mutt, git, emacs, vim, xpdf, VirtualBox, OpenShot\n  * new profiles: Flowblade, Eye of GNOME (eog), Evolution\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Fri, 21 Oct 2016 08:00:00 -0500\n\nfirejail (0.9.42) baseline; urgency=low\n  * security: --whitelist deleted files, submitted by Vasya Novikov\n  * security: disable x32 ABI in seccomp, submitted by Jann Horn\n  * security: tighten --chroot, submitted by Jann Horn\n  * security: terminal sandbox escape, submitted by Stephan Sokolow\n  * security: several TOCTOU fixes submitted by Aleksey Manevich\n  * modifs: bringing back --private-home option\n  * modifs: deprecated --user option, please use \"sudo -u username firejail\"\n  * modifs: allow symlinks in home directory for --whitelist option\n  * modifs: Firejail prompt is enabled by env variable FIREJAIL_PROMPT=\"yes\"\n  * modifs: recursive mkdir\n  * modifs: include /dev/snd in --private-dev\n  * modifs: seccomp filter update\n  * modifs: release archives moved to .xz format\n  * feature: AppImage support (--appimage)\n  * feature: AppArmor support (--apparmor)\n  * feature: Ubuntu snap support (/etc/firejail/snap.profile)\n  * feature: Sandbox auditing support (--audit)\n  * feature: remove environment variable (--rmenv)\n  * feature: noexec support (--noexec)\n  * feature: clean local overlay storage directory (--overlay-clean)\n  * feature: store and reuse overlay (--overlay-named)\n  * feature: allow debugging inside the sandbox with gdb and strace\n         (--allow-debuggers)\n  * feature: mkfile profile command\n  * feature: quiet profile command\n  * feature: x11 profile command\n  * feature: option to fix desktop files (firecfg --fix)\n  * compile time: Busybox support (--enable-busybox-workaround)\n  * compile time: disable overlayfs (--disable-overlayfs)\n  * compile time: disable whitlisting (--disable-whitelist)\n  * compile time: disable global config (--disable-globalcfg)\n  * run time: enable/disable overlayfs (overlayfs yes/no)\n  * run time: enable/disable  quiet as default (quiet-by-default yes/no)\n  * run time: user-defined network filter (netfilter-default)\n  * run time: enable/disable whitelisting (whitelist yes/no)\n  * run time: enable/disable remounting of /proc and /sys\n          (remount-proc-sys yes/no)\n  * run time: enable/disable chroot desktop features (chroot-desktop yes/no)\n  * profiles: Gitter, gThumb, mpv, Franz messenger, LibreOffice\n  * profiles: pix, audacity, xz, xzdec, gzip, cpio, less\n  * profiles: Atom Beta, Atom, jitsi, eom, uudeview\n  * profiles: tar (gtar), unzip, unrar, file, skypeforlinux,\n  * profiles: inox, Slack, gnome-chess. Gajim IM client, DOSBox\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Thu, 8 Sept 2016 08:00:00 -0500\n\nfirejail (0.9.40) baseline; urgency=low\n  * added --nice option\n  * added --x11 option\n  * added --x11=xpra option\n  * added --x11=xephyr option\n  * added --cpu.print option\n  * added filetransfer options --ls and --get\n  * added --writable-etc and --writable-var options\n  * added --read-only option\n  * added mkdir, ipc-namespace, and nosound profile commands\n  * added net, ip, defaultgw, ip6, mac, mtu and iprange profile commands\n  * --version also prints compile options\n  * --output option also redirects stderr\n  * added compile-time option to restrict --net= to root only\n  * run time config support, man firejail-config\n  * added firecfg utility\n  * AppArmor fixes\n  * default seccomp filter update\n  * disable STUN/WebRTC in default netfilter configuration\n  * new profiles: lxterminal, Epiphany, cherrytree, Polari, Vivaldi, Atril\n  * new profiles: qutebrowser, SlimJet, Battle for Wesnoth, Hedgewars\n  * new profiles: qTox, OpenSSH client, OpenBox, Dillo, cmus, dnsmasq\n  * new profiles: PaleMoon, Icedove, abrowser, 0ad, netsurf, Warzone2100\n  * new profiles: okular, gwenview, Google-Play-Music-Desktop-Player\n  * new profiles: Aweather, Stellarium, gpredict, quiterss, cyberfox\n  * new profiles: generic Ubuntu snap application profile, xplayer\n  * new profiles: xreader, xviewer, mcabber, Psi+, Corebird, Konversation\n  * new profiles: Brave, Gitter\n  * generic.profile renamed default.profile\n  * build rpm packages using \"make rpms\"\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sun, 29 May 2016 08:00:00 -0500\n\nfirejail (0.9.38) baseline; urgency=low\n  * IPv6 support (--ip6 and --netfilter6)\n  * --join command enhancement (--join-network, --join-filesystem)\n  * added --user command\n  * added --disable-network and --disable-userns compile time flags\n  * Centos 6 support\n  * symlink invocation\n  * added KMail, Seamonkey, Telegram, Mathematica, uGet,\n  *   and mupen64plus profiles\n  * --chroot in user mode allowed only if seccomp support is available\n  *   in current Linux kernel\n  * deprecated --private-home feature\n  * the first protocol list installed takes precedence\n  * --tmpfs option allowed only running as root\n  * added --private-tmp option\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Tue, 2 Feb 2016 10:00:00 -0500\n\nfirejail (0.9.36) baseline; urgency=low\n  * added  unbound, dnscrypt-proxy, BitlBee, HexChat, WeeChat,\n     parole and rtorrent profiles\n  * Google Chrome profile rework\n  * added google-chrome-stable profile\n  * added google-chrome-beta profile\n  * added google-chrome-unstable profile\n  * Opera profile rework\n  * added opera-beta profile\n  * added --noblacklist option\n  * added --profile-path option\n  * added --force option\n  * whitelist command enhancements\n  * prevent user name enumeration\n  * added /etc/firejail/nolocal.net network filter\n  * added /etc/firejail/webserver.net network filter\n  * blacklisting firejail configuration by default\n  * allow default gateway configuration for --interface option\n  * --debug enhancements: --debug-check-filenames, --debug-blacklists,\n    --debug-whitelists\n  * filesystem log\n  * libtrace enhancements, tracing opendir call\n  * added --tracelog option\n  * added \"name\" command to profile files\n  * added \"hostname\" command to profile files\n  * added automated feature testing framework\n  * Debian reproducible build\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sun, 27 Dec 2015 09:00:00 -0500\n\nfirejail (0.9.34) baseline; urgency=low\n  * added --ignore option\n  * added --protocol option\n  * support dual i386/amd64 seccomp filters\n  * added Google Chrome profile\n  * added Steam, Skype, Wine and Conkeror profiles\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sat, 7 Nov 2015 08:00:00 -0500\n\nfirejail (0.9.32) baseline; urgency=low\n  * added --interface option\n  * added --mtu option\n  * added --private-bin option\n  * added --nosound option\n  * added --hostname option\n  * added --quiet option\n  * added seccomp errno support\n  * added FBReader default profile\n  * added Spotify default profile\n  * lots of default security profile changes\n  * fixed a security problem on multi-user systems\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Wed, 21 Oct 2015 08:00:00 -0500\n\n\nfirejail (0.9.30) baseline; urgency=low\n  * added a disable-history.inc profile as a result of Firefox PDF.js exploit;\n    disable-history.inc included in all default profiles\n  * Firefox PDF.js exploit (CVE-2015-4495) fixes\n  * added --private-etc option\n  * added --env option\n  * added --whitelist option\n  * support ${HOME} token in include directive in profile files\n  * --private.keep is transitioned to --private-home\n  * support ~ and blanks in blacklist option\n  * support \"net none\" command in profile files\n  * using /etc/firejail/generic.profile by default for user sessions\n  * using /etc/firejail/server.profile by default for root sessions\n  * added build --enable-fatal-warnings configure option\n  * added persistence to --overlay option\n  * added --overlay-tmpfs option\n  * make install-strip implemented, make install renamed\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Mon, 14 Sept 2015 08:00:00 -0500\n\nfirejail (0.9.28) baseline; urgency=low\n  * network scanning, --scan option\n  * interface MAC address support, --mac option\n  * IP address range, --iprange option\n  * traffic shaping, --bandwidth option\n  * reworked printing of network status at startup\n  * man pages rework\n  * added firejail-login man page\n  * added GNU Icecat, FileZilla, Pidgin, XChat, Empathy, DeaDBeeF default\n    profiles\n  * added an /etc/firejail/disable-common.inc file to hold common directory\n    blacklists\n  * blacklist Opera and Chrome/Chromium config directories in profile files\n  * support noroot option for profile files\n  * enabled noroot in default profile files\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sat, 1 Aug 2015 08:00:00 -0500\n\nfirejail (0.9.26) baseline; urgency=low\n  * private dev directory\n  * private.keep option for whitelisting home files in a new private directory\n  * user namespaces support, noroot option\n  * added Deluge and qBittorent profiles\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Thu, 30 Apr 2015 08:00:00 -0500\n\n\nfirejail (0.9.24) baseline; urgency=low\n  * whitelist and blacklist seccomp filters\n  * doubledash option\n  * --shell=none support\n  * netfilter file support in profile files\n  * dns server support in profile files\n  * added --dns.print option\n  * added default profiles for Audacious, Clementine, Gnome-MPlayer, Rhythmbox and Totem.\n  * added --caps.drop=all in default profiles\n  * new syscalls in default seccomp filter: sysfs, sysctl, adjtimex, kcmp\n  *         clock_adjtime, lookup_dcookie, perf_event_open, fanotify_init\n  * Bugfix: using /proc/sys/kernel/pid_max for the max number of pids\n  * two build patches from Reiner Herman (tickets 11, 12)\n  * man page patch from Reiner Herman (ticket 13)\n  * output patch (ticket 15) from sshirokov\n\n -- netblue30 <netblue30@yahoo.com>  Sun, 5 Apr 2015 08:00:00 -0500\n\nfirejail (0.9.22) baseline; urgency=low\n  * Replaced --noip option with --ip=none\n  * Container stdout logging and log rotation\n  * Added process_vm_readv, process_vm_writev and mknod to\n  *    default seccomp blacklist\n  * Added CAP_MKNOD to default caps blacklist\n  * Blacklist and whitelist custom Linux capabilities filters\n  * macvlan device driver support for --net option\n  * DNS server support, --dns option\n  * Netfilter support\n  * Monitor network statistics, --netstats option\n  * Added profile for Mozilla Thunderbird/Icedove\n  * - --overlay support for Linux kernels 3.18+\n  * Bugfix: preserve .Xauthority file in private mode (test with ssh -X)\n  * Bugfix: check uid/gid for cgroup\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 9 Mar 2015 09:00:00 -0500\n\nfirejail (0.9.20) baseline; urgency=low\n  * utmp, btmp and wtmp enhancements\n  *    create empty /var/log/wtmp and /var/log/btmp files in sandbox\n  *    generate a new /var/run/utmp file in sandbox\n  * CPU affinity, --cpu option\n  * Linux control groups support, --cgroup option\n  * Opera web browser support\n  * VLC support\n  * Added \"empty\" attribute to seccomp command to remove the default\n  *    syscall list form seccomp blacklist\n  * Added --nogroups option to disable supplementary groups for regular\n  *   users. root user always runs without supplementary groups.\n  * firemon enhancements\n  *   display the command that started the sandbox\n  *   added --caps option to display capabilities for all sandboxes\n  *   added --cgroup option to display the control groups for all sandboxes\n  *   added --cpu option to display CPU affinity for all sandboxes\n  *   added --seccomp option to display seccomp setting for all sandboxes\n  * New compile time options: --disable-chroot, --disable-bind\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 02 Feb 2015 08:00:00 -0500\n\nfirejail (0.9.18) baseline; urgency=low\n  * Support for tracing system, setuid, setgid, setfsuid, setfsgid syscalls\n  * Support for tracing setreuid, setregid, setresuid, setresguid syscalls\n  * Added profiles for transmission-gtk and transmission-qt\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Fri, 25 Dec 2014 10:00:00 -0500\n\nfirejail (0.9.16) baseline; urgency=low\n  * Configurable private home directory\n  * Configurable default user shell\n  * Software configuration support for --docdir and DESTDIR\n  * Profile file support for include, caps, seccomp and private keywords\n  * Dropbox profile file\n  * Linux capabilities and seccomp filters enabled by default for Firefox,\n  Midori, Evince and Dropbox\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Tue, 4 Nov 2014 10:00:00 -0500\n\nfirejail (0.9.14) baseline; urgency=low\n  * Linux capabilities and seccomp filters are automatically enabled in\n    chroot mode (--chroot option) if the sandbox is started as regular user\n  * Added support for user defined seccomp blacklists\n  * Added syscall trace support\n  * Added --tmpfs option\n  * Added --balcklist option\n  * Added --read-only option\n  * Added --bind option\n  * Logging enhancements\n  * --overlay option was reactivated\n  * Added firemon support to print the ARP table for each sandbox\n  * Added firemon support to print the route table for each sandbox\n  * Added firemon support to print interface information for each sandbox\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Tue, 15 Oct 2014 10:00:00 -0500\n\nfirejail (0.9.12.2) baseline; urgency=low\n  * Fix for pulseaudio problems\n  * --overlay option was temporarily disabled in this build\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 29 Sept 2014 07:00:00 -0500\n\nfirejail (0.9.12.1) baseline; urgency=low\n  * Fix for pulseaudio problems\n  * --overlay option was temporarily disabled in this build\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 22 Sept 2014 09:00:00 -0500\n\nfirejail (0.9.12) baseline; urgency=low\n  * Added capabilities support\n  * Added support for CentOS 7\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 15 Sept 2014 10:00:00 -0500\n\nfirejail (0.9.10) baseline; urgency=low\n  * Disable /proc/kcore, /proc/kallsyms, /dev/port, /boot\n  * Fixed --top option CPU utilization calculation\n  * Implemented --tree option in firejail and firemon\n  * Implemented --join=name option\n  * Implemented --shutdown option\n  * Preserve the current working directory if possible\n  * Cppcheck and clang errors cleanup\n  * Added a Chromium web browser profile\n\n -- netblue30 <netblue30@yahoo.com>  Thu, 28 Aug 2014 07:00:00 -0500\n\nfirejail (0.9.8.1) baseline; urgency=low\n  * FIxed a number of bugs introduced in 0.9.8\n\n -- netblue30 <netblue30@yahoo.com>  Fri, 25 Jul 2014 07:25:00 -0500\n\nfirejail (0.9.8) baseline; urgency=low\n  * Implemented nowrap mode for firejail --list command option\n  * Added --top option in both firejail and firemon\n  * seccomp filter support\n  * Added pid support for firemon\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Tue, 24 Jul 2014 08:51:00 -0500\n\nfirejail (0.9.6) baseline; urgency=low\n\n  * Mounting tmpfs on top of /var/log, required by several server programs\n  * Server fixes for /var/lib and /var/cache\n  * Private mode fixes\n  * csh and zsh default shell support\n  * Chroot mode fixes\n  * Added support for lighttpd, isc-dhcp-server, apache2, nginx, snmpd,\n\n -- netblue30 <netblue30@yahoo.com>  Sat, 7 Jun 2014 09:00:00 -0500\n\nfirejail (0.9.4) baseline; urgency=low\n\n  * Fixed resolv.conf on Ubuntu systems using DHCP\n  * Fixed resolv.conf on Debian systems using resolvconf package\n  * Fixed /var/lock directory\n  * Fixed /var/tmp directory\n  * Fixed symbolic links in profile files\n  * Added profiles for evince, midori\n\n -- netblue30 <netblue30@yahoo.com>  Sun, 4 May 2014 08:00:00 -0500\n\nfirejail (0.9.2) baseline; urgency=low\n\n  * Checking IP address passed with --ip option using ARP; exit if the address\n   is already present\n  * Using a lock file during ARP address assignment in order to removed a race\n   condition.\n  * Several fixes to --private option; it also mounts a tmpfs filesystem on top\n   of /tmp\n  * Added user access check for profile file\n  * Added --defaultgw option\n  * Added support of --noip option; it is necessary for DHCP setups\n  * Added syslog support\n  * Added support for \"tmpfs\" and \"read-only\" profile commands\n  * Added an expect-based testing framework for the project\n  * Added bash completion support\n  * Added support for multiple networks\n\n -- netblue30 <netblue30@yahoo.com>  Fri, 25 Apr 2014 08:00:00 -0500\n\nfirejail (0.9) baseline; urgency=low\n\n  * First beta version\n\n -- netblue30 <netblue30@yahoo.com>  Sat, 12 Apr 2014 09:00:00 -0500\n", "/*\n * Copyright (C) 2014-2016 Firejail Authors\n *\n * This file is part of firejail project\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation; either version 2 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n*/\n#define _GNU_SOURCE\n#include <stdio.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <net/if.h>\n#include \"firejail.h\"\n\n//***********************************\n// interface bandwidth linked list\n//***********************************\ntypedef struct ifbw_t {\n\tstruct ifbw_t *next;\n\tchar *txt;\n} IFBW;\nIFBW *ifbw = NULL;\n\n\n#if 0\nstatic void ifbw_print(void) {\n\tIFBW *ptr = ifbw;\n\twhile (ptr) {\n\t\tprintf(\"#%s#\\n\", ptr->txt);\n\t\tptr = ptr->next;\n\t}\n}\n#endif\n\nstatic void ifbw_add(IFBW *ptr) {\n\tassert(ptr);\n\n\tif (ifbw != NULL)\n\t\tptr->next = ifbw;\n\tifbw = ptr;\n}\n\n\nIFBW *ifbw_find(const char *dev) {\n\tassert(dev);\n\tint len = strlen(dev);\n\tassert(len);\n\t\n\tif (ifbw == NULL)\n\t\treturn NULL;\n\t\n\tIFBW *ptr = ifbw;\n\twhile (ptr) {\n\t\tif (strncmp(ptr->txt, dev, len) == 0 && ptr->txt[len] == ':')\n\t\t\treturn ptr;\n\t\tptr = ptr->next;\n\t}\n\t\n\treturn NULL;\n}\n\nvoid ifbw_remove(IFBW *r) {\n\tif (ifbw == NULL)\n\t\treturn;\n\t\n\t// remove the first element\n\tif (ifbw == r) {\n\t\tifbw = ifbw->next;\n\t\treturn;\n\t}\n\t\n\t// walk the list\n\tIFBW *ptr = ifbw->next;\n\tIFBW *prev = ifbw;\n\twhile (ptr) {\n\t\tif (ptr == r) {\n\t\t\tprev->next = ptr->next;\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tprev = ptr;\n\t\tptr = ptr->next;\n\t}\t\n\t\n\treturn;\n}\n\nint fibw_count(void) {\n\tint rv = 0;\n\tIFBW *ptr = ifbw;\n\n\twhile (ptr) {\n\t\trv++;\n\t\tptr = ptr->next;\n\t}\n\t\n\treturn rv;\n}\n\t\n\n//***********************************\n// run file handling\n//***********************************\nstatic void bandwidth_create_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\t\n\t// if the file already exists, do nothing\n\tstruct stat s;\n\tif (stat(fname, &s) == 0) {\n\t\tfree(fname);\n\t\treturn;\n\t}\n\n\t// create an empty file and set mod and ownership\n\t/* coverity[toctou] */\n\tFILE *fp = fopen(fname, \"w\");\n\tif (fp) {\n\t\tSET_PERMS_STREAM(fp, 0, 0, 0644);\n\t\tfclose(fp);\n\t}\n\telse {\n\t\tfprintf(stderr, \"Error: cannot create bandwidth file\\n\");\n\t\texit(1);\n\t}\n\t\n\tfree(fname);\n}\n\n// delete bandwidth file\nvoid bandwidth_del_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\tunlink(fname);\n\tfree(fname);\n}\n\nvoid network_del_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-netmap\", RUN_FIREJAIL_NETWORK_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\tunlink(fname);\n\tfree(fname);\n}\n\nvoid network_set_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-netmap\", RUN_FIREJAIL_NETWORK_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\t\n\t// create an empty file and set mod and ownership\n\tFILE *fp = fopen(fname, \"w\");\n\tif (fp) {\n\t\tif (cfg.bridge0.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge0.dev, cfg.bridge0.devsandbox);\n\t\tif (cfg.bridge1.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge1.dev, cfg.bridge1.devsandbox);\n\t\tif (cfg.bridge2.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge2.dev, cfg.bridge2.devsandbox);\n\t\tif (cfg.bridge3.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge3.dev, cfg.bridge3.devsandbox);\n\n\t\tSET_PERMS_STREAM(fp, 0, 0, 0644);\n\t\tfclose(fp);\n\t}\n\telse {\n\t\tfprintf(stderr, \"Error: cannot create network map file\\n\");\n\t\texit(1);\n\t}\n\t\n\tfree(fname);\n}\n\n\nstatic void read_bandwidth_file(pid_t pid) {\n\tassert(ifbw == NULL);\n\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\n\tFILE *fp = fopen(fname, \"r\");\n\tif (fp) {\n\t\tchar buf[1024];\n\t\twhile (fgets(buf, 1024,fp)) {\n\t\t\t// remove '\\n'\n\t\t\tchar *ptr = strchr(buf, '\\n');\n\t\t\tif (ptr)\n\t\t\t\t*ptr = '\\0';\n\t\t\tif (strlen(buf) == 0)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\t// create a new IFBW entry\n\t\t\tIFBW *ifbw_new = malloc(sizeof(IFBW));\n\t\t\tif (!ifbw_new)\n\t\t\t\terrExit(\"malloc\");\n\t\t\tmemset(ifbw_new, 0, sizeof(IFBW));\n\t\t\tifbw_new->txt = strdup(buf);\n\t\t\tif (!ifbw_new->txt)\n\t\t\t\terrExit(\"strdup\");\n\t\t\t\n\t\t\t// add it to the linked list\n\t\t\tifbw_add(ifbw_new);\n\t\t}\t\n\t\t\n\t\tfclose(fp);\t\t\n\t}\n}\n\nstatic void write_bandwidth_file(pid_t pid) {\n\tif (ifbw == NULL)\n\t\treturn; // nothing to do\n\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\n\tFILE *fp = fopen(fname, \"w\");\n\tif (fp) {\n\t\tIFBW *ptr = ifbw;\n\t\twhile (ptr) {\n\t\t\tif (fprintf(fp, \"%s\\n\", ptr->txt) < 0)\n\t\t\t\tgoto errout;\n\t\t\tptr = ptr->next;\n\t\t}\n\t\tfclose(fp);\n\t}\n\telse\n\t\tgoto errout;\n\treturn;\n\nerrout:\n\tfprintf(stderr, \"Error: cannot write bandwidth file %s\\n\", fname);\n\texit(1);\n}\n\n//***********************************\n// add or remove interfaces\n//***********************************\n\n// remove interface from run file\nvoid bandwidth_remove(pid_t pid, const char *dev) {\n\tbandwidth_create_run_file(pid);\n\t\n\t// read bandwidth file\n\tread_bandwidth_file(pid);\n\t\n\t// find the element and remove it\n\tIFBW *elem = ifbw_find(dev);\n\tif (elem) {\n\t\tifbw_remove(elem);\n\t\twrite_bandwidth_file(pid) ;\n\t}\n\t\n\t// remove the file if there are no entries in the list\n\tif (ifbw == NULL) {\n\t\t bandwidth_del_run_file(pid);\n\t}\n}\n\n// add interface to run file\nvoid bandwidth_set(pid_t pid, const char *dev, int down, int up) {\n\t// create bandwidth directory & file in case they are not in the filesystem yet\n\tbandwidth_create_run_file(pid);\n\n\t// create the new text entry\n\tchar *txt;\n\tif (asprintf(&txt, \"%s: RX %dKB/s, TX %dKB/s\", dev, down, up) == -1)\n\t\terrExit(\"asprintf\");\n\t\n\t// read bandwidth file\n\tread_bandwidth_file(pid);\n\n\t// look for an existing entry and replace the text\n\tIFBW *ptr = ifbw_find(dev);\n\tif (ptr) {\n\t\tassert(ptr->txt);\n\t\tfree(ptr->txt);\n\t\tptr->txt = txt;\n\t}\n\t// ... or add a new entry\n\telse {\n\t\tIFBW *ifbw_new = malloc(sizeof(IFBW));\n\t\tif (!ifbw_new)\n\t\t\terrExit(\"malloc\");\n\t\tmemset(ifbw_new, 0, sizeof(IFBW));\n\t\tifbw_new->txt = txt;\n\t\t\n\t\t// add it to the linked list\n\t\tifbw_add(ifbw_new);\n\t}\n\twrite_bandwidth_file(pid) ;\n}\n\n\n//***********************************\n// command execution\n//***********************************\nvoid bandwidth_pid(pid_t pid, const char *command, const char *dev, int down, int up) {\n\tEUID_ASSERT();\n\t//************************\n\t// verify sandbox\n\t//************************\n\tEUID_ROOT();\n\tchar *comm = pid_proc_comm(pid);\n\tEUID_USER();\n\tif (!comm) {\n\t\tfprintf(stderr, \"Error: cannot find sandbox\\n\");\n\t\texit(1);\n\t}\n\n\t// check for firejail sandbox\n\tif (strcmp(comm, \"firejail\") != 0) {\n\t\tfprintf(stderr, \"Error: cannot find sandbox\\n\");\n\t\texit(1);\n\t}\n\tfree(comm);\n\t\n\t// check network namespace\n\tchar *name;\n\tif (asprintf(&name, \"/run/firejail/network/%d-netmap\", pid) == -1)\n\t\terrExit(\"asprintf\");\n\tstruct stat s;\n\tif (stat(name, &s) == -1) {\n\t\tfprintf(stderr, \"Error: the sandbox doesn't use a new network namespace\\n\");\n\t\texit(1);\n\t}\n\n\t//************************\n\t// join the network namespace\n\t//************************\n\tpid_t child;\n\tif (find_child(pid, &child) == -1) {\n\t\tfprintf(stderr, \"Error: cannot join the network namespace\\n\");\n\t\texit(1);\n\t}\n\n\tEUID_ROOT();\n\tif (join_namespace(child, \"net\")) {\n\t\tfprintf(stderr, \"Error: cannot join the network namespace\\n\");\n\t\texit(1);\n\t}\n\n\t// set run file\n\tif (strcmp(command, \"set\") == 0)\n\t\tbandwidth_set(pid, dev, down, up);\n\telse if (strcmp(command, \"clear\") == 0)\n\t\tbandwidth_remove(pid, dev);\n\n\t//************************\n\t// build command\n\t//************************\n\tchar *devname = NULL;\n\tif (dev) {\n\t\t// read network map file\n\t\tchar *fname;\n\t\tif (asprintf(&fname, \"%s/%d-netmap\", RUN_FIREJAIL_NETWORK_DIR, (int) pid) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tFILE *fp = fopen(fname, \"r\");\n\t\tif (!fp) {\n\t\t\tfprintf(stderr, \"Error: cannot read network map file %s\\n\", fname);\n\t\t\texit(1);\n\t\t}\n\t\t\n\t\tchar buf[1024];\n\t\tint len = strlen(dev);\n\t\twhile (fgets(buf, 1024, fp)) {\n\t\t\t// remove '\\n'\n\t\t\tchar *ptr = strchr(buf, '\\n');\n\t\t\tif (ptr)\n\t\t\t\t*ptr = '\\0';\n\t\t\tif (*buf == '\\0')\n\t\t\t\tbreak;\n\n\t\t\tif (strncmp(buf, dev, len) == 0  && buf[len] == ':') {\n\t\t\t\tdevname = strdup(buf + len + 1);\n\t\t\t\tif (!devname)\n\t\t\t\t\terrExit(\"strdup\");\n\t\t\t\t// check device in namespace\n\t\t\t\tif (if_nametoindex(devname) == 0) {\n\t\t\t\t\tfprintf(stderr, \"Error: cannot find network device %s\\n\", devname);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfree(fname);\n\t\tfclose(fp);\n\t}\n\t\n\t// build fshaper.sh command\n\tchar *cmd = NULL;\n\tif (devname) {\n\t\tif (strcmp(command, \"set\") == 0) {\n\t\t\tif (asprintf(&cmd, \"%s/firejail/fshaper.sh --%s %s %d %d\",\n\t\t\t\tLIBDIR, command, devname, down, up) == -1)\n\t\t\t\terrExit(\"asprintf\");\n\t\t}\n\t\telse {\n\t\t\tif (asprintf(&cmd, \"%s/firejail/fshaper.sh --%s %s\",\n\t\t\t\tLIBDIR, command, devname) == -1)\n\t\t\t\terrExit(\"asprintf\");\n\t\t}\n\t}\n\telse {\n\t\tif (asprintf(&cmd, \"%s/firejail/fshaper.sh --%s\", LIBDIR, command) == -1)\n\t\t\terrExit(\"asprintf\");\n\t}\n\tassert(cmd);\n\n\t// wipe out environment variables\n\tenviron = NULL;\n\n\t//************************\n\t// build command\n\t//************************\n\t// elevate privileges\n\tif (setreuid(0, 0))\n\t\terrExit(\"setreuid\");\n\tif (setregid(0, 0))\n\t\terrExit(\"setregid\");\n\n\tif (!cfg.shell)\n\t\tcfg.shell = guess_shell();\n\tif (!cfg.shell) {\n\t\tfprintf(stderr, \"Error: no POSIX shell found, please use --shell command line option\\n\");\n\t\texit(1);\n\t}\n\n\tchar *arg[4];\n\targ[0] = cfg.shell;\n\targ[1] = \"-c\";\n\targ[2] = cmd;\n\targ[3] = NULL;\n\tclearenv();\n\texecvp(arg[0], arg);\n\t\n\t// it will never get here\n\terrExit(\"execvp\");\n}\n"], "fixing_code": ["firejail (0.9.45) baseline; urgency=low\n  * development version, work in progress\n  * security: --bandwidth root shel found by Martin Carpenter\n  * security: disabled --allow-debuggers when running on kernel\n    versions prior to 4.8; a kernel bug in ptrace system call\n    allows a full bypass of seccomp filter; problem reported by Lizzie Dixon\n  * security: overwrite /etc/resolv.conf found by Martin Carpenter\n  * secuirty: TOCTOU exploit for --get and --put found by Daniel Hodson\n  * security: invalid environment exploit found by Martin Carpenter\n  * security: split most of networking code in a separate executable\n  * security: split seccomp filter code configuration in a separate executable\n  * security: split file copying in private option in a separate executable\n  * security: root exploit found by Sebastian Krahmer\n  * feature: disable gnupg and systemd directories under /run/user\n  * feature: allow root user access to /dev/shm (--noblacklist=/dev/shm)\n  * feature: AppImage type 2 support\n  * feature: test coverage (gcov) support\n  * feature: private /opt directory (--private-opt, profile support)\n  * feature: private /srv directory (--private-srv, profile support)\n  * feature: spoof machine-id\n  * feature: config support for firejail prompt in terminals\n  * feature: pass command line arguments to appimages\n  * feature: --allow-private-blacklist option\n  * feature: allow non-seccomp setup for OverlayFS sandboxes\n  * feature: added a number o Python scripts for handling sandboxes\n  * new profiles: xiphos, Tor Browser Bundle, display (imagemagik), Wire,\n  * new profiles: mumble, zoom, Guayadeque, qemu, keypass2, xed, pluma,\n  * new profiles: Cryptocat, Bless, Gnome 2048, Gnome Calculator,\n  * new profiles: Gnome Contacts, JD-GUI, Lollypop, MultiMC5, PDFSam, Pithos,\n  * new profies: Xonotic, wireshark, keepassx2, QupZilla, FossaMail\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sun, 23 Oct 2016 08:00:00 -0500\n\nfirejail (0.9.44) baseline; urgency=low\n  * CVE-2016-7545 submitted by Aleksey Manevich\n  * modifs: removed man firejail-config\n  * modifs: --private-tmp whitelists /tmp/.X11-unix directory\n  * modifs: Nvidia drivers added to --private-dev\n  * modifs: /srv supported by --whitelist\n  * feature: allow user access to /sys/fs (--noblacklist=/sys/fs)\n  * feature: support starting/joining sandbox is a single command\n    (--join-or-start)\n  * feature: X11 detection support for --audit\n  * feature: assign a name to the interface connected to the bridge\n    (--veth-name)\n  * feature: all user home directories are visible (--allusers)\n  * feature: add files to sandbox container (--put)\n  * feature: blocking x11 (--x11=block)\n  * feature: X11 security extension (--x11=xorg)\n  * feature: disable 3D hardware acceleration (--no3d)\n  * feature: x11 xpra, x11 xephyr, x11 block, allusers, no3d profile commands\n  * feature: move files in sandbox (--put)\n  * feature: accept wildcard patterns in user  name field of restricted\n    shell login feature\n  * new profiles: qpdfview, mupdf, Luminance HDR, Synfig Studio, Gimp, Inkscape\n  * new profiles: feh, ranger, zathura, 7z, keepass, keepassx,\n  * new profiles: claws-mail, mutt, git, emacs, vim, xpdf, VirtualBox, OpenShot\n  * new profiles: Flowblade, Eye of GNOME (eog), Evolution\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Fri, 21 Oct 2016 08:00:00 -0500\n\nfirejail (0.9.42) baseline; urgency=low\n  * security: --whitelist deleted files, submitted by Vasya Novikov\n  * security: disable x32 ABI in seccomp, submitted by Jann Horn\n  * security: tighten --chroot, submitted by Jann Horn\n  * security: terminal sandbox escape, submitted by Stephan Sokolow\n  * security: several TOCTOU fixes submitted by Aleksey Manevich\n  * modifs: bringing back --private-home option\n  * modifs: deprecated --user option, please use \"sudo -u username firejail\"\n  * modifs: allow symlinks in home directory for --whitelist option\n  * modifs: Firejail prompt is enabled by env variable FIREJAIL_PROMPT=\"yes\"\n  * modifs: recursive mkdir\n  * modifs: include /dev/snd in --private-dev\n  * modifs: seccomp filter update\n  * modifs: release archives moved to .xz format\n  * feature: AppImage support (--appimage)\n  * feature: AppArmor support (--apparmor)\n  * feature: Ubuntu snap support (/etc/firejail/snap.profile)\n  * feature: Sandbox auditing support (--audit)\n  * feature: remove environment variable (--rmenv)\n  * feature: noexec support (--noexec)\n  * feature: clean local overlay storage directory (--overlay-clean)\n  * feature: store and reuse overlay (--overlay-named)\n  * feature: allow debugging inside the sandbox with gdb and strace\n         (--allow-debuggers)\n  * feature: mkfile profile command\n  * feature: quiet profile command\n  * feature: x11 profile command\n  * feature: option to fix desktop files (firecfg --fix)\n  * compile time: Busybox support (--enable-busybox-workaround)\n  * compile time: disable overlayfs (--disable-overlayfs)\n  * compile time: disable whitlisting (--disable-whitelist)\n  * compile time: disable global config (--disable-globalcfg)\n  * run time: enable/disable overlayfs (overlayfs yes/no)\n  * run time: enable/disable  quiet as default (quiet-by-default yes/no)\n  * run time: user-defined network filter (netfilter-default)\n  * run time: enable/disable whitelisting (whitelist yes/no)\n  * run time: enable/disable remounting of /proc and /sys\n          (remount-proc-sys yes/no)\n  * run time: enable/disable chroot desktop features (chroot-desktop yes/no)\n  * profiles: Gitter, gThumb, mpv, Franz messenger, LibreOffice\n  * profiles: pix, audacity, xz, xzdec, gzip, cpio, less\n  * profiles: Atom Beta, Atom, jitsi, eom, uudeview\n  * profiles: tar (gtar), unzip, unrar, file, skypeforlinux,\n  * profiles: inox, Slack, gnome-chess. Gajim IM client, DOSBox\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Thu, 8 Sept 2016 08:00:00 -0500\n\nfirejail (0.9.40) baseline; urgency=low\n  * added --nice option\n  * added --x11 option\n  * added --x11=xpra option\n  * added --x11=xephyr option\n  * added --cpu.print option\n  * added filetransfer options --ls and --get\n  * added --writable-etc and --writable-var options\n  * added --read-only option\n  * added mkdir, ipc-namespace, and nosound profile commands\n  * added net, ip, defaultgw, ip6, mac, mtu and iprange profile commands\n  * --version also prints compile options\n  * --output option also redirects stderr\n  * added compile-time option to restrict --net= to root only\n  * run time config support, man firejail-config\n  * added firecfg utility\n  * AppArmor fixes\n  * default seccomp filter update\n  * disable STUN/WebRTC in default netfilter configuration\n  * new profiles: lxterminal, Epiphany, cherrytree, Polari, Vivaldi, Atril\n  * new profiles: qutebrowser, SlimJet, Battle for Wesnoth, Hedgewars\n  * new profiles: qTox, OpenSSH client, OpenBox, Dillo, cmus, dnsmasq\n  * new profiles: PaleMoon, Icedove, abrowser, 0ad, netsurf, Warzone2100\n  * new profiles: okular, gwenview, Google-Play-Music-Desktop-Player\n  * new profiles: Aweather, Stellarium, gpredict, quiterss, cyberfox\n  * new profiles: generic Ubuntu snap application profile, xplayer\n  * new profiles: xreader, xviewer, mcabber, Psi+, Corebird, Konversation\n  * new profiles: Brave, Gitter\n  * generic.profile renamed default.profile\n  * build rpm packages using \"make rpms\"\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sun, 29 May 2016 08:00:00 -0500\n\nfirejail (0.9.38) baseline; urgency=low\n  * IPv6 support (--ip6 and --netfilter6)\n  * --join command enhancement (--join-network, --join-filesystem)\n  * added --user command\n  * added --disable-network and --disable-userns compile time flags\n  * Centos 6 support\n  * symlink invocation\n  * added KMail, Seamonkey, Telegram, Mathematica, uGet,\n  *   and mupen64plus profiles\n  * --chroot in user mode allowed only if seccomp support is available\n  *   in current Linux kernel\n  * deprecated --private-home feature\n  * the first protocol list installed takes precedence\n  * --tmpfs option allowed only running as root\n  * added --private-tmp option\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Tue, 2 Feb 2016 10:00:00 -0500\n\nfirejail (0.9.36) baseline; urgency=low\n  * added  unbound, dnscrypt-proxy, BitlBee, HexChat, WeeChat,\n     parole and rtorrent profiles\n  * Google Chrome profile rework\n  * added google-chrome-stable profile\n  * added google-chrome-beta profile\n  * added google-chrome-unstable profile\n  * Opera profile rework\n  * added opera-beta profile\n  * added --noblacklist option\n  * added --profile-path option\n  * added --force option\n  * whitelist command enhancements\n  * prevent user name enumeration\n  * added /etc/firejail/nolocal.net network filter\n  * added /etc/firejail/webserver.net network filter\n  * blacklisting firejail configuration by default\n  * allow default gateway configuration for --interface option\n  * --debug enhancements: --debug-check-filenames, --debug-blacklists,\n    --debug-whitelists\n  * filesystem log\n  * libtrace enhancements, tracing opendir call\n  * added --tracelog option\n  * added \"name\" command to profile files\n  * added \"hostname\" command to profile files\n  * added automated feature testing framework\n  * Debian reproducible build\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sun, 27 Dec 2015 09:00:00 -0500\n\nfirejail (0.9.34) baseline; urgency=low\n  * added --ignore option\n  * added --protocol option\n  * support dual i386/amd64 seccomp filters\n  * added Google Chrome profile\n  * added Steam, Skype, Wine and Conkeror profiles\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sat, 7 Nov 2015 08:00:00 -0500\n\nfirejail (0.9.32) baseline; urgency=low\n  * added --interface option\n  * added --mtu option\n  * added --private-bin option\n  * added --nosound option\n  * added --hostname option\n  * added --quiet option\n  * added seccomp errno support\n  * added FBReader default profile\n  * added Spotify default profile\n  * lots of default security profile changes\n  * fixed a security problem on multi-user systems\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Wed, 21 Oct 2015 08:00:00 -0500\n\n\nfirejail (0.9.30) baseline; urgency=low\n  * added a disable-history.inc profile as a result of Firefox PDF.js exploit;\n    disable-history.inc included in all default profiles\n  * Firefox PDF.js exploit (CVE-2015-4495) fixes\n  * added --private-etc option\n  * added --env option\n  * added --whitelist option\n  * support ${HOME} token in include directive in profile files\n  * --private.keep is transitioned to --private-home\n  * support ~ and blanks in blacklist option\n  * support \"net none\" command in profile files\n  * using /etc/firejail/generic.profile by default for user sessions\n  * using /etc/firejail/server.profile by default for root sessions\n  * added build --enable-fatal-warnings configure option\n  * added persistence to --overlay option\n  * added --overlay-tmpfs option\n  * make install-strip implemented, make install renamed\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Mon, 14 Sept 2015 08:00:00 -0500\n\nfirejail (0.9.28) baseline; urgency=low\n  * network scanning, --scan option\n  * interface MAC address support, --mac option\n  * IP address range, --iprange option\n  * traffic shaping, --bandwidth option\n  * reworked printing of network status at startup\n  * man pages rework\n  * added firejail-login man page\n  * added GNU Icecat, FileZilla, Pidgin, XChat, Empathy, DeaDBeeF default\n    profiles\n  * added an /etc/firejail/disable-common.inc file to hold common directory\n    blacklists\n  * blacklist Opera and Chrome/Chromium config directories in profile files\n  * support noroot option for profile files\n  * enabled noroot in default profile files\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Sat, 1 Aug 2015 08:00:00 -0500\n\nfirejail (0.9.26) baseline; urgency=low\n  * private dev directory\n  * private.keep option for whitelisting home files in a new private directory\n  * user namespaces support, noroot option\n  * added Deluge and qBittorent profiles\n  * bugfixes\n -- netblue30 <netblue30@yahoo.com>  Thu, 30 Apr 2015 08:00:00 -0500\n\n\nfirejail (0.9.24) baseline; urgency=low\n  * whitelist and blacklist seccomp filters\n  * doubledash option\n  * --shell=none support\n  * netfilter file support in profile files\n  * dns server support in profile files\n  * added --dns.print option\n  * added default profiles for Audacious, Clementine, Gnome-MPlayer, Rhythmbox and Totem.\n  * added --caps.drop=all in default profiles\n  * new syscalls in default seccomp filter: sysfs, sysctl, adjtimex, kcmp\n  *         clock_adjtime, lookup_dcookie, perf_event_open, fanotify_init\n  * Bugfix: using /proc/sys/kernel/pid_max for the max number of pids\n  * two build patches from Reiner Herman (tickets 11, 12)\n  * man page patch from Reiner Herman (ticket 13)\n  * output patch (ticket 15) from sshirokov\n\n -- netblue30 <netblue30@yahoo.com>  Sun, 5 Apr 2015 08:00:00 -0500\n\nfirejail (0.9.22) baseline; urgency=low\n  * Replaced --noip option with --ip=none\n  * Container stdout logging and log rotation\n  * Added process_vm_readv, process_vm_writev and mknod to\n  *    default seccomp blacklist\n  * Added CAP_MKNOD to default caps blacklist\n  * Blacklist and whitelist custom Linux capabilities filters\n  * macvlan device driver support for --net option\n  * DNS server support, --dns option\n  * Netfilter support\n  * Monitor network statistics, --netstats option\n  * Added profile for Mozilla Thunderbird/Icedove\n  * - --overlay support for Linux kernels 3.18+\n  * Bugfix: preserve .Xauthority file in private mode (test with ssh -X)\n  * Bugfix: check uid/gid for cgroup\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 9 Mar 2015 09:00:00 -0500\n\nfirejail (0.9.20) baseline; urgency=low\n  * utmp, btmp and wtmp enhancements\n  *    create empty /var/log/wtmp and /var/log/btmp files in sandbox\n  *    generate a new /var/run/utmp file in sandbox\n  * CPU affinity, --cpu option\n  * Linux control groups support, --cgroup option\n  * Opera web browser support\n  * VLC support\n  * Added \"empty\" attribute to seccomp command to remove the default\n  *    syscall list form seccomp blacklist\n  * Added --nogroups option to disable supplementary groups for regular\n  *   users. root user always runs without supplementary groups.\n  * firemon enhancements\n  *   display the command that started the sandbox\n  *   added --caps option to display capabilities for all sandboxes\n  *   added --cgroup option to display the control groups for all sandboxes\n  *   added --cpu option to display CPU affinity for all sandboxes\n  *   added --seccomp option to display seccomp setting for all sandboxes\n  * New compile time options: --disable-chroot, --disable-bind\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 02 Feb 2015 08:00:00 -0500\n\nfirejail (0.9.18) baseline; urgency=low\n  * Support for tracing system, setuid, setgid, setfsuid, setfsgid syscalls\n  * Support for tracing setreuid, setregid, setresuid, setresguid syscalls\n  * Added profiles for transmission-gtk and transmission-qt\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Fri, 25 Dec 2014 10:00:00 -0500\n\nfirejail (0.9.16) baseline; urgency=low\n  * Configurable private home directory\n  * Configurable default user shell\n  * Software configuration support for --docdir and DESTDIR\n  * Profile file support for include, caps, seccomp and private keywords\n  * Dropbox profile file\n  * Linux capabilities and seccomp filters enabled by default for Firefox,\n  Midori, Evince and Dropbox\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Tue, 4 Nov 2014 10:00:00 -0500\n\nfirejail (0.9.14) baseline; urgency=low\n  * Linux capabilities and seccomp filters are automatically enabled in\n    chroot mode (--chroot option) if the sandbox is started as regular user\n  * Added support for user defined seccomp blacklists\n  * Added syscall trace support\n  * Added --tmpfs option\n  * Added --balcklist option\n  * Added --read-only option\n  * Added --bind option\n  * Logging enhancements\n  * --overlay option was reactivated\n  * Added firemon support to print the ARP table for each sandbox\n  * Added firemon support to print the route table for each sandbox\n  * Added firemon support to print interface information for each sandbox\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Tue, 15 Oct 2014 10:00:00 -0500\n\nfirejail (0.9.12.2) baseline; urgency=low\n  * Fix for pulseaudio problems\n  * --overlay option was temporarily disabled in this build\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 29 Sept 2014 07:00:00 -0500\n\nfirejail (0.9.12.1) baseline; urgency=low\n  * Fix for pulseaudio problems\n  * --overlay option was temporarily disabled in this build\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 22 Sept 2014 09:00:00 -0500\n\nfirejail (0.9.12) baseline; urgency=low\n  * Added capabilities support\n  * Added support for CentOS 7\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Mon, 15 Sept 2014 10:00:00 -0500\n\nfirejail (0.9.10) baseline; urgency=low\n  * Disable /proc/kcore, /proc/kallsyms, /dev/port, /boot\n  * Fixed --top option CPU utilization calculation\n  * Implemented --tree option in firejail and firemon\n  * Implemented --join=name option\n  * Implemented --shutdown option\n  * Preserve the current working directory if possible\n  * Cppcheck and clang errors cleanup\n  * Added a Chromium web browser profile\n\n -- netblue30 <netblue30@yahoo.com>  Thu, 28 Aug 2014 07:00:00 -0500\n\nfirejail (0.9.8.1) baseline; urgency=low\n  * FIxed a number of bugs introduced in 0.9.8\n\n -- netblue30 <netblue30@yahoo.com>  Fri, 25 Jul 2014 07:25:00 -0500\n\nfirejail (0.9.8) baseline; urgency=low\n  * Implemented nowrap mode for firejail --list command option\n  * Added --top option in both firejail and firemon\n  * seccomp filter support\n  * Added pid support for firemon\n  * bugfixes\n\n -- netblue30 <netblue30@yahoo.com>  Tue, 24 Jul 2014 08:51:00 -0500\n\nfirejail (0.9.6) baseline; urgency=low\n\n  * Mounting tmpfs on top of /var/log, required by several server programs\n  * Server fixes for /var/lib and /var/cache\n  * Private mode fixes\n  * csh and zsh default shell support\n  * Chroot mode fixes\n  * Added support for lighttpd, isc-dhcp-server, apache2, nginx, snmpd,\n\n -- netblue30 <netblue30@yahoo.com>  Sat, 7 Jun 2014 09:00:00 -0500\n\nfirejail (0.9.4) baseline; urgency=low\n\n  * Fixed resolv.conf on Ubuntu systems using DHCP\n  * Fixed resolv.conf on Debian systems using resolvconf package\n  * Fixed /var/lock directory\n  * Fixed /var/tmp directory\n  * Fixed symbolic links in profile files\n  * Added profiles for evince, midori\n\n -- netblue30 <netblue30@yahoo.com>  Sun, 4 May 2014 08:00:00 -0500\n\nfirejail (0.9.2) baseline; urgency=low\n\n  * Checking IP address passed with --ip option using ARP; exit if the address\n   is already present\n  * Using a lock file during ARP address assignment in order to removed a race\n   condition.\n  * Several fixes to --private option; it also mounts a tmpfs filesystem on top\n   of /tmp\n  * Added user access check for profile file\n  * Added --defaultgw option\n  * Added support of --noip option; it is necessary for DHCP setups\n  * Added syslog support\n  * Added support for \"tmpfs\" and \"read-only\" profile commands\n  * Added an expect-based testing framework for the project\n  * Added bash completion support\n  * Added support for multiple networks\n\n -- netblue30 <netblue30@yahoo.com>  Fri, 25 Apr 2014 08:00:00 -0500\n\nfirejail (0.9) baseline; urgency=low\n\n  * First beta version\n\n -- netblue30 <netblue30@yahoo.com>  Sat, 12 Apr 2014 09:00:00 -0500\n", "/*\n * Copyright (C) 2014-2016 Firejail Authors\n *\n * This file is part of firejail project\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation; either version 2 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License along\n * with this program; if not, write to the Free Software Foundation, Inc.,\n * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n*/\n#define _GNU_SOURCE\n#include <stdio.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <net/if.h>\n#include \"firejail.h\"\n\n//***********************************\n// interface bandwidth linked list\n//***********************************\ntypedef struct ifbw_t {\n\tstruct ifbw_t *next;\n\tchar *txt;\n} IFBW;\nIFBW *ifbw = NULL;\n\n\n#if 0\nstatic void ifbw_print(void) {\n\tIFBW *ptr = ifbw;\n\twhile (ptr) {\n\t\tprintf(\"#%s#\\n\", ptr->txt);\n\t\tptr = ptr->next;\n\t}\n}\n#endif\n\nstatic void ifbw_add(IFBW *ptr) {\n\tassert(ptr);\n\n\tif (ifbw != NULL)\n\t\tptr->next = ifbw;\n\tifbw = ptr;\n}\n\n\nIFBW *ifbw_find(const char *dev) {\n\tassert(dev);\n\tint len = strlen(dev);\n\tassert(len);\n\t\n\tif (ifbw == NULL)\n\t\treturn NULL;\n\t\n\tIFBW *ptr = ifbw;\n\twhile (ptr) {\n\t\tif (strncmp(ptr->txt, dev, len) == 0 && ptr->txt[len] == ':')\n\t\t\treturn ptr;\n\t\tptr = ptr->next;\n\t}\n\t\n\treturn NULL;\n}\n\nvoid ifbw_remove(IFBW *r) {\n\tif (ifbw == NULL)\n\t\treturn;\n\t\n\t// remove the first element\n\tif (ifbw == r) {\n\t\tifbw = ifbw->next;\n\t\treturn;\n\t}\n\t\n\t// walk the list\n\tIFBW *ptr = ifbw->next;\n\tIFBW *prev = ifbw;\n\twhile (ptr) {\n\t\tif (ptr == r) {\n\t\t\tprev->next = ptr->next;\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tprev = ptr;\n\t\tptr = ptr->next;\n\t}\t\n\t\n\treturn;\n}\n\nint fibw_count(void) {\n\tint rv = 0;\n\tIFBW *ptr = ifbw;\n\n\twhile (ptr) {\n\t\trv++;\n\t\tptr = ptr->next;\n\t}\n\t\n\treturn rv;\n}\n\t\n\n//***********************************\n// run file handling\n//***********************************\nstatic void bandwidth_create_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\t\n\t// if the file already exists, do nothing\n\tstruct stat s;\n\tif (stat(fname, &s) == 0) {\n\t\tfree(fname);\n\t\treturn;\n\t}\n\n\t// create an empty file and set mod and ownership\n\t/* coverity[toctou] */\n\tFILE *fp = fopen(fname, \"w\");\n\tif (fp) {\n\t\tSET_PERMS_STREAM(fp, 0, 0, 0644);\n\t\tfclose(fp);\n\t}\n\telse {\n\t\tfprintf(stderr, \"Error: cannot create bandwidth file\\n\");\n\t\texit(1);\n\t}\n\t\n\tfree(fname);\n}\n\n// delete bandwidth file\nvoid bandwidth_del_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\tunlink(fname);\n\tfree(fname);\n}\n\nvoid network_del_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-netmap\", RUN_FIREJAIL_NETWORK_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\tunlink(fname);\n\tfree(fname);\n}\n\nvoid network_set_run_file(pid_t pid) {\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-netmap\", RUN_FIREJAIL_NETWORK_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\t\n\t// create an empty file and set mod and ownership\n\tFILE *fp = fopen(fname, \"w\");\n\tif (fp) {\n\t\tif (cfg.bridge0.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge0.dev, cfg.bridge0.devsandbox);\n\t\tif (cfg.bridge1.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge1.dev, cfg.bridge1.devsandbox);\n\t\tif (cfg.bridge2.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge2.dev, cfg.bridge2.devsandbox);\n\t\tif (cfg.bridge3.configured)\n\t\t\tfprintf(fp, \"%s:%s\\n\", cfg.bridge3.dev, cfg.bridge3.devsandbox);\n\n\t\tSET_PERMS_STREAM(fp, 0, 0, 0644);\n\t\tfclose(fp);\n\t}\n\telse {\n\t\tfprintf(stderr, \"Error: cannot create network map file\\n\");\n\t\texit(1);\n\t}\n\t\n\tfree(fname);\n}\n\n\nstatic void read_bandwidth_file(pid_t pid) {\n\tassert(ifbw == NULL);\n\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\n\tFILE *fp = fopen(fname, \"r\");\n\tif (fp) {\n\t\tchar buf[1024];\n\t\twhile (fgets(buf, 1024,fp)) {\n\t\t\t// remove '\\n'\n\t\t\tchar *ptr = strchr(buf, '\\n');\n\t\t\tif (ptr)\n\t\t\t\t*ptr = '\\0';\n\t\t\tif (strlen(buf) == 0)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\t// create a new IFBW entry\n\t\t\tIFBW *ifbw_new = malloc(sizeof(IFBW));\n\t\t\tif (!ifbw_new)\n\t\t\t\terrExit(\"malloc\");\n\t\t\tmemset(ifbw_new, 0, sizeof(IFBW));\n\t\t\tifbw_new->txt = strdup(buf);\n\t\t\tif (!ifbw_new->txt)\n\t\t\t\terrExit(\"strdup\");\n\t\t\t\n\t\t\t// add it to the linked list\n\t\t\tifbw_add(ifbw_new);\n\t\t}\t\n\t\t\n\t\tfclose(fp);\t\t\n\t}\n}\n\nstatic void write_bandwidth_file(pid_t pid) {\n\tif (ifbw == NULL)\n\t\treturn; // nothing to do\n\n\tchar *fname;\n\tif (asprintf(&fname, \"%s/%d-bandwidth\", RUN_FIREJAIL_BANDWIDTH_DIR, (int) pid) == -1)\n\t\terrExit(\"asprintf\");\n\n\tFILE *fp = fopen(fname, \"w\");\n\tif (fp) {\n\t\tIFBW *ptr = ifbw;\n\t\twhile (ptr) {\n\t\t\tif (fprintf(fp, \"%s\\n\", ptr->txt) < 0)\n\t\t\t\tgoto errout;\n\t\t\tptr = ptr->next;\n\t\t}\n\t\tfclose(fp);\n\t}\n\telse\n\t\tgoto errout;\n\treturn;\n\nerrout:\n\tfprintf(stderr, \"Error: cannot write bandwidth file %s\\n\", fname);\n\texit(1);\n}\n\n//***********************************\n// add or remove interfaces\n//***********************************\n\n// remove interface from run file\nvoid bandwidth_remove(pid_t pid, const char *dev) {\n\tbandwidth_create_run_file(pid);\n\t\n\t// read bandwidth file\n\tread_bandwidth_file(pid);\n\t\n\t// find the element and remove it\n\tIFBW *elem = ifbw_find(dev);\n\tif (elem) {\n\t\tifbw_remove(elem);\n\t\twrite_bandwidth_file(pid) ;\n\t}\n\t\n\t// remove the file if there are no entries in the list\n\tif (ifbw == NULL) {\n\t\t bandwidth_del_run_file(pid);\n\t}\n}\n\n// add interface to run file\nvoid bandwidth_set(pid_t pid, const char *dev, int down, int up) {\n\t// create bandwidth directory & file in case they are not in the filesystem yet\n\tbandwidth_create_run_file(pid);\n\n\t// create the new text entry\n\tchar *txt;\n\tif (asprintf(&txt, \"%s: RX %dKB/s, TX %dKB/s\", dev, down, up) == -1)\n\t\terrExit(\"asprintf\");\n\t\n\t// read bandwidth file\n\tread_bandwidth_file(pid);\n\n\t// look for an existing entry and replace the text\n\tIFBW *ptr = ifbw_find(dev);\n\tif (ptr) {\n\t\tassert(ptr->txt);\n\t\tfree(ptr->txt);\n\t\tptr->txt = txt;\n\t}\n\t// ... or add a new entry\n\telse {\n\t\tIFBW *ifbw_new = malloc(sizeof(IFBW));\n\t\tif (!ifbw_new)\n\t\t\terrExit(\"malloc\");\n\t\tmemset(ifbw_new, 0, sizeof(IFBW));\n\t\tifbw_new->txt = txt;\n\t\t\n\t\t// add it to the linked list\n\t\tifbw_add(ifbw_new);\n\t}\n\twrite_bandwidth_file(pid) ;\n}\n\n\n//***********************************\n// command execution\n//***********************************\nvoid bandwidth_pid(pid_t pid, const char *command, const char *dev, int down, int up) {\n\tEUID_ASSERT();\n\t//************************\n\t// verify sandbox\n\t//************************\n\tEUID_ROOT();\n\tchar *comm = pid_proc_comm(pid);\n\tEUID_USER();\n\tif (!comm) {\n\t\tfprintf(stderr, \"Error: cannot find sandbox\\n\");\n\t\texit(1);\n\t}\n\n\t// check for firejail sandbox\n\tif (strcmp(comm, \"firejail\") != 0) {\n\t\tfprintf(stderr, \"Error: cannot find sandbox\\n\");\n\t\texit(1);\n\t}\n\tfree(comm);\n\t\n\t// check network namespace\n\tchar *name;\n\tif (asprintf(&name, \"/run/firejail/network/%d-netmap\", pid) == -1)\n\t\terrExit(\"asprintf\");\n\tstruct stat s;\n\tif (stat(name, &s) == -1) {\n\t\tfprintf(stderr, \"Error: the sandbox doesn't use a new network namespace\\n\");\n\t\texit(1);\n\t}\n\n\t//************************\n\t// join the network namespace\n\t//************************\n\tpid_t child;\n\tif (find_child(pid, &child) == -1) {\n\t\tfprintf(stderr, \"Error: cannot join the network namespace\\n\");\n\t\texit(1);\n\t}\n\n\tEUID_ROOT();\n\tif (join_namespace(child, \"net\")) {\n\t\tfprintf(stderr, \"Error: cannot join the network namespace\\n\");\n\t\texit(1);\n\t}\n\n\t// set run file\n\tif (strcmp(command, \"set\") == 0)\n\t\tbandwidth_set(pid, dev, down, up);\n\telse if (strcmp(command, \"clear\") == 0)\n\t\tbandwidth_remove(pid, dev);\n\n\t//************************\n\t// build command\n\t//************************\n\tchar *devname = NULL;\n\tif (dev) {\n\t\t// read network map file\n\t\tchar *fname;\n\t\tif (asprintf(&fname, \"%s/%d-netmap\", RUN_FIREJAIL_NETWORK_DIR, (int) pid) == -1)\n\t\t\terrExit(\"asprintf\");\n\t\tFILE *fp = fopen(fname, \"r\");\n\t\tif (!fp) {\n\t\t\tfprintf(stderr, \"Error: cannot read network map file %s\\n\", fname);\n\t\t\texit(1);\n\t\t}\n\t\t\n\t\tchar buf[1024];\n\t\tint len = strlen(dev);\n\t\twhile (fgets(buf, 1024, fp)) {\n\t\t\t// remove '\\n'\n\t\t\tchar *ptr = strchr(buf, '\\n');\n\t\t\tif (ptr)\n\t\t\t\t*ptr = '\\0';\n\t\t\tif (*buf == '\\0')\n\t\t\t\tbreak;\n\n\t\t\tif (strncmp(buf, dev, len) == 0  && buf[len] == ':') {\n\t\t\t\tdevname = strdup(buf + len + 1);\n\t\t\t\tif (!devname)\n\t\t\t\t\terrExit(\"strdup\");\n\t\t\t\t// check device in namespace\n\t\t\t\tif (if_nametoindex(devname) == 0) {\n\t\t\t\t\tfprintf(stderr, \"Error: cannot find network device %s\\n\", devname);\n\t\t\t\t\texit(1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfree(fname);\n\t\tfclose(fp);\n\t}\n\t\n\t// build fshaper.sh command\n\tchar *cmd = NULL;\n\tif (devname) {\n\t\tif (strcmp(command, \"set\") == 0) {\n\t\t\tif (asprintf(&cmd, \"%s/firejail/fshaper.sh --%s %s %d %d\",\n\t\t\t\tLIBDIR, command, devname, down, up) == -1)\n\t\t\t\terrExit(\"asprintf\");\n\t\t}\n\t\telse {\n\t\t\tif (asprintf(&cmd, \"%s/firejail/fshaper.sh --%s %s\",\n\t\t\t\tLIBDIR, command, devname) == -1)\n\t\t\t\terrExit(\"asprintf\");\n\t\t}\n\t}\n\telse {\n\t\tif (asprintf(&cmd, \"%s/firejail/fshaper.sh --%s\", LIBDIR, command) == -1)\n\t\t\terrExit(\"asprintf\");\n\t}\n\tassert(cmd);\n\n\t// wipe out environment variables\n\tenviron = NULL;\n\n\t//************************\n\t// build command\n\t//************************\n\t// elevate privileges\n\tif (setreuid(0, 0))\n\t\terrExit(\"setreuid\");\n\tif (setregid(0, 0))\n\t\terrExit(\"setregid\");\n\n\tchar *arg[4];\n\targ[0] = \"/bin/sh\";\n\targ[1] = \"-c\";\n\targ[2] = cmd;\n\targ[3] = NULL;\n\tclearenv();\n\texecvp(arg[0], arg);\n\t\n\t// it will never get here\n\terrExit(\"execvp\");\n}\n"], "filenames": ["RELNOTES", "src/firejail/bandwidth.c"], "buggy_code_start_loc": [2, 438], "buggy_code_end_loc": [2, 447], "fixing_code_start_loc": [3, 437], "fixing_code_end_loc": [4, 440], "type": "CWE-269", "message": "Firejail before 0.9.44.4, when running a bandwidth command, allows local users to gain root privileges via the --shell argument.", "other": {"cve": {"id": "CVE-2017-5207", "sourceIdentifier": "cve@mitre.org", "published": "2017-03-23T16:59:00.447", "lastModified": "2019-10-03T00:03:26.223", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Firejail before 0.9.44.4, when running a bandwidth command, allows local users to gain root privileges via the --shell argument."}, {"lang": "es", "value": "Firejail en versiones anteriores a 0.9.44.4, Cuando se ejecuta un comando de ancho de banda, permite a los usuarios locales obtener privilegios de root a trav\u00e9s del argumento --shell."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:firejail_project:firejail:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.9.44.4", "matchCriteriaId": "7CEF9414-DBF1-4FFC-BFF7-48E094599AD5"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2017/01/07/6", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/97385", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://firejail.wordpress.com/download-2/release-notes/", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://github.com/netblue30/firejail/commit/5d43fdcd215203868d440ffc42036f5f5ffc89fc", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/netblue30/firejail/issues/1023", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://security.gentoo.org/glsa/201701-62", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/netblue30/firejail/commit/5d43fdcd215203868d440ffc42036f5f5ffc89fc"}}