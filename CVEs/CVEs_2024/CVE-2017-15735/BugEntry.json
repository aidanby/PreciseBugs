{"buggy_code": ["<?php\n/**\n * Displays a form to add a glossary item.\n *\n * PHP Version 5.5\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @category  phpMyFAQ\n *\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2005-2017 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n *\n * @link      http://www.phpmyfaq.de\n * @since     2005-09-15\n */\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    $protocol = 'http';\n    if (isset($_SERVER['HTTPS']) && strtoupper($_SERVER['HTTPS']) === 'ON') {\n        $protocol = 'https';\n    }\n    header('Location: '.$protocol.'://'.$_SERVER['HTTP_HOST'].dirname($_SERVER['SCRIPT_NAME']));\n    exit();\n}\n?>\n        <header class=\"row\">\n            <div class=\"col-lg-12\">\n                <h2 class=\"page-header\">\n                    <i aria-hidden=\"true\" class=\"fa fa-list-ul\"></i> <?php echo $PMF_LANG['ad_glossary_add'] ?>\n                </h2>\n            </div>\n        </header>\n\n        <div class=\"row\">\n            <div class=\"col-lg-12\">\n\n<?php\nif ($user->perm->checkRight($user->getUserId(), 'addglossary')) {\n    ?>\n                <form class=\"form-horizontal\" action=\"?action=saveglossary\" method=\"post\" accept-charset=\"utf-8\">\n                    <div class=\"form-group\">\n                        <label class=\"col-lg-2 control-label\" for=\"item\"><?php echo $PMF_LANG['ad_glossary_item'];\n    ?>:</label>\n                        <div class=\"col-lg-4\">\n                            <input class=\"form-control\" type=\"text\" name=\"item\" id=\"item\" required />\n                        </div>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <label class=\"col-lg-2 control-label\" for=\"definition\">\n                            <?php echo $PMF_LANG['ad_glossary_definition'];\n    ?>:\n                        </label>\n                        <div class=\"col-lg-4\">\n                            <textarea class=\"form-control\" name=\"definition\" id=\"definition\" cols=\"50\" rows=\"5\" required></textarea>\n                        </div>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <div class=\"col-lg-offset-2 col-lg-4\">\n                            <button class=\"btn btn-primary\" type=\"submit\">\n                                <?php echo $PMF_LANG['ad_glossary_save'];\n    ?>\n                            </button>\n                            <a class=\"btn btn-info\" href=\"?action=glossary\">\n                                <?php echo $PMF_LANG['ad_entry_back'];\n    ?>\n                            </a>\n                        </div>\n                    </div>\n                </form>\n<?php\n\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n?>\n            </div>\n        </div>", "<?php\n/**\n * Displays a form to edit an existing glossary item.\n *\n * PHP Version 5.5\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @category  phpMyFAQ\n *\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2005-2017 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n *\n * @link      http://www.phpmyfaq.de\n * @since     2005-09-15\n */\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    $protocol = 'http';\n    if (isset($_SERVER['HTTPS']) && strtoupper($_SERVER['HTTPS']) === 'ON') {\n        $protocol = 'https';\n    }\n    header('Location: '.$protocol.'://'.$_SERVER['HTTP_HOST'].dirname($_SERVER['SCRIPT_NAME']));\n    exit();\n}\n?>\n        <header class=\"row\">\n            <div class=\"col-lg-12\">\n                <h2 class=\"page-header\">\n                    <i aria-hidden=\"true\" class=\"fa fa-list-ul\"></i> <?php echo $PMF_LANG['ad_glossary_edit'] ?>\n                </h2>\n            </div>\n        </header>\n\n        <div class=\"row\">\n            <div class=\"col-lg-12\">\n<?php\nif ($user->perm->checkRight($user->getUserId(), 'editglossary')) {\n    $id = PMF_Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);\n    $glossary = new PMF_Glossary($faqConfig);\n    $glossaryItem = $glossary->getGlossaryItem($id);\n    ?>\n                <form class=\"form-horizontal\" action=\"?action=updateglossary\" method=\"post\" accept-charset=\"utf-8\">\n                    <input type=\"hidden\" name=\"id\" value=\"<?php echo $glossaryItem['id'];\n    ?>\" />\n                    <div class=\"form-group\">\n                        <label class=\"col-lg-2 control-label\" for=\"item\"><?php echo $PMF_LANG['ad_glossary_item'];\n    ?>:</label>\n                        <div class=\"col-lg-4\">\n                            <input class=\"form-control\" type=\"text\" name=\"item\" id=\"item\"\n                                   value=\"<?php echo $glossaryItem['item'];\n    ?>\" required>\n                        </div>\n                    </div>\n\n            <div class=\"control-group\">\n                <label class=\"control-label\" for=\"definition\">\n                    <?php echo $PMF_LANG['ad_glossary_definition'];\n    ?>:\n                </label>\n                <div class=\"controls\">\n                    <textarea  class=\"input-xxlarge\" name=\"definition\" id=\"definition\" cols=\"50\" rows=\"3\" required><?php echo $glossaryItem['definition'];\n    ?></textarea>\n                </div>\n            </div>\n\n                    <div class=\"form-group\">\n                        <div class=\"col-lg-offset-2 col-lg-4\">\n                            <button class=\"btn btn-primary\" type=\"submit\">\n                                <?php echo $PMF_LANG['ad_glossary_save'];\n    ?>\n                            </button>\n                            <a class=\"btn btn-info\" href=\"?action=glossary\">\n                                <?php echo $PMF_LANG['ad_entry_back'];\n    ?>\n                            </a>\n                        </div>\n                    </div>\n                </form>\n<?php\n\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n?>\n            </div>\n        </div>", "<?php\n/**\n * The main glossary index file.\n *\n * PHP Version 5.5\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @category  phpMyFAQ\n *\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2005-2017 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n *\n * @link      http://www.phpmyfaq.de\n * @since     2005-09-15\n */\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    $protocol = 'http';\n    if (isset($_SERVER['HTTPS']) && strtoupper($_SERVER['HTTPS']) === 'ON') {\n        $protocol = 'https';\n    }\n    header('Location: '.$protocol.'://'.$_SERVER['HTTP_HOST'].dirname($_SERVER['SCRIPT_NAME']));\n    exit();\n}\n?>\n        <header class=\"row\">\n            <div class=\"col-lg-12\">\n                <h2 class=\"page-header\">\n                    <i aria-hidden=\"true\" class=\"fa fa-list-ul\"></i> <?php echo $PMF_LANG['ad_menu_glossary'] ?>\n                    <div class=\"pull-right\">\n                        <a class=\"btn btn-success\" href=\"?action=addglossary\">\n                            <i aria-hidden=\"true\" class=\"fa fa-plus fa-fw\"></i> <?php echo $PMF_LANG['ad_glossary_add'] ?>\n                        </a>\n                    </div>\n                </h2>\n            </div>\n        </header>\n\n        <div class=\"row\">\n            <div class=\"col-lg-12\">\n<?php\nif ($user->perm->checkRight($user->getUserId(), 'addglossary') ||\n    $user->perm->checkRight($user->getUserId(), 'editglossary') ||\n    $user->perm->checkRight($user->getUserId(), 'delglossary')) {\n    $glossary = new PMF_Glossary($faqConfig);\n\n    if ('saveglossary' == $action && $user->perm->checkRight($user->getUserId(), 'addglossary')) {\n        $item = PMF_Filter::filterInput(INPUT_POST, 'item', FILTER_SANITIZE_SPECIAL_CHARS);\n        $definition = PMF_Filter::filterInput(INPUT_POST, 'definition', FILTER_SANITIZE_SPECIAL_CHARS);\n        if ($glossary->addGlossaryItem($item, $definition)) {\n            echo '<p class=\"alert alert-success\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_save_success'].'</p>';\n        } else {\n            echo '<p class=\"alert alert-danger\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_save_error'];\n            echo '<br />'.$PMF_LANG['ad_adus_dberr'].'<br />';\n            echo $faqConfig->getDb()->error().'</p>';\n        }\n    }\n\n    if ('updateglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary')) {\n        $id = PMF_Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);\n        $item = PMF_Filter::filterInput(INPUT_POST, 'item', FILTER_SANITIZE_SPECIAL_CHARS);\n        $definition = PMF_Filter::filterInput(INPUT_POST, 'definition', FILTER_SANITIZE_SPECIAL_CHARS);\n        if ($glossary->updateGlossaryItem($id, $item, $definition)) {\n            echo '<p class=\"alert alert-success\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_update_success'].'</p>';\n        } else {\n            echo '<p class=\"alert alert-danger\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_update_error'];\n            echo '<br />'.$PMF_LANG['ad_adus_dberr'].'<br />';\n            echo $faqConfig->getDb()->error().'</p>';\n        }\n    }\n\n    if ('deleteglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary')) {\n        $id = PMF_Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);\n        if ($glossary->deleteGlossaryItem($id)) {\n            echo '<p class=\"alert alert-success\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_delete_success'].'</p>';\n        } else {\n            echo '<p class=\"alert alert-danger\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_delete_error'];\n            echo '<br />'.$PMF_LANG['ad_adus_dberr'].'<br />';\n            echo $faqConfig->getDb()->error().'</p>';\n        }\n    }\n\n    $glossaryItems = $glossary->getAllGlossaryItems();\n\n    echo '<table class=\"table table-striped\">';\n    printf(\n        '<thead><tr><th>%s</th><th>%s</th><th style=\"width: 16px\">&nbsp;</th></tr></thead>',\n        $PMF_LANG['ad_glossary_item'],\n        $PMF_LANG['ad_glossary_definition']\n    );\n\n    foreach ($glossaryItems as $items) {\n        echo '<tr>';\n        printf(\n            '<td><a href=\"%s%d\">%s</a></td>',\n            '?action=editglossary&amp;id=',\n            $items['id'],\n            $items['item']\n        );\n        printf(\n            '<td>%s</td>',\n            $items['definition']\n        );\n        printf(\n            '<td><a class=\"btn btn-danger\" onclick=\"return confirm(\\'%s\\'); return false;\" href=\"%s%d\">',\n            $PMF_LANG['ad_user_del_3'],\n            '?action=deleteglossary&amp;id=',\n            $items['id']\n        );\n        printf(\n            '<span title=\"%s\"><i aria-hidden=\"true\" class=\"fa fa-trash-o\"></i></span></a></td>',\n            $PMF_LANG['ad_entry_delete']\n        );\n        echo '</tr>';\n    }\n    echo '</table>';\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n?>\n            </div>\n        </div>"], "fixing_code": ["<?php\n/**\n * Displays a form to add a glossary item.\n *\n * PHP Version 5.5\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @category  phpMyFAQ\n *\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2005-2017 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n *\n * @link      http://www.phpmyfaq.de\n * @since     2005-09-15\n */\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    $protocol = 'http';\n    if (isset($_SERVER['HTTPS']) && strtoupper($_SERVER['HTTPS']) === 'ON') {\n        $protocol = 'https';\n    }\n    header('Location: '.$protocol.'://'.$_SERVER['HTTP_HOST'].dirname($_SERVER['SCRIPT_NAME']));\n    exit();\n}\n?>\n        <header class=\"row\">\n            <div class=\"col-lg-12\">\n                <h2 class=\"page-header\">\n                    <i aria-hidden=\"true\" class=\"fa fa-list-ul\"></i> <?php echo $PMF_LANG['ad_glossary_add'] ?>\n                </h2>\n            </div>\n        </header>\n\n        <div class=\"row\">\n            <div class=\"col-lg-12\">\n\n<?php\nif ($user->perm->checkRight($user->getUserId(), 'addglossary')) {\n    ?>\n                <form class=\"form-horizontal\" action=\"?action=saveglossary\" method=\"post\" accept-charset=\"utf-8\">\n                    <input type=\"hidden\" name=\"csrf\" value=\"<?php echo $user->getCsrfTokenFromSession() ?>\">\n\n                    <div class=\"form-group\">\n                        <label class=\"col-lg-2 control-label\" for=\"item\"><?php echo $PMF_LANG['ad_glossary_item'];\n    ?>:</label>\n                        <div class=\"col-lg-4\">\n                            <input class=\"form-control\" type=\"text\" name=\"item\" id=\"item\" required />\n                        </div>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <label class=\"col-lg-2 control-label\" for=\"definition\">\n                            <?php echo $PMF_LANG['ad_glossary_definition'];\n    ?>:\n                        </label>\n                        <div class=\"col-lg-4\">\n                            <textarea class=\"form-control\" name=\"definition\" id=\"definition\" cols=\"50\" rows=\"5\" required></textarea>\n                        </div>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <div class=\"col-lg-offset-2 col-lg-4\">\n                            <button class=\"btn btn-primary\" type=\"submit\">\n                                <?php echo $PMF_LANG['ad_glossary_save'];\n    ?>\n                            </button>\n                            <a class=\"btn btn-info\" href=\"?action=glossary\">\n                                <?php echo $PMF_LANG['ad_entry_back'];\n    ?>\n                            </a>\n                        </div>\n                    </div>\n                </form>\n<?php\n\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n?>\n            </div>\n        </div>", "<?php\n/**\n * Displays a form to edit an existing glossary item.\n *\n * PHP Version 5.5\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @category  phpMyFAQ\n *\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2005-2017 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n *\n * @link      http://www.phpmyfaq.de\n * @since     2005-09-15\n */\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    $protocol = 'http';\n    if (isset($_SERVER['HTTPS']) && strtoupper($_SERVER['HTTPS']) === 'ON') {\n        $protocol = 'https';\n    }\n    header('Location: '.$protocol.'://'.$_SERVER['HTTP_HOST'].dirname($_SERVER['SCRIPT_NAME']));\n    exit();\n}\n?>\n        <header class=\"row\">\n            <div class=\"col-lg-12\">\n                <h2 class=\"page-header\">\n                    <i aria-hidden=\"true\" class=\"fa fa-list-ul\"></i> <?php echo $PMF_LANG['ad_glossary_edit'] ?>\n                </h2>\n            </div>\n        </header>\n\n        <div class=\"row\">\n            <div class=\"col-lg-12\">\n<?php\nif ($user->perm->checkRight($user->getUserId(), 'editglossary')) {\n    $id = PMF_Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);\n    $glossary = new PMF_Glossary($faqConfig);\n    $glossaryItem = $glossary->getGlossaryItem($id);\n    ?>\n                <form class=\"form-horizontal\" action=\"?action=updateglossary\" method=\"post\" accept-charset=\"utf-8\">\n                    <input type=\"hidden\" name=\"csrf\" value=\"<?php echo $user->getCsrfTokenFromSession() ?>\">\n                    <input type=\"hidden\" name=\"id\" value=\"<?php echo $glossaryItem['id'];\n    ?>\" />\n                    <div class=\"form-group\">\n                        <label class=\"col-lg-2 control-label\" for=\"item\"><?php echo $PMF_LANG['ad_glossary_item'];\n    ?>:</label>\n                        <div class=\"col-lg-4\">\n                            <input class=\"form-control\" type=\"text\" name=\"item\" id=\"item\"\n                                   value=\"<?php echo $glossaryItem['item'];\n    ?>\" required>\n                        </div>\n                    </div>\n\n            <div class=\"control-group\">\n                <label class=\"control-label\" for=\"definition\">\n                    <?php echo $PMF_LANG['ad_glossary_definition'];\n    ?>:\n                </label>\n                <div class=\"controls\">\n                    <textarea  class=\"input-xxlarge\" name=\"definition\" id=\"definition\" cols=\"50\" rows=\"3\" required><?php echo $glossaryItem['definition'];\n    ?></textarea>\n                </div>\n            </div>\n\n                    <div class=\"form-group\">\n                        <div class=\"col-lg-offset-2 col-lg-4\">\n                            <button class=\"btn btn-primary\" type=\"submit\">\n                                <?php echo $PMF_LANG['ad_glossary_save'];\n    ?>\n                            </button>\n                            <a class=\"btn btn-info\" href=\"?action=glossary\">\n                                <?php echo $PMF_LANG['ad_entry_back'];\n    ?>\n                            </a>\n                        </div>\n                    </div>\n                </form>\n<?php\n\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n?>\n            </div>\n        </div>", "<?php\n/**\n * The main glossary index file.\n *\n * PHP Version 5.5\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @category  phpMyFAQ\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2005-2017 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link      http://www.phpmyfaq.de\n * @since     2005-09-15\n */\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    $protocol = 'http';\n    if (isset($_SERVER['HTTPS']) && strtoupper($_SERVER['HTTPS']) === 'ON') {\n        $protocol = 'https';\n    }\n    header('Location: '.$protocol.'://'.$_SERVER['HTTP_HOST'].dirname($_SERVER['SCRIPT_NAME']));\n    exit();\n}\n?>\n        <header class=\"row\">\n            <div class=\"col-lg-12\">\n                <h2 class=\"page-header\">\n                    <i aria-hidden=\"true\" class=\"fa fa-list-ul\"></i> <?php echo $PMF_LANG['ad_menu_glossary'] ?>\n                    <div class=\"pull-right\">\n                        <a class=\"btn btn-success\" href=\"?action=addglossary\">\n                            <i aria-hidden=\"true\" class=\"fa fa-plus fa-fw\"></i> <?php echo $PMF_LANG['ad_glossary_add'] ?>\n                        </a>\n                    </div>\n                </h2>\n            </div>\n        </header>\n\n        <div class=\"row\">\n            <div class=\"col-lg-12\">\n<?php\n\n$csrfTokenFromPost = PMF_Filter::filterInput(INPUT_POST, 'csrf', FILTER_SANITIZE_STRING);\n$csrfTokenFromGet = PMF_Filter::filterInput(INPUT_GET, 'csrf', FILTER_SANITIZE_STRING);\nif (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfTokenFromPost) {\n    $csrfCheck = false;\n} else {\n    $csrfCheck = true;\n}\nif (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfTokenFromGet) {\n    $csrfCheckDelete = false;\n} else {\n    $csrfCheckDelete = true;\n}\n\nif ($user->perm->checkRight($user->getUserId(), 'addglossary') ||\n    $user->perm->checkRight($user->getUserId(), 'editglossary') ||\n    $user->perm->checkRight($user->getUserId(), 'delglossary')) {\n    $glossary = new PMF_Glossary($faqConfig);\n\n    if ('saveglossary' == $action && $user->perm->checkRight($user->getUserId(), 'addglossary') && $csrfCheck) {\n        $item = PMF_Filter::filterInput(INPUT_POST, 'item', FILTER_SANITIZE_SPECIAL_CHARS);\n        $definition = PMF_Filter::filterInput(INPUT_POST, 'definition', FILTER_SANITIZE_SPECIAL_CHARS);\n        if ($glossary->addGlossaryItem($item, $definition)) {\n            echo '<p class=\"alert alert-success\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_save_success'].'</p>';\n        } else {\n            echo '<p class=\"alert alert-danger\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_save_error'];\n            echo '<br />'.$PMF_LANG['ad_adus_dberr'].'<br />';\n            echo $faqConfig->getDb()->error().'</p>';\n        }\n    }\n\n    if ('updateglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary') && $csrfCheck) {\n        $id = PMF_Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);\n        $item = PMF_Filter::filterInput(INPUT_POST, 'item', FILTER_SANITIZE_SPECIAL_CHARS);\n        $definition = PMF_Filter::filterInput(INPUT_POST, 'definition', FILTER_SANITIZE_SPECIAL_CHARS);\n        if ($glossary->updateGlossaryItem($id, $item, $definition)) {\n            echo '<p class=\"alert alert-success\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_update_success'].'</p>';\n        } else {\n            echo '<p class=\"alert alert-danger\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_update_error'];\n            echo '<br />'.$PMF_LANG['ad_adus_dberr'].'<br />';\n            echo $faqConfig->getDb()->error().'</p>';\n        }\n    }\n\n    if ('deleteglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary') && $csrfCheckDelete) {\n        $id = PMF_Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);\n        if ($glossary->deleteGlossaryItem($id)) {\n            echo '<p class=\"alert alert-success\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_delete_success'].'</p>';\n        } else {\n            echo '<p class=\"alert alert-danger\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">\u00d7</a>';\n            echo $PMF_LANG['ad_glossary_delete_error'];\n            echo '<br />'.$PMF_LANG['ad_adus_dberr'].'<br />';\n            echo $faqConfig->getDb()->error().'</p>';\n        }\n    }\n\n    $glossaryItems = $glossary->getAllGlossaryItems();\n\n    echo '<table class=\"table table-striped\">';\n    printf(\n        '<thead><tr><th>%s</th><th>%s</th><th style=\"width: 16px\">&nbsp;</th></tr></thead>',\n        $PMF_LANG['ad_glossary_item'],\n        $PMF_LANG['ad_glossary_definition']\n    );\n\n    foreach ($glossaryItems as $items) {\n        echo '<tr>';\n        printf(\n            '<td><a href=\"%s%d\">%s</a></td>',\n            '?action=editglossary&amp;id=',\n            $items['id'],\n            $items['item']\n        );\n        printf(\n            '<td>%s</td>',\n            $items['definition']\n        );\n        printf(\n            '<td><a class=\"btn btn-danger\" onclick=\"return confirm(\\'%s\\'); return false;\" href=\"%s%d%s%s\">',\n            $PMF_LANG['ad_user_del_3'],\n            '?action=deleteglossary&amp;id=',\n            $items['id'],\n            '&csrf=',\n            $user->getCsrfTokenFromSession()\n        );\n        printf(\n            '<span title=\"%s\"><i aria-hidden=\"true\" class=\"fa fa-trash-o\"></i></span></a></td>',\n            $PMF_LANG['ad_entry_delete']\n        );\n        echo '</tr>';\n    }\n    echo '</table>';\n} else {\n    echo $PMF_LANG['err_NotAuth'];\n}\n?>\n            </div>\n        </div>"], "filenames": ["phpmyfaq/admin/glossary.add.php", "phpmyfaq/admin/glossary.edit.php", "phpmyfaq/admin/glossary.main.php"], "buggy_code_start_loc": [43, 45, 12], "buggy_code_end_loc": [43, 45, 118], "fixing_code_start_loc": [44, 46, 11], "fixing_code_end_loc": [46, 47, 132], "type": "CWE-352", "message": "In phpMyFAQ before 2.9.9, there is Cross-Site Request Forgery (CSRF) for modifying a glossary.", "other": {"cve": {"id": "CVE-2017-15735", "sourceIdentifier": "cve@mitre.org", "published": "2017-10-22T18:29:00.590", "lastModified": "2017-10-24T15:09:47.350", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "In phpMyFAQ before 2.9.9, there is Cross-Site Request Forgery (CSRF) for modifying a glossary."}, {"lang": "es", "value": "En phpMyFAQ en versiones anteriores a la 2.9.9 hay Cross-Site Request Forgery (CSRF) al modificar un glosario."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpmyfaq:phpmyfaq:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.9.8", "matchCriteriaId": "1D0B1C07-83F7-4DB0-976C-51483D7DF516"}]}]}], "references": [{"url": "https://github.com/thorsten/phpMyFAQ/commit/867618110feb836e168435548d6c2cbb7c65eda3", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/thorsten/phpMyFAQ/commit/867618110feb836e168435548d6c2cbb7c65eda3"}}