{"buggy_code": ["<section class=\"content\">\n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header with-border\">\n                    <h3 class=\"card-title\"><?= $Lang->get('NAVBAR__ADD_LINK') ?></h3>\n                </div>\n                <div class=\"card-body\">\n                    <form method=\"post\" action=\"<?= $this->Html->url(['action' => 'add_ajax']) ?>\" data-ajax=\"true\"\n                          data-redirect-url=\"<?= $this->Html->url(['action' => 'index']) ?>\"\n                          data-custom-function=\"formatteData\">\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__NAME') ?></label>\n                            <input name=\"name\" class=\"form-control\" type=\"text\">\n                        </div>\n\n                        <div class=\"form-group\">\n\n                            <label><?= $Lang->get('NAVBAR__ICON') ?></label>\n                            <p><?= $Lang->get('NAVBAR__ICON__DESC') ?><a target=\"_blank\"\n                                                                         href=\"https://fontawesome.com/\">https://fontawesome.com/</a>\n                            <div class=\"input-group mb-3\">\n                                <div class=\"input-group-prepend\">\n                                    <span class=\"input-group-text\">FA</span>\n                                </div>\n                                <input name=\"icon\" class=\"form-control\" type=\"text\">\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__TYPE') ?></label>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"normal\" name=\"type\" value=\"normal\">\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DEFAULT') ?></label>\n                            </div>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"dropdown\" name=\"type\" value=\"dropdown\">\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DROPDOWN') ?></label>\n                            </div>\n                        </div>\n\n                        <div id=\"type-normal\" class=\"d-none\">\n                            <div class=\"form-group\">\n                                <label><?= $Lang->get('URL') ?></label>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_plugin\" name=\"url_type\" value=\"plugin\">\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PLUGIN') ?></label>\n                                </div>\n                                <div class=\"d-none plugin\">\n                                    <select class=\"form-control\" name=\"url_plugin\">\n                                        <?php\n                                        foreach ($url_plugins as $pluginId => $data) {\n                                            echo '<option disabled>' . $data->name . '</option>';\n                                            foreach ($data->routes as $name => $route)\n                                                echo '<option value=\\'' . json_encode(['id' => $pluginId, 'route' => $route]) . '\\'>' . $name . ' (' . $route . ')</option>';\n                                        }\n                                        ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_page\" name=\"url_type\" value=\"page\">\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PAGE') ?></label>\n                                </div>\n                                <div class=\"d-none page\">\n                                    <select class=\"form-control\" name=\"url_page\">\n                                        <?php foreach ($url_pages as $key => $value) { ?>\n                                            <option value=\"<?= $key ?>\"><?= $value ?></option>\n                                        <?php } ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_custom\" name=\"url_type\" value=\"custom\">\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_CUSTOM') ?></label>\n                                </div>\n                                </label>\n                                <input type=\"text\" class=\"form-control d-none custom\"\n                                       placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url_custom\">\n                            </div>\n                        </div>\n\n                        <div id=\"type-dropdown\" class=\"d-none\">\n                            <div class=\"form-group\">\n                                <div class=\"card card-body\" id=\"nav-1\">\n                                    <div class=\"form-group\">\n                                        <label><?= $Lang->get('NAVBAR__LINK_NAME') ?></label>\n                                        <input type=\"text\" class=\"form-control name_of_nav\" name=\"name_of_nav\">\n                                    </div>\n                                    <div class=\"form-group\">\n                                        <label><?= $Lang->get('URL') ?></label>\n                                        <input type=\"text\" class=\"form-control url_of_nav\"\n                                               placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\">\n                                    </div>\n                                    <a href=\"#\"\n                                       class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a>\n                                    <br>\n                                </div>\n                            </div>\n                            <div id=\"add-js\" data-number=\"1\"></div>\n                            <div class=\"control-group\">\n                                <a href=\"#\" id=\"add_nav\"\n                                   class=\"btn btn-success\"><?= $Lang->get('NAVBAR__ADD_LINK') ?></a>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <div class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"new_tab\">\n                                <label><?= $Lang->get('NAVBAR__OPEN_IN_NEW_TAB') ?></label>\n                            </div>\n                        </div>\n\n                        <div class=\"float-right\">\n                            <a href=\"<?= $this->Html->url(['controller' => 'navbar', 'action' => 'admin_index', 'admin' => true]) ?>\"\n                               class=\"btn btn-default\"><?= $Lang->get('GLOBAL__CANCEL') ?></a>\n                            <button class=\"btn btn-primary\" type=\"submit\"><?= $Lang->get('GLOBAL__SUBMIT') ?></button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</section>\n<script type=\"text/javascript\">\n    $('#add_nav').click(function (e) {\n        e.preventDefault();\n        var how = $('#add-js').attr('data-number');\n        how = parseInt(how) + 1;\n        var add = '<div class=\"form-group\"><div class=\"card card-body\" id=\"nav-' + how + '\"><div class=\"form-group\"><label><?= addslashes($Lang->get('NAVBAR__LINK_NAME')) ?></label><input type=\"text\" class=\"form-control name_of_nav\" name=\"name_of_nav\"></div><div class=\"form-group\"><label><?= $Lang->get('URL') ?></label><input type=\"text\" class=\"form-control url_of_nav\" placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\"></div><a href=\"#\" class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a><br></div></div>';\n        $('#add-js').append(add);\n        $('#add-js').attr('data-number', how);\n        deleteNavEvents();\n    });\n    deleteNavEvents();\n\n    function deleteNavEvents() {\n        $('.delete-nav').unbind('click');\n        $('.delete-nav').on('click', function (e) {\n            e.preventDefault();\n            var div = $(this).parent();\n            div.slideUp(150, function () {\n                $(this).remove();\n            });\n        });\n    }\n</script>\n<script type=\"text/javascript\">\n    $(\"#normal\").change(function () {\n        if ($(\"#normal\").is(':checked')) {\n            $(\"#type-normal\").removeClass('d-none');\n            $(\"#type-dropdown\").addClass('d-none');\n        } else {\n            $(\"#type-normal\").addClass('d-none');\n            $(\"#type-dropdown\").removeClass('d-none');\n        }\n    });\n    $(\"#dropdown\").change(function () {\n        if ($(\"dropdown\").is(':checked')) {\n            $(\"#type-dropdown\").addClass('d-none');\n            $(\"#type-normal\").removeClass('d-none');\n        } else {\n            $(\"#type-dropdown\").removeClass('d-none');\n            $(\"#type-normal\").addClass('d-none');\n        }\n    });\n\n    $(\".type_plugin\").change(function () {\n        if ($(\".type_plugin\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").removeClass('d-none');\n        } else {\n            $(\".plugin\").addClass('d-none');\n        }\n    });\n\n    $(\".type_page\").change(function () {\n        if ($(\".type_page\").is(':checked')) {\n            $(\".page\").removeClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".page\").addClass('d-none');\n        }\n    });\n\n    $(\".type_custom\").change(function () {\n        if ($(\".type_custom\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").removeClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".custom\").addClass('d-none');\n        }\n    });\n</script>\n<script type=\"text/javascript\">\n    function formatteData($form) {\n        var name = $form.find(\"input[name='name']\").val();\n        var icon = $form.find(\"input[name='icon']\").val();\n        var type = $form.find(\"input[type='radio'][name='type']:checked\").val();\n        var url;\n        if (type === \"normal\") {\n            if ($form.find(\"input[name='url_type']:checked\").val() === \"custom\")\n                url = '{\"type\":\"custom\", \"url\":\"' + $form.find(\"input[name='url_custom']\").val() + '\"}';\n            else if ($form.find(\"input[name='url_type']:checked\").val() === \"plugin\") {\n                var value = $form.find(\"select[name='url_plugin']\").val();\n                value = JSON.parse(value);\n                url = {\n                    type: 'plugin',\n                    id: value.id,\n                    route: value.route\n                };\n                url = JSON.stringify(url);\n            } else if ($form.find(\"input[name='url_type']:checked\").val() === \"page\")\n                url = '{\"type\":\"page\", \"id\":\"' + $form.find(\"select[name='url_page']\").val() + '\"}';\n            else\n                url = \"undefined\";\n        } else {\n            var names = $('.name_of_nav').serialize();\n            names = names.split('&');\n            var urls = $('.url_of_nav').serialize();\n            urls = urls.split('&');\n            url = {};\n            for (var key in test = names) {\n                var l = test[key].split('=');\n                l = l[1];\n                var p = urls[key].split('=');\n                p = p[1];\n                url[l] = p;\n            }\n        }\n\n        var inputs = {};\n        inputs['name'] = name;\n        inputs['icon'] = icon;\n        inputs['type'] = type;\n        inputs['url'] = url;\n        inputs['open_new_tab'] = $('input[name=\"new_tab\"]').is(':checked');\n        inputs['data[_Token][key]'] = '<?= $csrfToken ?>';\n\n        return inputs;\n    }\n</script>\n", "<section class=\"content\">\n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header with-border\">\n                    <h3 class=\"card-title\"><?= $Lang->get('NAVBAR__EDIT_TITLE') ?></h3>\n                </div>\n                <div class=\"card-body\">\n                    <form method=\"post\" action=\"<?= $this->Html->url(['action' => 'edit_ajax', $nav['id']]) ?>\"\n                          data-ajax=\"true\" data-redirect-url=\"<?= $this->Html->url(['action' => 'index']) ?>\"\n                          data-custom-function=\"formatteData\">\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__NAME') ?></label>\n                            <input name=\"name\" class=\"form-control\" type=\"text\" value=\"<?= $nav['name'] ?>\">\n                        </div>\n                        <div class=\"form-group\">\n\n                            <label><?= $Lang->get('NAVBAR__ICON') ?></label>\n                            <p><?= $Lang->get('NAVBAR__ICON__DESC') ?><a target=\"_blank\"\n                                                                         href=\"https://fontawesome.com/\">https://fontawesome.com/</a>\n                            <div class=\"input-group mb-3\">\n                                <div class=\"input-group-prepend\">\n                                    <span class=\"input-group-text\">FA</span>\n                                </div>\n                                <input name=\"icon\" class=\"form-control\" type=\"text\" value=\"<?= $nav['icon'] ?>\">\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__TYPE') ?></label>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"normal\" name=\"type\"\n                                       value=\"normal\"<?= ($nav['type'] == \"1\") ? ' checked=\"\"' : '' ?>>\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DEFAULT') ?></label>\n                            </div>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"dropdown\" name=\"type\"\n                                       value=\"dropdown\"<?= ($nav['type'] == \"2\") ? ' checked=\"\"' : '' ?>>\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DROPDOWN') ?></label>\n                            </div>\n                        </div>\n\n                        <div id=\"type-normal\" class=\"<?= ($nav['type'] == \"1\") ? '' : 'd-none' ?>\">\n                            <div class=\"form-group\">\n                                <label><?= $Lang->get('URL') ?></label>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_plugin\" name=\"url_type\"\n                                           value=\"plugin\"<?= ($nav['url']['type'] == \"plugin\") ? ' checked=\"\"' : '' ?>>\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PLUGIN') ?></label>\n                                </div>\n                                <div class=\"plugin<?= ($nav['url']['type'] == \"plugin\") ? '' : ' d-none' ?>\">\n                                    <select class=\"form-control\" name=\"url_plugin\">\n                                        <?php\n                                        foreach ($url_plugins as $pluginId => $data) {\n                                            echo '<option disabled>' . $data->name . '</option>';\n                                            foreach ($data->routes as $name => $route)\n                                                echo '<option value=\\'' . json_encode(['id' => $pluginId, 'route' => $route]) . '\\' ' . ($nav['url']['type'] === 'plugin' && $nav['url']['id'] === $pluginId && $nav['url']['route'] === $route ? ' selected' : '') . '>' . $name . ' (' . $route . ')</option>';\n                                        }\n                                        ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_page\" name=\"url_type\"\n                                           value=\"page\"<?= ($nav['url']['type'] == \"page\") ? ' checked=\"\"' : '' ?>>\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PAGE') ?></label>\n                                </div>\n                                <div class=\"page<?= ($nav['url']['type'] == \"page\") ? '' : ' d-none' ?>\">\n                                    <select class=\"form-control\" name=\"url_page\">\n                                        <?php foreach ($url_pages as $key => $value) { ?>\n                                            <option value=\"<?= $key ?>\"<?= ($nav['url']['id'] == $key) ? ' selected' : '' ?>><?= $value ?></option>\n                                        <?php } ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_custom\" name=\"url_type\"\n                                           value=\"custom\"<?= ($nav['url']['type'] == \"custom\") ? ' checked=\"\"' : '' ?>>\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_CUSTOM') ?></label>\n                                </div>\n                                </label>\n                                <input type=\"text\"\n                                       value=\"<?= ($nav['url']['type'] == \"custom\") ? $nav['url']['url'] : '' ?>\"\n                                       class=\"form-control custom<?= ($nav['url']['type'] == \"custom\") ? '' : ' d-none' ?>\"\n                                       placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url_custom\">\n                            </div>\n                        </div>\n\n                        <div id=\"type-dropdown\" class=\"<?= ($nav['type'] == \"2\") ? '' : 'd-none' ?>\">\n                            <div class=\"form-group\">\n                                <?php\n                                $i = 0;\n                                foreach (json_decode($nav['submenu'], true) as $name => $url) {\n                                    $i++;\n                                    ?>\n                                    <div class=\"card card-body\" id=\"nav-<?= $i ?>\">\n                                        <div class=\"form-group\">\n                                            <label><?= $Lang->get('NAVBAR__LINK_NAME') ?></label>\n                                            <input type=\"text\" class=\"form-control name_of_nav\"\n                                                   value=\"<?= urldecode($name) ?>\" name=\"name_of_nav\">\n                                        </div>\n                                        <div class=\"form-group\">\n                                            <label><?= $Lang->get('URL') ?></label>\n                                            <input type=\"text\" class=\"form-control url_of_nav\"\n                                                   value=\"<?= urldecode($url) ?>\"\n                                                   placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\">\n                                        </div>\n                                        <a href=\"#\"\n                                           class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a>\n                                        <br>\n                                    </div>\n                                <?php } ?>\n                            </div>\n                            <div id=\"add-js\" data-number=\"<?= $i ?>\"></div>\n                            <div class=\"control-group\">\n                                <a href=\"#\" id=\"add_nav\"\n                                   class=\"btn btn-success\"><?= $Lang->get('NAVBAR__ADD_LINK') ?></a>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <div class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"new_tab\"<?= ($nav['open_new_tab']) ? ' checked=\"\"' : '' ?>>\n                                <label><?= $Lang->get('NAVBAR__OPEN_IN_NEW_TAB') ?></label>\n                            </div>\n                        </div>\n\n                        <div class=\"float-right\">\n                            <a href=\"<?= $this->Html->url(['controller' => 'navbar', 'action' => 'admin_index', 'admin' => true]) ?>\"\n                               class=\"btn btn-default\"><?= $Lang->get('GLOBAL__CANCEL') ?></a>\n                            <button class=\"btn btn-primary\" type=\"submit\"><?= $Lang->get('GLOBAL__SUBMIT') ?></button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</section>\n<script type=\"text/javascript\">\n    $('#add_nav').click(function (e) {\n        e.preventDefault();\n        var how = $('#add-js').attr('data-number');\n        how = parseInt(how) + 1;\n        var add = '<div class=\"form-group\"><div class=\"card card-body\" id=\"nav-' + how + '\"><div class=\"form-group\"><label><?= addslashes($Lang->get('NAVBAR__LINK_NAME')) ?></label><input type=\"text\" class=\"form-control name_of_nav\" name=\"name_of_nav\"></div><div class=\"form-group\"><label><?= $Lang->get('URL') ?></label><input type=\"text\" class=\"form-control url_of_nav\" placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\"></div><a href=\"#\" class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a><br></div></div>';\n        $('#add-js').append(add);\n        $('#add-js').attr('data-number', how);\n        deleteNavEvents();\n    });\n    deleteNavEvents();\n\n    function deleteNavEvents() {\n        $('.delete-nav').unbind('click');\n        $('.delete-nav').on('click', function (e) {\n            e.preventDefault();\n            var div = $(this).parent();\n            div.slideUp(150, function () {\n                $(this).remove();\n            });\n        });\n    }\n</script>\n<script type=\"text/javascript\">\n    $(\"#normal\").change(function () {\n        if ($(\"#normal\").is(':checked')) {\n            $(\"#type-normal\").removeClass('d-none');\n            $(\"#type-dropdown\").addClass('d-none');\n        } else {\n            $(\"#type-normal\").addClass('d-none');\n            $(\"#type-dropdown\").removeClass('d-none');\n        }\n    });\n    $(\"#dropdown\").change(function () {\n        if ($(\"dropdown\").is(':checked')) {\n            $(\"#type-dropdown\").addClass('d-none');\n            $(\"#type-normal\").removeClass('d-none');\n        } else {\n            $(\"#type-dropdown\").removeClass('d-none');\n            $(\"#type-normal\").addClass('d-none');\n        }\n    });\n\n    $(\".type_plugin\").change(function () {\n        if ($(\".type_plugin\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").removeClass('d-none');\n        } else {\n            $(\".plugin\").addClass('d-none');\n        }\n    });\n\n    $(\".type_page\").change(function () {\n        if ($(\".type_page\").is(':checked')) {\n            $(\".page\").removeClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".page\").addClass('d-none');\n        }\n    });\n\n    $(\".type_custom\").change(function () {\n        if ($(\".type_custom\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").removeClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".custom\").addClass('d-none');\n        }\n    });\n</script>\n<script type=\"text/javascript\">\n    function formatteData($form) {\n        var name = $form.find(\"input[name='name']\").val();\n        var icon = $form.find(\"input[name='icon']\").val();\n        var type = $form.find(\"input[type='radio'][name='type']:checked\").val();\n        var url;\n        if (type === \"normal\") {\n            if ($form.find(\"input[name='url_type']:checked\").val() === \"custom\")\n                url = '{\"type\":\"custom\", \"url\":\"' + $form.find(\"input[name='url_custom']\").val() + '\"}';\n            else if ($form.find(\"input[name='url_type']:checked\").val() === \"plugin\") {\n                var value = $form.find(\"select[name='url_plugin']\").val();\n                value = JSON.parse(value);\n                url = {\n                    type: 'plugin',\n                    id: value.id,\n                    route: value.route\n                };\n                url = JSON.stringify(url);\n            } else if ($form.find(\"input[name='url_type']:checked\").val() === \"page\")\n                url = '{\"type\":\"page\", \"id\":\"' + $form.find(\"select[name='url_page']\").val() + '\"}';\n            else\n                url = \"undefined\";\n        } else {\n            var names = $('.name_of_nav').serialize();\n            names = names.split('&');\n            var urls = $('.url_of_nav').serialize();\n            urls = urls.split('&');\n            url = {};\n            for (var key in test = names) {\n                var l = test[key].split('=');\n                l = l[1];\n                var p = urls[key].split('=');\n                p = p[1];\n                url[l] = p;\n            }\n        }\n\n        var inputs = {};\n        inputs['name'] = name;\n        inputs['icon'] = icon;\n        inputs['type'] = type;\n        inputs['url'] = url;\n        inputs['open_new_tab'] = $('input[name=\"new_tab\"]').is(':checked');\n        inputs['data[_Token][key]'] = '<?= $csrfToken ?>';\n\n        return inputs;\n    }\n</script>\n"], "fixing_code": ["<section class=\"content\">\n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header with-border\">\n                    <h3 class=\"card-title\"><?= $Lang->get('NAVBAR__ADD_LINK') ?></h3>\n                </div>\n                <div class=\"card-body\">\n                    <form method=\"post\" action=\"<?= $this->Html->url(['action' => 'add_ajax']) ?>\" data-ajax=\"true\"\n                          data-redirect-url=\"<?= $this->Html->url(['action' => 'index']) ?>\"\n                          data-custom-function=\"formatteData\">\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__NAME') ?></label>\n                            <input name=\"name\" class=\"form-control\" type=\"text\">\n                        </div>\n\n                        <div class=\"form-group\">\n\n                            <label><?= $Lang->get('NAVBAR__ICON') ?></label>\n                            <p><?= $Lang->get('NAVBAR__ICON__DESC') ?><a target=\"_blank\"\n                                                                         href=\"https://fontawesome.com/\">https://fontawesome.com/</a>\n                            <div class=\"input-group mb-3\">\n                                <div class=\"input-group-prepend\">\n                                    <span class=\"input-group-text\">FA</span>\n                                </div>\n                                <input name=\"icon\" class=\"form-control\" type=\"text\">\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__TYPE') ?></label>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"normal\" name=\"type\" value=\"normal\">\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DEFAULT') ?></label>\n                            </div>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"dropdown\" name=\"type\" value=\"dropdown\">\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DROPDOWN') ?></label>\n                            </div>\n                        </div>\n\n                        <div id=\"type-normal\" class=\"d-none\">\n                            <div class=\"form-group\">\n                                <label><?= $Lang->get('URL') ?></label>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_plugin\" name=\"url_type\" value=\"plugin\">\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PLUGIN') ?></label>\n                                </div>\n                                <div class=\"d-none plugin\">\n                                    <select class=\"form-control\" name=\"url_plugin\">\n                                        <?php\n                                        foreach ($url_plugins as $pluginId => $data) {\n                                            echo '<option disabled>' . $data->name . '</option>';\n                                            foreach ($data->routes as $name => $route)\n                                                echo '<option value=\\'' . json_encode(['id' => $pluginId, 'route' => $route]) . '\\'>' . $name . ' (' . $route . ')</option>';\n                                        }\n                                        ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_page\" name=\"url_type\" value=\"page\">\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PAGE') ?></label>\n                                </div>\n                                <div class=\"d-none page\">\n                                    <select class=\"form-control\" name=\"url_page\">\n                                        <?php foreach ($url_pages as $key => $value) { ?>\n                                            <option value=\"<?= $key ?>\"><?= $value ?></option>\n                                        <?php } ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_custom\" name=\"url_type\" value=\"custom\">\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_CUSTOM') ?></label>\n                                </div>\n                                </label>\n                                <input type=\"text\" class=\"form-control d-none custom\"\n                                       placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url_custom\">\n                            </div>\n                        </div>\n\n                        <div id=\"type-dropdown\" class=\"d-none\">\n                            <div class=\"form-group\">\n                                <div class=\"card card-body\" id=\"nav-1\">\n                                    <div class=\"form-group\">\n                                        <label><?= $Lang->get('NAVBAR__LINK_NAME') ?></label>\n                                        <input type=\"text\" class=\"form-control name_of_nav\" name=\"name_of_nav\">\n                                    </div>\n                                    <div class=\"form-group\">\n                                        <label><?= $Lang->get('URL') ?></label>\n                                        <input type=\"text\" class=\"form-control url_of_nav\"\n                                               placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\">\n                                    </div>\n                                    <a href=\"#\"\n                                       class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a>\n                                    <br>\n                                </div>\n                            </div>\n                            <div id=\"add-js\" data-number=\"1\"></div>\n                            <div class=\"control-group\">\n                                <a href=\"#\" id=\"add_nav\"\n                                   class=\"btn btn-success\"><?= $Lang->get('NAVBAR__ADD_LINK') ?></a>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <div class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"new_tab\">\n                                <label><?= $Lang->get('NAVBAR__OPEN_IN_NEW_TAB') ?></label>\n                            </div>\n                        </div>\n\n                        <div class=\"float-right\">\n                            <a href=\"<?= $this->Html->url(['controller' => 'navbar', 'action' => 'admin_index', 'admin' => true]) ?>\"\n                               class=\"btn btn-default\"><?= $Lang->get('GLOBAL__CANCEL') ?></a>\n                            <button class=\"btn btn-primary\" type=\"submit\"><?= $Lang->get('GLOBAL__SUBMIT') ?></button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</section>\n<script type=\"text/javascript\">\n    $('#add_nav').click(function (e) {\n        e.preventDefault();\n        var how = $('#add-js').attr('data-number');\n        how = parseInt(how) + 1;\n        var add = '<div class=\"form-group\"><div class=\"card card-body\" id=\"nav-' + how + '\"><div class=\"form-group\"><label><?= addslashes($Lang->get('NAVBAR__LINK_NAME')) ?></label><input type=\"text\" class=\"form-control name_of_nav\" name=\"name_of_nav\"></div><div class=\"form-group\"><label><?= $Lang->get('URL') ?></label><input type=\"text\" class=\"form-control url_of_nav\" placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\"></div><a href=\"#\" class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a><br></div></div>';\n        $('#add-js').append(add);\n        $('#add-js').attr('data-number', how);\n        deleteNavEvents();\n    });\n    deleteNavEvents();\n\n    function deleteNavEvents() {\n        $('.delete-nav').unbind('click');\n        $('.delete-nav').on('click', function (e) {\n            e.preventDefault();\n            var div = $(this).parent();\n            div.slideUp(150, function () {\n                $(this).remove();\n            });\n        });\n    }\n</script>\n<script type=\"text/javascript\">\n    $(\"#normal\").change(function () {\n        if ($(\"#normal\").is(':checked')) {\n            $(\"#type-normal\").removeClass('d-none');\n            $(\"#type-dropdown\").addClass('d-none');\n        } else {\n            $(\"#type-normal\").addClass('d-none');\n            $(\"#type-dropdown\").removeClass('d-none');\n        }\n    });\n    $(\"#dropdown\").change(function () {\n        if ($(\"dropdown\").is(':checked')) {\n            $(\"#type-dropdown\").addClass('d-none');\n            $(\"#type-normal\").removeClass('d-none');\n        } else {\n            $(\"#type-dropdown\").removeClass('d-none');\n            $(\"#type-normal\").addClass('d-none');\n        }\n    });\n\n    $(\".type_plugin\").change(function () {\n        if ($(\".type_plugin\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").removeClass('d-none');\n        } else {\n            $(\".plugin\").addClass('d-none');\n        }\n    });\n\n    $(\".type_page\").change(function () {\n        if ($(\".type_page\").is(':checked')) {\n            $(\".page\").removeClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".page\").addClass('d-none');\n        }\n    });\n\n    $(\".type_custom\").change(function () {\n        if ($(\".type_custom\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").removeClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".custom\").addClass('d-none');\n        }\n    });\n</script>\n<script type=\"text/javascript\">\n    function formatteData($form) {\n        var name = $form.find(\"input[name='name']\").val();\n        var icon = $form.find(\"input[name='icon']\").val();\n        var type = $form.find(\"input[type='radio'][name='type']:checked\").val();\n        var url;\n        if (type === \"normal\") {\n            if ($form.find(\"input[name='url_type']:checked\").val() === \"custom\")\n                url = '{\"type\":\"custom\", \"url\":\"' + $form.find(\"input[name='url_custom']\").val() + '\"}';\n            else if ($form.find(\"input[name='url_type']:checked\").val() === \"plugin\") {\n                var value = $form.find(\"select[name='url_plugin']\").val();\n                value = JSON.parse(value);\n                url = {\n                    type: 'plugin',\n                    id: value.id,\n                    route: value.route\n                };\n                url = JSON.stringify(url);\n            } else if ($form.find(\"input[name='url_type']:checked\").val() === \"page\")\n                url = '{\"type\":\"page\", \"id\":\"' + $form.find(\"select[name='url_page']\").val() + '\"}';\n            else\n                url = \"undefined\";\n        } else {\n            var names = $('.name_of_nav').serialize();\n            names = names.split('&');\n            var urls = $('.url_of_nav').serialize();\n            urls = urls.split('&');\n            url = {};\n            for (var key in test = names) {\n                var l = test[key].split('=');\n                l = decodeURIComponent(l[1]);\n                var p = urls[key].split('=');\n                p = decodeURIComponent(p[1]);\n                url[l] = p;\n            }\n        }\n\n        var inputs = {};\n        inputs['name'] = name;\n        inputs['icon'] = icon;\n        inputs['type'] = type;\n        inputs['url'] = url;\n        inputs['open_new_tab'] = $('input[name=\"new_tab\"]').is(':checked');\n        inputs['data[_Token][key]'] = '<?= $csrfToken ?>';\n\n        return inputs;\n    }\n</script>\n", "<section class=\"content\">\n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header with-border\">\n                    <h3 class=\"card-title\"><?= $Lang->get('NAVBAR__EDIT_TITLE') ?></h3>\n                </div>\n                <div class=\"card-body\">\n                    <form method=\"post\" action=\"<?= $this->Html->url(['action' => 'edit_ajax', $nav['id']]) ?>\"\n                          data-ajax=\"true\" data-redirect-url=\"<?= $this->Html->url(['action' => 'index']) ?>\"\n                          data-custom-function=\"formatteData\">\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__NAME') ?></label>\n                            <input name=\"name\" class=\"form-control\" type=\"text\" value=\"<?= $nav['name'] ?>\">\n                        </div>\n                        <div class=\"form-group\">\n\n                            <label><?= $Lang->get('NAVBAR__ICON') ?></label>\n                            <p><?= $Lang->get('NAVBAR__ICON__DESC') ?><a target=\"_blank\"\n                                                                         href=\"https://fontawesome.com/\">https://fontawesome.com/</a>\n                            <div class=\"input-group mb-3\">\n                                <div class=\"input-group-prepend\">\n                                    <span class=\"input-group-text\">FA</span>\n                                </div>\n                                <input name=\"icon\" class=\"form-control\" type=\"text\" value=\"<?= $nav['icon'] ?>\">\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label><?= $Lang->get('GLOBAL__TYPE') ?></label>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"normal\" name=\"type\"\n                                       value=\"normal\"<?= ($nav['type'] == \"1\") ? ' checked=\"\"' : '' ?>>\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DEFAULT') ?></label>\n                            </div>\n                            <div class=\"radio\">\n                                <input type=\"radio\" id=\"dropdown\" name=\"type\"\n                                       value=\"dropdown\"<?= ($nav['type'] == \"2\") ? ' checked=\"\"' : '' ?>>\n                                <label><?= $Lang->get('NAVBAR__LINK_TYPE_DROPDOWN') ?></label>\n                            </div>\n                        </div>\n\n                        <div id=\"type-normal\" class=\"<?= ($nav['type'] == \"1\") ? '' : 'd-none' ?>\">\n                            <div class=\"form-group\">\n                                <label><?= $Lang->get('URL') ?></label>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_plugin\" name=\"url_type\"\n                                           value=\"plugin\"<?= ($nav['url']['type'] == \"plugin\") ? ' checked=\"\"' : '' ?>>\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PLUGIN') ?></label>\n                                </div>\n                                <div class=\"plugin<?= ($nav['url']['type'] == \"plugin\") ? '' : ' d-none' ?>\">\n                                    <select class=\"form-control\" name=\"url_plugin\">\n                                        <?php\n                                        foreach ($url_plugins as $pluginId => $data) {\n                                            echo '<option disabled>' . $data->name . '</option>';\n                                            foreach ($data->routes as $name => $route)\n                                                echo '<option value=\\'' . json_encode(['id' => $pluginId, 'route' => $route]) . '\\' ' . ($nav['url']['type'] === 'plugin' && $nav['url']['id'] === $pluginId && $nav['url']['route'] === $route ? ' selected' : '') . '>' . $name . ' (' . $route . ')</option>';\n                                        }\n                                        ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_page\" name=\"url_type\"\n                                           value=\"page\"<?= ($nav['url']['type'] == \"page\") ? ' checked=\"\"' : '' ?>>\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_PAGE') ?></label>\n                                </div>\n                                <div class=\"page<?= ($nav['url']['type'] == \"page\") ? '' : ' d-none' ?>\">\n                                    <select class=\"form-control\" name=\"url_page\">\n                                        <?php foreach ($url_pages as $key => $value) { ?>\n                                            <option value=\"<?= $key ?>\"<?= ($nav['url']['id'] == $key) ? ' selected' : '' ?>><?= $value ?></option>\n                                        <?php } ?>\n                                    </select>\n                                </div>\n                                <div class=\"radio\">\n                                    <input type=\"radio\" class=\"type_custom\" name=\"url_type\"\n                                           value=\"custom\"<?= ($nav['url']['type'] == \"custom\") ? ' checked=\"\"' : '' ?>>\n                                    <label><?= $Lang->get('NAVBAR__LINK_TYPE_CUSTOM') ?></label>\n                                </div>\n                                </label>\n                                <input type=\"text\"\n                                       value=\"<?= ($nav['url']['type'] == \"custom\") ? $nav['url']['url'] : '' ?>\"\n                                       class=\"form-control custom<?= ($nav['url']['type'] == \"custom\") ? '' : ' d-none' ?>\"\n                                       placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url_custom\">\n                            </div>\n                        </div>\n\n                        <div id=\"type-dropdown\" class=\"<?= ($nav['type'] == \"2\") ? '' : 'd-none' ?>\">\n                            <div class=\"form-group\">\n                                <?php\n                                $i = 0;\n                                foreach (json_decode($nav['submenu'], true) as $name => $url) {\n                                    $i++;\n                                    ?>\n                                    <div class=\"card card-body\" id=\"nav-<?= $i ?>\">\n                                        <div class=\"form-group\">\n                                            <label><?= $Lang->get('NAVBAR__LINK_NAME') ?></label>\n                                            <input type=\"text\" class=\"form-control name_of_nav\"\n                                                   value=\"<?= $name ?>\" name=\"name_of_nav\">\n                                        </div>\n                                        <div class=\"form-group\">\n                                            <label><?= $Lang->get('URL') ?></label>\n                                            <input type=\"text\" class=\"form-control url_of_nav\"\n                                                   value=\"<?= $url ?>\"\n                                                   placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\">\n                                        </div>\n                                        <a href=\"#\"\n                                           class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a>\n                                        <br>\n                                    </div>\n                                <?php } ?>\n                            </div>\n                            <div id=\"add-js\" data-number=\"<?= $i ?>\"></div>\n                            <div class=\"control-group\">\n                                <a href=\"#\" id=\"add_nav\"\n                                   class=\"btn btn-success\"><?= $Lang->get('NAVBAR__ADD_LINK') ?></a>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <div class=\"checkbox\">\n                                <input type=\"checkbox\" name=\"new_tab\"<?= ($nav['open_new_tab']) ? ' checked=\"\"' : '' ?>>\n                                <label><?= $Lang->get('NAVBAR__OPEN_IN_NEW_TAB') ?></label>\n                            </div>\n                        </div>\n\n                        <div class=\"float-right\">\n                            <a href=\"<?= $this->Html->url(['controller' => 'navbar', 'action' => 'admin_index', 'admin' => true]) ?>\"\n                               class=\"btn btn-default\"><?= $Lang->get('GLOBAL__CANCEL') ?></a>\n                            <button class=\"btn btn-primary\" type=\"submit\"><?= $Lang->get('GLOBAL__SUBMIT') ?></button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</section>\n<script type=\"text/javascript\">\n    $('#add_nav').click(function (e) {\n        e.preventDefault();\n        var how = $('#add-js').attr('data-number');\n        how = parseInt(how) + 1;\n        var add = '<div class=\"form-group\"><div class=\"card card-body\" id=\"nav-' + how + '\"><div class=\"form-group\"><label><?= addslashes($Lang->get('NAVBAR__LINK_NAME')) ?></label><input type=\"text\" class=\"form-control name_of_nav\" name=\"name_of_nav\"></div><div class=\"form-group\"><label><?= $Lang->get('URL') ?></label><input type=\"text\" class=\"form-control url_of_nav\" placeholder=\"<?= $Lang->get('NAVBAR__CUSTOM_URL') ?>\" name=\"url\"></div><a href=\"#\" class=\"btn btn-danger delete-nav float-right\"><?= $Lang->get('GLOBAL__DELETE') ?></a><br></div></div>';\n        $('#add-js').append(add);\n        $('#add-js').attr('data-number', how);\n        deleteNavEvents();\n    });\n    deleteNavEvents();\n\n    function deleteNavEvents() {\n        $('.delete-nav').unbind('click');\n        $('.delete-nav').on('click', function (e) {\n            e.preventDefault();\n            var div = $(this).parent();\n            div.slideUp(150, function () {\n                $(this).remove();\n            });\n        });\n    }\n</script>\n<script type=\"text/javascript\">\n    $(\"#normal\").change(function () {\n        if ($(\"#normal\").is(':checked')) {\n            $(\"#type-normal\").removeClass('d-none');\n            $(\"#type-dropdown\").addClass('d-none');\n        } else {\n            $(\"#type-normal\").addClass('d-none');\n            $(\"#type-dropdown\").removeClass('d-none');\n        }\n    });\n    $(\"#dropdown\").change(function () {\n        if ($(\"dropdown\").is(':checked')) {\n            $(\"#type-dropdown\").addClass('d-none');\n            $(\"#type-normal\").removeClass('d-none');\n        } else {\n            $(\"#type-dropdown\").removeClass('d-none');\n            $(\"#type-normal\").addClass('d-none');\n        }\n    });\n\n    $(\".type_plugin\").change(function () {\n        if ($(\".type_plugin\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").removeClass('d-none');\n        } else {\n            $(\".plugin\").addClass('d-none');\n        }\n    });\n\n    $(\".type_page\").change(function () {\n        if ($(\".type_page\").is(':checked')) {\n            $(\".page\").removeClass('d-none');\n            $(\".custom\").addClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".page\").addClass('d-none');\n        }\n    });\n\n    $(\".type_custom\").change(function () {\n        if ($(\".type_custom\").is(':checked')) {\n            $(\".page\").addClass('d-none');\n            $(\".custom\").removeClass('d-none');\n            $(\".plugin\").addClass('d-none');\n        } else {\n            $(\".custom\").addClass('d-none');\n        }\n    });\n</script>\n<script type=\"text/javascript\">\n    function formatteData($form) {\n        var name = $form.find(\"input[name='name']\").val();\n        var icon = $form.find(\"input[name='icon']\").val();\n        var type = $form.find(\"input[type='radio'][name='type']:checked\").val();\n        var url;\n        if (type === \"normal\") {\n            if ($form.find(\"input[name='url_type']:checked\").val() === \"custom\")\n                url = '{\"type\":\"custom\", \"url\":\"' + $form.find(\"input[name='url_custom']\").val() + '\"}';\n            else if ($form.find(\"input[name='url_type']:checked\").val() === \"plugin\") {\n                var value = $form.find(\"select[name='url_plugin']\").val();\n                value = JSON.parse(value);\n                url = {\n                    type: 'plugin',\n                    id: value.id,\n                    route: value.route\n                };\n                url = JSON.stringify(url);\n            } else if ($form.find(\"input[name='url_type']:checked\").val() === \"page\")\n                url = '{\"type\":\"page\", \"id\":\"' + $form.find(\"select[name='url_page']\").val() + '\"}';\n            else\n                url = \"undefined\";\n        } else {\n            var names = $('.name_of_nav').serialize();\n            names = names.split('&');\n            var urls = $('.url_of_nav').serialize();\n            urls = urls.split('&');\n            url = {};\n            for (var key in test = names) {\n                var l = test[key].split('=');\n                l = decodeURIComponent(l[1]);\n                var p = urls[key].split('=');\n                p = decodeURIComponent(p[1]);\n                url[l] = p;\n            }\n        }\n\n        var inputs = {};\n        inputs['name'] = name;\n        inputs['icon'] = icon;\n        inputs['type'] = type;\n        inputs['url'] = url;\n        inputs['open_new_tab'] = $('input[name=\"new_tab\"]').is(':checked');\n        inputs['data[_Token][key]'] = '<?= $csrfToken ?>';\n\n        return inputs;\n    }\n</script>\n"], "filenames": ["app/View/Navbar/admin_add.ctp", "app/View/Navbar/admin_edit.ctp"], "buggy_code_start_loc": [227, 99], "buggy_code_end_loc": [230, 244], "fixing_code_start_loc": [227, 99], "fixing_code_end_loc": [230, 244], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository mineweb/minewebcms prior to next.", "other": {"cve": {"id": "CVE-2022-1163", "sourceIdentifier": "security@huntr.dev", "published": "2022-03-30T07:15:07.223", "lastModified": "2022-06-02T20:12:39.457", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository mineweb/minewebcms prior to next."}, {"lang": "es", "value": "Una vulnerabilidad de tipo Cross-site Scripting (XSS) - Almacenado en el repositorio de GitHub mineweb/minewebcms anteriores al siguiente"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 5.3}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mineweb:minewebcms:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.15.2", "matchCriteriaId": "3215BB3E-B1BF-47E8-95F8-743DB93E7B60"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/166629/minewebcms-1.15.2-Cross-Site-Scripting.html", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/mineweb/minewebcms/commit/06ce52c20f208b0bbf24c6480d60332c9dd19428", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/44d40f34-c391-40c0-a517-12a2c0258149", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://www.exploit-db.com/exploits/50853", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/mineweb/minewebcms/commit/06ce52c20f208b0bbf24c6480d60332c9dd19428"}}