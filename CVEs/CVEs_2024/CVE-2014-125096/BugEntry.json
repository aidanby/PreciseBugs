{"buggy_code": ["(function($){\n  'use strict';\n\n  // Render the template stylesheets\n  if(FANCYGALLERY.stylesheets){\n    var $head = $('head:first');\n    for(var index in FANCYGALLERY.stylesheets){\n      $('<link rel=\"stylesheet\" href=\"\" media=\"screen\">').attr('href', FANCYGALLERY.stylesheets[index]).appendTo($head);\n    }\n  }\n\n  /*\n  // group gallery items\n  $('div.fancy-gallery a').each(function(){\n    var $this = $(this);\n    $this.attr('rel', $this.parents('.fancy-gallery').attr('id'));\n  });\n  */\n\n  // Associate the links with the lightbox\n  if (FANCYGALLERY.lightbox == 'on'){\n    // Load lightbox library (blueimp Gallery JS 2.14.0)\n    !function(){\"use strict\";function a(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function b(a){if(!this||this.find!==b.prototype.find)return new b(a);if(this.length=0,a)if(\"string\"==typeof a&&(a=this.find(a)),a.nodeType||a===a.window)this.length=1,this[0]=a;else{var c=a.length;for(this.length=c;c;)c-=1,this[c]=a[c]}}b.extend=a,b.contains=function(a,b){do if(b=b.parentNode,b===a)return!0;while(b);return!1},b.parseJSON=function(a){return window.JSON&&JSON.parse(a)},a(b.prototype,{find:function(a){var c=this[0]||document;return\"string\"==typeof a&&(a=c.querySelectorAll?c.querySelectorAll(a):\"#\"===a.charAt(0)?c.getElementById(a.slice(1)):c.getElementsByTagName(a)),new b(a)},hasClass:function(a){return this[0]?new RegExp(\"(^|\\\\s+)\"+a+\"(\\\\s+|$)\").test(this[0].className):!1},addClass:function(a){for(var b,c=this.length;c;){if(c-=1,b=this[c],!b.className)return b.className=a,this;if(this.hasClass(a))return this;b.className+=\" \"+a}return this},removeClass:function(a){for(var b,c=new RegExp(\"(^|\\\\s+)\"+a+\"(\\\\s+|$)\"),d=this.length;d;)d-=1,b=this[d],b.className=b.className.replace(c,\" \");return this},on:function(a,b){for(var c,d,e=a.split(/\\s+/);e.length;)for(a=e.shift(),c=this.length;c;)c-=1,d=this[c],d.addEventListener?d.addEventListener(a,b,!1):d.attachEvent&&d.attachEvent(\"on\"+a,b);return this},off:function(a,b){for(var c,d,e=a.split(/\\s+/);e.length;)for(a=e.shift(),c=this.length;c;)c-=1,d=this[c],d.removeEventListener?d.removeEventListener(a,b,!1):d.detachEvent&&d.detachEvent(\"on\"+a,b);return this},empty:function(){for(var a,b=this.length;b;)for(b-=1,a=this[b];a.hasChildNodes();)a.removeChild(a.lastChild);return this},first:function(){return new b(this[0])}}),\"function\"==typeof define&&define.amd?define(function(){return b}):(window.blueimp=window.blueimp||{},window.blueimp.helper=b)}(),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\"],a):(window.blueimp=window.blueimp||{},window.blueimp.Gallery=a(window.blueimp.helper||window.jQuery))}(function(a){\"use strict\";function b(a,c){return void 0===document.body.style.maxHeight?null:this&&this.options===b.prototype.options?a&&a.length?(this.list=a,this.num=a.length,this.initOptions(c),void this.initialize()):void this.console.log(\"blueimp Gallery: No or empty list provided as first argument.\",a):new b(a,c)}return a.extend(b.prototype,{options:{container:\"#blueimp-gallery\",slidesContainer:\"div\",titleElement:\"h3\",displayClass:\"blueimp-gallery-display\",controlsClass:\"blueimp-gallery-controls\",singleClass:\"blueimp-gallery-single\",leftEdgeClass:\"blueimp-gallery-left\",rightEdgeClass:\"blueimp-gallery-right\",playingClass:\"blueimp-gallery-playing\",slideClass:\"slide\",slideLoadingClass:\"slide-loading\",slideErrorClass:\"slide-error\",slideContentClass:\"slide-content\",toggleClass:\"toggle\",prevClass:\"prev\",nextClass:\"next\",closeClass:\"close\",playPauseClass:\"play-pause\",typeProperty:\"type\",titleProperty:\"title\",urlProperty:\"href\",displayTransition:!0,clearSlides:!0,stretchImages:!1,toggleControlsOnReturn:!0,toggleSlideshowOnSpace:!0,enableKeyboardNavigation:!0,closeOnEscape:!0,closeOnSlideClick:!0,closeOnSwipeUpOrDown:!0,emulateTouchEvents:!0,stopTouchEventsPropagation:!1,hidePageScrollbars:!0,disableScroll:!0,carousel:!1,continuous:!0,unloadElements:!0,startSlideshow:!1,slideshowInterval:5e3,index:0,preloadRange:2,transitionSpeed:400,slideshowTransitionSpeed:void 0,event:void 0,onopen:void 0,onopened:void 0,onslide:void 0,onslideend:void 0,onslidecomplete:void 0,onclose:void 0,onclosed:void 0},carouselOptions:{hidePageScrollbars:!1,toggleControlsOnReturn:!1,toggleSlideshowOnSpace:!1,enableKeyboardNavigation:!1,closeOnEscape:!1,closeOnSlideClick:!1,closeOnSwipeUpOrDown:!1,disableScroll:!1,startSlideshow:!0},console:window.console&&\"function\"==typeof window.console.log?window.console:{log:function(){}},support:function(b){var c={touch:void 0!==window.ontouchstart||window.DocumentTouch&&document instanceof DocumentTouch},d={webkitTransition:{end:\"webkitTransitionEnd\",prefix:\"-webkit-\"},MozTransition:{end:\"transitionend\",prefix:\"-moz-\"},OTransition:{end:\"otransitionend\",prefix:\"-o-\"},transition:{end:\"transitionend\",prefix:\"\"}},e=function(){var a,d,e=c.transition;document.body.appendChild(b),e&&(a=e.name.slice(0,-9)+\"ransform\",void 0!==b.style[a]&&(b.style[a]=\"translateZ(0)\",d=window.getComputedStyle(b).getPropertyValue(e.prefix+\"transform\"),c.transform={prefix:e.prefix,name:a,translate:!0,translateZ:!!d&&\"none\"!==d})),void 0!==b.style.backgroundSize&&(c.backgroundSize={},b.style.backgroundSize=\"contain\",c.backgroundSize.contain=\"contain\"===window.getComputedStyle(b).getPropertyValue(\"background-size\"),b.style.backgroundSize=\"cover\",c.backgroundSize.cover=\"cover\"===window.getComputedStyle(b).getPropertyValue(\"background-size\")),document.body.removeChild(b)};return function(a,c){var d;for(d in c)if(c.hasOwnProperty(d)&&void 0!==b.style[d]){a.transition=c[d],a.transition.name=d;break}}(c,d),document.body?e():a(document).on(\"DOMContentLoaded\",e),c}(document.createElement(\"div\")),requestAnimationFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,initialize:function(){return this.initStartIndex(),this.initWidget()===!1?!1:(this.initEventListeners(),this.onslide(this.index),this.ontransitionend(),void(this.options.startSlideshow&&this.play()))},slide:function(a,b){window.clearTimeout(this.timeout);var c,d,e,f=this.index;if(f!==a&&1!==this.num){if(b||(b=this.options.transitionSpeed),this.support.transition){for(this.options.continuous||(a=this.circle(a)),c=Math.abs(f-a)/(f-a),this.options.continuous&&(d=c,c=-this.positions[this.circle(a)]/this.slideWidth,c!==d&&(a=-c*this.num+a)),e=Math.abs(f-a)-1;e;)e-=1,this.move(this.circle((a>f?a:f)-e-1),this.slideWidth*c,0);a=this.circle(a),this.move(f,this.slideWidth*c,b),this.move(a,0,b),this.options.continuous&&this.move(this.circle(a-c),-(this.slideWidth*c),0)}else a=this.circle(a),this.animate(f*-this.slideWidth,a*-this.slideWidth,b);this.onslide(a)}},getIndex:function(){return this.index},getNumber:function(){return this.num},prev:function(){(this.options.continuous||this.index)&&this.slide(this.index-1)},next:function(){(this.options.continuous||this.index<this.num-1)&&this.slide(this.index+1)},play:function(a){var b=this;window.clearTimeout(this.timeout),this.interval=a||this.options.slideshowInterval,this.elements[this.index]>1&&(this.timeout=this.setTimeout(!this.requestAnimationFrame&&this.slide||function(a,c){b.animationFrameId=b.requestAnimationFrame.call(window,function(){b.slide(a,c)})},[this.index+1,this.options.slideshowTransitionSpeed],this.interval)),this.container.addClass(this.options.playingClass)},pause:function(){window.clearTimeout(this.timeout),this.interval=null,this.container.removeClass(this.options.playingClass)},add:function(a){var b;for(a.concat||(a=Array.prototype.slice.call(a)),this.list.concat||(this.list=Array.prototype.slice.call(this.list)),this.list=this.list.concat(a),this.num=this.list.length,this.num>2&&null===this.options.continuous&&(this.options.continuous=!0,this.container.removeClass(this.options.leftEdgeClass)),this.container.removeClass(this.options.rightEdgeClass).removeClass(this.options.singleClass),b=this.num-a.length;b<this.num;b+=1)this.addSlide(b),this.positionSlide(b);this.positions.length=this.num,this.initSlides(!0)},resetSlides:function(){this.slidesContainer.empty(),this.slides=[]},handleClose:function(){var a=this.options;this.destroyEventListeners(),this.pause(),this.container[0].style.display=\"none\",this.container.removeClass(a.displayClass).removeClass(a.singleClass).removeClass(a.leftEdgeClass).removeClass(a.rightEdgeClass),a.hidePageScrollbars&&(document.body.style.overflow=this.bodyOverflowStyle),this.options.clearSlides&&this.resetSlides(),this.options.onclosed&&this.options.onclosed.call(this)},close:function(){var a=this,b=function(c){c.target===a.container[0]&&(a.container.off(a.support.transition.end,b),a.handleClose())};this.options.onclose&&this.options.onclose.call(this),this.support.transition&&this.options.displayTransition?(this.container.on(this.support.transition.end,b),this.container.removeClass(this.options.displayClass)):this.handleClose()},circle:function(a){return(this.num+a%this.num)%this.num},move:function(a,b,c){this.translateX(a,b,c),this.positions[a]=b},translate:function(a,b,c,d){var e=this.slides[a].style,f=this.support.transition,g=this.support.transform;e[f.name+\"Duration\"]=d+\"ms\",e[g.name]=\"translate(\"+b+\"px, \"+c+\"px)\"+(g.translateZ?\" translateZ(0)\":\"\")},translateX:function(a,b,c){this.translate(a,b,0,c)},translateY:function(a,b,c){this.translate(a,0,b,c)},animate:function(a,b,c){if(!c)return void(this.slidesContainer[0].style.left=b+\"px\");var d=this,e=(new Date).getTime(),f=window.setInterval(function(){var g=(new Date).getTime()-e;return g>c?(d.slidesContainer[0].style.left=b+\"px\",d.ontransitionend(),void window.clearInterval(f)):void(d.slidesContainer[0].style.left=(b-a)*(Math.floor(g/c*100)/100)+a+\"px\")},4)},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},onresize:function(){this.initSlides(!0)},onmousedown:function(a){a.which&&1===a.which&&\"VIDEO\"!==a.target.nodeName&&(a.preventDefault(),(a.originalEvent||a).touches=[{pageX:a.pageX,pageY:a.pageY}],this.ontouchstart(a))},onmousemove:function(a){this.touchStart&&((a.originalEvent||a).touches=[{pageX:a.pageX,pageY:a.pageY}],this.ontouchmove(a))},onmouseup:function(a){this.touchStart&&(this.ontouchend(a),delete this.touchStart)},onmouseout:function(b){if(this.touchStart){var c=b.target,d=b.relatedTarget;(!d||d!==c&&!a.contains(c,d))&&this.onmouseup(b)}},ontouchstart:function(a){this.options.stopTouchEventsPropagation&&this.stopPropagation(a);var b=(a.originalEvent||a).touches[0];this.touchStart={x:b.pageX,y:b.pageY,time:Date.now()},this.isScrolling=void 0,this.touchDelta={}},ontouchmove:function(a){this.options.stopTouchEventsPropagation&&this.stopPropagation(a);var b,c,d=(a.originalEvent||a).touches[0],e=(a.originalEvent||a).scale,f=this.index;if(!(d.length>1||e&&1!==e))if(this.options.disableScroll&&a.preventDefault(),this.touchDelta={x:d.pageX-this.touchStart.x,y:d.pageY-this.touchStart.y},b=this.touchDelta.x,void 0===this.isScrolling&&(this.isScrolling=this.isScrolling||Math.abs(b)<Math.abs(this.touchDelta.y)),this.isScrolling)this.options.closeOnSwipeUpOrDown&&this.translateY(f,this.touchDelta.y+this.positions[f],0);else for(a.preventDefault(),window.clearTimeout(this.timeout),this.options.continuous?c=[this.circle(f+1),f,this.circle(f-1)]:(this.touchDelta.x=b/=!f&&b>0||f===this.num-1&&0>b?Math.abs(b)/this.slideWidth+1:1,c=[f],f&&c.push(f-1),f<this.num-1&&c.unshift(f+1));c.length;)f=c.pop(),this.translateX(f,b+this.positions[f],0)},ontouchend:function(a){this.options.stopTouchEventsPropagation&&this.stopPropagation(a);var b,c,d,e,f,g=this.index,h=this.options.transitionSpeed,i=this.slideWidth,j=Number(Date.now()-this.touchStart.time)<250,k=j&&Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.x)>i/2,l=!g&&this.touchDelta.x>0||g===this.num-1&&this.touchDelta.x<0,m=!k&&this.options.closeOnSwipeUpOrDown&&(j&&Math.abs(this.touchDelta.y)>20||Math.abs(this.touchDelta.y)>this.slideHeight/2);this.options.continuous&&(l=!1),b=this.touchDelta.x<0?-1:1,this.isScrolling?m?this.close():this.translateY(g,0,h):k&&!l?(c=g+b,d=g-b,e=i*b,f=-i*b,this.options.continuous?(this.move(this.circle(c),e,0),this.move(this.circle(g-2*b),f,0)):c>=0&&c<this.num&&this.move(c,e,0),this.move(g,this.positions[g]+e,h),this.move(this.circle(d),this.positions[this.circle(d)]+e,h),g=this.circle(d),this.onslide(g)):this.options.continuous?(this.move(this.circle(g-1),-i,h),this.move(g,0,h),this.move(this.circle(g+1),i,h)):(g&&this.move(g-1,-i,h),this.move(g,0,h),g<this.num-1&&this.move(g+1,i,h))},ontouchcancel:function(a){this.touchStart&&(this.ontouchend(a),delete this.touchStart)},ontransitionend:function(a){var b=this.slides[this.index];a&&b!==a.target||(this.interval&&this.play(),this.setTimeout(this.options.onslideend,[this.index,b]))},oncomplete:function(b){var c,d=b.target||b.srcElement,e=d&&d.parentNode;d&&e&&(c=this.getNodeIndex(e),a(e).removeClass(this.options.slideLoadingClass),\"error\"===b.type?(a(e).addClass(this.options.slideErrorClass),this.elements[c]=3):this.elements[c]=2,d.clientHeight>this.container[0].clientHeight&&(d.style.maxHeight=this.container[0].clientHeight),this.interval&&this.slides[this.index]===e&&this.play(),this.setTimeout(this.options.onslidecomplete,[c,e]))},onload:function(a){this.oncomplete(a)},onerror:function(a){this.oncomplete(a)},onkeydown:function(a){switch(a.which||a.keyCode){case 13:this.options.toggleControlsOnReturn&&(this.preventDefault(a),this.toggleControls());break;case 27:this.options.closeOnEscape&&this.close();break;case 32:this.options.toggleSlideshowOnSpace&&(this.preventDefault(a),this.toggleSlideshow());break;case 37:this.options.enableKeyboardNavigation&&(this.preventDefault(a),this.prev());break;case 39:this.options.enableKeyboardNavigation&&(this.preventDefault(a),this.next())}},handleClick:function(b){var c=this.options,d=b.target||b.srcElement,e=d.parentNode,f=function(b){return a(d).hasClass(b)||a(e).hasClass(b)};f(c.toggleClass)?(this.preventDefault(b),this.toggleControls()):f(c.prevClass)?(this.preventDefault(b),this.prev()):f(c.nextClass)?(this.preventDefault(b),this.next()):f(c.closeClass)?(this.preventDefault(b),this.close()):f(c.playPauseClass)?(this.preventDefault(b),this.toggleSlideshow()):e===this.slidesContainer[0]?(this.preventDefault(b),c.closeOnSlideClick?this.close():this.toggleControls()):e.parentNode&&e.parentNode===this.slidesContainer[0]&&(this.preventDefault(b),this.toggleControls())},onclick:function(a){return this.options.emulateTouchEvents&&this.touchDelta&&(Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.y)>20)?void delete this.touchDelta:this.handleClick(a)},updateEdgeClasses:function(a){a?this.container.removeClass(this.options.leftEdgeClass):this.container.addClass(this.options.leftEdgeClass),a===this.num-1?this.container.addClass(this.options.rightEdgeClass):this.container.removeClass(this.options.rightEdgeClass)},handleSlide:function(a){this.options.continuous||this.updateEdgeClasses(a),this.loadElements(a),this.options.unloadElements&&this.unloadElements(a),this.setTitle(a)},onslide:function(a){this.index=a,this.handleSlide(a),this.setTimeout(this.options.onslide,[a,this.slides[a]])},setTitle:function(a){var b=this.slides[a].firstChild.title,c=this.titleElement;c.length&&(this.titleElement.empty(),b&&c[0].appendChild(document.createTextNode(b)))},setTimeout:function(a,b,c){var d=this;return a&&window.setTimeout(function(){a.apply(d,b||[])},c||0)},imageFactory:function(b,c){var d,e,f,g=this,h=this.imagePrototype.cloneNode(!1),i=b,j=this.options.stretchImages,k=function(b){if(!d){if(b={type:b.type,target:e},!e.parentNode)return g.setTimeout(k,[b]);d=!0,a(h).off(\"load error\",k),j&&\"load\"===b.type&&(e.style.background='url(\"'+i+'\") center no-repeat',e.style.backgroundSize=j),c(b)}};return\"string\"!=typeof i&&(i=this.getItemProperty(b,this.options.urlProperty),f=this.getItemProperty(b,this.options.titleProperty)),j===!0&&(j=\"contain\"),j=this.support.backgroundSize&&this.support.backgroundSize[j]&&j,j?e=this.elementPrototype.cloneNode(!1):(e=h,h.draggable=!1),f&&(e.title=f),a(h).on(\"load error\",k),h.src=i,e},createElement:function(b,c){var d=b&&this.getItemProperty(b,this.options.typeProperty),e=d&&this[d.split(\"/\")[0]+\"Factory\"]||this.imageFactory,f=b&&e.call(this,b,c);return f||(f=this.elementPrototype.cloneNode(!1),this.setTimeout(c,[{type:\"error\",target:f}])),a(f).addClass(this.options.slideContentClass),f},loadElement:function(b){this.elements[b]||(this.slides[b].firstChild?this.elements[b]=a(this.slides[b]).hasClass(this.options.slideErrorClass)?3:2:(this.elements[b]=1,a(this.slides[b]).addClass(this.options.slideLoadingClass),this.slides[b].appendChild(this.createElement(this.list[b],this.proxyListener))))},loadElements:function(a){var b,c=Math.min(this.num,2*this.options.preloadRange+1),d=a;for(b=0;c>b;b+=1)d+=b*(b%2===0?-1:1),d=this.circle(d),this.loadElement(d)},unloadElements:function(a){var b,c,d;for(b in this.elements)this.elements.hasOwnProperty(b)&&(d=Math.abs(a-b),d>this.options.preloadRange&&d+this.options.preloadRange<this.num&&(c=this.slides[b],c.removeChild(c.firstChild),delete this.elements[b]))},addSlide:function(a){var b=this.slidePrototype.cloneNode(!1);b.setAttribute(\"data-index\",a),this.slidesContainer[0].appendChild(b),this.slides.push(b)},positionSlide:function(a){var b=this.slides[a];b.style.width=this.slideWidth+\"px\",this.support.transition&&(b.style.left=a*-this.slideWidth+\"px\",this.move(a,this.index>a?-this.slideWidth:this.index<a?this.slideWidth:0,0))},initSlides:function(b){var c,d;for(b||(this.positions=[],this.positions.length=this.num,this.elements={},this.imagePrototype=document.createElement(\"img\"),this.elementPrototype=document.createElement(\"div\"),this.slidePrototype=document.createElement(\"div\"),a(this.slidePrototype).addClass(this.options.slideClass),this.slides=this.slidesContainer[0].children,c=this.options.clearSlides||this.slides.length!==this.num),this.slideWidth=this.container[0].offsetWidth,this.slideHeight=this.container[0].offsetHeight,this.slidesContainer[0].style.width=this.num*this.slideWidth+\"px\",c&&this.resetSlides(),d=0;d<this.num;d+=1)c&&this.addSlide(d),this.positionSlide(d);this.options.continuous&&this.support.transition&&(this.move(this.circle(this.index-1),-this.slideWidth,0),this.move(this.circle(this.index+1),this.slideWidth,0)),this.support.transition||(this.slidesContainer[0].style.left=this.index*-this.slideWidth+\"px\")},toggleControls:function(){var a=this.options.controlsClass;this.container.hasClass(a)?this.container.removeClass(a):this.container.addClass(a)},toggleSlideshow:function(){this.interval?this.pause():this.play()},getNodeIndex:function(a){return parseInt(a.getAttribute(\"data-index\"),10)},getNestedProperty:function(a,b){return b.replace(/\\[(?:'([^']+)'|\"([^\"]+)\"|(\\d+))\\]|(?:(?:^|\\.)([^\\.\\[]+))/g,function(b,c,d,e,f){var g=f||c||d||e&&parseInt(e,10);b&&a&&(a=a[g])}),a},getDataProperty:function(b,c){if(b.getAttribute){var d=b.getAttribute(\"data-\"+c.replace(/([A-Z])/g,\"-$1\").toLowerCase());if(\"string\"==typeof d){if(/^(true|false|null|-?\\d+(\\.\\d+)?|\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\])$/.test(d))try{return a.parseJSON(d)}catch(e){}return d}}},getItemProperty:function(a,b){var c=a[b];return void 0===c&&(c=this.getDataProperty(a,b),void 0===c&&(c=this.getNestedProperty(a,b))),c},initStartIndex:function(){var a,b=this.options.index,c=this.options.urlProperty;if(b&&\"number\"!=typeof b)for(a=0;a<this.num;a+=1)if(this.list[a]===b||this.getItemProperty(this.list[a],c)===this.getItemProperty(b,c)){b=a;break}this.index=this.circle(parseInt(b,10)||0)},initEventListeners:function(){var b=this,c=this.slidesContainer,d=function(a){var c=b.support.transition&&b.support.transition.end===a.type?\"transitionend\":a.type;b[\"on\"+c](a)};a(window).on(\"resize\",d),a(document.body).on(\"keydown\",d),this.container.on(\"click\",d),this.support.touch?c.on(\"touchstart touchmove touchend touchcancel\",d):this.options.emulateTouchEvents&&this.support.transition&&c.on(\"mousedown mousemove mouseup mouseout\",d),this.support.transition&&c.on(this.support.transition.end,d),this.proxyListener=d},destroyEventListeners:function(){var b=this.slidesContainer,c=this.proxyListener;a(window).off(\"resize\",c),a(document.body).off(\"keydown\",c),this.container.off(\"click\",c),this.support.touch?b.off(\"touchstart touchmove touchend touchcancel\",c):this.options.emulateTouchEvents&&this.support.transition&&b.off(\"mousedown mousemove mouseup mouseout\",c),this.support.transition&&b.off(this.support.transition.end,c)},handleOpen:function(){this.options.onopened&&this.options.onopened.call(this)},initWidget:function(){var b=this,c=function(a){a.target===b.container[0]&&(b.container.off(b.support.transition.end,c),b.handleOpen())};return this.container=a(this.options.container),this.container.length?(this.slidesContainer=this.container.find(this.options.slidesContainer).first(),this.slidesContainer.length?(this.titleElement=this.container.find(this.options.titleElement).first(),1===this.num&&this.container.addClass(this.options.singleClass),this.options.onopen&&this.options.onopen.call(this),this.support.transition&&this.options.displayTransition?this.container.on(this.support.transition.end,c):this.handleOpen(),this.options.hidePageScrollbars&&(this.bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow=\"hidden\"),this.container[0].style.display=\"block\",this.initSlides(),void this.container.addClass(this.options.displayClass)):(this.console.log(\"blueimp Gallery: Slides container not found.\",this.options.slidesContainer),!1)):(this.console.log(\"blueimp Gallery: Widget container not found.\",this.options.container),!1)},initOptions:function(b){this.options=a.extend({},this.options),(b&&b.carousel||this.options.carousel&&(!b||b.carousel!==!1))&&a.extend(this.options,this.carouselOptions),a.extend(this.options,b),this.num<3&&(this.options.continuous=this.options.continuous?null:!1),this.support.transition||(this.options.emulateTouchEvents=!1),this.options.event&&this.preventDefault(this.options.event)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";a.extend(b.prototype.options,{fullScreen:!1});var c=b.prototype.initialize,d=b.prototype.close;return a.extend(b.prototype,{getFullScreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullScreen:function(a){a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen&&a.msRequestFullscreen()},exitFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},initialize:function(){c.call(this),this.options.fullScreen&&!this.getFullScreenElement()&&this.requestFullScreen(this.container[0])},close:function(){this.getFullScreenElement()===this.container[0]&&this.exitFullScreen(),d.call(this)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";a.extend(b.prototype.options,{indicatorContainer:\"ol\",activeIndicatorClass:\"active\",thumbnailProperty:\"thumbnail\",thumbnailIndicators:!0});var c=b.prototype.initSlides,d=b.prototype.addSlide,e=b.prototype.resetSlides,f=b.prototype.handleClick,g=b.prototype.handleSlide,h=b.prototype.handleClose;return a.extend(b.prototype,{createIndicator:function(b){var c,d,e=this.indicatorPrototype.cloneNode(!1),f=this.getItemProperty(b,this.options.titleProperty),g=this.options.thumbnailProperty;return this.options.thumbnailIndicators&&(d=b.getElementsByTagName&&a(b).find(\"img\")[0],d?c=d.src:g&&(c=this.getItemProperty(b,g)),c&&(e.style.backgroundImage='url(\"'+c+'\")')),f&&(e.title=f),e},addIndicator:function(a){if(this.indicatorContainer.length){var b=this.createIndicator(this.list[a]);b.setAttribute(\"data-index\",a),this.indicatorContainer[0].appendChild(b),this.indicators.push(b)}},setActiveIndicator:function(b){this.indicators&&(this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),this.activeIndicator=a(this.indicators[b]),this.activeIndicator.addClass(this.options.activeIndicatorClass))},initSlides:function(a){a||(this.indicatorContainer=this.container.find(this.options.indicatorContainer),this.indicatorContainer.length&&(this.indicatorPrototype=document.createElement(\"li\"),this.indicators=this.indicatorContainer[0].children)),c.call(this,a)},addSlide:function(a){d.call(this,a),this.addIndicator(a)},resetSlides:function(){e.call(this),this.indicatorContainer.empty(),this.indicators=[]},handleClick:function(a){var b=a.target||a.srcElement,c=b.parentNode;if(c===this.indicatorContainer[0])this.preventDefault(a),this.slide(this.getNodeIndex(b));else{if(c.parentNode!==this.indicatorContainer[0])return f.call(this,a);this.preventDefault(a),this.slide(this.getNodeIndex(c))}},handleSlide:function(a){g.call(this,a),this.setActiveIndicator(a)},handleClose:function(){this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),h.call(this)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";a.extend(b.prototype.options,{videoContentClass:\"video-content\",videoLoadingClass:\"video-loading\",videoPlayingClass:\"video-playing\",videoPosterProperty:\"poster\",videoSourcesProperty:\"sources\"});var c=b.prototype.handleSlide;return a.extend(b.prototype,{handleSlide:function(a){c.call(this,a),this.playingVideo&&this.playingVideo.pause()},videoFactory:function(b,c,d){var e,f,g,h,i,j=this,k=this.options,l=this.elementPrototype.cloneNode(!1),m=a(l),n=[{type:\"error\",target:l}],o=d||document.createElement(\"video\"),p=this.getItemProperty(b,k.urlProperty),q=this.getItemProperty(b,k.typeProperty),r=this.getItemProperty(b,k.titleProperty),s=this.getItemProperty(b,k.videoPosterProperty),t=this.getItemProperty(b,k.videoSourcesProperty);if(m.addClass(k.videoContentClass),r&&(l.title=r),o.canPlayType)if(p&&q&&o.canPlayType(q))o.src=p;else for(;t&&t.length;)if(f=t.shift(),p=this.getItemProperty(f,k.urlProperty),q=this.getItemProperty(f,k.typeProperty),p&&q&&o.canPlayType(q)){o.src=p;break}return s&&(o.poster=s,e=this.imagePrototype.cloneNode(!1),a(e).addClass(k.toggleClass),e.src=s,e.draggable=!1,l.appendChild(e)),g=document.createElement(\"a\"),g.setAttribute(\"target\",\"_blank\"),d||g.setAttribute(\"download\",r),g.href=p,o.src&&(o.controls=!0,(d||a(o)).on(\"error\",function(){j.setTimeout(c,n)}).on(\"pause\",function(){h=!1,m.removeClass(j.options.videoLoadingClass).removeClass(j.options.videoPlayingClass),i&&j.container.addClass(j.options.controlsClass),delete j.playingVideo,j.interval&&j.play()}).on(\"playing\",function(){h=!1,m.removeClass(j.options.videoLoadingClass).addClass(j.options.videoPlayingClass),j.container.hasClass(j.options.controlsClass)?(i=!0,j.container.removeClass(j.options.controlsClass)):i=!1}).on(\"play\",function(){window.clearTimeout(j.timeout),h=!0,m.addClass(j.options.videoLoadingClass),j.playingVideo=o}),a(g).on(\"click\",function(a){j.preventDefault(a),h?o.pause():o.play()}),l.appendChild(d&&d.element||o)),l.appendChild(g),this.setTimeout(c,[{type:\"load\",target:l}]),l}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery-video\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";if(!window.postMessage)return b;a.extend(b.prototype.options,{vimeoVideoIdProperty:\"vimeo\",vimeoPlayerUrl:\"//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID\",vimeoPlayerIdPrefix:\"vimeo-player-\",vimeoClickToPlay:!0});var c=b.prototype.textFactory||b.prototype.imageFactory,d=function(a,b,c,d){this.url=a,this.videoId=b,this.playerId=c,this.clickToPlay=d,this.element=document.createElement(\"div\"),this.listeners={}},e=0;return a.extend(d.prototype,{canPlayType:function(){return!0},on:function(a,b){return this.listeners[a]=b,this},loadAPI:function(){for(var b,c,d=this,e=\"//\"+(\"https\"===location.protocol?\"secure-\":\"\")+\"a.vimeocdn.com/js/froogaloop2.min.js\",f=document.getElementsByTagName(\"script\"),g=f.length,h=function(){!c&&d.playOnReady&&d.play(),c=!0};g;)if(g-=1,f[g].src===e){b=f[g];break}b||(b=document.createElement(\"script\"),b.src=e),a(b).on(\"load\",h),f[0].parentNode.insertBefore(b,f[0]),/loaded|complete/.test(b.readyState)&&h()},onReady:function(){var a=this;this.ready=!0,this.player.addEvent(\"play\",function(){a.hasPlayed=!0,a.onPlaying()}),this.player.addEvent(\"pause\",function(){a.onPause()}),this.player.addEvent(\"finish\",function(){a.onPause()}),this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){this.listeners.pause(),delete this.playStatus},insertIframe:function(){var a=document.createElement(\"iframe\");a.src=this.url.replace(\"VIDEO_ID\",this.videoId).replace(\"PLAYER_ID\",this.playerId),a.id=this.playerId,this.element.parentNode.replaceChild(a,this.element),this.element=a},play:function(){var a=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.api(\"play\"):(this.playOnReady=!0,window.$f?this.player||(this.insertIframe(),this.player=$f(this.element),this.player.addEvent(\"ready\",function(){a.onReady()})):this.loadAPI())},pause:function(){this.ready?this.player.api(\"pause\"):this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),a.extend(b.prototype,{VimeoPlayer:d,textFactory:function(a,b){var f=this.options,g=this.getItemProperty(a,f.vimeoVideoIdProperty);return g?(void 0===this.getItemProperty(a,f.urlProperty)&&(a[f.urlProperty]=\"//vimeo.com/\"+g),e+=1,this.videoFactory(a,b,new d(f.vimeoPlayerUrl,g,f.vimeoPlayerIdPrefix+e,f.vimeoClickToPlay))):c.call(this,a,b)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery-video\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";if(!window.postMessage)return b;a.extend(b.prototype.options,{youTubeVideoIdProperty:\"youtube\",youTubePlayerVars:{wmode:\"transparent\"},youTubeClickToPlay:!0});var c=b.prototype.textFactory||b.prototype.imageFactory,d=function(a,b,c){this.videoId=a,this.playerVars=b,this.clickToPlay=c,this.element=document.createElement(\"div\"),this.listeners={}};return a.extend(d.prototype,{canPlayType:function(){return!0},on:function(a,b){return this.listeners[a]=b,this},loadAPI:function(){var a,b=this,c=window.onYouTubeIframeAPIReady,d=\"//www.youtube.com/iframe_api\",e=document.getElementsByTagName(\"script\"),f=e.length;for(window.onYouTubeIframeAPIReady=function(){c&&c.apply(this),b.playOnReady&&b.play()};f;)if(f-=1,e[f].src===d)return;a=document.createElement(\"script\"),a.src=d,e[0].parentNode.insertBefore(a,e[0])},onReady:function(){this.ready=!0,this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){b.prototype.setTimeout.call(this,this.checkSeek,null,2e3)},checkSeek:function(){(this.stateChange===YT.PlayerState.PAUSED||this.stateChange===YT.PlayerState.ENDED)&&(this.listeners.pause(),delete this.playStatus)},onStateChange:function(a){switch(a.data){case YT.PlayerState.PLAYING:this.hasPlayed=!0,this.onPlaying();break;case YT.PlayerState.PAUSED:case YT.PlayerState.ENDED:this.onPause()}this.stateChange=a.data},onError:function(a){this.listeners.error(a)},play:function(){var a=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.playVideo():(this.playOnReady=!0,window.YT&&YT.Player?this.player||(this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){a.onReady()},onStateChange:function(b){a.onStateChange(b)},onError:function(b){a.onError(b)}}})):this.loadAPI())},pause:function(){this.ready?this.player.pauseVideo():this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),a.extend(b.prototype,{YouTubePlayer:d,textFactory:function(a,b){var e=this.options,f=this.getItemProperty(a,e.youTubeVideoIdProperty);return f?(void 0===this.getItemProperty(a,e.urlProperty)&&(a[e.urlProperty]=\"//www.youtube.com/watch?v=\"+f),void 0===this.getItemProperty(a,e.videoPosterProperty)&&(a[e.videoPosterProperty]=\"//img.youtube.com/vi/\"+f+\"/maxresdefault.jpg\"),this.videoFactory(a,b,new d(f,e.youTubePlayerVars,e.youTubeClickToPlay))):c.call(this,a,b)}}),b});\n\n    // Default options for the lightbox\n    var options = {\n      'gallery_relation_attr':  'rel',\n      'gallery_container':      $('#blueimp-gallery'),\n      'image_selector':         'a[href$=\".jpg\"], a[href$=\".jpeg\"], a[href$=\".png\"], a[href$=\".gif\"], a[href$=\".bmp\"], a[href$=\".wbmp\"], .image-lightbox',\n      'titleElement':           '.title',\n      'continuous':             FANCYGALLERY.continuous == 'on', // Allow continuous navigation, moving from last to first and from first to last slide\n      'slideshowInterval':      parseFloat(FANCYGALLERY.slideshow_speed), // Delay in milliseconds between slides for the automatic slideshow\n      'preloadRange':           parseFloat(FANCYGALLERY.preload_images), // The number of elements to load around the current index\n      'transitionSpeed':        parseFloat(FANCYGALLERY.animation_speed), // The transition speed between slide changes in milliseconds\n      'stretchImages':          FANCYGALLERY.stretch_images, // Defines if images should be stretched to fill the available space. Values: \"cover\", \"contain\", false\n      'onopen':                 function(){ $('html').css('overflow', 'hidden') },\n      'onclosed':               function(){ $('html').css('overflow', 'auto')   }\n    };\n\n    // Associate the links with the lightbox\n    $('body').on('click', options.image_selector, function(event){\n      event.preventDefault();\n\n      var\n        $container = options.gallery_container,\n        $link = $(this),\n        gallery_relation = $link.attr(options.gallery_relation_attr),\n        $gallery = [],\n        $gallery_wrapper = $link.parents('.gallery.fancy-gallery:first'),\n        $content_wrapper = $link.parents('.fancy-gallery-content-unit:first');\n\n      // If the relation attribute is empty we need to remove it from all other link tags which have empty relation attributes\n      if (!gallery_relation){\n        $(options.image_selector)\n          .filter(function(){ return !$(this).attr(options.gallery_relation_attr); })\n          .removeAttr(options.gallery_relation_attr);\n      }\n\n      // Find other link images which belongs to this one\n      if (gallery_relation)\n        $gallery = $('a[' + options.gallery_relation_attr + '=\"' + gallery_relation + '\"]');\n      else if ($gallery_wrapper.length > 0)\n        $gallery = $gallery_wrapper.find(options.image_selector);\n      else if ($content_wrapper.length > 0)\n        $gallery = $content_wrapper.find(options.image_selector).not('a[' + options.gallery_relation_attr + '], .gallery.fancy-gallery a');\n      else\n        $gallery = $(options.image_selector).not('.fancy-gallery-content-unit a, a[' + options.gallery_relation_attr + '], .gallery.fancy-gallery a');\n\n      // Set link index and event\n      $.extend(options, {\n        'index': $gallery.index( $link ),\n        'event': event\n      });\n\n      // Enabled descriptions\n      options.onslide = function(index, slide){\n        $(this.container).find('.description').empty().html( this.list[index].description );\n      };\n\n      // Prepare the gallery set of image links\n      $gallery.each(function(index, gallery_item){\n        var\n          $gallery_item = $(gallery_item),\n          href = $gallery_item.attr('href'),\n          thumbnail = $gallery_item.find('img:first').attr('src') || href,\n          title = $gallery_item.attr('title') || $gallery_item.find('img:first').attr('title'),\n          description = $gallery_item.data('description') /* || $gallery_item.data('caption') || $gallery_item.siblings('figcaption:first').text() */ ;\n\n        // modify the gallery set\n        $gallery[index] = {\n          'title':        title,\n          'description':  description,\n          'href':         href,\n          'thumbnail':    thumbnail\n        };\n      });\n\n      // Start the lightbox\n      new blueimp.Gallery($gallery, options);\n    });\n  }\n\n})(jQuery);", "<?php\nNamespace WordPress\\Plugin\\Fancy_Gallery;\n\nclass Options {\n  private\n    $arr_option_box, # Meta boxes for the option page\n    $core; # Pointer to the core object\n\n  public function __construct($core){\n    $this->core = $core;\n\n    # Option boxes\n    $this->arr_option_box = Array(\n      'main' => Array(),\n      'side' => Array()\n    );\n\n    Add_Action('admin_menu', Array($this, 'Add_Options_Page'));\n  }\n\n  private function t($text, $context = False){\n    return $this->core->t($text, $context);\n  }\n\n  public function Add_Options_Page(){\n    $handle = Add_Options_Page (\n      $this->t('Fancy Gallery Options'),\n      $this->t('Fancy Gallery'),\n      'manage_options',\n      __CLASS__,\n      Array($this, 'Print_Options_Page')\n    );\n\n    # Add JavaScript to this handle\n    Add_Action ('load-' . $handle, Array($this, 'Load_Options_Page'));\n\n    # Add option boxes\n    $this->Add_Option_Box($this->t('Lightbox'), DirName(__FILE__).'/options-page/lightbox.php');\n    $this->Add_Option_Box($this->t('Templates'), DirName(__FILE__).'/options-page/templates.php', 'main', 'closed');\n    $this->Add_Option_Box($this->t('User rights'), DirName(__FILE__).'/options-page/user-rights.php', 'main', 'closed');\n\n    $this->Add_Option_Box($this->t('Taxonomies'), DirName(__FILE__).'/options-page/taxonomies.php', 'side');\n    $this->Add_Option_Box($this->t('Gallery \"Excerpts\"'), DirName(__FILE__).'/options-page/excerpt.php', 'side');\n    $this->Add_Option_Box($this->t('Archive Url'), DirName(__FILE__).'/options-page/archive-link.php', 'side');\n  }\n\n  private function Get_Options_Page_Url($parameters = Array()){\n    $url = Add_Query_Arg(Array('page' => __CLASS__), Admin_Url('options-general.php'));\n    If (Is_Array($parameters) && !Empty($parameters)) $url = Add_Query_Arg($parameters, $url);\n    return $url;\n  }\n\n  public function Load_Options_Page(){\n    # Check if the user trys to delete a template\n    If (IsSet($_GET['delete']) && $this->core->Get_Template_Properties ($_GET['delete'])){ # You can only delete Fancy Gallery Templates!\n      Unlink($_GET['delete']);\n      WP_Redirect( $this->Get_Options_Page_Url(Array('template_deleted' => 'true')) );\n    }\n    ElseIf (IsSet($_GET['delete'])){\n      WP_Die($this->t('Error while deleting: ' . $_GET['delete']));\n    }\n\n    # If the Request was redirected from a \"Save Options\"-Post\n    If (IsSet($_REQUEST['options_saved'])) Flush_Rewrite_Rules();\n\n    # If this is a Post request to save the options\n    $options_saved = $this->Save_Options();\n    If ($options_saved)\n      WP_Redirect( $this->Get_Options_Page_Url(Array('options_saved' => 'true')) );\n\n    WP_Enqueue_Script('dashboard');\n    WP_Enqueue_Style('dashboard');\n\n    WP_Enqueue_Script('fancy-gallery-options-page', $this->core->base_url . '/options-page/options-page.js', Array('jquery'), $this->core->version, True);\n    WP_Enqueue_Style('fancy-gallery-options-page', $this->core->base_url . '/options-page/options-page.css' );\n\n    # Remove incompatible JS Libs\n    WP_Dequeue_Script('post');\n  }\n\n  public function Print_Options_Page(){\n    ?>\n    <div class=\"wrap\">\n      <h2><?php Echo $this->t('Fancy Gallery Settings') ?></h2>\n\n      <?php If (IsSet($_GET['options_saved'])) : ?>\n      <div id=\"message\" class=\"updated fade\">\n        <p><strong><?php _e('Settings saved.') ?></strong></p>\n      </div>\n      <?php EndIf; ?>\n\n      <?php If (IsSet($_GET['template_installed'])) : ?>\n      <div id=\"message\" class=\"updated fade\">\n        <p><strong><?php echo $this->t('Template installed.') ?></strong></p>\n      </div>\n      <?php EndIf; ?>\n\n      <?php If (IsSet($_GET['template_deleted'])) : ?>\n      <div id=\"message\" class=\"updated fade\">\n        <p><strong><?php echo $this->t('Template deleted.') ?></strong></p>\n      </div>\n      <?php EndIf; ?>\n\n      <form method=\"post\" action=\"\" enctype=\"multipart/form-data\">\n      <div class=\"metabox-holder\">\n\n        <div class=\"postbox-container\" style=\"width:69%;\">\n          <?php ForEach ($this->arr_option_box['main'] AS $box) : ?>\n            <div class=\"postbox should-be-<?php Echo $box['state'] ?>\">\n              <div class=\"handlediv\" title=\"<?php _e('Click to toggle') ?>\"><br /></div>\n              <h3 class=\"hndle\"><span><?php Echo $box['title'] ?></span></h3>\n              <div class=\"inside\"><?php Include $box['file'] ?></div>\n            </div>\n          <?php EndForEach ?>\n        </div>\n\n        <div class=\"postbox-container\" style=\"width:29%;float:right\">\n          <?php ForEach ($this->arr_option_box['side'] AS $box) : ?>\n            <div class=\"postbox should-be-<?php Echo $box['state'] ?>\">\n              <div class=\"handlediv\" title=\"<?php _e('Click to toggle') ?>\"><br /></div>\n              <h3 class=\"hndle\"><span><?php Echo $box['title'] ?></span></h3>\n              <div class=\"inside\"><?php Include $box['file'] ?></div>\n            </div>\n          <?php EndForEach ?>\n        </div>\n\n        <div class=\"clear\"></div>\n      </div>\n\n      <p class=\"submit\">\n        <input type=\"submit\" class=\"button-primary\" value=\"<?php _e('Save Changes') ?>\">\n      </p>\n\n      </form>\n    </div>\n    <?php\n  }\n\n  public function Add_Option_Box($title, $include_file, $column = 'main', $state = 'opened'){\n    # Check the input\n    If (!Is_File($include_file)) return False;\n    If ( $title == '' ) $title = '&nbsp;';\n\n    # Column (can be 'side' or 'main')\n    If ($column != '' && $column != Null && $column != 'main')\n      $column = 'side';\n    Else\n      $column = 'main';\n\n    # State (can be 'opened' or 'closed')\n    If ($state != '' && $state != Null && $state != 'opened')\n      $state = 'closed';\n    Else\n      $state = 'opened';\n\n    # Add a new box\n    $this->arr_option_box[$column][] = Array('title' => $title, 'file' => $include_file, 'state' => $state);\n  }\n\n  private function Save_Options(){\n    # Check if this is a post request\n    If (Empty($_POST)) return False;\n\n    # Add Capabilities\n    If (IsSet($_POST['capabilities']) && Is_Array($_POST['capabilities'])){\n      ForEach ($_POST['capabilities'] AS $role_name => $arr_role){\n        If (!$role = get_role($role_name)) Continue;\n        ForEach ((Array) $arr_role AS $capability => $yes_no){\n          If ($yes_no == 'yes')\n            $role->add_cap($capability);\n          Else\n            $role->remove_cap($capability);\n        }\n      }\n      Unset ($_POST['capabilities']);\n    }\n\n    # Clean the Post array\n    $_POST = StripSlashes_Deep($_POST);\n    ForEach ($_POST AS $option => $value)\n      If (!$value) Unset ($_POST[$option]);\n\n    # Save Options\n    Update_Option (__CLASS__, $_POST);\n    Delete_Option ('wp_plugin_fancy_gallery_pro');\n    Delete_Option ('wp_plugin_fancy_gallery');\n\n    # We delete the update cache\n    $this->core->Clear_Plugin_Update_Cache();\n\n    return True;\n  }\n\n  private function Default_Options(){\n    return Array(\n      'lightbox' => 'on',\n      'continuous' => 'off',\n      'title_description' => 'on',\n      'close_button' => 'on',\n      'indicator_thumbnails' => 'on',\n      'slideshow_speed' => 4000, # Slideshow speed in milliseconds\n      'preload_images' => 2,\n      'animation_speed' => 400,\n      'stretch_images' => False,\n\n      'gallery_taxonomy' => Array(),\n\n      'disable_excerpts' => False,\n      'excerpt_thumb_width' => Get_Option('thumbnail_size_w'),\n      'excerpt_thumb_height' => Get_Option('thumbnail_size_h'),\n      'excerpt_image_number' => 3,\n\n      'deactivate_archive' => False\n    );\n  }\n\n  public function Get($key = Null, $default = False){\n    # Read Options\n    $arr_option = Array_Merge (\n      (Array) $this->Default_Options(),\n      (Array) Get_Option('wp_plugin_fancy_gallery_pro'),\n      (Array) Get_Option('wp_plugin_fancy_gallery'),\n      (Array) Get_Option(__CLASS__)\n    );\n\n    # Locate the option\n    If ($key == Null)\n      return $arr_option;\n    ElseIf (IsSet($arr_option[$key]))\n      return $arr_option[$key];\n    Else\n      return $default;\n  }\n\n}", "<?php\n/*\nPlugin Name: Fancy Gallery Lite\nPlugin URI: http://dennishoppe.de/en/wordpress-plugins/fancy-gallery\nDescription: Fancy Gallery enables you to create and manage galleries and converts your galleries in post and pages to valid HTML5 blocks and associates linked images with a nice and responsive lightbox.\nVersion: 1.5.12\nAuthor: Dennis Hoppe\nAuthor URI: http://DennisHoppe.de\n*/\n\nIf (Version_Compare(PHP_VERSION, '5.3.0', '<')){\n\n  # Add PHP Version warning to the dashboard\n  Add_Action('admin_notices', 'Fancy_Gallery_PHP53_Version_Warning');\n  function Fancy_Gallery_PHP53_Version_Warning(){ ?>\n    <div class=\"error\">\n      <p><?php PrintF('<strong>%1$s:</strong> You need at least <strong>PHP 5.3</strong> or higher to use %1$s. You are using PHP %2$s. Please ask your hoster for an upgrade.', 'Fancy Gallery', PHP_VERSION) ?></p>\n    </div><?php\n  }\n\n}\nElse {\n\n  # Load core classes\n  Include DirName(__FILE__) . '/class.core.php';\n  Include DirName(__FILE__) . '/class.gallery-post-type.php';\n  Include DirName(__FILE__) . '/class.lightbox.php';\n  Include DirName(__FILE__) . '/class.i18n.php';\n  Include DirName(__FILE__) . '/class.mocking-bird.php';\n  Include DirName(__FILE__) . '/class.options.php';\n  Include DirName(__FILE__) . '/class.wpml.php';\n\n  # Load widgets\n  Include DirName(__FILE__) . '/widget.random-images.php';\n  Include DirName(__FILE__) . '/widget.taxonomies.php';\n  Include DirName(__FILE__) . '/widget.taxonomy-cloud.php';\n\n  # Inititalize Plugin: Would cause a synthax error in PHP < 5.3\n  Eval('New WordPress\\Plugin\\Fancy_Gallery\\Core(__FILE__);');\n\n}", "\ufeff=== Fancy Gallery ===\nContributors: dhoppe\nTags: gallery, galleries, image, images, picture, pictures, photo, photos, photo-album, photo-albums, fancybox, thickbox, lightbox, jquery, javascript, widget, cms, free, flickr\t\t\t\twidget,Post,plugin,admin,posts,sidebar,comments,google,images,page,image,links\nRequires at least: 3.6\nTested up to: 4.0\nStable tag: trunk\nDonate link: http://dennishoppe.de/en/wordpress-plugins/fancy-gallery\nLicense: GPLv2\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\n\nAwesome gallery management and touch-enabled, responsive, mobile-friendly image lightbox tool to manage and present image galleries within WordPress\n\n\n== Description ==\nFancy Gallery is *the* most innovative state of the art **WordPress Gallery Management tool** which enables you to **organize image galleries** easily in your WordPress backend. Furthermore this gallery plugin adds a beautiful awesome **javascript lightbox effect** (touch-enabled, responsive, optimized for both mobile and desktop web browsers) to all links pointing to an image anywhere on your website. This includes images in your posts, galleries, pages, sidebar widgets and anywhere else on your website.\n\n= Lightbox behavior =\nAll links - regardless if text or image - pointing to an image will automatically opened in a **responsive lightbox**. You do not need to care about any tag attributes or link classes \u2013 the plugins thinks about that for you. When using the [gallery] shortcode the images will get a **\"previous\", \"next\" and a slideshow button**. The gallery itself will be converted to a **valid HTML5 section** - even if your theme does not support HTML5 galleries yet.\n\n> #### Kick-Start\n> Read the feature lists below or [take an eye on the screenshots](https://wordpress.org/plugins/fancy-gallery/screenshots/)!\n\n= Gallery management features =\n* Organize image galleries separated from posts or pages\n* **Centralized gallery management**. Enjoy a single location where you can see and manage all your galleries\n* Automatically generated **index page with all galleries**\n* Every gallery has its own page with unique URL\n* Taxonomies to classify your galleries: **Categories, Tags, Events, Places, Dates, Persons, Photographers**.\u00b9 (Need more? Ask us!)\n* Both tags and categories are disjunct from your post tags and post categories\n* Supports gallery **comments**\u00b2\n* Supports **featured images** as gallery thumbnails\u00b2\n* Supports **excerpts** for your uploaded galleries (the same way you already know from regular posts)\n* Excerpts can contain text description and a random set of preview images\n* Supports WordPress **user rights** and capabilities\u00b9\n* Supports the **WordPress menus** and enables you to add all components of your galleries to any menu\n* **Import and export** directly via the official \"[WordPress Importer](https://wordpress.org/plugins/wordpress-importer/)\" by Automattic Inc.\n\n= Lightbox features =\n* Javascript lightbox support for **all linked images** on your website\n* Has \"Previous\" and \"Next\" buttons\n* Shows image title and description\n* Lightbox is **touch-enabled, responsive and mobile-friendly**\n* Supports **Swipe function** for touch screens \u2013 works with every smart phone and tablet\n* Awesome image **slideshow** function\n* **Indicator thumbnail images** below the full size image\n* Uses the **full screen** size for presenting your image\n\n= General features =\n* **SEO conform** URL structure for all kind of pages\n* Supports **WPML** flawless\n* Supports the WordPress theme template hierarchy and the parent-child-theme paradigm\n* Supports **user defined HTML templates**\n* Supports **RSS feeds** for the gallery index and for the comments of each gallery\n* Custom **thumbnail sizes** and **color effects**\u00b9\n* **Fully compatible** with all existing themes with archive template\n* Template engine to display your galleries in different styles\n* Widget to display random images from your galleries in the sidebar\u00b9\n* Widget to display the gallery taxonomies as list or cloud in the sidebar\u00b9\n* Converts all galleries in **valid HTML5 blocks**\n* **Completely translatable** - .pot file is included\n* Includes a **bunch of filters** to give you the control of the behavior of this piece of code\n* **Clean and intuitive** user interface\n* Works great with **WordPress Multisite**\n* Personal **one-on-one real-time support** by the developer\u00b9\n* No ads or branding anywhere - perfect white label solution\u00b9\n\n\u00b9 Available in [Fancy Gallery Pro](http://dennishoppe.de/en/wordpress-plugins/fancy-gallery).<br>\n\u00b2 Your theme needs to support this too.\n\n= Gallery shortcode =\nOf course you can use \"exclude\" and \"include\" parameters in your [gallery] shortcode like you already know from the traditional gallery code.\n\n= Settings =\nYou can find the settings page in your Dashboard -> Settings -> Fancy Gallery.\n\n= Gallery Templates =\nTo create your own gallery template you only need elementary HTML and PHP knowledge. Just start by creating a new HTML file with the following example header with the template details.\n\n<code>\n/*\nFancy Gallery Template: Template Name\nDescription: Your template description here.\nVersion: 1.0\nAuthor: John Doe\nAuthor URI: http://example.com\n*/\n</code>\n\nYou can place the template in these folders:\n\n1. If it is for your own website put it in /wp-content/fancy-gallery-templates.\n1. If you are a theme author just put in your theme (max one level deep).\n1. If you are a plugin developer use the \"fancy_gallery_template_files\" to add template files from anywhere.\n1. Absolutely not recommended: in the \"templates/\" folder of the plugin itself.\n\n\n= Questions and support requests =\nPlease use the support forum on WordPress.org only for this free lite version of the plugin. For the pro version there is a separate support package available. *Please do not use the WordPress.org support forum for questions about the pro version* or questions about my services! Of course you can hire me for consulting, support, programming and customizations at any time.\n\n\n= Language =\n* This Plugin is available in English.\n* Diese Erweiterung ist in Deutsch verf\u00fcgbar. ([Ulrike Seddig](http://UlrikeSeddig.de/))\n* Plugin disponible en Espa\u00f1ol. ([Guillermo Gozalbes](http://www.versus.es/))\n* Este plugin est\u00e1 dispon\u00edvel em portugu\u00eas - Brasil. (Ramiro Modica)\n* Ce plugin est disponible en fran\u00e7ais. (Thomas Schlesser)\n\n\n= Translate this plugin =\nIf you have translated this plugin in your language feel free to send us the language file (.po file) via E-Mail with your name and this translated sentence: \"This plug-in is available in %YOUR_LANGUAGE_NAME%.\" We will add it to the plug-in.\n\nYou can find the *Translation.pot* file in the *language/* folder in the plugin directory.\n\n* Copy it.\n* Rename it (to your language code).\n* Translate everything.\n* Send it via E-Mail to &lt;Mail [@t] [DennisHoppe](http://DennisHoppe.de) [dot] de&gt;.\n* Thats it. Thank you! =)\n\n= Limitations of the lite version =\nThere are no real limitations in this version except the number of galleries you can organize within the gallery management tool. The maximal number of galleries is limited to three but of course you can use the traditional galleries in your posts and pages *without* any limitations!\n\n\n== Installation ==\n\n= Minimum Requirements =\n\n* WordPress 3.6 or greater\n* PHP version 5.3 or greater\n* MySQL version 5.0 or greater\n\n= Automatic installation =\n\nAutomatic installation is the easiest option as WordPress handles the file transfers itself and you do not need to leave your web browser. To do an automatic install of Fancy Gallery, log in to your WordPress dashboard, navigate to the plugins menu and click \"Add New\".\n\nIn the search field type \"Fancy Gallery\" and click \"Search plugins\". Once you have found my gallery plugin you can view details about it such as the point release, rating and description. Most importantly of course, you can install it by simply clicking \"Install Now\".\n\n= Manual installation =\n\nThe manual installation method involves downloading my gallery plugin and uploading it to your web server via your favorite FTP application. The WordPress codex contains [instructions on how to do this here](http://codex.wordpress.org/Managing_Plugins#Manual_Plugin_Installation).\n\n= Updating =\n\nAutomatic updates should work like a charm; as always though, ensure you backup your site just in case.\n\n\n== Screenshots ==\n01. Gallery single view\n02. Gallery lightbox\n03. Add a new gallery\n04. Manage gallery categories\n05. Edit a category\n06. Edit an image\n07. Integrate your galleries to your navigation menus\n08. Change details of several images\n09. The lightbox settings\n\n== Upgrade Notice ==\nIf you update the plugin from version 1.4.x or lower to version 1.5.x or higher please reactivate the plugin after the update and re-save your options through clicking the \"Save changes\" button at the end of the options page.\n\n\n== Other Notes ==\n\nFancy Gallery is available as [premium plugin](http://dennishoppe.de/en/wordpress-plugins/fancy-gallery) too. In the premium version you can use all options and features which are restricted in the lite version.\n\nPossibly even more important, buying the premium edition gives you access to me and my support team. You can email us your questions about usage of the plugin or your problems in setting it up and we will assist you in no time!\n\n\n== Changelog ==\n\n= 1.5.12 =\n* Removed the Install_Template() function\n\n= 1.5.11 =\n* Fixed warning in library import tab\n* Fixed stylesheet in library import tab\n\n= 1.5.10 =\n* Fixed warning in library import tab\n* Fixed warning in featured image meta box\n* Set background color for images meta box to white\n\n= 1.5.9 =\n* Added warning if PHP version is lower than 5.3\n\n= 1.5.8 =\n* Added WPML Workaround for translated post type slugs\n\n= 1.5.7.1 =\n* Added padding style attribute to collage template\n\n= 1.5.7 =\n* Fixed: Undefined post object in the save meta box function\n\n= 1.5.6.1 =\n* Fixed: Made meta box hover texts translatable\n\n= 1.5.6 =\n* Fixed: Gallery items can contain images from other posts.\n\n= 1.5.5 =\n* Added: Classify images within the same post content\n\n= 1.5.4 =\n* Fixed: input name of the meta box fields do not contain backslashes anymore\n* Change: Does not use the image caption as description anymore if the description is not set\n* Patched: permalink for taxonomies were rewritten on plugin activation\n\n= 1.5.3 =\n* Patched HTML5-gallery style sheet to work with older themes\n* Patched Collage gallery template\n* Fixed German translation strings\n\n= 1.5.2 =\n* Removed deprecated jQuery \"live\" function call\n\n= 1.5 =\n* Replaced lightbox with a new responsive one\n* Replaced admin menu icon\n* Completely re-factored PHP code\n\n= 1.4.4 =\n* Fixed the edit image section\n* Made the lightbox library optional\n\n= 1.4.3 =\n* The plugin loads the stylesheets asynchronous now\n\n= 1.4.2 =\n* Added /wp-content/fancy-gallery-templates to the list of template include paths\n\n= 1.4.1 =\n* Updated jQuery Mousewheel to 1.3.11\n* Updated jQuery Livequery to 1.3.6\n* Fixed PHP notice on import tab for images without parent\n\n= 1.4 =\n* Merged jQuery Lightbox repository from 1.3.1 to 1.3.35\n\n= 1.3 =\n* Updated the whole backend and added more valuable features to the lite version\n\n= 1.2.8 =\n* Fixed Warnings on options page\n\n= 1.2.6 =\n* Moved the Register Widget function to the plugin itself\n\n= 1.2.5 =\n* Fixed: gallery shortcode without attributes shows the images of the current post now\n\n= 1.2.4 =\n* Fixed the responsive design of the edit-screen\n\n= 1.2.3 =\n* Patched the Fancy-Fancy template\n\n= 1.2.2 =\n* Made the FancyBox 1.3.4 the default lightbox\n* Changed the structure so you can easily add more other lightboxes\n\n= 1.2.1 =\n* Patched the options page / meta boxes with the old options\n\n= 1.2 =\n* Complete roll back to FancyBox 1.3.4\n* Optional FancyBox 2.x from external CDN\n\n= 1.1.7 =\n* Updated Fancybox JS library to the latest Git Hub state\n* Added Adminbar fix for top control buttons of the lightbox\n\n= 1.1.6 =\n* Updated Fancybox to version 2.1.5:\n* Fixed: Broken slideshow\n* Fixed: Parent option\n* Retina graphics and retina display support\n* Improved \"lock\" feature\n\n= 1.1.5 =\n* Made options page responsive\n\n= 1.1.4 =\n* Added French translation.\n* Merged all styles via SASS to fancybox.css\n* Patched z-index bug for Twenty Eleven theme\n* Patched default template styles\n* Improved Gallery generate code and parameters\n\n= 1.1.3 =\n* Fixed \"Image Order\" problem in manually created galleries.\n\n= 1.1.2 =\n* Improved the \"Import to gallery\" tab\n* removed some deprecated files\n* Fixed image size bug in Thumbnails-Share-Button template\n\n= 1.1.1 =\n* Added overflow style to gallery wrappers\n\n= 1.1 =\n* Fancybox updated, completely rewritten JS\n\n= 1.0.29 =\n* removed clear element from \"Thumbnails only\" template\n\n= 1.0.28 =\n* removed clear element from default template\n\n= 1.0.27 =\n* Fixed Strip_Tags bug in share-button-template\n\n= 1.0.26 =\n* Reordered Template files\n* New Template with share buttons inside the image title\n\n= 1.0.25 =\n* Changed the right image margin of the default gallery template\n* Converted the shortcode in the gallery backend from a <code> element to an <input> field\n\n= 1.0.24 =\n* Made taxonomy slugs translatable.\n\n= 1.0.23 =\n* Added a management column for each taxonomy to the gallery management page\n\n= 1.0.22 =\n* Added some CSS to the default template\n\n= 1.0.21 =\n* Removed column field from the gallery editor\n* Added support for \"orderby\" field in manually created galleries\n\n= 1.0.20 =\n* Added html trim function\n\n= 1.0.19 =\n* Splitted templates in Code and Style\n* improved template output cleaning\n\n= 1.0.18 =\n* Allow URL Slug translation via WPML now\n\n= 1.0.17 =\n* Added WP 3.5 support\n\n= 1.0.16 =\n* Fixed the (Widget) translation bug\n\n= 1.0.15 =\n* Eliminated Backslashes in generated URLs (should work with Windows now)\n\n= 1.0.14 =\n* Changed z-index values for all fancy objects\n* renamed library and stylesheet files\n* fixed IE6/7/8 Bugs\n\n= 1.0.13 =\n* Changed fade-in time of the overlay\n* fixed an IE bug which let the fancy box pop on non-image links\n\n= 1.0.12 =\n* Added Brazilian-Portuguese translation\n\n= 1.0.11 =\n* Updated mouse wheel library\n\n= 1.0 =\n* Everything works fine.\n", "<?php\nNamespace WordPress\\Plugin\\Fancy_Gallery\\Widget;\n\nclass Taxonomies Extends \\WP_Widget {\n  var $core; #  Pointer to the core class\n\n  function __construct(){\n    $this->core = $GLOBALS['WordPress\\Plugin\\Fancy_Gallery\\Core'];\n\n    # Setup the Widget data\n    parent::__construct (\n      'fancy-gallery-taxonomies',\n      $this->t('Gallery taxonomies'),\n      Array('description' => $this->t('Displays your gallery taxonomies like categories, tags, events, photographers, etc.'))\n    );\n  }\n\n  function t ($text, $context = False){\n    return $this->core->t($text, $context);\n  }\n\n  function Default_Options(){\n    # Default settings\n    return Array(\n      'show_count' => False,\n      'number'     => Null,\n      'orderby'    => 'name',\n      'order'      => 'ASC',\n      'exclude'    => False\n    );\n  }\n\n  function Load_Options($options){\n    $options = (Array) $options;\n\n    # Delete empty values\n    ForEach ($options AS $key => $value)\n      If (!$value) Unset($options[$key]);\n\n    # Load options\n    $this->arr_option = Array_Merge ($this->Default_Options(), $options);\n  }\n\n  function Get_Option($key, $default = False){\n    If (IsSet($this->arr_option[$key]) && $this->arr_option[$key])\n      return $this->arr_option[$key];\n    Else\n      return $default;\n  }\n\n  function Set_Option($key, $value){\n    $this->arr_option[$key] = $value;\n  }\n\n  function Form ($settings){\n    # Load options\n    $this->load_options ($settings); Unset ($settings);\n    ?>\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('title') ?>\"><?php _e('Title:') ?></label>\n      <input type=\"text\" id=\"<?php Echo $this->Get_Field_Id('title') ?>\" name=\"<?php Echo $this->Get_Field_Name('title')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('title')) ?>\" class=\"widefat\">\n      <small><?php Echo $this->t('Leave blank to use the widget default title.') ?></small>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\"><?php Echo $this->t('Taxonomy:') ?></label>\n      <select id=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\" name=\"<?php Echo $this->Get_Field_Name('taxonomy') ?>\" class=\"widefat\">\n      <?php ForEach(Get_Object_Taxonomies($this->core->gallery_post_type->name) AS $taxonomy) : $taxonomy = Get_Taxonomy($taxonomy) ?>\n      <option value=\"<?php Echo $taxonomy->name ?>\" <?php Selected($this->get_option('taxonomy'), $taxonomy->name) ?>><?php Echo HTMLSpecialChars($taxonomy->labels->name) ?></option>\n      <?php EndForEach ?>\n      </select><br>\n      <small><?php Echo $this->t('Please choose the Taxonomy the widget should display.') ?></small>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('number') ?>\"><?php Echo $this->t('Number of terms:') ?></label>\n      <input type=\"number\" id=\"<?php Echo $this->Get_Field_Id('number') ?>\" name=\"<?php Echo $this->Get_Field_Name('number')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('number')) ?>\"><br>\n      <small><?php Echo $this->t('Leave blank to show all.') ?></small>\n    </p>\n\n    <p>\n      <label for=\"<?php echo $this->Get_Field_Id('exclude') ?>\"><?php _e('Exclude:') ?></label>\n      <input type=\"text\" value=\"<?php Echo Esc_Attr($this->Get_Option('exclude')) ?>\" name=\"<?php Echo $this->Get_Field_Name('exclude') ?>\" id=\"<?php Echo $this->Get_Field_Id('exclude') ?>\" class=\"widefat\">\n      <small><?php Echo $this->t('Term IDs, separated by commas.') ?></small>\n    </p>\n\n    <p>\n      <input type=\"checkbox\" id=\"<?php Echo $this->Get_Field_Id('count') ?>\" name=\"<?php Echo $this->Get_Field_Name('count') ?>\" <?php Checked($this->Get_Option('count')) ?> >\n      <label for=\"<?php echo $this->Get_Field_Id('count') ?>\"><?php Echo $this->t( 'Show Gallery counts.' ) ?></label>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('orderby') ?>\"><?php Echo $this->t('Order by:') ?></label>\n      <select id=\"<?php Echo $this->Get_Field_Id('orderby') ?>\" name=\"<?php Echo $this->Get_Field_Name('orderby') ?>\" class=\"widefat\">\n      <option value=\"name\" <?php Selected($this->Get_Option('orderby'), 'name') ?>><?php _e('Name') ?></option>\n      <option value=\"count\" <?php Selected($this->Get_Option('orderby'), 'count') ?>><?php Echo $this->t('Gallery Count') ?></option>\n      <option value=\"ID\" <?php Selected($this->Get_Option('orderby'), 'ID') ?>>ID</option>\n      <option value=\"slug\" <?php Selected($this->Get_Option('orderby'), 'slug') ?>><?php Echo $this->t('Slug') ?></option>\n      </select>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('order') ?>\"><?php Echo $this->t('Order:') ?></label>\n      <select id=\"<?php Echo $this->Get_Field_Id('order') ?>\" name=\"<?php Echo $this->Get_Field_Name('order') ?>\" class=\"widefat\">\n      <option value=\"ASC\" <?php Selected($this->Get_Option('order'), 'ASC') ?>><?php _e('Ascending') ?></option>\n      <option value=\"DESC\" <?php Selected($this->Get_Option('order'), 'DESC') ?>><?php _e('Descending') ?></option>\n      </select>\n    </p>\n\n    <?php\n  }\n\n  function Widget ($args, $settings){\n    # Load options\n    $this->Load_Options ($settings); Unset ($settings);\n\n    # Check if the Taxonomy is alive\n    If (!Taxonomy_Exists($this->Get_Option('taxonomy'))) return False;\n\n    # Display Widget\n    Echo $args['before_widget'];\n\n    Echo $args['before_title'] . Apply_Filters('widget_title', $this->Get_Option('title'), $settings, $this->id_base) . $args['after_title'];\n\n    Echo '<ul>';\n    WP_List_Categories(Array(\n      'taxonomy'   => $this->Get_Option('taxonomy'),\n      'show_count' => $this->Get_Option('count'),\n      'number'     => $this->Get_Option('number'),\n      'order'      => $this->Get_Option('order'),\n      'orderby'    => $this->Get_Option('orderby'),\n      'exclude'    => $this->Get_Option('exclude'),\n      'title_li'   => ''\n    ));\n    Echo '</ul>';\n\n    Echo $args['after_widget'];\n  }\n\n  function Update ($new_settings, $old_settings){\n    return $new_settings;\n  }\n\n}", "<?php\r\nNamespace WordPress\\Plugin\\Fancy_Gallery\\Widget;\r\n\r\nclass Taxonomy_Cloud Extends \\WP_Widget {\r\n  var $core; #  Pointer to the core class\r\n\r\n  function __construct(){\r\n    $this->core = $GLOBALS['WordPress\\Plugin\\Fancy_Gallery\\Core'];\r\n\r\n    # Setup the Widget data\r\n    parent::__construct (\r\n      'fancy-gallery-taxonomy-cloud',\r\n      $this->t('Gallery taxonomy cloud'),\r\n      Array('description' => $this->t('Displays your gallery taxonomies as tag cloud.'))\r\n    );\r\n  }\r\n\r\n  function t ($text, $context = False){\r\n    return $this->core->t($text, $context);\r\n  }\r\n\r\n  function Default_Options(){\r\n    # Default settings\r\n    return Array(\r\n      'show_count' => False,\r\n      'number'     => 0,\r\n      'orderby'    => 'name',\r\n      'order'      => 'RAND',\r\n      'exclude'    => False\r\n    );\r\n  }\r\n\r\n  function Load_Options($options){\r\n    $options = (Array) $options;\r\n\r\n    # Delete empty values\r\n    ForEach ($options AS $key => $value)\r\n      If (!$value) Unset($options[$key]);\r\n\r\n    # Load options\r\n    $this->arr_option = Array_Merge ($this->Default_Options(), $options);\r\n  }\r\n\r\n  function Get_Option($key, $default = False){\r\n    If (IsSet($this->arr_option[$key]) && $this->arr_option[$key])\r\n      return $this->arr_option[$key];\r\n    Else\r\n      return $default;\r\n  }\r\n\r\n  function Set_Option($key, $value){\r\n    $this->arr_option[$key] = $value;\r\n  }\r\n\r\n  function Form ($settings){\r\n    # Load options\r\n    $this->load_options ($settings); Unset ($settings);\r\n    ?>\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('title') ?>\"><?php _e('Title:') ?></label>\r\n      <input type=\"text\" id=\"<?php Echo $this->Get_Field_Id('title') ?>\" name=\"<?php Echo $this->Get_Field_Name('title')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('title')) ?>\" class=\"widefat\">\r\n      <small><?php Echo $this->t('Leave blank to use the widget default title.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\"><?php Echo $this->t('Taxonomy:') ?></label>\r\n      <select id=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\" name=\"<?php Echo $this->Get_Field_Name('taxonomy') ?>\" class=\"widefat\">\r\n      <?php ForEach(Get_Object_Taxonomies($this->core->gallery_post_type->name) AS $taxonomy) : $taxonomy = Get_Taxonomy($taxonomy) ?>\r\n      <option value=\"<?php Echo $taxonomy->name ?>\" <?php Selected($this->get_option('taxonomy'), $taxonomy->name) ?>><?php Echo HTMLSpecialChars($taxonomy->labels->name) ?></option>\r\n      <?php EndForEach ?>\r\n      </select><br>\r\n      <small><?php Echo $this->t('Please choose the Taxonomy the widget should display.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('number') ?>\"><?php Echo $this->t('Number of terms:') ?></label>\r\n      <input type=\"number\" id=\"<?php Echo $this->Get_Field_Id('number') ?>\" name=\"<?php Echo $this->Get_Field_Name('number')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('number')) ?>\"><br>\r\n      <small><?php Echo $this->t('Leave blank to show all.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php echo $this->Get_Field_Id('exclude') ?>\"><?php _e('Exclude:') ?></label>\r\n      <input type=\"text\" value=\"<?php Echo Esc_Attr($this->Get_Option('exclude')) ?>\" name=\"<?php Echo $this->Get_Field_Name('exclude') ?>\" id=\"<?php Echo $this->Get_Field_Id('exclude') ?>\" class=\"widefat\">\r\n      <small><?php Echo $this->t('Term IDs, separated by commas.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('orderby') ?>\"><?php Echo $this->t('Order by:') ?></label>\r\n      <select id=\"<?php Echo $this->Get_Field_Id('orderby') ?>\" name=\"<?php Echo $this->Get_Field_Name('orderby') ?>\" class=\"widefat\">\r\n      <option value=\"name\" <?php Selected($this->Get_Option('orderby'), 'name') ?>><?php _e('Name') ?></option>\r\n      <option value=\"count\" <?php Selected($this->Get_Option('orderby'), 'count') ?>><?php Echo $this->t('Gallery Count') ?></option>\r\n      <option value=\"ID\" <?php Selected($this->Get_Option('orderby'), 'ID') ?>>ID</option>\r\n      <option value=\"slug\" <?php Selected($this->Get_Option('orderby'), 'slug') ?>><?php Echo $this->t('Slug') ?></option>\r\n      </select>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('order') ?>\"><?php Echo $this->t('Order:') ?></label>\r\n      <select id=\"<?php Echo $this->Get_Field_Id('order') ?>\" name=\"<?php Echo $this->Get_Field_Name('order') ?>\" class=\"widefat\">\r\n      <option value=\"ASC\" <?php Selected($this->Get_Option('order'), 'ASC') ?>><?php _e('Ascending') ?></option>\r\n      <option value=\"DESC\" <?php Selected($this->Get_Option('order'), 'DESC') ?>><?php _e('Descending') ?></option>\r\n      </select>\r\n    </p>\r\n\r\n    <?php\r\n  }\r\n\r\n  function Widget ($args, $settings){\r\n    # Load options\r\n    $this->load_options ($settings); Unset ($settings);\r\n\r\n    # Check if the Taxonomy is alive\r\n    If (!Taxonomy_Exists($this->Get_Option('taxonomy'))) return False;\r\n\r\n    # Display Widget\r\n    Echo $args['before_widget'];\r\n\r\n    Echo $args['before_title'] . Apply_Filters('widget_title', $this->get_option('title'), $settings, $this->id_base) . $args['after_title'];\r\n\r\n    Echo '<ul>';\r\n    WP_Tag_Cloud(Array(\r\n      'taxonomy' => $this->Get_Option('taxonomy'),\r\n      'number'   => $this->Get_Option('number'),\r\n      'order'    => $this->Get_Option('order'),\r\n      'orderby'  => $this->Get_Option('orderby'),\r\n      'exclude'  => $this->Get_Option('exclude')\r\n    ));\r\n    Echo '</ul>';\r\n\r\n    Echo $args['after_widget'];\r\n  }\r\n\r\n  function Update ($new_settings, $old_settings){\r\n    return $new_settings;\r\n  }\r\n\r\n}"], "fixing_code": ["(function($){\n  'use strict';\n\n  // Render the template stylesheets\n  if(FANCYGALLERY.stylesheets){\n    var $head = $('head:first');\n    for(var index in FANCYGALLERY.stylesheets){\n      $('<link rel=\"stylesheet\" href=\"\" media=\"screen\">').attr('href', FANCYGALLERY.stylesheets[index]).appendTo($head);\n    }\n  }\n\n  /*\n  // group gallery items\n  $('div.fancy-gallery a').each(function(){\n    var $this = $(this);\n    $this.attr('rel', $this.parents('.fancy-gallery').attr('id'));\n  });\n  */\n\n  // Associate the links with the lightbox\n  if (FANCYGALLERY.lightbox == 'on'){\n    // Load lightbox library (blueimp Gallery JS 2.14.0)\n    !function(){\"use strict\";function a(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function b(a){if(!this||this.find!==b.prototype.find)return new b(a);if(this.length=0,a)if(\"string\"==typeof a&&(a=this.find(a)),a.nodeType||a===a.window)this.length=1,this[0]=a;else{var c=a.length;for(this.length=c;c;)c-=1,this[c]=a[c]}}b.extend=a,b.contains=function(a,b){do if(b=b.parentNode,b===a)return!0;while(b);return!1},b.parseJSON=function(a){return window.JSON&&JSON.parse(a)},a(b.prototype,{find:function(a){var c=this[0]||document;return\"string\"==typeof a&&(a=c.querySelectorAll?c.querySelectorAll(a):\"#\"===a.charAt(0)?c.getElementById(a.slice(1)):c.getElementsByTagName(a)),new b(a)},hasClass:function(a){return this[0]?new RegExp(\"(^|\\\\s+)\"+a+\"(\\\\s+|$)\").test(this[0].className):!1},addClass:function(a){for(var b,c=this.length;c;){if(c-=1,b=this[c],!b.className)return b.className=a,this;if(this.hasClass(a))return this;b.className+=\" \"+a}return this},removeClass:function(a){for(var b,c=new RegExp(\"(^|\\\\s+)\"+a+\"(\\\\s+|$)\"),d=this.length;d;)d-=1,b=this[d],b.className=b.className.replace(c,\" \");return this},on:function(a,b){for(var c,d,e=a.split(/\\s+/);e.length;)for(a=e.shift(),c=this.length;c;)c-=1,d=this[c],d.addEventListener?d.addEventListener(a,b,!1):d.attachEvent&&d.attachEvent(\"on\"+a,b);return this},off:function(a,b){for(var c,d,e=a.split(/\\s+/);e.length;)for(a=e.shift(),c=this.length;c;)c-=1,d=this[c],d.removeEventListener?d.removeEventListener(a,b,!1):d.detachEvent&&d.detachEvent(\"on\"+a,b);return this},empty:function(){for(var a,b=this.length;b;)for(b-=1,a=this[b];a.hasChildNodes();)a.removeChild(a.lastChild);return this},first:function(){return new b(this[0])}}),\"function\"==typeof define&&define.amd?define(function(){return b}):(window.blueimp=window.blueimp||{},window.blueimp.helper=b)}(),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\"],a):(window.blueimp=window.blueimp||{},window.blueimp.Gallery=a(window.blueimp.helper||window.jQuery))}(function(a){\"use strict\";function b(a,c){return void 0===document.body.style.maxHeight?null:this&&this.options===b.prototype.options?a&&a.length?(this.list=a,this.num=a.length,this.initOptions(c),void this.initialize()):void this.console.log(\"blueimp Gallery: No or empty list provided as first argument.\",a):new b(a,c)}return a.extend(b.prototype,{options:{container:\"#blueimp-gallery\",slidesContainer:\"div\",titleElement:\"h3\",displayClass:\"blueimp-gallery-display\",controlsClass:\"blueimp-gallery-controls\",singleClass:\"blueimp-gallery-single\",leftEdgeClass:\"blueimp-gallery-left\",rightEdgeClass:\"blueimp-gallery-right\",playingClass:\"blueimp-gallery-playing\",slideClass:\"slide\",slideLoadingClass:\"slide-loading\",slideErrorClass:\"slide-error\",slideContentClass:\"slide-content\",toggleClass:\"toggle\",prevClass:\"prev\",nextClass:\"next\",closeClass:\"close\",playPauseClass:\"play-pause\",typeProperty:\"type\",titleProperty:\"title\",urlProperty:\"href\",displayTransition:!0,clearSlides:!0,stretchImages:!1,toggleControlsOnReturn:!0,toggleSlideshowOnSpace:!0,enableKeyboardNavigation:!0,closeOnEscape:!0,closeOnSlideClick:!0,closeOnSwipeUpOrDown:!0,emulateTouchEvents:!0,stopTouchEventsPropagation:!1,hidePageScrollbars:!0,disableScroll:!0,carousel:!1,continuous:!0,unloadElements:!0,startSlideshow:!1,slideshowInterval:5e3,index:0,preloadRange:2,transitionSpeed:400,slideshowTransitionSpeed:void 0,event:void 0,onopen:void 0,onopened:void 0,onslide:void 0,onslideend:void 0,onslidecomplete:void 0,onclose:void 0,onclosed:void 0},carouselOptions:{hidePageScrollbars:!1,toggleControlsOnReturn:!1,toggleSlideshowOnSpace:!1,enableKeyboardNavigation:!1,closeOnEscape:!1,closeOnSlideClick:!1,closeOnSwipeUpOrDown:!1,disableScroll:!1,startSlideshow:!0},console:window.console&&\"function\"==typeof window.console.log?window.console:{log:function(){}},support:function(b){var c={touch:void 0!==window.ontouchstart||window.DocumentTouch&&document instanceof DocumentTouch},d={webkitTransition:{end:\"webkitTransitionEnd\",prefix:\"-webkit-\"},MozTransition:{end:\"transitionend\",prefix:\"-moz-\"},OTransition:{end:\"otransitionend\",prefix:\"-o-\"},transition:{end:\"transitionend\",prefix:\"\"}},e=function(){var a,d,e=c.transition;document.body.appendChild(b),e&&(a=e.name.slice(0,-9)+\"ransform\",void 0!==b.style[a]&&(b.style[a]=\"translateZ(0)\",d=window.getComputedStyle(b).getPropertyValue(e.prefix+\"transform\"),c.transform={prefix:e.prefix,name:a,translate:!0,translateZ:!!d&&\"none\"!==d})),void 0!==b.style.backgroundSize&&(c.backgroundSize={},b.style.backgroundSize=\"contain\",c.backgroundSize.contain=\"contain\"===window.getComputedStyle(b).getPropertyValue(\"background-size\"),b.style.backgroundSize=\"cover\",c.backgroundSize.cover=\"cover\"===window.getComputedStyle(b).getPropertyValue(\"background-size\")),document.body.removeChild(b)};return function(a,c){var d;for(d in c)if(c.hasOwnProperty(d)&&void 0!==b.style[d]){a.transition=c[d],a.transition.name=d;break}}(c,d),document.body?e():a(document).on(\"DOMContentLoaded\",e),c}(document.createElement(\"div\")),requestAnimationFrame:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,initialize:function(){return this.initStartIndex(),this.initWidget()===!1?!1:(this.initEventListeners(),this.onslide(this.index),this.ontransitionend(),void(this.options.startSlideshow&&this.play()))},slide:function(a,b){window.clearTimeout(this.timeout);var c,d,e,f=this.index;if(f!==a&&1!==this.num){if(b||(b=this.options.transitionSpeed),this.support.transition){for(this.options.continuous||(a=this.circle(a)),c=Math.abs(f-a)/(f-a),this.options.continuous&&(d=c,c=-this.positions[this.circle(a)]/this.slideWidth,c!==d&&(a=-c*this.num+a)),e=Math.abs(f-a)-1;e;)e-=1,this.move(this.circle((a>f?a:f)-e-1),this.slideWidth*c,0);a=this.circle(a),this.move(f,this.slideWidth*c,b),this.move(a,0,b),this.options.continuous&&this.move(this.circle(a-c),-(this.slideWidth*c),0)}else a=this.circle(a),this.animate(f*-this.slideWidth,a*-this.slideWidth,b);this.onslide(a)}},getIndex:function(){return this.index},getNumber:function(){return this.num},prev:function(){(this.options.continuous||this.index)&&this.slide(this.index-1)},next:function(){(this.options.continuous||this.index<this.num-1)&&this.slide(this.index+1)},play:function(a){var b=this;window.clearTimeout(this.timeout),this.interval=a||this.options.slideshowInterval,this.elements[this.index]>1&&(this.timeout=this.setTimeout(!this.requestAnimationFrame&&this.slide||function(a,c){b.animationFrameId=b.requestAnimationFrame.call(window,function(){b.slide(a,c)})},[this.index+1,this.options.slideshowTransitionSpeed],this.interval)),this.container.addClass(this.options.playingClass)},pause:function(){window.clearTimeout(this.timeout),this.interval=null,this.container.removeClass(this.options.playingClass)},add:function(a){var b;for(a.concat||(a=Array.prototype.slice.call(a)),this.list.concat||(this.list=Array.prototype.slice.call(this.list)),this.list=this.list.concat(a),this.num=this.list.length,this.num>2&&null===this.options.continuous&&(this.options.continuous=!0,this.container.removeClass(this.options.leftEdgeClass)),this.container.removeClass(this.options.rightEdgeClass).removeClass(this.options.singleClass),b=this.num-a.length;b<this.num;b+=1)this.addSlide(b),this.positionSlide(b);this.positions.length=this.num,this.initSlides(!0)},resetSlides:function(){this.slidesContainer.empty(),this.slides=[]},handleClose:function(){var a=this.options;this.destroyEventListeners(),this.pause(),this.container[0].style.display=\"none\",this.container.removeClass(a.displayClass).removeClass(a.singleClass).removeClass(a.leftEdgeClass).removeClass(a.rightEdgeClass),a.hidePageScrollbars&&(document.body.style.overflow=this.bodyOverflowStyle),this.options.clearSlides&&this.resetSlides(),this.options.onclosed&&this.options.onclosed.call(this)},close:function(){var a=this,b=function(c){c.target===a.container[0]&&(a.container.off(a.support.transition.end,b),a.handleClose())};this.options.onclose&&this.options.onclose.call(this),this.support.transition&&this.options.displayTransition?(this.container.on(this.support.transition.end,b),this.container.removeClass(this.options.displayClass)):this.handleClose()},circle:function(a){return(this.num+a%this.num)%this.num},move:function(a,b,c){this.translateX(a,b,c),this.positions[a]=b},translate:function(a,b,c,d){var e=this.slides[a].style,f=this.support.transition,g=this.support.transform;e[f.name+\"Duration\"]=d+\"ms\",e[g.name]=\"translate(\"+b+\"px, \"+c+\"px)\"+(g.translateZ?\" translateZ(0)\":\"\")},translateX:function(a,b,c){this.translate(a,b,0,c)},translateY:function(a,b,c){this.translate(a,0,b,c)},animate:function(a,b,c){if(!c)return void(this.slidesContainer[0].style.left=b+\"px\");var d=this,e=(new Date).getTime(),f=window.setInterval(function(){var g=(new Date).getTime()-e;return g>c?(d.slidesContainer[0].style.left=b+\"px\",d.ontransitionend(),void window.clearInterval(f)):void(d.slidesContainer[0].style.left=(b-a)*(Math.floor(g/c*100)/100)+a+\"px\")},4)},preventDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},onresize:function(){this.initSlides(!0)},onmousedown:function(a){a.which&&1===a.which&&\"VIDEO\"!==a.target.nodeName&&(a.preventDefault(),(a.originalEvent||a).touches=[{pageX:a.pageX,pageY:a.pageY}],this.ontouchstart(a))},onmousemove:function(a){this.touchStart&&((a.originalEvent||a).touches=[{pageX:a.pageX,pageY:a.pageY}],this.ontouchmove(a))},onmouseup:function(a){this.touchStart&&(this.ontouchend(a),delete this.touchStart)},onmouseout:function(b){if(this.touchStart){var c=b.target,d=b.relatedTarget;(!d||d!==c&&!a.contains(c,d))&&this.onmouseup(b)}},ontouchstart:function(a){this.options.stopTouchEventsPropagation&&this.stopPropagation(a);var b=(a.originalEvent||a).touches[0];this.touchStart={x:b.pageX,y:b.pageY,time:Date.now()},this.isScrolling=void 0,this.touchDelta={}},ontouchmove:function(a){this.options.stopTouchEventsPropagation&&this.stopPropagation(a);var b,c,d=(a.originalEvent||a).touches[0],e=(a.originalEvent||a).scale,f=this.index;if(!(d.length>1||e&&1!==e))if(this.options.disableScroll&&a.preventDefault(),this.touchDelta={x:d.pageX-this.touchStart.x,y:d.pageY-this.touchStart.y},b=this.touchDelta.x,void 0===this.isScrolling&&(this.isScrolling=this.isScrolling||Math.abs(b)<Math.abs(this.touchDelta.y)),this.isScrolling)this.options.closeOnSwipeUpOrDown&&this.translateY(f,this.touchDelta.y+this.positions[f],0);else for(a.preventDefault(),window.clearTimeout(this.timeout),this.options.continuous?c=[this.circle(f+1),f,this.circle(f-1)]:(this.touchDelta.x=b/=!f&&b>0||f===this.num-1&&0>b?Math.abs(b)/this.slideWidth+1:1,c=[f],f&&c.push(f-1),f<this.num-1&&c.unshift(f+1));c.length;)f=c.pop(),this.translateX(f,b+this.positions[f],0)},ontouchend:function(a){this.options.stopTouchEventsPropagation&&this.stopPropagation(a);var b,c,d,e,f,g=this.index,h=this.options.transitionSpeed,i=this.slideWidth,j=Number(Date.now()-this.touchStart.time)<250,k=j&&Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.x)>i/2,l=!g&&this.touchDelta.x>0||g===this.num-1&&this.touchDelta.x<0,m=!k&&this.options.closeOnSwipeUpOrDown&&(j&&Math.abs(this.touchDelta.y)>20||Math.abs(this.touchDelta.y)>this.slideHeight/2);this.options.continuous&&(l=!1),b=this.touchDelta.x<0?-1:1,this.isScrolling?m?this.close():this.translateY(g,0,h):k&&!l?(c=g+b,d=g-b,e=i*b,f=-i*b,this.options.continuous?(this.move(this.circle(c),e,0),this.move(this.circle(g-2*b),f,0)):c>=0&&c<this.num&&this.move(c,e,0),this.move(g,this.positions[g]+e,h),this.move(this.circle(d),this.positions[this.circle(d)]+e,h),g=this.circle(d),this.onslide(g)):this.options.continuous?(this.move(this.circle(g-1),-i,h),this.move(g,0,h),this.move(this.circle(g+1),i,h)):(g&&this.move(g-1,-i,h),this.move(g,0,h),g<this.num-1&&this.move(g+1,i,h))},ontouchcancel:function(a){this.touchStart&&(this.ontouchend(a),delete this.touchStart)},ontransitionend:function(a){var b=this.slides[this.index];a&&b!==a.target||(this.interval&&this.play(),this.setTimeout(this.options.onslideend,[this.index,b]))},oncomplete:function(b){var c,d=b.target||b.srcElement,e=d&&d.parentNode;d&&e&&(c=this.getNodeIndex(e),a(e).removeClass(this.options.slideLoadingClass),\"error\"===b.type?(a(e).addClass(this.options.slideErrorClass),this.elements[c]=3):this.elements[c]=2,d.clientHeight>this.container[0].clientHeight&&(d.style.maxHeight=this.container[0].clientHeight),this.interval&&this.slides[this.index]===e&&this.play(),this.setTimeout(this.options.onslidecomplete,[c,e]))},onload:function(a){this.oncomplete(a)},onerror:function(a){this.oncomplete(a)},onkeydown:function(a){switch(a.which||a.keyCode){case 13:this.options.toggleControlsOnReturn&&(this.preventDefault(a),this.toggleControls());break;case 27:this.options.closeOnEscape&&this.close();break;case 32:this.options.toggleSlideshowOnSpace&&(this.preventDefault(a),this.toggleSlideshow());break;case 37:this.options.enableKeyboardNavigation&&(this.preventDefault(a),this.prev());break;case 39:this.options.enableKeyboardNavigation&&(this.preventDefault(a),this.next())}},handleClick:function(b){var c=this.options,d=b.target||b.srcElement,e=d.parentNode,f=function(b){return a(d).hasClass(b)||a(e).hasClass(b)};f(c.toggleClass)?(this.preventDefault(b),this.toggleControls()):f(c.prevClass)?(this.preventDefault(b),this.prev()):f(c.nextClass)?(this.preventDefault(b),this.next()):f(c.closeClass)?(this.preventDefault(b),this.close()):f(c.playPauseClass)?(this.preventDefault(b),this.toggleSlideshow()):e===this.slidesContainer[0]?(this.preventDefault(b),c.closeOnSlideClick?this.close():this.toggleControls()):e.parentNode&&e.parentNode===this.slidesContainer[0]&&(this.preventDefault(b),this.toggleControls())},onclick:function(a){return this.options.emulateTouchEvents&&this.touchDelta&&(Math.abs(this.touchDelta.x)>20||Math.abs(this.touchDelta.y)>20)?void delete this.touchDelta:this.handleClick(a)},updateEdgeClasses:function(a){a?this.container.removeClass(this.options.leftEdgeClass):this.container.addClass(this.options.leftEdgeClass),a===this.num-1?this.container.addClass(this.options.rightEdgeClass):this.container.removeClass(this.options.rightEdgeClass)},handleSlide:function(a){this.options.continuous||this.updateEdgeClasses(a),this.loadElements(a),this.options.unloadElements&&this.unloadElements(a),this.setTitle(a)},onslide:function(a){this.index=a,this.handleSlide(a),this.setTimeout(this.options.onslide,[a,this.slides[a]])},setTitle:function(a){var b=this.slides[a].firstChild.title,c=this.titleElement;c.length&&(this.titleElement.empty(),b&&c[0].appendChild(document.createTextNode(b)))},setTimeout:function(a,b,c){var d=this;return a&&window.setTimeout(function(){a.apply(d,b||[])},c||0)},imageFactory:function(b,c){var d,e,f,g=this,h=this.imagePrototype.cloneNode(!1),i=b,j=this.options.stretchImages,k=function(b){if(!d){if(b={type:b.type,target:e},!e.parentNode)return g.setTimeout(k,[b]);d=!0,a(h).off(\"load error\",k),j&&\"load\"===b.type&&(e.style.background='url(\"'+i+'\") center no-repeat',e.style.backgroundSize=j),c(b)}};return\"string\"!=typeof i&&(i=this.getItemProperty(b,this.options.urlProperty),f=this.getItemProperty(b,this.options.titleProperty)),j===!0&&(j=\"contain\"),j=this.support.backgroundSize&&this.support.backgroundSize[j]&&j,j?e=this.elementPrototype.cloneNode(!1):(e=h,h.draggable=!1),f&&(e.title=f),a(h).on(\"load error\",k),h.src=i,e},createElement:function(b,c){var d=b&&this.getItemProperty(b,this.options.typeProperty),e=d&&this[d.split(\"/\")[0]+\"Factory\"]||this.imageFactory,f=b&&e.call(this,b,c);return f||(f=this.elementPrototype.cloneNode(!1),this.setTimeout(c,[{type:\"error\",target:f}])),a(f).addClass(this.options.slideContentClass),f},loadElement:function(b){this.elements[b]||(this.slides[b].firstChild?this.elements[b]=a(this.slides[b]).hasClass(this.options.slideErrorClass)?3:2:(this.elements[b]=1,a(this.slides[b]).addClass(this.options.slideLoadingClass),this.slides[b].appendChild(this.createElement(this.list[b],this.proxyListener))))},loadElements:function(a){var b,c=Math.min(this.num,2*this.options.preloadRange+1),d=a;for(b=0;c>b;b+=1)d+=b*(b%2===0?-1:1),d=this.circle(d),this.loadElement(d)},unloadElements:function(a){var b,c,d;for(b in this.elements)this.elements.hasOwnProperty(b)&&(d=Math.abs(a-b),d>this.options.preloadRange&&d+this.options.preloadRange<this.num&&(c=this.slides[b],c.removeChild(c.firstChild),delete this.elements[b]))},addSlide:function(a){var b=this.slidePrototype.cloneNode(!1);b.setAttribute(\"data-index\",a),this.slidesContainer[0].appendChild(b),this.slides.push(b)},positionSlide:function(a){var b=this.slides[a];b.style.width=this.slideWidth+\"px\",this.support.transition&&(b.style.left=a*-this.slideWidth+\"px\",this.move(a,this.index>a?-this.slideWidth:this.index<a?this.slideWidth:0,0))},initSlides:function(b){var c,d;for(b||(this.positions=[],this.positions.length=this.num,this.elements={},this.imagePrototype=document.createElement(\"img\"),this.elementPrototype=document.createElement(\"div\"),this.slidePrototype=document.createElement(\"div\"),a(this.slidePrototype).addClass(this.options.slideClass),this.slides=this.slidesContainer[0].children,c=this.options.clearSlides||this.slides.length!==this.num),this.slideWidth=this.container[0].offsetWidth,this.slideHeight=this.container[0].offsetHeight,this.slidesContainer[0].style.width=this.num*this.slideWidth+\"px\",c&&this.resetSlides(),d=0;d<this.num;d+=1)c&&this.addSlide(d),this.positionSlide(d);this.options.continuous&&this.support.transition&&(this.move(this.circle(this.index-1),-this.slideWidth,0),this.move(this.circle(this.index+1),this.slideWidth,0)),this.support.transition||(this.slidesContainer[0].style.left=this.index*-this.slideWidth+\"px\")},toggleControls:function(){var a=this.options.controlsClass;this.container.hasClass(a)?this.container.removeClass(a):this.container.addClass(a)},toggleSlideshow:function(){this.interval?this.pause():this.play()},getNodeIndex:function(a){return parseInt(a.getAttribute(\"data-index\"),10)},getNestedProperty:function(a,b){return b.replace(/\\[(?:'([^']+)'|\"([^\"]+)\"|(\\d+))\\]|(?:(?:^|\\.)([^\\.\\[]+))/g,function(b,c,d,e,f){var g=f||c||d||e&&parseInt(e,10);b&&a&&(a=a[g])}),a},getDataProperty:function(b,c){if(b.getAttribute){var d=b.getAttribute(\"data-\"+c.replace(/([A-Z])/g,\"-$1\").toLowerCase());if(\"string\"==typeof d){if(/^(true|false|null|-?\\d+(\\.\\d+)?|\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\])$/.test(d))try{return a.parseJSON(d)}catch(e){}return d}}},getItemProperty:function(a,b){var c=a[b];return void 0===c&&(c=this.getDataProperty(a,b),void 0===c&&(c=this.getNestedProperty(a,b))),c},initStartIndex:function(){var a,b=this.options.index,c=this.options.urlProperty;if(b&&\"number\"!=typeof b)for(a=0;a<this.num;a+=1)if(this.list[a]===b||this.getItemProperty(this.list[a],c)===this.getItemProperty(b,c)){b=a;break}this.index=this.circle(parseInt(b,10)||0)},initEventListeners:function(){var b=this,c=this.slidesContainer,d=function(a){var c=b.support.transition&&b.support.transition.end===a.type?\"transitionend\":a.type;b[\"on\"+c](a)};a(window).on(\"resize\",d),a(document.body).on(\"keydown\",d),this.container.on(\"click\",d),this.support.touch?c.on(\"touchstart touchmove touchend touchcancel\",d):this.options.emulateTouchEvents&&this.support.transition&&c.on(\"mousedown mousemove mouseup mouseout\",d),this.support.transition&&c.on(this.support.transition.end,d),this.proxyListener=d},destroyEventListeners:function(){var b=this.slidesContainer,c=this.proxyListener;a(window).off(\"resize\",c),a(document.body).off(\"keydown\",c),this.container.off(\"click\",c),this.support.touch?b.off(\"touchstart touchmove touchend touchcancel\",c):this.options.emulateTouchEvents&&this.support.transition&&b.off(\"mousedown mousemove mouseup mouseout\",c),this.support.transition&&b.off(this.support.transition.end,c)},handleOpen:function(){this.options.onopened&&this.options.onopened.call(this)},initWidget:function(){var b=this,c=function(a){a.target===b.container[0]&&(b.container.off(b.support.transition.end,c),b.handleOpen())};return this.container=a(this.options.container),this.container.length?(this.slidesContainer=this.container.find(this.options.slidesContainer).first(),this.slidesContainer.length?(this.titleElement=this.container.find(this.options.titleElement).first(),1===this.num&&this.container.addClass(this.options.singleClass),this.options.onopen&&this.options.onopen.call(this),this.support.transition&&this.options.displayTransition?this.container.on(this.support.transition.end,c):this.handleOpen(),this.options.hidePageScrollbars&&(this.bodyOverflowStyle=document.body.style.overflow,document.body.style.overflow=\"hidden\"),this.container[0].style.display=\"block\",this.initSlides(),void this.container.addClass(this.options.displayClass)):(this.console.log(\"blueimp Gallery: Slides container not found.\",this.options.slidesContainer),!1)):(this.console.log(\"blueimp Gallery: Widget container not found.\",this.options.container),!1)},initOptions:function(b){this.options=a.extend({},this.options),(b&&b.carousel||this.options.carousel&&(!b||b.carousel!==!1))&&a.extend(this.options,this.carouselOptions),a.extend(this.options,b),this.num<3&&(this.options.continuous=this.options.continuous?null:!1),this.support.transition||(this.options.emulateTouchEvents=!1),this.options.event&&this.preventDefault(this.options.event)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";a.extend(b.prototype.options,{fullScreen:!1});var c=b.prototype.initialize,d=b.prototype.close;return a.extend(b.prototype,{getFullScreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},requestFullScreen:function(a){a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen&&a.msRequestFullscreen()},exitFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},initialize:function(){c.call(this),this.options.fullScreen&&!this.getFullScreenElement()&&this.requestFullScreen(this.container[0])},close:function(){this.getFullScreenElement()===this.container[0]&&this.exitFullScreen(),d.call(this)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";a.extend(b.prototype.options,{indicatorContainer:\"ol\",activeIndicatorClass:\"active\",thumbnailProperty:\"thumbnail\",thumbnailIndicators:!0});var c=b.prototype.initSlides,d=b.prototype.addSlide,e=b.prototype.resetSlides,f=b.prototype.handleClick,g=b.prototype.handleSlide,h=b.prototype.handleClose;return a.extend(b.prototype,{createIndicator:function(b){var c,d,e=this.indicatorPrototype.cloneNode(!1),f=this.getItemProperty(b,this.options.titleProperty),g=this.options.thumbnailProperty;return this.options.thumbnailIndicators&&(d=b.getElementsByTagName&&a(b).find(\"img\")[0],d?c=d.src:g&&(c=this.getItemProperty(b,g)),c&&(e.style.backgroundImage='url(\"'+c+'\")')),f&&(e.title=f),e},addIndicator:function(a){if(this.indicatorContainer.length){var b=this.createIndicator(this.list[a]);b.setAttribute(\"data-index\",a),this.indicatorContainer[0].appendChild(b),this.indicators.push(b)}},setActiveIndicator:function(b){this.indicators&&(this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),this.activeIndicator=a(this.indicators[b]),this.activeIndicator.addClass(this.options.activeIndicatorClass))},initSlides:function(a){a||(this.indicatorContainer=this.container.find(this.options.indicatorContainer),this.indicatorContainer.length&&(this.indicatorPrototype=document.createElement(\"li\"),this.indicators=this.indicatorContainer[0].children)),c.call(this,a)},addSlide:function(a){d.call(this,a),this.addIndicator(a)},resetSlides:function(){e.call(this),this.indicatorContainer.empty(),this.indicators=[]},handleClick:function(a){var b=a.target||a.srcElement,c=b.parentNode;if(c===this.indicatorContainer[0])this.preventDefault(a),this.slide(this.getNodeIndex(b));else{if(c.parentNode!==this.indicatorContainer[0])return f.call(this,a);this.preventDefault(a),this.slide(this.getNodeIndex(c))}},handleSlide:function(a){g.call(this,a),this.setActiveIndicator(a)},handleClose:function(){this.activeIndicator&&this.activeIndicator.removeClass(this.options.activeIndicatorClass),h.call(this)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";a.extend(b.prototype.options,{videoContentClass:\"video-content\",videoLoadingClass:\"video-loading\",videoPlayingClass:\"video-playing\",videoPosterProperty:\"poster\",videoSourcesProperty:\"sources\"});var c=b.prototype.handleSlide;return a.extend(b.prototype,{handleSlide:function(a){c.call(this,a),this.playingVideo&&this.playingVideo.pause()},videoFactory:function(b,c,d){var e,f,g,h,i,j=this,k=this.options,l=this.elementPrototype.cloneNode(!1),m=a(l),n=[{type:\"error\",target:l}],o=d||document.createElement(\"video\"),p=this.getItemProperty(b,k.urlProperty),q=this.getItemProperty(b,k.typeProperty),r=this.getItemProperty(b,k.titleProperty),s=this.getItemProperty(b,k.videoPosterProperty),t=this.getItemProperty(b,k.videoSourcesProperty);if(m.addClass(k.videoContentClass),r&&(l.title=r),o.canPlayType)if(p&&q&&o.canPlayType(q))o.src=p;else for(;t&&t.length;)if(f=t.shift(),p=this.getItemProperty(f,k.urlProperty),q=this.getItemProperty(f,k.typeProperty),p&&q&&o.canPlayType(q)){o.src=p;break}return s&&(o.poster=s,e=this.imagePrototype.cloneNode(!1),a(e).addClass(k.toggleClass),e.src=s,e.draggable=!1,l.appendChild(e)),g=document.createElement(\"a\"),g.setAttribute(\"target\",\"_blank\"),d||g.setAttribute(\"download\",r),g.href=p,o.src&&(o.controls=!0,(d||a(o)).on(\"error\",function(){j.setTimeout(c,n)}).on(\"pause\",function(){h=!1,m.removeClass(j.options.videoLoadingClass).removeClass(j.options.videoPlayingClass),i&&j.container.addClass(j.options.controlsClass),delete j.playingVideo,j.interval&&j.play()}).on(\"playing\",function(){h=!1,m.removeClass(j.options.videoLoadingClass).addClass(j.options.videoPlayingClass),j.container.hasClass(j.options.controlsClass)?(i=!0,j.container.removeClass(j.options.controlsClass)):i=!1}).on(\"play\",function(){window.clearTimeout(j.timeout),h=!0,m.addClass(j.options.videoLoadingClass),j.playingVideo=o}),a(g).on(\"click\",function(a){j.preventDefault(a),h?o.pause():o.play()}),l.appendChild(d&&d.element||o)),l.appendChild(g),this.setTimeout(c,[{type:\"load\",target:l}]),l}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery-video\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";if(!window.postMessage)return b;a.extend(b.prototype.options,{vimeoVideoIdProperty:\"vimeo\",vimeoPlayerUrl:\"//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID\",vimeoPlayerIdPrefix:\"vimeo-player-\",vimeoClickToPlay:!0});var c=b.prototype.textFactory||b.prototype.imageFactory,d=function(a,b,c,d){this.url=a,this.videoId=b,this.playerId=c,this.clickToPlay=d,this.element=document.createElement(\"div\"),this.listeners={}},e=0;return a.extend(d.prototype,{canPlayType:function(){return!0},on:function(a,b){return this.listeners[a]=b,this},loadAPI:function(){for(var b,c,d=this,e=\"//\"+(\"https\"===location.protocol?\"secure-\":\"\")+\"a.vimeocdn.com/js/froogaloop2.min.js\",f=document.getElementsByTagName(\"script\"),g=f.length,h=function(){!c&&d.playOnReady&&d.play(),c=!0};g;)if(g-=1,f[g].src===e){b=f[g];break}b||(b=document.createElement(\"script\"),b.src=e),a(b).on(\"load\",h),f[0].parentNode.insertBefore(b,f[0]),/loaded|complete/.test(b.readyState)&&h()},onReady:function(){var a=this;this.ready=!0,this.player.addEvent(\"play\",function(){a.hasPlayed=!0,a.onPlaying()}),this.player.addEvent(\"pause\",function(){a.onPause()}),this.player.addEvent(\"finish\",function(){a.onPause()}),this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){this.listeners.pause(),delete this.playStatus},insertIframe:function(){var a=document.createElement(\"iframe\");a.src=this.url.replace(\"VIDEO_ID\",this.videoId).replace(\"PLAYER_ID\",this.playerId),a.id=this.playerId,this.element.parentNode.replaceChild(a,this.element),this.element=a},play:function(){var a=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.api(\"play\"):(this.playOnReady=!0,window.$f?this.player||(this.insertIframe(),this.player=$f(this.element),this.player.addEvent(\"ready\",function(){a.onReady()})):this.loadAPI())},pause:function(){this.ready?this.player.api(\"pause\"):this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),a.extend(b.prototype,{VimeoPlayer:d,textFactory:function(a,b){var f=this.options,g=this.getItemProperty(a,f.vimeoVideoIdProperty);return g?(void 0===this.getItemProperty(a,f.urlProperty)&&(a[f.urlProperty]=\"//vimeo.com/\"+g),e+=1,this.videoFactory(a,b,new d(f.vimeoPlayerUrl,g,f.vimeoPlayerIdPrefix+e,f.vimeoClickToPlay))):c.call(this,a,b)}}),b}),function(a){\"use strict\";\"function\"==typeof define&&define.amd?define([\"./blueimp-helper\",\"./blueimp-gallery-video\"],a):a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(a,b){\"use strict\";if(!window.postMessage)return b;a.extend(b.prototype.options,{youTubeVideoIdProperty:\"youtube\",youTubePlayerVars:{wmode:\"transparent\"},youTubeClickToPlay:!0});var c=b.prototype.textFactory||b.prototype.imageFactory,d=function(a,b,c){this.videoId=a,this.playerVars=b,this.clickToPlay=c,this.element=document.createElement(\"div\"),this.listeners={}};return a.extend(d.prototype,{canPlayType:function(){return!0},on:function(a,b){return this.listeners[a]=b,this},loadAPI:function(){var a,b=this,c=window.onYouTubeIframeAPIReady,d=\"//www.youtube.com/iframe_api\",e=document.getElementsByTagName(\"script\"),f=e.length;for(window.onYouTubeIframeAPIReady=function(){c&&c.apply(this),b.playOnReady&&b.play()};f;)if(f-=1,e[f].src===d)return;a=document.createElement(\"script\"),a.src=d,e[0].parentNode.insertBefore(a,e[0])},onReady:function(){this.ready=!0,this.playOnReady&&this.play()},onPlaying:function(){this.playStatus<2&&(this.listeners.playing(),this.playStatus=2)},onPause:function(){b.prototype.setTimeout.call(this,this.checkSeek,null,2e3)},checkSeek:function(){(this.stateChange===YT.PlayerState.PAUSED||this.stateChange===YT.PlayerState.ENDED)&&(this.listeners.pause(),delete this.playStatus)},onStateChange:function(a){switch(a.data){case YT.PlayerState.PLAYING:this.hasPlayed=!0,this.onPlaying();break;case YT.PlayerState.PAUSED:case YT.PlayerState.ENDED:this.onPause()}this.stateChange=a.data},onError:function(a){this.listeners.error(a)},play:function(){var a=this;this.playStatus||(this.listeners.play(),this.playStatus=1),this.ready?!this.hasPlayed&&(this.clickToPlay||window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform))?this.onPlaying():this.player.playVideo():(this.playOnReady=!0,window.YT&&YT.Player?this.player||(this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){a.onReady()},onStateChange:function(b){a.onStateChange(b)},onError:function(b){a.onError(b)}}})):this.loadAPI())},pause:function(){this.ready?this.player.pauseVideo():this.playStatus&&(delete this.playOnReady,this.listeners.pause(),delete this.playStatus)}}),a.extend(b.prototype,{YouTubePlayer:d,textFactory:function(a,b){var e=this.options,f=this.getItemProperty(a,e.youTubeVideoIdProperty);return f?(void 0===this.getItemProperty(a,e.urlProperty)&&(a[e.urlProperty]=\"//www.youtube.com/watch?v=\"+f),void 0===this.getItemProperty(a,e.videoPosterProperty)&&(a[e.videoPosterProperty]=\"//img.youtube.com/vi/\"+f+\"/maxresdefault.jpg\"),this.videoFactory(a,b,new d(f,e.youTubePlayerVars,e.youTubeClickToPlay))):c.call(this,a,b)}}),b});\n\n    // Default options for the lightbox\n    var options = {\n      'gallery_relation_attr':  'rel',\n      'gallery_container':      $('#blueimp-gallery'),\n      'image_selector':         'a[href$=\".jpg\"], a[href$=\".jpeg\"], a[href$=\".png\"], a[href$=\".gif\"], a[href$=\".bmp\"], a[href$=\".wbmp\"], .image-lightbox',\n      'titleElement':           '.title',\n      'continuous':             FANCYGALLERY.continuous == 'on', // Allow continuous navigation, moving from last to first and from first to last slide\n      'slideshowInterval':      parseFloat(FANCYGALLERY.slideshow_speed), // Delay in milliseconds between slides for the automatic slideshow\n      'preloadRange':           parseFloat(FANCYGALLERY.preload_images), // The number of elements to load around the current index\n      'transitionSpeed':        parseFloat(FANCYGALLERY.animation_speed), // The transition speed between slide changes in milliseconds\n      'stretchImages':          FANCYGALLERY.stretch_images, // Defines if images should be stretched to fill the available space. Values: \"cover\", \"contain\", false\n      'onopen':                 function(){ $('html').css('overflow', 'hidden') },\n      'onclosed':               function(){ $('html').css('overflow', 'auto')   }\n    };\n\n    // Associate the links with the lightbox\n    $('body').on('click', options.image_selector, function(event){\n      event.preventDefault();\n\n      var\n        $container = options.gallery_container,\n        $link = $(this),\n        gallery_relation = $link.attr(options.gallery_relation_attr),\n        $gallery = [],\n        $gallery_wrapper = $link.parents('.gallery.fancy-gallery:first'),\n        $content_wrapper = $link.parents('.fancy-gallery-content-unit:first');\n\n      // If the relation attribute is empty we need to remove it from all other link tags which have empty relation attributes\n      if (!gallery_relation){\n        $(options.image_selector)\n          .filter(function(){ return !$(this).attr(options.gallery_relation_attr); })\n          .removeAttr(options.gallery_relation_attr);\n      }\n\n      // Find other linked images which belongs to this gallery\n      if (gallery_relation)\n        $gallery = $('a[' + options.gallery_relation_attr + '=\"' + gallery_relation + '\"]');\n      else if ($gallery_wrapper.length > 0)\n        $gallery = $gallery_wrapper.find(options.image_selector);\n      else if ($content_wrapper.length > 0)\n        $gallery = $content_wrapper.find(options.image_selector).not('a[' + options.gallery_relation_attr + '], .gallery.fancy-gallery a');\n      else\n        $gallery = $(options.image_selector).not('.fancy-gallery-content-unit a, a[' + options.gallery_relation_attr + '], .gallery.fancy-gallery a');\n\n      // Set link index and event\n      $.extend(options, {\n        'index': $gallery.index( $link ),\n        'event': event\n      });\n\n      // Enabled descriptions\n      options.onslide = function(index, slide){\n        $(this.container).find('.description').empty().html( this.list[index].description );\n      };\n\n      // Prepare the gallery set of image links\n      $gallery.each(function(index, gallery_item){\n        var\n          $gallery_item = $(gallery_item),\n          href = $gallery_item.attr('href'),\n          thumbnail = $gallery_item.find('img:first').attr('src') || href,\n          title = $gallery_item.attr('title') || $gallery_item.find('img:first').attr('title'),\n          description = $gallery_item.data('description') /* || $gallery_item.data('caption') || $gallery_item.siblings('figcaption:first').text() */ ;\n\n        // modify the gallery set\n        $gallery[index] = {\n          'title':        title,\n          'description':  description,\n          'href':         href,\n          'thumbnail':    thumbnail\n        };\n      });\n\n      // Start the lightbox\n      new blueimp.Gallery($gallery, options);\n    });\n  }\n\n})(jQuery);", "<?php\nNamespace WordPress\\Plugin\\Fancy_Gallery;\n\nclass Options {\n  private\n    $arr_option_box, # Meta boxes for the option page\n    $options_page_slug, # Slug for the options page\n    $core; # Pointer to the core object\n\n  public function __construct($core){\n    $this->core = $core;\n    $this->options_page_slug = Sanitize_Title(Str_Replace(Array('\\\\', '/', '_'), '-', __CLASS__));\n\n    # Option boxes\n    $this->arr_option_box = Array(\n      'main' => Array(),\n      'side' => Array()\n    );\n\n    Add_Action('admin_menu', Array($this, 'Add_Options_Page'));\n  }\n\n  private function t($text, $context = False){\n    return $this->core->t($text, $context);\n  }\n\n  public function Add_Options_Page(){\n    $handle = Add_Options_Page (\n      $this->t('Fancy Gallery Options'),\n      $this->t('Fancy Gallery'),\n      'manage_options',\n      $this->options_page_slug,\n      Array($this, 'Print_Options_Page')\n    );\n\n    # Add JavaScript to this handle\n    Add_Action ('load-' . $handle, Array($this, 'Load_Options_Page'));\n\n    # Add option boxes\n    $this->Add_Option_Box($this->t('Lightbox'), DirName(__FILE__).'/options-page/lightbox.php');\n    $this->Add_Option_Box($this->t('Templates'), DirName(__FILE__).'/options-page/templates.php', 'main', 'closed');\n    $this->Add_Option_Box($this->t('User rights'), DirName(__FILE__).'/options-page/user-rights.php', 'main', 'closed');\n\n    $this->Add_Option_Box($this->t('Taxonomies'), DirName(__FILE__).'/options-page/taxonomies.php', 'side');\n    $this->Add_Option_Box($this->t('Gallery \"Excerpts\"'), DirName(__FILE__).'/options-page/excerpt.php', 'side');\n    $this->Add_Option_Box($this->t('Archive Url'), DirName(__FILE__).'/options-page/archive-link.php', 'side');\n  }\n\n  private function Get_Options_Page_Url($parameters = Array()){\n    $url = Add_Query_Arg(Array('page' => $this->options_page_slug), Admin_Url('options-general.php'));\n    If (Is_Array($parameters) && !Empty($parameters)) $url = Add_Query_Arg($parameters, $url);\n    return $url;\n  }\n\n  public function Load_Options_Page(){\n    # Check if the user trys to delete a template\n    If (IsSet($_GET['delete']) && $this->core->Get_Template_Properties ($_GET['delete'])){ # You can only delete Fancy Gallery Templates!\n      Unlink($_GET['delete']);\n      WP_Redirect( $this->Get_Options_Page_Url(Array('template_deleted' => 'true')) );\n    }\n    ElseIf (IsSet($_GET['delete'])){\n      WP_Die($this->t('Error while deleting: ' . HTMLSpecialChars($_GET['delete'])));\n    }\n\n    # If the Request was redirected from a \"Save Options\"-Post\n    If (IsSet($_REQUEST['options_saved'])) Flush_Rewrite_Rules();\n\n    # If this is a Post request to save the options\n    $options_saved = $this->Save_Options();\n    If ($options_saved)\n      WP_Redirect( $this->Get_Options_Page_Url(Array('options_saved' => 'true')) );\n\n    WP_Enqueue_Script('dashboard');\n    WP_Enqueue_Style('dashboard');\n\n    WP_Enqueue_Script('fancy-gallery-options-page', $this->core->base_url . '/options-page/options-page.js', Array('jquery'), $this->core->version, True);\n    WP_Enqueue_Style('fancy-gallery-options-page', $this->core->base_url . '/options-page/options-page.css' );\n\n    # Remove incompatible JS Libs\n    WP_Dequeue_Script('post');\n  }\n\n  public function Print_Options_Page(){\n    ?>\n    <div class=\"wrap\">\n      <h2><?php Echo $this->t('Fancy Gallery Settings') ?></h2>\n\n      <?php If (IsSet($_GET['options_saved'])) : ?>\n      <div id=\"message\" class=\"updated fade\">\n        <p><strong><?php _e('Settings saved.') ?></strong></p>\n      </div>\n      <?php EndIf; ?>\n\n      <?php If (IsSet($_GET['template_installed'])) : ?>\n      <div id=\"message\" class=\"updated fade\">\n        <p><strong><?php echo $this->t('Template installed.') ?></strong></p>\n      </div>\n      <?php EndIf; ?>\n\n      <?php If (IsSet($_GET['template_deleted'])) : ?>\n      <div id=\"message\" class=\"updated fade\">\n        <p><strong><?php echo $this->t('Template deleted.') ?></strong></p>\n      </div>\n      <?php EndIf; ?>\n\n      <form method=\"post\" action=\"\" enctype=\"multipart/form-data\">\n      <div class=\"metabox-holder\">\n\n        <div class=\"postbox-container\" style=\"width:69%;\">\n          <?php ForEach ($this->arr_option_box['main'] AS $box) : ?>\n            <div class=\"postbox should-be-<?php Echo $box['state'] ?>\">\n              <div class=\"handlediv\" title=\"<?php _e('Click to toggle') ?>\"><br /></div>\n              <h3 class=\"hndle\"><span><?php Echo $box['title'] ?></span></h3>\n              <div class=\"inside\"><?php Include $box['file'] ?></div>\n            </div>\n          <?php EndForEach ?>\n        </div>\n\n        <div class=\"postbox-container\" style=\"width:29%;float:right\">\n          <?php ForEach ($this->arr_option_box['side'] AS $box) : ?>\n            <div class=\"postbox should-be-<?php Echo $box['state'] ?>\">\n              <div class=\"handlediv\" title=\"<?php _e('Click to toggle') ?>\"><br /></div>\n              <h3 class=\"hndle\"><span><?php Echo $box['title'] ?></span></h3>\n              <div class=\"inside\"><?php Include $box['file'] ?></div>\n            </div>\n          <?php EndForEach ?>\n        </div>\n\n        <div class=\"clear\"></div>\n      </div>\n\n      <p class=\"submit\">\n        <input type=\"submit\" class=\"button-primary\" value=\"<?php _e('Save Changes') ?>\">\n      </p>\n\n      </form>\n    </div>\n    <?php\n  }\n\n  public function Add_Option_Box($title, $include_file, $column = 'main', $state = 'opened'){\n    # Check the input\n    If (!Is_File($include_file)) return False;\n    If ( $title == '' ) $title = '&nbsp;';\n\n    # Column (can be 'side' or 'main')\n    If ($column != '' && $column != Null && $column != 'main')\n      $column = 'side';\n    Else\n      $column = 'main';\n\n    # State (can be 'opened' or 'closed')\n    If ($state != '' && $state != Null && $state != 'opened')\n      $state = 'closed';\n    Else\n      $state = 'opened';\n\n    # Add a new box\n    $this->arr_option_box[$column][] = Array('title' => $title, 'file' => $include_file, 'state' => $state);\n  }\n\n  private function Save_Options(){\n    # Check if this is a post request\n    If (Empty($_POST)) return False;\n\n    # Add Capabilities\n    If (IsSet($_POST['capabilities']) && Is_Array($_POST['capabilities'])){\n      ForEach ($_POST['capabilities'] AS $role_name => $arr_role){\n        If (!$role = get_role($role_name)) Continue;\n        ForEach ((Array) $arr_role AS $capability => $yes_no){\n          If ($yes_no == 'yes')\n            $role->add_cap($capability);\n          Else\n            $role->remove_cap($capability);\n        }\n      }\n      Unset ($_POST['capabilities']);\n    }\n\n    # Clean the Post array\n    $_POST = StripSlashes_Deep($_POST);\n    ForEach ($_POST AS $option => $value)\n      If (!$value) Unset ($_POST[$option]);\n\n    # Save Options\n    Update_Option (__CLASS__, $_POST);\n    Delete_Option ('wp_plugin_fancy_gallery_pro');\n    Delete_Option ('wp_plugin_fancy_gallery');\n\n    # We delete the update cache\n    $this->core->Clear_Plugin_Update_Cache();\n\n    return True;\n  }\n\n  private function Default_Options(){\n    return Array(\n      'lightbox' => 'on',\n      'continuous' => 'off',\n      'title_description' => 'on',\n      'close_button' => 'on',\n      'indicator_thumbnails' => 'on',\n      'slideshow_speed' => 4000, # Slideshow speed in milliseconds\n      'preload_images' => 2,\n      'animation_speed' => 400,\n      'stretch_images' => False,\n\n      'gallery_taxonomy' => Array(),\n\n      'disable_excerpts' => False,\n      'excerpt_thumb_width' => Get_Option('thumbnail_size_w'),\n      'excerpt_thumb_height' => Get_Option('thumbnail_size_h'),\n      'excerpt_image_number' => 3,\n\n      'deactivate_archive' => False\n    );\n  }\n\n  public function Get($key = Null, $default = False){\n    # Read Options\n    $arr_option = Array_Merge (\n      (Array) $this->Default_Options(),\n      (Array) Get_Option('wp_plugin_fancy_gallery_pro'),\n      (Array) Get_Option('wp_plugin_fancy_gallery'),\n      (Array) Get_Option(__CLASS__)\n    );\n\n    # Locate the option\n    If ($key == Null)\n      return $arr_option;\n    ElseIf (IsSet($arr_option[$key]))\n      return $arr_option[$key];\n    Else\n      return $default;\n  }\n\n}", "<?php\n/*\nPlugin Name: Fancy Gallery Lite\nPlugin URI: http://dennishoppe.de/en/wordpress-plugins/fancy-gallery\nDescription: Fancy Gallery enables you to create and manage galleries and converts your galleries in post and pages to valid HTML5 blocks and associates linked images with a nice and responsive lightbox.\nVersion: 1.5.13\nAuthor: Dennis Hoppe\nAuthor URI: http://DennisHoppe.de\n*/\n\nIf (Version_Compare(PHP_VERSION, '5.3.0', '<')){\n\n  # Add PHP Version warning to the dashboard\n  Add_Action('admin_notices', 'Fancy_Gallery_PHP53_Version_Warning');\n  function Fancy_Gallery_PHP53_Version_Warning(){ ?>\n    <div class=\"error\">\n      <p><?php PrintF('<strong>%1$s:</strong> You need at least <strong>PHP 5.3</strong> or higher to use %1$s. You are using PHP %2$s. Please ask your hoster for an upgrade.', 'Fancy Gallery', PHP_VERSION) ?></p>\n    </div><?php\n  }\n\n}\nElse {\n\n  # Load core classes\n  Include DirName(__FILE__) . '/class.core.php';\n  Include DirName(__FILE__) . '/class.gallery-post-type.php';\n  Include DirName(__FILE__) . '/class.lightbox.php';\n  Include DirName(__FILE__) . '/class.i18n.php';\n  Include DirName(__FILE__) . '/class.mocking-bird.php';\n  Include DirName(__FILE__) . '/class.options.php';\n  Include DirName(__FILE__) . '/class.wpml.php';\n\n  # Load widgets\n  Include DirName(__FILE__) . '/widget.random-images.php';\n  Include DirName(__FILE__) . '/widget.taxonomies.php';\n  Include DirName(__FILE__) . '/widget.taxonomy-cloud.php';\n\n  # Inititalize Plugin: Would cause a synthax error in PHP < 5.3\n  Eval('New WordPress\\Plugin\\Fancy_Gallery\\Core(__FILE__);');\n\n}", "\ufeff=== Fancy Gallery ===\nContributors: dhoppe\nTags: gallery, galleries, image, images, picture, pictures, photo, photos, photo-album, photo-albums, fancybox, thickbox, lightbox, jquery, javascript, widget, cms, free, flickr\t\t\t\twidget,Post,plugin,admin,posts,sidebar,comments,google,images,page,image,links\nRequires at least: 3.6\nTested up to: 4.0\nStable tag: trunk\nDonate link: http://dennishoppe.de/en/wordpress-plugins/fancy-gallery\nLicense: GPLv2\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\n\nAwesome gallery management and touch-enabled, responsive, mobile-friendly image lightbox tool to manage and present image galleries within WordPress\n\n\n== Description ==\nFancy Gallery is *the* most innovative state of the art **WordPress Gallery Management tool** which enables you to **organize image galleries** easily in your WordPress backend. Furthermore this gallery plugin adds a beautiful awesome **javascript lightbox effect** (touch-enabled, responsive, optimized for both mobile and desktop web browsers) to all links pointing to an image anywhere on your website. This includes images in your posts, galleries, pages, sidebar widgets and anywhere else on your website.\n\n= Lightbox behavior =\nAll links - regardless if text or image - pointing to an image will automatically opened in a **responsive lightbox**. You do not need to care about any tag attributes or link classes \u2013 the plugins thinks about that for you. When using the [gallery] shortcode the images will get a **\"previous\", \"next\" and a slideshow button**. The gallery itself will be converted to a **valid HTML5 section** - even if your theme does not support HTML5 galleries yet.\n\n> #### Kick-Start\n> Read the feature lists below or [take an eye on the screenshots](https://wordpress.org/plugins/fancy-gallery/screenshots/)!\n\n= Gallery management features =\n* Organize image galleries separated from posts or pages\n* **Centralized gallery management**. Enjoy a single location where you can see and manage all your galleries\n* Automatically generated **index page with all galleries**\n* Every gallery has its own page with unique URL\n* Taxonomies to classify your galleries: **Categories, Tags, Events, Places, Dates, Persons, Photographers**.\u00b9 (Need more? Ask us!)\n* Both tags and categories are disjunct from your post tags and post categories\n* Supports gallery **comments**\u00b2\n* Supports **featured images** as gallery thumbnails\u00b2\n* Supports **excerpts** for your uploaded galleries (the same way you already know from regular posts)\n* Excerpts can contain text description and a random set of preview images\n* Supports WordPress **user rights** and capabilities\u00b9\n* Supports the **WordPress menus** and enables you to add all components of your galleries to any menu\n* **Import and export** directly via the official \"[WordPress Importer](https://wordpress.org/plugins/wordpress-importer/)\" by Automattic Inc.\n\n= Lightbox features =\n* Javascript lightbox support for **all linked images** on your website\n* Has \"Previous\" and \"Next\" buttons\n* Shows image title and description\n* Lightbox is **touch-enabled, responsive and mobile-friendly**\n* Supports **Swipe function** for touch screens \u2013 works with every smart phone and tablet\n* Awesome image **slideshow** function\n* **Indicator thumbnail images** below the full size image\n* Uses the **full screen** size for presenting your image\n\n= General features =\n* **SEO conform** URL structure for all kind of pages\n* Supports **WPML** flawless\n* Supports the WordPress theme template hierarchy and the parent-child-theme paradigm\n* Supports **user defined HTML templates**\n* Supports **RSS feeds** for the gallery index and for the comments of each gallery\n* Custom **thumbnail sizes** and **color effects**\u00b9\n* **Fully compatible** with all existing themes with archive template\n* Template engine to display your galleries in different styles\n* Widget to display random images from your galleries in the sidebar\u00b9\n* Widget to display the gallery taxonomies as list or cloud in the sidebar\u00b9\n* Converts all galleries in **valid HTML5 blocks**\n* **Completely translatable** - .pot file is included\n* Includes a **bunch of filters** to give you the control of the behavior of this piece of code\n* **Clean and intuitive** user interface\n* Works great with **WordPress Multisite**\n* Personal **one-on-one real-time support** by the developer\u00b9\n* No ads or branding anywhere - perfect white label solution\u00b9\n\n\u00b9 Available in [Fancy Gallery Pro](http://dennishoppe.de/en/wordpress-plugins/fancy-gallery).<br>\n\u00b2 Your theme needs to support this too.\n\n= Gallery shortcode =\nOf course you can use \"exclude\" and \"include\" parameters in your [gallery] shortcode like you already know from the traditional gallery code.\n\n= Settings =\nYou can find the settings page in your Dashboard -> Settings -> Fancy Gallery.\n\n= Gallery Templates =\nTo create your own gallery template you only need elementary HTML and PHP knowledge. Just start by creating a new HTML file with the following example header with the template details.\n\n<code>\n/*\nFancy Gallery Template: Template Name\nDescription: Your template description here.\nVersion: 1.0\nAuthor: John Doe\nAuthor URI: http://example.com\n*/\n</code>\n\nYou can place the template in these folders:\n\n1. If it is for your own website put it in /wp-content/fancy-gallery-templates.\n1. If you are a theme author just put in your theme (max one level deep).\n1. If you are a plugin developer use the \"fancy_gallery_template_files\" to add template files from anywhere.\n1. Absolutely not recommended: in the \"templates/\" folder of the plugin itself.\n\n\n= Questions and support requests =\nPlease use the support forum on WordPress.org only for this free lite version of the plugin. For the pro version there is a separate support package available. *Please do not use the WordPress.org support forum for questions about the pro version* or questions about my services! Of course you can hire me for consulting, support, programming and customizations at any time.\n\n\n= Language =\n* This Plugin is available in English.\n* Diese Erweiterung ist in Deutsch verf\u00fcgbar. ([Ulrike Seddig](http://UlrikeSeddig.de/))\n* Plugin disponible en Espa\u00f1ol. ([Guillermo Gozalbes](http://www.versus.es/))\n* Este plugin est\u00e1 dispon\u00edvel em portugu\u00eas - Brasil. (Ramiro Modica)\n* Ce plugin est disponible en fran\u00e7ais. (Thomas Schlesser)\n\n\n= Translate this plugin =\nIf you have translated this plugin in your language feel free to send us the language file (.po file) via E-Mail with your name and this translated sentence: \"This plug-in is available in %YOUR_LANGUAGE_NAME%.\" We will add it to the plug-in.\n\nYou can find the *Translation.pot* file in the *language/* folder in the plugin directory.\n\n* Copy it.\n* Rename it (to your language code).\n* Translate everything.\n* Send it via E-Mail to &lt;Mail [@t] [DennisHoppe](http://DennisHoppe.de) [dot] de&gt;.\n* Thats it. Thank you! =)\n\n= Limitations of the lite version =\nThere are no real limitations in this version except the number of galleries you can organize within the gallery management tool. The maximal number of galleries is limited to three but of course you can use the traditional galleries in your posts and pages *without* any limitations!\n\n\n== Installation ==\n\n= Minimum Requirements =\n\n* WordPress 3.6 or greater\n* PHP version 5.3 or greater\n* MySQL version 5.0 or greater\n\n= Automatic installation =\n\nAutomatic installation is the easiest option as WordPress handles the file transfers itself and you do not need to leave your web browser. To do an automatic install of Fancy Gallery, log in to your WordPress dashboard, navigate to the plugins menu and click \"Add New\".\n\nIn the search field type \"Fancy Gallery\" and click \"Search plugins\". Once you have found my gallery plugin you can view details about it such as the point release, rating and description. Most importantly of course, you can install it by simply clicking \"Install Now\".\n\n= Manual installation =\n\nThe manual installation method involves downloading my gallery plugin and uploading it to your web server via your favorite FTP application. The WordPress codex contains [instructions on how to do this here](http://codex.wordpress.org/Managing_Plugins#Manual_Plugin_Installation).\n\n= Updating =\n\nAutomatic updates should work like a charm; as always though, ensure you backup your site just in case.\n\n\n== Screenshots ==\n01. Gallery single view\n02. Gallery lightbox\n03. Add a new gallery\n04. Manage gallery categories\n05. Edit a category\n06. Edit an image\n07. Integrate your galleries to your navigation menus\n08. Change details of several images\n09. The lightbox settings\n\n== Upgrade Notice ==\nIf you update the plugin from version 1.4.x or lower to version 1.5.x or higher please reactivate the plugin after the update and re-save your options through clicking the \"Save changes\" button at the end of the options page.\n\n\n== Other Notes ==\n\nFancy Gallery is available as [premium plugin](http://dennishoppe.de/en/wordpress-plugins/fancy-gallery) too. In the premium version you can use all options and features which are restricted in the lite version.\n\nPossibly even more important, buying the premium edition gives you access to me and my support team. You can email us your questions about usage of the plugin or your problems in setting it up and we will assist you in no time!\n\n\n== Changelog ==\n\n= 1.5.13 =\n* Fixed: XSS issue in the options page\n* Improved: Options page slug is sanitized now\n* Fixed Settings warning in taxonomy and taxonomy cloud widget\n\n= 1.5.12 =\n* Removed the Install_Template() function\n\n= 1.5.11 =\n* Fixed warning in library import tab\n* Fixed stylesheet in library import tab\n\n= 1.5.10 =\n* Fixed warning in library import tab\n* Fixed warning in featured image meta box\n* Set background color for images meta box to white\n\n= 1.5.9 =\n* Added warning if PHP version is lower than 5.3\n\n= 1.5.8 =\n* Added WPML Workaround for translated post type slugs\n\n= 1.5.7.1 =\n* Added padding style attribute to collage template\n\n= 1.5.7 =\n* Fixed: Undefined post object in the save meta box function\n\n= 1.5.6.1 =\n* Fixed: Made meta box hover texts translatable\n\n= 1.5.6 =\n* Fixed: Gallery items can contain images from other posts.\n\n= 1.5.5 =\n* Added: Classify images within the same post content\n\n= 1.5.4 =\n* Fixed: input name of the meta box fields do not contain backslashes anymore\n* Change: Does not use the image caption as description anymore if the description is not set\n* Patched: permalink for taxonomies were rewritten on plugin activation\n\n= 1.5.3 =\n* Patched HTML5-gallery style sheet to work with older themes\n* Patched Collage gallery template\n* Fixed German translation strings\n\n= 1.5.2 =\n* Removed deprecated jQuery \"live\" function call\n\n= 1.5 =\n* Replaced lightbox with a new responsive one\n* Replaced admin menu icon\n* Completely re-factored PHP code\n\n= 1.4.4 =\n* Fixed the edit image section\n* Made the lightbox library optional\n\n= 1.4.3 =\n* The plugin loads the stylesheets asynchronous now\n\n= 1.4.2 =\n* Added /wp-content/fancy-gallery-templates to the list of template include paths\n\n= 1.4.1 =\n* Updated jQuery Mousewheel to 1.3.11\n* Updated jQuery Livequery to 1.3.6\n* Fixed PHP notice on import tab for images without parent\n\n= 1.4 =\n* Merged jQuery Lightbox repository from 1.3.1 to 1.3.35\n\n= 1.3 =\n* Updated the whole backend and added more valuable features to the lite version\n\n= 1.2.8 =\n* Fixed Warnings on options page\n\n= 1.2.6 =\n* Moved the Register Widget function to the plugin itself\n\n= 1.2.5 =\n* Fixed: gallery shortcode without attributes shows the images of the current post now\n\n= 1.2.4 =\n* Fixed the responsive design of the edit-screen\n\n= 1.2.3 =\n* Patched the Fancy-Fancy template\n\n= 1.2.2 =\n* Made the FancyBox 1.3.4 the default lightbox\n* Changed the structure so you can easily add more other lightboxes\n\n= 1.2.1 =\n* Patched the options page / meta boxes with the old options\n\n= 1.2 =\n* Complete roll back to FancyBox 1.3.4\n* Optional FancyBox 2.x from external CDN\n\n= 1.1.7 =\n* Updated Fancybox JS library to the latest Git Hub state\n* Added Adminbar fix for top control buttons of the lightbox\n\n= 1.1.6 =\n* Updated Fancybox to version 2.1.5:\n* Fixed: Broken slideshow\n* Fixed: Parent option\n* Retina graphics and retina display support\n* Improved \"lock\" feature\n\n= 1.1.5 =\n* Made options page responsive\n\n= 1.1.4 =\n* Added French translation.\n* Merged all styles via SASS to fancybox.css\n* Patched z-index bug for Twenty Eleven theme\n* Patched default template styles\n* Improved Gallery generate code and parameters\n\n= 1.1.3 =\n* Fixed \"Image Order\" problem in manually created galleries.\n\n= 1.1.2 =\n* Improved the \"Import to gallery\" tab\n* removed some deprecated files\n* Fixed image size bug in Thumbnails-Share-Button template\n\n= 1.1.1 =\n* Added overflow style to gallery wrappers\n\n= 1.1 =\n* Fancybox updated, completely rewritten JS\n\n= 1.0.29 =\n* removed clear element from \"Thumbnails only\" template\n\n= 1.0.28 =\n* removed clear element from default template\n\n= 1.0.27 =\n* Fixed Strip_Tags bug in share-button-template\n\n= 1.0.26 =\n* Reordered Template files\n* New Template with share buttons inside the image title\n\n= 1.0.25 =\n* Changed the right image margin of the default gallery template\n* Converted the shortcode in the gallery backend from a <code> element to an <input> field\n\n= 1.0.24 =\n* Made taxonomy slugs translatable.\n\n= 1.0.23 =\n* Added a management column for each taxonomy to the gallery management page\n\n= 1.0.22 =\n* Added some CSS to the default template\n\n= 1.0.21 =\n* Removed column field from the gallery editor\n* Added support for \"orderby\" field in manually created galleries\n\n= 1.0.20 =\n* Added html trim function\n\n= 1.0.19 =\n* Splitted templates in Code and Style\n* improved template output cleaning\n\n= 1.0.18 =\n* Allow URL Slug translation via WPML now\n\n= 1.0.17 =\n* Added WP 3.5 support\n\n= 1.0.16 =\n* Fixed the (Widget) translation bug\n\n= 1.0.15 =\n* Eliminated Backslashes in generated URLs (should work with Windows now)\n\n= 1.0.14 =\n* Changed z-index values for all fancy objects\n* renamed library and stylesheet files\n* fixed IE6/7/8 Bugs\n\n= 1.0.13 =\n* Changed fade-in time of the overlay\n* fixed an IE bug which let the fancy box pop on non-image links\n\n= 1.0.12 =\n* Added Brazilian-Portuguese translation\n\n= 1.0.11 =\n* Updated mouse wheel library\n\n= 1.0 =\n* Everything works fine.\n", "<?php\nNamespace WordPress\\Plugin\\Fancy_Gallery\\Widget;\n\nclass Taxonomies Extends \\WP_Widget {\n  public\n    $arr_options,\n    $core; #  Pointer to the core class\n\n  function __construct(){\n    $this->core = $GLOBALS['WordPress\\Plugin\\Fancy_Gallery\\Core'];\n\n    # Setup the Widget data\n    parent::__construct (\n      'fancy-gallery-taxonomies',\n      $this->t('Gallery taxonomies'),\n      Array('description' => $this->t('Displays your gallery taxonomies like categories, tags, events, photographers, etc.'))\n    );\n  }\n\n  function t ($text, $context = False){\n    return $this->core->t($text, $context);\n  }\n\n  function Default_Options(){\n    # Default settings\n    return Array(\n      'show_count' => False,\n      'number'     => Null,\n      'orderby'    => 'name',\n      'order'      => 'ASC',\n      'exclude'    => False\n    );\n  }\n\n  function Load_Options($options){\n    $options = (Array) $options;\n\n    # Delete empty values\n    ForEach ($options AS $key => $value)\n      If (!$value) Unset($options[$key]);\n\n    # Load options\n    $this->arr_option = Array_Merge ($this->Default_Options(), $options);\n  }\n\n  function Get_Option($key, $default = False){\n    If (IsSet($this->arr_option[$key]) && $this->arr_option[$key])\n      return $this->arr_option[$key];\n    Else\n      return $default;\n  }\n\n  function Set_Option($key, $value){\n    $this->arr_option[$key] = $value;\n  }\n\n  function Form ($settings){\n    # Load options\n    $this->load_options ($settings); Unset ($settings);\n    ?>\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('title') ?>\"><?php _e('Title:') ?></label>\n      <input type=\"text\" id=\"<?php Echo $this->Get_Field_Id('title') ?>\" name=\"<?php Echo $this->Get_Field_Name('title')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('title')) ?>\" class=\"widefat\">\n      <small><?php Echo $this->t('Leave blank to use the widget default title.') ?></small>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\"><?php Echo $this->t('Taxonomy:') ?></label>\n      <select id=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\" name=\"<?php Echo $this->Get_Field_Name('taxonomy') ?>\" class=\"widefat\">\n      <?php ForEach(Get_Object_Taxonomies($this->core->gallery_post_type->name) AS $taxonomy) : $taxonomy = Get_Taxonomy($taxonomy) ?>\n      <option value=\"<?php Echo $taxonomy->name ?>\" <?php Selected($this->get_option('taxonomy'), $taxonomy->name) ?>><?php Echo HTMLSpecialChars($taxonomy->labels->name) ?></option>\n      <?php EndForEach ?>\n      </select><br>\n      <small><?php Echo $this->t('Please choose the Taxonomy the widget should display.') ?></small>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('number') ?>\"><?php Echo $this->t('Number of terms:') ?></label>\n      <input type=\"number\" id=\"<?php Echo $this->Get_Field_Id('number') ?>\" name=\"<?php Echo $this->Get_Field_Name('number')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('number')) ?>\"><br>\n      <small><?php Echo $this->t('Leave blank to show all.') ?></small>\n    </p>\n\n    <p>\n      <label for=\"<?php echo $this->Get_Field_Id('exclude') ?>\"><?php _e('Exclude:') ?></label>\n      <input type=\"text\" value=\"<?php Echo Esc_Attr($this->Get_Option('exclude')) ?>\" name=\"<?php Echo $this->Get_Field_Name('exclude') ?>\" id=\"<?php Echo $this->Get_Field_Id('exclude') ?>\" class=\"widefat\">\n      <small><?php Echo $this->t('Term IDs, separated by commas.') ?></small>\n    </p>\n\n    <p>\n      <input type=\"checkbox\" id=\"<?php Echo $this->Get_Field_Id('count') ?>\" name=\"<?php Echo $this->Get_Field_Name('count') ?>\" <?php Checked($this->Get_Option('count')) ?> >\n      <label for=\"<?php echo $this->Get_Field_Id('count') ?>\"><?php Echo $this->t( 'Show Gallery counts.' ) ?></label>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('orderby') ?>\"><?php Echo $this->t('Order by:') ?></label>\n      <select id=\"<?php Echo $this->Get_Field_Id('orderby') ?>\" name=\"<?php Echo $this->Get_Field_Name('orderby') ?>\" class=\"widefat\">\n      <option value=\"name\" <?php Selected($this->Get_Option('orderby'), 'name') ?>><?php _e('Name') ?></option>\n      <option value=\"count\" <?php Selected($this->Get_Option('orderby'), 'count') ?>><?php Echo $this->t('Gallery Count') ?></option>\n      <option value=\"ID\" <?php Selected($this->Get_Option('orderby'), 'ID') ?>>ID</option>\n      <option value=\"slug\" <?php Selected($this->Get_Option('orderby'), 'slug') ?>><?php Echo $this->t('Slug') ?></option>\n      </select>\n    </p>\n\n    <p>\n      <label for=\"<?php Echo $this->Get_Field_Id('order') ?>\"><?php Echo $this->t('Order:') ?></label>\n      <select id=\"<?php Echo $this->Get_Field_Id('order') ?>\" name=\"<?php Echo $this->Get_Field_Name('order') ?>\" class=\"widefat\">\n      <option value=\"ASC\" <?php Selected($this->Get_Option('order'), 'ASC') ?>><?php _e('Ascending') ?></option>\n      <option value=\"DESC\" <?php Selected($this->Get_Option('order'), 'DESC') ?>><?php _e('Descending') ?></option>\n      </select>\n    </p>\n\n    <?php\n  }\n\n  function Widget ($args, $settings){\n    # Load options\n    $this->Load_Options ($settings); Unset ($settings);\n\n    # Check if the Taxonomy is alive\n    If (!Taxonomy_Exists($this->Get_Option('taxonomy'))) return False;\n\n    # Display Widget\n    Echo $args['before_widget'];\n\n    Echo $args['before_title'] . Apply_Filters('widget_title', $this->Get_Option('title'), $this->arr_option, $this->id_base) . $args['after_title'];\n\n    Echo '<ul>';\n    WP_List_Categories(Array(\n      'taxonomy'   => $this->Get_Option('taxonomy'),\n      'show_count' => $this->Get_Option('count'),\n      'number'     => $this->Get_Option('number'),\n      'order'      => $this->Get_Option('order'),\n      'orderby'    => $this->Get_Option('orderby'),\n      'exclude'    => $this->Get_Option('exclude'),\n      'title_li'   => ''\n    ));\n    Echo '</ul>';\n\n    Echo $args['after_widget'];\n  }\n\n  function Update ($new_settings, $old_settings){\n    return $new_settings;\n  }\n\n}", "<?php\r\nNamespace WordPress\\Plugin\\Fancy_Gallery\\Widget;\r\n\r\nclass Taxonomy_Cloud Extends \\WP_Widget {\r\n  public\r\n    $arr_option,\r\n    $core; #  Pointer to the core class\r\n\r\n  function __construct(){\r\n    $this->core = $GLOBALS['WordPress\\Plugin\\Fancy_Gallery\\Core'];\r\n\r\n    # Setup the Widget data\r\n    parent::__construct (\r\n      'fancy-gallery-taxonomy-cloud',\r\n      $this->t('Gallery taxonomy cloud'),\r\n      Array('description' => $this->t('Displays your gallery taxonomies as tag cloud.'))\r\n    );\r\n  }\r\n\r\n  function t ($text, $context = False){\r\n    return $this->core->t($text, $context);\r\n  }\r\n\r\n  function Default_Options(){\r\n    # Default settings\r\n    return Array(\r\n      'show_count' => False,\r\n      'number'     => 0,\r\n      'orderby'    => 'name',\r\n      'order'      => 'RAND',\r\n      'exclude'    => False\r\n    );\r\n  }\r\n\r\n  function Load_Options($options){\r\n    $options = (Array) $options;\r\n\r\n    # Delete empty values\r\n    ForEach ($options AS $key => $value)\r\n      If (!$value) Unset($options[$key]);\r\n\r\n    # Load options\r\n    $this->arr_option = Array_Merge ($this->Default_Options(), $options);\r\n  }\r\n\r\n  function Get_Option($key, $default = False){\r\n    If (IsSet($this->arr_option[$key]) && $this->arr_option[$key])\r\n      return $this->arr_option[$key];\r\n    Else\r\n      return $default;\r\n  }\r\n\r\n  function Set_Option($key, $value){\r\n    $this->arr_option[$key] = $value;\r\n  }\r\n\r\n  function Form ($settings){\r\n    # Load options\r\n    $this->load_options ($settings); Unset ($settings);\r\n    ?>\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('title') ?>\"><?php _e('Title:') ?></label>\r\n      <input type=\"text\" id=\"<?php Echo $this->Get_Field_Id('title') ?>\" name=\"<?php Echo $this->Get_Field_Name('title')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('title')) ?>\" class=\"widefat\">\r\n      <small><?php Echo $this->t('Leave blank to use the widget default title.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\"><?php Echo $this->t('Taxonomy:') ?></label>\r\n      <select id=\"<?php Echo $this->Get_Field_Id('taxonomy') ?>\" name=\"<?php Echo $this->Get_Field_Name('taxonomy') ?>\" class=\"widefat\">\r\n      <?php ForEach(Get_Object_Taxonomies($this->core->gallery_post_type->name) AS $taxonomy) : $taxonomy = Get_Taxonomy($taxonomy) ?>\r\n      <option value=\"<?php Echo $taxonomy->name ?>\" <?php Selected($this->get_option('taxonomy'), $taxonomy->name) ?>><?php Echo HTMLSpecialChars($taxonomy->labels->name) ?></option>\r\n      <?php EndForEach ?>\r\n      </select><br>\r\n      <small><?php Echo $this->t('Please choose the Taxonomy the widget should display.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('number') ?>\"><?php Echo $this->t('Number of terms:') ?></label>\r\n      <input type=\"number\" id=\"<?php Echo $this->Get_Field_Id('number') ?>\" name=\"<?php Echo $this->Get_Field_Name('number')?>\" value=\"<?php Echo Esc_Attr($this->Get_Option('number')) ?>\"><br>\r\n      <small><?php Echo $this->t('Leave blank to show all.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php echo $this->Get_Field_Id('exclude') ?>\"><?php _e('Exclude:') ?></label>\r\n      <input type=\"text\" value=\"<?php Echo Esc_Attr($this->Get_Option('exclude')) ?>\" name=\"<?php Echo $this->Get_Field_Name('exclude') ?>\" id=\"<?php Echo $this->Get_Field_Id('exclude') ?>\" class=\"widefat\">\r\n      <small><?php Echo $this->t('Term IDs, separated by commas.') ?></small>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('orderby') ?>\"><?php Echo $this->t('Order by:') ?></label>\r\n      <select id=\"<?php Echo $this->Get_Field_Id('orderby') ?>\" name=\"<?php Echo $this->Get_Field_Name('orderby') ?>\" class=\"widefat\">\r\n      <option value=\"name\" <?php Selected($this->Get_Option('orderby'), 'name') ?>><?php _e('Name') ?></option>\r\n      <option value=\"count\" <?php Selected($this->Get_Option('orderby'), 'count') ?>><?php Echo $this->t('Gallery Count') ?></option>\r\n      <option value=\"ID\" <?php Selected($this->Get_Option('orderby'), 'ID') ?>>ID</option>\r\n      <option value=\"slug\" <?php Selected($this->Get_Option('orderby'), 'slug') ?>><?php Echo $this->t('Slug') ?></option>\r\n      </select>\r\n    </p>\r\n\r\n    <p>\r\n      <label for=\"<?php Echo $this->Get_Field_Id('order') ?>\"><?php Echo $this->t('Order:') ?></label>\r\n      <select id=\"<?php Echo $this->Get_Field_Id('order') ?>\" name=\"<?php Echo $this->Get_Field_Name('order') ?>\" class=\"widefat\">\r\n      <option value=\"ASC\" <?php Selected($this->Get_Option('order'), 'ASC') ?>><?php _e('Ascending') ?></option>\r\n      <option value=\"DESC\" <?php Selected($this->Get_Option('order'), 'DESC') ?>><?php _e('Descending') ?></option>\r\n      </select>\r\n    </p>\r\n\r\n    <?php\r\n  }\r\n\r\n  function Widget ($args, $settings){\r\n    # Load options\r\n    $this->load_options ($settings); Unset ($settings);\r\n\r\n    # Check if the Taxonomy is alive\r\n    If (!Taxonomy_Exists($this->Get_Option('taxonomy'))) return False;\r\n\r\n    # Display Widget\r\n    Echo $args['before_widget'];\r\n\r\n    Echo $args['before_title'] . Apply_Filters('widget_title', $this->get_option('title'), $this->arr_option, $this->id_base) . $args['after_title'];\r\n\r\n    Echo '<ul>';\r\n    WP_Tag_Cloud(Array(\r\n      'taxonomy' => $this->Get_Option('taxonomy'),\r\n      'number'   => $this->Get_Option('number'),\r\n      'order'    => $this->Get_Option('order'),\r\n      'orderby'  => $this->Get_Option('orderby'),\r\n      'exclude'  => $this->Get_Option('exclude')\r\n    ));\r\n    Echo '</ul>';\r\n\r\n    Echo $args['after_widget'];\r\n  }\r\n\r\n  function Update ($new_settings, $old_settings){\r\n    return $new_settings;\r\n  }\r\n\r\n}"], "filenames": ["assets/js/fancy-gallery.js", "class.options.php", "plugin.php", "readme.txt", "widget.taxonomies.php", "widget.taxonomy-cloud.php"], "buggy_code_start_loc": [59, 6, 6, 170, 5, 5], "buggy_code_end_loc": [60, 61, 7, 170, 124, 119], "fixing_code_start_loc": [59, 7, 6, 171, 5, 5], "fixing_code_end_loc": [60, 63, 7, 176, 126, 121], "type": "CWE-79", "message": "A vulnerability was found in Fancy Gallery Plugin 1.5.12. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file class.options.php of the component Options Page. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 1.5.13 is able to address this issue. The name of the patch is fdf1f9e5a1ec738900f962e69c6fa4ec6055ed8d. It is recommended to upgrade the affected component. The identifier VDB-225349 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2014-125096", "sourceIdentifier": "cna@vuldb.com", "published": "2023-04-10T03:15:07.040", "lastModified": "2023-04-13T19:51:24.907", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in Fancy Gallery Plugin 1.5.12. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file class.options.php of the component Options Page. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 1.5.13 is able to address this issue. The name of the patch is fdf1f9e5a1ec738900f962e69c6fa4ec6055ed8d. It is recommended to upgrade the affected component. The identifier VDB-225349 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fancy_gallery_project:fancy_gallery:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.5.13", "matchCriteriaId": "CD99F4D3-2719-4ABD-A59C-47B853848CD1"}]}]}], "references": [{"url": "https://github.com/wp-plugins/fancy-gallery/commit/fdf1f9e5a1ec738900f962e69c6fa4ec6055ed8d", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.225349", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.225349", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/fancy-gallery/commit/fdf1f9e5a1ec738900f962e69c6fa4ec6055ed8d"}}