{"buggy_code": ["{**\n * templates/frontend/pages/submissions.tpl\n *\n * Copyright (c) 2014-2021 Simon Fraser University\n * Copyright (c) 2003-2021 John Willinsky\n * Distributed under the GNU GPL v3. For full terms see the file docs/COPYING.\n *\n * @brief Display the page to view the editorial team.\n *\n * @uses $currentContext Journal|Press The current journal or press\n * @uses $submissionChecklist array List of requirements for submissions\n *}\n{include file=\"frontend/components/header.tpl\" pageTitle=\"about.submissions\"}\n\n<div class=\"page page_submissions\">\n\t{include file=\"frontend/components/breadcrumbs.tpl\" currentTitleKey=\"about.submissions\"}\n\t<h1>\n\t\t{translate key=\"about.submissions\"}\n\t</h1>\n\n\t<div class=\"cmp_notification\">\n\t\t{if $sections|@count == 0 || $currentContext->getData('disableSubmissions')}\n\t\t\t{translate key=\"author.submit.notAccepting\"}\n\t\t{else}\n\t\t\t{if $isUserLoggedIn}\n\t\t\t\t{capture assign=\"newSubmission\"}<a href=\"{url page=\"submission\" op=\"wizard\"}\">{translate key=\"about.onlineSubmissions.newSubmission\"}</a>{/capture}\n\t\t\t\t{capture assign=\"viewSubmissions\"}<a href=\"{url page=\"submissions\"}\">{translate key=\"about.onlineSubmissions.viewSubmissions\"}</a>{/capture}\n\t\t\t\t\t{translate key=\"about.onlineSubmissions.submissionActions\" newSubmission=$newSubmission viewSubmissions=$viewSubmissions}\n\t\t\t{else}\n\t\t\t\t{capture assign=\"login\"}<a href=\"{url page=\"login\"}\">{translate key=\"about.onlineSubmissions.login\"}</a>{/capture}\n\t\t\t\t{capture assign=\"register\"}<a href=\"{url page=\"user\" op=\"register\"}\">{translate key=\"about.onlineSubmissions.register\"}</a>{/capture}\n\t\t\t\t\t{translate key=\"about.onlineSubmissions.registrationRequired\" login=$login register=$register}\n\t\t\t{/if}\n\t\t{/if}\n\t</div>\n\n\t{if $submissionChecklist}\n\t\t<div class=\"submission_checklist\">\n\t\t\t<h2>\n\t\t\t\t{translate key=\"about.submissionPreparationChecklist\"}\n\t\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"workflow\" anchor=\"submission/submissionChecklist\" sectionTitleKey=\"about.submissionPreparationChecklist\"}\n\t\t\t</h2>\n\t\t\t{translate key=\"about.submissionPreparationChecklist.description\"}\n\t\t\t<ul>\n\t\t\t\t{foreach from=$submissionChecklist item=checklistItem}\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span class=\"fa fa-check\" aria-hidden=\"true\"></span>\n\t\t\t\t\t\t{$checklistItem.content|nl2br}\n\t\t\t\t\t</li>\n\t\t\t\t{/foreach}\n\t\t\t</ul>\n\t\t</div>\n\t{/if}\n\n\t{if $currentContext->getLocalizedData('authorGuidelines')}\n\t<div class=\"author_guidelines\" id=\"authorGuidelines\">\n\t\t<h2>\n\t\t\t{translate key=\"about.authorGuidelines\"}\n\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"workflow\" anchor=\"submission/authorGuidelines\" sectionTitleKey=\"about.authorGuidelines\"}\n\t\t</h2>\n\t\t{$currentContext->getLocalizedData('authorGuidelines')}\n\t</div>\n\t{/if}\n\n\t{foreach from=$sections item=\"section\"}\n\t\t{if $section->getLocalizedPolicy()}\n\t\t\t<div class=\"section_policy\">\n\t\t\t\t<h2>{$section->getLocalizedTitle()|escape}</h2>\n\t\t\t\t{$section->getLocalizedPolicy()}\n\t\t\t\t{if $isUserLoggedIn}\n\t\t\t\t\t{capture assign=\"sectionSubmissionUrl\"}{url page=\"submission\" op=\"wizard\" sectionId=$section->getId()}{/capture}\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{translate key=\"about.onlineSubmissions.submitToSection\" name=$section->getLocalizedTitle() url=$sectionSubmissionUrl}\n\t\t\t\t\t</p>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t{/foreach}\n\n\t{if $currentContext->getLocalizedData('copyrightNotice')}\n\t\t<div class=\"copyright_notice\">\n\t\t\t<h2>\n\t\t\t\t{translate key=\"about.copyrightNotice\"}\n\t\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"workflow\" anchor=\"submission/authorGuidelines\" sectionTitleKey=\"about.copyrightNotice\"}\n\t\t\t</h2>\n\t\t\t{$currentContext->getLocalizedData('copyrightNotice')}\n\t\t</div>\n\t{/if}\n\n\t{if $currentContext->getLocalizedData('privacyStatement')}\n\t<div class=\"privacy_statement\" id=\"privacyStatement\">\n\t\t<h2>\n\t\t\t{translate key=\"about.privacyStatement\"}\n\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"website\" anchor=\"setup/privacy\" sectionTitleKey=\"about.privacyStatement\"}\n\t\t</h2>\n\t\t{$currentContext->getLocalizedData('privacyStatement')}\n\t</div>\n\t{/if}\n\n</div><!-- .page -->\n\n{include file=\"frontend/components/footer.tpl\"}\n"], "fixing_code": ["{**\n * templates/frontend/pages/submissions.tpl\n *\n * Copyright (c) 2014-2021 Simon Fraser University\n * Copyright (c) 2003-2021 John Willinsky\n * Distributed under the GNU GPL v3. For full terms see the file docs/COPYING.\n *\n * @brief Display the page to view the editorial team.\n *\n * @uses $currentContext Journal|Press The current journal or press\n * @uses $submissionChecklist array List of requirements for submissions\n *}\n{include file=\"frontend/components/header.tpl\" pageTitle=\"about.submissions\"}\n\n<div class=\"page page_submissions\">\n\t{include file=\"frontend/components/breadcrumbs.tpl\" currentTitleKey=\"about.submissions\"}\n\t<h1>\n\t\t{translate key=\"about.submissions\"}\n\t</h1>\n\n\t<div class=\"cmp_notification\">\n\t\t{if $sections|@count == 0 || $currentContext->getData('disableSubmissions')}\n\t\t\t{translate key=\"author.submit.notAccepting\"}\n\t\t{else}\n\t\t\t{if $isUserLoggedIn}\n\t\t\t\t{capture assign=\"newSubmission\"}<a href=\"{url page=\"submission\" op=\"wizard\"}\">{translate key=\"about.onlineSubmissions.newSubmission\"}</a>{/capture}\n\t\t\t\t{capture assign=\"viewSubmissions\"}<a href=\"{url page=\"submissions\"}\">{translate key=\"about.onlineSubmissions.viewSubmissions\"}</a>{/capture}\n\t\t\t\t\t{translate key=\"about.onlineSubmissions.submissionActions\" newSubmission=$newSubmission viewSubmissions=$viewSubmissions}\n\t\t\t{else}\n\t\t\t\t{capture assign=\"login\"}<a href=\"{url page=\"login\"}\">{translate key=\"about.onlineSubmissions.login\"}</a>{/capture}\n\t\t\t\t{capture assign=\"register\"}<a href=\"{url page=\"user\" op=\"register\"}\">{translate key=\"about.onlineSubmissions.register\"}</a>{/capture}\n\t\t\t\t\t{translate key=\"about.onlineSubmissions.registrationRequired\" login=$login register=$register}\n\t\t\t{/if}\n\t\t{/if}\n\t</div>\n\n\t{if $submissionChecklist}\n\t\t<div class=\"submission_checklist\">\n\t\t\t<h2>\n\t\t\t\t{translate key=\"about.submissionPreparationChecklist\"}\n\t\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"workflow\" anchor=\"submission/submissionChecklist\" sectionTitleKey=\"about.submissionPreparationChecklist\"}\n\t\t\t</h2>\n\t\t\t{translate key=\"about.submissionPreparationChecklist.description\"}\n\t\t\t<ul>\n\t\t\t\t{foreach from=$submissionChecklist item=checklistItem}\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<span class=\"fa fa-check\" aria-hidden=\"true\"></span>\n\t\t\t\t\t\t{$checklistItem.content|nl2br}\n\t\t\t\t\t</li>\n\t\t\t\t{/foreach}\n\t\t\t</ul>\n\t\t</div>\n\t{/if}\n\n\t{if $currentContext->getLocalizedData('authorGuidelines')}\n\t<div class=\"author_guidelines\" id=\"authorGuidelines\">\n\t\t<h2>\n\t\t\t{translate key=\"about.authorGuidelines\"}\n\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"workflow\" anchor=\"submission/authorGuidelines\" sectionTitleKey=\"about.authorGuidelines\"}\n\t\t</h2>\n\t\t{$currentContext->getLocalizedData('authorGuidelines')}\n\t</div>\n\t{/if}\n\n\t{foreach from=$sections item=\"section\"}\n\t\t{if $section->getLocalizedPolicy()}\n\t\t\t<div class=\"section_policy\">\n\t\t\t\t<h2>{$section->getLocalizedTitle()|escape}</h2>\n\t\t\t\t{$section->getLocalizedPolicy()}\n\t\t\t\t{if $isUserLoggedIn}\n\t\t\t\t\t{capture assign=\"sectionSubmissionUrl\"}{url page=\"submission\" op=\"wizard\" sectionId=$section->getId()}{/capture}\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{translate key=\"about.onlineSubmissions.submitToSection\" name=$section->getLocalizedTitle()|escape url=$sectionSubmissionUrl}\n\t\t\t\t\t</p>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/if}\n\t{/foreach}\n\n\t{if $currentContext->getLocalizedData('copyrightNotice')}\n\t\t<div class=\"copyright_notice\">\n\t\t\t<h2>\n\t\t\t\t{translate key=\"about.copyrightNotice\"}\n\t\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"workflow\" anchor=\"submission/authorGuidelines\" sectionTitleKey=\"about.copyrightNotice\"}\n\t\t\t</h2>\n\t\t\t{$currentContext->getLocalizedData('copyrightNotice')}\n\t\t</div>\n\t{/if}\n\n\t{if $currentContext->getLocalizedData('privacyStatement')}\n\t<div class=\"privacy_statement\" id=\"privacyStatement\">\n\t\t<h2>\n\t\t\t{translate key=\"about.privacyStatement\"}\n\t\t\t{include file=\"frontend/components/editLink.tpl\" page=\"management\" op=\"settings\" path=\"website\" anchor=\"setup/privacy\" sectionTitleKey=\"about.privacyStatement\"}\n\t\t</h2>\n\t\t{$currentContext->getLocalizedData('privacyStatement')}\n\t</div>\n\t{/if}\n\n</div><!-- .page -->\n\n{include file=\"frontend/components/footer.tpl\"}\n"], "filenames": ["templates/frontend/pages/submissions.tpl"], "buggy_code_start_loc": [73], "buggy_code_end_loc": [74], "fixing_code_start_loc": [73], "fixing_code_end_loc": [74], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository pkp/pkp-lib prior to 3.3.0-16.", "other": {"cve": {"id": "CVE-2023-5903", "sourceIdentifier": "security@huntr.dev", "published": "2023-11-07T04:24:32.357", "lastModified": "2023-11-13T15:21:27.970", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository pkp/pkp-lib prior to 3.3.0-16."}, {"lang": "es", "value": "Cross-Site Scripting (XSS) Almacenado en el repositorio de GitHub pkp/pkp-lib anterior a 3.3.0-16."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.7, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sfu:pkp_web_application_library:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.3.0-15", "matchCriteriaId": "EFB5FA1A-644F-4BC0-8ADD-22F75D67F7E5"}]}]}], "references": [{"url": "https://github.com/pkp/pkp-lib/commit/8b26ee404af3b11803a40e904f985f0a0b215a5c", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.com/bounties/5c147ff8-3cc4-4f21-9f1c-13fd50957dad", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/pkp/pkp-lib/commit/8b26ee404af3b11803a40e904f985f0a0b215a5c"}}