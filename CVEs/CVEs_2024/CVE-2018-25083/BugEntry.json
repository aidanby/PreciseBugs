{"buggy_code": ["{\n  \"name\": \"pullit\",\n  \"version\": \"1.3.0\",\n  \"description\": \"Display and pull branches from GitHub pull requests\",\n  \"main\": \"src/index.js\",\n  \"preferGlobal\": true,\n  \"scripts\": {\n    \"start\": \"node src/index.js\",\n    \"test\": \"jest\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/jkup/pullit.git\"\n  },\n  \"keywords\": [\n    \"github\",\n    \"pull\",\n    \"request\",\n    \"pr\",\n    \"cli\"\n  ],\n  \"author\": \"Jon Kuperman\",\n  \"license\": \"MIT\",\n  \"bin\": {\n    \"pullit\": \"./bin/pullit.js\"\n  },\n  \"bugs\": {\n    \"url\": \"https://github.com/jkup/pullit/issues\"\n  },\n  \"homepage\": \"https://github.com/jkup/pullit#readme\",\n  \"devDependencies\": {\n    \"jest\": \"^21.1.0\",\n    \"proxyquire\": \"^1.8.0\"\n  },\n  \"dependencies\": {\n    \"github\": \"^11.0.0\",\n    \"parse-github-repo-url\": \"^1.4.1\",\n    \"terminal-menu\": \"^2.1.1\"\n  },\n  \"jest\": {\n    \"collectCoverageFrom\": [\n      \"src/**/*.js\"\n    ],\n    \"testEnvironment\": \"node\",\n    \"modulePathIgnorePatterns\": [\n      \"__tests__/fixtures/\"\n    ],\n    \"testPathIgnorePatterns\": [\n      \"__tests__/fixtures/\"\n    ]\n  }\n}", "const GitHubApi = require('github');\nconst Menu = require('terminal-menu');\nconst {\n  execSync\n} = require('child_process');\nconst parse = require('parse-github-repo-url');\n\nclass Pullit {\n  constructor() {\n    this.init();\n    this.github = new GitHubApi({});\n  }\n\n  init() {\n    const url = execSync(`git config --get remote.origin.url`, {\n      encoding: 'utf8'\n    }).trim();\n\n    return this.parsedGithubUrl(url);\n  }\n\n  parsedGithubUrl(url) {\n    const parsedUrl = parse(url);\n\n    (this.owner = parsedUrl[0]), (this.repo = parsedUrl[1]);\n  }\n\n  fetch(id) {\n    return this.github.pullRequests\n      .get({\n        owner: this.owner,\n        repo: this.repo,\n        number: id\n      })\n      .then(res => {\n        const branch = res.data.head.ref;\n        execSync(\n          `git fetch origin pull/${id}/head:${branch} && git checkout ${branch}`\n        );\n      })\n      .catch(err => {\n        console.log('Error: Could not find the specified pull request.');\n      });\n  }\n\n  fetchRequests() {\n    return this.github.pullRequests.getAll({\n      owner: this.owner,\n      repo: this.repo\n    });\n  }\n\n  display() {\n    this.fetchRequests().then(results => {\n      const menu = Menu({\n       width: process.stdout.columns - 4,\n        x: 0,\n        y: 2\n      });\n      menu.reset();\n      menu.write('Currently open pull requests:\\n');\n      menu.write('-------------------------\\n');\n\n      results.data.forEach(element => {\n        menu.add(`${element.number} - ${element.title} - ${element.head.user.login}`);\n      });\n\n      menu.add(`Exit`);\n\n      menu.on('select', label => {\n        menu.close();\n        this.fetch(label.split(' ')[0]);\n      });\n      process.stdin.pipe(menu.createStream()).pipe(process.stdout);\n\n      process.stdin.setRawMode(true);\n      menu.on('close', () => {\n        process.stdin.setRawMode(false);\n        process.stdin.end();\n      });\n    }).catch(err => {\n      console.log('Error: could not display pull requests. Please make sure this is a valid repository.')\n    });\n  }\n}\n\nmodule.exports = Pullit;\n"], "fixing_code": ["{\n  \"name\": \"pullit\",\n  \"version\": \"1.4.0\",\n  \"description\": \"Display and pull branches from GitHub pull requests\",\n  \"main\": \"src/index.js\",\n  \"preferGlobal\": true,\n  \"scripts\": {\n    \"start\": \"node src/index.js\",\n    \"test\": \"jest\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/jkup/pullit.git\"\n  },\n  \"keywords\": [\"github\", \"pull\", \"request\", \"pr\", \"cli\"],\n  \"author\": \"Jon Kuperman\",\n  \"license\": \"MIT\",\n  \"bin\": {\n    \"pullit\": \"./bin/pullit.js\"\n  },\n  \"bugs\": {\n    \"url\": \"https://github.com/jkup/pullit/issues\"\n  },\n  \"homepage\": \"https://github.com/jkup/pullit#readme\",\n  \"devDependencies\": {\n    \"jest\": \"^21.1.0\",\n    \"proxyquire\": \"^1.8.0\"\n  },\n  \"dependencies\": {\n    \"github\": \"^11.0.0\",\n    \"parse-github-repo-url\": \"^1.4.1\",\n    \"terminal-menu\": \"^2.1.1\"\n  },\n  \"jest\": {\n    \"collectCoverageFrom\": [\"src/**/*.js\"],\n    \"testEnvironment\": \"node\",\n    \"modulePathIgnorePatterns\": [\"__tests__/fixtures/\"],\n    \"testPathIgnorePatterns\": [\"__tests__/fixtures/\"]\n  }\n}\n", "const GitHubApi = require(\"github\");\nconst Menu = require(\"terminal-menu\");\nconst { execFileSync } = require(\"child_process\");\nconst parse = require(\"parse-github-repo-url\");\n\nclass Pullit {\n  constructor() {\n    this.init();\n    this.github = new GitHubApi({});\n  }\n\n  init() {\n    const url = execFileSync(\"git\", [\"config\", \"--get\", \"remote.origin.url\"], {\n      encoding: \"utf8\"\n    }).trim();\n\n    return this.parsedGithubUrl(url);\n  }\n\n  parsedGithubUrl(url) {\n    const parsedUrl = parse(url);\n\n    (this.owner = parsedUrl[0]), (this.repo = parsedUrl[1]);\n  }\n\n  fetch(id) {\n    return this.github.pullRequests\n      .get({\n        owner: this.owner,\n        repo: this.repo,\n        number: id\n      })\n      .then(res => {\n        const branch = res.data.head.ref;\n        execFileSync(\"git\", [\"fetch\", \"origin\", `pull/${id}/head:${branch}`]);\n        execFileSync(\"git\", [\"checkout\", branch]);\n      })\n      .catch(err => {\n        console.log(\"Error: Could not find the specified pull request.\");\n      });\n  }\n\n  fetchRequests() {\n    return this.github.pullRequests.getAll({\n      owner: this.owner,\n      repo: this.repo\n    });\n  }\n\n  display() {\n    this.fetchRequests()\n      .then(results => {\n        const menu = Menu({\n          width: process.stdout.columns - 4,\n          x: 0,\n          y: 2\n        });\n        menu.reset();\n        menu.write(\"Currently open pull requests:\\n\");\n        menu.write(\"-------------------------\\n\");\n\n        results.data.forEach(element => {\n          menu.add(\n            `${element.number} - ${element.title} - ${element.head.user.login}`\n          );\n        });\n\n        menu.add(`Exit`);\n\n        menu.on(\"select\", label => {\n          menu.close();\n          this.fetch(label.split(\" \")[0]);\n        });\n        process.stdin.pipe(menu.createStream()).pipe(process.stdout);\n\n        process.stdin.setRawMode(true);\n        menu.on(\"close\", () => {\n          process.stdin.setRawMode(false);\n          process.stdin.end();\n        });\n      })\n      .catch(err => {\n        console.log(\n          \"Error: could not display pull requests. Please make sure this is a valid repository.\"\n        );\n      });\n  }\n}\n\nmodule.exports = Pullit;\n"], "filenames": ["package.json", "src/index.js"], "buggy_code_start_loc": [3, 1], "buggy_code_end_loc": [53, 84], "fixing_code_start_loc": [3, 1], "fixing_code_end_loc": [41, 86], "type": "CWE-78", "message": "The pullit package before 1.4.0 for Node.js allows OS Command Injection because eval is used on an attacker-supplied Git branch name.", "other": {"cve": {"id": "CVE-2018-25083", "sourceIdentifier": "cve@mitre.org", "published": "2023-03-27T03:15:07.103", "lastModified": "2023-03-31T00:21:54.407", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "The pullit package before 1.4.0 for Node.js allows OS Command Injection because eval is used on an attacker-supplied Git branch name."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pull_it_project:pull_it:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "1.4.0", "matchCriteriaId": "3791B0C1-B4CE-48C2-8857-BF683C4AFED7"}]}]}], "references": [{"url": "https://github.com/jkup/pullit/commit/4fec455774ee08f4dce0ef2ef934ffcc37219bfb", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://security.snyk.io/vuln/npm:pullit:20180214", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/jkup/pullit/commit/4fec455774ee08f4dce0ef2ef934ffcc37219bfb"}}