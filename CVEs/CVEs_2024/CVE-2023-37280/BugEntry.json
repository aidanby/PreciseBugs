{"buggy_code": ["{% extends '@PimcoreAdmin/admin/login/layout.html.twig' %}\n\n{% block content %}\n    {% if error is defined %}\n        <div class=\"text error\">\n            {{ error|trans([],'admin')|raw }}\n        </div>\n    {% else %}\n        <div class=\"text info\">\n            {{ 'Enter your verification code'|trans([],'admin') }}\n        </div>\n    {% endif %}\n\n    <div>\n        <img src=\"{{ image }}\"/>\n        <p>{{ '2fa_alert_text'|trans([], 'admin')|raw }}</p>\n    </div>\n\n    <form method=\"post\" action=\"{{ path('pimcore_admin_2fa_setup') }}\">\n        <input name=\"_auth_code\" id=\"_auth_code\" autocomplete=\"one-time-code\" type=\"password\" placeholder=\"{{ '2fa_code'|trans([],'admin') }}\" required autofocus>\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken(app.request.session) }}\">\n\n        <button type=\"submit\">{{ 'Login'|trans([],'admin') }}</button>\n    </form>\n\n    <form id=\"pimcore_logout_form\" method=\"post\" action=\"{{ path('pimcore_admin_logout') }}\">\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken(app.request.session) }}\">\n        <a id=\"pimcore_logout\" href=\"#\">{{ 'Back to Login'|trans([],'admin') }}</a>\n    </form>\n\n\n\n    {{ pimcore_breach_attack_random_content() }}\n{% endblock %}\n\n{% block below_footer %}\n    <script {{ pimcore_csp.getNonceHtmlAttribute()|raw }}>\n        document.getElementById('pimcore_logout').addEventListener('click', function () {\n            document.getElementById('pimcore_logout_form').submit();\n        });\n    </script>\n{% endblock %}\n"], "fixing_code": ["{% extends '@PimcoreAdmin/admin/login/layout.html.twig' %}\n\n{% block content %}\n    {% if error is defined %}\n        <div class=\"text error\">\n            {{ error|trans([],'admin') }}\n        </div>\n    {% else %}\n        <div class=\"text info\">\n            {{ 'Enter your verification code'|trans([],'admin') }}\n        </div>\n    {% endif %}\n\n    <div>\n        <img src=\"{{ image }}\"/>\n        <p>{{ '2fa_alert_text'|trans([], 'admin')|raw }}</p>\n    </div>\n\n    <form method=\"post\" action=\"{{ path('pimcore_admin_2fa_setup') }}\">\n        <input name=\"_auth_code\" id=\"_auth_code\" autocomplete=\"one-time-code\" type=\"password\" placeholder=\"{{ '2fa_code'|trans([],'admin') }}\" required autofocus>\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken(app.request.session) }}\">\n\n        <button type=\"submit\">{{ 'Login'|trans([],'admin') }}</button>\n    </form>\n\n    <form id=\"pimcore_logout_form\" method=\"post\" action=\"{{ path('pimcore_admin_logout') }}\">\n        <input type=\"hidden\" name=\"csrfToken\" value=\"{{ pimcore_csrf.getCsrfToken(app.request.session) }}\">\n        <a id=\"pimcore_logout\" href=\"#\">{{ 'Back to Login'|trans([],'admin') }}</a>\n    </form>\n\n\n\n    {{ pimcore_breach_attack_random_content() }}\n{% endblock %}\n\n{% block below_footer %}\n    <script {{ pimcore_csp.getNonceHtmlAttribute()|raw }}>\n        document.getElementById('pimcore_logout').addEventListener('click', function () {\n            document.getElementById('pimcore_logout_form').submit();\n        });\n    </script>\n{% endblock %}\n"], "filenames": ["templates/admin/login/two_factor_setup.html.twig"], "buggy_code_start_loc": [6], "buggy_code_end_loc": [7], "fixing_code_start_loc": [6], "fixing_code_end_loc": [7], "type": "CWE-79", "message": "Pimcore Admin Classic Bundle provides a Backend UI for Pimcore based on the ExtJS framework. An admin who has not setup two factor authentication before is vulnerable for this attack, without need for any form of privilege, causing the application to execute arbitrary scripts/HTML content. This vulnerability has been patched in version 1.0.3.", "other": {"cve": {"id": "CVE-2023-37280", "sourceIdentifier": "security-advisories@github.com", "published": "2023-07-11T19:15:09.687", "lastModified": "2023-07-19T18:31:42.580", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Pimcore Admin Classic Bundle provides a Backend UI for Pimcore based on the ExtJS framework. An admin who has not setup two factor authentication before is vulnerable for this attack, without need for any form of privilege, causing the application to execute arbitrary scripts/HTML content. This vulnerability has been patched in version 1.0.3."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pimcore:admin_classic_bundle:*:*:*:*:*:pimcore:*:*", "versionEndExcluding": "1.0.3", "matchCriteriaId": "73604DE7-60DC-4BCC-87F1-734915ADBC62"}]}]}], "references": [{"url": "https://github.com/pimcore/admin-ui-classic-bundle/commit/5fcd19bdc89a3fe4cb8ad8c356590e1e4740c743", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/pimcore/admin-ui-classic-bundle/pull/147", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/pimcore/admin-ui-classic-bundle/security/advisories/GHSA-hqv9-6jqw-9g8m", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/pimcore/admin-ui-classic-bundle/commit/5fcd19bdc89a3fe4cb8ad8c356590e1e4740c743"}}