{"buggy_code": ["<?php\n$config = array(\n\t'debug'            => 0,\n\t'Security'         =>\n\t\tarray(\n\t\t\t'level'      => 'medium',\n\t\t\t'salt'       => '',\n\t\t\t'cipherSeed' => '',\n\t\t\t//'auth'=>array('CertAuth.Certificate'), // additional authentication methods\n\t\t\t//'auth'=>array('ShibbAuth.ApacheShibb'),\n\t\t),\n\t'MISP'             =>\n\t\tarray(\n\t\t\t'baseurl'                        => '',\n\t\t\t'footermidleft'                  => '',\n\t\t\t'footermidright'                 => '',\n\t\t\t'org'                            => 'ORGNAME',\n\t\t\t'showorg'                        => true,\n\t\t\t'threatlevel_in_email_subject'   => true,\n            'email_subject_TLP_string'       => 'tlp:amber',\n\t\t\t'email_subject_tag'              => 'tlp',\n\t\t\t'email_subject_include_tag_name' => true,\n\t\t\t'background_jobs'                => true,\n\t\t\t'cached_attachments'             => true,\n\t\t\t'osuser'                         => 'www-data',\n\t\t\t'email'                          => 'email@address.com',\n\t\t\t'contact'                        => 'email@address.com',\n\t\t\t'cveurl'                         => 'https://cve.circl.lu/cve/',\n\t\t\t'cweurl'                         => 'https://cve.circl.lu/cwe/',\n\t\t\t'disablerestalert'               => false,\n\t\t\t'default_event_distribution'     => '1',\n\t\t\t'default_attribute_distribution' => 'event',\n\t\t\t'tagging'                        => true,\n\t\t\t'full_tags_on_event_index'       => true,\n\t\t\t'attribute_tagging'              => true,\n\t\t\t'full_tags_on_attribute_index'   => true,\n\t\t\t'footer_logo'                    => '',\n\t\t\t'take_ownership_xml_import'      => false,\n\t\t\t'unpublishedprivate'             => false,\n\t\t\t'disable_emailing'               => false,\n\t\t\t'manage_workers'                 => true,\n\t\t\t'Attributes_Values_Filter_In_Event' => 'id, uuid, value, comment, type, category, Tag.name',\n\t\t),\n\t'GnuPG'            =>\n\t\tarray(\n\t\t\t'onlyencrypted'     => false,\n\t\t\t'email'             => '',\n\t\t\t'homedir'           => '',\n\t\t\t'password'          => '',\n            'bodyonlyencrypted' => false,\n            'sign'              => true,\n            'obscure_subject'   => false,\n\t\t),\n\t'SMIME'            =>\n\t\tarray(\n\t\t\t'enabled'          => false,\n\t\t\t'email'            => '',\n\t\t\t'cert_public_sign' => '',\n\t\t\t'key_sign'         => '',\n\t\t\t'password'         => '',\n\t\t),\n\t'Proxy'            =>\n\t\tarray(\n\t\t\t'host'     => '',\n\t\t\t'port'     => '',\n\t\t\t'method'   => '',\n\t\t\t'user'     => '',\n\t\t\t'password' => '',\n\t\t),\n\t'SecureAuth'       =>\n\t\tarray(\n\t\t\t'amount' => 5,\n\t\t\t'expire' => 300,\n\t\t),\n\t// Uncomment the following to enable client SSL certificate authentication\n\t/*\n\t'CertAuth'         =>\n\t\tarray(\n\n\t\t\t// CA\n\t\t\t'ca'           => array('FIRST.Org'), // List of CAs authorized\n\t\t\t'caId'         => 'O',          // Certificate field used to verify the CA. In this example, the field O (organization) of the client certificate has to equal to 'FIRST.Org' in order to validate the CA\n\n\t\t\t// User/client configuration\n\t\t\t'userModel'    => 'User',       // name of the User class (MISP class) to check if the user exists\n\t\t\t'userModelKey' => 'email',      // User field that will be used for querying. In this example, the field email of the MISP accounts will be used to search if the user exists.\n\t\t\t'map'          => array(        // maps client certificate attributes to User properties. This map will be used as conditions to find if the user exists. In this example, the client certificate fields 'O' (organization) and 'emailAddress' have to match with the MISP fields 'org' and 'email' to validate the user.\n\t\t\t\t'O'            => 'org',\n\t\t\t\t'emailAddress' => 'email',\n\t\t\t),\n\n\t\t\t// Synchronization/RestAPI\n\t\t\t'syncUser'     => true,         // should the User be synchronized with an external REST API\n\t\t\t'userDefaults' => array(          // default user attributes, only used when creating new users. By default, new users are \"Read only\" users (role_id: 6).\n\t\t\t\t'role_id' => 6,\n\t\t\t),\n\t\t\t'restApi'      => array(        // API parameters\n\t\t\t\t'url'     => 'https://example.com/data/users',  // URL to query\n\t\t\t\t'headers' => array(),                           // additional headers, used for authentication\n\t\t\t\t'param'   => array('email' => 'email'),       // query parameters to add to the URL, mapped to User properties\n\t\t\t\t'map'     => array(                            // maps REST result to the User properties\n\t\t\t\t\t'uid'        => 'nids_sid',\n\t\t\t\t\t'team'       => 'org',\n\t\t\t\t\t'email'      => 'email',\n\t\t\t\t\t'pgp_public' => 'gpgkey',\n\t\t\t\t),\n\t\t\t),\n\t\t\t'userDefaults' => array('role_id' => 6),          // default attributes for new users. By default, new users are \"Read only\" users (role_id: 6).\n\t\t),\n\t*/\n\t/*\n\t'ApacheShibbAuth'  =>                      // Configuration for shibboleth authentication\n\t\tarray(\n\t\t\t'apacheEnv'         => 'REMOTE_USER',        // If proxy variable = HTTP_REMOTE_USER\n\t\t\t'MailTag'           => 'EMAIL_TAG',\n\t\t\t'OrgTag'            => 'FEDERATION_TAG',\n\t\t\t'GroupTag'          => 'GROUP_TAG',\n\t\t\t'GroupSeparator'    => ';',\n\t\t\t'GroupRoleMatching' => array(                // 3:User, 1:admin. May be good to set \"1\" for the first user\n\t\t\t\t'group_three' => 3,\n\t\t\t\t'group_two'   => 2,\n\t\t\t\t'group_one'   => 1,\n\t\t\t),\n\t\t\t'DefaultOrg'        => 'DEFAULT_ORG',\n\t\t),\n\t*/\n\t/*\n\t'LinOTPAuth' => // Configuration for the LinOTP authentication\n\t    array(\n\t        'baseUrl' => 'https://linotp', // The base URL of LinOTP\n\t        'realm' => 'lino', // the (default) realm of all the users logging in through this system\n\t        'userModel' => 'User', // name of the User class (MISP class) to check if the user exists\n            'userModelKey' => 'email', // User field that will be used for querying.\n        ),\n\t*/\n\t// Warning: The following is a 3rd party contribution and still untested (including security) by the MISP-project team.\n\t// Feel free to enable it and report back to us if you run into any issues.\n\t//\n\t// Uncomment the following to enable Kerberos authentication\n\t// needs PHP LDAP support enabled (e.g. compile flag --with-ldap or Debian package php5-ldap)\n\t/*\n\t'ApacheSecureAuth' => // Configuration for kerberos authentication\n\t\tarray(\n\t\t\t'apacheEnv'          => 'REMOTE_USER',           // If proxy variable = HTTP_REMOTE_USER, If BasicAuth ldap = PHP_AUTH_USER\n\t\t\t'ldapServer'         => 'ldap://example.com',   // FQDN or IP\n\t\t\t'ldapProtocol'       => 3,\n\t\t\t'ldapNetworkTimeout' => -1,  // use -1 for unlimited network timeout\n\t\t\t'ldapReaderUser'     => 'cn=userWithReadAccess,ou=users,dc=example,dc=com', // DN ou RDN LDAP with reader user right\n\t\t\t'ldapReaderPassword' => 'UserPassword', // the LDAP reader user password\n\t\t\t'ldapDN'             => 'dc=example,dc=com',\n\t\t\t'ldapSearchFilter'   => '', // Search filter to limit results from ldapsearh fx to specific group. FX\n\t \t\t//'ldapSearchFilter'   => '(objectclass=InetOrgPerson)(!(nsaccountlock=True))(memberOf=cn=misp,cn=groups,cn=accounts,dc=example,dc=com)',\n\t\t\t'ldapSearchAttribut' => 'uid',          // filter for search\n\t\t\t'ldapFilter'         => array(\n\t\t\t\t'mail',\n\t\t\t//\t'memberOf', //Needed filter if roles should be added depending on group membership.\n\t\t\t),\n\t\t\t'ldapDefaultRoleId'  => 3,               // 3:User, 1:admin. May be good to set \"1\" for the first user\n\t\t\t//ldapDefaultRoleId can also be set as an array to support creating users into different group, depending on ldap membership.\n\t\t\t//This will only work if the ldap server supports memberOf\n\t\t\t//'ldapDefaultRoleId'  => array(\n\t\t\t//                         'misp_admin' => 1,\n\t\t\t//                         'misp_orgadmin' => 2,\n\t\t\t//                         'misp_user' => 3,\n\t\t\t//                         'misp_publisher' => 4,\n\t\t\t//                         'misp_syncuser' => 5,\n\t\t\t//                         'misp_readonly' => 6,\n\t\t\t//                         ),\n\t\t\t//\n\t\t\t'ldapDefaultOrg'     => '1',      // uses 1st local org in MISP if undefined,\n\t\t\t'ldapAllowReferrals' => true,   // allow or disallow chasing LDAP referrals\n\t\t\t//'ldapEmailField' => array('emailAddress, 'mail'), // Optional : fields from which the email address should be retrieved. Default to 'mail' only. If more than one field is set (e.g. 'emailAddress' and 'mail' in this example), only the first one will be used.\n\t\t\t//'updateUser' => true, // Optional : Will update user on LDAP login to update user fields (e.g. role)\n\t\t),\n\t*/\n);\n"], "fixing_code": ["<?php\n$config = array(\n\t'debug'            => 0,\n\t'Security'         =>\n\t\tarray(\n\t\t\t'level'      => 'medium',\n\t\t\t'salt'       => '',\n\t\t\t'cipherSeed' => '',\n            'require_password_confirmation' => true\n\t\t\t//'auth'=>array('CertAuth.Certificate'), // additional authentication methods\n\t\t\t//'auth'=>array('ShibbAuth.ApacheShibb'),\n\t\t),\n\t'MISP'             =>\n\t\tarray(\n\t\t\t'baseurl'                        => '',\n\t\t\t'footermidleft'                  => '',\n\t\t\t'footermidright'                 => '',\n\t\t\t'org'                            => 'ORGNAME',\n\t\t\t'showorg'                        => true,\n\t\t\t'threatlevel_in_email_subject'   => true,\n            'email_subject_TLP_string'       => 'tlp:amber',\n\t\t\t'email_subject_tag'              => 'tlp',\n\t\t\t'email_subject_include_tag_name' => true,\n\t\t\t'background_jobs'                => true,\n\t\t\t'cached_attachments'             => true,\n\t\t\t'osuser'                         => 'www-data',\n\t\t\t'email'                          => 'email@address.com',\n\t\t\t'contact'                        => 'email@address.com',\n\t\t\t'cveurl'                         => 'https://cve.circl.lu/cve/',\n\t\t\t'cweurl'                         => 'https://cve.circl.lu/cwe/',\n\t\t\t'disablerestalert'               => false,\n\t\t\t'default_event_distribution'     => '1',\n\t\t\t'default_attribute_distribution' => 'event',\n\t\t\t'tagging'                        => true,\n\t\t\t'full_tags_on_event_index'       => true,\n\t\t\t'attribute_tagging'              => true,\n\t\t\t'full_tags_on_attribute_index'   => true,\n\t\t\t'footer_logo'                    => '',\n\t\t\t'take_ownership_xml_import'      => false,\n\t\t\t'unpublishedprivate'             => false,\n\t\t\t'disable_emailing'               => false,\n\t\t\t'manage_workers'                 => true,\n\t\t\t'Attributes_Values_Filter_In_Event' => 'id, uuid, value, comment, type, category, Tag.name',\n\t\t),\n\t'GnuPG'            =>\n\t\tarray(\n\t\t\t'onlyencrypted'     => false,\n\t\t\t'email'             => '',\n\t\t\t'homedir'           => '',\n\t\t\t'password'          => '',\n            'bodyonlyencrypted' => false,\n            'sign'              => true,\n            'obscure_subject'   => false,\n\t\t),\n\t'SMIME'            =>\n\t\tarray(\n\t\t\t'enabled'          => false,\n\t\t\t'email'            => '',\n\t\t\t'cert_public_sign' => '',\n\t\t\t'key_sign'         => '',\n\t\t\t'password'         => '',\n\t\t),\n\t'Proxy'            =>\n\t\tarray(\n\t\t\t'host'     => '',\n\t\t\t'port'     => '',\n\t\t\t'method'   => '',\n\t\t\t'user'     => '',\n\t\t\t'password' => '',\n\t\t),\n\t'SecureAuth'       =>\n\t\tarray(\n\t\t\t'amount' => 5,\n\t\t\t'expire' => 300,\n\t\t),\n\t// Uncomment the following to enable client SSL certificate authentication\n\t/*\n\t'CertAuth'         =>\n\t\tarray(\n\n\t\t\t// CA\n\t\t\t'ca'           => array('FIRST.Org'), // List of CAs authorized\n\t\t\t'caId'         => 'O',          // Certificate field used to verify the CA. In this example, the field O (organization) of the client certificate has to equal to 'FIRST.Org' in order to validate the CA\n\n\t\t\t// User/client configuration\n\t\t\t'userModel'    => 'User',       // name of the User class (MISP class) to check if the user exists\n\t\t\t'userModelKey' => 'email',      // User field that will be used for querying. In this example, the field email of the MISP accounts will be used to search if the user exists.\n\t\t\t'map'          => array(        // maps client certificate attributes to User properties. This map will be used as conditions to find if the user exists. In this example, the client certificate fields 'O' (organization) and 'emailAddress' have to match with the MISP fields 'org' and 'email' to validate the user.\n\t\t\t\t'O'            => 'org',\n\t\t\t\t'emailAddress' => 'email',\n\t\t\t),\n\n\t\t\t// Synchronization/RestAPI\n\t\t\t'syncUser'     => true,         // should the User be synchronized with an external REST API\n\t\t\t'userDefaults' => array(          // default user attributes, only used when creating new users. By default, new users are \"Read only\" users (role_id: 6).\n\t\t\t\t'role_id' => 6,\n\t\t\t),\n\t\t\t'restApi'      => array(        // API parameters\n\t\t\t\t'url'     => 'https://example.com/data/users',  // URL to query\n\t\t\t\t'headers' => array(),                           // additional headers, used for authentication\n\t\t\t\t'param'   => array('email' => 'email'),       // query parameters to add to the URL, mapped to User properties\n\t\t\t\t'map'     => array(                            // maps REST result to the User properties\n\t\t\t\t\t'uid'        => 'nids_sid',\n\t\t\t\t\t'team'       => 'org',\n\t\t\t\t\t'email'      => 'email',\n\t\t\t\t\t'pgp_public' => 'gpgkey',\n\t\t\t\t),\n\t\t\t),\n\t\t\t'userDefaults' => array('role_id' => 6),          // default attributes for new users. By default, new users are \"Read only\" users (role_id: 6).\n\t\t),\n\t*/\n\t/*\n\t'ApacheShibbAuth'  =>                      // Configuration for shibboleth authentication\n\t\tarray(\n\t\t\t'apacheEnv'         => 'REMOTE_USER',        // If proxy variable = HTTP_REMOTE_USER\n\t\t\t'MailTag'           => 'EMAIL_TAG',\n\t\t\t'OrgTag'            => 'FEDERATION_TAG',\n\t\t\t'GroupTag'          => 'GROUP_TAG',\n\t\t\t'GroupSeparator'    => ';',\n\t\t\t'GroupRoleMatching' => array(                // 3:User, 1:admin. May be good to set \"1\" for the first user\n\t\t\t\t'group_three' => 3,\n\t\t\t\t'group_two'   => 2,\n\t\t\t\t'group_one'   => 1,\n\t\t\t),\n\t\t\t'DefaultOrg'        => 'DEFAULT_ORG',\n\t\t),\n\t*/\n\t/*\n\t'LinOTPAuth' => // Configuration for the LinOTP authentication\n\t    array(\n\t        'baseUrl' => 'https://linotp', // The base URL of LinOTP\n\t        'realm' => 'lino', // the (default) realm of all the users logging in through this system\n\t        'userModel' => 'User', // name of the User class (MISP class) to check if the user exists\n            'userModelKey' => 'email', // User field that will be used for querying.\n        ),\n\t*/\n\t// Warning: The following is a 3rd party contribution and still untested (including security) by the MISP-project team.\n\t// Feel free to enable it and report back to us if you run into any issues.\n\t//\n\t// Uncomment the following to enable Kerberos authentication\n\t// needs PHP LDAP support enabled (e.g. compile flag --with-ldap or Debian package php5-ldap)\n\t/*\n\t'ApacheSecureAuth' => // Configuration for kerberos authentication\n\t\tarray(\n\t\t\t'apacheEnv'          => 'REMOTE_USER',           // If proxy variable = HTTP_REMOTE_USER, If BasicAuth ldap = PHP_AUTH_USER\n\t\t\t'ldapServer'         => 'ldap://example.com',   // FQDN or IP\n\t\t\t'ldapProtocol'       => 3,\n\t\t\t'ldapNetworkTimeout' => -1,  // use -1 for unlimited network timeout\n\t\t\t'ldapReaderUser'     => 'cn=userWithReadAccess,ou=users,dc=example,dc=com', // DN ou RDN LDAP with reader user right\n\t\t\t'ldapReaderPassword' => 'UserPassword', // the LDAP reader user password\n\t\t\t'ldapDN'             => 'dc=example,dc=com',\n\t\t\t'ldapSearchFilter'   => '', // Search filter to limit results from ldapsearh fx to specific group. FX\n\t \t\t//'ldapSearchFilter'   => '(objectclass=InetOrgPerson)(!(nsaccountlock=True))(memberOf=cn=misp,cn=groups,cn=accounts,dc=example,dc=com)',\n\t\t\t'ldapSearchAttribut' => 'uid',          // filter for search\n\t\t\t'ldapFilter'         => array(\n\t\t\t\t'mail',\n\t\t\t//\t'memberOf', //Needed filter if roles should be added depending on group membership.\n\t\t\t),\n\t\t\t'ldapDefaultRoleId'  => 3,               // 3:User, 1:admin. May be good to set \"1\" for the first user\n\t\t\t//ldapDefaultRoleId can also be set as an array to support creating users into different group, depending on ldap membership.\n\t\t\t//This will only work if the ldap server supports memberOf\n\t\t\t//'ldapDefaultRoleId'  => array(\n\t\t\t//                         'misp_admin' => 1,\n\t\t\t//                         'misp_orgadmin' => 2,\n\t\t\t//                         'misp_user' => 3,\n\t\t\t//                         'misp_publisher' => 4,\n\t\t\t//                         'misp_syncuser' => 5,\n\t\t\t//                         'misp_readonly' => 6,\n\t\t\t//                         ),\n\t\t\t//\n\t\t\t'ldapDefaultOrg'     => '1',      // uses 1st local org in MISP if undefined,\n\t\t\t'ldapAllowReferrals' => true,   // allow or disallow chasing LDAP referrals\n\t\t\t//'ldapEmailField' => array('emailAddress, 'mail'), // Optional : fields from which the email address should be retrieved. Default to 'mail' only. If more than one field is set (e.g. 'emailAddress' and 'mail' in this example), only the first one will be used.\n\t\t\t//'updateUser' => true, // Optional : Will update user on LDAP login to update user fields (e.g. role)\n\t\t),\n\t*/\n);\n"], "filenames": ["app/Config/config.default.php"], "buggy_code_start_loc": [8], "buggy_code_end_loc": [8], "fixing_code_start_loc": [9], "fixing_code_end_loc": [10], "type": "CWE-640", "message": "The default setting of MISP 2.4.136 did not enable the requirements (aka require_password_confirmation) to provide the previous password when changing a password.", "other": {"cve": {"id": "CVE-2021-25323", "sourceIdentifier": "cve@mitre.org", "published": "2021-01-19T16:15:13.327", "lastModified": "2021-01-22T15:40:54.153", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "The default setting of MISP 2.4.136 did not enable the requirements (aka require_password_confirmation) to provide the previous password when changing a password."}, {"lang": "es", "value": "La configuraci\u00f3n predeterminada de MISP versi\u00f3n 2.4.136 no habilit\u00f3 los requisitos (tambi\u00e9n se conoce como require_password_confirmation) para proporcionar la contrase\u00f1a anterior al cambiar una contrase\u00f1a"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.1, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 6.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-640"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:misp:misp:2.4.136:*:*:*:*:*:*:*", "matchCriteriaId": "847602BA-85D7-432D-917D-76D14E6D2769"}]}]}], "references": [{"url": "https://github.com/MISP/MISP/commit/afbf95a478b6e94f532ca0776c79da1b08be7eed", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/MISP/MISP/commit/afbf95a478b6e94f532ca0776c79da1b08be7eed"}}