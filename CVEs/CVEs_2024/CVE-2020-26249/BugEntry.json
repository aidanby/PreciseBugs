{"buggy_code": ["{% extends \"base-site.html\" %}\r\n\r\n{% block title %} {{ _('Dashboard') }} {% endblock %}\r\n\r\n<!-- Specific Page CSS goes HERE  -->\r\n{% block stylesheets %}{% endblock stylesheets %}\r\n\r\n{% block content %}\r\n\r\n<div class=\"row\">\r\n    <div class=\"col-md-12\">\r\n        <div class=\"card card-profile\">\r\n            <div class=\"card-body\">\r\n                <h6 class=\"card-category text-gray\">{{ _('Dashboard') }}</h6>\r\n                <div class=\"card-body\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-11\">\r\n                            <h5>{{ (_(\"Welcome to the interactive dashboard, where you can control your bot via this easy-to-use interface. Choose a server that you have elevated permissions in below. If you don't see your server below, check to make sure that your server's owner has set roles with <code>{command}</code>\").format(command=\"[p]dashboard roles create\"))|safe }}\r\n                            </h5>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"row\">\r\n    <div class=\"col-md-12\">\r\n        <div class=\"card card-profile\">\r\n            <div class=\"card-body\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-md-3\">\r\n                        <form class=\"form-inline d-flex justify-content-center md-form form-sm mt-0\">\r\n                            <i class=\"fas fa-search\" aria-hidden=\"true\"></i>\r\n                            <input class=\"form-control form-control-sm ml-3 w-75\" id=\"guildsearch\" type=\"text\"\r\n                                placeholder=\"{{ _('Search') }}\" aria-label=\"Search\">\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"row\" id=\"serverrow\">\r\n    <div class=\"col-md-12\">\r\n        <h1>{{ _('Loading servers...') }}</h1>\r\n    </div>\r\n</div>\r\n\r\n{% endblock content %}\r\n\r\n<!-- Specific Page JS goes HERE  -->\r\n{% block javascripts %}\r\n<script src=\"https://cdn.jsdelivr.net/npm/fuse.js@6.0.4\"></script>\r\n<script>\r\n    // Since the serer loading could take who knows how long, we'll load in JS so it says \"Loading...\"\" in the page\r\n    $(document).ready(function () {\r\n        var xhr = new XMLHttpRequest();\r\n        var url = \"{{ url_for('home_blueprint.getservers') }}\"\r\n        xhr.open(\"GET\", url, true)\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\")\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState !== 4) { return }\r\n            var json = JSON.parse(xhr.responseText)\r\n            if (json.status === 0) {\r\n                $(\"#serverrow\").html(`<div class=\"col-md-12\"><h1>${json[\"message\"]}</h1></div>`)\r\n            } else {\r\n                if (json.data.length === 0) {\r\n                    $(\"#serverrow\").html(`<div class=\"col-md-12\"><h1>{{ _(\"You're not in any servers with elevated permissions!\") }}</h1></div>`)\r\n                } else {\r\n                    var base_guild_url = \"{{ url_for('home_blueprint.guild', guild='123456789123456789') }}\"\r\n                    $(\"#serverrow\").html(\"\")\r\n                    for (let g of json.data) {\r\n                        var current_guild_url = base_guild_url.replace(\"123456789123456789\", g.id)\r\n                        $(\"#serverrow\").append(`\r\n                            <div class=\"col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 guildcard\" style=\"margin-bottom: 50px\">\r\n                                <a href=\"${current_guild_url}\">\r\n                                    <div class=\"card h-100\" onmouseover=\"playGif(this)\" onmouseout=\"stopGif(this)\">\r\n                                        <img class=\"card-img-top\" src=\"${g.icon}png\" alt=\"Card image cap\" data-src-url=\"${g.icon}\" data-is-animated=${g.animated}>\r\n                                        <div class=\"card-body\">\r\n                                            <h5 class=\"card-title\">${g.name}</h5>\r\n                                            <p class=\"card-text\">Owner: ${g.owner}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </a>\r\n                            </div>\r\n                        `)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        try {\r\n            xhr.send()\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    })\r\n\r\n    function playGif(elm) {\r\n        var img = $(elm).find(\"img\")\r\n        if (img.attr('data-is-animated') === \"true\") {\r\n            img.attr(\"src\", `${img.attr(\"data-src-url\")}gif`)\r\n        }\r\n    }\r\n    function stopGif(elm) {\r\n        var img = $(elm).find(\"img\")\r\n        if (img.attr('data-is-animated') === \"true\") {\r\n            img.attr(\"src\", `${img.attr(\"data-src-url\")}png`)\r\n        }\r\n    }\r\n    $(document).ready(function () {\r\n        $(\"#guildsearch\").on(\"keyup\", function () {\r\n            var value = $(this).val().toLowerCase();\r\n            $('.guildcard').filter(function () {\r\n                var name = $(this).find('h5').text().toLowerCase()\r\n                var list = [name]\r\n                var options = {\r\n                    threshold: '0.3'\r\n                }\r\n                var fuse = new Fuse(list, options)\r\n                $(this).toggle(fuse.search(value).length === 1 || value === \"\")\r\n            });\r\n        });\r\n    });\r\n</script>\r\n{% endblock javascripts %}"], "fixing_code": ["{% extends \"base-site.html\" %}\r\n\r\n{% block title %} {{ _('Dashboard') }} {% endblock %}\r\n\r\n<!-- Specific Page CSS goes HERE  -->\r\n{% block stylesheets %}{% endblock stylesheets %}\r\n\r\n{% block content %}\r\n\r\n<div class=\"row\">\r\n    <div class=\"col-md-12\">\r\n        <div class=\"card card-profile\">\r\n            <div class=\"card-body\">\r\n                <h6 class=\"card-category text-gray\">{{ _('Dashboard') }}</h6>\r\n                <div class=\"card-body\">\r\n                    <div class=\"row\">\r\n                        <div class=\"col-md-11\">\r\n                            <h5>{{ (_(\"Welcome to the interactive dashboard, where you can control your bot via this easy-to-use interface. Choose a server that you have elevated permissions in below. If you don't see your server below, check to make sure that your server's owner has set roles with <code>{command}</code>\").format(command=\"[p]dashboard roles create\"))|safe }}\r\n                            </h5>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"row\">\r\n    <div class=\"col-md-12\">\r\n        <div class=\"card card-profile\">\r\n            <div class=\"card-body\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-md-3\">\r\n                        <form class=\"form-inline d-flex justify-content-center md-form form-sm mt-0\">\r\n                            <i class=\"fas fa-search\" aria-hidden=\"true\"></i>\r\n                            <input class=\"form-control form-control-sm ml-3 w-75\" id=\"guildsearch\" type=\"text\"\r\n                                placeholder=\"{{ _('Search') }}\" aria-label=\"Search\">\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"row\" id=\"serverrow\">\r\n    <div class=\"col-md-12\">\r\n        <h1>{{ _('Loading servers...') }}</h1>\r\n    </div>\r\n</div>\r\n\r\n{% endblock content %}\r\n\r\n<!-- Specific Page JS goes HERE  -->\r\n{% block javascripts %}\r\n<script src=\"https://cdn.jsdelivr.net/npm/fuse.js@6.0.4\"></script>\r\n<script>\r\n    // Since the serer loading could take who knows how long, we'll load in JS so it says \"Loading...\"\" in the page\r\n    $(document).ready(function () {\r\n        var xhr = new XMLHttpRequest();\r\n        var url = \"{{ url_for('home_blueprint.getservers') }}\"\r\n        xhr.open(\"GET\", url, true)\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\")\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState !== 4) { return }\r\n            var json = JSON.parse(xhr.responseText)\r\n            if (json.status === 0) {\r\n                $(\"#serverrow\").html(`<div class=\"col-md-12\"><h1>${json[\"message\"]}</h1></div>`)\r\n            } else {\r\n                if (json.data.length === 0) {\r\n                    $(\"#serverrow\").html(`<div class=\"col-md-12\"><h1>{{ _(\"You're not in any servers with elevated permissions!\") }}</h1></div>`)\r\n                } else {\r\n                    var base_guild_url = \"{{ url_for('home_blueprint.guild', guild='123456789123456789') }}\"\r\n                    $(\"#serverrow\").html(\"\")\r\n                    let counter = 0\r\n                    for (let g of json.data) {\r\n                        var current_guild_url = base_guild_url.replace(\"123456789123456789\", g.id)\r\n                        $(\"#serverrow\").append(`\r\n                            <div class=\"col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 guildcard\" style=\"margin-bottom: 50px\">\r\n                                <a href=\"${current_guild_url}\">\r\n                                    <div class=\"card h-100\" onmouseover=\"playGif(this)\" onmouseout=\"stopGif(this)\">\r\n                                        <img class=\"card-img-top\" src=\"${g.icon}png\" alt=\"Card image cap\" data-src-url=\"${g.icon}\" data-is-animated=${g.animated}>\r\n                                        <div class=\"card-body\">\r\n                                            <h5 class=\"card-title\" id=\"guild-counter-${counter}\">Loading...</h5>\r\n                                            <p class=\"card-text\" id=\"owner-counter-${counter}\">Owner: Loading...</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </a>\r\n                            </div>\r\n                        `)\r\n                        $(`#guild-counter-${counter}`).text(g.name)\r\n                        $(`#owner-counter-${counter}`).text(g.owner)\r\n                        counter += 1\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        try {\r\n            xhr.send()\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    })\r\n\r\n    function playGif(elm) {\r\n        var img = $(elm).find(\"img\")\r\n        if (img.attr('data-is-animated') === \"true\") {\r\n            img.attr(\"src\", `${img.attr(\"data-src-url\")}gif`)\r\n        }\r\n    }\r\n    function stopGif(elm) {\r\n        var img = $(elm).find(\"img\")\r\n        if (img.attr('data-is-animated') === \"true\") {\r\n            img.attr(\"src\", `${img.attr(\"data-src-url\")}png`)\r\n        }\r\n    }\r\n    $(document).ready(function () {\r\n        $(\"#guildsearch\").on(\"keyup\", function () {\r\n            var value = $(this).val().toLowerCase();\r\n            $('.guildcard').filter(function () {\r\n                var name = $(this).find('h5').text().toLowerCase()\r\n                var list = [name]\r\n                var options = {\r\n                    threshold: '0.3'\r\n                }\r\n                var fuse = new Fuse(list, options)\r\n                $(this).toggle(fuse.search(value).length === 1 || value === \"\")\r\n            });\r\n        });\r\n    });\r\n</script>\r\n{% endblock javascripts %}"], "filenames": ["reddash/app/home/templates/dashboard.html"], "buggy_code_start_loc": [74], "buggy_code_end_loc": [89], "fixing_code_start_loc": [75], "fixing_code_end_loc": [94], "type": "CWE-79", "message": "Red Discord Bot Dashboard is an easy-to-use interactive web dashboard to control your Redbot. In Red Discord Bot before version 0.1.7a an RCE exploit has been discovered. This exploit allows Discord users with specially crafted Server names and Usernames/Nicknames to inject code into the webserver front-end code. By abusing this exploit, it's possible to perform destructive actions and/or access sensitive information. This high severity exploit has been fixed on version 0.1.7a. There are no workarounds, bot owners must upgrade their relevant packages (Dashboard module and Dashboard webserver) in order to patch this issue.", "other": {"cve": {"id": "CVE-2020-26249", "sourceIdentifier": "security-advisories@github.com", "published": "2020-12-09T00:15:13.157", "lastModified": "2020-12-10T20:15:02.223", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Red Discord Bot Dashboard is an easy-to-use interactive web dashboard to control your Redbot. In Red Discord Bot before version 0.1.7a an RCE exploit has been discovered. This exploit allows Discord users with specially crafted Server names and Usernames/Nicknames to inject code into the webserver front-end code. By abusing this exploit, it's possible to perform destructive actions and/or access sensitive information. This high severity exploit has been fixed on version 0.1.7a. There are no workarounds, bot owners must upgrade their relevant packages (Dashboard module and Dashboard webserver) in order to patch this issue."}, {"lang": "es", "value": "Red Discord Bot Dashboard es un panel web interactivo f\u00e1cil de usar para controlar tu Redbot. En Red Discord Bot versiones anteriores a 0.1.7a ha sido detectado una explotaci\u00f3n de RCE. Esta explotaci\u00f3n permite a usuarios de Discord con nombres de Server y Usernames/Nicknames especialmente dise\u00f1ados, inyectar c\u00f3digo en el c\u00f3digo del front-end del servidor web. Al abusar de esta explotaci\u00f3n, es posible llevar a cabo acciones destructivas y/o acceder a informaci\u00f3n confidencial. Esta explotaci\u00f3n de alta severidad ha sido corregida en la versi\u00f3n 0.1.7a. No se presentan soluciones provisionales, los propietarios de los bots deben actualizar sus paquetes relevantes (m\u00f3dulo de Dashboard y servidor web de Dashboard) para poder parchear este problema"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 5.8}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cogboard:red-dashboard:0.1.2:alpha0:*:*:*:*:*:*", "matchCriteriaId": "E8CF51B9-B3EA-4B38-94AB-AA36BAAD6296"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cogboard:red-dashboard:0.1.3:alpha0:*:*:*:*:*:*", "matchCriteriaId": "3A6ABE0E-5718-463F-9188-AC2FD94ECD44"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cogboard:red-dashboard:0.1.4:alpha0:*:*:*:*:*:*", "matchCriteriaId": "E264D5C4-F0A5-469E-89F9-AD456723703E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cogboard:red-dashboard:0.1.5:alpha0:*:*:*:*:*:*", "matchCriteriaId": "96A9C2E7-B629-4B61-83D9-6E627480E82B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:cogboard:red-dashboard:0.1.6:alpha0:*:*:*:*:*:*", "matchCriteriaId": "BAA08A22-1BAE-432B-A85C-8E40BA6B2184"}]}]}], "references": [{"url": "https://github.com/Cog-Creators/Red-Dashboard/commit/99d88b840674674166ce005b784ae8e31e955ab1", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Cog-Creators/Red-Dashboard/commit/a6b9785338003ec87fb75305e7d1cc2d40c7ab91", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Cog-Creators/Red-Dashboard/security/advisories/GHSA-hm45-mgqm-gjm4", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://pypi.org/project/Red-Dashboard", "source": "security-advisories@github.com", "tags": ["Product", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Cog-Creators/Red-Dashboard/commit/99d88b840674674166ce005b784ae8e31e955ab1"}}