{"buggy_code": ["const exec = require('child_process').exec;\n\nmodule.exports = async function (bin, options) {\n    return new Promise((resolve, reject) => {\n        const cmd = `${process.cwd()}/node_modules/.bin/${bin}`;\n\n        console.log(`Running \\`${cmd}\\``);\n\n        const theProcess = exec(cmd, options, (error, stdout, stderr) => {\n            if (stderr) {\n                reject(error);\n                return;\n            }\n\n            resolve(stdout);\n        });\n\n        theProcess.stdout.on('data', (data) => {\n            process.stdout.write(data.toString());\n        });\n\n        theProcess.stderr.on('data', (data) => {\n            process.stdout.write(data.toString());\n        });\n    });\n};\n", "{\n  \"name\": \"exec-local-bin\",\n  \"version\": \"1.1.1\",\n  \"description\": \"Helps you run local node binaries in node\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/saeedseyfi/exec-local-bin.git\"\n  },\n  \"keywords\": [\n    \"node\",\n    \"exec\",\n    \"local-bin\",\n    \"node_modules\"\n  ],\n  \"author\": \"Saeed Seyfi <me@saeedseyfi.com> (http://saeedseyfi.com)\",\n  \"license\": \"ISC\",\n  \"bugs\": {\n    \"url\": \"https://github.com/saeedseyfi/exec-local-bin/issues\"\n  },\n  \"homepage\": \"https://github.com/saeedseyfi/exec-local-bin#readme\",\n  \"dependencies\": {}\n}\n"], "fixing_code": ["const exec = require('child_process').exec;\nconst fs = require('fs');\nconst path = require('path');\n\nmodule.exports = async function (bin, options) {\n    return new Promise(async (resolve, reject) => {\n        const binDir = `${process.cwd()}/node_modules/.bin`;\n        const cmd = path.join(binDir, bin);\n\n        if (!cmd.startsWith(binDir)) {\n            reject(new Error(`${cmd} within the expected directory`));\n            return;\n        }\n\n        try {\n            await fs.access(cmd, fs.constants.X_OK);\n        } catch (err) {\n            reject(new Error(`${cmd} is not accessible: ${err.message}`));\n            return;\n        }\n\n        console.log(`Running \\`${cmd}\\``);\n\n        const theProcess = exec(cmd, options, (error, stdout, stderr) => {\n            if (stderr) {\n                reject(error);\n                return;\n            }\n\n            resolve(stdout);\n        });\n\n        theProcess.stdout.on('data', (data) => {\n            process.stdout.write(data.toString());\n        });\n\n        theProcess.stderr.on('data', (data) => {\n            process.stdout.write(data.toString());\n        });\n    });\n};\n", "{\n  \"name\": \"exec-local-bin\",\n  \"version\": \"1.1.1\",\n  \"description\": \"Helps you run local node binaries in node\",\n  \"main\": \"index.js\",\n  \"files\": [\n    \"index.js\"\n  ],\n  \"engines\": {\n    \"node\": \"^8.0.0\"\n  },\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/saeedseyfi/exec-local-bin.git\"\n  },\n  \"keywords\": [\n    \"node\",\n    \"exec\",\n    \"local-bin\",\n    \"node_modules\"\n  ],\n  \"author\": \"Saeed Seyfi <me@saeedseyfi.com> (http://saeedseyfi.com)\",\n  \"license\": \"ISC\",\n  \"bugs\": {\n    \"url\": \"https://github.com/saeedseyfi/exec-local-bin/issues\"\n  },\n  \"homepage\": \"https://github.com/saeedseyfi/exec-local-bin#readme\",\n  \"dependencies\": {}\n}\n"], "filenames": ["index.js", "package.json"], "buggy_code_start_loc": [1, 5], "buggy_code_end_loc": [6, 5], "fixing_code_start_loc": [2, 6], "fixing_code_end_loc": [21, 12], "type": "CWE-77", "message": "Versions of the package exec-local-bin before 1.2.0 are vulnerable to Command Injection via the theProcess() functionality due to improper user-input sanitization.", "other": {"cve": {"id": "CVE-2022-25923", "sourceIdentifier": "report@snyk.io", "published": "2023-01-06T05:15:11.537", "lastModified": "2023-01-12T13:28:51.470", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Versions of the package exec-local-bin before 1.2.0 are vulnerable to Command Injection via the theProcess() functionality due to improper user-input sanitization."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "report@snyk.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.4, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:exec-local-bin_project:exec-local-bin:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "1.2.0", "matchCriteriaId": "297A840D-0E3D-479D-90BB-4E4DE195F19E"}]}]}], "references": [{"url": "https://github.com/saeedseyfi/exec-local-bin/blob/92db00bde9d6e2d83410849f898df12f075b73b0/index.js%23L9", "source": "report@snyk.io", "tags": ["Broken Link"]}, {"url": "https://github.com/saeedseyfi/exec-local-bin/commit/d425866375c85038133a6f79db2aac66c0a72624", "source": "report@snyk.io", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://security.snyk.io/vuln/SNYK-JS-EXECLOCALBIN-3157956", "source": "report@snyk.io", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/saeedseyfi/exec-local-bin/commit/d425866375c85038133a6f79db2aac66c0a72624"}}