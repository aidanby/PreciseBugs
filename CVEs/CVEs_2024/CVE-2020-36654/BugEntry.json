{"buggy_code": ["<?php\n//----------------------------------------------------------------------\n// Copyright (c) 2011-2016 Raytheon BBN Technologies\n//\n// Permission is hereby granted, free of charge, to any person obtaining\n// a copy of this software and/or hardware specification (the \"Work\") to\n// deal in the Work without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense,\n// and/or sell copies of the Work, and to permit persons to whom the Work\n// is furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be\n// included in all copies or substantial portions of the Work.\n//\n// THE WORK IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n// WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE WORK OR THE USE OR OTHER DEALINGS\n// IN THE WORK.\n//----------------------------------------------------------------------\n?>\n<?php\nrequire_once(\"settings.php\");\nrequire_once('portal.php');\nrequire_once(\"user.php\");\nrequire_once(\"file_utils.php\");\nrequire_once(\"sr_client.php\");\nrequire_once(\"sr_constants.php\");\nrequire_once(\"am_client.php\");\nrequire_once(\"am_map.php\");\nrequire_once(\"sa_client.php\");\nrequire_once(\"print-text-helpers.php\");\nrequire_once(\"logging_client.php\");\nrequire_once(\"header.php\");\n$user = geni_loadUser();\nif (!isset($user) || is_null($user) || ! $user->isActive()) {\n  relative_redirect('home.php');\n}\n\nfunction no_slice_error() {\n  header('HTTP/1.1 404 Not Found');\n  print 'No slice id specified.';\n  exit();\n}\n\nfunction no_invocation_id_error() {\n  header('HTTP/1.1 404 Not Found');\n  print 'No omni invocation id and/or user ID specified.';\n  exit();\n}\n\n// redirect if no attributes passed in\nif (! count($_REQUEST)) {\n  no_slice_error();\n}\n\n// set user ID and invocation\nif(array_key_exists(\"invocation_id\", $_REQUEST) &&\n        array_key_exists(\"invocation_user\", $_REQUEST)) {\n    $invocation_user = $_REQUEST['invocation_user'];\n    $invocation_id = $_REQUEST['invocation_id'];\n}\nelse {\n    no_invocation_id_error();\n}\n\n// set slice/AM information\nunset($slice);\nunset($am);\ninclude(\"tool-lookupids.php\");\nif (! isset($slice)) {\n  no_slice_error();\n}\n\n// redirect if slice has expired\nif (isset($slice_expired) && convert_boolean($slice_expired)) {\n  if (! isset($slice_name)) {\n    $slice_name = \"\";\n  }\n  $_SESSION['lasterror'] = \"Slice \" . $slice_name . \" is expired.\";\n  relative_redirect('dashboard.php#slices');\n}\n\n// redirect if user isn't allowed to look up slice\nif(!$user->isAllowed(SA_ACTION::LOOKUP_SLICE, CS_CONTEXT_TYPE::SLICE, $slice_id)) {\n  relative_redirect('home.php');\n}\n\n// show header and breadcrumbs\nshow_header('GENI Portal: Add Resources to Slice (Results)');\ninclude(\"tool-breadcrumbs.php\");\ninclude(\"tool-showmessage.php\");\n\n// check that invocation ID actually points to a directory\n$dir_to_check = get_invocation_dir_name($invocation_user, $invocation_id);\nif(!is_dir($dir_to_check)) {\n    echo \"<h1>Add Resources to GENI Slice <i>$slice_name</i> (Results)</h1>\";\n    echo \"<p class='error'>Files and process data related to omni request\";\n    echo \" <b>$invocation_user-$invocation_id</b> not found.\";\n    echo \" Older files are periodically removed from the Portal, so it is possible that the files\";\n    echo \" and process-related data have been deleted as part of routine maintenance.\";\n    echo \"<br><br>\";\n    echo \"Please <a href='contact-us.php'>contact us</a> if you require further assistance.</p>\";\n\n    echo '<form method=\"GET\" action=\"back\">';\n    echo '<input type=\"button\" value=\"Back\" onClick=\"history.back(-1)\"/>';\n    echo '</form>';\n    include(\"footer.php\");\n    error_log(\"sliceresource.php: Failed to find directory with invocation ID \" .\n        \"$invocation_id and user $invocation_user.\");\n    exit;\n}\n\n// set e-mail footer message\n$bug_report_msg1 = \"Attached is a problem report about reserving resources generated from the GENI Portal (https://portal.geni.net/). This problem report contains process-related information such as log files, resource specifications (RSpecs) and metadata.<br><br>User message:\";\n$bug_report_msg2 = \"Thanks,<br>\" . $user->prettyName();\n$bug_report_subject = \"GENI Portal Reservation Problem Report\";\n\n/*\n    since AM ID is optional for this page, it needs to be explicitly\n    set if tool-lookupids.php hasn't already set it - there's no else clause\n    in tool-lookupids.php because the assumption is that the page would have\n    already shown an error earlier if $REQUEST['am_id'] hadn't been specified\n*/\nif(!isset($am_id)) {\n    $am_id = NULL;\n}\n\nprint '<script src=\"jacks-lib.js\"></script>';\ninclude(\"sliceresource.js\");\n\necho \"<h1>Add Resources to GENI Slice <i>$slice_name</i> (Results)</h1>\";\necho \"<div style='position:relative;'>\";\necho \"<p style='margin-left:0px;'>Total run time: <b><span id='total_run_time'></span></b> \";\necho \"<br>Status: <span id='total_run_time_status'></span></p>\";\necho \"<div style='position:absolute;top:0px;right:0px;'>\";\necho \"<p style='margin:0px;text-align:right;'>Started at: <b><span id='start_time'></span></b><br><span id='last_updated_or_finished_text'>Last updated:</span> <b><span id='last_updated_or_finished_time'></span></b></p>\";\necho \"</div></div>\";\n\n$request_rspec_filename = $slice_name . \"_request_rspec.xml\";\n$manifest_rspec_filename = $slice_name . \"_manifest_rspec.xml\";\n?>\n\n  <div id='tablist'>\n\t\t<ul class='tabs'>\n\t\t\t<li><a href='#tab_results'>Results</a></li>\n\t\t\t<li><a href='#tab_progress'>Detailed Progress</a></li>\n\t\t\t<li><a href='#tab_request_rspec'>Request RSpec</a></li>\n\t\t\t<li><a href='#tab_manifest_rspec'>Manifest RSpec</a></li>\n\t\t\t<li><a href='#tab_send_bug_report'>Send Problem Report</a></li>\n\t\t\t<li style=\"border-right: none\"><a href='#tab_advanced'>Advanced</a></li>\n\t\t</ul>\n  </div>\n\n<!-- begin tab content -->\n<div class='tabContent'>\n\n<!-- resource 'tab' - this is empty so that the results (which always appear on\n     each tab) will show at the top -->\n<div id='tab_results'>\n</div>\n\n<!-- progress tab -->\n<div id='tab_progress'>\n\n<h2>Detailed Progress</h2>\n<pre id='console_data_container' style=\"height:300px;\">\n<span id='console_data'></span>\n</pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=console&download=true&filename=detailed_progress.log\";?>'\" title='Download Detailed Progress Log' id='download_console'>Download Detailed Progress Log</button></p>\n</div>\n\n<!-- request RSpec tab -->\n<div id='tab_request_rspec'>\n\n<h2>Request RSpec</h2>\n<pre id='requestrspec_container' style=\"height:300px;\"><span id='requestrspec_data'></span></pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=requestrspec&download=true&filename=$request_rspec_filename\";?>'\" title='Download Request RSpec' id='download_requestrspec'>Download Request RSpec</button></p>\n</div>\n\n<!-- manifest RSpec tab -->\n<div id='tab_manifest_rspec'>\n\n<h2>Manifest RSpec</h2>\n<pre id='manifestrspec_container' style=\"height:300px;\"><span id='manifestrspec_data'><i>Manifest RSpec empty</i></span></pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=manifestrspec&download=true&filename=$manifest_rspec_filename\";?>'\" title='Download Manifest RSpec' id='download_manifestrspec' disabled='disabled'>Download Manifest RSpec</button></p>\n</div>\n\n\n<!-- send bug report tab -->\n<div id='tab_send_bug_report'>\n\n<script>\nfunction validateBugReportSubmit()\n{\n  f1 = document.getElementById(\"f1\");\n  to = document.getElementById(\"to\");\n  message = document.getElementById(\"message\");\n\n  if (to.value && message.value) {\n    f1.submit();\n    return true;\n  } else if(to.value && !(message.value)) {\n    alert(\"Please add a message.\");\n    return false;\n  } else if(!(to.value) && message.value) {\n    alert(\"Please select a recipient e-mail address.\");\n    return false;\n  } else {\n    alert(\"Please select a recipient e-mail address and add a message.\");\n    return false;\n  }\n}\n</script>\n\n<h2>Send a Problem Report</h2>\n\n<p>Ran into a problem or have a question? Search the\n  <a target=\"_blank\" href=\"https://groups.google.com/forum/#!forum/geni-users\">\n    GENI Users</a> archives for answers to similar questions.\n</p>\n\n<ul>\n<li>The problem report will include your name, e-mail address, slice and project information, request RSpec, manifest RSpec(s), progress log, debug log, error log and process metadata.</li>\n<li>The report will not include security-sensitive information such as slice credentials, certificates, private keys and SpeaksFor credentials.</li>\n</ul>\n\n<p>If you are not comfortable sharing your problem report publicly, email it to\n  <a href=\"mailto:<?php echo $portal_help_email;?>\">\n          <?php echo $portal_help_email;?></a>.\n</p>\n\n<form id=\"f1\" action=\"send_bug_report.php\" method=\"post\" enctype=\"multipart/form-data\" onsubmit=\"return validateBugReportSubmit()\">\n<input type=\"hidden\" name=\"invocation_id\" id=\"invocation_id\" value=\"<?php echo $invocation_id;?>\"/>\n<input type=\"hidden\" name=\"invocation_user\" id=\"invocation_user\" value=\"<?php echo $invocation_user;?>\"/>\n<input type=\"hidden\" name=\"slice_id\" id=\"slice_id\" value=\"<?php echo $slice_id;?>\"/>\n\n<table>\n<tr>\n<th>From</th>\n<td><b><?php echo $user->prettyName() . \" &lt;\" . $user->email() . \"&gt;\"; ?></b> (Copy me on the problem report e-mail:<input type=\"checkbox\" name=\"copy\" id='copy' value=\"true\"/>)</td>\n</tr>\n<tr>\n<th>Subject</th>\n<td><b><?php echo $bug_report_subject; ?></b></td>\n</tr>\n<tr>\n<th>To<br><small>(Required)</small></th>\n<td><b>Recipient e-mail:</b> <input type='text' name='to' id='to' size='30' value='geni-users@googlegroups.com'></input><br></td>\n</tr>\n<tr>\n<th>Message<br><small>(Required)</small></th>\n<td><tt><?php echo $bug_report_msg1;?></tt><br><textarea name='message' id='message' cols='60' rows='4'></textarea><br><br><tt><?php echo $bug_report_msg2;?></tt></td>\n</tr>\n</table>\n\n<p><input type=\"submit\" value=\"Submit Problem Report\"/></p>\n\n\n</form>\n\n</div>\n\n<!-- advanced tab -->\n<div id='tab_advanced'>\n\n<h2>Debug Log</h2>\n<pre id='debug_data_container' style=\"height:300px;\">\n<span id='debug_data'></span>\n</pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=debug&download=true&filename=debug.log\";?>'\" title='Download Debug Log' id='download_debug'>Download Debug Log</button></p>\n\n<h2>Error Log</h2>\n<pre id='error_data_container'><span id='error_data'><i>Error log empty</i></span></pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=error&download=true&filename=error.log\";?>'\" title='Download Error Log' id='download_error' disabled='disabled'>Download Error Log</button></p>\n\n<h2>Command</h2>\n<pre id='command_data_container'><span id='command_data'></span></pre>\n\n</div>\n\n<!-- end tab content -->\n</div>\n\n<!-- always show results -->\n<h2>Results</h2>\n<?php\n// set AM name if it exists\nif (isset($am_id) && $am_id) {\n    $am_url = $am[SR_ARGUMENT::SERVICE_URL];\n    $AM_name = am_name($am_url);\n    print \"<p>Resources on AM (<b>$AM_name</b>):</p>\";\n}\nelse {\n    print \"<p>Resources requested from RSpec:</p>\";\n}\n?>\n\n<div id='results_stop_msg'></div>\n<div class='resources' id='prettyxml'><p><i>Pending... (See 'Detailed Progress' tab for more information.)</i></p></div>\n\n<!-- Jacks container -->\n<link rel=\"stylesheet\" type=\"text/css\" href=\"jacks-app.css\" />\n<link rel=\"stylesheet\" type=\"text/css\" href=\"jacks-editor-app.css\" />\n<script src=\"<?php echo $jacks_stable_url;?>\"></script>\n<div id='jacksContainer' class='jacks resources' style='background-color: white;display: none;'></div>\n\n<div id='results_manifest_link'></div>\n<p>\n<a href=\"dashboard.php#slices\">Back to All slices</a><br>\n<a href=\"slice.php?slice_id=<?php echo $slice_id; ?>\">Back to Slice <i><?php echo $slice_name; ?></i></a>\n</p>\n\n<?php\n\ninclude \"tabs.js\";\ninclude(\"footer.php\");\n\n?>\n"], "fixing_code": ["<?php\n//----------------------------------------------------------------------\n// Copyright (c) 2011-2016 Raytheon BBN Technologies\n//\n// Permission is hereby granted, free of charge, to any person obtaining\n// a copy of this software and/or hardware specification (the \"Work\") to\n// deal in the Work without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense,\n// and/or sell copies of the Work, and to permit persons to whom the Work\n// is furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be\n// included in all copies or substantial portions of the Work.\n//\n// THE WORK IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n// HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n// WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE WORK OR THE USE OR OTHER DEALINGS\n// IN THE WORK.\n//----------------------------------------------------------------------\n?>\n<?php\nrequire_once(\"settings.php\");\nrequire_once('portal.php');\nrequire_once(\"user.php\");\nrequire_once(\"file_utils.php\");\nrequire_once(\"sr_client.php\");\nrequire_once(\"sr_constants.php\");\nrequire_once(\"am_client.php\");\nrequire_once(\"am_map.php\");\nrequire_once(\"sa_client.php\");\nrequire_once(\"print-text-helpers.php\");\nrequire_once(\"logging_client.php\");\nrequire_once(\"header.php\");\n$user = geni_loadUser();\nif (!isset($user) || is_null($user) || ! $user->isActive()) {\n  relative_redirect('home.php');\n}\n\nfunction no_slice_error() {\n  header('HTTP/1.1 404 Not Found');\n  print 'No slice id specified.';\n  exit();\n}\n\nfunction no_invocation_id_error() {\n  header('HTTP/1.1 404 Not Found');\n  print 'No omni invocation id and/or user ID specified.';\n  exit();\n}\n\n// redirect if no attributes passed in\nif (! count($_REQUEST)) {\n  no_slice_error();\n}\n\n// set user ID and invocation\nif(array_key_exists(\"invocation_id\", $_REQUEST) &&\n        array_key_exists(\"invocation_user\", $_REQUEST)) {\n    $invocation_user = $_REQUEST['invocation_user'];\n    $invocation_id = $_REQUEST['invocation_id'];\n    if(!ctype_alnum($invocation_id) || !ctype_alnum($invocation_user))\n    {\n      relative_redirect('dashboard.php#slices');\n    }\n}\nelse {\n    no_invocation_id_error();\n}\n\n// set slice/AM information\nunset($slice);\nunset($am);\ninclude(\"tool-lookupids.php\");\nif (! isset($slice)) {\n  no_slice_error();\n}\n\n// redirect if slice has expired\nif (isset($slice_expired) && convert_boolean($slice_expired)) {\n  if (! isset($slice_name)) {\n    $slice_name = \"\";\n  }\n  $_SESSION['lasterror'] = \"Slice \" . $slice_name . \" is expired.\";\n  relative_redirect('dashboard.php#slices');\n}\n\n// redirect if user isn't allowed to look up slice\nif(!$user->isAllowed(SA_ACTION::LOOKUP_SLICE, CS_CONTEXT_TYPE::SLICE, $slice_id)) {\n  relative_redirect('home.php');\n}\n\n// show header and breadcrumbs\nshow_header('GENI Portal: Add Resources to Slice (Results)');\ninclude(\"tool-breadcrumbs.php\");\ninclude(\"tool-showmessage.php\");\n\n// check that invocation ID actually points to a directory\n$dir_to_check = get_invocation_dir_name($invocation_user, $invocation_id);\nif(!is_dir($dir_to_check)) {\n    echo \"<h1>Add Resources to GENI Slice <i>$slice_name</i> (Results)</h1>\";\n    echo \"<p class='error'>Files and process data related to omni request\";\n    echo \" <b>$invocation_user-$invocation_id</b> not found.\";\n    echo \" Older files are periodically removed from the Portal, so it is possible that the files\";\n    echo \" and process-related data have been deleted as part of routine maintenance.\";\n    echo \"<br><br>\";\n    echo \"Please <a href='contact-us.php'>contact us</a> if you require further assistance.</p>\";\n\n    echo '<form method=\"GET\" action=\"back\">';\n    echo '<input type=\"button\" value=\"Back\" onClick=\"history.back(-1)\"/>';\n    echo '</form>';\n    include(\"footer.php\");\n    error_log(\"sliceresource.php: Failed to find directory with invocation ID \" .\n        \"$invocation_id and user $invocation_user.\");\n    exit;\n}\n\n// set e-mail footer message\n$bug_report_msg1 = \"Attached is a problem report about reserving resources generated from the GENI Portal (https://portal.geni.net/). This problem report contains process-related information such as log files, resource specifications (RSpecs) and metadata.<br><br>User message:\";\n$bug_report_msg2 = \"Thanks,<br>\" . $user->prettyName();\n$bug_report_subject = \"GENI Portal Reservation Problem Report\";\n\n/*\n    since AM ID is optional for this page, it needs to be explicitly\n    set if tool-lookupids.php hasn't already set it - there's no else clause\n    in tool-lookupids.php because the assumption is that the page would have\n    already shown an error earlier if $REQUEST['am_id'] hadn't been specified\n*/\nif(!isset($am_id)) {\n    $am_id = NULL;\n}\n\nprint '<script src=\"jacks-lib.js\"></script>';\ninclude(\"sliceresource.js\");\n\necho \"<h1>Add Resources to GENI Slice <i>$slice_name</i> (Results)</h1>\";\necho \"<div style='position:relative;'>\";\necho \"<p style='margin-left:0px;'>Total run time: <b><span id='total_run_time'></span></b> \";\necho \"<br>Status: <span id='total_run_time_status'></span></p>\";\necho \"<div style='position:absolute;top:0px;right:0px;'>\";\necho \"<p style='margin:0px;text-align:right;'>Started at: <b><span id='start_time'></span></b><br><span id='last_updated_or_finished_text'>Last updated:</span> <b><span id='last_updated_or_finished_time'></span></b></p>\";\necho \"</div></div>\";\n\n$request_rspec_filename = $slice_name . \"_request_rspec.xml\";\n$manifest_rspec_filename = $slice_name . \"_manifest_rspec.xml\";\n?>\n\n  <div id='tablist'>\n\t\t<ul class='tabs'>\n\t\t\t<li><a href='#tab_results'>Results</a></li>\n\t\t\t<li><a href='#tab_progress'>Detailed Progress</a></li>\n\t\t\t<li><a href='#tab_request_rspec'>Request RSpec</a></li>\n\t\t\t<li><a href='#tab_manifest_rspec'>Manifest RSpec</a></li>\n\t\t\t<li><a href='#tab_send_bug_report'>Send Problem Report</a></li>\n\t\t\t<li style=\"border-right: none\"><a href='#tab_advanced'>Advanced</a></li>\n\t\t</ul>\n  </div>\n\n<!-- begin tab content -->\n<div class='tabContent'>\n\n<!-- resource 'tab' - this is empty so that the results (which always appear on\n     each tab) will show at the top -->\n<div id='tab_results'>\n</div>\n\n<!-- progress tab -->\n<div id='tab_progress'>\n\n<h2>Detailed Progress</h2>\n<pre id='console_data_container' style=\"height:300px;\">\n<span id='console_data'></span>\n</pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=console&download=true&filename=detailed_progress.log\";?>'\" title='Download Detailed Progress Log' id='download_console'>Download Detailed Progress Log</button></p>\n</div>\n\n<!-- request RSpec tab -->\n<div id='tab_request_rspec'>\n\n<h2>Request RSpec</h2>\n<pre id='requestrspec_container' style=\"height:300px;\"><span id='requestrspec_data'></span></pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=requestrspec&download=true&filename=$request_rspec_filename\";?>'\" title='Download Request RSpec' id='download_requestrspec'>Download Request RSpec</button></p>\n</div>\n\n<!-- manifest RSpec tab -->\n<div id='tab_manifest_rspec'>\n\n<h2>Manifest RSpec</h2>\n<pre id='manifestrspec_container' style=\"height:300px;\"><span id='manifestrspec_data'><i>Manifest RSpec empty</i></span></pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=manifestrspec&download=true&filename=$manifest_rspec_filename\";?>'\" title='Download Manifest RSpec' id='download_manifestrspec' disabled='disabled'>Download Manifest RSpec</button></p>\n</div>\n\n\n<!-- send bug report tab -->\n<div id='tab_send_bug_report'>\n\n<script>\nfunction validateBugReportSubmit()\n{\n  f1 = document.getElementById(\"f1\");\n  to = document.getElementById(\"to\");\n  message = document.getElementById(\"message\");\n\n  if (to.value && message.value) {\n    f1.submit();\n    return true;\n  } else if(to.value && !(message.value)) {\n    alert(\"Please add a message.\");\n    return false;\n  } else if(!(to.value) && message.value) {\n    alert(\"Please select a recipient e-mail address.\");\n    return false;\n  } else {\n    alert(\"Please select a recipient e-mail address and add a message.\");\n    return false;\n  }\n}\n</script>\n\n<h2>Send a Problem Report</h2>\n\n<p>Ran into a problem or have a question? Search the\n  <a target=\"_blank\" href=\"https://groups.google.com/forum/#!forum/geni-users\">\n    GENI Users</a> archives for answers to similar questions.\n</p>\n\n<ul>\n<li>The problem report will include your name, e-mail address, slice and project information, request RSpec, manifest RSpec(s), progress log, debug log, error log and process metadata.</li>\n<li>The report will not include security-sensitive information such as slice credentials, certificates, private keys and SpeaksFor credentials.</li>\n</ul>\n\n<p>If you are not comfortable sharing your problem report publicly, email it to\n  <a href=\"mailto:<?php echo $portal_help_email;?>\">\n          <?php echo $portal_help_email;?></a>.\n</p>\n\n<form id=\"f1\" action=\"send_bug_report.php\" method=\"post\" enctype=\"multipart/form-data\" onsubmit=\"return validateBugReportSubmit()\">\n<input type=\"hidden\" name=\"invocation_id\" id=\"invocation_id\" value=\"<?php echo $invocation_id;?>\"/>\n<input type=\"hidden\" name=\"invocation_user\" id=\"invocation_user\" value=\"<?php echo $invocation_user;?>\"/>\n<input type=\"hidden\" name=\"slice_id\" id=\"slice_id\" value=\"<?php echo $slice_id;?>\"/>\n\n<table>\n<tr>\n<th>From</th>\n<td><b><?php echo $user->prettyName() . \" &lt;\" . $user->email() . \"&gt;\"; ?></b> (Copy me on the problem report e-mail:<input type=\"checkbox\" name=\"copy\" id='copy' value=\"true\"/>)</td>\n</tr>\n<tr>\n<th>Subject</th>\n<td><b><?php echo $bug_report_subject; ?></b></td>\n</tr>\n<tr>\n<th>To<br><small>(Required)</small></th>\n<td><b>Recipient e-mail:</b> <input type='text' name='to' id='to' size='30' value='geni-users@googlegroups.com'></input><br></td>\n</tr>\n<tr>\n<th>Message<br><small>(Required)</small></th>\n<td><tt><?php echo $bug_report_msg1;?></tt><br><textarea name='message' id='message' cols='60' rows='4'></textarea><br><br><tt><?php echo $bug_report_msg2;?></tt></td>\n</tr>\n</table>\n\n<p><input type=\"submit\" value=\"Submit Problem Report\"/></p>\n\n\n</form>\n\n</div>\n\n<!-- advanced tab -->\n<div id='tab_advanced'>\n\n<h2>Debug Log</h2>\n<pre id='debug_data_container' style=\"height:300px;\">\n<span id='debug_data'></span>\n</pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=debug&download=true&filename=debug.log\";?>'\" title='Download Debug Log' id='download_debug'>Download Debug Log</button></p>\n\n<h2>Error Log</h2>\n<pre id='error_data_container'><span id='error_data'><i>Error log empty</i></span></pre>\n<p><button onClick=\"window.location='<?php echo \"get_omni_invocation_data.php?invocation_user=$invocation_user&invocation_id=$invocation_id&slice_id=$slice_id&request=error&download=true&filename=error.log\";?>'\" title='Download Error Log' id='download_error' disabled='disabled'>Download Error Log</button></p>\n\n<h2>Command</h2>\n<pre id='command_data_container'><span id='command_data'></span></pre>\n\n</div>\n\n<!-- end tab content -->\n</div>\n\n<!-- always show results -->\n<h2>Results</h2>\n<?php\n// set AM name if it exists\nif (isset($am_id) && $am_id) {\n    $am_url = $am[SR_ARGUMENT::SERVICE_URL];\n    $AM_name = am_name($am_url);\n    print \"<p>Resources on AM (<b>$AM_name</b>):</p>\";\n}\nelse {\n    print \"<p>Resources requested from RSpec:</p>\";\n}\n?>\n\n<div id='results_stop_msg'></div>\n<div class='resources' id='prettyxml'><p><i>Pending... (See 'Detailed Progress' tab for more information.)</i></p></div>\n\n<!-- Jacks container -->\n<link rel=\"stylesheet\" type=\"text/css\" href=\"jacks-app.css\" />\n<link rel=\"stylesheet\" type=\"text/css\" href=\"jacks-editor-app.css\" />\n<script src=\"<?php echo $jacks_stable_url;?>\"></script>\n<div id='jacksContainer' class='jacks resources' style='background-color: white;display: none;'></div>\n\n<div id='results_manifest_link'></div>\n<p>\n<a href=\"dashboard.php#slices\">Back to All slices</a><br>\n<a href=\"slice.php?slice_id=<?php echo $slice_id; ?>\">Back to Slice <i><?php echo $slice_name; ?></i></a>\n</p>\n\n<?php\n\ninclude \"tabs.js\";\ninclude(\"footer.php\");\n\n?>\n"], "filenames": ["portal/www/portal/sliceresource.php"], "buggy_code_start_loc": [64], "buggy_code_end_loc": [64], "fixing_code_start_loc": [65], "fixing_code_end_loc": [69], "type": "CWE-79", "message": "A vulnerability classified as problematic has been found in GENI Portal. This affects the function no_invocation_id_error of the file portal/www/portal/sliceresource.php. The manipulation of the argument invocation_id/invocation_user leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 39a96fb4b822bd3497442a96135de498d4a81337. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218475.", "other": {"cve": {"id": "CVE-2020-36654", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-18T08:15:10.073", "lastModified": "2023-01-25T19:25:21.523", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic has been found in GENI Portal. This affects the function no_invocation_id_error of the file portal/www/portal/sliceresource.php. The manipulation of the argument invocation_id/invocation_user leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 39a96fb4b822bd3497442a96135de498d4a81337. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218475."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:geni:geni-portal:*:*:*:*:*:*:*:*", "versionEndExcluding": "2020-08-27", "matchCriteriaId": "3CBA439B-EA3D-4DD2-A84F-AFE2CF9A4DF7"}]}]}], "references": [{"url": "https://github.com/GENI-NSF/geni-portal/commit/39a96fb4b822bd3497442a96135de498d4a81337", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/GENI-NSF/geni-portal/pull/1824", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.218475", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.218475", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/GENI-NSF/geni-portal/commit/39a96fb4b822bd3497442a96135de498d4a81337"}}