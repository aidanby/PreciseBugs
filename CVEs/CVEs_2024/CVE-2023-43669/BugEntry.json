{"buggy_code": ["# 0.20.0\n- Remove many implicit flushing behaviours. In general reading and writing messages will no \n  longer flush until calling `flush`. An exception is automatic responses (e.g. pongs) \n  which will continue to be written and flushed when reading and writing.\n  This allows writing a batch of messages and flushing once, improving performance.\n- Add `WebSocket::read`, `write`, `send`, `flush`. Deprecate `read_message`, `write_message`, `write_pending`.\n- Add `FrameSocket::read`, `write`, `send`, `flush`. Remove `read_frame`, `write_frame`, `write_pending`. \n  Note: Previous use of `write_frame` may be replaced with `send`.\n- Add `WebSocketContext::read`, `write`, `flush`. Remove `read_message`, `write_message`, `write_pending`.\n  Note: Previous use of `write_message` may be replaced with `write` + `flush`.\n- Remove `send_queue`, replaced with using the frame write buffer to achieve similar results.\n  * Add `WebSocketConfig::max_write_buffer_size`. Deprecate `max_send_queue`.\n  * Add `Error::WriteBufferFull`. Remove `Error::SendQueueFull`.\n    Note: `WriteBufferFull` returns the message that could not be written as a `Message::Frame`.\n- Add ability to buffer multiple writes before writing to the underlying stream, controlled by\n  `WebSocketConfig::write_buffer_size` (default 128 KiB). Improves batch message write performance.\n- Panic on receiving invalid `WebSocketConfig`.\n\n# 0.19.0\n\n- Update TLS dependencies.\n- Exchanging `base64` for `data-encoding`.\n\n# 0.18.0\n\n- Make handshake dependencies optional with a new `handshake` feature (now a default one!).\n- Return HTTP error responses (their HTTP body) upon non 101 status codes.\n\n# 0.17.3\n\n- Respect the case-sentitivity of the \"Origin\" header to keep compatibility with the older servers that use case-sensitive comparison.\n\n# 0.17.2\n\n- Fix panic when invalid manually constructed `http::Request` is passed to `tungstenite`.\n- Downgrade the MSRV to `1.56` due to some other crates that rely on us not being quite ready for `1.58`.\n\n# 0.17.1\n\n- Specify the minimum required Rust version.\n\n# 0.17.0\n\n- Update of dependencies (primarily `sha1`).\n- Add support of the fragmented messages (allow the user to send the frames without composing the full message).\n- Overhaul of the client's request generation process. Now the users are able to pass the constructed `http::Request` \"as is\" to `tungstenite-rs`, letting the library to check the correctness of the request and specifying their own headers (including its own key if necessary). No changes for those ones who used the client in a normal way by connecting using a URL/URI (most common use-case).\n\n# 0.16.0\n\n- Update of dependencies (primarily `rustls`, `webpki-roots`, `rustls-native-certs`).\n- When the close frame is received, the reply that is automatically sent to the initiator has the same code (so we just echo the frame back). Previously a new close frame was created (i.e. the close code / reason was always the same regardless of what code / reason specified by the initiator). Now it\u2019s more symmetrical and arguably more intuitive behavior (see [#246](https://github.com/snapview/tungstenite-rs/pull/246) for more context).\n- The internal `ReadBuffer` implementation uses heap instead of stack to store the buffer. This should solve issues with possible stack overflows in some scenarios (see [#241](https://github.com/snapview/tungstenite-rs/pull/241) for more context).\n\n# 0.15.0\n\n- Allow selecting the method of loading root certificates if `rustls` is used as TLS implementation.\n  - Two new feature flags `rustls-tls-native-roots` and `rustls-tls-webpki-roots` have been added\n    that activate the respective method to load certificates.\n  - The `rustls-tls` flag was removed to raise awareness of this change. Otherwise, compilation\n    would have continue to work and potential errors (due to different or missing certificates)\n    only occurred at runtime.\n  - The new feature flags are additive. If both are enabled, both methods will be used to add\n    certificates to the TLS configuration.\n- Allow specifying a connector (for more fine-grained configuration of the TLS).\n\n# 0.14.0\n\n- Use `rustls-native-certs` instead of `webpki-root` when `rustls-tls` feature is enabled.\n- Don't use `native-tls` as a default feature (see #202 for more details).\n- New fast and safe implementation of the reading buffer (replacement for the `input_buffer`).\n- Remove some errors from the `Error` enum that can't be triggered anymore with the new buffer implementation.\n\n# 0.13.0\n\n- Add `CapacityError`, `UrlError`, and `ProtocolError` types to represent the different types of capacity, URL, and protocol errors respectively.\n- Modify variants `Error::Capacity`, `Error::Url`, and `Error::Protocol` to hold the above errors types instead of string error messages.\n- Add `handshake::derive_accept_key` to facilitate external handshakes.\n- Add support for `rustls` as TLS backend. The previous `tls` feature flag is now removed in favor\n  of `native-tls` and `rustls-tls`, which allows to pick the TLS backend. The error API surface had\n  to be changed to support the new error types coming from rustls related crates.\n\n# 0.12.0\n\n- Add facilities to allow clients to follow HTTP 3XX redirects.\n- Allow accepting unmasked clients on the server side to be compatible with some legacy / invalid clients.\n- Update of dependencies and documentation fixes.\n"], "fixing_code": ["# 0.20.1\n\n- Fixes [CVE-2023-43669](https://github.com/snapview/tungstenite-rs/pull/379).\n\n# 0.20.0\n- Remove many implicit flushing behaviours. In general reading and writing messages will no \n  longer flush until calling `flush`. An exception is automatic responses (e.g. pongs) \n  which will continue to be written and flushed when reading and writing.\n  This allows writing a batch of messages and flushing once, improving performance.\n- Add `WebSocket::read`, `write`, `send`, `flush`. Deprecate `read_message`, `write_message`, `write_pending`.\n- Add `FrameSocket::read`, `write`, `send`, `flush`. Remove `read_frame`, `write_frame`, `write_pending`. \n  Note: Previous use of `write_frame` may be replaced with `send`.\n- Add `WebSocketContext::read`, `write`, `flush`. Remove `read_message`, `write_message`, `write_pending`.\n  Note: Previous use of `write_message` may be replaced with `write` + `flush`.\n- Remove `send_queue`, replaced with using the frame write buffer to achieve similar results.\n  * Add `WebSocketConfig::max_write_buffer_size`. Deprecate `max_send_queue`.\n  * Add `Error::WriteBufferFull`. Remove `Error::SendQueueFull`.\n    Note: `WriteBufferFull` returns the message that could not be written as a `Message::Frame`.\n- Add ability to buffer multiple writes before writing to the underlying stream, controlled by\n  `WebSocketConfig::write_buffer_size` (default 128 KiB). Improves batch message write performance.\n- Panic on receiving invalid `WebSocketConfig`.\n\n# 0.19.0\n\n- Update TLS dependencies.\n- Exchanging `base64` for `data-encoding`.\n\n# 0.18.0\n\n- Make handshake dependencies optional with a new `handshake` feature (now a default one!).\n- Return HTTP error responses (their HTTP body) upon non 101 status codes.\n\n# 0.17.3\n\n- Respect the case-sentitivity of the \"Origin\" header to keep compatibility with the older servers that use case-sensitive comparison.\n\n# 0.17.2\n\n- Fix panic when invalid manually constructed `http::Request` is passed to `tungstenite`.\n- Downgrade the MSRV to `1.56` due to some other crates that rely on us not being quite ready for `1.58`.\n\n# 0.17.1\n\n- Specify the minimum required Rust version.\n\n# 0.17.0\n\n- Update of dependencies (primarily `sha1`).\n- Add support of the fragmented messages (allow the user to send the frames without composing the full message).\n- Overhaul of the client's request generation process. Now the users are able to pass the constructed `http::Request` \"as is\" to `tungstenite-rs`, letting the library to check the correctness of the request and specifying their own headers (including its own key if necessary). No changes for those ones who used the client in a normal way by connecting using a URL/URI (most common use-case).\n\n# 0.16.0\n\n- Update of dependencies (primarily `rustls`, `webpki-roots`, `rustls-native-certs`).\n- When the close frame is received, the reply that is automatically sent to the initiator has the same code (so we just echo the frame back). Previously a new close frame was created (i.e. the close code / reason was always the same regardless of what code / reason specified by the initiator). Now it\u2019s more symmetrical and arguably more intuitive behavior (see [#246](https://github.com/snapview/tungstenite-rs/pull/246) for more context).\n- The internal `ReadBuffer` implementation uses heap instead of stack to store the buffer. This should solve issues with possible stack overflows in some scenarios (see [#241](https://github.com/snapview/tungstenite-rs/pull/241) for more context).\n\n# 0.15.0\n\n- Allow selecting the method of loading root certificates if `rustls` is used as TLS implementation.\n  - Two new feature flags `rustls-tls-native-roots` and `rustls-tls-webpki-roots` have been added\n    that activate the respective method to load certificates.\n  - The `rustls-tls` flag was removed to raise awareness of this change. Otherwise, compilation\n    would have continue to work and potential errors (due to different or missing certificates)\n    only occurred at runtime.\n  - The new feature flags are additive. If both are enabled, both methods will be used to add\n    certificates to the TLS configuration.\n- Allow specifying a connector (for more fine-grained configuration of the TLS).\n\n# 0.14.0\n\n- Use `rustls-native-certs` instead of `webpki-root` when `rustls-tls` feature is enabled.\n- Don't use `native-tls` as a default feature (see #202 for more details).\n- New fast and safe implementation of the reading buffer (replacement for the `input_buffer`).\n- Remove some errors from the `Error` enum that can't be triggered anymore with the new buffer implementation.\n\n# 0.13.0\n\n- Add `CapacityError`, `UrlError`, and `ProtocolError` types to represent the different types of capacity, URL, and protocol errors respectively.\n- Modify variants `Error::Capacity`, `Error::Url`, and `Error::Protocol` to hold the above errors types instead of string error messages.\n- Add `handshake::derive_accept_key` to facilitate external handshakes.\n- Add support for `rustls` as TLS backend. The previous `tls` feature flag is now removed in favor\n  of `native-tls` and `rustls-tls`, which allows to pick the TLS backend. The error API surface had\n  to be changed to support the new error types coming from rustls related crates.\n\n# 0.12.0\n\n- Add facilities to allow clients to follow HTTP 3XX redirects.\n- Allow accepting unmasked clients on the server side to be compatible with some legacy / invalid clients.\n- Update of dependencies and documentation fixes.\n"], "filenames": ["CHANGELOG.md"], "buggy_code_start_loc": [0], "buggy_code_end_loc": [0], "fixing_code_start_loc": [1], "fixing_code_end_loc": [5], "type": "NVD-CWE-noinfo", "message": "The Tungstenite crate before 0.20.1 for Rust allows remote attackers to cause a denial of service (minutes of CPU consumption) via an excessive length of an HTTP header in a client handshake. The length affects both how many times a parse is attempted (e.g., thousands of times) and the average amount of data for each parse attempt (e.g., millions of bytes).", "other": {"cve": {"id": "CVE-2023-43669", "sourceIdentifier": "cve@mitre.org", "published": "2023-09-21T06:15:13.833", "lastModified": "2024-02-16T17:56:45.190", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "The Tungstenite crate before 0.20.1 for Rust allows remote attackers to cause a denial of service (minutes of CPU consumption) via an excessive length of an HTTP header in a client handshake. The length affects both how many times a parse is attempted (e.g., thousands of times) and the average amount of data for each parse attempt (e.g., millions of bytes)."}, {"lang": "es", "value": "El Tungstenite crate anterior a la versi\u00f3n 0.20.1 para Rust permite a atacantes remotos provocar una denegaci\u00f3n del servicio (de minutos de consumo de la CPU) a trav\u00e9s de una longitud excesiva de un encabezado HTTP en el handshake del cliente. La longitud afecta tanto a cu\u00e1ntas veces se intenta un an\u00e1lisis (por ejemplo, miles de veces) y la cantidad promedio de datos para cada intento de an\u00e1lisis (por ejemplo, millones de bytes)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:snapview:tungstenite:*:*:*:*:*:rust:*:*", "versionEndIncluding": "0.20.0", "matchCriteriaId": "12C41B5D-324F-42A2-B0EF-670FD95BAD9B"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*", "matchCriteriaId": "E30D0E6F-4AE8-4284-8716-991DFA48CC5D"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:38:*:*:*:*:*:*:*", "matchCriteriaId": "CC559B26-5DFC-4B7A-A27C-B77DE755DFF9"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:39:*:*:*:*:*:*:*", "matchCriteriaId": "B8EDB836-4E6A-4B71-B9B2-AA3E03E0F646"}]}]}], "references": [{"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2240110", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://bugzilla.suse.com/show_bug.cgi?id=1215563", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://crates.io/crates/tungstenite/versions", "source": "cve@mitre.org", "tags": ["Release Notes"]}, {"url": "https://cwe.mitre.org/data/definitions/407.html", "source": "cve@mitre.org", "tags": ["Technical Description"]}, {"url": "https://github.com/advisories/GHSA-9mcr-873m-xcxp", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/github/advisory-database/pull/2752", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/snapview/tungstenite-rs/commit/8b3ecd3cc0008145ab4bc8d0657c39d09db8c7e2", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/snapview/tungstenite-rs/issues/376", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/R77EUWPZVP5WSMNXUXUDNHR7G7OI5NGM/", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/THK6G6CD4VW6RCROWUV2C4HSINKK3XAK/", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/TT7SF6CQ5VHAGFLWNXY64NFSW4WIWE7D/", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://security-tracker.debian.org/tracker/CVE-2023-43669", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/snapview/tungstenite-rs/commit/8b3ecd3cc0008145ab4bc8d0657c39d09db8c7e2"}}