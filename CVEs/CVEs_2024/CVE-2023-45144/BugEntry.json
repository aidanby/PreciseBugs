{"buggy_code": ["{{velocity output=false}}\n\n## Identity OAuth Config macros\n## - a set of macros useful for editing the OAuth-related configurations\n## - this page should be included with #includeInContext(\"IdentityOAuth.IdentityOAuthConfigMacros\")\n##   so that it defines a few useful constants which you can use, includes javascript and stylesheee\n##   extensions. The macros it defines should be called after all necessary variables are defined,\n##   notably oauthProviderHint.\n## lets the JavaScript and CSS extensions be loaded\n#set ($mainReference = $services.model.createDocumentReference('', 'IdentityOAuth', 'WebPreferences'))\n#if (!$services.licensing.licensor.hasLicensureForEntity($mainReference))\n  $services.identityoauth.init()\n\n  #macro (ioIncludeUIX)\n    $xwiki.jsx.use('IdentityOAuth.IdentityOAuthConfigClass')\n    $xwiki.ssx.use('IdentityOAuth.IdentityOAuthConfigClass')\n  #end\n\n\n  ## defines formId, propNamePrefixIO, propNamePrefixO, configDoc, objIO, objO\n  #macro (initConfigObjects $configDocName $extraObjectClassPropPrefixes $translationPrefixesP)\n    #set($formId = \"${section.toLowerCase()}_${configDocName1}\")\n    #set($configDoc = $xwiki.getDocument($configDocName))\n\n    #set($classNameIO=\"IdentityOAuth.IdentityOAuthConfigClass\")\n    #set($propNamePrefixIO=\"${configDoc.fullName}_${classNameIO}_0\")\n    #set($objIO = $configDoc.getObject($classNameIO))\n\n    #set($translationPrefixes = [])\n    #foreach($p in $translationPrefixesP)\n      #set($nuts=$translationPrefixes.add($p))\n    #end\n    #set($nuts=$translationPrefixes.add('IdentityOAuth.IdentityOAuthConfigClass_'))\n\n    #foreach($x in $extraObjectClassPropPrefixes)\n      #set($shhh = $x.add($x[0]))\n      #set($x[0] = $configDoc.getObject($x[0]))\n    #end\n  #end\n\n\n  ## t: shorthand for translation\n  #macro (alignWithTranslationPrefixes $name)\n    #set($tn = [])\n    #foreach($p in $translationPrefixes)\n      #set($nuts=$tn.add(\"${p}${name}\"))\n    #end\n  #end\n  #macro (t $name)\n    #alignWithTranslationPrefixes($name)\n    $services.localization.render($tn)\n  #end\n\n  ## tp: shorthand for translation with parameters\n  #macro (tp $name $params)##\n    #alignWithTranslationPrefixes($name)\n    #set ($msg = $services.localization.render($tn,$params))##\n    ## convert to <a href=\"link\">link-text</a> for the simple wiki syntax of links\n    $stringtool.replacePattern($msg, '\\[\\[([^>]*)>>([^\\]]*)\\]\\]', '<a href=\"$2\">$1</a>')##\n  #end\n\n  ## displayInput: displays the form element of the relevant property of the object having removed the\n  ##   html macro around it.\n  #macro (displayInput $property $obj)\n    #set ($output = $doc.display($property, 'edit', $obj))\n    #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n    #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n    $output\n  #end\n\n  #macro (renderRedirectUrlInputAndHints)\n    #displayInput ('redirectUrl', $objIO)<br/>\n    <span class=\"xHint\" id=\"redirectUrlAsExpected\">#t('redirectUrl.asExpected')</span>\n    <span class=\"xHint\" id=\"redirectUrlAsServers\">#t('redirectUrl.asExpectedServers')</span>\n    <span class=\"xHint\" id=\"redirectUrlAsBrowsers\">#t('redirectUrl.asExpectedBrowsers')</span>\n    <span class=\"xHint\" id=\"redirectUrlDifferentOfAll\">#t('redirectUrl.notAsExpectedAny')</span>\n    <span class=\"xHint\" id=\"redirectMakeItLikePredicted\">##\n      (<a href=\"#\" onclick=\"return resetRedirectUrlBrowser()\">#t('redirectUrl.recalc.predicted'))</a></span>\n    <span class=\"xHint\" id=\"redirectMakeItLikePredictedBrowser\">##\n      (<a href=\"#\" onclick=\"return resetRedirectUrlBrowser()\">#t('redirectUrl.recalc.browser'))</a></span>\n    <span class=\"xHint\" id=\"redirectMakeItLikePredictedServer\">\n      (<a href=\"#\" onclick=\"return resetRedirectUrlServer()\">#t('redirectUrl.recalc.server'))</a></span>\n  #end\n\n  #macro (calcReturnUrlsJS)\n  <script type=\"text/javascript\">\n      #set($serverReturn=$xwiki.getURL('XWiki.XWikiLogin', 'login')) ## typically a host-absolute URL\n      // serverReturn: $serverReturn\n      #if($serverReturn.startsWith(\"http://\") || $serverReturn.startsWith(\"https://\"))\n        ## all good\n      #elseif($serverReturn.startsWith('/'))\n        #set($absUrl = $xcontext.request.requestURL)\n      // absUrl: $absUrl\n        #set($serverReturn = \"${absUrl.substring(0, $absUrl.indexOf('/',8))}${serverReturn}\")\n      #end\n      window.placeHolderForRedirectUrl = '#tp(\"redirectUrl.placeHolderMessage\", [\"${serverReturn}\"])';\n      var p = window.location.href.indexOf('/admin');\n      window.browserReturnUrl = (p === -1 ?\n              window.location.href :\n              window.location.href.substring(0, p)) + \"/login/XWiki/XWikiLogin\"\n  </script>\n  #end\n\n  #set($hasLoadedMacros=true)\n#end\n{{/velocity}}", "{{velocity output=\"false\"}}\n#macro (renderLoginCodes $loginCodes $hasSeveralLogins)\n  #set ($count = 0)\n  #set ($loginCodeWrapperStart = '<div class=\"identity-oauth-provider-login\">')\n  #foreach ($loginCode in $identityOAuth.renderLoginCodes())\n    #set ($count = $mathtool.add($count, 1))\n    #set ($loginCodes=\"${loginCodes}${loginCodeWrapperStart}${loginCode}</div>\")\n  #end\n  #set ($hasSeveralLogins = $count > 0)\n#end\n{{/velocity}}\n\n{{velocity}}\n#set ($mainReference = $services.model.createDocumentReference('', 'IdentityOAuth', 'WebPreferences'))\n#set ($generalConfigDoc = $xwiki.getDocument('IdentityOAuth.IdentityOAuthGeneralConfiguration'))\n#set ($generalConfigObj = $generalConfigDoc.getObject('IdentityOAuth.IdentityOAuthGeneralConfigClass'))\n#if ($xcontext.getAction()==\"login\" && $doc.fullName==\"XWiki.XWikiLogin\")\n  #if (!$services.licensing.licensor.hasLicensureForEntity($mainReference))\n    #set($statusMessage = \"identityOAuth installed but not licensed.\")\n  #else\n    #set($identityOAuth = $services.idoauth)\n    #if ($identityOAuth.doesDetectReturn())\n      #set($statusMessage = \"IdentityOAuth: return of the OAuth bounce; if all goes well, the user can be logged in.\")\n      #set($result = $identityOAuth.processOAuthReturn())\n      #set($prfx = \"failed login:\")\n      #if ($result.startsWith($prfx))\n        #set($email = $result.substring($prfx.length()))\n        #set($errorMsg = \" ${services.localization.render('idoauth.login.domainerror1')} \")\n        #set($errorMsg = \" ${errorMsg} ${services.localization.render('idoauth.login.domainerror2')} $!{email}.\")\n        #set($errorMsg = \" ${errorMsg} ${services.localization.render('idoauth.login.domainerror3')}\")\n      #elseif ($result==\"ok\")\n        #set($successM = ${services.localization.render(\"idoauth.login.redirectmessage\")})\n        ## the browser should have been redirected by processOAuthReturn\n      #else ## $result is \"no user\"\n        #set($errorMsg = ${services.localization.render('idoauth.login.message')})\n        #set($errorMsg = \" ${errorMsg} ${services.localization.render('idoauth.login.error')}\")\n        #if($request.getAttribute(\"idoauth-error-message\"))\n          #set($errorMsg = \"${errorMsg}: ${request.getAttribute('idoauth-error-message')}\")\n        #end\n      #end\n    #elseif ($request.identityOAuth == \"start\")\n      ## Don't alter the login form in case the XWiki default implementation is requested.\n      #if (\"$!request.provider\" != \"default\")\n        #set($statusMsg = \"IdentityOAuth Start login, should bounce to the provider.\")\n        #set($succesMsg = $services.localization.render(\"idoauth.login.oauth.message\"))\n        #set($success = $identityOAuth.processOAuthStart()) <!-- processOAuthStart: $success -->\n        #if($success)\n          #if($request.state)\n            #set($successMsg = $services.localization.render(\"idoauth.login.oauth.successwithredirect\"))\n          #else\n            #set($successMsg = $services.localization.render(\"idoauth.login.oauth.success\"))\n          #end\n        #else\n          #set($errorMsg = $services.localization.render(\"idoauth.login.oauth.failedOAuth\"))\n        #end\n      #end\n    #elseif ($request.identityOAuth)\n      #set($statusMsg = \"no such identityOAuth operation '$request.identityOAuth'\")\n    #else\n      #set($statusMsg = \"Login page\")\n      ## assemble the login code from the providers\n      #set($loginCodes = '<div id=\"idoauth-login-choice\">\n                             <div class=\"col-xs-12\">')\n      #renderLoginCodes($loginCodes $hasSeveralLogins)\n      #set($loginCodes=\"${loginCodes}</div><div style='clear: both;'></div></div>\")\n    #end\n\n    ## ============================================== end of velocity preparation ===============================\n\n    {{html clean=\"false\" wiki=\"false\"}}<!-- this is IdentityOAuth -->\n    <!-- This code is displayed on the login page, so we cannot use a ssx skin extension since guest users may have\n    restricted view rights and the style won't be displayed -->\n    <style>\n    .provider-login-button {\n      background: white;\n      color: #333;\n      border: #e8e8e8 2px solid;\n      display: flex;\n      align-items: center;\n    }\n    .provider-login-button >img {\n      height: 1.1em;\n      margin-right: 2%;\n    }\n    .identity-oauth-provider-login {\n      padding: 3% 0;\n    }\n\n    #idoauth-login-choice {\n      margin-bottom: 5%;\n    }\n    </style>\n    <!-- ======= ${statusMsg} ====== -->\n\n    #if ($successMsg || $errorMsg)\n    <script type=\"text/javascript\">\n      // Identity OAuth Login Extension: Success or warning messages\n      document.addEventListener('DOMContentLoaded', function() {\n        var p = document.createElement(\"p\"), div = document.createElement(\"div\");\n        #if ($successMsg)\n          p.innerText = \"${escapetool.javascript($successMsg)}\";\n          div.className = \"box successmessage\";\n        #elseif ($errorMsg)\n          p.innerText = \"${escapetool.javascript($errorMsg)}\";\n          div.className = \"box warningmessage\";\n        #end\n        div.appendChild(p);\n        var c = document.getElementById(\"mainContentArea\")\n        c.insertBefore(div, c.firstChild);\n      });\n    </script>\n    #elseif($hasSeveralLogins)\n    <script type=\"text/javascript\">\n      // Identity OAuth Login Extension: Button: offer a button to go to the provider. Don't alter the login if no other\n      // providers are defined.\n      document.addEventListener('DOMContentLoaded', function() {\n        require(['jquery', 'xwiki-events-bridge', 'xwiki-meta'], function($, xm) {\n          window.loginWithXWiki = function() {\n              jQuery(\".panel .panel-body dl\").show()\n              return false;\n          }\n          if (XWiki.contextaction == \"login\" || XWiki.contextaction == \"loginsubmit\" ) {\n            var url = location.href, baseUrl = url;\n            if (url.indexOf('?') < 0){\n                url=url+'?';\n            } else {\n                baseUrl = url.substring(0, url.indexOf('?'));\n            }\n            if (url.indexOf('identityOAuth=')>=0) {\n                url = url.replace(/identityOAuth=[a-zA-Z]*/, \"identityOAuth=start\");\n            } else {\n                url = url + \"&identityOAuth=start\";\n            }\n            url = url + \"&browserLocation=\" + escape(baseUrl);\n\n            var loginCode = \"${escapetool.javascript($loginCodes)}\";\n            loginCode = loginCode.replace(\"-URL-\",url);\n            jQuery(loginCode).insertBefore(jQuery(\".panel .panel-body dl\"));\n\n            if (XWiki.contextaction != \"loginsubmit\") {\n              jQuery(\".panel .panel-body dl\").hide();\n            }\n          }\n        }); // end requirejs\n      });\n    </script>\n    #end ## if ($successMsg || $errorMsg)\n  {{/html}}\n  #end ## identityOAuth is active\n#end ## on login page\n{{/velocity}}\n", "admin.idoauth=Identity OAuth\n\nidoauth.config.heading=Einstellungen des OAuth Providers\nIdentityOAuth.IdentityOAuthConfigClass_config.explanation=XWiki kann mit externen Identit\u00e4tsanbietern verbunden werdeb.\n\n## Adminstration interface\nIdentityOAuth.IdentityOAuthConfigClass_active=Aktivieren\nIdentityOAuth.IdentityOAuthConfigClass_communicate=Schnittstellen zu dem OAuth Provider\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint=Um eine OAuth Integration zu aktivieren, musst du {0}dein Wiki als App f\u00fcr den OAuth Zugang bei dem Provider registrieren{1} und die genannten Client-ID und Clientschl\u00fcssel in den folgenden Einstellungen einf\u00fcgen.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2=Du erh\u00e4lst mehr Information in den {0}Installationsanweisungen{1}.\n\nIdentityOAuth.IdentityOAuthConfigClass_appname=Name\nIdentityOAuth.IdentityOAuthConfigClass_appname.hint=F\u00fcr deine eigene Organisation\nIdentityOAuth.IdentityOAuthConfigClass_clientid=Client-ID\nIdentityOAuth.IdentityOAuthConfigClass_clientid.hint=Wird vom Provider genannt.\nIdentityOAuth.IdentityOAuthConfigClass_secret=Clientschl\u00fcssel\nIdentityOAuth.IdentityOAuthConfigClass_secret.hint=Wird vom Provider genannt.\n\n\nIdentityOAuth.IdentityOAuthConfigClass_scope=Autorisierungen\nIdentityOAuth.IdentityOAuthConfigClass_scope.hint=Welche Information sollte dieses Wiki von dem Provider abfragen?\nIdentityOAuth.IdentityOAuthConfigClass_scope_identity=Vor- und Nachname.\nIdentityOAuth.IdentityOAuthConfigClass_scope_email=Emailadresse.\nIdentityOAuth.IdentityOAuthConfigClass_scope_avatar=Benutzerprofilbild\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_mandatory=Diese Autorisierung ist n\u00f6tig.\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_notyetdone=Diese Autorisierung wird noch implementiert.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl=R\u00fcckkehr-URL\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.hint=Ein Benutzer macht seinen R\u00fcckkehr auf dieser Seite (mit Extraparametern) nachdem die Autorisierungen best\u00e4tigt wurden.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpected=Diese Adresse ist dieselbe als die von der Loginseite des Wikis, bestimmt durch die aktuelle Browseradresse.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpected=Diese Adresse ist nicht dieselbe als die von der Loginseite des Wikis, bestimmt durch die aktuelle Browseradresse.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.placeHolderMessage=(Defautwert: berechnet durch vom Server; {0})\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedServers=Diese Adresse entspricht die Loginseitenadresse, die das Server berechnet.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedBrowsers=Diese Adresse entspricht die Loginseitenadresse, die aus der Browseradresse berechnet werden kann.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpectedAny=Diese Adresse Entspricht keine bekannte Loginseitenadresse.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.predicted=Die Adresse neu berechnen.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.browser=Die Adresse durch das Server berechnen lassen.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.server=Die Adresse ab der Browseradresse berechnen.\n\nIdentityOAuth.IdentityOAuthConfigClass_loginbehaviour=XWiki Anmeldungsvorgang\nIdentityOAuth.IdentityOAuthConfigClass_useCookies=Cookies anwenden, um die Identifizierung zu erinnern\nIdentityOAuth.IdentityOAuthConfigClass_useCookies.hint=Diese Cookies erlauben Browsers zu erinnern, welche Benutzer benutzt war, um sich zum Wiki anzumelden.\n\nIdentityOAuth.IdentityOAuthConfigClass_warningIncomplete=Die gesamte Informationen sind n\u00f6tig.\n\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat1=Nachdem es gemacht ist, bitte logge dich aus und dann logge dich ein mit dem Provider.\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat2=Wenn du technische Schwierigkeiten hast, dann schreibe bitte support@xwiki.com an.\n\n\n\nidoauth.login.title=Identity OAuth Login\nidoauth.login.withoauth=Mit einem OAuth Provider einloggen\nidoauth.login.withxwiki=Mit XWiki einloggen\n\n## error reporting\nidoauth.login.error=Ein Fehler ist w\u00e4hrend des Logins mit einem OAuth Providers entstanden. Bitte nehmen Sie Kontakt mit dem Administrator oder XWiki Support.\nidoauth.login.message=Du wirst zum OAuth Provider f\u00fcr die Autorisierung weitergeleitet.\nidoauth.login.redirectmessage=Du wirst zur angeforderte Seite weitergeleitet.\nidoauth.login.oauth.message=OAuth Autorisieriung im Lauf\nidoauth.login.oauth.success=Erfolgreiche Autorisierung.\nidoauth.login.oauth.successwithredirect=Erfolgreiche Autorisierung. Du wirst zur angeforderte Seite weitergeleitet.\n\nidoauth.error.noValidLicense=Diese App hat keine g\u00fcltige Lizenz. Bitte die Lizenzeinstellungseite (in dem Abschnitt Erweiterungen der globalen Einstelllungen) besuchen, um eine zu erhalten.\nidoauth.error.extensionDisabled=Die OAuth Integration ist auf dieses Wiki deaktiviert.\n\nidoauth.webHome.1=Dieses Space ist der Code der Identity OAuth Erweiterung. Sie hilft die Integration von OAuth Providers zu leisten.\nidoauth.webHome.2=...\nidoauth.webHome.3=...\nidoauth.webHome.4=Provider-spezifische Einstellungen sind n\u00f6tig. Bitte besuche den Provider''s Abschnitt der XWiki Einstellungen, damit sie angepasst werden.\n", "admin.idoauth=Identity OAuth\n\nidoauth.config.heading=Configuration Int\u00e9gration OAuth\nIdentityOAuth.IdentityOAuthConfigClass_config.explanation=XWiki peut \u00eatre int\u00e9gr\u00e9 avec un fournisseur externe d'identit\u00e9.\n\n## Adminstration interface\nIdentityOAuth.IdentityOAuthConfigClass_active=Activer\nIdentityOAuth.IdentityOAuthConfigClass_communicate=Communication avec les services OAuth\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint=Afin d''activer l''int\u00e9gration OAuth vous devez vous enregistrer pour l''acc\u00e8s \u00e0 OAuth chez le fournisseur et ins\u00e9rer les informations dans les param\u00e8tres suivants.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2=Voir aussi {0}les instructions d''installation{1}.\n\nIdentityOAuth.IdentityOAuthConfigClass_appname=Nom de l'application\nIdentityOAuth.IdentityOAuthConfigClass_appname.hint=Pour votre propre organisation.\nIdentityOAuth.IdentityOAuthConfigClass_clientid=ID client\nIdentityOAuth.IdentityOAuthConfigClass_clientid.hint=Indiqu\u00e9 dans la page de l'application.\nIdentityOAuth.IdentityOAuthConfigClass_secret=Cl\u00e9 secr\u00e8te\nIdentityOAuth.IdentityOAuthConfigClass_secret.hint=Indiqu\u00e9 dans la page de l'application.\n\n\nIdentityOAuth.IdentityOAuthConfigClass_scope=Types de  permissions\nIdentityOAuth.IdentityOAuthConfigClass_scope.hint=Quelle information devrait \u00eatre demand\u00e9es par le wiki au fournisseurs d'identit\u00e9s?\nIdentityOAuth.IdentityOAuthConfigClass_scope_identity=Nom et pr\u00e9nom\nIdentityOAuth.IdentityOAuthConfigClass_scope_email=Adresse email\nIdentityOAuth.IdentityOAuthConfigClass_scope_avatar=Photo de profil\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_mandatory=Ceci est n\u00e9cessaire\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_notyetdone=Ceci n'est pas encore impl\u00e9ment\u00e9\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl=URL de retour\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.hint=L'utilisateur revient \u00e0 la page de login de ce wiki avec des param\u00e8tres suppl\u00e9mentaires pour indiquer l'autorisation OAuth.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpected=Ceci devrait \u00eatre la bonne adresse d'apr\u00e8s l'adresse de votre navigateur.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpected=Ceci ne correspond pas \u00e0 l'adresse de votre navigateur.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.placeHolderMessage=(valuer par d\u00e9faut: calcul\u00e9e par le serveur; {0})\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedServers=Cette adresse correspond \u00e0 l'adresse de la page de connexion ainsi que calcul\u00e9e par votre serveur.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedBrowsers=Cette adresse correspond \u00e0 l'adresse de la page de connexion ainsi que calcul\u00e9e par votre navigateur.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpectedAny=Cette adresse ne correspond pas \u00e0 l'adresse connue de la page de connexion.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.predicted=Recalculer l'adresse\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.browser=Recalculer l'adresse d'apr\u00e8s l'adresse du navigateur\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.server=Recalculer l'adresse d'apr\u00e8s l'adresse du serveur\n\nIdentityOAuth.IdentityOAuthConfigClass_loginbehaviour=Comportement de login\nIdentityOAuth.IdentityOAuthConfigClass_useCookies=Utiliser des cookies pour la connexion\nIdentityOAuth.IdentityOAuthConfigClass_useCookies.hint=Les cookies permettent de se rappeler le nom d'utilisateur utilis\u00e9 chez le fournisseur.\n\nIdentityOAuth.IdentityOAuthConfigClass_warningIncomplete=Veuillez fournir toutes les informations ou d\u00e9sactiver l'application.\n\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat1=Vous pouvez v\u00e9rifier votre installation en vous d\u00e9onnectant et reconnectant avec le fournisseur OAuth.\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat2=Si vous avez des difficult\u00e9s, veuillez prendre contact avec support@xwiki.com .\n\n\n\nidoauth.login.title=Connexion Identity OAuth\nidoauth.login.withoauth=Se connecter avec un fournisseur OAuth\nidoauth.login.withxwiki=Se connecter avec XWiki\n\n## error reporting\nidoauth.login.error=Une erreur est survenue durant la connexion par le fournisseur OAuth. Prenez contact avec votre administrateur ou le support XWiki.\nidoauth.login.message=Vous allez \u00eatre redirig\u00e9 vers la page d'autorisation du fournisseur OAuth.\nidoauth.login.redirectmessage=Vous allez \u00eatre redirig\u00e9 vers la page demand\u00e9e.\nidoauth.login.oauth.message=Autorisation OAuth en cours.\nidoauth.login.oauth.success=Autorisation OAuth r\u00e9ussie.\nidoauth.login.oauth.successwithredirect=Autorisation OAuth r\u00e9ussie. Vous allez \u00eatre redirig\u00e9 vers la page demand\u00e9e.\n\nidoauth.error.noValidLicense=Cette app n'a pas de licence valide. Veuillez aller \u00e0 la page des licences (dans les r\u00e9glages) afin d'en obtenir une.\nidoauth.error.extensionDisabled=L'int\u00e9gration OAuth est d\u00e9sactiv\u00e9e sur ce wiki.\n\nidoauth.webHome.1=Cet espace contient le code de l'extension Identity OAuth. Cette extension soutient l'int\u00e9gration de fournisseurs OAuth.\nidoauth.webHome.2=...\nidoauth.webHome.3=...\nidoauth.webHome.4=Des r\u00e9glages sp\u00e9cifiques \u00e0 chaque fournisseur sont n\u00e9cessaires. Visitez la section sp\u00e9cifique au fournisseur pour les ajuster.\n", "\n\nadmin.idoauth=Identity OAuth\nadmin.idoauth.default.heading=Default Identity OAuth Provider\nadmin.idoauth.default.description=Configure the default XWiki login implementation\n\nidoauth.config.heading=Identity OAuth Integration Configuration\nIdentityOAuth.IdentityOAuthConfigClass_config.explanation=XWiki can be integrated with an external provider.\n\n## Adminstration interface\nIdentityOAuth.IdentityOAuthConfigClass_active=Activate\nIdentityOAuth.IdentityOAuthConfigClass_communicate=Communication with the OAuth service\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint=To activate an OAuth integration you need to {0}register for OAuth access to the provider''s configuration{1} and to insert your Client-Id and secret in the following settings.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2=For more information, please see {0}the installation instructions{1}.\n\nIdentityOAuth.IdentityOAuthConfigClass_appname=Application Name\nIdentityOAuth.IdentityOAuthConfigClass_appname.hint=For your own organisation.\nIdentityOAuth.IdentityOAuthConfigClass_clientid=Client ID\nIdentityOAuth.IdentityOAuthConfigClass_clientid.hint=The provider indicates this.\nIdentityOAuth.IdentityOAuthConfigClass_secret=Secret Key\nIdentityOAuth.IdentityOAuthConfigClass_secret.hint=The provider indicates this.\n\n\nIdentityOAuth.IdentityOAuthConfigClass_scope=Permissions to request\nIdentityOAuth.IdentityOAuthConfigClass_scope.hint=Which information should XWiki request to the the provider about the account?\nIdentityOAuth.IdentityOAuthConfigClass_scope_identity=First and last name\nIdentityOAuth.IdentityOAuthConfigClass_scope_email=Email address\nIdentityOAuth.IdentityOAuthConfigClass_scope_avatar=User image\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_mandatory=This is required\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_notyetdone=This is not implemented yet\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl = Return URL\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.hint = A user is returned  to the login page of this wiki with extra parameters after the OAuth authorization.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpected = This address matches the login page URL that can be expected from the URL of your browser.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpected = This address does not match the login page URL that can be expected from the URL of your browser.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.placeHolderMessage = (default: computed by the server; {0})\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedServers = This address matches the login page URL that can be expected from the URL of your server.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedBrowsers = This address matches the login page URL that can be expected from the URL of your browser.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpectedAny = This address does not match the login page URL.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.predicted = Recalculate URL\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.browser = Recalculate URL from the current browser page\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.server = Recalculate URL from the server\n\nIdentityOAuth.IdentityOAuthConfigClass_loginbehaviour=XWiki Login Behaviour\nIdentityOAuth.IdentityOAuthConfigClass_useCookies=Use of cookies for Login\nIdentityOAuth.IdentityOAuthConfigClass_useCookies.hint=These cookies allow browsers to remember which user was used to login to the Wiki.\n\nIdentityOAuth.IdentityOAuthConfigClass_warningIncomplete=Please provide all information or disable the app.\n\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat1=Using a different browser, please try to login to the XWiki.\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat2=Should you need support, please ask support@xwiki.com\n\nIdentityOAuth.IdentityOAuthGeneralConfigClass_displayXWikiLogin.hint=Whether to display the XWiki option on the login page\n\nIdentityOAuth.OAuthProviderClass_active.hint=Whether this provider should be displayed on the login page\n\nidoauth.login.title=Identity OAuth Login\nidoauth.login.withoauth=Login with an OAuth provider\nidoauth.login.withxwiki=Login with XWiki\n\n## error reporting\nidoauth.login.error=An error occurred while trying to login with the OAuth provider. Please contact XWiki Support for help or try again.\nidoauth.login.message=You are being redirected to the OAuth provider for Authentication.\nidoauth.login.redirectmessage=You are being redirected to your requested page.\nidoauth.login.oauth.message=OAuth authentication in progress\nidoauth.login.oauth.success=Successful authentication.\nidoauth.login.oauth.successwithredirect=Successful authentication. You are being redirected to your page.\n\nidoauth.error.noValidLicense=A license for this application is missing. Please visit the License setting (in the Extensions section) to obtain one.\nidoauth.error.extensionDisabled=The IdentityOAuth integration is disabled on this wiki.\n\nidoauth.webHome.1=This is the code for the Identity OAuth extension, allowing to integrate XWiki with external provider's identities.\nidoauth.webHome.2=...\nidoauth.webHome.3=...\nidoauth.webHome.4=Go to Provider's section of the XWiki Preferences in order to configure the application.\n\n", "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc>\n  <web>IdentityOAuth</web>\n  <name>WebHome</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <parent>IdentityOAuth.WebHome</parent>\n  <creator>xwiki:XWiki.Admin</creator>\n  <author>xwiki:XWiki.Admin</author>\n  <customClass/>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Identity OAuth</title>\n  <defaultTemplate/>\n  <validationScript/>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{include reference=\"Licenses.Code.VelocityMacros\"/}}\n\n{{velocity}}\n#set ($mainReference = $services.model.createDocumentReference('', 'IdentityOAuth','OAuth'))\n#if (!$services.licensing.licensor.hasLicensureForEntity($mainReference))\n  {{error}}#getMissingLicenseMessage('idoauth.extension.name'){{/error}}\n#else\n\t$services.localization.render('idoauth.webHome.1')\n\t$services.localization.render('idoauth.webHome.2')\n\t$services.localization.render('idoauth.webHome.3')\n  $services.localization.render('idoauth.webHome.4')\n#end\n\n[[=&gt; More about the IdentityOAuth Application>>https://store.xwiki.com/xwiki/bin/view/Extension/IdentityOAuth]].\n{{/velocity}}\n</content>\n  <attachment>\n    <filename>xwiki-logo.png</filename>\n    <mimetype>image/png</mimetype>\n    <charset>UTF-8</charset>\n    <author>xwiki:XWiki.Admin</author>\n    <version>1.1</version>\n    <comment/>\n    <content>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</content>\n    <filesize>2983</filesize>\n  </attachment>\n</xwikidoc>\n"], "fixing_code": ["{{velocity output=false}}\n\n## Identity OAuth Config macros\n## - a set of macros useful for editing the OAuth-related configurations\n## - this page should be included with #includeInContext(\"IdentityOAuth.IdentityOAuthConfigMacros\")\n##   so that it defines a few useful constants which you can use, includes javascript and stylesheee\n##   extensions. The macros it defines should be called after all necessary variables are defined,\n##   notably oauthProviderHint.\n## lets the JavaScript and CSS extensions be loaded\n#set ($mainReference = $services.model.createDocumentReference('', 'IdentityOAuth', 'WebPreferences'))\n#if (!$services.licensing.licensor.hasLicensureForEntity($mainReference))\n  $services.identityoauth.init()\n\n  #macro (ioIncludeUIX)\n    $xwiki.jsx.use('IdentityOAuth.IdentityOAuthConfigClass')\n    $xwiki.ssx.use('IdentityOAuth.IdentityOAuthConfigClass')\n  #end\n\n\n  ## defines formId, propNamePrefixIO, propNamePrefixO, configDoc, objIO, objO\n  #macro (initConfigObjects $configDocName $extraObjectClassPropPrefixes $translationPrefixesP)\n    #set($formId = \"${section.toLowerCase()}_${configDocName1}\")\n    #set($configDoc = $xwiki.getDocument($configDocName))\n    #set($classNameIO=\"IdentityOAuth.IdentityOAuthConfigClass\")\n    #set($propNamePrefixIO=\"${configDoc.fullName}_${classNameIO}_0\")\n    #set($objIO = $configDoc.getObject($classNameIO))\n    ## Handle translation prefixes.\n    #set($translationPrefixes = [])\n    #foreach($p in $translationPrefixesP)\n      #set($nuts=$translationPrefixes.add($p))\n    #end\n    #set($nuts=$translationPrefixes.add('IdentityOAuth.IdentityOAuthConfigClass_'))\n    ## Handle extra class properties.\n    #foreach($x in $extraObjectClassPropPrefixes)\n      #set($shhh = $x.add($x[0]))\n      #set($x[0] = $configDoc.getObject($x[0]))\n    #end\n  #end\n\n  ##\n  ## Macros used in managing providers translations. t is for translation and tp for translation with parameters.\n  ##\n  #macro (alignWithTranslationPrefixes $name)\n    #set($tn = [])\n    #foreach($p in $translationPrefixes)\n      #set($nuts=$tn.add(\"${p}${name}\"))\n    #end\n  #end\n  #macro (getTranslation $name $usage $translation)\n    #alignWithTranslationPrefixes($name)\n    #if ($usage == 'js')\n      #set ($translation = $escapetool.javascript($services.localization.render($tn)))\n    #else\n      #set ($translation = $escapetool.xml($services.localization.render($tn)))\n    #end\n  #end\n  ## Display translation.\n  #macro (t $name $usage)\n    #getTranslation($name $usage $translation)\n    $translation\n  #end\n  ## Get translation with parameters.\n  #macro (tp $name $params $usage $translation)\n    #alignWithTranslationPrefixes($name)\n    #set ($msg = $services.localization.render($tn, $params))##\n    #if ($usage == 'js')\n      #set ($translation = $escapetool.javascript($msg))\n    #else\n      #set ($translation = $escapetool.xml($msg))\n    #end\n  #end\n\n  ## displayInput: displays the form element of the relevant property of the object having removed the\n  ##   html macro around it.\n  #macro (displayInput $property $obj)\n    #set ($output = $doc.display($property, 'edit', $obj))\n    #set ($output = $stringtool.removeStart($output, '{{html clean=\"false\" wiki=\"false\"}}'))\n    #set ($output = $stringtool.removeEnd($output, '{{/html}}'))\n    $output\n  #end\n\n  #macro (renderRedirectUrlInputAndHints)\n    #displayInput ('redirectUrl', $objIO)<br/>\n    <span class=\"xHint\" id=\"redirectUrlAsExpected\">#t('redirectUrl.asExpected')</span>\n    <span class=\"xHint\" id=\"redirectUrlAsServers\">#t('redirectUrl.asExpectedServers')</span>\n    <span class=\"xHint\" id=\"redirectUrlAsBrowsers\">#t('redirectUrl.asExpectedBrowsers')</span>\n    <span class=\"xHint\" id=\"redirectUrlDifferentOfAll\">#t('redirectUrl.notAsExpectedAny')</span>\n    <span class=\"xHint\" id=\"redirectMakeItLikePredicted\">##\n      (<a href=\"#\" onclick=\"return resetRedirectUrlBrowser()\">#t('redirectUrl.recalc.predicted'))</a></span>\n    <span class=\"xHint\" id=\"redirectMakeItLikePredictedBrowser\">##\n      (<a href=\"#\" onclick=\"return resetRedirectUrlBrowser()\">#t('redirectUrl.recalc.browser'))</a></span>\n    <span class=\"xHint\" id=\"redirectMakeItLikePredictedServer\">\n      (<a href=\"#\" onclick=\"return resetRedirectUrlServer()\">#t('redirectUrl.recalc.server'))</a></span>\n  #end\n\n  #macro (calcReturnUrlsJS)\n  <script type=\"text/javascript\">\n      #set($serverReturn=$xwiki.getURL('XWiki.XWikiLogin', 'login')) ## typically a host-absolute URL\n      // serverReturn: $serverReturn\n      #if($serverReturn.startsWith(\"http://\") || $serverReturn.startsWith(\"https://\"))\n        ## all good\n      #elseif($serverReturn.startsWith('/'))\n        #set($absUrl = $xcontext.request.requestURL)\n      // absUrl: $absUrl\n        #set($serverReturn = \"${absUrl.substring(0, $absUrl.indexOf('/',8))}${serverReturn}\")\n      #end\n      #tp(\"redirectUrl.placeHolderMessage\", [\"${serverReturn}\"], \"js\", $translation)\n      window.placeHolderForRedirectUrl = \"${translation}\";\n      var p = window.location.href.indexOf('/admin');\n      window.browserReturnUrl = (p === -1 ?\n              window.location.href :\n              window.location.href.substring(0, p)) + \"/login/XWiki/XWikiLogin\"\n  </script>\n  #end\n\n  #set($hasLoadedMacros=true)\n#end\n{{/velocity}}", "{{velocity output=\"false\"}}\n#macro (renderLoginCodes $loginCodes $hasSeveralLogins)\n  #set ($count = 0)\n  #set ($loginCodeWrapperStart = '<div class=\"identity-oauth-provider-login\">')\n  #foreach ($loginCode in $identityOAuth.renderLoginCodes())\n    #set ($count = $mathtool.add($count, 1))\n    #set ($loginCodes=\"${loginCodes}${loginCodeWrapperStart}${loginCode}</div>\")\n  #end\n  #set ($hasSeveralLogins = $count > 0)\n#end\n{{/velocity}}\n\n{{velocity}}\n#set ($mainReference = $services.model.createDocumentReference('', 'IdentityOAuth', 'WebPreferences'))\n#set ($generalConfigDoc = $xwiki.getDocument('IdentityOAuth.IdentityOAuthGeneralConfiguration'))\n#set ($generalConfigObj = $generalConfigDoc.getObject('IdentityOAuth.IdentityOAuthGeneralConfigClass'))\n#if ($xcontext.getAction()==\"login\" && $doc.fullName==\"XWiki.XWikiLogin\")\n  #if (!$services.licensing.licensor.hasLicensureForEntity($mainReference))\n    #set($statusMessage = \"identityOAuth installed but not licensed.\")\n  #else\n    #set($identityOAuth = $services.idoauth)\n    #if ($identityOAuth.doesDetectReturn())\n      #set($statusMessage = \"IdentityOAuth: return of the OAuth bounce; if all goes well, the user can be logged in.\")\n      #set($result = $identityOAuth.processOAuthReturn())\n      #set($prfx = \"failed login:\")\n      #if ($result.startsWith($prfx))\n        #set($email = $result.substring($prfx.length()))\n        #set($errorMsg = \" ${services.localization.render('idoauth.login.domainerror1')} \")\n        #set($errorMsg = \" ${errorMsg} ${services.localization.render('idoauth.login.domainerror2')} $!{email}.\")\n        #set($errorMsg = \" ${errorMsg} ${services.localization.render('idoauth.login.domainerror3')}\")\n      #elseif ($result==\"ok\")\n        #set ($successMsg = ${services.localization.render(\"idoauth.login.redirectmessage\")})\n        ## the browser should have been redirected by processOAuthReturn\n      #else ## $result is \"no user\"\n        #set($errorMsg = ${services.localization.render('idoauth.login.message')})\n        #set($errorMsg = \" ${errorMsg} ${services.localization.render('idoauth.login.error')}\")\n        #if($request.getAttribute(\"idoauth-error-message\"))\n          #set($errorMsg = \"${errorMsg}: ${request.getAttribute('idoauth-error-message')}\")\n        #end\n      #end\n    #elseif ($request.identityOAuth == \"start\")\n      ## Don't alter the login form in case the XWiki default implementation is requested.\n      #if (\"$!request.provider\" != \"default\")\n        #set($statusMsg = \"IdentityOAuth Start login, should bounce to the provider.\")\n        #set($succesMsg = $services.localization.render(\"idoauth.login.oauth.message\"))\n        #set($success = $identityOAuth.processOAuthStart()) <!-- processOAuthStart: $success -->\n        #if($success)\n          #if($request.state)\n            #set($successMsg = $services.localization.render(\"idoauth.login.oauth.successwithredirect\"))\n          #else\n            #set($successMsg = $services.localization.render(\"idoauth.login.oauth.success\"))\n          #end\n        #else\n          #set($errorMsg = $services.localization.render(\"idoauth.login.oauth.failedOAuth\"))\n        #end\n      #end\n    #elseif ($request.identityOAuth)\n      #set ($statusMsg = \"no such identityOAuth operation '$request.identityOAuth'\")\n    #else\n      #set($statusMsg = \"Login page\")\n      ## assemble the login code from the providers\n      #set($loginCodes = '<div id=\"idoauth-login-choice\">\n                             <div class=\"col-xs-12\">')\n      #renderLoginCodes($loginCodes $hasSeveralLogins)\n      #set($loginCodes=\"${loginCodes}</div><div style='clear: both;'></div></div>\")\n    #end\n\n    ## ============================================== end of velocity preparation ===============================\n\n    {{html clean=\"false\" wiki=\"false\"}}<!-- this is IdentityOAuth -->\n    <!-- This code is displayed on the login page, so we cannot use a ssx skin extension since guest users may have\n    restricted view rights and the style won't be displayed -->\n    <style>\n    .provider-login-button {\n      background: white;\n      color: #333;\n      border: #e8e8e8 2px solid;\n      display: flex;\n      align-items: center;\n    }\n    .provider-login-button >img {\n      height: 1.1em;\n      margin-right: 2%;\n    }\n    .identity-oauth-provider-login {\n      padding: 3% 0;\n    }\n\n    #idoauth-login-choice {\n      margin-bottom: 5%;\n    }\n    </style>\n    <!-- ======= ${escapetool.xml($statusMsg)} ====== -->\n\n    #if ($successMsg || $errorMsg)\n    <script type=\"text/javascript\">\n      // Identity OAuth Login Extension: Success or warning messages\n      document.addEventListener('DOMContentLoaded', function() {\n        var p = document.createElement(\"p\"), div = document.createElement(\"div\");\n        #if ($successMsg)\n          p.innerText = \"${escapetool.javascript($successMsg)}\";\n          div.className = \"box successmessage\";\n        #elseif ($errorMsg)\n          p.innerText = \"${escapetool.javascript($errorMsg)}\";\n          div.className = \"box warningmessage\";\n        #end\n        div.appendChild(p);\n        var c = document.getElementById(\"mainContentArea\")\n        c.insertBefore(div, c.firstChild);\n      });\n    </script>\n    #elseif($hasSeveralLogins)\n    <script type=\"text/javascript\">\n      // Identity OAuth Login Extension: Button: offer a button to go to the provider. Don't alter the login if no other\n      // providers are defined.\n      document.addEventListener('DOMContentLoaded', function() {\n        require(['jquery', 'xwiki-events-bridge', 'xwiki-meta'], function($, xm) {\n          window.loginWithXWiki = function() {\n              jQuery(\".panel .panel-body dl\").show()\n              return false;\n          }\n          if (XWiki.contextaction == \"login\" || XWiki.contextaction == \"loginsubmit\" ) {\n            var url = location.href, baseUrl = url;\n            if (url.indexOf('?') < 0){\n                url=url+'?';\n            } else {\n                baseUrl = url.substring(0, url.indexOf('?'));\n            }\n            if (url.indexOf('identityOAuth=')>=0) {\n                url = url.replace(/identityOAuth=[a-zA-Z]*/, \"identityOAuth=start\");\n            } else {\n                url = url + \"&identityOAuth=start\";\n            }\n            url = url + \"&browserLocation=\" + escape(baseUrl);\n\n            var loginCode = \"${escapetool.javascript($loginCodes)}\";\n            loginCode = loginCode.replace(\"-URL-\",url);\n            jQuery(loginCode).insertBefore(jQuery(\".panel .panel-body dl\"));\n\n            if (XWiki.contextaction != \"loginsubmit\") {\n              jQuery(\".panel .panel-body dl\").hide();\n            }\n          }\n        }); // end requirejs\n      });\n    </script>\n    #end ## if ($successMsg || $errorMsg)\n  {{/html}}\n  #end ## identityOAuth is active\n#end ## on login page\n{{/velocity}}\n", "admin.idoauth=Identity OAuth\n\nidoauth.config.heading=Einstellungen des OAuth Providers\nIdentityOAuth.IdentityOAuthConfigClass_config.explanation=XWiki kann mit externen Identit\u00e4tsanbietern verbunden werdeb.\n\n## Adminstration interface\nIdentityOAuth.IdentityOAuthConfigClass_active=Aktivieren\nIdentityOAuth.IdentityOAuthConfigClass_communicate=Schnittstellen zu dem OAuth Provider\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint=Um eine OAuth Integration zu aktivieren, musst du {0} und die genannten Client-ID und Clientschl\u00fcssel in den folgenden Einstellungen einf\u00fcgen.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint.linkLabel=dein Wiki als App f\u00fcr den OAuth Zugang bei dem Provider registrieren\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2=Du erh\u00e4lst mehr Information in den {0}.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2.linkLabel=Installationsanweisungen\n\nIdentityOAuth.IdentityOAuthConfigClass_appname=Name\nIdentityOAuth.IdentityOAuthConfigClass_appname.hint=F\u00fcr deine eigene Organisation\nIdentityOAuth.IdentityOAuthConfigClass_clientid=Client-ID\nIdentityOAuth.IdentityOAuthConfigClass_clientid.hint=Wird vom Provider genannt.\nIdentityOAuth.IdentityOAuthConfigClass_secret=Clientschl\u00fcssel\nIdentityOAuth.IdentityOAuthConfigClass_secret.hint=Wird vom Provider genannt.\n\n\nIdentityOAuth.IdentityOAuthConfigClass_scope=Autorisierungen\nIdentityOAuth.IdentityOAuthConfigClass_scope.hint=Welche Information sollte dieses Wiki von dem Provider abfragen?\nIdentityOAuth.IdentityOAuthConfigClass_scope_identity=Vor- und Nachname.\nIdentityOAuth.IdentityOAuthConfigClass_scope_email=Emailadresse.\nIdentityOAuth.IdentityOAuthConfigClass_scope_avatar=Benutzerprofilbild\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_mandatory=Diese Autorisierung ist n\u00f6tig.\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_notyetdone=Diese Autorisierung wird noch implementiert.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl=R\u00fcckkehr-URL\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.hint=Ein Benutzer macht seinen R\u00fcckkehr auf dieser Seite (mit Extraparametern) nachdem die Autorisierungen best\u00e4tigt wurden.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpected=Diese Adresse ist dieselbe als die von der Loginseite des Wikis, bestimmt durch die aktuelle Browseradresse.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpected=Diese Adresse ist nicht dieselbe als die von der Loginseite des Wikis, bestimmt durch die aktuelle Browseradresse.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.placeHolderMessage=(Defautwert: berechnet durch vom Server; {0})\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedServers=Diese Adresse entspricht die Loginseitenadresse, die das Server berechnet.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedBrowsers=Diese Adresse entspricht die Loginseitenadresse, die aus der Browseradresse berechnet werden kann.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpectedAny=Diese Adresse Entspricht keine bekannte Loginseitenadresse.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.predicted=Die Adresse neu berechnen.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.browser=Die Adresse durch das Server berechnen lassen.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.server=Die Adresse ab der Browseradresse berechnen.\n\nIdentityOAuth.IdentityOAuthConfigClass_loginbehaviour=XWiki Anmeldungsvorgang\nIdentityOAuth.IdentityOAuthConfigClass_useCookies=Cookies anwenden, um die Identifizierung zu erinnern\nIdentityOAuth.IdentityOAuthConfigClass_useCookies.hint=Diese Cookies erlauben Browsers zu erinnern, welche Benutzer benutzt war, um sich zum Wiki anzumelden.\n\nIdentityOAuth.IdentityOAuthConfigClass_warningIncomplete=Die gesamte Informationen sind n\u00f6tig.\n\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat1=Nachdem es gemacht ist, bitte logge dich aus und dann logge dich ein mit dem Provider.\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat2=Wenn du technische Schwierigkeiten hast, dann schreibe bitte support@xwiki.com an.\n\n\n\nidoauth.login.title=Identity OAuth Login\nidoauth.login.withoauth=Mit einem OAuth Provider einloggen\nidoauth.login.withxwiki=Mit XWiki einloggen\n\n## error reporting\nidoauth.login.error=Ein Fehler ist w\u00e4hrend des Logins mit einem OAuth Providers entstanden. Bitte nehmen Sie Kontakt mit dem Administrator oder XWiki Support.\nidoauth.login.message=Du wirst zum OAuth Provider f\u00fcr die Autorisierung weitergeleitet.\nidoauth.login.redirectmessage=Du wirst zur angeforderte Seite weitergeleitet.\nidoauth.login.oauth.message=OAuth Autorisieriung im Lauf\nidoauth.login.oauth.success=Erfolgreiche Autorisierung.\nidoauth.login.oauth.successwithredirect=Erfolgreiche Autorisierung. Du wirst zur angeforderte Seite weitergeleitet.\n\nidoauth.error.noValidLicense=Diese App hat keine g\u00fcltige Lizenz. Bitte die Lizenzeinstellungseite (in dem Abschnitt Erweiterungen der globalen Einstelllungen) besuchen, um eine zu erhalten.\nidoauth.error.extensionDisabled=Die OAuth Integration ist auf dieses Wiki deaktiviert.\n\nidoauth.webHome.1=Dieses Space ist der Code der Identity OAuth Erweiterung. Sie hilft die Integration von OAuth Providers zu leisten.\nidoauth.webHome.2=...\nidoauth.webHome.3=...\nidoauth.webHome.4=Provider-spezifische Einstellungen sind n\u00f6tig. Bitte besuche den Provider''s Abschnitt der XWiki Einstellungen, damit sie angepasst werden.\n", "admin.idoauth=Identity OAuth\n\nidoauth.config.heading=Configuration Int\u00e9gration OAuth\nIdentityOAuth.IdentityOAuthConfigClass_config.explanation=XWiki peut \u00eatre int\u00e9gr\u00e9 avec un fournisseur externe d'identit\u00e9.\n\n## Adminstration interface\nIdentityOAuth.IdentityOAuthConfigClass_active=Activer\nIdentityOAuth.IdentityOAuthConfigClass_communicate=Communication avec les services OAuth\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint=Afin d''activer l''int\u00e9gration OAuth vous devez {0} et ins\u00e9rer les informations dans les param\u00e8tres suivants.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint.linkLabel=vous enregistrer pour l''acc\u00e8s \u00e0 OAuth chez le fournisseur\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2=Voir aussi {0}.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2.linkLabel=les instructions d''installation\n\nIdentityOAuth.IdentityOAuthConfigClass_appname=Nom de l'application\nIdentityOAuth.IdentityOAuthConfigClass_appname.hint=Pour votre propre organisation.\nIdentityOAuth.IdentityOAuthConfigClass_clientid=ID client\nIdentityOAuth.IdentityOAuthConfigClass_clientid.hint=Indiqu\u00e9 dans la page de l'application.\nIdentityOAuth.IdentityOAuthConfigClass_secret=Cl\u00e9 secr\u00e8te\nIdentityOAuth.IdentityOAuthConfigClass_secret.hint=Indiqu\u00e9 dans la page de l'application.\n\n\nIdentityOAuth.IdentityOAuthConfigClass_scope=Types de  permissions\nIdentityOAuth.IdentityOAuthConfigClass_scope.hint=Quelle information devrait \u00eatre demand\u00e9es par le wiki au fournisseurs d'identit\u00e9s?\nIdentityOAuth.IdentityOAuthConfigClass_scope_identity=Nom et pr\u00e9nom\nIdentityOAuth.IdentityOAuthConfigClass_scope_email=Adresse email\nIdentityOAuth.IdentityOAuthConfigClass_scope_avatar=Photo de profil\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_mandatory=Ceci est n\u00e9cessaire\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_notyetdone=Ceci n'est pas encore impl\u00e9ment\u00e9\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl=URL de retour\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.hint=L'utilisateur revient \u00e0 la page de login de ce wiki avec des param\u00e8tres suppl\u00e9mentaires pour indiquer l'autorisation OAuth.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpected=Ceci devrait \u00eatre la bonne adresse d'apr\u00e8s l'adresse de votre navigateur.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpected=Ceci ne correspond pas \u00e0 l'adresse de votre navigateur.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.placeHolderMessage=(valuer par d\u00e9faut: calcul\u00e9e par le serveur; {0})\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedServers=Cette adresse correspond \u00e0 l'adresse de la page de connexion ainsi que calcul\u00e9e par votre serveur.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedBrowsers=Cette adresse correspond \u00e0 l'adresse de la page de connexion ainsi que calcul\u00e9e par votre navigateur.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpectedAny=Cette adresse ne correspond pas \u00e0 l'adresse connue de la page de connexion.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.predicted=Recalculer l'adresse\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.browser=Recalculer l'adresse d'apr\u00e8s l'adresse du navigateur\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.server=Recalculer l'adresse d'apr\u00e8s l'adresse du serveur\n\nIdentityOAuth.IdentityOAuthConfigClass_loginbehaviour=Comportement de login\nIdentityOAuth.IdentityOAuthConfigClass_useCookies=Utiliser des cookies pour la connexion\nIdentityOAuth.IdentityOAuthConfigClass_useCookies.hint=Les cookies permettent de se rappeler le nom d'utilisateur utilis\u00e9 chez le fournisseur.\n\nIdentityOAuth.IdentityOAuthConfigClass_warningIncomplete=Veuillez fournir toutes les informations ou d\u00e9sactiver l'application.\n\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat1=Vous pouvez v\u00e9rifier votre installation en vous d\u00e9onnectant et reconnectant avec le fournisseur OAuth.\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat2=Si vous avez des difficult\u00e9s, veuillez prendre contact avec support@xwiki.com .\n\n\n\nidoauth.login.title=Connexion Identity OAuth\nidoauth.login.withoauth=Se connecter avec un fournisseur OAuth\nidoauth.login.withxwiki=Se connecter avec XWiki\n\n## error reporting\nidoauth.login.error=Une erreur est survenue durant la connexion par le fournisseur OAuth. Prenez contact avec votre administrateur ou le support XWiki.\nidoauth.login.message=Vous allez \u00eatre redirig\u00e9 vers la page d'autorisation du fournisseur OAuth.\nidoauth.login.redirectmessage=Vous allez \u00eatre redirig\u00e9 vers la page demand\u00e9e.\nidoauth.login.oauth.message=Autorisation OAuth en cours.\nidoauth.login.oauth.success=Autorisation OAuth r\u00e9ussie.\nidoauth.login.oauth.successwithredirect=Autorisation OAuth r\u00e9ussie. Vous allez \u00eatre redirig\u00e9 vers la page demand\u00e9e.\n\nidoauth.error.noValidLicense=Cette app n'a pas de licence valide. Veuillez aller \u00e0 la page des licences (dans les r\u00e9glages) afin d'en obtenir une.\nidoauth.error.extensionDisabled=L'int\u00e9gration OAuth est d\u00e9sactiv\u00e9e sur ce wiki.\n\nidoauth.webHome.1=Cet espace contient le code de l'extension Identity OAuth. Cette extension soutient l'int\u00e9gration de fournisseurs OAuth.\nidoauth.webHome.2=...\nidoauth.webHome.3=...\nidoauth.webHome.4=Des r\u00e9glages sp\u00e9cifiques \u00e0 chaque fournisseur sont n\u00e9cessaires. Visitez la section sp\u00e9cifique au fournisseur pour les ajuster.\n", "\n\nadmin.idoauth=Identity OAuth\nadmin.idoauth.default.heading=Default Identity OAuth Provider\nadmin.idoauth.default.description=Configure the default XWiki login implementation\n\nidoauth.config.heading=Identity OAuth Integration Configuration\nIdentityOAuth.IdentityOAuthConfigClass_config.explanation=XWiki can be integrated with an external provider.\n\n## Adminstration interface\nIdentityOAuth.IdentityOAuthConfigClass_active=Activate\nIdentityOAuth.IdentityOAuthConfigClass_communicate=Communication with the OAuth service\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint=To activate an OAuth integration you need to {0} and to insert your Client-Id and secret in the following settings.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint.linkLabel=register for OAuth access to the provider''s configuration\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2=For more information, please see {0}.\nIdentityOAuth.IdentityOAuthConfigClass_communicate.hint2.linkLabel=the installation instructions\n\nIdentityOAuth.IdentityOAuthConfigClass_appname=Application Name\nIdentityOAuth.IdentityOAuthConfigClass_appname.hint=For your own organisation.\nIdentityOAuth.IdentityOAuthConfigClass_clientid=Client ID\nIdentityOAuth.IdentityOAuthConfigClass_clientid.hint=The provider indicates this.\nIdentityOAuth.IdentityOAuthConfigClass_secret=Secret Key\nIdentityOAuth.IdentityOAuthConfigClass_secret.hint=The provider indicates this.\n\n\nIdentityOAuth.IdentityOAuthConfigClass_scope=Permissions to request\nIdentityOAuth.IdentityOAuthConfigClass_scope.hint=Which information should XWiki request to the the provider about the account?\nIdentityOAuth.IdentityOAuthConfigClass_scope_identity=First and last name\nIdentityOAuth.IdentityOAuthConfigClass_scope_email=Email address\nIdentityOAuth.IdentityOAuthConfigClass_scope_avatar=User image\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_mandatory=This is required\nIdentityOAuth.IdentityOAuthConfigClass_checkbox_notyetdone=This is not implemented yet\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl = Return URL\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.hint = A user is returned  to the login page of this wiki with extra parameters after the OAuth authorization.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpected = This address matches the login page URL that can be expected from the URL of your browser.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpected = This address does not match the login page URL that can be expected from the URL of your browser.\n\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.placeHolderMessage = (default: computed by the server; {0})\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedServers = This address matches the login page URL that can be expected from the URL of your server.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.asExpectedBrowsers = This address matches the login page URL that can be expected from the URL of your browser.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.notAsExpectedAny = This address does not match the login page URL.\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.predicted = Recalculate URL\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.browser = Recalculate URL from the current browser page\nIdentityOAuth.IdentityOAuthConfigClass_redirectUrl.recalc.server = Recalculate URL from the server\n\nIdentityOAuth.IdentityOAuthConfigClass_loginbehaviour=XWiki Login Behaviour\nIdentityOAuth.IdentityOAuthConfigClass_useCookies=Use of cookies for Login\nIdentityOAuth.IdentityOAuthConfigClass_useCookies.hint=These cookies allow browsers to remember which user was used to login to the Wiki.\n\nIdentityOAuth.IdentityOAuthConfigClass_warningIncomplete=Please provide all information or disable the app.\n\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat1=Using a different browser, please try to login to the XWiki.\nIdentityOAuth.IdentityOAuthConfigClass_nowWhat2=Should you need support, please ask support@xwiki.com\n\nIdentityOAuth.IdentityOAuthGeneralConfigClass_displayXWikiLogin.hint=Whether to display the XWiki option on the login page\n\nIdentityOAuth.OAuthProviderClass_active.hint=Whether this provider should be displayed on the login page\n\nidoauth.login.title=Identity OAuth Login\nidoauth.login.withoauth=Login with an OAuth provider\nidoauth.login.withxwiki=Login with XWiki\n\n## error reporting\nidoauth.login.error=An error occurred while trying to login with the OAuth provider. Please contact XWiki Support for help or try again.\nidoauth.login.message=You are being redirected to the OAuth provider for Authentication.\nidoauth.login.redirectmessage=You are being redirected to your requested page.\nidoauth.login.oauth.message=OAuth authentication in progress\nidoauth.login.oauth.success=Successful authentication.\nidoauth.login.oauth.successwithredirect=Successful authentication. You are being redirected to your page.\n\nidoauth.error.noValidLicense=A license for this application is missing. Please visit the License setting (in the Extensions section) to obtain one.\nidoauth.error.extensionDisabled=The IdentityOAuth integration is disabled on this wiki.\n\nidoauth.webHome.1=This is the code for the Identity OAuth extension, allowing to integrate XWiki with external provider identities.\nidoauth.webHome.2=...\nidoauth.webHome.3=...\nidoauth.webHome.4=Go to the administration section of your specific provider in order to configure the application. \n\n", "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc>\n  <web>IdentityOAuth</web>\n  <name>WebHome</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <parent>IdentityOAuth.WebHome</parent>\n  <creator>xwiki:XWiki.Admin</creator>\n  <author>xwiki:XWiki.Admin</author>\n  <customClass/>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Identity OAuth</title>\n  <defaultTemplate/>\n  <validationScript/>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{include reference=\"Licenses.Code.VelocityMacros\"/}}\n\n{{velocity}}\n#set ($mainReference = $services.model.createDocumentReference('', 'IdentityOAuth','OAuth'))\n#if (!$services.licensing.licensor.hasLicensureForEntity($mainReference))\n  {{error}}#getMissingLicenseMessage('idoauth.extension.name'){{/error}}\n#else\n  $escapetool.xml($services.localization.render('idoauth.webHome.1'))\n  $escapetool.xml($services.localization.render('idoauth.webHome.2'))\n  $escapetool.xml($services.localization.render('idoauth.webHome.3'))\n  $escapetool.xml($services.localization.render('idoauth.webHome.4'))\n#end\n\n[[=&gt; More about the IdentityOAuth Application&gt;&gt;https://store.xwiki.com/xwiki/bin/view/Extension/IdentityOAuth]].\n{{/velocity}}\n</content>\n  <attachment>\n    <filename>xwiki-logo.png</filename>\n    <mimetype>image/png</mimetype>\n    <charset>UTF-8</charset>\n    <author>xwiki:XWiki.Admin</author>\n    <version>1.1</version>\n    <comment/>\n    <content>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</content>\n    <filesize>2983</filesize>\n  </attachment>\n</xwikidoc>\n"], "filenames": ["ui/src/main/resources/IdentityOAuth/IdentityOAuthConfigMacros.vm", "ui/src/main/resources/IdentityOAuth/LoginUIExtension.vm", "ui/src/main/resources/IdentityOAuth/Translations.de.properties", "ui/src/main/resources/IdentityOAuth/Translations.fr.properties", "ui/src/main/resources/IdentityOAuth/Translations.properties", "ui/src/main/resources/IdentityOAuth/WebHome.xml"], "buggy_code_start_loc": [24, 32, 9, 9, 13, 49], "buggy_code_end_loc": [97, 94, 11, 11, 77, 56], "fixing_code_start_loc": [23, 32, 9, 9, 13, 49], "fixing_code_end_loc": [109, 94, 13, 13, 79, 56], "type": "CWE-79", "message": "com.xwiki.identity-oauth:identity-oauth-ui is a package to aid in building identity and service providers based on OAuth authorizations. When a user logs in via the OAuth method, the identityOAuth parameters sent in the GET request is vulnerable to cross site scripting (XSS) and XWiki syntax injection. This allows remote code execution via the groovy macro and thus affects the confidentiality, integrity and availability of the whole XWiki installation. The issue has been fixed in Identity OAuth version 1.6. There are no known workarounds for this vulnerability and users are advised to upgrade.", "other": {"cve": {"id": "CVE-2023-45144", "sourceIdentifier": "security-advisories@github.com", "published": "2023-10-16T21:15:11.333", "lastModified": "2023-10-20T20:00:09.403", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "com.xwiki.identity-oauth:identity-oauth-ui is a package to aid in building identity and service providers based on OAuth authorizations. When a user logs in via the OAuth method, the identityOAuth parameters sent in the GET request is vulnerable to cross site scripting (XSS) and XWiki syntax injection. This allows remote code execution via the groovy macro and thus affects the confidentiality, integrity and availability of the whole XWiki installation. The issue has been fixed in Identity OAuth version 1.6. There are no known workarounds for this vulnerability and users are advised to upgrade."}, {"lang": "es", "value": "com.xwiki.identity-oauth:identity-oauth-ui es un paquete para ayudar a crear identidades y proveedores de servicios basados en autorizaciones OAuth. Cuando un usuario inicia sesi\u00f3n a trav\u00e9s del m\u00e9todo OAuth, los par\u00e1metros de identidadOAuth enviados en la solicitud GET son vulnerables a Cross-Site Scripting (XSS) y a la inyecci\u00f3n de XWiki syntax. Esto permite la ejecuci\u00f3n remota de c\u00f3digo a trav\u00e9s de la macro groovy y, por lo tanto, afecta la confidencialidad, integridad y disponibilidad de toda la instalaci\u00f3n de XWiki. El problema se solucion\u00f3 en Identity OAuth versi\u00f3n 1.6. No se conocen workarounds para esta vulnerabilidad y se recomienda a los usuarios que actualicen."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.8, "impactScore": 6.0}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}, {"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:oauth_identity:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.0", "versionEndExcluding": "1.6", "matchCriteriaId": "B145876F-17CC-44FA-B95A-9C591255D17C"}]}]}], "references": [{"url": "https://github.com/xwikisas/identity-oauth/blob/master/ui/src/main/resources/IdentityOAuth/LoginUIExtension.vm#L58", "source": "security-advisories@github.com", "tags": ["Broken Link"]}, {"url": "https://github.com/xwikisas/identity-oauth/commit/d805d3154b17c6bf455ddf5deb0a3461a3833bc6", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwikisas/identity-oauth/commit/d805d3154b17c6bf455ddf5deb0a3461a3833bc6#diff-2ab2e0716443d790d7d798320e4a45151661f4eca5440331f4a227b29c87c188", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwikisas/identity-oauth/security/advisories/GHSA-h2rm-29ch-wfmh", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-20719", "source": "security-advisories@github.com", "tags": ["Permissions Required"]}]}, "github_commit_url": "https://github.com/xwikisas/identity-oauth/commit/d805d3154b17c6bf455ddf5deb0a3461a3833bc6"}}