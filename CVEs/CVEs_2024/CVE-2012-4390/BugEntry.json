{"buggy_code": ["<?php\n/**\n * Copyright (c) 2011 Jakob Sack <mail@jakobsack.de>\n * This file is licensed under the Affero General Public License version 3 or\n * later.\n * See the COPYING-README file.\n */\nOCP\\App::checkAppEnabled('calendar');\n\nif(substr($_SERVER[\"REQUEST_URI\"],0,strlen(OC::$APPSWEBROOT . '/apps/calendar/caldav.php')) == OC::$APPSWEBROOT . '/apps/calendar/caldav.php'){\n\t$baseuri = OC::$APPSWEBROOT . '/apps/calendar/caldav.php';\n}\n\n// only need authentication apps\n$RUNTIME_APPTYPES=array('authentication');\nOC_App::loadApps($RUNTIME_APPTYPES);\n\n// Backends\n$authBackend = new OC_Connector_Sabre_Auth();\n$principalBackend = new OC_Connector_Sabre_Principal();\n$caldavBackend    = new OC_Connector_Sabre_CalDAV();\n\n// Root nodes\n$collection = new Sabre_CalDAV_Principal_Collection($principalBackend); \n$collection->disableListing = true; // Disable listening\n\n$nodes = array( \n\t$collection, \n\tnew Sabre_CalDAV_CalendarRootNode($principalBackend, $caldavBackend),\n\t);\n\n\n// Fire up server\n$server = new Sabre_DAV_Server($nodes);\n$server->setBaseUri($baseuri);\n// Add plugins\n$server->addPlugin(new Sabre_DAV_Auth_Plugin($authBackend,'ownCloud'));\n$server->addPlugin(new Sabre_CalDAV_Plugin());\n$server->addPlugin(new Sabre_DAVACL_Plugin());\n$server->addPlugin(new Sabre_DAV_Browser_Plugin(false)); // Show something in the Browser, but no upload\n\n// And off we go!\n$server->exec();\n", "<?php\n/**\n * ownCloud - Addressbook\n *\n * @author Jakob Sack\n * @copyright 2011 Jakob Sack mail@jakobsack.de\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with this library.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nOCP\\App::checkAppEnabled('contacts');\n\nif(substr($_SERVER[\"REQUEST_URI\"],0,strlen(OC::$APPSWEBROOT . '/apps/contacts/carddav.php')) == OC::$APPSWEBROOT . '/apps/contacts/carddav.php'){\n\t$baseuri = OC::$APPSWEBROOT . '/apps/contacts/carddav.php';\n}\n\n// only need authentication apps\n$RUNTIME_APPTYPES=array('authentication');\nOC_App::loadApps($RUNTIME_APPTYPES);\n\n// Backends\n$authBackend = new OC_Connector_Sabre_Auth();\n$principalBackend = new OC_Connector_Sabre_Principal();\n$carddavBackend   = new OC_Connector_Sabre_CardDAV();\n\n// Root nodes\n$collection = new Sabre_CalDAV_Principal_Collection($principalBackend); \n$collection->disableListing = true; // Disable listening\n\n$nodes = array( \n\t$collection, \n\tnew Sabre_CardDAV_AddressBookRoot($principalBackend, $carddavBackend),\n\t);\n\n// Fire up server\n$server = new Sabre_DAV_Server($nodes);\n$server->setBaseUri($baseuri);\n// Add plugins\n$server->addPlugin(new Sabre_DAV_Auth_Plugin($authBackend,'ownCloud'));\n$server->addPlugin(new Sabre_CardDAV_Plugin());\n$server->addPlugin(new Sabre_DAVACL_Plugin());\n$server->addPlugin(new Sabre_DAV_Browser_Plugin(false)); // Show something in the Browser, but no upload\n\n// And off we go!\n$server->exec();\n"], "fixing_code": ["<?php\n/**\n * Copyright (c) 2011 Jakob Sack <mail@jakobsack.de>\n * This file is licensed under the Affero General Public License version 3 or\n * later.\n * See the COPYING-README file.\n */\nOCP\\App::checkAppEnabled('calendar');\n\nif(substr($_SERVER[\"REQUEST_URI\"],0,strlen(OC::$APPSWEBROOT . '/apps/calendar/caldav.php')) == OC::$APPSWEBROOT . '/apps/calendar/caldav.php'){\n\t$baseuri = OC::$APPSWEBROOT . '/apps/calendar/caldav.php';\n}\n\n// only need authentication apps\n$RUNTIME_APPTYPES=array('authentication');\nOC_App::loadApps($RUNTIME_APPTYPES);\n\n// Backends\n$authBackend = new OC_Connector_Sabre_Auth();\n$principalBackend = new OC_Connector_Sabre_Principal();\n$caldavBackend    = new OC_Connector_Sabre_CalDAV();\n\n// Root nodes\n$Sabre_CalDAV_Principal_Collection = new Sabre_CalDAV_Principal_Collection($principalBackend); \n$Sabre_CalDAV_Principal_Collection->disableListing = true; // Disable listening\n\n$Sabre_CalDAV_CalendarRootNode = new Sabre_CalDAV_CalendarRootNode($principalBackend, $caldavBackend); \n$Sabre_CalDAV_CalendarRootNode->disableListing = true; // Disable listening\n\n$nodes = array( \n\t$Sabre_CalDAV_Principal_Collection, \n\t$Sabre_CalDAV_CalendarRootNode,\n\t);\n\n\n// Fire up server\n$server = new Sabre_DAV_Server($nodes);\n$server->setBaseUri($baseuri);\n// Add plugins\n$server->addPlugin(new Sabre_DAV_Auth_Plugin($authBackend,'ownCloud'));\n$server->addPlugin(new Sabre_CalDAV_Plugin());\n$server->addPlugin(new Sabre_DAVACL_Plugin());\n$server->addPlugin(new Sabre_DAV_Browser_Plugin(false)); // Show something in the Browser, but no upload\n\n// And off we go!\n$server->exec();\n", "<?php\n/**\n * ownCloud - Addressbook\n *\n * @author Jakob Sack\n * @copyright 2011 Jakob Sack mail@jakobsack.de\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with this library.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nOCP\\App::checkAppEnabled('contacts');\n\nif(substr($_SERVER[\"REQUEST_URI\"],0,strlen(OC::$APPSWEBROOT . '/apps/contacts/carddav.php')) == OC::$APPSWEBROOT . '/apps/contacts/carddav.php'){\n\t$baseuri = OC::$APPSWEBROOT . '/apps/contacts/carddav.php';\n}\n\n// only need authentication apps\n$RUNTIME_APPTYPES=array('authentication');\nOC_App::loadApps($RUNTIME_APPTYPES);\n\n// Backends\n$authBackend = new OC_Connector_Sabre_Auth();\n$principalBackend = new OC_Connector_Sabre_Principal();\n$carddavBackend   = new OC_Connector_Sabre_CardDAV();\n\n// Root nodes\n$Sabre_CalDAV_Principal_Collection = new Sabre_CalDAV_Principal_Collection($principalBackend); \n$Sabre_CalDAV_Principal_Collection->disableListing = true; // Disable listening\n\n$Sabre_CardDAV_AddressBookRoot = new Sabre_CardDAV_AddressBookRoot($principalBackend, $carddavBackend);\n$Sabre_CardDAV_AddressBookRoot->disableListing = true; // Disable listening\n\n$nodes = array( \n\t$Sabre_CalDAV_Principal_Collection, \n\t$Sabre_CardDAV_AddressBookRoot,\n\t);\n\n// Fire up server\n$server = new Sabre_DAV_Server($nodes);\n$server->setBaseUri($baseuri);\n// Add plugins\n$server->addPlugin(new Sabre_DAV_Auth_Plugin($authBackend,'ownCloud'));\n$server->addPlugin(new Sabre_CardDAV_Plugin());\n$server->addPlugin(new Sabre_DAVACL_Plugin());\n$server->addPlugin(new Sabre_DAV_Browser_Plugin(false)); // Show something in the Browser, but no upload\n\n// And off we go!\n$server->exec();\n"], "filenames": ["apps/calendar/appinfo/remote.php", "apps/contacts/appinfo/remote.php"], "buggy_code_start_loc": [24, 39], "buggy_code_end_loc": [30, 45], "fixing_code_start_loc": [24, 39], "fixing_code_end_loc": [33, 48], "type": "CWE-200", "message": "(1) apps/calendar/appinfo/remote.php and (2) apps/contacts/appinfo/remote.php in ownCloud before 4.0.7 allows remote authenticated users to enumerate the registered users via unspecified vectors.", "other": {"cve": {"id": "CVE-2012-4390", "sourceIdentifier": "secalert@redhat.com", "published": "2012-09-05T23:55:02.787", "lastModified": "2012-09-13T04:00:00.000", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "(1) apps/calendar/appinfo/remote.php and (2) apps/contacts/appinfo/remote.php in ownCloud before 4.0.7 allows remote authenticated users to enumerate the registered users via unspecified vectors."}, {"lang": "es", "value": "(1) apps/calendar/appinfo/remote.php y (2) apps/contacts/appinfo/remote.php en ownCloud anterior a v4.0.7 permite a usuarios remotos autenticados enumerar los usuarios registrados mediante vectores desconocidos."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.0.6", "matchCriteriaId": "9C5EB081-BE10-49B1-8A91-3EC70F6DC6AE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "0A1021FF-2A5A-49AA-A376-09C98FECC519"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "3F6C12F7-5897-4DBB-A9AB-8180101F37C3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "E9CC055C-CFA3-4A23-AF91-83F7F087F282"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "AA5445B4-9115-4D31-9DF9-E7E30CAF1FFD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:4.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "8FAE7D90-6190-44E2-B4EA-F47FF3263BE6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:4.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "C7BAB402-B6A0-4314-A37A-C9465157BF5E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:4.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "8A32BED8-F428-44D3-BEAC-E0BB0208B6B6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:4.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "F46F53A9-52B2-41D6-859B-9062B1F02B86"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:4.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "875B306F-92A2-4360-979E-2B53466A33F0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:4.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "6EB01EA3-3071-424F-9586-83CD208D5CAE"}]}]}], "references": [{"url": "http://owncloud.org/changelog/", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2012/09/02/2", "source": "secalert@redhat.com"}, {"url": "https://github.com/owncloud/core/commit/4682846d3ecdad15c6a60126dda75eb7fa97c707", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/owncloud/core/commit/4682846d3ecdad15c6a60126dda75eb7fa97c707"}}