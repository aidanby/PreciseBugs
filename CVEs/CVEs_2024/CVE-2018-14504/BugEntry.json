{"buggy_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manage filter edit page\n *\n * @package MantisBT\n * @copyright Copyright 2016  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses access_api.php\n * @uses authentication_api.php\n * @uses compress_api.php\n * @uses config_api.php\n * @uses constant_inc.php\n * @uses current_user_api.php\n * @uses custom_field_api.php\n * @uses filter_api.php\n * @uses filter_constants_inc.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses string_api.php\n * @uses version_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'access_api.php' );\nrequire_api( 'authentication_api.php' );\nrequire_api( 'compress_api.php' );\nrequire_api( 'config_api.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'current_user_api.php' );\nrequire_api( 'custom_field_api.php' );\nrequire_api( 'filter_api.php' );\nrequire_api( 'filter_constants_inc.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'version_api.php' );\n\nauth_ensure_user_authenticated();\n\nlayout_page_header( lang_get('manage_filter_edit_page_title' ) );\n\nlayout_page_begin( 'manage_filter_edit_page.php' );\n\n$f_filter_id = gpc_get_int( 'filter_id', null );\nif( null === $f_filter_id ) {\n\terror_parameters( 'FILTER_ID' );\n\ttrigger_error( ERROR_EMPTY_FIELD, ERROR );\n}\n\n$t_filter = filter_get( $f_filter_id, null );\nif( null === $t_filter ) {\n\taccess_denied();\n}\n\n$f_view_type = gpc_get_string( 'view_type', $t_filter['_view_type'] );\n$t_filter['_view_type'] = $f_view_type;\n$t_filter = filter_ensure_valid_filter( $t_filter );\n\n$t_action = 'manage_filter_edit_update.php';\n$t_current_project_id = helper_get_current_project();\n$t_filter_project_id = filter_get_field( $f_filter_id, 'project_id' );\n\n?>\n\n<div class=\"col-md-12 col-xs-12\">\n\t<div class=\"space-10\"></div>\n\n\t<form method=\"post\" name=\"filters\" id=\"filters_form_open\" action=\"<?php echo $t_action; ?>\">\n\t<input type=\"hidden\" name=\"filter_id\" value=\"<?php echo $f_filter_id ?>\" >\n\t<input type=\"hidden\" name=\"view_type\" value=\"<?php echo $t_filter['_view_type'] ?>\" >\n\t<?php echo form_security_field( 'manage_filter_edit_update' ) ?>\n\n\t<div class=\"widget-box widget-color-blue2\">\n\t\t<div class=\"widget-header widget-header-small\">\n\t\t\t<h4 class=\"widget-title lighter\">\n\t\t\t\t<i class=\"ace-icon fa fa-filter\"></i>\n\t\t\t\t<?php echo lang_get('edit_filter') ?>\n\t\t\t</h4>\n\n\t\t\t<div class=\"widget-toolbar\">\n\t\t\t\t<div class=\"widget-menu\">\n\t\t\t\t\t<a href=\"#\" data-action=\"settings\" data-toggle=\"dropdown\">\n\t\t\t\t\t\t<i class=\"ace-icon fa fa-bars bigger-125\"></i>\n\t\t\t\t\t</a>\n\t\t\t\t\t<ul class=\"dropdown-menu dropdown-menu-right dropdown-yellow dropdown-caret dropdown-closer\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t$t_url = 'manage_filter_edit_page.php?filter_id=' . $f_filter_id . '&view_type=';\n\t\t\t\t\t\t\tfilter_print_view_type_toggle( $t_url, $t_filter['_view_type'] );\n\t\t\t\t\t\t?>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"widget-body\">\n\t\t\t<div class=\"widget-main no-padding\">\n\n\t\t\t\t<div class=\"widget-toolbox padding-8 clearfix\">\n\t\t\t\t\t<div class=\"btn-toolbar pull-left\">\n\t\t\t\t\t\t<div class=\"form-inline\">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<?php echo lang_get( 'query_name' ) ?>&nbsp;\n\t\t\t\t\t\t\t\t<input type=\"text\" size=\"25\" name=\"filter_name\" maxlength=\"64\" value=\"<?php echo filter_get_field( $f_filter_id, 'name' ) ?>\">\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"table-responsive\">\n\t\t\t\t\t<?php\n\t\t\t\t\t$t_for_screen = true;\n\t\t\t\t\t$t_static = gpc_get_bool( 'static', false );\n\t\t\t\t\tfilter_form_draw_inputs( $t_filter, $t_for_screen, $t_static );\n\t\t\t\t\t?>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"widget-toolbox padding-8 clearfix\">\n\t\t\t\t\t<div class=\"btn-toolbar pull-left\">\n\t\t\t\t\t\t<div class=\"form-inline\">\n\t\t\t\t\t\t\t<label><?php echo lang_get( 'search' ) ?>&nbsp;\n\t\t\t\t\t\t\t\t<input type=\"text\" id=\"filter-search-txt\" class=\"input-sm\" size=\"16\"\n\t\t\t\t\t\t\t\t\t   name=\"<?php echo FILTER_PROPERTY_SEARCH ?>\"\n\t\t\t\t\t\t\t\t\t   value=\"<?php echo string_attribute( $t_filter[FILTER_PROPERTY_SEARCH] ) ?>\">\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"table-responsive\">\n\t\t\t\t\t<table class=\"table table-bordered table-condensed table-striped\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\tif( access_has_project_level( config_get( 'stored_query_create_shared_threshold' ) ) ) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t\t<?php echo lang_get( 'view_status' ) ?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace\" name=\"is_public\" value=\"1\" <?php check_checked( (bool)filter_get_field( $f_filter_id, 'is_public' ), true ) ?> />\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'public' ) ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t&#160;&#160;&#160;&#160;\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace\" name=\"is_public\" value=\"0\" <?php check_checked( (bool)filter_get_field( $f_filter_id, 'is_public' ), false ) ?> />\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'private' ) ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t\t<?php echo lang_get( 'email_project' ) ?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<label class=\"inline\">\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace input-sm\" name=\"filter_project_id\" value=\"<?php echo ALL_PROJECTS ?>\" <?php check_checked( ALL_PROJECTS == $t_filter_project_id ) ?>>\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'all_projects' ) ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<?php if( ALL_PROJECTS != $t_filter_project_id ) { ?>\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace input-sm\" name=\"filter_project_id\" value=\"<?php echo $t_filter_project_id ?>\" <?php check_checked( ALL_PROJECTS != $t_filter_project_id ) ?>>\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'stored_project' ) . ' (' . project_get_name( $t_filter_project_id ) . ')' ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t<?php if( $t_filter_project_id != $t_current_project_id ) { ?>\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace input-sm\" name=\"filter_project_id\" value=\"<?php echo $t_current_project_id ?>\">\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'current_project' ) . ' (' . project_get_name( $t_current_project_id ) . ')' ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"widget-toolbox padding-8 clearfix\">\n\t\t\t<input type=\"submit\" class=\"btn btn-primary btn-white btn-round\" value=\"<?php echo lang_get( 'update_filter' ) ?>\" />\n\t\t</div>\n\t</div>\n\t</form>\n</div>\n\n<?php\nlayout_page_end();\n"], "fixing_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manage filter edit page\n *\n * @package MantisBT\n * @copyright Copyright 2016  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses access_api.php\n * @uses authentication_api.php\n * @uses compress_api.php\n * @uses config_api.php\n * @uses constant_inc.php\n * @uses current_user_api.php\n * @uses custom_field_api.php\n * @uses filter_api.php\n * @uses filter_constants_inc.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses string_api.php\n * @uses version_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'access_api.php' );\nrequire_api( 'authentication_api.php' );\nrequire_api( 'compress_api.php' );\nrequire_api( 'config_api.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'current_user_api.php' );\nrequire_api( 'custom_field_api.php' );\nrequire_api( 'filter_api.php' );\nrequire_api( 'filter_constants_inc.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'version_api.php' );\n\nauth_ensure_user_authenticated();\n\nlayout_page_header( lang_get('manage_filter_edit_page_title' ) );\n\nlayout_page_begin( 'manage_filter_edit_page.php' );\n\n$f_filter_id = gpc_get_int( 'filter_id', null );\nif( null === $f_filter_id ) {\n\terror_parameters( 'FILTER_ID' );\n\ttrigger_error( ERROR_EMPTY_FIELD, ERROR );\n}\n\n$t_filter = filter_get( $f_filter_id, null );\nif( null === $t_filter ) {\n\taccess_denied();\n}\n\n$f_view_type = gpc_get_string( 'view_type', $t_filter['_view_type'] );\n$t_filter['_view_type'] = $f_view_type;\n$t_filter = filter_ensure_valid_filter( $t_filter );\n\n$t_action = 'manage_filter_edit_update.php';\n$t_current_project_id = helper_get_current_project();\n$t_filter_project_id = filter_get_field( $f_filter_id, 'project_id' );\n\n?>\n\n<div class=\"col-md-12 col-xs-12\">\n\t<div class=\"space-10\"></div>\n\n\t<form method=\"post\" name=\"filters\" id=\"filters_form_open\" action=\"<?php echo $t_action; ?>\">\n\t<input type=\"hidden\" name=\"filter_id\" value=\"<?php echo $f_filter_id ?>\" >\n\t<input type=\"hidden\" name=\"view_type\" value=\"<?php echo $t_filter['_view_type'] ?>\" >\n\t<?php echo form_security_field( 'manage_filter_edit_update' ) ?>\n\n\t<div class=\"widget-box widget-color-blue2\">\n\t\t<div class=\"widget-header widget-header-small\">\n\t\t\t<h4 class=\"widget-title lighter\">\n\t\t\t\t<i class=\"ace-icon fa fa-filter\"></i>\n\t\t\t\t<?php echo lang_get('edit_filter') ?>\n\t\t\t</h4>\n\n\t\t\t<div class=\"widget-toolbar\">\n\t\t\t\t<div class=\"widget-menu\">\n\t\t\t\t\t<a href=\"#\" data-action=\"settings\" data-toggle=\"dropdown\">\n\t\t\t\t\t\t<i class=\"ace-icon fa fa-bars bigger-125\"></i>\n\t\t\t\t\t</a>\n\t\t\t\t\t<ul class=\"dropdown-menu dropdown-menu-right dropdown-yellow dropdown-caret dropdown-closer\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t$t_url = 'manage_filter_edit_page.php?filter_id=' . $f_filter_id . '&view_type=';\n\t\t\t\t\t\t\tfilter_print_view_type_toggle( $t_url, $t_filter['_view_type'] );\n\t\t\t\t\t\t?>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<div class=\"widget-body\">\n\t\t\t<div class=\"widget-main no-padding\">\n\n\t\t\t\t<div class=\"widget-toolbox padding-8 clearfix\">\n\t\t\t\t\t<div class=\"btn-toolbar pull-left\">\n\t\t\t\t\t\t<div class=\"form-inline\">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<?php echo lang_get( 'query_name' ) ?>&nbsp;\n\t\t\t\t\t\t\t\t<input type=\"text\" size=\"25\" name=\"filter_name\" maxlength=\"64\" value=\"<?php echo string_display_line( filter_get_field( $f_filter_id, 'name' ) ) ?>\">\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"table-responsive\">\n\t\t\t\t\t<?php\n\t\t\t\t\t$t_for_screen = true;\n\t\t\t\t\t$t_static = gpc_get_bool( 'static', false );\n\t\t\t\t\tfilter_form_draw_inputs( $t_filter, $t_for_screen, $t_static );\n\t\t\t\t\t?>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"widget-toolbox padding-8 clearfix\">\n\t\t\t\t\t<div class=\"btn-toolbar pull-left\">\n\t\t\t\t\t\t<div class=\"form-inline\">\n\t\t\t\t\t\t\t<label><?php echo lang_get( 'search' ) ?>&nbsp;\n\t\t\t\t\t\t\t\t<input type=\"text\" id=\"filter-search-txt\" class=\"input-sm\" size=\"16\"\n\t\t\t\t\t\t\t\t\t   name=\"<?php echo FILTER_PROPERTY_SEARCH ?>\"\n\t\t\t\t\t\t\t\t\t   value=\"<?php echo string_attribute( $t_filter[FILTER_PROPERTY_SEARCH] ) ?>\">\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"table-responsive\">\n\t\t\t\t\t<table class=\"table table-bordered table-condensed table-striped\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\tif( access_has_project_level( config_get( 'stored_query_create_shared_threshold' ) ) ) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t\t<?php echo lang_get( 'view_status' ) ?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace\" name=\"is_public\" value=\"1\" <?php check_checked( (bool)filter_get_field( $f_filter_id, 'is_public' ), true ) ?> />\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'public' ) ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t&#160;&#160;&#160;&#160;\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace\" name=\"is_public\" value=\"0\" <?php check_checked( (bool)filter_get_field( $f_filter_id, 'is_public' ), false ) ?> />\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'private' ) ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t\t<?php echo lang_get( 'email_project' ) ?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<label class=\"inline\">\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace input-sm\" name=\"filter_project_id\" value=\"<?php echo ALL_PROJECTS ?>\" <?php check_checked( ALL_PROJECTS == $t_filter_project_id ) ?>>\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'all_projects' ) ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<?php if( ALL_PROJECTS != $t_filter_project_id ) { ?>\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace input-sm\" name=\"filter_project_id\" value=\"<?php echo $t_filter_project_id ?>\" <?php check_checked( ALL_PROJECTS != $t_filter_project_id ) ?>>\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'stored_project' ) . ' (' . project_get_name( $t_filter_project_id ) . ')' ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t<?php if( $t_filter_project_id != $t_current_project_id ) { ?>\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" class=\"ace input-sm\" name=\"filter_project_id\" value=\"<?php echo $t_current_project_id ?>\">\n\t\t\t\t\t\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'current_project' ) . ' (' . project_get_name( $t_current_project_id ) . ')' ?></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"widget-toolbox padding-8 clearfix\">\n\t\t\t<input type=\"submit\" class=\"btn btn-primary btn-white btn-round\" value=\"<?php echo lang_get( 'update_filter' ) ?>\" />\n\t\t</div>\n\t</div>\n\t</form>\n</div>\n\n<?php\nlayout_page_end();\n"], "filenames": ["manage_filter_edit_page.php"], "buggy_code_start_loc": [127], "buggy_code_end_loc": [128], "fixing_code_start_loc": [127], "fixing_code_end_loc": [128], "type": "CWE-79", "message": "An issue was discovered in manage_filter_edit_page.php in MantisBT 2.x through 2.15.0. A cross-site scripting (XSS) vulnerability in the Edit Filter page allows execution of arbitrary code (if CSP settings permit it) when displaying a filter with a crafted name (e.g., 'foobar\" onclick=\"alert(1)').", "other": {"cve": {"id": "CVE-2018-14504", "sourceIdentifier": "cve@mitre.org", "published": "2018-08-03T18:29:00.487", "lastModified": "2018-10-02T20:20:47.883", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in manage_filter_edit_page.php in MantisBT 2.x through 2.15.0. A cross-site scripting (XSS) vulnerability in the Edit Filter page allows execution of arbitrary code (if CSP settings permit it) when displaying a filter with a crafted name (e.g., 'foobar\" onclick=\"alert(1)')."}, {"lang": "es", "value": "Se ha descubierto un problema en manage_filter_edit_page.php en MantisBT en versiones 2.x hasta la versi\u00f3n 2.15.0. Una vulnerabilidad Cross-Site Scripting (XSS) en la p\u00e1gina Edit Filter permite la ejecuci\u00f3n de c\u00f3digo arbitrario (si la configuraci\u00f3n CSP lo permite) al mostrar un filtro con un nombre manipulado (p.ej. 'foobar\" onclick=\"alert(1)')."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndIncluding": "2.15.0", "matchCriteriaId": "A2AC9D0D-5278-499A-8790-A7748A96E034"}]}]}], "references": [{"url": "http://github.com/mantisbt/mantisbt/commit/8b5fa243dbf04344a55fe880135ec149fc1f439f", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://mantisbt.org/blog/archives/mantisbt/602", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://mantisbt.org/bugs/view.php?id=24608", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Patch", "Vendor Advisory"]}]}, "github_commit_url": "http://github.com/mantisbt/mantisbt/commit/8b5fa243dbf04344a55fe880135ec149fc1f439f"}}