{"buggy_code": ["# Release Notes for Craft CMS 4\n\n## Unreleased\n\n- Content tab menus now reveal when a tab contains validation errors, and invalid tabs\u2019 menu options get the same warning icon treatment as inline tabs do. ([#12971](https://github.com/craftcms/cms/issues/12971))\n- Selectize menus now expand upwards when there\u2019s not ample space below them. ([#12976](https://github.com/craftcms/cms/issues/12976))\n- Element index bulk action spinners are now centered on the viewport. ([#12972](https://github.com/craftcms/cms/issues/12972))\n- Fixed a bug where Assets fields weren\u2019t respecting their View Mode setting when viewing entry revisions. ([#12948](https://github.com/craftcms/cms/issues/12948))\n- Fixed a bug where asset pagination was broken when there was more than 100 subfolders. ([#12969](https://github.com/craftcms/cms/issues/12969))\n- Fixed a bug where entry index pages\u2019 \u201cRevision Notes\u201d and \u201cLast Edited By\u201d columns weren\u2019t getting populated for disabled entries. ([#12981](https://github.com/craftcms/cms/issues/12981))\n- Fixed a bug where assets were getting relocated to the root volume folder when renamed. ([#12995](https://github.com/craftcms/cms/issues/12995))\n- Fixed a bug where it wasn\u2019t possible to preview entries on another domain when the system was offline. ([#12979](https://github.com/craftcms/cms/issues/12979))\n- Fixed a bug where `craft\\helpers\\FileHelper::absolutePath()` wasn\u2019t treating Windows file paths beginning drive letters as absolute. ([craftcms/generator#16](https://github.com/craftcms/generator/issues/16))\n- Fixed a bug where it wasn\u2019t possible to sort Categories fields with \u201cMaintain hierarchy\u201d disabled. ([#10560](https://github.com/craftcms/cms/discussions/10560))\n- Fixed a bug where selectize inputs didn\u2019t have a minimum width. ([#12950](https://github.com/craftcms/cms/issues/12950))\n- Fixed a bug where the wrong tab would appear to be initially selected after an autosave, if the selected tab had changed during the autosave. ([#12960](https://github.com/craftcms/cms/issues/12960))\n- Fixed a bug where it wasn\u2019t possible to add a Dropdown field without a blank option to a global set. ([#12965](https://github.com/craftcms/cms/issues/12965))\n- Fixed a bug where automatically-added Matrix blocks (per the field\u2019s Min Blocks setting) were getting discarded if no changes were made to them. ([#12973](https://github.com/craftcms/cms/issues/12973))\n- Fixed an error that could occur when installing Craft with an existing project config, if any image transforms were defined that didn\u2019t specify the `upscale` property.\n- Fixed a bug where nested folders in asset search results weren\u2019t showing their relative path.\n- Fixed an XSS vulnerability.\n\n## 4.4.5 - 2023-03-21\n\n- Fixed a bug where relation data was getting deleted when running garbage collection on PostgreSQL. ([#9905](https://github.com/craftcms/cms/issues/9905))\n- Fixed a bug where Lightswitch fields\u2019 \u201cOFF Label\u201d and \u201cON Label\u201d settings weren\u2019t getting translated. ([#12942](https://github.com/craftcms/cms/issues/12942))\n- Fixed a bug where `craft\\events\\DefineUserContentSummaryEvent::$userId` was never set for `craft\\controllers\\EVENT_DEFINE_CONTENT_SUMMARY` events. ([#12944](https://github.com/craftcms/cms/issues/12944))\n- Fixed a bug where element edit pages weren\u2019t displaying layout tabs that didn\u2019t have a unique name. ([#12928](https://github.com/craftcms/cms/issues/12928))\n- Fixed a bug where the `CRAFT_LOG_PHP_ERRORS` constant/environment variable wasn\u2019t being respected when set to `false`. ([#12862](https://github.com/craftcms/cms/issues/12862))\n- Fixed a bug where the `entrify/categories` command wasn\u2019t converting disabled categories. ([#12945](https://github.com/craftcms/cms/issues/12945))\n- Updated svg-sanitizer to 0.16. ([#12943](https://github.com/craftcms/cms/issues/12943))\n\n## 4.4.4 - 2023-03-20\n\n- Input autofocussing has been reintroduced throughout the control panel. ([#12921](https://github.com/craftcms/cms/discussions/12921))\n- The `|json_encode` Twig filter now calls `craft\\helpers\\Json::encode()` internally, improving error handling. ([#12919](https://github.com/craftcms/cms/issues/12919))\n- `craft\\helpers\\Json::encode()` no longer sets the `JSON_UNESCAPED_SLASHES` flag by default.\n- Fixed a JavaScript error that occurred when resolving an asset move conflict. ([#12920](https://github.com/craftcms/cms/issues/12920))\n- Fixed a bug where volume subfolders were being shown when viewing soft-deleted assets. ([#12927](https://github.com/craftcms/cms/issues/12927))\n- Fixed a bug where structure data was getting deleted when running garbage collection on PostgreSQL. ([#12925](https://github.com/craftcms/cms/issues/12925))\n- Fixed an error that could occur when rebuilding the project config, if there were any custom source definitions for element types that weren\u2019t Composer-installed. ([#12881](https://github.com/craftcms/cms/issues/12881))\n- Fixed an XSS vulnerability.\n\n## 4.4.3 - 2023-03-16\n\n- Customize Sources modals no longer hide when the <kbd>Esc</kbd> key is pressed on the surrounding area is clicked on. ([#12895](https://github.com/craftcms/cms/issues/12895))\n- Sections created via `entrify` commands no longer get a \u201cPrimary entry page\u201d preview target by default, unless it was sourced from a category group with URLs. ([#12897](https://github.com/craftcms/cms/issues/12897))\n- `entrify` commands and the `sections/create` command now prompt for the initial entry type name and handle. ([#12894](https://github.com/craftcms/cms/discussions/12894))\n- Added `craft\\helpers\\FileHelper::uniqueName()`.\n- Added `craft\\helpers\\StringHelper::emojiToShortcodes()`.\n- Added `craft\\helpers\\StringHelper::shortcodesToEmoji()`.\n- Fixed an error that occurred when uploading an asset with a filename over 250 characters long. ([#12889](https://github.com/craftcms/cms/issues/12889))\n- Fixed an error that could occur when preparing licensing alerts, if any licenses were invalid. ([#12899](https://github.com/craftcms/cms/issues/12899))\n- Fixed a bug where it wasn\u2019t possible to drag nested Neo blocks. ([#12896](https://github.com/craftcms/cms/issues/12896))\n- Fixed a bug where fields with reduced widths in Matrix blocks were becoming full-width while dragged. ([#12909](https://github.com/craftcms/cms/issues/12909))\n- Fixed a bug where multi-edition plugins weren\u2019t showing their edition labels within the Plugin Store cart. ([#12910](https://github.com/craftcms/cms/issues/12910))\n- Fixed a bug where private plugins\u2019 control panel templates weren\u2019t directly accessible by URL.\n- Fixed a bug where element selector modals were persisting parts of their state in the query string. ([#12900](https://github.com/craftcms/cms/issues/12900))\n- Fixed a PHP error that occurred if a field type stored enum values. ([#12297](https://github.com/craftcms/cms/issues/12297))\n- Fixed an error that could occur when generating transforms for images stored in Google Cloud Storage. ([#12878](https://github.com/craftcms/cms/issues/12878))\n- Fixed a bug where some unicode characters were getting removed by LitEmoji. ([#12905](https://github.com/craftcms/cms/issues/12905))\n\n## 4.4.2 - 2023-03-14\n\n- The `entrify/categories` and `entrify/global-set` commands now update user permissions for the new sections. ([#12849](https://github.com/craftcms/cms/discussions/12849))\n- Variable dumps now use a light theme for web requests by default. ([#12857](https://github.com/craftcms/cms/pull/12857))\n- Added the `dumper` application component and `craft\\base\\ApplicationTrait::getDumper()`. ([#12869](https://github.com/craftcms/cms/pull/12869))\n- Added `craft\\models\\ImageTransform::getConfig()`.\n- Fixed a bug where it wasn\u2019t always possible to access entry or category edit pages if the `slugWordSeparator` config setting was set to `/`. ([#12871](https://github.com/craftcms/cms/issues/12871))\n- Fixed a bug where `craft\\helpers\\Html::parseTagAttribute()` wasn\u2019t decoding attribute values, which could lead to double-encoded attributes, e.g. when using the `|attr` filter. ([#12887](https://github.com/craftcms/cms/issues/12887))\n- Fixed a bug where multi-value field inputs would be considered modified even if they weren\u2019t, if the field type\u2019s `isValueEmpty()` method returned `true`. ([#12858](https://github.com/craftcms/cms/issues/12858))\n- Fixed a bug where asset thumbnails within secondary slideout tabs weren\u2019t loading immediately. ([#12859](https://github.com/craftcms/cms/issues/12859))\n- Fixed a bug where rebuilding the project config would lose track of image transforms\u2019 `fill` and `upscale` settings. ([#12879](https://github.com/craftcms/cms/issues/12879))\n- Fixed a bug where blank Dropdown options weren\u2019t showing up in the Selectize menu. ([#12880](https://github.com/craftcms/cms/issues/12880))\n- Fixed a bug where it was possible to save a Dropdown field without a value, even if the field didn\u2019t have any blank options. ([#12880](https://github.com/craftcms/cms/issues/12880))\n- Fixed a bug where element action triggers weren\u2019t centered for element sources that don\u2019t define any exporters. ([#12885](https://github.com/craftcms/cms/issues/12885))\n- Fixed an error that could occur when generating a transform URL for an image in the temp folder.\n- Fixed XSS vulnerabilities.\n- Fixed an SSRF vulnerability.\n\n## 4.4.1 - 2023-03-09\n\n- Fixed a bug where it wasn\u2019t possible to select subfolders on the Assets index page. ([#12802](https://github.com/craftcms/cms/issues/12802))\n- Fixed a bug where element index search inputs were losing focus when the element listing was updated. ([#12846](https://github.com/craftcms/cms/issues/12846))\n- Fixed a bug where the database driver was being referenced as \u201cMySQL\u201d when using MariaDB. ([#12827](https://github.com/craftcms/cms/issues/12827))\n- Fixed a bug where users weren\u2019t able to select assets within Assets fields, if they didn\u2019t have full permissions for the volume. ([#12851](https://github.com/craftcms/cms/issues/12851))\n- Fixed a bug where the Assets index page\u2019s URL would get updated incorrectly when renaming a subfolder.\n- Fixed a bug where non-admin users weren\u2019t able to view Single section entries. ([#12838](https://github.com/craftcms/cms/issues/12838))\n- Fixed an error that could occur when saving an element with eager-loaded relations. ([#12839](https://github.com/craftcms/cms/issues/12839))\n- Fixed a bug where Customize Sources modals weren\u2019t showing source headings with no subsequent sources. ([#12840](https://github.com/craftcms/cms/issues/12840))\n- Fixed a bug where `entrify` commands could leave the database and project config data in inconsistent states, if aborted prematurely. ([#12850](https://github.com/craftcms/cms/pull/12850))\n- Fixed a bug where the `entrify/global-set` command wasn\u2019t always suggesting the command to run on other environments.\n- Fixed a bug where the Assets index page would appear to keep loading indefinitely after renaming a subfolder.\n- Fixed a bug where folders within asset indexes were getting the current site name appended to them, on multi-site installs. ([#12852](https://github.com/craftcms/cms/issues/12852))\n- Fixed a SQL error that could occur when updating to Craft 4.4 on PostgreSQL. ([#12855](https://github.com/craftcms/cms/issues/12855))\n- Added `craft\\db\\Connection::getDriverLabel()`.\n\n## 4.4.0 - 2023-03-08\n\n### Content Management\n- Volume subfolders are now displayed within the element listing pane on asset indexes, rather than as nested sources in the sidebar. ([#12558](https://github.com/craftcms/cms/pull/12558), [#9171](https://github.com/craftcms/cms/discussions/9171), [#5809](https://github.com/craftcms/cms/issues/5809))\n- Asset indexes now display the current subfolder path above the element listing. ([#12558](https://github.com/craftcms/cms/pull/12558))\n- Assets and folders can now be drag-and-dropped simultaneously. ([#12792](https://github.com/craftcms/cms/pull/12792))\n- Reduced the likelihood of accidentally triggering an asset drag operation. ([#12792](https://github.com/craftcms/cms/pull/12792))\n- Reduced the likelihood of accidentally dropping dragged assets/folders on an unintended target. ([#12792](https://github.com/craftcms/cms/pull/12792))\n- It\u2019s now possible to move volume folders and assets to a new location via a new \u201cMove\u2026\u201d bulk element action, rather than via drag-and-drop interactions. ([#12558](https://github.com/craftcms/cms/pull/12558))\n- It\u2019s now possible to sort asset indexes by image width and height. ([#12653](https://github.com/craftcms/cms/pull/12653))\n- Structured element index sources now have a dedicated view mode option for showing elements as a structured table. ([#12722](https://github.com/craftcms/cms/pull/12722), [#12718](https://github.com/craftcms/cms/discussions/12718))\n- Entry and category indexes can now have \u201cAncestors\u201d and \u201cParent\u201d columns. ([#12666](https://github.com/craftcms/cms/discussions/12666))\n- All element sources now have a \u201cDuplicate\u201d action, even if the element type\u2019s `defineActions()` method didn\u2019t include one. ([#12382](https://github.com/craftcms/cms/discussions/12382))\n- Element index pages now track the search term in a query param, so the results can be shared. ([#8942](https://github.com/craftcms/cms/discussions/8942), [#12399](https://github.com/craftcms/cms/pull/12399))\n- Entries with more than 10 revisions now include a \u201cView all revisions\u201d item within their revision menu, which links to a new revisions index page for the entry that paginates through all its revisions. ([#8609](https://github.com/craftcms/cms/discussions/8609))\n- Entries and Categories fields now have \u201cMaintain hierarchy\u201d settings, which become available when a single structured source is selected. ([#8522](https://github.com/craftcms/cms/discussions/8522), [#8748](https://github.com/craftcms/cms/discussions/8748), [#10560](https://github.com/craftcms/cms/discussions/10560), [#11749](https://github.com/craftcms/cms/pull/11749))\n- Entries fields now have a \u201cBranch Limit\u201d setting, which becomes available when \u201cMaintain hierarchy\u201d is enabled, replacing \u201cMin Relations\u201d and \u201cMax Relations\u201d.\n- Categories fields now have \u201cMin Relations\u201d and \u201cMax Relations\u201d settings, which become available when \u201cMaintain hierarchy\u201d is disabled, replacing \u201cBranch Limit\u201d.\n- Added \u201cViewable\u201d asset and entry condition rules. ([#12240](https://github.com/craftcms/cms/discussions/12240), [#12266](https://github.com/craftcms/cms/pull/12266))\n- Renamed the \u201cEditable\u201d asset and entry condition rules to \u201cSavable\u201d. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Assets, categories, and entries will now redirect to the last-selected source on their index pages when saved. ([#11996](https://github.com/craftcms/cms/discussions/11996))\n- Dropdown fields that don\u2019t have a blank option and are missing a value will now include and select a blank option at the beginning of their menu. ([#12235](https://github.com/craftcms/cms/discussions/12235))\n- Tip and Warning field layout UI elements can now be marked as dismissible, giving authors the ability to hide them. ([#12188](https://github.com/craftcms/cms/discussions/12188))\n- All assets now get thumbnails in the control panel, even if they don\u2019t have a transform filesystem with a base URL. ([#12531](https://github.com/craftcms/cms/issues/12531))\n- Dropdown and Multi-select fields now use Selectize. ([#8403](https://github.com/craftcms/cms/discussions/8403))\n- Improved the styling of bulk element action triggers. ([#12793](https://github.com/craftcms/cms/pull/12793))\n\n### Accessibility\n- Improved the announcement menu for screen readers. ([#12361](https://github.com/craftcms/cms/pull/12361))\n- Improved keyboard control of the Updates utility. ([#12189](https://github.com/craftcms/cms/pull/12189))\n- Improved the color contrast and keyboard control of the Customize Sources modal. ([#12233](https://github.com/craftcms/cms/pull/12233))\n- Improved info icons for screen readers. ([#12272](https://github.com/craftcms/cms/pull/12272))\n- Removed input autofocussing throughout the control panel. ([#12324](https://github.com/craftcms/cms/discussions/12324), [#12332](https://github.com/craftcms/cms/pull/12332), [#12406](https://github.com/craftcms/cms/pull/12406))\n- Improved the login screen for screen readers. ([#12386](https://github.com/craftcms/cms/pull/12386))\n- Improved _conditional_ and _required_ field indicators for screen readers. ([#12509](https://github.com/craftcms/cms/pull/12509))\n- Improved element index pages for screen readers. ([#12731](https://github.com/craftcms/cms/pull/12731))\n- Improved bulk element action triggers on element index pages. ([#12415](https://github.com/craftcms/cms/pull/12415))\n- Improved the color contrast of element indexes. ([#12213](https://github.com/craftcms/cms/pull/12213))\n- Asset preview modals now show videos\u2019 alt text. ([#12637](https://github.com/craftcms/cms/pull/12637))\n- Improved element indexes\u2019 \u201cExport\u201d buttons for screen readers. ([#12754](https://github.com/craftcms/cms/pull/12754))\n- Improved Quick Post widgets\u2019 \u201cFields\u201d settings for screen readers. ([#12772](https://github.com/craftcms/cms/pull/12772))\n- Improved some element selector modals for screen readers. ([#12783](https://github.com/craftcms/cms/pull/12783))\n- Fixed a bug where it wasn\u2019t possible to vertically scroll element index filter HUDs. ([#12751](https://github.com/craftcms/cms/pull/12751))\n- Fixed a bug where translated locale names within users\u2019 \u201cLanguage\u201d and \u201cFormatting Locale\u201d preference menus didn\u2019t have `lang` attributes. ([#12773](https://github.com/craftcms/cms/pull/12773))\n- Fixed a bug where search icons on element indexes weren\u2019t hidden from screen readers. ([#12785](https://github.com/craftcms/cms/pull/12785))\n\n### Administration\n- Most licensing isuses are now consolidated into a single control panel alert, with a button to resolve them all with a single purchase on Craft Console. ([#12768](https://github.com/craftcms/cms/pull/12768))\n- Conditional layout components are now identified using a condition icon within field layout designers. ([#12250](https://github.com/craftcms/cms/issues/12250))\n- All CLI commands now support an `--isolated` option, which ensures the command is run in isolation. ([#12337](https://github.com/craftcms/cms/discussions/12337), [#12350](https://github.com/craftcms/cms/pull/12350))\n- Added the `entrify/categories`, `entrify/tags`, and `entrify/global-set` commands, for converting categories, tags, and global sets to entries. ([#12689](https://github.com/craftcms/cms/pull/12689), [#9781](https://github.com/craftcms/cms/discussions/9781))\n- Added the `sections/create` and `sections/delete` commands. ([#12689](https://github.com/craftcms/cms/pull/12689))\n- The `plugin/install`, `plugin/uninstall`, `plugin/enable`, and `plugin/disabled` commands now support an `--all` option, which applies the action to all applicable Composer-installed plugins. ([#11373](https://github.com/craftcms/cms/discussions/11373), [#12218](https://github.com/craftcms/cms/pull/12218))\n- The `project-config/apply` command now supports a `--quiet` option, which reduces the command output. ([#12568](https://github.com/craftcms/cms/discussions/12568))\n- Added the `users/unlock` console command. ([#12345](https://github.com/craftcms/cms/discussions/12345))\n- The Asset Indexes utility no longer skips volumes if the root folder was completely empty. ([#12585](https://github.com/craftcms/cms/issues/12585), [#12604](https://github.com/craftcms/cms/pull/12604))\n- The Asset Indexes utility now has a \u201cList empty folders\u201d setting, which determines whether empty folders sholud be listed for deletion from the index. ([#12604](https://github.com/craftcms/cms/pull/12604))\n- The Asset Indexes utility now lists missing/empty folders and files separately in the review screen. ([#12604](https://github.com/craftcms/cms/pull/12604))\n- Relational condition rules for conditions that are saved to the project config now accept a Twig template which outputs a related element ID dynamically. ([#12679](https://github.com/craftcms/cms/pull/12679), [#12676](https://github.com/craftcms/cms/discussions/12676))\n- Image transform settings no longer show the \u201cDefault Focal Point\u201d setting when Mode is set to \u201cFit\u201d, as the setting had no effect. ([#12774](https://github.com/craftcms/cms/pull/12774))\n- Improved the CLI output for `index-assets` commands. ([#12604](https://github.com/craftcms/cms/pull/12604))\n\n### Development\n- Added the \u201cLetterbox\u201d (`letterbox`) image transform mode. ([#8848](https://github.com/craftcms/cms/discussions/8848), [#12214](https://github.com/craftcms/cms/pull/12214))\n- Added the `preloadSingles` config setting, which causes front-end Twig templates to automatically preload Single section entries which are referenced in the template. ([#12698](https://github.com/craftcms/cms/pull/12787))\n- Control panel-defined image transforms now have an \u201cAllow Upscaling\u201d setting, which will initially be set to the `upscaleImages` config setting for existing transforms. ([#12214](https://github.com/craftcms/cms/pull/12214))\n- Template-defined image transforms can now have an `upscale` setting. The `upscaleImages` config setting will be used by default if not set. ([#12214](https://github.com/craftcms/cms/pull/12214))\n- Added the `exec` command, which executes an individual PHP statement and outputs the result. ([#12528](https://github.com/craftcms/cms/pull/12528))\n- Added the `editable` and `savable` asset query params. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added the `savable` entry query param. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- The `editable` entry query param can now be set to `false` to only show entries that _can\u2019t_ be viewed by the current user. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added the `{% dump %}` tag, which dumps variables into a new \u201cDumps\u201d Debug Toolbar panel. ([#12506](https://github.com/craftcms/cms/pull/12506))\n- Added the `base64_decode` and `base64_encode` Twig filters. ([#12696](https://github.com/craftcms/cms/discussions/12696))\n- The `dump()` Twig function now utilizes `Craft::dump()`, and no longer requires Dev Mode to be active. ([#12486](https://github.com/craftcms/cms/pull/12486), [#12479](https://github.com/craftcms/cms/discussions/12479))\n- The `{% dd %}` Twig tag can now output the entire `context` array, if no variable is passed to it. ([#12486](https://github.com/craftcms/cms/pull/12486))\n- Added the `revisionNotes` field to elements queried via GraphQL. ([#12610](https://github.com/craftcms/cms/issues/12610))\n- Added `ancestors` and `descendants` fields to categories queried via GraphQL. ([#12427](https://github.com/craftcms/cms/issues/12427))\n- Added `craft\\elements\\Asset::getFormat()` and the `format` field for assets queried via GraphQL. ([#12398](https://github.com/craftcms/cms/pull/12398), [#12521](https://github.com/craftcms/cms/pull/12521))\n- `Craft::dump()`, `Craft::dd()`, the `dump()` Twig function, and the `{% dd %}` Twig tag now use Symfony\u2019s VarDumper. ([#12479](https://github.com/craftcms/cms/discussions/12479))\n- `Craft::dump()` now has a `$return` argument, which will cause the resulting dump to be returned as a string rather than output, if `true`.\n- `craft\\elements\\Asset::getMimeType()` now has a `$transform` argument, and assets\u2019 `mimeType` GraphQL fields now support a `@transform` directive. ([#12269](https://github.com/craftcms/cms/discussions/12269), [#12397](https://github.com/craftcms/cms/pull/12397), [#12522](https://github.com/craftcms/cms/pull/12522))\n- `craft\\helpers\\App::env()` now returns `null` if the original value was `'null'`. ([#12742](https://github.com/craftcms/cms/pull/12742))\n- `craft\\helpers\\Db::escapeParam()` now escapes `:empty:` and `:notempty:` strings. ([#12691](https://github.com/craftcms/cms/discussions/12691))\n\n### Extensibility\n- Added support for private plugins. ([#12716](https://github.com/craftcms/cms/pull/12716), [#8908](https://github.com/craftcms/cms/discussions/8908))\n- Added the `elements/revisions` action. ([#12211](https://github.com/craftcms/cms/pull/12211))\n- Console controllers that directly use `craft\\console\\ControllerTrait` no longer need to call `$this->checkTty()` or `$this->checkRootUser()` themselves; they are now called from `ControllerTrait::init()` and `beforeAction()`.\n- Element source definitions can now include a `defaultSourcePath` key.\n- Element custom field validation now respects the list of attributes passed to `validate()`.\n- Improving IDE autocompletion for chained query param calls. ([#12656](https://github.com/craftcms/cms/pull/12656))\n- Added `craft\\base\\ApplicationTrait::getEditionHandle()`.\n- Added `craft\\base\\BaseFsInterface`. ([#12709](https://github.com/craftcms/cms/pull/12709))\n- Added `craft\\base\\Batchable`.\n- Added `craft\\base\\Element::cpRevisionsUrl()`.\n- Added `craft\\base\\Element::indexElements()`.\n- Added `craft\\base\\ElementInterface::findSource()`.\n- Added `craft\\base\\ElementInterface::getCpRevisionsUrl()`.\n- Added `craft\\base\\ElementInterface::getUiLabelPath()`.\n- Added `craft\\base\\ElementInterface::indexElementCount()`.\n- Added `craft\\base\\ElementInterface::setUiLabelPath()`.\n- Added `craft\\base\\Event`, which provides a `once()` static method for registering an event handler that will only be triggered up to one time.\n- Added `craft\\console\\ControllerTrait::beforeAction()`.\n- Added `craft\\console\\ControllerTrait::failure()`.\n- Added `craft\\console\\ControllerTrait::init()`.\n- Added `craft\\console\\ControllerTrait::markdownToAnsi()`.\n- Added `craft\\console\\ControllerTrait::note()`.\n- Added `craft\\console\\ControllerTrait::options()`.\n- Added `craft\\console\\ControllerTrait::runAction()`.\n- Added `craft\\console\\ControllerTrait::success()`.\n- Added `craft\\console\\ControllerTrait::tip()`.\n- Added `craft\\console\\ControllerTrait::warning()`.\n- Added `craft\\db\\QueryBatcher`.\n- Added `craft\\debug\\DumpPanel`.\n- Added `craft\\elements\\conditions\\assets\\ViewableConditionRule`. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added `craft\\elements\\conditions\\ElementCondition::$referenceElement`.\n- Added `craft\\elements\\conditions\\entries\\ViewableConditionRule`. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added `craft\\elements\\Entry::EVENT_DEFINE_PARENT_SELECTION_CRITERIA`. ([#12475](https://github.com/craftcms/cms/discussions/12475))\n- Added `craft\\events\\DefineInputOptionsEvent`. ([#12351](https://github.com/craftcms/cms/pull/12351))\n- Added `craft\\events\\ListVolumesEvent`.\n- Added `craft\\events\\UserPhotoEvent`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\fields\\BaseOptionsField::EVENT_DEFINE_OPTIONS`. ([#12351](https://github.com/craftcms/cms/pull/12351))\n- Added `craft\\fields\\BaseRelationField::$branchLimit`.\n- Added `craft\\fields\\BaseRelationField::$maintainHierarchy`.\n- Added `craft\\helpers\\Db::rawTableShortName()`.\n- Added `craft\\helpers\\ImageTransforms::generateTransform()`.\n- Added `craft\\helpers\\ImageTransforms::parseTransformString()`.\n- Added `craft\\helpers\\StringHelper::toHandle()`.\n- Added `craft\\helpers\\Template::fallback()`.\n- Added `craft\\helpers\\Template::fallbackExists()`.\n- Added `craft\\helpers\\Template::preloadSingles()`.\n- Added `craft\\image\\Raster::scaleToFitAndFill()`.\n- Added `craft\\image\\Raster::setFill()`.\n- Added `craft\\imagetransforms\\FallbackTransformer`.\n- Added `craft\\models\\CategoryGroup::$dateDeleted`.\n- Added `craft\\models\\ImageTransform::$fill`.\n- Added `craft\\models\\ImageTransform::$upscale`.\n- Added `craft\\models\\TagGroup::$dateDeleted`.\n- Added `craft\\models\\VolumeFolder::getHasChildren()`.\n- Added `craft\\models\\VolumeFolder::setHasChildren()`.\n- Added `craft\\queue\\BaseBatchedJob`. ([#12638](https://github.com/craftcms/cms/pull/12638))\n- Added `craft\\queue\\jobs\\GenerateImageTransform`. ([#12340](https://github.com/craftcms/cms/pull/12340))\n- Added `craft\\services\\Assets::createFolderQuery()`.\n- Added `craft\\services\\Assets::foldersExist()`.\n- Added `craft\\services\\Elements::deleteElementForSite()`.\n- Added `craft\\services\\Elements::deleteElementsForSite()`.\n- Added `craft\\services\\Elements::EVENT_AFTER_DELETE_FOR_SITE`. ([#12354](https://github.com/craftcms/cms/issues/12354))\n- Added `craft\\services\\Elements::EVENT_BEFORE_DELETE_FOR_SITE`. ([#12354](https://github.com/craftcms/cms/issues/12354))\n- Added `craft\\services\\Entries::getSingleEntriesByHandle()`. ([#12698](https://github.com/craftcms/cms/pull/12787))\n- Added `craft\\services\\Fields::getFieldsByType()`. ([#12381](https://github.com/craftcms/cms/discussions/12381))\n- Added `craft\\services\\Path::getImageTransformsPath()`.\n- Added `craft\\services\\Search::normalizeSearchQuery()`.\n- Added `craft\\services\\Users::EVENT_AFTER_DELETE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\services\\Users::EVENT_AFTER_SAVE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\services\\Users::EVENT_BEFORE_DELETE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\services\\Users::EVENT_BEFORE_SAVE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\utilities\\AssetIndexes::EVENT_LIST_VOLUMES`. ([#12383](https://github.com/craftcms/cms/pull/12383), [#12443](https://github.com/craftcms/cms/pull/12443))\n- Renamed `craft\\elements\\conditions\\assets\\EditableConditionRule` to `SavableConditionRule`, while preserving the original class name with an alias. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Renamed `craft\\elements\\conditions\\entries\\EditableConditionRule` to `SavableConditionRule`, while preserving the original class name with an alias. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- `craft\\services\\AssetIndexer::startIndexingSession()` and `createIndexingSession()` now have a `$listEmptyFolders` argument. ([#12604](https://github.com/craftcms/cms/pull/12604))\n- `craft\\base\\ElementQuery::joinElementTable()` now accepts table names in the format of `{{%tablename}}`.\n- `craft\\models\\Volume` now implements `craft\\base\\BaseFsInterface`. ([#12709](https://github.com/craftcms/cms/pull/12709))\n- `craft\\services\\Categories::getGroupByHandle()` now has a `$withTrashed` argument.\n- `craft\\services\\Globals::getSetByHandle()` now has a `$withTrashed` argument.\n- `craft\\services\\Tags::getTagGroupByHandle()` now has a `$withTrashed` argument.\n- `craft\\services\\Users::sendActivationEmail()`, `sendNewEmailVerifyEmail()`, `sendPasswordResetEmail()`, `getActivationUrl()`, `getEmailVerifyUrl()`, `getPasswordResetUrl()`, and `setVerificationCodeOnUser()` will now throw a `craft\\errors\\InvalidElementException` if the user has a non-unique email. ([#12431](https://github.com/craftcms/cms/issues/12431), [#12712](https://github.com/craftcms/cms/pull/12712))\n- Deprecated `craft\\elements\\Asset::getFs()`. `getVolume()` should be used instead.\n- Deprecated `craft\\helpers\\Assets::sortFolderTree()`.\n- Deprecated `craft\\imagetransforms\\ImageTransformer::ensureTransformUrlByIndexModel()`. `getTransformUrl()` should be used instead.\n- Deprecated `craft\\imagetransforms\\ImageTransformer::procureTransformedImage()`. `generateTransform()` should be used instead.\n- Deprecated `craft\\queue\\jobs\\GeneratePendingTransforms`. `GenerateImageTransform` should be used instead. ([#12340](https://github.com/craftcms/cms/pull/12340))\n- Deprecated `craft\\services\\Assets::getFolderTreeByFolderId()`.\n- Deprecated `craft\\services\\Assets::getFolderTreeByVolumeIds`.\n- Added `Craft.Accordion`. ([#12189](https://github.com/craftcms/cms/pull/12189))\n- Added `Craft.AssetMover`.\n- Added `Craft.BaseElementIndex::getSourcePathActionLabel()`.\n- Added `Craft.BaseElementIndex::getSourcePathActions()`.\n- Added `Craft.BaseElementIndex::getSourcePathLabel()`.\n- Added `Craft.BaseElementIndex::onSourcePathChange()`.\n- Added `Craft.BaseElementIndex::sourcePath`.\n- Added `Craft.BaseElementSelectorModal::getElementIndexParams()`.\n- Added `Craft.BaseElementSelectorModal::getIndexSettings()`.\n- Added `Craft.BaseElementSelectorModal::hasSelection()`.\n- Added `Craft.ElementFieldSettings`.\n- Added `Craft.VolumeFolderSelectorModal`.\n- Added `Garnish.MultiFunctionBtn`.\n- The custom `activate` jQuery event will now trigger when the <kbd>Return</kbd> key is pressed.\n- The custom `activate` jQuery event will no longer trigger for <kbd>Ctrl</kbd>/<kbd>Command</kbd>-clicks.\n- Deprecated `Craft.CategorySelectInput`. `Craft.BaseElementSelectInput` should be used instead. ([#11749](https://github.com/craftcms/cms/pull/11749))\n\n### System\n- Improved element deletion performance. ([#12223](https://github.com/craftcms/cms/pull/12223))\n- Improved queue performance. ([#12274](https://github.com/craftcms/cms/issues/12274), [#12340](https://github.com/craftcms/cms/pull/12340))\n- \u201cApplying new propagation method to elements\u201d, \u201cPropagating [element type]\u201d, and \u201cResaving [element type]\u201d queue jobs are now splt up into batches of up to 100 items. ([#12638](https://github.com/craftcms/cms/pull/12638))\n- Assets\u2019 alternative text values are now included as search keywords.\n- Entry type, section, category group, and tag group deletion no longer involves looping through all affected entries/categories/tags and deleting each one individually via `craft\\services\\Elements::deleteElement()`. ([#12665](https://github.com/craftcms/cms/pull/12665))\n- Updated LitEmoji to v4. ([#12226](https://github.com/craftcms/cms/discussions/12226))\n- Fixed a database deadlock error that could occur when updating a relation or structure position for an element that was simultaneously being saved. ([#9905](https://github.com/craftcms/cms/issues/9905))\n- Fixed a bug where element query `select()` and `orderBy()` params could resolve element extension table column names to custom field columns, if a custom field had a conflicting handle. ([#12652](https://github.com/craftcms/cms/issues/12652))\n- Fixed a bug where it was possible to activate inactive users with non-unique emails. ([#12431](https://github.com/craftcms/cms/issues/12431), [#12712](https://github.com/craftcms/cms/pull/12712))\n- Fixed a bug where hint text within Selectize menus had extremely low contrast on hover. ([#12829](https://github.com/craftcms/cms/issues/12829))\n\n## 4.3.11 - 2023-03-07\n\n- Fixed a bug where `craft\\events\\RegisterElementSourcesEvent::$context` wasn\u2019t always set to `modal` when defining the available element sources for an element selection modal.\n- Fixed a styling bug where multi-line checkbox labels within the Customize Sources modal and View menu weren\u2019t wrapping properly. ([#12717](https://github.com/craftcms/cms/issues/12717))\n- Fixed a bug where asset thumbnails within collapsed Matrix blocks weren\u2019t loading when the block was expanded. ([#12720](https://github.com/craftcms/cms/issues/12720))\n- Fixed a bug where user activation/verification/reset-password URLs could be root-relative, if the `@web` alias was explicitly set to a root-relative URL.\n- Fixed a PHP error that could occur if an options field\u2019s condition rule wasn\u2019t configured with any values. ([#12713](https://github.com/craftcms/cms/pull/12713))\n- Fixed a bug where control panel notifications weren\u2019t being announced to screen readers. ([#12714](https://github.com/craftcms/cms/pull/12714))\n- Fixed a bug where localized relations could be moved to a newly-added site rather than copied, when applying project config changes. ([#12702](https://github.com/craftcms/cms/issues/12702))\n- Fixed a bug where element indexes\u2019 \u201cView\u201d buttons could be inconsistently positioned in the toolbar.\n- Fixed a bug where element selector modal footers could hide the modal contents. ([#12708](https://github.com/craftcms/cms/issues/12708))\n- Fixed a bug where asset thumbnails weren\u2019t respecting the `generateTransformsBeforePageLoad` config setting. ([#12750](https://github.com/craftcms/cms/issues/12750))\n- Fixed a bug where soft hyphens, non-breaking spaces, zero-width characters, invisible times characters, and invisible separators weren\u2019t getting stripped from sanitized asset filenames. ([#12741](https://github.com/craftcms/cms/issues/12741), [#12759](https://github.com/craftcms/cms/pull/12759))\n- Fixed a bug where custom fields\u2019 database columns would get deleted when applying project config changes, if the field type wasn\u2019t present. ([#12760](https://github.com/craftcms/cms/issues/12760))\n- Fixed an error that could occur if a non-numeric value was entered into an image transform\u2019s Width or Height settings. ([#12776](https://github.com/craftcms/cms/pull/12776))\n- Fixed a bug where Assets, Categories, and Tags fields weren\u2019t respecting their \u201cAllow self relations\u201d settings. ([#12769](https://github.com/craftcms/cms/issues/12769))\n- Fixed a bug where dynamically-generated entry titles weren\u2019t always generated with the site\u2019s formatting locale in place. ([12780](https://github.com/craftcms/cms/issues/12780))\n- Fixed a bug where element titles weren\u2019t getting a pointer cursor or underlines on hover, when selected on an element index page.\n- Fixed a bug where it wasn\u2019t possible to close modals that were opened by a custom select menu via the <kbd>Esc</kbd> key. ([#12814](https://github.com/craftcms/cms/pull/12814))\n- Fixed an error that could occur when saving an element with an eager-loaded Matrix field. ([#12815](https://github.com/craftcms/cms/issues/12815))\n- Fixed a bug where the \u201csend to Developer Support\u201d links within the Craft Support widget weren\u2019t working. ([#12822](https://github.com/craftcms/cms/issues/12822))\n\n## 4.3.10 - 2023-02-17\n\n- Fixed a bug where clicking on the scrollbar of a disclosure menu would close it. ([#12681](https://github.com/craftcms/cms/issues/12681))\n- Fixed an error that could occur when loading the Plugin Store, if there wasn\u2019t a `.env` file. ([#12687](https://github.com/craftcms/cms/issues/12687))\n- Fixed a bug where large asset thumbnails weren\u2019t centered within Assets fields. ([#12682](https://github.com/craftcms/cms/issues/12682))\n- Fixed a PHP error that could occur when versioning asset URLs. ([#12678](https://github.com/craftcms/cms/issues/12678))\n- Fixed a bug where the \u201cSite\u201d element condition rule was available for non-localizable element types\u2019 conditions. ([#12601](https://github.com/craftcms/cms/pull/12601))\n- Fixed a bug where it wasn\u2019t possible to sort assets within subfolders by anything besides the asset title. ([#12688](https://github.com/craftcms/cms/issues/12688))\n\n## 4.3.9 - 2023-02-14\n\n- Image thumbnails and previews are no longer versioned if their image URL doesn\u2019t begin with one of the asset\u2019s base filesystem URLs. ([#12663](https://github.com/craftcms/cms/issues/12663))\n- HTML Purifier now allows `oembed` tags. ([ckeditor#59](https://github.com/craftcms/ckeditor/issues/59))\n- Added `craft\\htmlpurifier\\VideoEmbedUrlDef`.\n- `craft\\helpers\\Assets::revUrl()` now has an `$fsOnly` argument.\n- Fixed a bug where entries that aren\u2019t propagated to the primary site weren\u2019t showing revision notes. ([#12641](https://github.com/craftcms/cms/issues/12641))\n- Fixed a bug where HTML tags weren\u2019t getting stripped from auto-generated Handle and URI Format setting values.\n- Fixed a JavaScript error that could occur if an object with `null` values was passed to `Craft.compare()`.\n- Fixed a bug where `craft\\elements\\db\\ElementQuery::toArray()` was calling getter methods whose names conflicted with custom field handles. ([#12635](https://github.com/craftcms/cms/pull/12635))\n\n## 4.3.8.2 - 2023-02-08\n\n- Fixed a PHP error that could occur if relational fields were getting eager-loaded for elements that the fields didn\u2019t belong to. ([#12648](https://github.com/craftcms/cms/issues/12648))\n\n## 4.3.8.1 - 2023-02-08\n\n- Fixed a PHP error that occurred after performing a Composer action within Craft. ([#12647](https://github.com/craftcms/cms/issues/12647))\n- Fixed a bug where element attributes weren\u2019t getting eager-loaded. ([#12646](https://github.com/craftcms/cms/pull/12646), [#12645](https://github.com/craftcms/cms/issues/12645))\n- Fixed a bug where image previews weren\u2019t getting versioned, unless the `revAssetUrls` config setting was enabled. ([#12603](https://github.com/craftcms/cms/issues/12603))\n\n## 4.3.8 - 2023-02-07\n\n- Updated Composer to 2.2.19, fixing a PHP error that could occur when performing a Composer action within Craft, when the autoload classmap was generated with Composer 2.5. ([#12482](https://github.com/craftcms/cms/issues/12482))\n- Fixed a bug where Matrix blocks weren\u2019t getting eager-loaded. ([#12631](https://github.com/craftcms/cms/issues/12631))\n- Fixed a PHP error that could occur when calling `craft\\services\\Assets::getAllDescendantFolders()` for the root folder. ([craftcms/feed-me#1231](https://github.com/craftcms/feed-me/issues/1231))\n- Fixed a bug where revision notes weren\u2019t always being retained for provisional drafts. ([#12641](https://github.com/craftcms/cms/issues/12641))\n- Fixed a bug where it wasn\u2019t possible to access the Customize Sources modal on element index pages, if all sources were disabled. ([#12634](https://github.com/craftcms/cms/issues/12634))\n\n## 4.3.7.1 - 2023-02-05\n\n- The `_includes/forms/checkbox.twig`, `select.twig`, and `text.twig` templates no longer add an `aria-labelledby` attribute to the input if an `aria-label` attribute is also specified.\n- `craft\\helpers\\Cp::dateTimeFieldHtml()` now returns inputs contained within a fieldset.\n- Fixed a bug where some inputs were getting `aria-labelledby` attributes that referenced a nonexistent label ID.\n- Fixed a bug where the first changes to entries weren\u2019t saving properly. ([#12623](https://github.com/craftcms/cms/issues/12623), [#12592](https://github.com/craftcms/cms/issues/12592))\n- Fixed a bug where `craft\\behaviors\\CustomFieldBehavior::$owner` was getting nullified by `craft\\base\\Element::fieldByHandle()`. ([#12624](https://github.com/craftcms/cms/issues/12624))\n\n## 4.3.7 - 2023-02-03\n\n- Improved the performance of the \u201cGenerating pending image transforms\u201d queue job. ([#12274](https://github.com/craftcms/cms/issues/12274))\n- Removed the \u201cTimeout\u201d setting from the Gmail and SMTP mailer transporters, as they aren\u2019t supported by Symfony Mailer\u2019s transport configuration.\n- Removed the \u201cEncryption Method\u201d setting from the SMTP mailer transporter, as Symfony Mailer already uses TLS when port 465 is used (as it is by default).\n- The \u201cPort\u201d setting on the SMTP mailer transporter is no longer required. It will default to 465 or 25 depending on whether OpenSSL is installed.\n- Added more reserved field handles to avoid conflicts with `craft\\base\\Element` properties. ([#12577](https://github.com/craftcms/cms/issues/12577))\n- Assets\u2019 `alt` properties are now automatically trimmed of leading/trailing whitespace.\n- Asset element components in the control panel now include a `data-alt` attribute. ([#12600](https://github.com/craftcms/cms/discussions/12600))\n- Control panel requests no longer override the `pageTrigger` config setting value to `'p'`. ([#12598](https://github.com/craftcms/cms/issues/12598), [#12614](https://github.com/craftcms/cms/pull/12614))\n- Fixed field status badge styling in some contexts. ([#12403](https://github.com/craftcms/cms/issues/12403))\n- Fixed a bug where exporting elements with multiple field layouts as a CSV file using the \u201cExpanded\u201d export type would result in mismatched column values.\n- Fixed a bug where cancelling a conflicting volume folder move would result in the moved folder getting deleted.\n- Fixed a bug where `craft\\elements\\Category::canDuplicate()` wasn\u2019t factoring in save permissions.\n- Fixed a bug where the horizontal scroll position wasn\u2019t being retained when refreshing Live Preview. ([#12504](https://github.com/craftcms/cms/issues/12504))\n- Fixed a bug where user group condition rules for the default user group weren\u2019t getting matched properly during public registration. ([#12283](https://github.com/craftcms/cms/issues/12283))\n- Fixed a bug where HTML tags within field labels, instructions, tips, and warnings weren\u2019t always getting escaped.\n- Fixed a bug where the sidebar scroll position wasn\u2019t retained when selecting a new source on element index pages. ([#12523](https://github.com/craftcms/cms/issues/12523))\n- Fixed a bug where `resave/*` commands\u2019 output didn\u2019t take the offset into account. ([#12526](https://github.com/craftcms/cms/issues/12526))\n- Fixed a bug where warnings were getting logged for video assets that were \u201cmissing\u201d their dimensions.\n- Fixed a bug where `craft\\services\\Assets::getAllDescendantFolders()` could return unexpected results for folders that contained an underscore.\n- Fixed a bug where accessing a custom field\u2019s magic property on an element would return the field\u2019s raw database value rather than `null`, if it didn\u2019t belong to the element\u2019s field layout anymore. ([#12539](https://github.com/craftcms/cms/issues/12539), [#12578](https://github.com/craftcms/cms/pull/12578))\n- Fixed a bug where previewing an asset could wipe out all `h1` tags within Redactor fields. ([#12545](https://github.com/craftcms/cms/issues/12545))\n- Fixed a bug where `craft\\image\\Raster::getIsTransparent()` wasn\u2019t working. ([#12565](https://github.com/craftcms/cms/issues/12565))\n- Fixed a bug where textual condition rules were still showing a text input when the \u201cis empty\u201d or \u201chas a value\u201d operators were selected. ([#12587](https://github.com/craftcms/cms/pull/12587))\n- Fixed a bug where the component name comments in project config YAML files would always lag behind the current project config a little. ([#12576](https://github.com/craftcms/cms/issues/12576), [#12581](https://github.com/craftcms/cms/pull/12581))\n- Fixed a SQL error that occurred when creating a database backup using the default backup command, when running MySQL 5.7.41+ or 8.0.32+. ([#12557](https://github.com/craftcms/cms/issues/12557), [#12560](https://github.com/craftcms/cms/pull/12560))\n- Fixed a bug where database backups weren\u2019t respecting SSL database connection settings if they were specified when using MySQL. ([#10351](https://github.com/craftcms/cms/issues/10351), [#11753](https://github.com/craftcms/cms/issues/11753), [#12596](https://github.com/craftcms/cms/pull/12596))\n- Fixed a bug where element indexes could stop showing their loading spinner prematurely if the element listing needed to be reloaded multiple times in rapid succession. ([#12595](https://github.com/craftcms/cms/issues/12595))\n- Fixed a bug where element editors wouldn\u2019t show tabs that didn\u2019t contain any characters that could be converted to ASCII. ([#12602](https://github.com/craftcms/cms/issues/12602))\n- Fixed a bug where asset thumbnails weren\u2019t getting versioned in the control panel, unless the `revAssetUrls` config setting was enabled. ([#12603](https://github.com/craftcms/cms/issues/12603))\n- Fixed a bug where entry relations could be lost when switching entry types, for relational fields that didn\u2019t exist on the prior entry type. ([#12592](https://github.com/craftcms/cms/issues/12592))\n- Fixed a bug where Matrix blocks weren\u2019t getting duplicated to other sites when first editing an unpublished draft. ([#11366](https://github.com/craftcms/cms/issues/11366))\n- Fixed a bug where element indexes would show show an expand/collapse toggle for structured elements that only had unsaved draft children, which aren\u2019t actually shown. ([#11253](https://github.com/craftcms/cms/issues/11253))\n- Fixed a SQL error that occurred when running the `index-assets` command on PostgreSQL. ([#12617](https://github.com/craftcms/cms/issues/12617))\n- Added `craft\\helpers\\Assets::revUrl()`.\n- Added `craft\\helpers\\Db::escapeForLike()`.\n- Added `craft\\web\\twig\\variables\\Paginate::$pageTrigger`. ([#12614](https://github.com/craftcms/cms/pull/12614))\n- `craft\\helpers\\Assets::revParams()` no longer takes the `revAssetUrls` config setting into account. That should be factored in by whatever is calling it.\n- `craft\\services\\Assets::getAllDescendantFolders()` now has a `$withParent` argument, which can be passed `false` to omit the parent folder from the results. ([#12536](https://github.com/craftcms/cms/issues/12536))\n- `craft\\services\\Matrix::duplicateBlocks()` now has a `$force` argument.\n- Deprecated `craft\\helpers\\DateTimeHelper::timeZoneAbbreviation()`.\n- Deprecated `craft\\helpers\\DateTimeHelper::timeZoneOffset()`.\n\n## 4.3.6.1 - 2023-01-09\n\n- Element edit pages now retain their previous scroll position when they\u2019re automatically refreshed to keep up with changes from another browser tab.\n- Fixed a bug where editing certain Matrix/Neo/Super Table fields could result in content loss. ([#12445](https://github.com/craftcms/cms/issues/12445))\n\n## 4.3.6 - 2023-01-04\n\n- Template caching is no longer enabled for tokenized requests. ([#12458](https://github.com/craftcms/cms/issues/12458))\n- Elisions are now stripped from search keywords. ([#12467](https://github.com/craftcms/cms/issues/12467), [#12474](https://github.com/craftcms/cms/pull/12474))\n- Added support for HEIC/HEIF images. ([#9115](https://github.com/craftcms/cms/discussions/9115))\n- The `allowedFileExtensions` config setting now includes `heic`, `heif`, and `hevc` by default. ([#12490](https://github.com/craftcms/cms/discussions/12490))\n- It\u2019s now possible to assign aliases `children` fields queried via GraphQL. ([#12494](https://github.com/craftcms/cms/pull/12494))\n- Added `craft\\helpers\\Image::isWebSafe()`.\n- Added `craft\\services\\Images::getSupportsHeic()`.\n- `Craft.MatrixInput` now fires `blockSortDragStop`, `beforeMoveBlockUp`, `moveBlockUp`, `beforeMoveBlockDown`, and `moveBlockDown` events. ([#12498](https://github.com/craftcms/cms/pull/12498))\n- Fixed a bug where deleting a field layout tab could result in duplicated tabs. ([#12459](https://github.com/craftcms/cms/issues/12459))\n- Fixed a bug where Feed widgets weren\u2019t showing feed items when they were first loaded. ([#12460](https://github.com/craftcms/cms/issues/12460))\n- Fixed an error that occurred when a Date field\u2019s condition rule was set to a relative range, \u201chas a value\u201d, or \u201cis empty\u201d. ([#12457](https://github.com/craftcms/cms/issues/12457))\n- Fixed an error that could occur when processing template caches in a console request, if a globally-scoped template cache was processed before it.\n- Fixed styling issues with large element thumbnail views. ([#12455](https://github.com/craftcms/cms/issues/12455))\n- Fixed a bug where it wasn\u2019t possible to retry all failed jobs when using a proxy queue. ([#12471](https://github.com/craftcms/cms/issues/12471))\n- Fixed a bug where the selected table columns would be forgotten if modified from a nested source. ([#12477](https://github.com/craftcms/cms/issues/12477))\n- Fixed a bug where some custom field property types in `craft\\behaviors\\CustomFieldBehavior` were incorrect.\n- Fixed an error that could occur if a Matrix sub-field\u2019s handle was too long. ([#12422](https://github.com/craftcms/cms/issues/12422))\n- Fixed a bug where element editor slideouts\u2019 submit buttons weren\u2019t always consistent with the full-page edit form. ([#12487](https://github.com/craftcms/cms/issues/12487))\n- Fixed an XSS vulnerability.\n\n## 4.3.5 - 2022-12-13\n\n- Fixed a bug where entry tab contents could remain visible when switching to other tabs, after changing the entry type.\n- Fixed a bug where it wasn\u2019t possible to enter `0` in Number fields, Money fields, and numeric column cells within editable tables, using certain keyboard layouts. ([#12412](https://github.com/craftcms/cms/issues/12412))\n- Fixed a bug where the default MySQL restore command would attempt to use credentials from `~/.my.cnf` if it existed, instead of Craft\u2019s configured database connection settings. ([#12349](https://github.com/craftcms/cms/issues/12349), [#12430](https://github.com/craftcms/cms/pull/12430))\n- Fixed a JavaScript error that could occur when autosaving an entry draft. ([#12445](https://github.com/craftcms/cms/issues/12445))\n- Added `craft\\base\\ApplicationTrait::onInit()`. ([#12439](https://github.com/craftcms/cms/pull/12439))\n- Added `craft\\console\\Controller::createDirectory()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::do()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::failure()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::note()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::success()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::tip()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::warning()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::writeJson()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::writeToFile()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\helpers\\FileHelper::absolutePath()`.\n- Added `craft\\helpers\\FileHelper::findClosestFile()`.\n- Added `craft\\helpers\\FileHelper::isWithin()`.\n- Added `craft\\helpers\\FileHelper::relativePath()`.\n- Added `craft\\helpers\\Json::decodeFromFile()`.\n- Added `Craft.filterInputVal()`.\n- Added `Craft.filterNumberInputVal()`.\n\n## 4.3.4 - 2022-11-29\n\n- The `serve` command now routes requests for nonexistent files to Craft. ([#12310](https://github.com/craftcms/cms/pull/12310))\n- `craft\\base\\Element::includeSetStatusAction()` now returns `false` by default regardless of what `hasStatuses()` returns, fixing a bug where some element indexes were unexpectedly getting \u201cSet Status\u201d actions.\n- Query conditions generated by `craft\\helpers\\Db::parseParam()` no longer account for `null` values, due to a heavy performance impact. ([#11931](https://github.com/craftcms/cms/issues/11931))\n- Fixed a bug where the default MySQL backup command would attempt to use credentials from `~/.my.cnf` if it existed, instead of Craft\u2019s configured database connection settings. ([#12349](https://github.com/craftcms/cms/issues/12349))\n- Fixed a bug where it wasn\u2019t possible to access the Customize Sources modal if all sources were disabled. ([#12369](https://github.com/craftcms/cms/issues/12369))\n- Fixed a bug where Assets fields weren\u2019t taking their \u201cShow unpermitted volumes\u201d setting into account when defining the available input sources. ([#12364](https://github.com/craftcms/cms/issues/12364))\n- Fixed a bug where user slideouts included status toggles.\n- Updated Yii to 2.0.47.\n\n## 4.3.3 - 2022-11-17\n\n- Fixed an error that occurred if an arrow function was passed to the `|sort` Twig filter. ([#12334](https://github.com/craftcms/cms/issues/12334))\n- Fixed a bug where nested fields set to numbers could be inadvertently changed when an entry draft was created.\n- `craft\\services\\Fields::getFieldsWithContent()` and `getFieldsWithoutContent()` now have `$context` arguments.\n\n## 4.3.2.1 - 2022-11-16\n\n- Fixed a PHP error that could occur when generating an image transform. ([#12333](https://github.com/craftcms/cms/issues/12333))\n\n## 4.3.2 - 2022-11-16\n\n- `firstName` and `lastName` are now reserved field handles for the user field layout. ([#12241](https://github.com/craftcms/cms/issues/12241), [#12316](https://github.com/craftcms/cms/pull/12316))\n- Asset filenames are truncated in large thumbnail views, as they were before 4.3.0. ([#12236](https://github.com/craftcms/cms/discussions/12236))\n- Fixed an information disclosure vulnerability.\n- Fixed an XSS vulnerability.\n- Fixed asset indexing for Local filesystems that were configured to use a symlinked server path.\n- Fixed an error that could occur when calling `craft\\base\\Element::getCanonicalUid()` on a draft loaded for a site that the canonical element didn\u2019t exist on yet. ([#12228](https://github.com/craftcms/cms/issues/12228))\n- Fixed a bug where long words in asset titles weren\u2019t wrapping in the large thumbnail view. ([#12237](https://github.com/craftcms/cms/issues/12237))\n- Fixed a bug where the Users index page was showing a \u201cSet Status\u201d bulk action, making it possible to disable users.\n- Disabled users now identify themselves as disabled, and Edit User pages now provide a way for them to be re-enabled.\n- Fixed a layout issue that could occur on Assets fields using the \u201cLarge Thumbnails\u201d view mode. ([#12230](https://github.com/craftcms/cms/issues/12230))\n- Fixed a bug where elements that weren\u2019t viewable by the current user could still be hyperlinked in element indexes.\n- Fixed a bug where `craft\\helpers\\DateTimeHelper::toDateInterval()` could return a `DateInterval` that was off by an hour around daylight savings time changes.\n- Fixed a bug where sticky element index footers were obstructed when the Debug Toolbar was enabled. ([#12242](https://github.com/craftcms/cms/issues/12242))\n- Fixed a bug where it wasn\u2019t possible to change the sort attribute on element indexes while searching. ([#12256](https://github.com/craftcms/cms/issues/12256))\n- Fixed a bug where `resave/*` commands weren\u2019t catching exceptions thrown when applying the `--set` and `--to` options. ([#12262](https://github.com/craftcms/cms/issues/12262))\n- Fixed the position of field status indicators within Matrix fields in Live Preview. ([#12287](https://github.com/craftcms/cms/issues/12287))\n- Fixed PHP errors that could occur when executing GraphQL queries. ([#12271](https://github.com/craftcms/cms/pull/12271), [#12275](https://github.com/craftcms/cms/pull/12275))\n- Fixed a bug where it was possible to add a \u201cStatus\u201d condition rule to relational fields\u2019 selectable element conditions. ([#12289](https://github.com/craftcms/cms/issues/12289))\n- Fixed a PHP error that occurred if a field type stored enum values. ([#12297](https://github.com/craftcms/cms/issues/12297))\n- Fixed a bug where PHP errors and exceptions thrown when formatting a control panel screen response weren\u2019t being handled properly. ([#12308](https://github.com/craftcms/cms/issues/12308))\n- Fixed a bug where element indexes were showing the labels of empty Dropdown options when selected. ([#12319](https://github.com/craftcms/cms/issues/12319))\n- Fixed condition builder styling issues that occurred if any rules had exceptionally long names. ([#12311](https://github.com/craftcms/cms/issues/12311))\n- Fixed an error that occurred when saving an entry via GraphQL, if a parent entry was assigned that didn\u2019t exist on the requested site. ([#12291](https://github.com/craftcms/cms/issues/12291))\n- Fixed a bug where conditional fields weren\u2019t always saving for elements that didn\u2019t support autosaved drafts. ([#12166](https://github.com/craftcms/cms/issues/12166))\n- Fixed a bug where fields set to numbers could be inadvertently changed when an entry draft was created.\n- Added `craft\\base\\Element::includeSetStatusAction()`.\n- Added `craft\\services\\Fields::getFieldsWithoutContent()`.\n\n## 4.3.1 - 2022-10-27\n\n- Numeric values are no longer automatically formatted within element indexes. ([#12205](https://github.com/craftcms/cms/issues/12205))\n- When `craft\\base\\Element::EVENT_DEFINE_URL` event handlers set `craft\\events\\DefineUrlEvent::$url` to `null`, that will no longer be respected unless `$handled` was also set to `true`. ([#12210](https://github.com/craftcms/cms/issues/12210), [nystudio107/craft-imageoptimize#359](https://github.com/nystudio107/craft-imageoptimize/issues/359))\n- Asset folder and file names are now converted to ASCII using the primary site\u2019s language for character mappings, regardless of the current user\u2019s preferred language, when the `convertFilenamesToAscii` config setting is enabled. ([#12207](https://github.com/craftcms/cms/discussions/12207))\n- Fixed a bug where locked users\u2019 remaining cooldown times could be calculated incorrectly on PHP 8.0.\n- Fixed an infinite recursion bug that occurred when editing a Matrix field with a custom propagation method. ([#12176](https://github.com/craftcms/cms/issues/12176))\n- Fixed a bug where element index source lists were showing headings that didn\u2019t have any visible nested sources. ([#12193](https://github.com/craftcms/cms/issues/12193))\n- Fixed a JavaScript 404 error that occurred when users\u2019 Language was set to Chinese. ([#12194](https://github.com/craftcms/cms/issues/12194))\n- Fixed a bug where users couldn\u2019t delete their own addresses. ([craftcms/commerce#3011](https://github.com/craftcms/commerce/issues/3011))\n- Fixed a bug where the `users/save-address` action wasn\u2019t validating addresses properly.\n- Fixed an error that could occur during garbage collection, if any nested volume folders were missing their path. ([#12195](https://github.com/craftcms/cms/issues/12195))\n\n## 4.3.0 - 2022-10-25\n\n### Content Management\n- Added a \u201cView\u201d menu to element indexes, which enable users to customize the visible table columns for themselves, without affecting other users. ([#11915](https://github.com/craftcms/cms/pull/11915))\n- Added source setting menus to element index pages, which now contain the \u201cCustomize sources\u201d option when allowed, and \u201cNew subfolder\u201d, \u201cRename folder\u201d, and \u201cDelete folder\u201d actions on the Assets index page. ([#11906](https://github.com/craftcms/cms/pull/11906))\n- Added the \u201cEditable\u201d rule to asset and entry conditions. ([#11995](https://github.com/craftcms/cms/discussions/11995))\n- Improved control panel mobile support. ([#11963](https://github.com/craftcms/cms/pull/11963), [#12005](https://github.com/craftcms/cms/pull/12005))\n- Element indexes now respect field layouts\u2019 user conditions when determining which custom field columns to show. ([#11913](https://github.com/craftcms/cms/pull/11913))\n- Element index URLs now include the selected source key in a `source` query param, so all sources are now deep-linkable, including custom sources. ([#11996](https://github.com/craftcms/cms/discussions/11996))\n- Notifications are now shown after executing folder actions on the Assets index page. ([#11906](https://github.com/craftcms/cms/pull/11906))\n- Date range condition rules now support \u201cToday\u201d, \u201cThis week\u201d, \u201cThis month\u201d, \u201cThis year\u201d, \u201cPast 7 days\u201d, \u201cPast 30 days\u201d, \u201cPast 30 days\u201d, \u201cPast year\u201d, \u201cBefore\u2026\u201d, and \u201cAfter\u2026\u201d relative range types, in addition to specifying a custom date range. ([#10749](https://github.com/craftcms/cms/discussions/10749), [#11888](https://github.com/craftcms/cms/pull/11888))\n- Number condition rules now support an \u201cis between\u2026\u201d operator. ([#11950](https://github.com/craftcms/cms/pull/11950))\n- All text, number, and date range condition rules now support \u201chas a value\u201d and \u201cis empty\u201d operators. ([#11070](https://github.com/craftcms/cms/discussions/11070))\n- \u201cSave as a new [element type]\u201d actions will now discard any unsaved changes on the original element after the new element is created. ([#10204](https://github.com/craftcms/cms/issues/10204), [#11959](https://github.com/craftcms/cms/issues/11959), [#12102](https://github.com/craftcms/cms/issues/12102), [#12165](https://github.com/craftcms/cms/issues/12165))\n- If Live Preview is triggered while a draft is saving, it will now wait until the save completes before opening. ([#11858](https://github.com/craftcms/cms/issues/11858), [#11895](https://github.com/craftcms/cms/pull/11895))\n- Addresses now support change tracking.\n- It\u2019s now possible to restore assets that were deleted programmatically with `craft\\elements\\Asset::$keepFile` set to `true`. ([#11761](https://github.com/craftcms/cms/issues/11761))\n\n### Accessibility\n- Improved the styling of selected sidebar navigation items to meet contrast requirements. ([#11589](https://github.com/craftcms/cms/pull/11589))\n- Improved the styling of slideouts for screens under 600 pixels wide. ([#11636](https://github.com/craftcms/cms/pull/11636))\n- Improved the styling of the primary button on element index pages for small screens. ([#11963](https://github.com/craftcms/cms/pull/11963))\n- Improved the contrast of modal resize handles. ([#11727](https://github.com/craftcms/cms/pull/11727))\n- Improved the contrast of fields\u2019 searchable and translatable indicator icons on the Fields index page. ([#12169](https://github.com/craftcms/cms/pull/12169))\n- Improed the contrast of the \u201cSame as language\u201d text within the \u201cFormatting Locale\u201d user preference. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Improved the contrast of the selected options within combo boxes. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved the readability of the global navigation and date pickers when text is resized to 200%. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Improved focus management for HUD components. ([#11985](https://github.com/craftcms/cms/pull/11985))\n- Improved focus management for element index pagination links.  ([#11565](https://github.com/craftcms/cms/pull/11565)).\n- Improved focus management for editable tables. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Custom slider components now support <kbd>Home</kbd> and <kbd>End</kbd> key presses. ([#11578](https://github.com/craftcms/cms/pull/11578))\n- Improved the markup and keyboard control for exclusive button groups. ([#11942](https://github.com/craftcms/cms/pull/11942))\n- Improved keyboard control for the widget manager HUD on the Dashboard. ([#11578](https://github.com/craftcms/cms/pull/11578))\n- Improved New Widget and Quick Post action menus for screen readers. ([#11611](https://github.com/craftcms/cms/pull/11611))\n- Improved the widget manager HUD for screen readers. ([#11945](https://github.com/craftcms/cms/pull/11945))\n- Improved the Craft Support widget for screen readers. ([#11703](https://github.com/craftcms/cms/pull/11703))\n- Improved element index view mode buttons for screen readers. ([#11613](https://github.com/craftcms/cms/pull/11613))\n- Improved element type selects within \u201cRelated To\u201d condition rules for screen readers. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved element action modals for screen readers. ([#11905](https://github.com/craftcms/cms/issues/7377))\n- Improved field instructions, errors, and other visually-related text for screen readers. ([#11763](https://github.com/craftcms/cms/issues/7377))\n- Improved field translation indicators for screen readers. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved the parent selection button on structured entries\u2019 and categories\u2019 edit pages for screen readers. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved the Rotate button within Live Preview for screen readers. ([#11953](https://github.com/craftcms/cms/pull/11953))\n- Improved Date fields for screen readers. ([#10546](https://github.com/craftcms/cms/pull/10546))\n- Fixed a mismatch between the visible and accessibile text on the site name in the global sidebar. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Added alternative text to element status indicators. ([#11604](https://github.com/craftcms/cms/pull/11604))\n- Feed, Recent Entries, and Drafts widgets now use use semantic lists instead of tables. ([#11952](https://github.com/craftcms/cms/pull/11952))\n- Added autocomplete attributes to several address fields. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Implemented fieldsets and descriptive headings on user accounts\u2019 \u201cPreferences\u201d tab. ([#11534](https://github.com/craftcms/cms/pull/11534))\n- The \u201cAll\u201d status option within element index toolbars now uses a differentiated gradient icon. ([#11911](https://github.com/craftcms/cms/pull/11911))\n- Improved status indicator shapes, when the \u201cUse shapes to represent statuses\u201d user preference is enabled. ([#11911](https://github.com/craftcms/cms/pull/11911))\n- Boolean table columns within element indexes now use check icons to indicate `true` values. ([#11911](https://github.com/craftcms/cms/pull/11911))\n- Element titles are no longer truncated on edit pages. ([#11768](https://github.com/craftcms/cms/pull/11768))\n- Asset titles are no longer truncated in asset indexes. ([#11775](https://github.com/craftcms/cms/pull/11775))\n- Element source navigation now programmatically conveys structure imparted by headings. ([#11777](https://github.com/craftcms/cms/pull/11777))\n- Added a warning icon to related elements that contain validation errors. ([#11610](https://github.com/craftcms/cms/pull/11610))\n- Element index footers now stick to the bottom of the window, and element action triggers are now inserted into the footer rather than replacing the contents of the page\u2019s toolbar. ([#11844](https://github.com/craftcms/cms/pull/11844))\n\n### Administration\n- Added the `extraLastNamePrefixes` config setting. ([#11903](https://github.com/craftcms/cms/pull/11903))\n- Added the `extraNameSalutations` config setting. ([#11903](https://github.com/craftcms/cms/pull/11903))\n- Added the `extraNameSuffixes` config setting. ([#11903](https://github.com/craftcms/cms/pull/11903))\n- Element sources now have a \u201cDefault Sort\u201d setting in the Customize Sources modal. ([#12002](https://github.com/craftcms/cms/discussions/12002))\n- Control panel-defined image transforms can now have custom quality values. ([#9622](https://github.com/craftcms/cms/discussions/9622))\n- Added support for the `CRAFT_DOTENV_PATH` PHP constant. ([#11894](https://github.com/craftcms/cms/discussions/11894))\n- Added support for `CRAFT_WEB_URL` and `CRAFT_WEB_ROOT` environment variables/PHP constants, which can be used to set the default `@web` and `@webroot` alias values. ([#11912](https://github.com/craftcms/cms/pull/11912))\n\n### Development\n- Added the `canCreateDrafts()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canDelete()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canDeleteForSite()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canDuplicate()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canSave()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canView()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `|boolean` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Added the `|float` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Added the `|integer` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Added the `|string` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Twig templates now have `today`, `tomorrow`, and `yesterday` global variables available to them.\n- Element query date params now support passing `today`, `tomorrow`, and `yesterday`. ([#10485](https://github.com/craftcms/cms/issues/10485))\n- Element queries\u2019 `relatedTo` params now only check for relations in the same site as `siteId`, if set. ([#12000](https://github.com/craftcms/cms/issues/12000), [#12072](https://github.com/craftcms/cms/pull/12072))\n- Element queries now support passing ambiguous column names (e.g. `dateCreated`) and field handles into `select()`. ([#11790](https://github.com/craftcms/cms/pull/11790), [#11800](https://github.com/craftcms/cms/pull/11800))\n- Element queries\u2019 `collect()` methods eager-loaded elements now return `craft\\elements\\ElementCollection` objects, which extends `Illuminate\\Support\\Collection` with `ids()` and `with()` methods. ([#12113](https://github.com/craftcms/cms/discussions/12113))\n- `{% cache %}` tags now store any HTML registered with `{% html %}` tags. ([#11811](https://github.com/craftcms/cms/discussions/11811))\n- `{% cache %}` tags and GraphQL query caches now get a max cache duration based on the fetched/referenced entries\u2019 expiry dates. ([#8525](https://github.com/craftcms/cms/discussions/8525), [#11901](https://github.com/craftcms/cms/pull/11901))\n- Added the `siteHandle` field to elements queried via GraphQL. ([#10829](https://github.com/craftcms/cms/discussions/10829))\n- `users/session-info` responses now include a `csrfTokenName` key. ([#11706](https://github.com/craftcms/cms/pull/11706), [#11767](https://github.com/craftcms/cms/pull/11767))\n- The `elements/save-draft` action now supports being called from the front end. ([#12131](https://github.com/craftcms/cms/issues/12131))\n- The `users/upload-user-photo` action now includes a `photoId` key in the response data. ([#12175](https://github.com/craftcms/cms/pull/12175))\n\n### Extensibility\n- Added `craft\\base\\conditions\\BaseTextConditionRule::inputOptions()`.\n- Added `craft\\base\\Element::EVENT_DEFINE_URL`. ([#12168](https://github.com/craftcms/cms/pull/12168))\n- Added `craft\\base\\ExpirableElementInterface`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\controllers\\ElementsController::$element`.\n- Added `craft\\db\\ActiveQuery::collect()`. ([#11842](https://github.com/craftcms/cms/pull/11842))\n- Added `craft\\elements\\actions\\Restore::$restorableElementsOnly`.\n- Added `craft\\elements\\conditions\\assets\\EditableConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\EditableConditionRule`.\n- Added `craft\\elements\\ElementCollection`. ([#12113](https://github.com/craftcms/cms/discussions/12113))\n- Added `craft\\events\\AuthorizationCheckEvent::$element`.\n- Added `craft\\events\\CreateTwigEvent`.\n- Added `craft\\events\\DefineAddressFieldLabelEvent`.\n- Added `craft\\events\\DefineAddressFieldsEvent`.\n- Added `craft\\events\\DefineUrlEvent`. ([#12168](https://github.com/craftcms/cms/pull/12168))\n- Added `craft\\events\\ImageTransformerOperationEvent::$tempPath`.\n- Added `craft\\events\\SearchEvent::$scores`. ([#11882](https://github.com/craftcms/cms/discussions/11882))\n- Added `craft\\events\\UserGroupPermissionsEvent`.\n- Added `craft\\events\\UserPermissionsEvent`.\n- Added `craft\\helpers\\DateRange`.\n- Added `craft\\helpers\\DateTimeHelper::firstWeekDay()`.\n- Added `craft\\helpers\\DateTimeHelper::lastMonth()`.\n- Added `craft\\helpers\\DateTimeHelper::lastWeek()`.\n- Added `craft\\helpers\\DateTimeHelper::lastWeekDay()`.\n- Added `craft\\helpers\\DateTimeHelper::lastYear()`.\n- Added `craft\\helpers\\DateTimeHelper::nextMonth()`.\n- Added `craft\\helpers\\DateTimeHelper::nextWeek()`.\n- Added `craft\\helpers\\DateTimeHelper::nextYear()`.\n- Added `craft\\helpers\\DateTimeHelper::thisMonth()`.\n- Added `craft\\helpers\\DateTimeHelper::thisWeek()`.\n- Added `craft\\helpers\\DateTimeHelper::thisYear()`.\n- Added `craft\\helpers\\DateTimeHelper::today()`.\n- Added `craft\\helpers\\DateTimeHelper::tomorrow()`.\n- Added `craft\\helpers\\DateTimeHelper::yesterday()`.\n- Added `craft\\helpers\\ElementHelper::attributeHtml()`.\n- Added `craft\\helpers\\Html::svg()`. ([#11932](https://github.com/craftcms/cms/pull/11932))\n- Added `craft\\i18n\\FormatConverter::convertDatePhpToHuman()`. ([#10546](https://github.com/craftcms/cms/pull/10546))\n- Added `craft\\i18n\\Locale::FORMAT_HUMAN`.\n- Added `craft\\nameparsing\\CustomLanguage`.\n- Added `craft\\services\\Addresses::EVENT_DEFINE_FIELD_LABEL`. ([#11788](https://github.com/craftcms/cms/discussions/11788))\n- Added `craft\\services\\Addresses::EVENT_DEFINE_USED_FIELDS`. ([#11788](https://github.com/craftcms/cms/discussions/11788))\n- Added `craft\\services\\Addresses::EVENT_DEFINE_USED_SUBDIVISION_FIELDS`. ([#11788](https://github.com/craftcms/cms/discussions/11788))\n- Added `craft\\services\\Addresses::getFieldLabel()`.\n- Added `craft\\services\\Addresses::getUsedFields()`.\n- Added `craft\\services\\Addresses::getUsedSubdivisionFields()`.\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_CREATE_DRAFTS`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE_FOR_SITE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_DUPLICATE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_SAVE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_VIEW`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::canCreateDrafts()`.\n- Added `craft\\services\\Elements::canDelete()`.\n- Added `craft\\services\\Elements::canDeleteForSite()`.\n- Added `craft\\services\\Elements::canDuplicate()`.\n- Added `craft\\services\\Elements::canSave()`.\n- Added `craft\\services\\Elements::canView()`.\n- Added `craft\\services\\Elements::getIsCollectingCacheInfo()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Elements::setCacheExpiryDate()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Elements::startCollectingCacheInfo()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Elements::stopCollectingCacheInfo()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Search::EVENT_BEFORE_SCORE_RESULTS`. ([#11882](https://github.com/craftcms/cms/discussions/11882))\n- Added `craft\\services\\UserPermissions::EVENT_AFTER_SAVE_GROUP_PERMISSIONS`. ([#12130](https://github.com/craftcms/cms/discussions/12130), [#12146](https://github.com/craftcms/cms/pull/12146))\n- Added `craft\\services\\UserPermissions::EVENT_AFTER_SAVE_USER_PERMISSIONS`. ([#12130](https://github.com/craftcms/cms/discussions/12130), [#12146](https://github.com/craftcms/cms/pull/12146))\n- Added `craft\\web\\Controller::currentUser()`. ([#11754](https://github.com/craftcms/cms/pull/11754), [#11916](https://github.com/craftcms/cms/pull/11916))\n- Added `craft\\web\\View::EVENT_AFTER_CREATE_TWIG`. ([#11774](https://github.com/craftcms/cms/pull/11774))\n- `craft\\elements\\Asset::EVENT_DEFINE_URL` now gets triggered after the default URL has been generated, and the URL will be passed to `craft\\events\\DefineAssetUrlEvent::$url`.\n- `craft\\elements\\db\\ElementQuery::collect()` and `craft\\base\\Element::getEagerLoadedElements()` now return `craft\\elements\\ElementCollection` instances. ([#12113](https://github.com/craftcms/cms/discussions/12113))\n- `craft\\events\\DraftEvent::$creatorId` is now nullable. ([#11904](https://github.com/craftcms/cms/issues/11904))\n- `craft\\fieldlayoutelements\\BaseField::statusClass()` and `statusLabel()` now return status info from the element for the attribute specified by `attribute()`.\n- `craft\\helpers\\Component::iconSvg()` now namespaces the SVG contents, and adds `aria-hidden=\"true\"`. ([#11703](https://github.com/craftcms/cms/pull/11703))\n- `craft\\services\\Drafts::createDraft()` now accepts `null` passed to its `$creatorId` argument. ([#11904](https://github.com/craftcms/cms/issues/11904))\n- `craft\\services\\Search::EVENT_AFTER_SEARCH` now includes the computed search result scores, set to `craft\\events\\SearchEvent::$scores`, and any changes made to it will be returned by `searchElements()`. ([#11882](https://github.com/craftcms/cms/discussions/11882))\n- `craft\\services\\Search::EVENT_BEFORE_INDEX_KEYWORDS` is now cancellable by setting `$event->isValid` to `false`. ([#11705](https://github.com/craftcms/cms/discussions/11705))\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_CREATE_DRAFTS`. `craft\\services\\Elements::EVENT_AUTHORIZE_CREATE_DRAFTS` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_DELETE_FOR_SITE`. `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE_FOR_SITE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_DELETE`. `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_DUPLICATE`. `craft\\services\\Elements::EVENT_AUTHORIZE_DUPLICATE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_SAVE`. `craft\\services\\Elements::EVENT_AUTHORIZE_SAVE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_VIEW`. `craft\\services\\Elements::EVENT_AUTHORIZE_VIEW` should be used instead.\n- Deprecated `craft\\elements\\Address::addressAttributeLabel()`. `craft\\services\\Addresses::getFieldLabel()` should be used instead.\n- Deprecated `craft\\events\\DefineAssetUrlEvent::$asset`. `$sender` should be used instead.\n- Deprecated `craft\\services\\Elements::getIsCollectingCacheTags()`. `getIsCollectingCacheInfo()` should be used instead. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Deprecated `craft\\services\\Elements::startCollectingCacheTags()`. `startCollectingCacheInfo()` should be used instead. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Deprecated `craft\\services\\Elements::stopCollectingCacheTags()`. `stopCollectingCacheInfo()` should be used instead. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- `checkboxSelect` inputs without `showAllOption: true` now post an empty value if no options were selected. ([#11748](https://github.com/craftcms/cms/issues/11748))\n- Added the `Craft.useMobileStyles()` JavaScript method. ([#11636](https://github.com/craftcms/cms/pull/11636))\n- Added `Craft.BaseElementIndex::getParentSource()`.\n- Added `Craft.BaseElementIndex::getRootSource()`.\n- Added `Craft.BaseElementIndex::getSourceActions()`. ([#11906](https://github.com/craftcms/cms/pull/11906))\n- Added `Craft.BaseElementIndex::getSourceLevel()`.\n- `Craft.BaseElementSelectInput` now triggers a `change` event when elements are added programmatically or removed.\n\n### System\n- Name parsing now checks for common German salutations, suffixes, and last name prefixes.\n- \u201cGenerating pending image transforms\u201d jobs no longer attempt to process transforms that had previously failed. ([#11970](https://github.com/craftcms/cms/issues/11970))\n- The default system email template now sets the `lang` attribute on the `<html>` tag. ([#12156](https://github.com/craftcms/cms/pull/12156))\n- The default system email template now includes a `Content-Type` tag. ([#12156](https://github.com/craftcms/cms/pull/12156))\n- Improved GraphQL cache reliability. ([#11994](https://github.com/craftcms/cms/issues/11994), [#12086](https://github.com/craftcms/cms/pull/12086))\n- Control panel `.twig` templates are now prioritized over `.html`. ([#11809](https://github.com/craftcms/cms/discussions/11809), [#11840](https://github.com/craftcms/cms/pull/11840))\n- Updated Yii to 2.0.46.\n- Fixed a bug where addresses weren\u2019t validating their country codes. ([#12161](https://github.com/craftcms/cms/issues/12161))\n- Fixed a bug where Entry URI Format, Template, and Default Status switches were focusable within sections\u2019 Site Settings tables, for disabled sites.\n- Fixed a bug where `craft\\helpers\\Db::parseParam()` wasn\u2019t generating conditions that would include `null` values when it should have. ([#11931](https://github.com/craftcms/cms/issues/11931))\n\n## 4.2.8 - 2022-10-18\n\n### Changed\n- The `setup/keys` command will now set the application ID if `Craft::$app->id` is empty. ([#12103](https://github.com/craftcms/cms/pull/12103))\n\n### Fixed\n- Fixed an error that could occur when running tests. ([#12088](https://github.com/craftcms/cms/issues/12088), [#12089](https://github.com/craftcms/cms/issues/12089))\n- Fixed a bug where the `db/restore` command would output a warning about a missing `info` row, even if one existed in the imported database. ([#12101](https://github.com/craftcms/cms/issues/12101))\n- Fixed a bug where the \u201cYour session has ended\u201d modal could be shown on the control panel\u2019s login page. ([#12121](https://github.com/craftcms/cms/issues/12121))\n- Fixed a permission error that could occur when uploading a file to an Assets field.\n- Fixed a bug where custom log targets were getting removed when processing queue jobs. ([#12109](https://github.com/craftcms/cms/pull/12109))\n- Fixed a bug where Money fields weren\u2019t distinguishing between `0` and empty values. ([#12122](https://github.com/craftcms/cms/issues/12122), [#12132](https://github.com/craftcms/cms/pull/12132))\n- Fixed an error that could occur in the control panel. ([#12133](https://github.com/craftcms/cms/issues/12133))\n- Fixed a bug where assets uploaded from Assets fields weren\u2019t retaining their original filename for all but the initial site. ([#12142](https://github.com/craftcms/cms/pull/12142))\n- Fixed a bug where non-admin users couldn\u2019t always see the Temporary Uploads source when selecting assets from an Assets field. ([#12128](https://github.com/craftcms/cms/issues/12128))\n- Fixed a bug where image transforms that used the `fit` mode but didn\u2019t specify a width or height weren\u2019t getting their missing dimension set on the asset. ([#12137](https://github.com/craftcms/cms/issues/12137))\n\n## 4.2.7 - 2022-10-11\n\n### Added\n- Added the `setup/keys` command, which ensure Craft is configured with an application ID and security key.\n\n### Changed\n- The `install/craft` command now runs `setup/keys` before doing anything else.\n\n## 4.2.6 - 2022-10-11\n\n### Added\n- Added the `--as-json` option to the `help` command. ([#12017](https://github.com/craftcms/cms/pull/12017), [#12074](https://github.com/craftcms/cms/pull/12074))\n- Added `craft\\helpers\\ElementHelper::isAttributeEmpty()`.\n- Added `craft\\queue\\jobs\\ResaveElements::$ifEmpty`.\n- Added `craft\\queue\\jobs\\ResaveElements::$set`.\n- Added `craft\\queue\\jobs\\ResaveElements::$to`.\n- Added `craft\\queue\\jobs\\ResaveElements::$touch`.\n\n### Changed\n- When passing a PHP callback function to the `--to` option of a `resave/*` command, the `$element` argument is now optional.\n\n### Deprecated\n- Deprecated `craft\\web\\assets\\focusvisible\\FocusVisibleAsset`. ([#12037](https://github.com/craftcms/cms/pull/12037))\n\n### Fixed\n- Fixed an error that could occur when editing a draft of an element type that didn\u2019t have change tracking enabled.\n- Fixed an error that could occur when saving an entry with Matrix blocks, if the entry had been deleted for a site.\n- Fixed a bug where `resave/*` commands weren\u2019t respecting the `--set`, `--to`, or `--touch` options when `--queue` was passed. ([#11974](https://github.com/craftcms/cms/issues/11974))\n- Fixed a bug where `relatedTo` params didn\u2019t support collections.\n- Fixed an error that could occur when passing an element query to a `relatedTo` param, if the parent element query contained any closures. ([#11981](https://github.com/craftcms/cms/issues/11981))\n- Fixed a bug where `craft\\log\\MonologTarget::$allowLineBreaks` wasn\u2019t getting a default value. ([#12004](https://github.com/craftcms/cms/pull/12004))\n- Fixed a PHP error that occurred when attempting to edit an element by an invalid ID or UUID.\n- Fixed a bug where unsaved drafts could be unintentionally deleted when saved, if a plugin or module was blocking the save via `EVENT_BEFORE_SAVE`. ([#12015](https://github.com/craftcms/cms/issues/12015))\n- Fixed a bug where \u201cPropagating tags\u201d jobs would fail if two tags had similar titles.\n- Fixed a bug where pressing \u201cDisable focal point\u201d within asset preview modals would only reset the focal point position, but not delete it. ([#12030](https://github.com/craftcms/cms/issues/12030))\n- Fixed a bug where image transforms weren\u2019t getting sized correctly in some cases when `upscaleImages` was disabled. ([#12023](https://github.com/craftcms/cms/issues/12023))\n- Fixed a bug where table cells within Redactor fields could appear to be focused when they weren\u2019t. ([#12001](https://github.com/craftcms/cms/issues/12001), [#12037](https://github.com/craftcms/cms/pull/12037))\n- Fixed a bug where alerts saying a folder can\u2019t be renamed due to a naming conflict were showing the old folder name instead of the new one. ([#12049](https://github.com/craftcms/cms/pull/12049))\n- Fixed a bug where custom fields nested within Matrix fields weren\u2019t always updating properly within slideout editors. ([#11988](https://github.com/craftcms/cms/issues/11988), [#12058](https://github.com/craftcms/cms/issues/12058))\n- Fixed an error that could occur when adding new textual condition rules to a condition. ([#12077](https://github.com/craftcms/cms/pull/12077))\n- Fixed a bug where Table fields\u2019 Default Values settings were always showing at least one row, even if the setting had been saved without any rows. ([#12071](https://github.com/craftcms/cms/issues/12071))\n- Fixed a bug where existing rows in Table fields\u2019 Default Values settings were losing the ability to be reordered or deleted when the table columns were changed.\n- Fixed a bug where sending a password reset email for an inactive user would set them to a pending state. ([#12080](https://github.com/craftcms/cms/pull/12080))\n- Fixed a bug where some GraphQL results could be missing if multiple sets of nested elements were being queried using the same alias. ([#11982](https://github.com/craftcms/cms/issues/11982))\n\n### Security\n- Fixed information disclosure vulnerabilities.\n\n## 4.2.5.2 - 2022-10-03\n\n### Security\n- Updated Twig to 3.4. ([#12022](https://github.com/craftcms/cms/issues/12022))\n\n## 4.2.5.1 - 2022-09-21\n\n### Fixed\n- Fixed a bug where the \u201cNew category\u201d button could be missing from the Categories index page. ([#11977](https://github.com/craftcms/cms/issues/11977))\n- Fixed a bug where `Craft::t()` and the `|t` Twig filter were modifying digit-dash-digit sequences. ([#11980](https://github.com/craftcms/cms/issues/11980))\n- Fixed PHP errors that occurred if `webonyx/graphql-php` 14.11.17 was installed. ([#11979](https://github.com/craftcms/cms/issues/11979), [webonyx/graphql-php#1221](https://github.com/webonyx/graphql-php/issues/1221))\n- Fixed a PHP error that could occur when working with a draft. ([#11976](https://github.com/craftcms/cms/issues/11976))\n\n## 4.2.5 - 2022-09-20\n\n### Added\n- Added `craft\\helpers\\Image::targetDimensions()`.\n\n### Changed\n- Edit Asset pages now show the \u201cView\u201d button for all file types, not just images, PDFs, and text files. ([#11936](https://github.com/craftcms/cms/issues/11936))\n\n### Removed\n- Removed the Punycode PHP library. ([#11948](https://github.com/craftcms/cms/issues/11948))\n\n### Fixed\n- Fixed a bug where image transforms weren\u2019t always getting applied properly to all animation frames. ([#11937](https://github.com/craftcms/cms/pull/11937))\n- Fixed a bug where animated WebP images would lose their animation frames when transformed. ([#11937](https://github.com/craftcms/cms/pull/11937))\n- Fixed a bug where image transform dimensions could be calculated incorrectly when `upscaleImages` was `false`. ([#11837](https://github.com/craftcms/cms/issues/11837))\n- Fixed a bug where the `users/send-password-reset-email` action wasn\u2019t passing errors back to the template. ([#11933](https://github.com/craftcms/cms/issues/11933))\n- Fixed an error that occurred when setting a non-numeric `width` or `height` on an image transform. ([#11837](https://github.com/craftcms/cms/issues/11837))\n- Fixed a bug where the database connection wasn\u2019t being configured properly when fluent config methods and environment variable overrides were being used in combination. ([#11941](https://github.com/craftcms/cms/issues/11941))\n- Fixed a bug where slideouts lost their shadows when focused.\n- Fixed a bug where `relatedTo*` arguments weren\u2019t supported by `children` fields in GraphQL. ([#11918](https://github.com/craftcms/cms/issues/11918))\n- Fixed a bug where Image Editor and slideout action buttons were obstructed when the Debug Toolbar was enabled. ([#11965](https://github.com/craftcms/cms/issues/11965))\n- Fixed an error that occurred when installing Craft when MySQL\u2019s `sql_require_primary_key` setting was enabled. ([#11374](https://github.com/craftcms/cms/discussions/11374))\n- Fixed a bug subfolders created by Assets fields could be reported as missing when updating asset indexes, even if they contained assets. ([#11949](https://github.com/craftcms/cms/issues/11949))\n- Fixed a PHP error that could occur in a potential race condition when calling  `craft\\helpers\\FileHelper::clearDirectory()`.\n- Fixed a bug where Structure section entries that were duplicated via the \u201cSave as a new entry\u201d action on a provisional draft weren\u2019t being placed within the structure properly.\n- Fixed a bug where element\u2019s `searchScore` properties would be set to `null` when their original score was below 1, rather than rounding to 0 or 1. ([#11973](https://github.com/craftcms/cms/issues/11973))\n\n## 4.2.4 - 2022-09-13\n\n### Changed\n- The \u201cNew entry\u201d and \u201cNew category\u201d buttons on the Entries and Categories index pages now support <kbd>Ctrl</kbd>/<kbd>Command</kbd>/middle-clicking to open the edit page in a new window. ([#11870](https://github.com/craftcms/cms/issues/11870))\n- Control panel menus now automatically reposition themselves when the window is resized.\n- Improved the performance of some element queries on MySQL. ([#11825](https://github.com/craftcms/cms/pull/11825))\n- `resave/*` commands now have a `--touch` option. When passed, elements\u2019 `dateUpdated` timestamps will be updated as they\u2019re resaved. ([#11849](https://github.com/craftcms/cms/discussions/11849))\n- Underscores within query param values that begin/end with `*` are now escaped, so they aren\u2019t treated as wildcard characters by the `like` condition. ([#11898](https://github.com/craftcms/cms/issues/11898))\n- `craft\\services\\Elements::resaveElements()` now has a `$touch` argument.\n- Disable the preview button while drafts are saving ([#11858](https://github.com/craftcms/cms/issues/11858))\n\n### Fixed\n- Fixed an error that could occur when upgrading to Craft 4, if any Matrix blocks contained null `sortOrder` values. ([#11843](https://github.com/craftcms/cms/issues/11843))\n- Fixed a bug where image transform dimensions could be calculated incorrectly when `upscaleImages` was `false`. ([#11837](https://github.com/craftcms/cms/issues/11837))\n- Fixed an error that occurred when parsing an image transform string that was missing an interlace type. ([#11834](https://github.com/craftcms/cms/pull/11834))\n- Fixed a bug where element caches weren\u2019t being invalidated during garbage collection, so hard-deleted elements could appear to still exist.\n- Fixed a bug where image transforms were always getting saved with `dateIndexed` set to `null`. ([#11863](https://github.com/craftcms/cms/pull/11863))\n- Fixed an error that could occur when rendering front-end templates if there was a problem connecting to the database. ([#11855](https://github.com/craftcms/cms/issues/11855))\n- Fixed a bug where Edit Asset pages were showing the \u201cView\u201d button for assets in volumes without public URLs. ([#11860](https://github.com/craftcms/cms/issues/11860))\n- Fixed a bug where the Assets index page wasn\u2019t handling failed uploads properly. ([#11866](https://github.com/craftcms/cms/issues/11866))\n- Fixed a bug where it was possible to save an asset with a focal point outside its cropped area. ([#11875](https://github.com/craftcms/cms/issues/11875))\n- Fixed a bug where element index filter HUDs were unresponsive if another one was already active for a different site/source. ([#11880](https://github.com/craftcms/cms/issues/11880))\n- Fixed a bug where newly-created subfolders on the Assets index page could appear to have the wrong indentation.\n- Fixed a UI bug where renaming a newly-created volume subfolder didn\u2019t appear to have any effect.\n- Fixed a bug where empty URL fields would be marked as changed, even when no change was made to them. ([#11908](https://github.com/craftcms/cms/issues/11908))\n- Fixed a UI bug where autosuggest menus weren\u2019t getting filtered when first opened for inputs with existing values. ([#11896](https://github.com/craftcms/cms/issues/11896))\n- Fixed a bug where Entry Type condition rules weren\u2019t working for conditions that were applied to a single element. ([#11914](https://github.com/craftcms/cms/issues/11914))\n- Fixed a bug where Related To condition rules weren\u2019t working for conditions that were applied to a single element, for cross-site relations. ([#11892](https://github.com/craftcms/cms/issues/11892))\n- Fixed a bug where form action keyboard shortcuts weren\u2019t available when a custom select menu was focused. ([#11919](https://github.com/craftcms/cms/issues/11919))\n- Fixed a bug where transforming an animated GIF into a WebP file would only include the first frame. ([#11889](https://github.com/craftcms/cms/issues/11889))\n- Fixed a bug where `craft\\models\\FieldLayout::createFromConfig()` was ignoring `id`, `uid`, `type`, and `reservedFieldHandles` keys, if set. ([#11929](https://github.com/craftcms/cms/issues/11929))\n\n### Security\n- Fixed XSS vulnerabilities.\n- Password inputs no longer temporarily reveal the password when the <kbd>Alt</kbd> key is pressed. ([#11930](https://github.com/craftcms/cms/issues/11930))\n\n## 4.2.3 - 2022-08-26\n\n### Changed\n- If a plugin\u2019s license key is set to an empty environment variable, its trial license key will now be stored in `.env` rather than the project config. ([#11830](https://github.com/craftcms/cms/issues/11830))\n\n### Fixed\n- Fixed a PHP error that occurred when garbage collection was run on web requests. ([#11829](https://github.com/craftcms/cms/issues/11829))\n\n## 4.2.2 - 2022-08-23\n\n### Added\n- Added the `utils/fix-field-layout-uids` command. ([#11746](https://github.com/craftcms/cms/issues/11746))\n\n### Changed\n- Improved the styling of Categories fields.\n- The first field group is now automatically selected by default when creating a new custom field.\n- Improved console output for the `gc` command.\n- The `gc` command now runs garbage collection for data caches.\n- Exception JSON responses now include `name` and `code` keys. ([#11799](https://github.com/craftcms/cms/discussions/11799))\n- `elements/*` actions no longer include custom field values in the failure response data, improving performance. ([#11807](https://github.com/craftcms/cms/discussions/11807))\n\n### Fixed\n- Fixed a bug where keyboard focus wasn\u2019t being maintained when changing the element type within a \u201cRelated To\u201d condition rule.\n- Fixed a bug where keyboard focus wasn\u2019t being maintained when changing the country within an address\u2019s \u201cAdministrative Area\u201d condition rule.\n- Fixed a bug where Date fields\u2019 Timezone menus could be clipped. ([#11780](https://github.com/craftcms/cms/pull/11780))\n- Fixed an error that could occur when saving an unpublished draft, if any custom validation errors were added to it after its draft status had been removed. ([#11407](https://github.com/craftcms/cms/issues/11407))\n- Fixed a bug where custom validation errors would be shown twice for unpublished drafts, if they were added to it after its draft status had been removed. ([#11407](https://github.com/craftcms/cms/issues/11407))\n- Fixed PHP warnings that would occur when passing `0` into `craft\\helpers\\DateTimeHelper::humanDuration()`. ([#11787](https://github.com/craftcms/cms/issues/11787))\n- Fixed a bug where selected assets weren\u2019t getting automatically replaced when an image was edited and \u201cSave as a new asset\u201d was chosen. ([#11805](https://github.com/craftcms/cms/issues/11805))\n- Fixed a JavaScript error that occurred when editing a user via a slideout, if the user had any addresses. ([#11810](https://github.com/craftcms/cms/issues/11810))\n- Fixed a bug where some invalid slideout submissions weren\u2019t being handled properly. ([#11812](https://github.com/craftcms/cms/issues/11812))\n- Fixed a bug where `craft\\helpers\\DateTimeHelper::toDateInterval()` was returning negative interval durations when integers were passed in. ([#11814](https://github.com/craftcms/cms/pull/11814))\n- Fixed a bug where `iframeResizer.contentWindow.js` was getting loaded for all preview requests, not just Live Preview, and even when `useIframeResizer` was disabled. ([#11778](https://github.com/craftcms/cms/issues/11778))\n- Fixed a bug where deleted relations and Matrix blocks could persist if the edit form was submitted before they had been fully animated away. ([#11789](https://github.com/craftcms/cms/issues/11789))\n- Fixed a PHP error that could occur if `craft\\services\\Assets::getUserTemporaryUploadFolder()` was called when there was no logged-in user account. ([#11751](https://github.com/craftcms/cms/issues/11751))\n\n## 4.2.1.1 - 2022-08-10\n\n### Fixed\n- Fixed a bug where saving an element with invalid field values could result in some field values being forgotten. ([#11756](https://github.com/craftcms/cms/issues/11756))\n- Fixed a bug where it wasn\u2019t always possible to serve asset bundles via `webpack-dev-server` over SSL. ([#11758](https://github.com/craftcms/cms/pull/11758))\n\n## 4.2.1 - 2022-08-09\n\n### Added\n- Added the `project-config/export` command. ([#11733](https://github.com/craftcms/cms/pull/11733))\n- Added `craft\\config\\GeneralConfig::getRememberedUserSessionDuration()`.\n- Added `craft\\helpers\\DateTimeHelper::toDateInterval()`.\n\n### Changed\n- \u201cRelated To\u201d condition rules are now available for conditions that are stored in the project config. ([#11740](https://github.com/craftcms/cms/issues/11740))\n- Element index filters are now managed for each site and source, rather than just for each source. ([#11719](https://github.com/craftcms/cms/issues/11719))\n- `craft\\config\\DbConfig::dsn()` now parses the DSN string and populates the other DSN-settable config properties.\n- `craft\\helpers\\DateTimeHelper::humanDuration()` no longer returns the number of weeks, unless the number of days is divisible by 7. ([#11594](https://github.com/craftcms/cms/discussions/11594))\n- `craft\\helpers\\DateTimeHelper::humanDuration()` now accepts date interval strings to be passed in.\n- `craft\\helpers\\Db::url2config()` now returns `driver`, `server`, `port`, and `database` keys, when possible. ([#11735](https://github.com/craftcms/cms/issues/11735))\n- `craft\\services\\Assets::getImagePreviewUrl()` now throws a `yii\\base\\NotSupportedException` if a preview URL could not be generated for the asset, rather than causing a PHP error.\n\n### Deprecated\n- Deprecated `craft\\helpers\\DateTimeHelper::secondsToInterval()`. `toDateInterval()` should be used instead.\n\n### Fixed\n- Fixed a bug where database connections would always use port `3306` by default if `craft\\config\\DbConfig` had been configured via fluent methods, even for PostgreSQL.\n- Fixed a bug where system messages provided by Yii weren\u2019t getting translated in some cases. ([#11712](https://github.com/craftcms/cms/issues/11712))\n- Fixed a bug where the \u201cKeep me signed in\u201d checkbox label wasn\u2019t always accurately representing the `rememberedUserSessionDuration` config setting. ([#11594](https://github.com/craftcms/cms/discussions/11594))\n- Fixed a bug where the `Craft.cp.setSiteId()` JavaScript method wasn\u2019t updating `Craft.siteId`, or the base URLs used by `Craft.getActionUrl()`, `Craft.getCpUrl()`, and `Craft.getUrl()`.\n- Fixed an error that occurred when removing a Single section from the primary site, if it contained any Matrix blocks. ([#11669](https://github.com/craftcms/cms/issues/11669))\n- Fixed a bug where Matrix sub-fields weren\u2019t showing their validation errors when `autosaveDrafts` was `false`. ([#11731](https://github.com/craftcms/cms/issues/11731))\n- Fixed a bug where saving an element with invalid field values could result in the invalid values being forgotten, rather than re-validated. ([#11731](https://github.com/craftcms/cms/issues/11731))\n- Fixed a bug where the database connection would be misconfigured if the `url` connection setting was used. ([#11735](https://github.com/craftcms/cms/issues/11735))\n- Fixed a bug where the element index filter HUDs weren\u2019t always visually aligned with the search input. ([#11739](https://github.com/craftcms/cms/issues/11739))\n- Fixed a bug where it wasn\u2019t possible to preview or edit image assets if their filesystem and transform filesystem didn\u2019t have public URLs. ([#11686](https://github.com/craftcms/cms/issues/11686), [#11687](https://github.com/craftcms/cms/issues/11687))\n- Fixed a bug where not all project config changes would be applied if a site was deleted. ([#9567](https://github.com/craftcms/cms/issues/9567))\n- Fixed a bug where `$` characters in database connection passwords weren\u2019t being escaped property when backing up/restoring the database. ([#11750](https://github.com/craftcms/cms/issues/11750))\n\n### Security\n- Fixed XSS vulnerabilities.\n\n## 4.2.0.2 - 2022-07-27\n\n### Fixed\n- Fixed a bug where `Garnish.uiShortcutManager` was getting double-instantiated, causing some keyboard shortcuts to be triggered multiple times.\n- Fixed a JavaScript error that occurred when switching sites in the control panel. ([#11709](https://github.com/craftcms/cms/issues/11709))\n- Fixed a bug where some config settings set via fluent setters weren\u2019t getting normalized.\n- Fixed a bug where the database connection DSN string wasn\u2019t getting built properly when the connection settings were set via fluent setters.\n\n## 4.2.0.1 - 2022-07-26\n\n### Fixed\n- Fixed an error that could occur when passing an object into `craft\\helpers\\ArrayHelper::removeValue()` or the `|without` filter.\n\n## 4.2.0 - 2022-07-26\n\n### Added\n- The control panel is now translated into Ukrainian.\n- Element conditions can now include condition rules for Matrix fields. ([#11620](https://github.com/craftcms/cms/issues/11620))\n- Element conditions can now include condition rules for Money fields. ([#11560](https://github.com/craftcms/cms/issues/11560))\n- Added the \u201cNotification Duration\u201d user accessibility preference. ([#11612](https://github.com/craftcms/cms/pull/11612))\n- The `accessibilityDefaults` config setting now supports a `notificationDuration` key.\n- Added `craft\\behaviors\\SessionBehavior::getSuccess()`.\n- Added `craft\\behaviors\\SessionBehavior::setSuccess()`.\n- Added `craft\\config\\BaseConfig`. ([#11591](https://github.com/craftcms/cms/pull/11591), [#11656](https://github.com/craftcms/cms/pull/11656))\n- Added `craft\\controllers\\UsersController::EVENT_AFTER_FIND_LOGIN_USER`. ([#11645](https://github.com/craftcms/cms/pull/11645))\n- Added `craft\\controllers\\UsersController::EVENT_BEFORE_FIND_LOGIN_USER`. ([#11645](https://github.com/craftcms/cms/pull/11645))\n- Added `craft\\events\\DefineFieldLayoutCustomFieldsEvent`.\n- Added `craft\\events\\FindLoginUserEvent`.\n- Added `craft\\events\\IndexKeywordsEvent`.\n- Added `craft\\fields\\conditions\\EmptyFieldConditionRule`.\n- Added `craft\\helpers\\DateTimeHelper::humanDuration()`.\n- Added `craft\\helpers\\Template::resolveTemplatePathAndLine()`.\n- Added `craft\\models\\FieldLayout::EVENT_DEFINE_CUSTOM_FIELDS`. ([#11634](https://github.com/craftcms/cms/discussions/11634))\n- Added `craft\\services\\Config::getLoadingConfigFile()`.\n- Added `craft\\services\\Elements::EVENT_INVALIDATE_CACHES`. ([#11617](https://github.com/craftcms/cms/pull/11617))\n- Added `craft\\services\\Search::EVENT_BEFORE_INDEX_KEYWORDS`. ([#11575](https://github.com/craftcms/cms/discussions/11575))\n\n### Changed\n- Redesigned user notifications. ([#11612](https://github.com/craftcms/cms/pull/11612))\n- Most element notifications now include a link to the element. ([#11612](https://github.com/craftcms/cms/pull/11612))\n- Improved overall control panel accessibility. ([#11563](https://github.com/craftcms/cms/pull/11563), [#11543](https://github.com/craftcms/cms/pull/11543), [#11688](https://github.com/craftcms/cms/pull/11688), [#11699](https://github.com/craftcms/cms/pull/11699))\n- Improved condition builder accessibility. ([#11588](https://github.com/craftcms/cms/pull/11588), [#11643](https://github.com/craftcms/cms/pull/11643))\n- Improved Image Editor accessibility. ([#11496](https://github.com/craftcms/cms/pull/11496))\n- The \u201cKeep me signed in\u201d checkbox label on the control panel\u2019s login page now includes the remembered session duration, e.g. \u201cKeep me signed in for 2 weeks\u201d. ([#11594](https://github.com/craftcms/cms/discussions/11594))\n- Dashboard widgets no longer show a confirmation dialog when deleted. Their delete notifications include an \u201cUndo\u201d button instead. ([#11573](https://github.com/craftcms/cms/discussions/11573))\n- Element edit pages no longer jump down when the \u201cShowing your unsaved changes\u201d notice is added, unless there\u2019s not enough content to require a scroll bar. ([#11586](https://github.com/craftcms/cms/discussions/11586))\n- Matrix block previews now show selected option labels rather than their raw values. ([#11659](https://github.com/craftcms/cms/issues/11659))\n- Improved the behavior of some console commands for non-interactive shells. ([#11650](https://github.com/craftcms/cms/issues/11650))\n- The `utils/prune-revisions` console command now has a `--section` option. ([#8783](https://github.com/craftcms/cms/discussions/8783))\n- Deprecation warnings\u2019 stack traces now show source templates\u2019 paths and line numbers.\n- Exception JSON responses now include the previous exception details, recursively. ([#11694](https://github.com/craftcms/cms/discussions/11694))\n- `config/general.php` and `config/db.php` can now return `craft\\config\\GeneralConfig`/`DbConfig` objects, which can be defined using new fluent setter methods. ([#11591](https://github.com/craftcms/cms/pull/11591), [#11656](https://github.com/craftcms/cms/pull/11656))\n- The `|duration` Twig filter can now be used with an integer representing a number of seconds, and its `showSeconds` argument is no longer required. Seconds will be output if the duration is less than one minute by default.\n- The `|length` Twig filter now checks if the variable is a query, and if so, returns its count. ([#11625](https://github.com/craftcms/cms/discussions/11625))\n- The `|without` Twig filter no longer uses strict value comparisons by default. It has a new `$strict` argument that can be set to `true` to enforce strict comparisons if desired. ([#11695](https://github.com/craftcms/cms/issues/11695))\n- `craft\\base\\conditions\\BaseConditionRule::inputHtml()` is no longer abstract, and returns an empty string by default.\n- `craft\\behaviors\\SessionBehavior::setError()` now has a `$settings` argument.\n- `craft\\behaviors\\SessionBehavior::setNotice()` now has a `$settings` argument.\n- `craft\\db\\Query` now implements the `ArrayAccess` and `IteratorAggregate` interfaces, so queries (including element queries) can be treated as arrays.\n- `craft\\helpers\\ArrayHelper::removeValue()` no longer uses strict value comparisons by default. It has a new `$strict` argument that can be set to `true` to enforce strict comparisons if desired.\n- `craft\\web\\Controller::asSuccess()` now has a `$notificationSettings` argument.\n- `craft\\web\\Controller::setFailFlash()` now has a `$settings` argument.\n- `craft\\web\\Controller::setSuccessFlash()` now has a `$settings` argument.\n\n### Deprecated\n- Deprecated `craft\\helpers\\DateTimeHelper::humanDurationFromInterval()`. `humanDuration()` should be used instead.\n- Deprecated `craft\\helpers\\DateTimeHelper::secondsToHumanTimeDuration()`. `humanDuration()` should be used instead.\n\n### Fixed\n- Fixed a bug where new condition rules\u2019 type selectors weren\u2019t getting auto-focused.\n- Fixed a bug where Quick Post widgets weren\u2019t submitting custom field values.\n- Fixed a bug where assets\u2019 `getImg()` methods were returning `null` for assets in volumes without URLs, even if a transform was being used. ([#11614](https://github.com/craftcms/cms/issues/11614))\n- Fixed a bug where sensitive data wasn\u2019t getting redacted in the logs when Dev Mode was enabled. ([#11618](https://github.com/craftcms/cms/issues/11618))\n- Fixed a SQL error that could occur on MySQL 5. ([#11596](https://github.com/craftcms/cms/issues/11596))\n- Fixed an error that could occur when upgrading to Craft 4. ([#11644](https://github.com/craftcms/cms/issues/11644))\n- Fixed a bug where the green color used in lightswitches was too dark. ([#11653](https://github.com/craftcms/cms/issues/11653))\n- Fixed a bug where relational and Matrix fields were assuming their values hadn\u2019t been eager-loaded on element save. ([#11667](https://github.com/craftcms/cms/issues/11667), [#11670](https://github.com/craftcms/cms/issues/11670))\n- Fixed a bug where deprecation warnings for treating an element query as an array weren\u2019t getting logged with an origin, if they involved Twig\u2019s `|batch` filter. ([#11597](https://github.com/craftcms/cms/issues/11597))\n- Fixed a bug where `{% js %}`, `{% script %}`, and `{% css %}` tags weren\u2019t registering JavaScript and CSS code properly when used within a `{% cache %}` tag that contained an ungenerated image transform. ([#11602](https://github.com/craftcms/cms/issues/11602))\n- Fixed a bug where the \u201cUser saved\u201d notification was translated for the former language, when changing the current user\u2019s language preference.\n- Fixed a JavaScript error that occurred when removing a category from a Categories field, if any of its descendants were selected as well. ([#11641](https://github.com/craftcms/cms/issues/11641))\n- Fixed a bug where links to config settings from **Settings** \u2192 **General** didn\u2019t include the correct setting anchors. ([#11665](https://github.com/craftcms/cms/pull/11665))\n- Fixed styling issues with Live Preview in Firefox.\n\n### Security\n- Fixed an information disclosure vulnerability.\n\n## 4.1.4.1 - 2022-07-13\n\n### Fixed\n- Fixed a bug where `craft\\services\\Assets::getRootFolderByVolumeId()` wasn\u2019t returning the root folder. ([#11593](https://github.com/craftcms/cms/issues/11593))\n\n## 4.1.4 - 2022-07-12\n\n### Added\n- Added `craft\\models\\FieldLayout::getVisibleCustomFieldElements()`.\n\n### Changed\n- Relation fields now focus on the next related element\u2019s \u201cRemove\u201d button when an element is removed. ([#11577](https://github.com/craftcms/cms/issues/11577))\n\n### Deprecated\n- Deprecated `craft\\base\\FieldTrait::$required`. `craft\\fieldlayoutelements\\BaseField::$required` should be used instead.\n\n### Fixed\n- Fixed a bug where assets\u2019 native Alternative Text fields were getting mislabeled as translatable. ([#11576](https://github.com/craftcms/cms/issues/11576))\n- Fixed a bug where fields nested within Neo fields could be incorrectly validated as required. ([#11574](https://github.com/craftcms/cms/issues/11574))\n- Fixed a PHP error that occurred when editing a Date field with a Min Date setting set.\n- Fixed a bug where date range inputs weren\u2019t working on mobile. ([#11571](https://github.com/craftcms/cms/issues/11571))\n- Fixed a bug where the \u201cCraft Support\u201d Dashboard widget wasn\u2019t being labeled properly in the widget settings HUD and delete confirmation dialog. ([#11573](https://github.com/craftcms/cms/discussions/11573))\n- Fixed a bug where the project config cache was getting invalidated on each public GraphQL API request.\n\n## 4.1.3 - 2022-07-07\n\n### Changed\n- Address fields now show required indicators based on the configured validation rules. ([#11566](https://github.com/craftcms/cms/pull/11566))\n\n### Fixed\n- Fixed a JavaScript error that occurred on the Updates utility. ([#11567](https://github.com/craftcms/cms/issues/11567))\n- Fixed a bug where Craft\u2019s Composer commands could produce a malformed `composer.json` file. ([#11564](https://github.com/craftcms/cms/issues/11564))\n\n## 4.1.2 - 2022-07-06\n\n### Added\n- Added `craft\\helpers\\ProjectConfig::ensureAllFilesystemsProcessed()`.\n\n### Changed\n- Relational field condition rules now have the \u201cis related to\u201d operator selected by default. ([#11550](https://github.com/craftcms/cms/discussions/11550))\n\n### Fixed\n- Fixed a bug where the Updates utility wasn\u2019t checking for updates properly. ([#11552](https://github.com/craftcms/cms/issues/11552))\n- Fixed an error that could occur when deploying a Craft 4 upgrade to another server. ([#11558](https://github.com/craftcms/cms/issues/11558))\n- Fixed a bug where Assets fields were relocating assets when saving a revision.\n- Fixed a bug where asset bundles weren\u2019t getting registered on the front end. ([#11555](https://github.com/craftcms/cms/issues/11555))\n\n## 4.1.1 - 2022-07-05\n\n### Changed\n- Improved the control panel tab design. ([#11524](https://github.com/craftcms/cms/pull/11524))\n- Changed the order of relational field condition rule operators, so \u201cis related to\u201d is listed first. ([#11550](https://github.com/craftcms/cms/discussions/11550))\n- Template caching is now supported for console requests, for `{% cache %}` tags that have the `globally` param. ([#11551](https://github.com/craftcms/cms/issues/11551))\n- Updated Composer to 2.2.15. ([#11538](https://github.com/craftcms/cms/issues/11538))\n\n### Fixed\n- Fixed an error that could occur if any custom fields were missing their field group. ([#11522](https://github.com/craftcms/cms/discussions/11522))\n- Fixed a bug where custom selects weren\u2019t scrolling to the visually-focused option.\n- Fixed errors that could occur if an element condition contained any rules for deleted custom fields. ([#11526](https://github.com/craftcms/cms/issues/11526))\n- Fixed a bug where the \u201cDeactivate users by default\u201d user setting wasn\u2019t working. ([#11519](https://github.com/craftcms/cms/issues/11519))\n- Fixed a styling issue with the Edit Route modal. ([#11528](https://github.com/craftcms/cms/issues/11528))\n- Fixed a bug where assets uploaded from Assets fields weren\u2019t retaining their original filename. ([#11530](https://github.com/craftcms/cms/issues/11530))\n- Fixed a bug where project config changes made at the end of the request lifecycle weren\u2019t getting saved.\n- Fixed a bug where toggling entries\u2019 and categories\u2019 site-specific statuses from element editor slideouts wasn\u2019t working. ([#11547](https://github.com/craftcms/cms/issues/11547))\n- Fixed a SQL error that occurred when running the `utils/prune-provisional-drafts` command. ([#11548](https://github.com/craftcms/cms/issues/11548))\n- Fixed focus styling issues with the Edit Route modal.\n\n## 4.1.0.2 - 2022-06-28\n\n### Fixed\n- Fixed a PHP error. ([#11518](https://github.com/craftcms/cms/issues/11518))\n\n## 4.1.0.1 - 2022-06-28\n\n### Fixed\n- Fixed an infinite recursion bug. ([#11514](https://github.com/craftcms/cms/issues/11514))\n\n## 4.1.0 - 2022-06-28\n\n### Added\n- Field layouts can now have \u201cLine Break\u201d UI elements. ([#11328](https://github.com/craftcms/cms/discussions/11328))\n- Added the `db/drop-all-tables` command. ([#11288](https://github.com/craftcms/cms/pull/11288))\n- Added the `elements/delete` command.\n- Added the `elements/restore` command.\n- Added the `project-config/get` command. ([#11341](https://github.com/craftcms/cms/pull/11341))\n- Added the `project-config/remove` command. ([#11341](https://github.com/craftcms/cms/pull/11341))\n- Added the `project-config/set` command. ([#11341](https://github.com/craftcms/cms/pull/11341))\n- The `AdminTable` Vue component can now be included into other Vue apps, in addition to being used as a standalone app. ([#11107](https://github.com/craftcms/cms/pull/11107))\n- Added a `one()` alias for `first()` to collections. ([#11134](https://github.com/craftcms/cms/discussions/11134))\n- Added `craft\\base\\Element::EVENT_DEFINE_CACHE_TAGS`. ([#11171](https://github.com/craftcms/cms/discussions/11171))\n- Added `craft\\base\\Element::cacheTags()`.\n- Added `craft\\base\\FieldInterface::getLabelId()`.\n- Added `craft\\console\\controllers\\UsersController::$activate`.\n- Added `craft\\elements\\conditions\\ElementCondition::$sourceKey`.\n- Added `craft\\elements\\db\\ElementQuery::EVENT_AFTER_POPULATE_ELEMENTS`. ([#11262](https://github.com/craftcms/cms/discussions/11262))\n- Added `craft\\elements\\db\\ElementQuery::EVENT_DEFINE_CACHE_TAGS`. ([#11171](https://github.com/craftcms/cms/discussions/11171))\n- Added `craft\\events\\PopulateElementsEvent`.\n- Added `craft\\fieldlayoutelements\\BaseField::labelId()`.\n- Added `craft\\fieldlayoutelements\\LineBreak`.\n- Added `craft\\helpers\\DateTimeHelper::now()`.\n- Added `craft\\helpers\\DateTimeHelper::pause()`. ([#11130](https://github.com/craftcms/cms/pull/11130))\n- Added `craft\\helpers\\DateTimeHelper::resume()`. ([#11130](https://github.com/craftcms/cms/pull/11130))\n\n### Changed\n- Improved overall control panel accessibility. ([#11297](https://github.com/craftcms/cms/pull/11297), [#11296](https://github.com/craftcms/cms/pull/11296), [#11414](https://github.com/craftcms/cms/pull/11414), [#11452](https://github.com/craftcms/cms/pull/11452))\n- Improved pagination UI accessibility. ([#11126](https://github.com/craftcms/cms/pull/11126))\n- Improved element index accessibility. ([#11169](https://github.com/craftcms/cms/pull/11169), [#11200](https://github.com/craftcms/cms/pull/11200), [#11251](https://github.com/craftcms/cms/pull/11251))\n- Improved Dashboard accessibility. ([#11217](https://github.com/craftcms/cms/pull/11217), [#11297](https://github.com/craftcms/cms/pull/11297))\n- Improved address management accessibility. ([#11397](https://github.com/craftcms/cms/pull/11397))\n- Improved Matrix field accessibility. ([#11306](https://github.com/craftcms/cms/pull/11306))\n- Improved mobile support. ([#11323](https://github.com/craftcms/cms/pull/11323), [#11430](https://github.com/craftcms/cms/pull/11430))\n- Improved keyboard support for custom selects. ([#11414](https://github.com/craftcms/cms/pull/11414))\n- It\u2019s now possible to remove all selected elements from relational fields by pressing <kbd>Backspace</kbd> or <kbd>Delete</kbd> while one of them is focused.\n- Improved the UI of condition builders. ([#11386](https://github.com/craftcms/cms/pull/11386))\n- Entry Type condition rules now allow multiple selections. ([#11124](https://github.com/craftcms/cms/pull/11124))\n- Element index filters now only show condition rules for the custom fields that are used by the field layouts in the selected source, if a native source is selected. ([#11187](https://github.com/craftcms/cms/discussions/11187))\n- Element index filters now only show condition rules for custom fields used by field layouts created for the target element type, if no native source is selected.\n- Condition builders can now include multiple rules with the same label, as long as they\u2019re in different groups.\n- Asset indexes now have a \u201cLocation\u201d table attribute option. ([#11450](https://github.com/craftcms/cms/discussions/11450))\n- It\u2019s now possible to sort entries by their section and type. ([#9192](https://github.com/craftcms/cms/discussions/9192), [#11335](https://github.com/craftcms/cms/discussions/11335))\n- It\u2019s now possible to sort assets by their file kind.\n- Element editor metadata now lists elements\u2019 IDs.\n- Live Preview now always shows a \u201cRefresh\u201d button, regardless of whether the preview target has auto-refresh enabled. ([#11160](https://github.com/craftcms/cms/discussions/11160))\n- Sites\u2019 Language settings now display the locale IDs as option hints, rather than the languages\u2019 native names. ([#11195](https://github.com/craftcms/cms/discussions/11195))\n- Selectize options can now specify searchable `keywords` that won\u2019t be visible in the UI.\n- Selectize inputs will now include their options\u2019 values as search keywords.\n- Newly-created entries now get placeholder Post Date set on them, so they get sorted appropriately when querying for entries ordered by `postDate`. ([#11272](https://github.com/craftcms/cms/issues/11272))\n- Element queries can now pass columns into the `orderBy` param in addition to `score` when searching. ([#11470](https://github.com/craftcms/cms/pull/11470), [#11457](https://github.com/craftcms/cms/discussions/11457))\n- Field layout elements within field layout designers now support double-clicking to open their settings slideout. ([#11277](https://github.com/craftcms/cms/discussions/11277))\n- The control panel\u2019s JavaScript queue is now paused when the browser tab isn\u2019t visible. ([#10632](https://github.com/craftcms/cms/issues/10632))\n- The `db/restore` command now asks whether the database should be backed up, and whether all existing database tables should be dropped, prior to restoring the backup. ([#11288](https://github.com/craftcms/cms/pull/11288))\n- The `users/create` command now asks whether the user should be activated when saved.\n- The `maxBackups` config setting now impacts `.sql.zip` files in addition to `.sql` files. ([#11241](https://github.com/craftcms/cms/issues/11241))\n- Deprecation messages are now consistently referred to as \u201cdeprecation warnings\u201d in the control panel.\n- Callback functions returned by elements\u2019 `sortOptions()`/`defineSortOptions()` methods are now passed a `craft\\db\\Connection` object as a second argument.\n- All element sources now have a \u201cSet Status\u201d action, even if the element type\u2019s `defineActions()` method didn\u2019t include one, if the element type\u2019s `hasStatuses()` method returns `true`. ([#11383](https://github.com/craftcms/cms/discussions/11383))\n- All element sources now have a \u201cView\u201d action, even if the element type\u2019s `defineActions()` method didn\u2019t include one, if the element type\u2019s `hasUris()` method returns `true`. ([#11383](https://github.com/craftcms/cms/discussions/11383))\n- All element sources now have \u201cEdit\u201d and \u201cDelete\u201d actions, even if the element type\u2019s `defineActions()` method didn\u2019t include them. ([#11383](https://github.com/craftcms/cms/discussions/11383))\n- The \u201cSet Status\u201d and \u201cEdit\u201d element actions are now only available for elements whose `canSave()` method returned `true`.\n- Assets fields now reject uploaded files which don\u2019t pass their \u201cSelectable Assets Condition\u201d setting. ([#11433](https://github.com/craftcms/cms/issues/11433))\n- It\u2019s now possible to save new assets without setting their `filename` or `kind` attributes, as long as `newLocation` or `newFilename` is set. ([#11439](https://github.com/craftcms/cms/issues/11439))\n- The `searchindex` table is now uses the InnoDB storage engine by default for MySQL installs. ([#11374](https://github.com/craftcms/cms/discussions/11374))\n- The `_layouts/elementindex` control panel template now sets the page title based on the element\u2019s `pluralDisplayName()` method by default. ([#11502](https://github.com/craftcms/cms/pull/11502))\n- `craft\\test\\ActiveFixture::$data` is now populated with the active record instances, making them accessible to tests via `$this->tester->grabFixture('my-fixture', 'data-key')`. ([#11445](https://github.com/craftcms/cms/pull/11445))\n- Address validation rules are now defined by `defineRules()`. ([#11471](https://github.com/craftcms/cms/pull/11471))\n- `Garnish.DELETE_KEY` now refers to the actual <kbd>Delete</kbd> key code, and the <kbd>Backspace</kbd> key code is now referenced by `Garnish.BACKSPACE_KEY`.\n\n### Deprecated\n- Deprecated `craft\\elements\\actions\\DeleteAssets`. `craft\\elements\\actions\\Delete` should be used instead.\n\n### Removed\n- Removed `craft\\elements\\conditions\\entries\\EntryTypeCondition::$sectionUid`.\n- Removed `craft\\elements\\conditions\\entries\\EntryTypeCondition::$entryTypeUid`.\n\n## 4.0.6 - 2022-06-28\n\n### Added\n- Added `craft\\fields\\BaseOptionsField::encodeValue()`.\n\n### Changed\n- Improved the `install` command\u2019s error output when invalid options were passed.\n- `canonical` is now a reserved field handle. ([#11503](https://github.com/craftcms/cms/issues/11503))\n- `craft\\fields\\BaseOptionsField::translatedOptions()` now has an `$encode` argument.\n\n### Fixed\n- Fixed a bug where self relations within relational fields were being forgotten. ([#11461](https://github.com/craftcms/cms/issues/11461))\n- Fixed a bug where the `install` command required `--site-name`, `--site-url`, and `--language` options to be passed when project config YAML was already present. ([#11513](https://github.com/craftcms/cms/issues/11513))\n- Fixed a bug where `Garnish.setFocusWithin()` wasn\u2019t working if the first focusable element was a checkbox. ([#11498](https://github.com/craftcms/cms/discussions/11498))\n- Fixed a bug where Matrix blocks could be saved in the wrong order.\n- Fixed a bug where Checkboxes, Dropdown, Multi-select, and Radio Buttons fields could lose their values if their option values were set to integers. ([#11461](https://github.com/craftcms/cms/issues/11461))\n\n## 4.0.5.2 - 2022-06-24\n\n### Fixed\n- Fixed a SQL error that could occur on MySQL 5. ([#11493](https://github.com/craftcms/cms/issues/11493))\n- Fixed a bug where Craft\u2019s Composer commands weren\u2019t ensuring that `config.allow-plugins.yiisoft/yii2-composer` was `true` in `composer.json`. ([#11399](https://github.com/craftcms/cms/issues/11399))\n\n## 4.0.5.1 - 2022-06-22\n\n### Fixed\n- Fixed a bug where not all changes to entries and categories created via the \u201cSave and add another\u201d action were propagating to other sites. ([#11476](https://github.com/craftcms/cms/issues/11476))\n- Fixed a bug where it wasn\u2019t possible to rename assets.\n- Fixed a bug where a provisional draft could be created for an entry if its form was interacted with before the page had fully initialized. ([#11466](https://github.com/craftcms/cms/issues/11466))\n- Fixed exact phrase searching on PostgreSQL. ([#11486](https://github.com/craftcms/cms/issues/11486))\n\n## 4.0.5 - 2022-06-21\n\n### Added\n- Added `craft\\helpers\\Number::isIntOrFloat()`.\n\n### Changed\n- Categories now support change tracking.\n- Improved performance when working with temp asset folders.\n- Temp asset folders are no longer created until they\u2019re actually needed. ([#11427](https://github.com/craftcms/cms/issues/11427))\n- Element index queries are no longer cached if they contain a search term.\n- Search inputs within field layout designers now prevent the containing form from being submitted when the <kbd>Return</kbd> key is pressed. ([#11415](https://github.com/craftcms/cms/discussions/11415))\n\n### Deprecated\n- Deprecated `craft\\services\\Categories::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Globals::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Sections::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Tags::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Users::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Volumes::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n\n### Fixed\n- Fixed an error that could occur when saving an element to a disabled site. ([#10499](https://github.com/craftcms/cms/issues/10499))\n- Fixed a bug where newly-added condition rules\u2019 types were still selectable for preexisting condition rules, when they shouldn\u2019t have been.\n- Fixed a bug where field layout designers were checking the wrong setting when determining whether to include UI elements (`customizableTabs` instead of `customizableUi`).\n- Fixed a bug where the Asset Indexes utility was analyzing image transform directories and files. ([#11362](https://github.com/craftcms/cms/issues/11362), [#11384](https://github.com/craftcms/cms/pull/11384))\n- Fixed a bug where focus was getting trapped within element editor slideouts\u2019 sidebars even for wide viewports where there was enough room to display the sidebar side-by-side with other slideout content. ([#11358](https://github.com/craftcms/cms/pull/11358))\n- Fixed a bug where users\u2019 Formatting Locale preferences weren\u2019t always being respected.\n- Fixed a bug where address card menus would linger around after an address was deleted.\n- Fixed a bug where the `index-assets` command could produce unexpected output. ([#11194](https://github.com/craftcms/cms/issues/11194)).\n- Fixed a bug where video controls within asset preview modals were inaccessible via the keyboard. ([#11371](https://github.com/craftcms/cms/pull/11371))\n- Fixed a bug where `transform` GraphQL directives weren\u2019t working for Assets fields. ([#10299](https://github.com/craftcms/cms/discussions/10299))\n- Fixed a PHP error that could occur when running the `help` command. ([#11423](https://github.com/craftcms/cms/issues/11423))\n- Fixed a bug where `craft\\helpers\\App::env()` was converting some values to integers or floats unexpectedly. ([#11422](https://github.com/craftcms/cms/issues/11422))\n- Fixed a bug where changes to existing Matrix blocks weren\u2019t saving for element types that supported drafts but not change tracking. ([#11419](https://github.com/craftcms/cms/issues/11419))\n- Fixed a bug where double-clicking on a related asset\u2019s thumbnail could open the asset\u2019s preview modal. ([#11424](https://github.com/craftcms/cms/issues/11424))\n- Fixed a bug where the control panel wasn\u2019t displaying file upload failure messages.\n- Fixed a bug where `action` query params were taking precedence over `actionTrigger` URI matches, when handling action requests. ([#11435](https://github.com/craftcms/cms/issues/11435))\n- Fixed a bug where image fields within Edit User pages and the Settings \u2192 General page weren\u2019t resetting properly after an image was deleted. ([#11436](https://github.com/craftcms/cms/issues/11436))\n- Fixed a bug where User Group condition rules set to the \u201cis not one of\u201d operator weren\u2019t being applied to individual elements correctly. ([#11444](https://github.com/craftcms/cms/discussions/11444))\n- Fixed a JavaScript error that occurred on element indexes for users that didn\u2019t have permission to edit any sites.\n- Fixed a bug where users without permission to create new entries in a section could duplicate existing entries. ([#11447](https://github.com/craftcms/cms/pull/11447))\n- Fixed a bug where element selection condition rules weren\u2019t working if an element ID was provided. ([#11451](https://github.com/craftcms/cms/pull/11451))\n- Fixed a PHP error that occurred when executing a GraphQL query using a token that wasn\u2019t set to a schema. ([#11453](https://github.com/craftcms/cms/issues/11453))\n- Fixed a PHP error that could occur when unserializing a `craft\\validator\\DateTimeValidator`, `LanguageValidator`, `StringValidator`, or `TimeValidator` object. ([#11454](https://github.com/craftcms/cms/issues/11454))\n- Fixed a bug where element types\u2019 `actions()` methods were getting called for all `element-indexes/*` action requests.\n- Fixed a bug where the `install` command would run non-interactively even if not all needed options were passed, resulting in an error after the database tables had been added. ([#11305](https://github.com/craftcms/cms/issues/11305))\n- Fixed a viewport clipping bug on the control panel\u2019s Login page. ([#11372](https://github.com/craftcms/cms/pull/11372))\n- Fixed a bug where filtering an element query by a relational field using `:empty:`/`:notempty:` wasn\u2019t factoring in the field\u2019s \u201cWhich site should entries be related from?\u201d setting properly.\n- Fixed a bug where filtering an element query by a relational field using `:empty:`/`:notempty:` wasn\u2019t factoring in the source elements\u2019 site IDs, for fields set to manage relations on a per-site basis. ([#11418](https://github.com/craftcms/cms/issues/11418))\n- Fixed a bug where the Temporary Uploads asset source wasn\u2019t including subfolders.\n- Fixed a bug where file upload progress bars weren\u2019t always going away when an upload error occurred.\n- Fixed a bug where Pashto was not being treated as an RTL langauge. ([#11428](https://github.com/craftcms/cms/issues/11428))\n- Fixed a bug where the `upscaleImages` config setting wasn\u2019t being respected for transforms where only a single image dimension was specified. ([#11398](https://github.com/craftcms/cms/issues/11398))\n- Fixed an error that could occur when executing a GraphQL query, if a section didn\u2019t have any entry types. ([#11273](https://github.com/craftcms/cms/issues/11273))\n- Fixed an error that could occur when changing the primary site on installs with a large number of users. ([#11459](https://github.com/craftcms/cms/issues/11459))\n- Fixed a bug where Assets fields within Vizy fields weren\u2019t getting relocated from the user\u2019s temp uploads folder. ([#11462](https://github.com/craftcms/cms/issues/11462))\n\n### Security\n- Environment-aware control panel fields no longer suggest environment variables that begin with `HTTP_`.\n- The Sendmail mailer no longer validates if the Sendmail Command setting is set to an enivornment variable that begins with `HTTP_`.\n\n## 4.0.4 - 2022-06-03\n\n### Added\n- Added support for querying for users with a `credentialed` status.\n- Added `craft\\elements\\db\\UserQuery::STATUS_CREDENTIALED`.\n- Added `craft\\errors\\FieldNotFoundException`.\n- Added `craft\\helpers\\Html::encodeSpaces()`.\n- Added `craft\\web\\twig\\variables\\Cp::getRequestedSite()`. ([#11082](https://github.com/craftcms/cms/discussions/11082))\n\n### Changed\n- `temp` is now a reserved volume handle.\n- Improved the performance of field layout designers. ([#11298](https://github.com/craftcms/cms/issues/11298))\n- All control panel pages now have a `site--<siteHandle>` class name on the `<body>`, based on the currently-selected site. ([#11303](https://github.com/craftcms/cms/discussions/11303))\n- Warnings are no longer logged when instantiating a field layout that references a deleted custom field. ([#11333](https://github.com/craftcms/cms/issues/11333))\n- Read/write splitting is now disabled for all console requests.\n- The `db/restore` command now prompts to clear data caches after the import is complete. ([#11327](https://github.com/craftcms/cms/issues/11327))\n- Entry queries no longer factor in seconds when looking for currently-live entries, without excluding entries that were published in the past minute. ([#5389](https://github.com/craftcms/cms/issues/5389))\n- `craft\\elements\\Asset::getUrl()` now encodes any spaces in the URL as `%20` entities.\n\n### Fixed\n- Fixed a bug where it wasn\u2019t possible to disable all table columns for an element source. ([#11291](https://github.com/craftcms/cms/issues/11291))\n- Fixed a bug where the Assets index page wasn\u2019t allowing any bulk actions for assets in the temporary volume. ([#11293](https://github.com/craftcms/cms/issues/11293))\n- Fixed a bug where PHP errors thrown while rendering a template weren\u2019t being handled properly. ([#11108](https://github.com/craftcms/cms/issues/11108))\n- Fixed a bug where site status labels were inconsistent on element edit pages. ([#11307](https://github.com/craftcms/cms/issues/11307))\n- Fixed a bug where addresses\u2019 County fields were mislablled. ([#11314](https://github.com/craftcms/cms/pull/11314))\n- Fixed a bug where the control panel\u2019s login form wasn\u2019t handling errors properly. ([#11319](https://github.com/craftcms/cms/pull/11319))\n- Fixed a bug where it wasn\u2019t possible to use a `{% redirect %}` tag in an error template. ([#11336](https://github.com/craftcms/cms/issues/11336))\n- Fixed an error that occurred when saving an entry via a GraphQL mutation. ([#11312](https://github.com/craftcms/cms/issues/11312))\n- Fixed a bug where all web requests were getting no-cache headers. ([#11346](https://github.com/craftcms/cms/issues/11346))\n- Fixed a bug where user caches weren\u2019t getting invalidated when users were changed to a pending or inactive state.\n- Fixed a bug where querying for users with an `active` status was returning suspended users. ([#11370](https://github.com/craftcms/cms/pull/11370))\n- Fixed a bug where it wasn\u2019t possible to drag assets within Assets fields by their thumbnails. ([#11364](https://github.com/craftcms/cms/issues/11364))\n- Fixed a bug where asset thumbnails weren\u2019t loading if their filename contained a space. ([#11350](https://github.com/craftcms/cms/issues/11350))\n- Fixed a bug where `craft\\services\\AssetIndexer::indexFile()` wasn\u2019t removing the filename from the file path when setting the directory on the listing. ([#11365](https://github.com/craftcms/cms/issues/11365))\n- Fixed a bug where links within custom field instructions were getting mangled. ([#11377](https://github.com/craftcms/cms/issues/11377))\n- Fixed a bug where project config paths that contained slashes weren\u2019t getting handled properly. ([#10774](https://github.com/craftcms/cms/issues/10774))\n- Fixed a bug where the Login page had a tab-focusable \u201cSkip to content\u201d button. ([#11375](https://github.com/craftcms/cms/issues/11375))\n\n## 4.0.3 - 2022-05-20\n\n### Added\n- Added `craft\\elements\\db\\ElementQuery::prepareSubquery()`.\n\n### Changed\n- Element edit pages now disable pointer events on the content container for 300 milliseconds after the \u201cShowing your unsaved changes\u201d notice is displayed. ([#11229](https://github.com/craftcms/cms/issues/11229))\n- Users can now create drafts for entries they have permission to view, but not save. ([#11249](https://github.com/craftcms/cms/issues/11249))\n- User Group condition rules are no longer available in element conditions when no user groups exist. ([#11252](https://github.com/craftcms/cms/issues/11252))\n- Matrix blocks now have `data-type-name` attributes. ([#11286](https://github.com/craftcms/cms/pull/11286))\n- Reversed the order of Lightswitch fields\u2019 \u201cON Label\u201d and \u201cOFF Label\u201d settings. ([#11259](https://github.com/craftcms/cms/issues/11259))\n- `craft\\services\\Elements::duplicateElement()` now has a `$trackDuplication` argument.\n- `craft\\services\\Matrix::duplicateBlocks()` now has a `$trackDuplications` argument.\n\n### Fixed\n- Fixed a bug where dynamically-defined image transforms weren\u2019t respecting the `format` param, unless the `generateTransformsBeforePageLoad` config setting was enabled.\n- Fixed a bug where Table fields with Min Rows and Max Rows set to `1` were still showing a delete button. ([#11211](https://github.com/craftcms/cms/issues/11211))\n- Fixed an error that could occur when saving an Assets field that was restricted to a single location, at the root of a volume. ([#11212](https://github.com/craftcms/cms/issues/11212))\n- Fixed an error that could occur after a queue job execution had finished. ([#11213](https://github.com/craftcms/cms/issues/11213))\n- Fixed an error that could occur when saving an entry with Matrix blocks. ([#11155](https://github.com/craftcms/cms/issues/11155))\n- Fixed an error that occurred when saving a GraphQL schema without a scope. ([#11240](https://github.com/craftcms/cms/issues/11240))\n- Fixed an error that could occur when editing the public GraphQL schema, if a public token existed in the project config, but not the database. ([#11218](https://github.com/craftcms/cms/issues/11218))\n- Fixed some bugs with inconsistent asset indexing on Windows. ([#11174](https://github.com/craftcms/cms/issues/11174)), ([#11219](https://github.com/craftcms/cms/issues/11219))\n- Fixed a bug where custom fields weren\u2019t available to be included as table attributes. ([#11222](https://github.com/craftcms/cms/issues/11222))\n- Fixed a bug where Alternative Text wasn\u2019t available to be included as a table attribute. ([#11222](https://github.com/craftcms/cms/issues/11222))`immediately`\n- Fixed a JavaScript error that broke Matrix fields with Min Blocks and Max Blocks both set to `1`. ([#11233](https://github.com/craftcms/cms/issues/11233))\n- Fixed a bug where request context logs could appear when nothing else was logged. ([#11141](https://github.com/craftcms/cms/issues/11141))\n- Fixed a bug where stack traces could be erroneously filtered from logs.\n- Fixed a bug where removing an element from a relational field within an element editor could cause the editor to create a provisional draft, even if the element type didn\u2019t support drafts. ([#11242](https://github.com/craftcms/cms/issues/11242))\n- Fixed a bug where draft editor pages had two identical \u201cSave and continue editing\u201d alternate form actions.\n- Fixed a JavaScript warning that occurred when viewing an element edit page, if the user didn\u2019t have permission to edit it.\n- Fixed a bug where asset selector modals weren\u2019t fully initializing for Assets fields, if they were targeting the user\u2019s temp folder. ([#11254](https://github.com/craftcms/cms/issues/11254))\n- Fixed an error that occurred when saving an entry via a GraphQL mutation. ([#11258](https://github.com/craftcms/cms/issues/11258))\n- Fixed a bug where Matrix block types\u2019 layout elements were getting new UUIDs assigned each time the Matrix field was edited. ([#11248](https://github.com/craftcms/cms/issues/11248))\n- Fixed a bug where the web-based installation wizard was throwing an exception if a database connection couldn\u2019t be established, and there was no `config/db.php` file. ([#11245](https://github.com/craftcms/cms/issues/11245))\n- Fixed a bug where editable tables\u2019 delete buttons\u2019 `aria-label` attributes weren\u2019t getting updated when table rows were reordered or deleted.\n- Fixed a bug where editable tables\u2019 delete buttons weren\u2019t visually disabled when the minimum number of rows had been reached.\n- Fixed a bug where all eager-loaded `srcset`-style transform sizes were relative to the first eager-loaded transform, rather than the prior one. ([#11209](https://github.com/craftcms/cms/issues/11209))\n- Fixed a bug where eager-loaded `srcset`-style transform sizes didn\u2019t reference the prior eager-loaded transform\u2019s `format`, `interlace`, `mode`, `position`, or `quality` settings. ([#11264](https://github.com/craftcms/cms/issues/11264))\n- Fixed a bug where the web-based installation wizard wouldn\u2019t show the database connection screen if a connection could be established but no database was selected. ([#11245](https://github.com/craftcms/cms/issues/11245))\n- Fixed an error that could occur when applying a multi-site draft with relational fields. ([#11220](https://github.com/craftcms/cms/issues/11220))\n- Fixed a bug where Matrix blocks could be deleted from newly-created multi-site entries, if the edit page was reloaded. ([#10906](https://github.com/craftcms/cms/issues/10906))\n\n## 4.0.2 - 2022-05-11\n\n### Added\n- Added `craft\\events\\LocateUploadedFilesEvent`.\n- Added `craft\\fields\\Assets::EVENT_LOCATE_UPLOADED_FILES`. ([#11123](https://github.com/craftcms/cms/discussions/11123))\n\n### Changed\n- `elements/*` actions no longer include custom field values in the response data, improving performance.\n- Garnish menu buttons are now aware of the `disabled` attribute. ([#11128](https://github.com/craftcms/cms/issues/11128))\n- Improved save performance for multi-site elements ([#11113](https://github.com/craftcms/cms/issues/11113))\n- Built-in Composer actions now ensure that `composer.json` allows the `craftcms/plugin-installer` Composer plugin.\n\n### Fixed\n- Fixed an error that occurred when searching for elements by a custom field. ([#11120](https://github.com/craftcms/cms/pull/11120))\n- Fixed a bug where asset upload failures weren\u2019t being handled properly. ([#11156](https://github.com/craftcms/cms/issues/11156))\n- Fixed a bug where warning and error logs were being sent to both `stdout` and `stderr` when `CRAFT_STREAM_LOG` was enabled. ([#11189](https://github.com/craftcms/cms/issues/11189))\n- Fixed an error that occurred when exporting elements with relational fields using the \u201cExpanded\u201d export type. ([#11127](https://github.com/craftcms/cms/issues/11127))\n- Fixed a PHP deprecation warning that occurred if the `tablePrefix` database connection setting was `null`.\n- Fixed a bug where category groups were being identified as \u201c{name}\u201d in user permission lists. ([#11132](https://github.com/craftcms/cms/issues/11132))\n- Fixed a bug where Assets fields\u2019 \u201cUpload files\u201d buttons weren\u2019t wrapping when there wasn\u2019t enough space to show them alongside \u201cAdd an asset\u201d. ([#11133](https://github.com/craftcms/cms/issues/11133))\n- Fixed a bug where `Craft.getUrl()` was appending empty query strings to URLs when they weren\u2019t needed. ([#11159](https://github.com/craftcms/cms/issues/11159))\n- Fixed a bug where addresses could validate the wrong set of required fields, if the validation rules were invoked before the country code was set. ([#11162](https://github.com/craftcms/cms/issues/11162))\n- Fixed an error that could occur when viewing the Temporary Uploads volume, if the Temp Uploads Location asset setting was set to \u201cIn the local temp folder\u201d. ([#11192](https://github.com/craftcms/cms/issues/11192))\n- Fixed an error that could occur when deleting a volume, if its filesystem had been deleted.\n- Fixed an error that could occur when rendering the thumbnail preview for an asset, if its file was missing. ([#11196](https://github.com/craftcms/cms/issues/11196))\n- Fixed a bug where soft-deleted drafts\u2019 search keywords weren\u2019t getting re-indexed if they were restored.\n- Fixed an error that occurred when transforming an SVG image without specifying a width or height. ([#11122](https://github.com/craftcms/cms/issues/11122))\n- Fixed an error that occurred when saving a Number field with a non-numeric value. ([#11164](https://github.com/craftcms/cms/issues/11164))\n- Fixed a bug where it wasn\u2019t possible to drag an item to the top in admin tables. ([#10781](https://github.com/craftcms/cms/issues/10781))\n- Fixed a bug where entries within Structure sections weren\u2019t expandable if their only descendants were unpublished drafts.\n- Fixed a bug where expanding a collapsed Structure section entry wouldn\u2019t reveal its descendants, if the parent was a draft. ([#11186](https://github.com/craftcms/cms/issues/11186))\n- Fixed a bug where element caches weren\u2019t getting cleared for elements when they were propagated to a newly-created site.\n\n## 4.0.1 - 2022-05-06\n\n### Fixed\n- Fixed a bug where Money field labels\u2019 `for` attributes weren\u2019t referencing the correct input ID. ([#11016](https://github.com/craftcms/cms/pull/11016))\n- Fixed a bug where Money field inputs weren\u2019t getting `aria-describedby` attributes. ([#11016](https://github.com/craftcms/cms/pull/11016))\n- Fixed an error that occurred when loading an edit screen for an element type that didn\u2019t have a field layout. ([#11110](https://github.com/craftcms/cms/pull/11110))\n- Fixed a bug where condition rules that weren\u2019t selectable (per `isSelectable()`) were still visible in the rule dropdown menu. ([#11104](https://github.com/craftcms/cms/pull/11104))\n- Fixed a bug where element edit pages could reload themselves immediately after saving the element. ([#11084](https://github.com/craftcms/cms/issues/11084))\n- Fixed a bug where tabs weren\u2019t interactive after changing an entry\u2019s type, if the new entry type didn\u2019t have a tab of the same name as the previously-selected tab. ([#11093](https://github.com/craftcms/cms/issues/11093))\n- Fixed a bug where Twig syntax errors weren\u2019t being handled properly. ([#11108](https://github.com/craftcms/cms/issues/11108))\n- Fixed an error that occurred when attempting to delete a global set. ([#11100](https://github.com/craftcms/cms/issues/11100))\n- Fixed an error that could occur when applying a draft. ([#11083](https://github.com/craftcms/cms/issues/11083))\n- Fixed a bug where element queries weren\u2019t returning any results if an element attribute table wasn\u2019t joined in, and the element query was set to an abstract element class. ([#11105](https://github.com/craftcms/cms/issues/11105))\n\n## 4.0.0.1 - 2022-05-04\n\n### Changed\n- The `setup` command now writes the application ID to a `CRAFT_APP_ID` environment variable.\n- The `setup` command now writes the security key to a `CRAFT_SECURITY_KEY` environment variable.\n\n## 4.0.0 - 2022-05-04\n\n### Added\n- Entries\u2019, categories\u2019, and assets\u2019 edit pages, and all element types via slideouts, now use a unified editing experience. ([#10467](https://github.com/craftcms/cms/pull/10467))\n- Categories now support drafts. ([#10467](https://github.com/craftcms/cms/pull/10467))\n- Element slideouts now support provisional drafts and autosaving, for element types that support them. ([#10467](https://github.com/craftcms/cms/pull/10467))\n- Element indexes can now be filtered by element attributes and custom field values. ([#9192](https://github.com/craftcms/cms/discussions/9192), [#9450](https://github.com/craftcms/cms/discussions/9450), [#9462](https://github.com/craftcms/cms/discussions/9462), [#9483](https://github.com/craftcms/cms/discussions/9483))\n- Admins can now create custom element sources from the Customize Sources modal. ([#8423](https://github.com/craftcms/cms/discussions/8423))\n- It\u2019s now possible to disable native element sources from the Customize Sources modal. ([#10676](https://github.com/craftcms/cms/discussions/10676))\n- Field layout tabs, fields, and UI elements can now be conditionally shown based on properties of the current user and/or element being edited. ([#8099](https://github.com/craftcms/cms/discussions/8099), [#8154](https://github.com/craftcms/cms/discussions/8154))\n- Assets, Entries, and Users fields have new condition settings that can be used to further limit which elements should be relatable, beyond the existing field settings. ([#10393](https://github.com/craftcms/cms/pull/10393))\n- Assets, Entries, and Users fields have new \u201cMin Relations\u201d settings, and their former \u201cLimit\u201d settings have been renamed to \u201cMax Relations\u201d. ([#8621](https://github.com/craftcms/cms/discussions/8621))\n- Added a dedicated \u201cFull Name\u201d field to users. \u201cFirst Name\u201d and \u201cLast Name\u201d are now parsed out from the full name automatically when a user is saved. ([#10405](https://github.com/craftcms/cms/discussions/10405))\n- Added the \u201cInactive\u201d user status, which can be used by users which can\u2019t be signed into. ([#8963](https://github.com/craftcms/cms/discussions/8963))\n- Added \u201cCredentialed\u201d and \u201cInactive\u201d user sources.\n- Added the \u201cDeactivate\u2026\u201d user action for pending and active users.\n- Users can now have an \u201cAddresses\u201d field. ([#10507](https://github.com/craftcms/cms/pull/10507))\n- Added the concept of \u201cfilesystems\u201d, which handle file operations, either locally or on a remote service like Amazon S3.\n- It\u2019s now possible to set sites\u2019 Status settings to environment variables. ([#3005](https://github.com/craftcms/cms/issues/3005))\n- Added the Money field type.\n- Craft now provides a native \u201cAlternative Text\u201d (`alt`) field for assets. ([#10302](https://github.com/craftcms/cms/discussions/10302))\n- Asset thumbnails in the control panel now have `alt` attributes, for assets with a filled-in Alternative Text value.\n- Added the `index-assets/cleanup` command.\n- Added the \u201cDeactivate users by default\u201d user registration setting, which replaces \u201cSuspend users by default\u201d. ([#5830](https://github.com/craftcms/cms/issues/5830))\n- Element source settings are now stored in the project config. ([#8616](https://github.com/craftcms/cms/discussions/8616))\n- Improved element index accessibility. ([#10629](https://github.com/craftcms/cms/pull/10629), [#10660](https://github.com/craftcms/cms/pull/10660))\n- Improved Live Preview accessibility for screen readers. ([#10688](https://github.com/craftcms/cms/pull/10688))\n- Slideouts, Live Preview, and Matrix blocks are no longer animated for browsers that have requested reduced motion. ([#10665](https://github.com/craftcms/cms/pull/10665))\n- Added support for `JSON` columns. ([#9089](https://github.com/craftcms/cms/pull/9089))\n- It\u2019s now possible to edit images\u2019 focal points from their preview modals. ([#8489](https://github.com/craftcms/cms/discussions/8489))\n- Added support for Monolog and the PSR-3 logging interface. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- Added the `|address` Twig filter.\n- Added the `|money` Twig filter.\n- Added the `collect()` Twig function.\n- Added the `assetUploaders`, `authors`, and `fullName` user query params.\n- Added the `primaryOwner` and `primaryOwnerId` Matrix block query params.\n- Added the `hasAlt` asset query param.\n- Added the `button`, `submitButton`, `fs`, `fsField`, `volume`, and `volumeField` macros to the `_includes/forms` control panel template.\n- Added the `buildId` general config. ([#10705](https://github.com/craftcms/cms/pull/10705))\n- Added support for setting custom config settings from `config/custom.php`, which are accessible via `Craft::$app->config->custom`. ([#10012](https://github.com/craftcms/cms/issues/10012))\n- Added the `addresses`, `address`, and `addressCount` GraphQL queries.\n- Added the `hasAlt` argument to asset GraphQL queries.\n- Added the `alt` field to assets queried via GraphQL.\n- Added the `fullName`, `assetUploaders`, and `authors` arguments to user GraphQL queries.\n- Added the `addresses` field to user GraphQL queries.\n- GraphQL schemas now include settings that determine which sites elements can be queried from. ([#10610](https://github.com/craftcms/cms/issues/10610))\n- Added the `assets/icon` action.\n- Added the `assets/update-focal-point` action.\n- Added the `categories/create` action.\n- Added the `elements/apply-draft` action.\n- Added the `elements/create` action.\n- Added the `elements/delete-draft` action.\n- Added the `elements/delete-for-site` action.\n- Added the `elements/delete` action.\n- Added the `elements/duplicate` action.\n- Added the `elements/edit` action.\n- Added the `elements/redirect` action.\n- Added the `elements/revert` action.\n- Added the `elements/save-draft` action.\n- Added the `elements/save` action.\n- Added the `users/delete-address` action.\n- Added the `users/save-address` action.\n- Added the `app/render-element` control panel controller action.\n- Added the `element-indexes/element-table-html` control panel controller action.\n- Added `craft\\base\\ApplicationTrait::getConditions()`.\n- Added `craft\\base\\ApplicationTrait::getElementSources()`, which replaces `getElementIndexes()`.\n- Added `craft\\base\\ApplicationTrait::getFs()`.\n- Added `craft\\base\\ApplicationTrait::getImageTransforms()`, which replaces `getAssetTransforms()`.\n- Added `craft\\base\\conditions\\BaseCondition`.\n- Added `craft\\base\\conditions\\BaseConditionRule`.\n- Added `craft\\base\\conditions\\BaseDateRangeConditionRule`.\n- Added `craft\\base\\conditions\\BaseElementSelectConditionRule`.\n- Added `craft\\base\\conditions\\BaseLightswitchConditionRule`.\n- Added `craft\\base\\conditions\\BaseMultiSelectConditionRule`.\n- Added `craft\\base\\conditions\\BaseNumberConditionRule`.\n- Added `craft\\base\\conditions\\BaseSelectConditionRule`.\n- Added `craft\\base\\conditions\\BaseTextConditionRule`.\n- Added `craft\\base\\conditions\\ConditionInterface`.\n- Added `craft\\base\\conditions\\ConditionRuleInterface`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_CREATE_DRAFTS`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_DELETE_FOR_SITE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_DELETE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_DUPLICATE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_SAVE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_VIEW`.\n- Added `craft\\base\\Element::EVENT_DEFINE_ADDITIONAL_BUTTONS`. ([#10420](https://github.com/craftcms/cms/discussions/10420))\n- Added `craft\\base\\Element::getParentId()`.\n- Added `craft\\base\\Element::hasNewParent()`.\n- Added `craft\\base\\Element::notesFieldHtml()`.\n- Added `craft\\base\\Element::setParentId()`.\n- Added `craft\\base\\Element::statusFieldHtml()`.\n- Added `craft\\base\\ElementInterface::canCreateDrafts()`.\n- Added `craft\\base\\ElementInterface::canDelete()`.\n- Added `craft\\base\\ElementInterface::canDeleteForSite()`.\n- Added `craft\\base\\ElementInterface::canDuplicate()`.\n- Added `craft\\base\\ElementInterface::canSave()`.\n- Added `craft\\base\\ElementInterface::canView()`.\n- Added `craft\\base\\ElementInterface::createAnother()`.\n- Added `craft\\base\\ElementInterface::createCondition()`.\n- Added `craft\\base\\ElementInterface::getAdditionalButtons()`.\n- Added `craft\\base\\ElementInterface::getPostEditUrl()`.\n- Added `craft\\base\\ElementInterface::getThumbAlt()`.\n- Added `craft\\base\\ElementInterface::hasRevisions()`.\n- Added `craft\\base\\ElementInterface::prepareEditScreen()`.\n- Added `craft\\base\\FieldInterface::getElementConditionRuleType()`.\n- Added `craft\\base\\FieldInterface::isRequirable()`.\n- Added `craft\\base\\FieldLayoutComponent`.\n- Added `craft\\base\\Fs`.\n- Added `craft\\base\\FsInterface`.\n- Added `craft\\base\\FsTrait`.\n- Added `craft\\base\\Image::heartbeat()`.\n- Added `craft\\base\\Image::setHeartbeatCallback()`.\n- Added `craft\\base\\imagetransforms\\EagerImageTransformerInterface`.\n- Added `craft\\base\\imagetransforms\\ImageEditorTransformerInterface`.\n- Added `craft\\base\\imagetransforms\\ImageTransformerInterface`.\n- Added `craft\\base\\LocalFsInterface`.\n- Added `craft\\base\\Model::defineBehaviors()`. ([#10691](https://github.com/craftcms/cms/pull/10691))\n- Added `craft\\base\\ModelInterface`.\n- Added `craft\\base\\NameTrait`.\n- Added `craft\\base\\PluginInterface::config()`. ([#11039](https://github.com/craftcms/cms/pull/11039))\n- Added `craft\\behaviors\\SessionBehavior::broadcastToJs()`.\n- Added `craft\\behaviors\\SessionBehavior::getError()`.\n- Added `craft\\behaviors\\SessionBehavior::getNotice()`.\n- Added `craft\\controllers\\AddressesController`.\n- Added `craft\\controllers\\AssetIndexesController`.\n- Added `craft\\controllers\\ConditionsController`.\n- Added `craft\\controllers\\ElementIndexesController::$condition`.\n- Added `craft\\controllers\\FsController`.\n- Added `craft\\controllers\\ImageTransformsController`.\n- Added `craft\\db\\Migration::archiveTableIfExists()`. ([#10827](https://github.com/craftcms/cms/discussions/10827))\n- Added `craft\\db\\Migration::dropAllForeignKeysToTable()`.\n- Added `craft\\db\\Migration::dropForeignKeyIfExists()`.\n- Added `craft\\db\\Migration::renameTable()`.\n- Added `craft\\db\\Query::collect()`, which returns the query results as an `Illuminate\\Support\\Collection` object rather than an array. ([#8513](https://github.com/craftcms/cms/discussions/8513))\n- Added `craft\\db\\Table::ADDRESSES`.\n- Added `craft\\db\\Table::ASSETINDEXINGSESSIONS`.\n- Added `craft\\db\\Table::IMAGETRANSFORMINDEX`.\n- Added `craft\\db\\Table::IMAGETRANSFORMS`.\n- Added `craft\\db\\Table::MATRIXBLOCKS_OWNERS`.\n- Added `craft\\debug\\LogTarget`.\n- Added `craft\\debug\\MailPanel`.\n- Added `craft\\elements\\Address`.\n- Added `craft\\elements\\Asset::$alt`.\n- Added `craft\\elements\\Asset::EVENT_AFTER_GENERATE_TRANSFORM`.\n- Added `craft\\elements\\Asset::EVENT_BEFORE_GENERATE_TRANSFORM`.\n- Added `craft\\elements\\Asset::getFs()`.\n- Added `craft\\elements\\Asset::setFilename()`.\n- Added `craft\\elements\\conditions\\addresses\\AddressCondition`.\n- Added `craft\\elements\\conditions\\addresses\\CountryConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\AssetCondition`.\n- Added `craft\\elements\\conditions\\assets\\DateModifiedConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\FilenameConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\FileSizeConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\FileTypeConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\HasAltConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\HeightConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\UploaderConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\VolumeConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\WidthConditionRule`.\n- Added `craft\\elements\\conditions\\categories\\CategoryCondition`.\n- Added `craft\\elements\\conditions\\categories\\GroupConditionRule`.\n- Added `craft\\elements\\conditions\\DateCreatedConditionRule`.\n- Added `craft\\elements\\conditions\\DateUpdatedConditionRule`.\n- Added `craft\\elements\\conditions\\ElementCondition`.\n- Added `craft\\elements\\conditions\\ElementConditionInterface`.\n- Added `craft\\elements\\conditions\\ElementConditionRuleInterface`.\n- Added `craft\\elements\\conditions\\entries\\AuthorConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\AuthorGroupConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\EntryCondition`.\n- Added `craft\\elements\\conditions\\entries\\ExpiryDateConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\PostDateConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\SectionConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\TypeConditionRule`.\n- Added `craft\\elements\\conditions\\HasUrlConditionRule`.\n- Added `craft\\elements\\conditions\\IdConditionRule`.\n- Added `craft\\elements\\conditions\\LevelConditionRule`.\n- Added `craft\\elements\\conditions\\RelatedToConditionRule`.\n- Added `craft\\elements\\conditions\\SlugConditionRule`.\n- Added `craft\\elements\\conditions\\tags\\GroupConditionRule`.\n- Added `craft\\elements\\conditions\\tags\\TagCondition`.\n- Added `craft\\elements\\conditions\\TitleConditionRule`.\n- Added `craft\\elements\\conditions\\UriConditionRule`.\n- Added `craft\\elements\\conditions\\users\\AdminConditionRule`.\n- Added `craft\\elements\\conditions\\users\\CredentialedConditionRule`.\n- Added `craft\\elements\\conditions\\users\\EmailConditionRule`.\n- Added `craft\\elements\\conditions\\users\\FirstNameConditionRule`.\n- Added `craft\\elements\\conditions\\users\\GroupConditionRule`.\n- Added `craft\\elements\\conditions\\users\\LastLoginDateConditionRule`.\n- Added `craft\\elements\\conditions\\users\\LastNameConditionRule`.\n- Added `craft\\elements\\conditions\\users\\UserCondition`.\n- Added `craft\\elements\\conditions\\users\\UsernameConditionRule`.\n- Added `craft\\elements\\db\\AddressQuery`.\n- Added `craft\\elements\\MatrixBlock::$primaryOwnerId`.\n- Added `craft\\elements\\MatrixBlock::$saveOwnership`.\n- Added `craft\\elements\\User::$active`.\n- Added `craft\\elements\\User::$fullName`.\n- Added `craft\\elements\\User::canAssignUserGroups()`.\n- Added `craft\\elements\\User::getAddresses()`.\n- Added `craft\\elements\\User::getIsCredentialed()`.\n- Added `craft\\elements\\User::STATUS_INACTIVE`.\n- Added `craft\\errors\\FsException`.\n- Added `craft\\errors\\FsObjectExistsException`.\n- Added `craft\\errors\\FsObjectNotFoundException`.\n- Added `craft\\errors\\ImageTransformException`.\n- Added `craft\\errors\\InvalidFsException`.\n- Added `craft\\errors\\MissingVolumeFolderException`.\n- Added `craft\\events\\AuthorizationCheckEvent`.\n- Added `craft\\events\\CreateElementCheckEvent`.\n- Added `craft\\events\\DefineElementEditorHtmlEvent`.\n- Added `craft\\events\\DefineElementInnerHtmlEvent`. ([#11035](https://github.com/craftcms/cms/pull/11035))\n- Added `craft\\events\\DefineHtmlEvent::$static`.\n- Added `craft\\events\\FsEvent`.\n- Added `craft\\events\\GenerateTransformEvent::$asset`.\n- Added `craft\\events\\GenerateTransformEvent::$transform`.\n- Added `craft\\events\\GenerateTransformEvent::$url`.\n- Added `craft\\events\\ImageTransformerOperationEvent`.\n- Added `craft\\events\\ImageTransformEvent`.\n- Added `craft\\events\\RegisterConditionRuleTypesEvent`.\n- Added `craft\\events\\TransformImageEvent`.\n- Added `craft\\fieldlayoutelements\\addresses\\AddressField`.\n- Added `craft\\fieldlayoutelements\\addresses\\CountryCodeField`.\n- Added `craft\\fieldlayoutelements\\addresses\\LabelField`.\n- Added `craft\\fieldlayoutelements\\addresses\\LatLongField`.\n- Added `craft\\fieldlayoutelements\\addresses\\OrganizationField`.\n- Added `craft\\fieldlayoutelements\\addresses\\OrganizationTaxIdField`.\n- Added `craft\\fieldlayoutelements\\assets\\AltField`.\n- Added `craft\\fieldlayoutelements\\BaseField::selectorLabel()`.\n- Added `craft\\fieldlayoutelements\\FullNameField`.\n- Added `craft\\fieldlayoutelements\\TextareaField`.\n- Added `craft\\fieldlayoutelements\\users\\AddressesField`.\n- Added `craft\\fields\\Assets::$allowSubfolders`.\n- Added `craft\\fields\\Assets::$restrictedDefaulUploadSubpath`.\n- Added `craft\\fields\\BaseRelationField::createSelectionCondition()`.\n- Added `craft\\fields\\BaseRelationField::getSelectionCondition()`.\n- Added `craft\\fields\\BaseRelationField::setSelectionCondition()`.\n- Added `craft\\fields\\conditions\\DateFieldConditionRule`.\n- Added `craft\\fields\\conditions\\FieldConditionRuleInterface`.\n- Added `craft\\fields\\conditions\\FieldConditionRuleTrait`.\n- Added `craft\\fields\\conditions\\LightswitchFieldConditionRule`.\n- Added `craft\\fields\\conditions\\NumberFieldConditionRule`.\n- Added `craft\\fields\\conditions\\OptionsFieldConditionRule`.\n- Added `craft\\fields\\conditions\\RelationalFieldConditionRule`.\n- Added `craft\\fields\\conditions\\TextFieldConditionRule`.\n- Added `craft\\fields\\Money`.\n- Added `craft\\fs\\Local`.\n- Added `craft\\fs\\MissingFs`.\n- Added `craft\\fs\\Temp`.\n- Added `craft\\gql\\arguments\\elements\\Address`.\n- Added `craft\\gql\\base\\SingularTypeInterface`.\n- Added `craft\\gql\\interfaces\\elements\\Address`.\n- Added `craft\\gql\\queries\\Address`.\n- Added `craft\\gql\\resolvers\\elements\\Address`.\n- Added `craft\\gql\\TypeManager::registerFieldDefinitions()`.\n- Added `craft\\gql\\types\\elements\\Address`.\n- Added `craft\\gql\\types\\generators\\AddressType`.\n- Added `craft\\helpers\\App::cliOption()`.\n- Added `craft\\helpers\\App::devMode()`.\n- Added `craft\\helpers\\App::envConfig()`. ([#10869](https://github.com/craftcms/cms/pull/10869))\n- Added `craft\\helpers\\App::isStreamLog()`.\n- Added `craft\\helpers\\App::normalizeValue()`.\n- Added `craft\\helpers\\Assets::downloadFile()`.\n- Added `craft\\helpers\\Assets::iconPath()`.\n- Added `craft\\helpers\\Assets::iconUrl()`.\n- Added `craft\\helpers\\Assets::revParams()`.\n- Added `craft\\helpers\\Cp::addressCardHtml()`.\n- Added `craft\\helpers\\Cp::addressCardsHtml()`.\n- Added `craft\\helpers\\Cp::addressFieldsHtml()`.\n- Added `craft\\helpers\\Cp::dateFieldHtml()`.\n- Added `craft\\helpers\\Cp::dateHtml()`.\n- Added `craft\\helpers\\Cp::elementSelectHtml()`.\n- Added `craft\\helpers\\Cp::EVENT_DEFINE_ELEMENT_INNER_HTML`. ([#11035](https://github.com/craftcms/cms/pull/11035))\n- Added `craft\\helpers\\Cp::fieldLayoutDesignerHtml()`.\n- Added `craft\\helpers\\Cp::lightswitchHtml()`.\n- Added `craft\\helpers\\Cp::multiSelectFieldHtml()`.\n- Added `craft\\helpers\\Cp::multiSelectHtml()`.\n- Added `craft\\helpers\\Cp::requestedSite()`.\n- Added `craft\\helpers\\Cp::textareaHtml()`.\n- Added `craft\\helpers\\Cp::textHtml()`.\n- Added `craft\\helpers\\Cp::timeFieldHtml()`.\n- Added `craft\\helpers\\Cp::timeHtml()`.\n- Added `craft\\helpers\\Db::dropAllForeignKeysToTable()`.\n- Added `craft\\helpers\\Db::dropForeignKeyIfExists()`.\n- Added `craft\\helpers\\Db::dropIndexIfExists()`.\n- Added `craft\\helpers\\Db::findForeignKey()`.\n- Added `craft\\helpers\\Db::findIndex()`.\n- Added `craft\\helpers\\Db::parseMoneyParam()`.\n- Added `craft\\helpers\\Db::parseNumericParam()`.\n- Added `craft\\helpers\\Db::prepareMoneyForDb()`.\n- Added `craft\\helpers\\Db::renameTable()`.\n- Added `craft\\helpers\\FileHelper::deleteFileAfterRequest()`.\n- Added `craft\\helpers\\FileHelper::deleteQueuedFiles()`.\n- Added `craft\\helpers\\Gql::getSchemaContainedEntryTypes)()`.\n- Added `craft\\helpers\\Html::hiddenLabel()`.\n- Added `craft\\helpers\\Html::unwrapCondition()`.\n- Added `craft\\helpers\\Html::unwrapNoscript()`.\n- Added `craft\\helpers\\ImageTransforms`.\n- Added `craft\\helpers\\Money`.\n- Added `craft\\helpers\\Number::isInt()`.\n- Added `craft\\helpers\\Number::toIntOrFloat()`.\n- Added `craft\\helpers\\ProjectConfig::encodeValueAsString()`.\n- Added `craft\\helpers\\ProjectConfig::ensureAllSectionsProcessed()`.\n- Added `craft\\helpers\\ProjectConfig::traverseDataArray()`.\n- Added `craft\\helpers\\Typecast`. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- Added `craft\\i18n\\Translation`.\n- Added `craft\\imagetransforms\\ImageTransformer`.\n- Added `craft\\log\\ContextProcessor`.\n- Added `craft\\log\\Dispatcher::getTargets()`.\n- Added `craft\\log\\MessageProcessor`.\n- Added `craft\\log\\MonologTarget`.\n- Added `craft\\models\\AssetIndexingSession`.\n- Added `craft\\models\\FieldLayout::getElementsByType()`.\n- Added `craft\\models\\FieldLayout::getFirstElementByType()`.\n- Added `craft\\models\\FieldLayout::getFirstVisibleElementByType()`.\n- Added `craft\\models\\FieldLayout::getVisibleCustomFields()`.\n- Added `craft\\models\\FieldLayout::getVisibleElementsByType()`.\n- Added `craft\\models\\FieldLayoutElement::$uid`.\n- Added `craft\\models\\FieldLayoutElement::getLayout()` and `setLayout()`.\n- Added `craft\\models\\FieldLayoutForm::getVisibleElements()`.\n- Added `craft\\models\\FieldLayoutFormTab::getTabId()`.\n- Added `craft\\models\\FieldLayoutFormTab::getUid()`.\n- Added `craft\\models\\FieldLayoutTab::getElements()` and `setElements()`.\n- Added `craft\\models\\FsListing`.\n- Added `craft\\models\\ImageTransform`.\n- Added `craft\\models\\ImageTransformIndex`.\n- Added `craft\\models\\ProjectConfigData`.\n- Added `craft\\models\\ReadOnlyProjectConfigData`.\n- Added `craft\\models\\Volume`.\n- Added `craft\\queue\\jobs\\Proxy`.\n- Added `craft\\queue\\Queue::$proxyQueue`, which can be set to another queue configuration that all jobs should be sent to as proxies. ([#10999](https://github.com/craftcms/cms/pull/10999))\n- Added `craft\\records\\Address`.\n- Added `craft\\records\\AssetIndexingSession`.\n- Added `craft\\records\\ImageTransform`.\n- Added `craft\\services\\Addresses`.\n- Added `craft\\services\\AssetIndexer::createIndexingSession()`.\n- Added `craft\\services\\AssetIndexer::getExistingIndexingSessions()`.\n- Added `craft\\services\\AssetIndexer::getIndexingSessionById()`.\n- Added `craft\\services\\AssetIndexer::getMissingEntriesForSession()`.\n- Added `craft\\services\\AssetIndexer::getSkippedItemsForSession()`.\n- Added `craft\\services\\AssetIndexer::indexFileByListing()`.\n- Added `craft\\services\\AssetIndexer::indexFolderByEntry()`.\n- Added `craft\\services\\AssetIndexer::indexFolderByListing()`.\n- Added `craft\\services\\AssetIndexer::processIndexSession()`.\n- Added `craft\\services\\AssetIndexer::removeCliIndexingSessions()`.\n- Added `craft\\services\\AssetIndexer::startIndexingSession()`.\n- Added `craft\\services\\AssetIndexer::stopIndexingSession()`.\n- Added `craft\\services\\Assets::getImagePreviewUrl()`.\n- Added `craft\\services\\AssetTransforms::deleteTransformIndexDataByAssetIds()`.\n- Added `craft\\services\\Conditions`.\n- Added `craft\\services\\Config::CATEGORY_CUSTOM`.\n- Added `craft\\services\\Config::getCustom()`.\n- Added `craft\\services\\Drafts::removeDraftData()`.\n- Added `craft\\services\\ElementSources`, which replaces `craft\\services\\ElementIndexes`.\n- Added `craft\\services\\Fields::createLayout()`.\n- Added `craft\\services\\Fs`.\n- Added `craft\\services\\Gc::hardDeleteElements()`.\n- Added `craft\\services\\Gc::removeEmptyTempFolders()`.\n- Added `craft\\services\\Gql::prepareFieldDefinitions()`.\n- Added `craft\\services\\ImageTransforms`.\n- Added `craft\\services\\Matrix::createRevisionBlocks()`.\n- Added `craft\\services\\Matrix::duplicateOwnership()`.\n- Added `craft\\services\\ProjectConfig::ASSOC_KEY`.\n- Added `craft\\services\\ProjectConfig::PATH_DATE_MODIFIED`.\n- Added `craft\\services\\ProjectConfig::PATH_ELEMENT_SOURCES`.\n- Added `craft\\services\\ProjectConfig::PATH_FS`.\n- Added `craft\\services\\ProjectConfig::PATH_META_NAMES`.\n- Added `craft\\services\\ProjectConfig::PATH_SCHEMA_VERSION`.\n- Added `craft\\services\\ProjectConfig::PATH_SYSTEM`.\n- Added `craft\\services\\ProjectConfig::rememberAppliedChanges()`.\n- Added `craft\\services\\Users::deactivateUser()`.\n- Added `craft\\services\\Users::ensureUserByEmail()`, which will return a user for the given email, creating one if it didn\u2019t exist yet.\n- Added `craft\\services\\Users::EVENT_AFTER_DEACTIVATE_USER`.\n- Added `craft\\services\\Users::EVENT_BEFORE_DEACTIVATE_USER`.\n- Added `craft\\services\\Users::removeCredentials()`.\n- Added `craft\\services\\Volumes::getTemporaryVolume()`.\n- Added `craft\\services\\Volumes::getUserPhotoVolume()`.\n- Added `craft\\validators\\MoneyValidator`.\n- Added `craft\\web\\assets\\conditionbuilder\\ConditionBuilderAsset`.\n- Added `craft\\web\\assets\\htmx\\HtmxAsset`.\n- Added `craft\\web\\assets\\money\\MoneyAsset`.\n- Added `craft\\web\\Controller::asCpScreen()`.\n- Added `craft\\web\\Controller::asFailure()`.\n- Added `craft\\web\\Controller::asModelFailure()`.\n- Added `craft\\web\\Controller::asModelSuccess()`.\n- Added `craft\\web\\Controller::asSuccess()`.\n- Added `craft\\web\\Controller::CpScreenResponseBehavior()`.\n- Added `craft\\web\\Controller::CpScreenResponseFormatter()`.\n- Added `craft\\web\\Controller::getPostedRedirectUrl()`.\n- Added `craft\\web\\Controller::TemplateResponseBehavior()`.\n- Added `craft\\web\\Controller::TemplateResponseFormatter()`.\n- Added `craft\\web\\twig\\Extension::addressFilter()`.\n- Added `craft\\web\\twig\\Extension::moneyFilter()`.\n- Added `craft\\web\\twig\\variables\\Cp::fieldLayoutDesigner()`.\n- Added `craft\\web\\twig\\variables\\Cp::getFsOptions()`.\n- Added `craft\\web\\twig\\variables\\Cp::getVolumeOptions()`.\n- Added `craft\\web\\View::clearCssFileBuffer()`.\n- Added `craft\\web\\View::clearJsFileBuffer()`.\n- Added `craft\\web\\View::startCssFileBuffer()`.\n- Added `craft\\web\\View::startJsFileBuffer()`.\n- Added the `Craft.appendBodyHtml()` JavaScript method, which replaces the now-deprecated `appendFootHtml()` method.\n- Added the `Craft.CpScreenSlideout` JavaScript class, which can be used to create slideouts from actions that return `$this->asCpScreen()`.\n- Added the `Craft.ElementEditor` JavaScript class.\n- Added the `Craft.ElementEditorSlideout` JavaScript class.\n- Added the `Craft.getPageUrl()` JavaScript method.\n- Added the `Craft.getQueryParam()` JavaScript method.\n- Added the `Craft.getQueryParams()` JavaScript method.\n- Added the `Craft.namespaceId()` JavaScript method.\n- Added the `Craft.namespaceInputName()` JavaScript method.\n- Added the `Craft.Preview.refresh()` JavaScript method.\n- Added the `Craft.Queue` JavaScript class.\n- Added the `Craft.setElementAttributes()` JavaScript method.\n- Added the `Craft.setPath()` JavaScript method.\n- Added the `Craft.setQueryParam()` JavaScript method.\n- Added the `Craft.setUrl()` JavaScript method.\n- Added the `Craft.ui.createButton()` JavaScript method.\n- Added the `Craft.ui.createSubmitButton()` JavaScript method.\n- Added the `htmx.org` JavaScript library.\n- Added the commerceguys/addressing package.\n- Added the illuminate/collections package. ([#8475](https://github.com/craftcms/cms/discussions/8475))\n- Added the moneyphp/money package.\n- Added the symfony/var-dumper package.\n- Added the theiconic/name-parser package.\n- Added the yiisoft/yii2-symfonymailer package.\n\n### Changed\n- Craft now requires PHP 8.0.2 or later.\n- Craft now requires MySQL 5.7.8 / MariaDB 10.2.7 / PostgreSQL 10.0 or later.\n- Craft now requires the [Intl](https://php.net/manual/en/book.intl.php) and [BCMath](https://www.php.net/manual/en/book.bc.php) PHP extensions.\n- Improved draft creation/application performance. ([#10577](https://github.com/craftcms/cms/pull/10577))\n- Improved revision creation performance. ([#10589](https://github.com/craftcms/cms/pull/10577))\n- The \u201cWhat\u2019s New\u201d HUD now displays an icon and label above each announcement, identifying where it came from (Craft CMS or a plugin). ([#9747](https://github.com/craftcms/cms/discussions/9747))\n- The control panel now keeps track of the currently-edited site on a per-tab basis by adding a `site` query string param to all control panel URLs. ([#8920](https://github.com/craftcms/cms/discussions/8920))\n- Element index pages\u2019 status and sort menu option selections are now coded into the page URL via `status` and `sort` query string params. ([#10669](https://github.com/craftcms/cms/discussions/10669))\n- Users are no longer required to have a username or email.\n- Users can now set their Formatting Locale to any known locale; not just the available Language options. ([#10519](https://github.com/craftcms/cms/pull/10519))\n- Users\u2019 Language and Formatting Locale settings now display locale names in the current language and their native languages. ([#10519](https://github.com/craftcms/cms/pull/10519))\n- User queries now return all users by default, rather than only active users.\n- Filtering users by `active`, `pending`, and `locked` statuses no longer excludes suspended users.\n- `credentialed` and `inactive` are now reserved user group handles.\n- Elements throughout the control panel are now automatically updated whenever they\u2019re saved by another browser tab.\n- Assets fields that are restricted to a single location can now be configured to allow selection within subfolders of that location. ([#9070](https://github.com/craftcms/cms/discussions/9070))\n- When an image is saved as a new asset from the Image Editor via an Assets field, the Assets field will now automatically replace the selected asset with the new one. ([#8974](https://github.com/craftcms/cms/discussions/8974))\n- `alt` is now a reserved field handle for volume field layouts.\n- Volumes no longer have \u201ctypes\u201d, and their file operations are now delegated to a filesystem selected by an \u201cAsset Filesystem\u201d setting on the volume.\n- Volumes now have \u201cTransform Filesystem\u201d and \u201cTransform Subpath\u201d settings, which can be used to choose where image transforms should be stored. (The volume\u2019s Asset Filesystem will be used by default.)\n- Asset thumbnails are now generated as image transforms.\n- It\u2019s now possible to create volumes directly from the User Settings page.\n- Images that are not web-safe now are always converted to JPEGs when transforming, if no format was specified.\n- Entry post dates are no longer set automatically until the entry is validated with the `live` scenario. ([#10093](https://github.com/craftcms/cms/pull/10093))\n- Entry queries\u2019 `authorGroup()` param method now accepts an array of `craft\\models\\UserGroup` objects.\n- Element queries\u2019 `revision` params can now be set to `null` to include normal and revision elements.\n- Element queries can no longer be traversed or accessed like an array. Use a query execution method such as `all()`, `collect()`, or `one()` to fetch the results before working with them.\n- Element queries\u2019 `title` params no longer treat values with commas as arrays. ([#10891](https://github.com/craftcms/cms/issues/10891))\n- User queries\u2019 `firstName` and `lastName` params no longer treat values with commas as arrays. ([#10891](https://github.com/craftcms/cms/issues/10891))\n- Relational fields now load elements in the current site rather than the primary site, if the source element isn\u2019t localizable. ([#7048](https://github.com/craftcms/cms/issues/7048))\n- Lightswitch fields can no longer be marked as required within field layouts. ([#10773](https://github.com/craftcms/cms/issues/10773))\n- Built-in queue jobs are now always translated for the current user\u2019s language. ([#9745](https://github.com/craftcms/cms/pull/9745))\n- Path options passed to console commands (e.g. `--basePath`) now take precedence over their enivronment variable/PHP constant counterparts.\n- Database backups are now named after the Craft version in the database, rather than the Composer-installed version. ([#9733](https://github.com/craftcms/cms/discussions/9733))\n- Template autosuggestions now include their filename. ([#9744](https://github.com/craftcms/cms/pull/9744))\n- Improved the look of loading spinners in the control panel. ([#9109](https://github.com/craftcms/cms/discussions/9109))\n- The default `subLeft` and `subRight` search query term options are now only applied to terms that don\u2019t include an asterisk at the beginning/end, e.g. `hello*`. ([#10613](https://github.com/craftcms/cms/discussions/10613))\n- `{% cache %}` tags now store any external JavaScript or CSS files registered with `{% js %}` and `{% css %}` tags. ([#9987](https://github.com/craftcms/cms/discussions/9987))\n- All control panel templates end in `.twig` now. ([#9743](https://github.com/craftcms/cms/pull/9743))\n- 404 requests are no longer logged by default. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- Log entries are now single-line by default when Dev Mode is disabled. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- Log files are now rotated once every 24 hours. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- `CRAFT_STREAM_LOG` no longer logs _in addition to_ other log targets. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- The default log target no longer logs `debug` or `info` messages when Dev Mode is enabled. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- SQL query logs now use the `debug` log level, so they no longer get logged when Dev Mode is enabled. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- `yii\\db\\Connection::$enableLogging` and `$enableProfiling` are no longer enabled by default when Dev Mode is disabled. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- The `queue` log target no longer has special handling for Yii or `info` logs. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- A warning is now logged if an element query is executed before Craft is fully initialized. ([#11033](https://github.com/craftcms/cms/issues/11033))\n- A warning is now logged if Twig is instantiated before Craft is fully initialized. ([#11033](https://github.com/craftcms/cms/issues/11033))\n- Craft\u2019s bootstrap script now attempts to create its configured system paths automatically. ([#10562](https://github.com/craftcms/cms/pull/10562))\n- When using GraphQL to mutate entries, the `enabled` status is now affected on a per-site basis when specifying both the `enabled` and `siteId` parameters. ([#9771](https://github.com/craftcms/cms/issues/9771))\n- The `forms/selectize` control panel template now supports `addOptionFn` and `addOptionLabel` params, which can be set to add new options to the list.\n- Editable tables now support `allowAdd`, `allowDelete`, and `allowReorder` settings, replacing `staticRows`. ([#10163](https://github.com/craftcms/cms/pull/10163))\n- Column definitions passed to the `_includes/forms/editableTable` control panel template can now specify a `width` key. ([#11062](https://github.com/craftcms/cms/pull/11062))\n- The `limitField` macro in the `_components/fieldtypes/elementfieldsettings` control panel template has been renamed to `limitFields`.\n- Renamed the `elements/get-categories-input-html` action to `categories/input-html`.\n- Renamed the `elements/get-modal-body` action to `element-selector-modals/body`.\n- The `entries/save-entry` action now returns a 400 HTTP status for JSON responses when the entry couldn\u2019t be saved.\n- The `users/save-user` action no longer includes a `unverifiedEmail` key in failure responses.\n- The `users/set-password` action now returns a 400 HTTP status when an invalid token is passed, if there\u2019s no URL to redirect to. ([#10592](https://github.com/craftcms/cms/discussions/10592))\n- `install/*`, `setup/*`, `db/*`, and `help` actions no longer output a warning if Craft can\u2019t connect to the database. ([#10851](https://github.com/craftcms/cms/pull/10851))\n- `createFoldersInVolume:<uid>` user permissions have been renamed to `createFolders:<uid>`.\n- `deleteFilesAndFoldersInVolume:<uid>` user permissions have been renamed to `deleteAssets:<uid>`.\n- `deletePeerFilesInVolume:<uid>` user permissions have been renamed to `deletePeerAssets:<uid>`.\n- `editCategories:<uid>` user permissions have been split into `viewCategories:<uid>`, `saveCategories:<uid>`, `deleteCategories:<uid>`, `viewPeerCategoryDrafts:<uid>`, `savePeerCategoryDrafts:<uid>`, and `deletePeerCategoryDrafts:<uid>`.\n- `editEntries:<uid>` user permissions have been renamed to `viewEntries:<uid>`.\n- `editImagesInVolume:<uid>` user permissions have been renamed to `editImages:<uid>`.\n- `editPeerEntries:<uid>` user permissions have been renamed to `viewPeerEntries:<uid>`.\n- `editPeerEntryDrafts:<uid>` user permissions have been split into `viewPeerEntryDrafts:<uid>` and `savePeerEntryDrafts:<uid>`.\n- `editPeerFilesInVolume:<uid>` user permissions have been renamed to `savePeerAssets:<uid>`.\n- `editPeerImagesInVolume:<uid>` user permissions have been renamed to `editPeerImages:<uid>`.\n- `publishEntries:<uid>` user permissions have been renamed to `saveEntries:<uid>`, and no longer differentiate between enabled and disabled entries. (Users with `viewEntries:<uid>` permissions will still be able to create drafts.)\n- `publishPeerEntries:<uid>` user permissions have been renamed to `savePeerEntries:<uid>`, and no longer differentiate between enabled and disabled entries. (Users with `viewPeerEntries:<uid>` permissions will still be able to create drafts.)\n- `replaceFilesInVolume:<uid>` user permissions have been renamed to `replaceFiles:<uid>`.\n- `replacePeerFilesInVolume:<uid>` user permissions have been renamed to `replacePeerFiles:<uid>`.\n- `saveAssetInVolume:<uid>` user permissions have been renamed to `saveAssets:<uid>`.\n- `viewPeerFilesInVolume:<uid>` user permissions have been renamed to `viewPeerAssets:<uid>`.\n- `viewVolume:<uid>` user permissions have been renamed to `viewAssets:<uid>`.\n- Elements\u2019 `searchScore` GraphQL fields are now returned as integers.\n- Element types must now override `craft\\base\\Element::isDeletable()` if its elements should be deletable from the index page.\n- Element types\u2019 `cpEditUrl()` methods no longer need to add a `site` param; one will be added automatically by `craft\\base\\Element::getCpEditUrl()`.\n- Element types\u2019 `defineActions()` methods\u2019 `$source` arguments should no longer accept `null`.\n- Element types\u2019 `defineSources()` methods\u2019 `$context` arguments should no longer accept `null`.\n- Element types\u2019 `getHtmlAttributes()` and `htmlAttributes()` methods must now return attribute arrays that are compatible with `craft\\helpers\\Html::renderTagAttributes()`.\n- Element types\u2019 `sources()` methods\u2019 `$context` arguments should no longer accept `null`.\n- Element types\u2019 `tableAttributes()` and `defineTableAttributes()` methods should no longer return a generic attribute for defining the header column heading at the beginning of the returned array. The header column heading is now set to the element type\u2019s display name, per its `displayName()` method.\n- Block element types\u2019 `getOwner()` methods can now return `null`.\n- Control panel resource locations are now cached, so resource requests can be resolved when Craft isn\u2019t installed yet, or a database connection can\u2019t be established. ([#10642](https://github.com/craftcms/cms/pull/10642))\n- Control panel resources are now served with cache headers, if the `buildId` config setting is set. ([#10705](https://github.com/craftcms/cms/pull/10705))\n- Empty subfolders within the temporary upload volume are now removed during garbage collection. ([#10746](https://github.com/craftcms/cms/issues/10746))\n- Most config settings can now be overridden via environment variables. ([#10573](https://github.com/craftcms/cms/pull/10573), [#10869](https://github.com/craftcms/cms/pull/10869))\n- It\u2019s now possible to configure the Debug Toolbar to store its data files on a filesystem, rather than within `storage/runtime/debug/`. ([#10825](https://github.com/craftcms/cms/pull/10825))\n- `craft\\base\\AssetPreviewHandlerInterface::getPreviewHtml()` now accepts an optional array of variable to pass on to the template.\n- `craft\\base\\Element::__get()` now clones custom field values before returning them. ([#8781](https://github.com/craftcms/cms/discussions/8781))\n- `craft\\base\\Element::fieldLayoutFields()` now has a `visibleOnly` argument.\n- `craft\\base\\Element::getFieldValue()` now returns eager-loaded element values for the field, when they exist. ([#10047](https://github.com/craftcms/cms/issues/10047))\n- `craft\\base\\Element::metaFieldsHtml()` now has a `static` argument.\n- `craft\\base\\Element::setFieldValue()` now unsets any previously-eager-loaded elements for the field. ([#11003](https://github.com/craftcms/cms/discussions/11003))\n- `craft\\base\\Element::slugFieldHtml()` now has a `static` argument.\n- `craft\\base\\ElementInterface::getEagerLoadedElements()` now returns an `Illuminate\\Support\\Collection` object instead of an array. ([#8513](https://github.com/craftcms/cms/discussions/8513))\n- `craft\\base\\ElementInterface::getSidebarHtml()` now has a `static` argument.\n- `craft\\base\\MemoizableArray` no longer extends `ArrayObject`, and now implements `IteratorAggregate` and `Countable` directly.\n- `craft\\base\\Model::__construct()` and `setAttributes()` now automatically typecast values that map to properties with `int`, `float`, `int|float`, `string`, `bool`, `array`, or `DateTime` type declarations. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- `craft\\base\\Model::datetimeAttributes()` is now called from the constructor, instead of the `init()` method.\n- `craft\\base\\Model::setAttributes()` now normalizes date attributes into `DateTime` objects.\n- `craft\\behaviors\\FieldLayoutBehavior::getFields()` has been renamed to `getCustomFields()`.\n- `craft\\elements\\Asset::getImg()` now sets the `alt` attribute to the native Alternative Text field value, if set.\n- `craft\\elements\\Asset::getVolume()` now returns an instance of `craft\\models\\Volume`.\n- `craft\\elements\\db\\ElementQuery::ids()` no longer accepts an array of criteria params.\n- `craft\\events\\DraftEvent::$source` has been renamed to `$canonical`.\n- `craft\\events\\GetAssetThumbUrlEvent` has been renamed to `DefineAssetThumbUrlEvent`.\n- `craft\\events\\GetAssetUrlEvent` has been renamed to `DefineAssetUrlEvent`.\n- `craft\\events\\RevisionEvent::$source` has been renamed to `$canonical`.\n- `craft\\fieldlayoutelements\\AssetTitleField` has been renamed to `craft\\fieldlayoutelements\\assets\\AssetTitleField`.\n- `craft\\fieldlayoutelements\\EntryTitleField` has been renamed to `craft\\fieldlayoutelements\\entries\\EntryTitleField`.\n- `craft\\fieldlayoutelements\\StandardField` has been renamed to `craft\\fieldlayoutelements\\BaseNativeField`.\n- `craft\\fieldlayoutelements\\StandardTextField` has been renamed to `craft\\fieldlayoutelements\\TextField`.\n- `craft\\fields\\Assets::$singleUploadLocationSource` has been renamed to `$restrictedLocationSource`.\n- `craft\\fields\\Assets::$singleUploadLocationSubpath` has been renamed to `$restrictedLocationSubpath`.\n- `craft\\fields\\Assets::$useSingleFolder` has been renamed to `$restrictLocation`.\n- `craft\\fields\\BaseRelationField::$limit` has been renamed to `$maxRelations`.\n- `craft\\fields\\BaseRelationField::elementType()` is now public.\n- `craft\\fields\\BaseRelationField::inputSelectionCriteria()` has been renamed to `getInputSelectionCriteria()`, and is now public.\n- `craft\\fields\\BaseRelationField::inputSources()` has been renamed to `getInputSources()`, and is now public.\n- `craft\\gql\\directives\\FormatDateTime::defaultTimezone()` has been renamed to `defaultTimeZone()`.\n- `craft\\gql\\TypeManager::EVENT_DEFINE_GQL_TYPE_FIELDS` is now triggered when actually resolving fields for a GraphQL type, rather than when the type is first created. ([#9626](https://github.com/craftcms/cms/issues/9626))\n- `craft\\helpers\\App::env()` now checks for a PHP constant as well, if the environment variable didn\u2019t exist.\n- `craft\\helpers\\App::env()` now returns `null` if a value couldn\u2019t be found, rather than `false`.\n- `craft\\helpers\\App::env()` now returns a boolean if the original value was `'true'` or `'false'`.\n- `craft\\helpers\\App::env()` now returns an integer or float if the original value was numeric.\n- `craft\\helpers\\ArrayHelper::getValue()` now supports keys in square bracket syntax, e.g. `foo[bar][baz]`.\n- `craft\\helpers\\Assets::generateUrl()` no longer accepts a transform index for date modified comparisons. A `DateTime` object is expected instead.\n- `craft\\helpers\\Assets::urlAppendix()` no longer accepts a transform index for date modified comparisons. A `DateTime` object is expected instead.\n- `craft\\helpers\\Component::createComponent()` now automatically typecasts values that map to properties with `int`, `float`, `int|float`, `string`, `bool`, `array`, or `DateTime` type declarations. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- `craft\\helpers\\Cp::elementHtml()` now has an `$autoReload` argument.\n- `craft\\helpers\\Db::batchInsert()`, `craft\\helpers\\Db::insert()`, `craft\\db\\Command::batchInsert()`, `craft\\db\\Command::insert()`, `craft\\db\\Migration::batchInsert()`, and `craft\\db\\Migration::insert()` no longer have `$includeAuditColumns` arguments, and now check if the table has `dateCreated`, `dateUpdated`, and/or `uid` columns before setting their values.\n- `craft\\helpers\\Db::parseParam()` now validates that numeric values are passed if the `$columnType` is set to a numeric column type. ([#9142](https://github.com/craftcms/cms/issues/9142))\n- `craft\\helpers\\Db::prepareDateForDb()` no longer has a `$stripSeconds` argument.\n- `craft\\helpers\\Db::prepareValueForDb()` now has a `$columnType` argument.\n- `craft\\helpers\\Db::truncateTable()` now returns `void` rather than `int`.\n- `craft\\helpers\\Db::update()`, `craft\\helpers\\Db::upsert()`, `craft\\db\\Command::update()`, `craft\\db\\Command::upsert()`, `craft\\db\\Migration::update()`\u2019 and `craft\\db\\Migration::upsert()`\u2019 `$includeAuditColumns` arguments have been renamed to `$updateTimestamp`, and only affect the `dateCreated` column now. All upserts now check if the table has `dateCreated`, `dateUpdated`, and/or `uid` columns before setting their values.\n- `craft\\helpers\\Db::upsert()`, `craft\\db\\Command::upsert()`, and `craft\\db\\Migration()` no longer merge the `$updateColumns` array into `$insertColumns`. The full array of `INSERT` column values should be passed to `$insertColumns` now.\n- `craft\\helpers\\Gql::getUnionType()` no longer requires a resolver function to be passed, if the union contains only element GraphQL types.\n- `craft\\helpers\\Html::beginForm()` not sets `accept-charset=\"UTF-8\"` by default.\n- `craft\\helpers\\Html` now supports defining `hx-*` and `data-hx-*` attributes via a `hx` and `data-hx` keys, similar to `aria` and `data`.\n- `craft\\helpers\\i18n\\Formatter::asPercent()` now chooses a default `$decimals` value based on the value given, if `null`.\n- `craft\\helpers\\i18n\\Formatter::asPercent()` now treats all empty values as `0`.\n- `craft\\helpers\\MailerHelper::normalizeEmails()` now returns an empty array instead of `null`.\n- `craft\\helpers\\MigrationHelper::dropAllIndexesOnTable()` no longer returns an array of the dropped indexes.\n- `craft\\helpers\\Queue::push()` now has a `$queue` argument.\n- `craft\\models\\FieldLayout::EVENT_DEFINE_STANDARD_FIELDS` has been renamed to `EVENT_DEFINE_NATIVE_FIELDS`.\n- `craft\\models\\FieldLayout::getAvailableStandardFields()` has been renamed to `getAvailableNativeFields()`.\n- `craft\\models\\FieldLayout::getFields()` has been renamed to `getCustomFields()`.\n- `craft\\queue\\Queue::$channel` is now set automatically based on the queue\u2019s application component ID.\n- `craft\\services\\Announcements::push()` no longer accepts callables to be passed to the `$heading` and `$body` arguments. `craft\\i18n\\Translation::prep()` should be used to prepare the messages to be lazy-translated instead.\n- `craft\\services\\AssetIndexer::storeIndexList()` now expects the first argument to be a generator that returns `craft\\models\\FsListing` objects.\n- `craft\\services\\Assets::ensureFolderByFullPathAndVolume()` now returns a `craft\\models\\VolumeFolder` object rather than a folder ID.\n- `craft\\services\\Assets::ensureTopFolder()` now returns a `craft\\models\\VolumeFolder` object rather than a folder ID.\n- `craft\\services\\Assets::EVENT_GET_ASSET_THUMB_URL` has been renamed to `EVENT_DEFINE_THUMB_URL`.\n- `craft\\services\\Assets::EVENT_GET_ASSET_URL` has been moved to `craft\\elements\\Asset::EVENT_DEFINE_URL`.\n- `craft\\services\\AssetTransforms::CONFIG_TRANSFORM_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_IMAGE_TRANSFORMS`.\n- `craft\\services\\Categories::CONFIG_CATEGORYROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_CATEGORY_GROUPS`.\n- `craft\\services\\Fields::CONFIG_FIELDGROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_FIELD_GROUPS`.\n- `craft\\services\\Fields::CONFIG_FIELDS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_FIELDS`.\n- `craft\\services\\Globals::CONFIG_GLOBALSETS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GLOBAL_SETS`.\n- `craft\\services\\Gql::CONFIG_GQL_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GRAPHQL`.\n- `craft\\services\\Gql::CONFIG_GQL_PUBLIC_TOKEN_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GRAPHQL_PUBLIC_TOKEN`.\n- `craft\\services\\Gql::CONFIG_GQL_SCHEMAS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GRAPHQL_SCHEMAS`.\n- `craft\\services\\Matrix::CONFIG_BLOCKTYPE_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_MATRIX_BLOCK_TYPES`.\n- `craft\\services\\Matrix::duplicateBlocks()` now has a `$deleteOtherBlocks` argument.\n- `craft\\services\\Plugins::CONFIG_PLUGINS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_PLUGINS`.\n- `craft\\services\\Plugins::doesPluginRequireDatabaseUpdate()` has been renamed to `isPluginUpdatePending()`.\n- `craft\\services\\ProjectConfig::applyYamlChanges()` has been renamed to `applyExternalChanges()`.\n- `craft\\services\\ProjectConfig::getDoesYamlExist()` has been renamed to `getDoesExternalConfigExist()`.\n- `craft\\services\\ProjectConfig::getIsApplyingYamlChanges()` has been renamed to `getIsApplyingExternalChanges()`.\n- `craft\\services\\ProjectConfig::set()` now returns `true` or `false` depending on whether the project config was modified.\n- `craft\\services\\Revisions::createRevision()` now returns the ID of the revision, rather than the revision itself.\n- `craft\\services\\Routes::CONFIG_ROUTES_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_ROUTES`.\n- `craft\\services\\Sections::CONFIG_ENTRYTYPES_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_ENTRY_TYPES`.\n- `craft\\services\\Sections::CONFIG_SECTIONS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_PATH_SECTIONS`.\n- `craft\\services\\Sites::CONFIG_SITEGROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_SITE_GROUPS`.\n- `craft\\services\\Sites::CONFIG_SITES_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_SITES`.\n- `craft\\services\\Tags::CONFIG_TAGGROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_TAG_GROUPS`.\n- `craft\\services\\Updates::getIsCraftDbMigrationNeeded()` has been renamed to `getIsCraftUpdatePending()`.\n- `craft\\services\\Updates::getIsPluginDbUpdateNeeded()` has been renamed to `getIsPluginUpdatePending()`.\n- `craft\\services\\UserGroups::CONFIG_USERPGROUPS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_USER_GROUPS`.\n- `craft\\services\\UserPermissions::getAllPermissions()` and `getAssignablePermissions()` now return permission groups as arrays with `heading` and `permission` sub-keys, fixing a bug where two groups with the same heading would conflict with each other. ([#7771](https://github.com/craftcms/cms/issues/7771))\n- `craft\\services\\Users::CONFIG_USERLAYOUT_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_USER_FIELD_LAYOUTS`.\n- `craft\\services\\Users::CONFIG_USERS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_USERS`.\n- `craft\\services\\Volumes::CONFIG_VOLUME_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_VOLUMES`.\n- `craft\\test\\fixtures\\elements\\BaseElementFixture` now validates elements with the `live` scenario if they are enabled, canonical, and not a provisional draft.\n- `craft\\test\\TestSetup::getMockApp()` has been renamed to `getMockModule()`, and its `$appClass` argument has been renamed to `$moduleClass`.\n- `craft\\web\\Request::getBodyParam()` now accepts nested param names in the `foo[bar][baz]` format.\n- `craft\\web\\Request::getBodyParams()` and `getBodyParam()` now check for an `X-Craft-Namespace` header. If present, only params that begin with its value will be returned, excluding the namespace.\n- `craft\\web\\View::renderString()` now has an `$escapeHtml` argument.\n- `craft\\web\\View::setNamespace()`\u2019 `$namespace` argument no longer has a default value of `null`.\n- The `Craft.getUrl()` JavaScript method now removes duplicate query string params when passing in a param that\u2019s already included in the base URL.\n- The `Craft.getUrl()` JavaScript method now encodes any query string params passed to it.\n- `Craft.broadcastChannel` has been split up into two broadcast channels: `Craft.broadcaster` and `Craft.messageReceiver`.\n- `Craft.cp.$tabs` now returns a collection of the tabs\u2019 `<a>` elements, as they no longer have wrapping `<li>` elements.\n- Local volumes no longer use Flysystem.\n- A selected volume for user photo storage if no longer displayed if no volume has been set.\n- The user photo volume can now only be set to a volume that has a public transform filesystem configured.\n- Craft now uses Symfony Mailer to send email. ([#10062](https://github.com/craftcms/cms/discussions/10062))\n- Updated Twig to 3.3.\n- Updated vue-autosuggest to 2.2.0.\n\n### Deprecated\n- Deprecated the `autosaveDrafts` config setting.\n- Deprecated the `anyStatus` element query param. `status(null)` should be used instead.\n- Deprecated the `immediately` argument for transforms created over GraphQL. It no longer has any effect.\n- Deprecated `craft\\base\\ApplicationTrait::getInstalledSchemaVersion()`.\n- Deprecated `craft\\base\\Model::datetimeAttributes()`. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- Deprecated `craft\\elements\\User::getFullName()`. `$fullName` should be used instead.\n- Deprecated `craft\\gql\\TypeManager::flush()`. `craft\\services\\Gql::flushCaches()` should be used instead.\n- Deprecated `craft\\gql\\TypeManager::prepareFieldDefinitions()`. `craft\\services\\Gql::prepareFieldDefinitions()` should be used instead.\n- Deprecated `craft\\helpers\\ArrayHelper::append()`. `array_unshift()` should be used instead.\n- Deprecated `craft\\helpers\\ArrayHelper::prepend()`. `array_push()` should be used instead.\n- Deprecated `craft\\helpers\\MigrationHelper`.\n- Deprecated `craft\\i18n\\I18N::getIsIntlLoaded()`.\n- Deprecated `craft\\services\\Assets::getAssetUrl()`. `craft\\elements\\Asset::getUrl()` should be used instead.\n- Deprecated `craft\\services\\Assets::getIconPath()`. `craft\\helpers\\Assets::iconPath()` should be used instead.\n- Deprecated `craft\\web\\Controller::asErrorJson()`. `asFailure()` should be used instead.\n- Deprecated the `assets/save-asset` action. `elements/save` should be used instead.\n- Deprecated the `categories/save-category` action. `elements/save` should be used instead.\n- Deprecated the `Craft.appendFootHtml()` JavaScript method. `appendBodyHtml()` should be used instead.\n\n### Removed\n- Removed the \u201cHeader Column Heading\u201d element source setting.\n- Removed support for setting custom config settings from `config/general.php`. `config/custom.php` should be used instead. ([#10012](https://github.com/craftcms/cms/issues/10012))\n- Removed the `customAsciiCharMappings` config setting.\n- Removed the `siteName` config setting. Environment-specific site names can be defined via environment variables.\n- Removed the `siteUrl` config setting. Environment-specific site URLs can be defined via environment variables.\n- Removed the `suppressTemplateErrors` config setting.\n- Removed the `useCompressedJs` config setting.\n- Removed the `useProjectConfigFile` config setting. Override `craft\\services\\ProjectConfig::$writeYamlAutomatically` to opt into [manual YAML file generation](https://craftcms.com/docs/4.x/project-config.html#manual-yaml-file-generation).\n- Removed support for `config/volumes.php`. Volumes can now specify per-environment filesystems.\n- Removed support for the `CRAFT_SITE_URL` PHP constant. Environment-specific site URLs can be defined via environment variables.\n- Removed the `enabledForSite` GraphQL argument. `status` should be used instead.\n- Removed the `{% includeHiResCss %}` Twig tag.\n- Removed support for deprecated `DateTime` faux Twig methods `atom()`, `cookie()`, `iso8601()`, `rfc822()`, `rfc850()`, `rfc1036()`, `rfc1123()`, `rfc2822()`, `rfc3339()`, `rss()`, `w3c()`, `w3cDate()`, `mySqlDateTime()`, `localeDate()`, `localeTime()`, `year()`, `month()`, `day()`, `nice()`, and `uiTimestamp()`.\n- Removed the `locale` element property. `siteId` should be used instead.\n- Removed the `ownerLocale` Matrix block query param. `site` or `siteId` should be used instead.\n- Removed support for `sourceLocale` in `relatedTo` element query params. `sourceSite` should be used instead.\n- Removed the `craft.categoryGroups` Twig variable.\n- Removed the `craft.config` Twig variable.\n- Removed the `craft.deprecator` Twig variable.\n- Removed the `craft.elementIndexes` Twig variable.\n- Removed the `craft.emailMessages` Twig variable.\n- Removed the `craft.feeds` Twig variable.\n- Removed the `craft.fields` Twig variable.\n- Removed the `craft.globals` Twig variable.\n- Removed the `craft.i18n` Twig variable.\n- Removed the `craft.request` Twig variable.\n- Removed the `craft.sections` Twig variable.\n- Removed the `craft.session` Twig variable.\n- Removed the `craft.systemSettings` Twig variable.\n- Removed the `craft.userGroups` Twig variable.\n- Removed the `craft.userPermissions` Twig variable.\n- Removed the `assignUserGroups` user permission, which authorized users to assign other users to their own groups. Authorization must now be explicitly granted for each group. ([#10422](https://github.com/craftcms/cms/issues/10422))\n- Removed the `customizeSources` user permission. Only admins can customize element sources now, and only from an environment that allows admin changes.\n- Removed the `publishPeerEntryDrafts:<uid>` permissions, as they were pointless. (If a user is authorized to save an entry and view other users\u2019 drafts of it, there\u2019s nothing stopping them from making the same changes themselves.)\n- Removed the `assets/edit-asset` action.\n- Removed the `assets/thumb` action.\n- Removed the `categories/edit-category` action.\n- Removed the `categories/preview-category` action.\n- Removed the `categories/share-category` action.\n- Removed the `categories/view-shared-category` action.\n- Removed the `dashboard/get-feed-items` action.\n- Removed the `elements/get-editor-html` action.\n- Removed the `entries/switch-entry-type` action.\n- Removed `craft\\base\\ApplicationTrait::getEntryRevisions()`.\n- Removed `craft\\base\\ApplicationTrait::getFeed()`.\n- Removed `craft\\base\\Element::ATTR_STATUS_CONFLICTED`.\n- Removed `craft\\base\\Element::getHasFreshContent()`. `getIsFresh()` should be used instead.\n- Removed `craft\\base\\ElementInterface::getEditorHtml()`. Element edit forms are now exclusively driven by their field layout.\n- Removed `craft\\base\\FieldLayoutElementInterface`.\n- Removed `craft\\base\\FlysystemVolume`.\n- Removed `craft\\base\\LocalVolumeInterface`.\n- Removed `craft\\base\\Volume`.\n- Removed `craft\\base\\VolumeInterface`.\n- Removed `craft\\base\\VolumeTrait`.\n- Removed `craft\\behaviors\\FieldLayoutBehavior::setFields()`.\n- Removed `craft\\config\\DbConfig::updateDsn()`.\n- Removed `craft\\console\\Request::getIsSingleActionRequest()`.\n- Removed `craft\\controllers\\AssetTransformsController`.\n- Removed `craft\\controllers\\BaseUpdaterController::ACTION_COMPOSER_OPTIMIZE`.\n- Removed `craft\\controllers\\BaseUpdaterController::actionComposerOptimize()`.\n- Removed `craft\\controllers\\Drafts`.\n- Removed `craft\\controllers\\ElementIndexesController::$paginated`.\n- Removed `craft\\controllers\\EntriesController::EVENT_PREVIEW_ENTRY`.\n- Removed `craft\\controllers\\UtilitiesController::actionAssetIndexPerformAction()`.\n- Removed `craft\\db\\Connection::trimObjectName()`.\n- Removed `craft\\db\\Table::ASSETTRANSFORMINDEX`.\n- Removed `craft\\db\\Table::ASSETTRANSFORMS`.\n- Removed `craft\\elements\\actions\\SetStatus::$allowDisabledForSite`.\n- Removed `craft\\elements\\actions\\SetStatus::DISABLED_FOR_SITE`.\n- Removed `craft\\elements\\actions\\SetStatus::DISABLED_GLOBALLY`.\n- Removed `craft\\elements\\Asset::getSupportsPreview()`.\n- Removed `craft\\elements\\Asset::getTransformSource()`.\n- Removed `craft\\elements\\Asset::setTransformSource()`.\n- Removed `craft\\elements\\db\\ElementQuery::getIterator()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetExists()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetGet()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetSet()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetUnset()`.\n- Removed `craft\\elements\\User::mergePreferences()`.\n- Removed `craft\\errors\\AssetTransformException`.\n- Removed `craft\\errors\\FieldNotFoundException`.\n- Removed `craft\\errors\\InvalidVolumeException`.\n- Removed `craft\\errors\\MissingVolumeFolderException`.\n- Removed `craft\\errors\\VolumeException`.\n- Removed `craft\\errors\\VolumeObjectExistsException`.\n- Removed `craft\\errors\\VolumeObjectNotFoundException`.\n- Removed `craft\\events\\AssetTransformEvent`.\n- Removed `craft\\events\\AssetTransformImageEvent`.\n- Removed `craft\\events\\DefineComponentsEvent`.\n- Removed `craft\\events\\GenerateTransformEvent::$image`.\n- Removed `craft\\events\\GenerateTransformEvent::$tempPath`.\n- Removed `craft\\events\\GetAssetThumbEvent`.\n- Removed `craft\\events\\GetAssetThumbUrlEvent::$generate`.\n- Removed `craft\\events\\GetAssetThumbUrlEvent::$size`.\n- Removed `craft\\events\\GlobalSetContentEvent`.\n- Removed `craft\\events\\RegisterGqlPermissionsEvent`.\n- Removed `craft\\events\\SearchEvent::getElementIds()`.\n- Removed `craft\\events\\SearchEvent::setElementIds()`.\n- Removed `craft\\feeds\\Feeds`.\n- Removed `craft\\feeds\\GuzzleClient`.\n- Removed `craft\\fields\\BaseOptionsField::optionLabel()`.\n- Removed `craft\\fields\\Url::$placeholder`.\n- Removed `craft\\gql\\base\\Resolver::extractEagerLoadCondition()`.\n- Removed `craft\\gql\\base\\Resolver::getArrayableArguments()`.\n- Removed `craft\\gql\\base\\Resolver::prepareArguments()`.\n- Removed `craft\\helpers\\App::dbMutexConfig()`.\n- Removed `craft\\helpers\\App::getDefaultLogTargets()`.\n- Removed `craft\\helpers\\App::logConfig()`.\n- Removed `craft\\helpers\\Cp::editElementTitles()`.\n- Removed `craft\\helpers\\Localization::localeData()`.\n- Removed `craft\\helpers\\Stringy`.\n- Removed `craft\\i18n\\Locale::setDateTimeFormats()`.\n- Removed `craft\\log\\FileTarget`.\n- Removed `craft\\log\\StreamLogTarget`.\n- Removed `craft\\models\\AssetTransform`.\n- Removed `craft\\models\\AssetTransformIndex`.\n- Removed `craft\\models\\BaseEntryRevisionModel`.\n- Removed `craft\\models\\EntryDraft`.\n- Removed `craft\\models\\EntryVersion`.\n- Removed `craft\\models\\FieldLayout::setFields()`.\n- Removed `craft\\models\\FieldLayoutTab::getFields()`.\n- Removed `craft\\models\\Site::$originalBaseUrl`.\n- Removed `craft\\models\\Site::$originalName`.\n- Removed `craft\\models\\Site::overrideBaseUrl()`.\n- Removed `craft\\models\\Site::overrideName()`.\n- Removed `craft\\models\\VolumeListing`.\n- Removed `craft\\mutex\\DbMutexTrait`.\n- Removed `craft\\mutex\\FileMutex`.\n- Removed `craft\\mutex\\MysqlMutex`.\n- Removed `craft\\mutex\\PgsqlMutex`.\n- Removed `craft\\mutex\\PrefixedMutexTrait`.\n- Removed `craft\\queue\\jobs\\DeleteStaleTemplateCaches`.\n- Removed `craft\\records\\AssetTransform`.\n- Removed `craft\\records\\MatrixBlockType::$validateUniques`.\n- Removed `craft\\services\\AssetIndexer::deleteStaleIndexingData()`.\n- Removed `craft\\services\\AssetIndexer::extractFolderItemsFromIndexList()`.\n- Removed `craft\\services\\AssetIndexer::extractSkippedItemsFromIndexList()`.\n- Removed `craft\\services\\AssetIndexer::getIndexingSessionId()`.\n- Removed `craft\\services\\AssetIndexer::getMissingFiles()`.\n- Removed `craft\\services\\AssetIndexer::prepareIndexList()`.\n- Removed `craft\\services\\AssetIndexer::processIndexForVolume()`.\n- Removed `craft\\services\\Assets::$generatePendingTransformsViaQueue`.\n- Removed `craft\\services\\Assets::EVENT_GET_ASSET_THUMB_URL`.\n- Removed `craft\\services\\Assets::EVENT_GET_THUMB_PATH`.\n- Removed `craft\\services\\Assets::getThumbPath()`.\n- Removed `craft\\services\\AssetTransforms`.\n- Removed `craft\\services\\Composer::$disablePackagist`.\n- Removed `craft\\services\\Composer::optimize()`.\n- Removed `craft\\services\\Content::getContentRow()`.\n- Removed `craft\\services\\Content::populateElementContent()`.\n- Removed `craft\\services\\Drafts::EVENT_AFTER_MERGE_SOURCE_CHANGES`.\n- Removed `craft\\services\\Drafts::EVENT_AFTER_PUBLISH_DRAFT`.\n- Removed `craft\\services\\Drafts::EVENT_BEFORE_MERGE_SOURCE_CHANGES`.\n- Removed `craft\\services\\Drafts::EVENT_BEFORE_PUBLISH_DRAFT`.\n- Removed `craft\\services\\Drafts::publishDraft()`.\n- Removed `craft\\services\\EntryRevisions`.\n- Removed `craft\\services\\Fields::assembleLayout()`.\n- Removed `craft\\services\\Fields::getFieldIdsByLayoutId()`.\n- Removed `craft\\services\\Fields::getFieldsByElementType()`.\n- Removed `craft\\services\\Fields::getFieldsByLayoutId()`.\n- Removed `craft\\services\\Gql::getAllPermissions()`.\n- Removed `craft\\services\\Path::getAssetThumbsPath()`.\n- Removed `craft\\services\\ProjectConfig::CONFIG_ALL_KEY`.\n- Removed `craft\\services\\ProjectConfig::CONFIG_ALL_KEY`.\n- Removed `craft\\services\\ProjectConfig::CONFIG_KEY`.\n- Removed `craft\\services\\Sections::isSectionTemplateValid()`.\n- Removed `craft\\services\\SystemSettings`.\n- Removed `craft\\services\\TemplateCaches::deleteCacheById()`.\n- Removed `craft\\services\\TemplateCaches::deleteCachesByKey()`.\n- Removed `craft\\services\\TemplateCaches::deleteExpiredCaches()`.\n- Removed `craft\\services\\TemplateCaches::deleteExpiredCachesIfOverdue()`.\n- Removed `craft\\services\\TemplateCaches::EVENT_AFTER_DELETE_CACHES`.\n- Removed `craft\\services\\TemplateCaches::EVENT_BEFORE_DELETE_CACHES`.\n- Removed `craft\\services\\TemplateCaches::handleResponse()`.\n- Removed `craft\\services\\TemplateCaches::handleResponse()`.\n- Removed `craft\\services\\TemplateCaches::includeElementInTemplateCaches()`.\n- Removed `craft\\services\\TemplateCaches::includeElementQueryInTemplateCaches()`.\n- Removed `craft\\services\\Volumes::createVolume()`.\n- Removed `craft\\services\\Volumes::EVENT_REGISTER_VOLUME_TYPES`.\n- Removed `craft\\services\\Volumes::getAllVolumeTypes()`.\n- Removed `craft\\services\\Volumes::getVolumeOverrides()`.\n- Removed `craft\\volumes\\Local`.\n- Removed `craft\\volumes\\MissingVolume`.\n- Removed `craft\\volumes\\Temp`.\n- Removed `craft\\web\\AssetBundle::useCompressedJs()`.\n- Removed `craft\\web\\AssetManager::getPublishedPath()`.\n- Removed `craft\\web\\Request::getIsSingleActionRequest()`.\n- Removed `craft\\web\\twig\\Template`.\n- Removed `craft\\web\\twig\\variables\\CategoryGroups`.\n- Removed `craft\\web\\twig\\variables\\Config`.\n- Removed `craft\\web\\twig\\variables\\Deprecator`.\n- Removed `craft\\web\\twig\\variables\\ElementIndexes`.\n- Removed `craft\\web\\twig\\variables\\EmailMessages`.\n- Removed `craft\\web\\twig\\variables\\Feeds`.\n- Removed `craft\\web\\twig\\variables\\Fields`.\n- Removed `craft\\web\\twig\\variables\\Globals`.\n- Removed `craft\\web\\twig\\variables\\I18N`.\n- Removed `craft\\web\\twig\\variables\\Request`.\n- Removed `craft\\web\\twig\\variables\\Sections`.\n- Removed `craft\\web\\twig\\variables\\SystemSettings`.\n- Removed `craft\\web\\twig\\variables\\UserGroups`.\n- Removed `craft\\web\\twig\\variables\\UserPermissions`.\n- Removed `craft\\web\\twig\\variables\\UserSession`.\n- Removed `craft\\web\\User::destroyDebugPreferencesInSession()`.\n- Removed `craft\\web\\User::saveDebugPreferencesToSession()`.\n- Removed `craft\\web\\View::$minifyCss`.\n- Removed `craft\\web\\View::$minifyJs`.\n- Removed `craft\\web\\View::registerHiResCss()`.\n- Removed `craft\\web\\View::renderTemplateMacro()`.\n- Removed the `_layouts/element` control panel template.\n- Removed the `assets/_edit` control panel template.\n- Removed the `categories/_edit` control panel template.\n- Removed the `entries/_edit` control panel template.\n- Removed the `cp.assets.edit.content` control panel template hook.\n- Removed the `cp.assets.edit.details` control panel template hook.\n- Removed the `cp.assets.edit.meta` control panel template hook.\n- Removed the `cp.assets.edit.settings` control panel template hook.\n- Removed the `cp.assets.edit` control panel template hook.\n- Removed the `cp.categories.edit.content` control panel template hook.\n- Removed the `cp.categories.edit.details` control panel template hook.\n- Removed the `cp.categories.edit.meta` control panel template hook.\n- Removed the `cp.categories.edit.settings` control panel template hook.\n- Removed the `cp.categories.edit` control panel template hook.\n- Removed the `cp.elements.edit` control panel template hook.\n- Removed the `cp.entries.edit.content` control panel template hook.\n- Removed the `cp.entries.edit.details` control panel template hook.\n- Removed the `cp.entries.edit.meta` control panel template hook.\n- Removed the `cp.entries.edit.settings` control panel template hook.\n- Removed the `cp.entries.edit` control panel template hook.\n- Removed the `Craft.AssetEditor` JavaScript class.\n- Removed the `Craft.BaseElementEditor` JavaScript class.\n- Removed the `Craft.DraftEditor` JavaScript class.\n- Removed the `Craft.queueActionRequest()` JavaScript method. `Craft.queue.push()` can be used instead.\n- Removed the Flysystem package. The `craftcms/flysystem-adapter` package now provides a base Flysystem adapter class.\n- Removed the laminas-feed package.\n- Removed the yii2-swiftmailer package.\n\n### Fixed\n- Fixed a bug where pending project config changes in the YAML would get applied when other project config changes were made. ([#9660](https://github.com/craftcms/cms/issues/9660))\n- Fixed a bug where revisions weren\u2019t getting propagated when a section was enabled for new sites, or its Propagation Method was changed. ([#10634](https://github.com/craftcms/cms/issues/10634))\n\n### Security\n- Generated control panel URLs now begin with the `@web` alias value if the `baseCpUrl` config setting isn\u2019t defined.\n- HTML entities output within email body text are now escaped by default in HTML email bodies.\n", "{% import \"_includes/links\" as links %}\n\n{% macro resourceLink(config) %}\n    <a href=\"{{ config.link }}\" target=\"_blank\" rel=\"noopener\">\n        <h4 class=\"cs-resource-heading\">\n            <img class=\"cs-logo-image\" src=\"{{ config.bundleUrl }}{{ config.iconPath }}\" alt=\"{{ config.title }}\">\n        </h4>\n        <p>{{ config.description }} {{ links.externalLinkIcon() }}</p>\n    </a>\n{% endmacro %}\n\n{% macro screen(widget, showBackupOption, bundleUrl, screen, placeholder, resultsIcon, resultsHeading, formAction, submitText) %}\n    {% import \"_includes/forms\" as forms %}\n    {% set idPrefix = 'cs-'~screen~random() %}\n\n    <div id=\"cs-screen-{{ screen }}\" class=\"cs-screen cs-screen-2 cs-screen-{{ screen }}\" action=\"{{ formAction }}\" method=\"get\" target=\"_blank\" rel=\"noopener\">\n        {{ tag('h2', {\n            text: submitText,\n        }) }}\n        {{ forms.textareaField({\n            first: true,\n            class: 'cs-body-text',\n            label: placeholder|t('app'),\n            rows: 5\n        }) }}\n        <div class=\"cs-search-results-container hidden\">\n            <div class=\"cs-search-icon\">{{ svg(resultsIcon, sanitize=false) }}</div>\n            <h2>{{ resultsHeading }}</h2>\n            <ul class=\"cs-search-results\"></ul>\n        </div>\n        <div class=\"cs-forms\">\n            <form class=\"cs-search-form\" action=\"{{ formAction }}\" method=\"get\" target=\"_blank\" rel=\"noopener\">\n                <div class=\"cs-search-params\"></div>\n                {% tag 'div' with { class: 'cs-button-wrapper' }%}\n                    <button type=\"submit\" class=\"btn submit fullwidth disabled\">{{ submitText }}</button>\n                    {% if CraftEdition == CraftPro %}\n                        <p>{{ \"or <a>send to Developer Support</a>\"|t('app')|raw }}</p>\n                    {% endif %}\n                    {{ tag('button', {\n                        class: 'btn fullwidth cancel',\n                        type: 'button',\n                        text: 'Cancel'|t('app'),\n                    }) }}\n                {% endtag %}\n                <hr>\n                <h3 class=\"cs-more-resources-heading\">{{ 'More Resources'|t('app') }}</h3>\n                <div class=\"cs-logo-resources\">\n                    {{ _self.resourceLink({\n                        link: 'https://craftcms.com/partners',\n                        iconPath: '/logos/craft-partners.svg',\n                        title: 'Craft Partners',\n                        description: 'Find an official Craft Partner'|t('app'),\n                        bundleUrl: bundleUrl,\n                    }) }}\n                    {{ _self.resourceLink({\n                        link: 'https://craftcms.com/discord',\n                        iconPath: '/logos/discord.svg',\n                        title: 'Discord',\n                        description: 'Meet the Craft community'|t('app'),\n                        bundleUrl: bundleUrl,\n                    }) }}\n                    {{ _self.resourceLink({\n                        link: 'https://craftquest.io',\n                        iconPath: '/logos/craftquest.svg',\n                        title: 'CraftQuest',\n                        description: 'Unlimited video training'|t('app'),\n                        bundleUrl: bundleUrl,\n                    }) }}\n                </div>\n                <div class=\"cs-icon-resources\">\n                    {% set documentationLinkHtml %}\n                        {{ svg('@appicons/book.svg')|attr({ 'aria-hidden': 'true' }) }}\n                        <span>{{ 'Documentation'|t('app') }}</span>\n                    {% endset %}\n                    {% set knowledgeBaseLinkHtml %}\n                        {{ svg('@appicons/magnifying-glass.svg', namespace=true)|attr({ 'aria-hidden': 'true' }) }}\n                        <span>{{ 'Knowledge Base'|t('app') }}</span>\n                    {% endset %}\n                    {{ links.externalLink({\n                        link: 'https://craftcms.com/docs/4.x/',\n                        text: documentationLinkHtml\n                    }) }}\n                    {{ links.externalLink({\n                        link: 'https://craftcms.com/knowledge-base',\n                        text: knowledgeBaseLinkHtml\n                    }) }}\n                </div>\n            </form>\n            <form class=\"cs-support-form hidden\" action=\"{{ actionUrl('dashboard/send-support-request') }}\" method=\"post\" target=\"{{ idPrefix }}-iframe\" accept-charset=\"UTF-8\" enctype=\"multipart/form-data\">\n                {{ csrfInput() }}\n                {{ hiddenInput('widgetId', widget.id) }}\n                {{ hiddenInput('message', '', {class: 'cs-support-message'}) }}\n\n                {% set email = currentUser.email %}\n                {% if email in ['support@pixelandtonic.com', 'support@craftcms.com'] %}\n                    {% set email = '' %}\n                {% endif %}\n\n                {{ forms.textField({\n                    first: true,\n                    label: \"Your Email\"|t('app'),\n                    name: 'fromEmail',\n                    value: email\n                }) }}\n\n                <a class=\"fieldtoggle\" data-target=\"{{ idPrefix }}-support-more\">{{ \"More\"|t('app') }}</a>\n\n                <div id=\"{{ idPrefix }}-support-more\" class=\"cs-support-more hidden\">\n                    <fieldset>\n                        {{ forms.checkboxField({\n                            label: 'Attach error logs'|t('app'),\n                            name: 'attachLogs',\n                            checked: true\n                        }) }}\n\n                        {% if showBackupOption %}\n                            {{ forms.checkboxField({\n                                label: 'Attach a database backup'|t('app'),\n                                name: 'attachDbBackup',\n                                checked: true\n                            }) }}\n                        {% endif %}\n\n                        {{ forms.checkboxField({\n                            name: 'attachTemplates',\n                            checked: true,\n                            label: 'Include your template files'|t('app'),\n                        }) }}\n                    </fieldset>\n\n                    {{ forms.fileField({\n                        label: 'Attach an additional file'|t('app'),\n                        class: 'cs-support-attachment',\n                        name: 'attachAdditionalFile',\n                    }) }}\n                </div>\n\n                {{ forms.submitButton({\n                    class: ['fullwidth', 'disabled'],\n                    label: 'Send'|t('app'),\n                    spinner: true,\n                }) }}\n            </form>\n        </div>\n        <iframe id=\"{{ idPrefix }}-iframe\" name=\"{{ idPrefix }}-iframe\" class=\"hidden\"></iframe>\n    </div>\n{% endmacro %}\n\n{% from _self import screen %}\n\n\n<div class=\"cs-screen cs-screen-home\">\n    <button type=\"button\" class=\"cs-opt\" data-screen=\"help\" aria-controls=\"cs-screen-help\" aria-expanded=\"false\">\n        <div class=\"cs-opt-icon\">{{ svg(buoeyIcon, sanitize=false)|attr({ 'aria-hidden': 'true' }) }}</div>\n        <h2>{{ \"Get help\"|t('app') }}</h2>\n        <p>{{ \"How-to\u2019s and other questions\"|t('app') }}</p>\n    </button>\n    <button type=\"button\" class=\"cs-opt\" data-screen=\"feedback\" aria-controls=\"cs-screen-feedback\" aria-expanded=\"false\">\n        <div class=\"cs-opt-icon\">{{ svg(bullhornIcon, sanitize=false)|attr({ 'aria-hidden': 'true' }) }}</div>\n        <h2>{{ \"Give feedback\"|t('app') }}</h2>\n        <p>{{ \"Bug reports and feature requests\"|t('app') }}</p>\n    </button>\n</div>\n\n{{ screen(widget, showBackupOption, bundleUrl, 'help', \"Briefly describe your question.\"|t('app'), seIcon, \"Similar questions on Stack Exchange\"|t('app'), 'https://craftcms.stackexchange.com/questions/ask', \"Ask on Stack Exchange\"|t('app')) }}\n\n{{ screen(widget, showBackupOption, bundleUrl, 'feedback', \"Briefly describe your issue or idea.\"|t('app'), ghIcon, \"Similar issues on GitHub\"|t('app'), 'https://github.com/craftcms/cms/issues/new', \"Post on GitHub\"|t('app')) }}\n", "{% macro externalLinkIcon() %}\n    {{ tag('span', {\n        'data-icon': 'external',\n        'role': 'img',\n        'aria-label': 'Opens in a new window'|t('app'),\n    }) }}\n{% endmacro %}\n\n{% macro externalLink(config) %}\n    {% set linkAttributes = {\n        href: config.link,\n        target: '_blank',\n        rel: 'noopener',\n        html: config.text ~ _self.externalLinkIcon()\n    } %}\n    {{ tag('a', linkAttributes) }}\n{% endmacro %}"], "fixing_code": ["# Release Notes for Craft CMS 4\n\n## Unreleased\n\n- Content tab menus now reveal when a tab contains validation errors, and invalid tabs\u2019 menu options get the same warning icon treatment as inline tabs do. ([#12971](https://github.com/craftcms/cms/issues/12971))\n- Selectize menus now expand upwards when there\u2019s not ample space below them. ([#12976](https://github.com/craftcms/cms/issues/12976))\n- Element index bulk action spinners are now centered on the viewport. ([#12972](https://github.com/craftcms/cms/issues/12972))\n- Fixed a bug where Assets fields weren\u2019t respecting their View Mode setting when viewing entry revisions. ([#12948](https://github.com/craftcms/cms/issues/12948))\n- Fixed a bug where asset pagination was broken when there was more than 100 subfolders. ([#12969](https://github.com/craftcms/cms/issues/12969))\n- Fixed a bug where entry index pages\u2019 \u201cRevision Notes\u201d and \u201cLast Edited By\u201d columns weren\u2019t getting populated for disabled entries. ([#12981](https://github.com/craftcms/cms/issues/12981))\n- Fixed a bug where assets were getting relocated to the root volume folder when renamed. ([#12995](https://github.com/craftcms/cms/issues/12995))\n- Fixed a bug where it wasn\u2019t possible to preview entries on another domain when the system was offline. ([#12979](https://github.com/craftcms/cms/issues/12979))\n- Fixed a bug where `craft\\helpers\\FileHelper::absolutePath()` wasn\u2019t treating Windows file paths beginning drive letters as absolute. ([craftcms/generator#16](https://github.com/craftcms/generator/issues/16))\n- Fixed a bug where it wasn\u2019t possible to sort Categories fields with \u201cMaintain hierarchy\u201d disabled. ([#10560](https://github.com/craftcms/cms/discussions/10560))\n- Fixed a bug where selectize inputs didn\u2019t have a minimum width. ([#12950](https://github.com/craftcms/cms/issues/12950))\n- Fixed a bug where the wrong tab would appear to be initially selected after an autosave, if the selected tab had changed during the autosave. ([#12960](https://github.com/craftcms/cms/issues/12960))\n- Fixed a bug where it wasn\u2019t possible to add a Dropdown field without a blank option to a global set. ([#12965](https://github.com/craftcms/cms/issues/12965))\n- Fixed a bug where automatically-added Matrix blocks (per the field\u2019s Min Blocks setting) were getting discarded if no changes were made to them. ([#12973](https://github.com/craftcms/cms/issues/12973))\n- Fixed an error that could occur when installing Craft with an existing project config, if any image transforms were defined that didn\u2019t specify the `upscale` property.\n- Fixed a bug where nested folders in asset search results weren\u2019t showing their relative path.\n- Fixed XSS vulnerabilities.\n\n## 4.4.5 - 2023-03-21\n\n- Fixed a bug where relation data was getting deleted when running garbage collection on PostgreSQL. ([#9905](https://github.com/craftcms/cms/issues/9905))\n- Fixed a bug where Lightswitch fields\u2019 \u201cOFF Label\u201d and \u201cON Label\u201d settings weren\u2019t getting translated. ([#12942](https://github.com/craftcms/cms/issues/12942))\n- Fixed a bug where `craft\\events\\DefineUserContentSummaryEvent::$userId` was never set for `craft\\controllers\\EVENT_DEFINE_CONTENT_SUMMARY` events. ([#12944](https://github.com/craftcms/cms/issues/12944))\n- Fixed a bug where element edit pages weren\u2019t displaying layout tabs that didn\u2019t have a unique name. ([#12928](https://github.com/craftcms/cms/issues/12928))\n- Fixed a bug where the `CRAFT_LOG_PHP_ERRORS` constant/environment variable wasn\u2019t being respected when set to `false`. ([#12862](https://github.com/craftcms/cms/issues/12862))\n- Fixed a bug where the `entrify/categories` command wasn\u2019t converting disabled categories. ([#12945](https://github.com/craftcms/cms/issues/12945))\n- Updated svg-sanitizer to 0.16. ([#12943](https://github.com/craftcms/cms/issues/12943))\n\n## 4.4.4 - 2023-03-20\n\n- Input autofocussing has been reintroduced throughout the control panel. ([#12921](https://github.com/craftcms/cms/discussions/12921))\n- The `|json_encode` Twig filter now calls `craft\\helpers\\Json::encode()` internally, improving error handling. ([#12919](https://github.com/craftcms/cms/issues/12919))\n- `craft\\helpers\\Json::encode()` no longer sets the `JSON_UNESCAPED_SLASHES` flag by default.\n- Fixed a JavaScript error that occurred when resolving an asset move conflict. ([#12920](https://github.com/craftcms/cms/issues/12920))\n- Fixed a bug where volume subfolders were being shown when viewing soft-deleted assets. ([#12927](https://github.com/craftcms/cms/issues/12927))\n- Fixed a bug where structure data was getting deleted when running garbage collection on PostgreSQL. ([#12925](https://github.com/craftcms/cms/issues/12925))\n- Fixed an error that could occur when rebuilding the project config, if there were any custom source definitions for element types that weren\u2019t Composer-installed. ([#12881](https://github.com/craftcms/cms/issues/12881))\n- Fixed an XSS vulnerability.\n\n## 4.4.3 - 2023-03-16\n\n- Customize Sources modals no longer hide when the <kbd>Esc</kbd> key is pressed on the surrounding area is clicked on. ([#12895](https://github.com/craftcms/cms/issues/12895))\n- Sections created via `entrify` commands no longer get a \u201cPrimary entry page\u201d preview target by default, unless it was sourced from a category group with URLs. ([#12897](https://github.com/craftcms/cms/issues/12897))\n- `entrify` commands and the `sections/create` command now prompt for the initial entry type name and handle. ([#12894](https://github.com/craftcms/cms/discussions/12894))\n- Added `craft\\helpers\\FileHelper::uniqueName()`.\n- Added `craft\\helpers\\StringHelper::emojiToShortcodes()`.\n- Added `craft\\helpers\\StringHelper::shortcodesToEmoji()`.\n- Fixed an error that occurred when uploading an asset with a filename over 250 characters long. ([#12889](https://github.com/craftcms/cms/issues/12889))\n- Fixed an error that could occur when preparing licensing alerts, if any licenses were invalid. ([#12899](https://github.com/craftcms/cms/issues/12899))\n- Fixed a bug where it wasn\u2019t possible to drag nested Neo blocks. ([#12896](https://github.com/craftcms/cms/issues/12896))\n- Fixed a bug where fields with reduced widths in Matrix blocks were becoming full-width while dragged. ([#12909](https://github.com/craftcms/cms/issues/12909))\n- Fixed a bug where multi-edition plugins weren\u2019t showing their edition labels within the Plugin Store cart. ([#12910](https://github.com/craftcms/cms/issues/12910))\n- Fixed a bug where private plugins\u2019 control panel templates weren\u2019t directly accessible by URL.\n- Fixed a bug where element selector modals were persisting parts of their state in the query string. ([#12900](https://github.com/craftcms/cms/issues/12900))\n- Fixed a PHP error that occurred if a field type stored enum values. ([#12297](https://github.com/craftcms/cms/issues/12297))\n- Fixed an error that could occur when generating transforms for images stored in Google Cloud Storage. ([#12878](https://github.com/craftcms/cms/issues/12878))\n- Fixed a bug where some unicode characters were getting removed by LitEmoji. ([#12905](https://github.com/craftcms/cms/issues/12905))\n\n## 4.4.2 - 2023-03-14\n\n- The `entrify/categories` and `entrify/global-set` commands now update user permissions for the new sections. ([#12849](https://github.com/craftcms/cms/discussions/12849))\n- Variable dumps now use a light theme for web requests by default. ([#12857](https://github.com/craftcms/cms/pull/12857))\n- Added the `dumper` application component and `craft\\base\\ApplicationTrait::getDumper()`. ([#12869](https://github.com/craftcms/cms/pull/12869))\n- Added `craft\\models\\ImageTransform::getConfig()`.\n- Fixed a bug where it wasn\u2019t always possible to access entry or category edit pages if the `slugWordSeparator` config setting was set to `/`. ([#12871](https://github.com/craftcms/cms/issues/12871))\n- Fixed a bug where `craft\\helpers\\Html::parseTagAttribute()` wasn\u2019t decoding attribute values, which could lead to double-encoded attributes, e.g. when using the `|attr` filter. ([#12887](https://github.com/craftcms/cms/issues/12887))\n- Fixed a bug where multi-value field inputs would be considered modified even if they weren\u2019t, if the field type\u2019s `isValueEmpty()` method returned `true`. ([#12858](https://github.com/craftcms/cms/issues/12858))\n- Fixed a bug where asset thumbnails within secondary slideout tabs weren\u2019t loading immediately. ([#12859](https://github.com/craftcms/cms/issues/12859))\n- Fixed a bug where rebuilding the project config would lose track of image transforms\u2019 `fill` and `upscale` settings. ([#12879](https://github.com/craftcms/cms/issues/12879))\n- Fixed a bug where blank Dropdown options weren\u2019t showing up in the Selectize menu. ([#12880](https://github.com/craftcms/cms/issues/12880))\n- Fixed a bug where it was possible to save a Dropdown field without a value, even if the field didn\u2019t have any blank options. ([#12880](https://github.com/craftcms/cms/issues/12880))\n- Fixed a bug where element action triggers weren\u2019t centered for element sources that don\u2019t define any exporters. ([#12885](https://github.com/craftcms/cms/issues/12885))\n- Fixed an error that could occur when generating a transform URL for an image in the temp folder.\n- Fixed XSS vulnerabilities.\n- Fixed an SSRF vulnerability.\n\n## 4.4.1 - 2023-03-09\n\n- Fixed a bug where it wasn\u2019t possible to select subfolders on the Assets index page. ([#12802](https://github.com/craftcms/cms/issues/12802))\n- Fixed a bug where element index search inputs were losing focus when the element listing was updated. ([#12846](https://github.com/craftcms/cms/issues/12846))\n- Fixed a bug where the database driver was being referenced as \u201cMySQL\u201d when using MariaDB. ([#12827](https://github.com/craftcms/cms/issues/12827))\n- Fixed a bug where users weren\u2019t able to select assets within Assets fields, if they didn\u2019t have full permissions for the volume. ([#12851](https://github.com/craftcms/cms/issues/12851))\n- Fixed a bug where the Assets index page\u2019s URL would get updated incorrectly when renaming a subfolder.\n- Fixed a bug where non-admin users weren\u2019t able to view Single section entries. ([#12838](https://github.com/craftcms/cms/issues/12838))\n- Fixed an error that could occur when saving an element with eager-loaded relations. ([#12839](https://github.com/craftcms/cms/issues/12839))\n- Fixed a bug where Customize Sources modals weren\u2019t showing source headings with no subsequent sources. ([#12840](https://github.com/craftcms/cms/issues/12840))\n- Fixed a bug where `entrify` commands could leave the database and project config data in inconsistent states, if aborted prematurely. ([#12850](https://github.com/craftcms/cms/pull/12850))\n- Fixed a bug where the `entrify/global-set` command wasn\u2019t always suggesting the command to run on other environments.\n- Fixed a bug where the Assets index page would appear to keep loading indefinitely after renaming a subfolder.\n- Fixed a bug where folders within asset indexes were getting the current site name appended to them, on multi-site installs. ([#12852](https://github.com/craftcms/cms/issues/12852))\n- Fixed a SQL error that could occur when updating to Craft 4.4 on PostgreSQL. ([#12855](https://github.com/craftcms/cms/issues/12855))\n- Added `craft\\db\\Connection::getDriverLabel()`.\n\n## 4.4.0 - 2023-03-08\n\n### Content Management\n- Volume subfolders are now displayed within the element listing pane on asset indexes, rather than as nested sources in the sidebar. ([#12558](https://github.com/craftcms/cms/pull/12558), [#9171](https://github.com/craftcms/cms/discussions/9171), [#5809](https://github.com/craftcms/cms/issues/5809))\n- Asset indexes now display the current subfolder path above the element listing. ([#12558](https://github.com/craftcms/cms/pull/12558))\n- Assets and folders can now be drag-and-dropped simultaneously. ([#12792](https://github.com/craftcms/cms/pull/12792))\n- Reduced the likelihood of accidentally triggering an asset drag operation. ([#12792](https://github.com/craftcms/cms/pull/12792))\n- Reduced the likelihood of accidentally dropping dragged assets/folders on an unintended target. ([#12792](https://github.com/craftcms/cms/pull/12792))\n- It\u2019s now possible to move volume folders and assets to a new location via a new \u201cMove\u2026\u201d bulk element action, rather than via drag-and-drop interactions. ([#12558](https://github.com/craftcms/cms/pull/12558))\n- It\u2019s now possible to sort asset indexes by image width and height. ([#12653](https://github.com/craftcms/cms/pull/12653))\n- Structured element index sources now have a dedicated view mode option for showing elements as a structured table. ([#12722](https://github.com/craftcms/cms/pull/12722), [#12718](https://github.com/craftcms/cms/discussions/12718))\n- Entry and category indexes can now have \u201cAncestors\u201d and \u201cParent\u201d columns. ([#12666](https://github.com/craftcms/cms/discussions/12666))\n- All element sources now have a \u201cDuplicate\u201d action, even if the element type\u2019s `defineActions()` method didn\u2019t include one. ([#12382](https://github.com/craftcms/cms/discussions/12382))\n- Element index pages now track the search term in a query param, so the results can be shared. ([#8942](https://github.com/craftcms/cms/discussions/8942), [#12399](https://github.com/craftcms/cms/pull/12399))\n- Entries with more than 10 revisions now include a \u201cView all revisions\u201d item within their revision menu, which links to a new revisions index page for the entry that paginates through all its revisions. ([#8609](https://github.com/craftcms/cms/discussions/8609))\n- Entries and Categories fields now have \u201cMaintain hierarchy\u201d settings, which become available when a single structured source is selected. ([#8522](https://github.com/craftcms/cms/discussions/8522), [#8748](https://github.com/craftcms/cms/discussions/8748), [#10560](https://github.com/craftcms/cms/discussions/10560), [#11749](https://github.com/craftcms/cms/pull/11749))\n- Entries fields now have a \u201cBranch Limit\u201d setting, which becomes available when \u201cMaintain hierarchy\u201d is enabled, replacing \u201cMin Relations\u201d and \u201cMax Relations\u201d.\n- Categories fields now have \u201cMin Relations\u201d and \u201cMax Relations\u201d settings, which become available when \u201cMaintain hierarchy\u201d is disabled, replacing \u201cBranch Limit\u201d.\n- Added \u201cViewable\u201d asset and entry condition rules. ([#12240](https://github.com/craftcms/cms/discussions/12240), [#12266](https://github.com/craftcms/cms/pull/12266))\n- Renamed the \u201cEditable\u201d asset and entry condition rules to \u201cSavable\u201d. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Assets, categories, and entries will now redirect to the last-selected source on their index pages when saved. ([#11996](https://github.com/craftcms/cms/discussions/11996))\n- Dropdown fields that don\u2019t have a blank option and are missing a value will now include and select a blank option at the beginning of their menu. ([#12235](https://github.com/craftcms/cms/discussions/12235))\n- Tip and Warning field layout UI elements can now be marked as dismissible, giving authors the ability to hide them. ([#12188](https://github.com/craftcms/cms/discussions/12188))\n- All assets now get thumbnails in the control panel, even if they don\u2019t have a transform filesystem with a base URL. ([#12531](https://github.com/craftcms/cms/issues/12531))\n- Dropdown and Multi-select fields now use Selectize. ([#8403](https://github.com/craftcms/cms/discussions/8403))\n- Improved the styling of bulk element action triggers. ([#12793](https://github.com/craftcms/cms/pull/12793))\n\n### Accessibility\n- Improved the announcement menu for screen readers. ([#12361](https://github.com/craftcms/cms/pull/12361))\n- Improved keyboard control of the Updates utility. ([#12189](https://github.com/craftcms/cms/pull/12189))\n- Improved the color contrast and keyboard control of the Customize Sources modal. ([#12233](https://github.com/craftcms/cms/pull/12233))\n- Improved info icons for screen readers. ([#12272](https://github.com/craftcms/cms/pull/12272))\n- Removed input autofocussing throughout the control panel. ([#12324](https://github.com/craftcms/cms/discussions/12324), [#12332](https://github.com/craftcms/cms/pull/12332), [#12406](https://github.com/craftcms/cms/pull/12406))\n- Improved the login screen for screen readers. ([#12386](https://github.com/craftcms/cms/pull/12386))\n- Improved _conditional_ and _required_ field indicators for screen readers. ([#12509](https://github.com/craftcms/cms/pull/12509))\n- Improved element index pages for screen readers. ([#12731](https://github.com/craftcms/cms/pull/12731))\n- Improved bulk element action triggers on element index pages. ([#12415](https://github.com/craftcms/cms/pull/12415))\n- Improved the color contrast of element indexes. ([#12213](https://github.com/craftcms/cms/pull/12213))\n- Asset preview modals now show videos\u2019 alt text. ([#12637](https://github.com/craftcms/cms/pull/12637))\n- Improved element indexes\u2019 \u201cExport\u201d buttons for screen readers. ([#12754](https://github.com/craftcms/cms/pull/12754))\n- Improved Quick Post widgets\u2019 \u201cFields\u201d settings for screen readers. ([#12772](https://github.com/craftcms/cms/pull/12772))\n- Improved some element selector modals for screen readers. ([#12783](https://github.com/craftcms/cms/pull/12783))\n- Fixed a bug where it wasn\u2019t possible to vertically scroll element index filter HUDs. ([#12751](https://github.com/craftcms/cms/pull/12751))\n- Fixed a bug where translated locale names within users\u2019 \u201cLanguage\u201d and \u201cFormatting Locale\u201d preference menus didn\u2019t have `lang` attributes. ([#12773](https://github.com/craftcms/cms/pull/12773))\n- Fixed a bug where search icons on element indexes weren\u2019t hidden from screen readers. ([#12785](https://github.com/craftcms/cms/pull/12785))\n\n### Administration\n- Most licensing isuses are now consolidated into a single control panel alert, with a button to resolve them all with a single purchase on Craft Console. ([#12768](https://github.com/craftcms/cms/pull/12768))\n- Conditional layout components are now identified using a condition icon within field layout designers. ([#12250](https://github.com/craftcms/cms/issues/12250))\n- All CLI commands now support an `--isolated` option, which ensures the command is run in isolation. ([#12337](https://github.com/craftcms/cms/discussions/12337), [#12350](https://github.com/craftcms/cms/pull/12350))\n- Added the `entrify/categories`, `entrify/tags`, and `entrify/global-set` commands, for converting categories, tags, and global sets to entries. ([#12689](https://github.com/craftcms/cms/pull/12689), [#9781](https://github.com/craftcms/cms/discussions/9781))\n- Added the `sections/create` and `sections/delete` commands. ([#12689](https://github.com/craftcms/cms/pull/12689))\n- The `plugin/install`, `plugin/uninstall`, `plugin/enable`, and `plugin/disabled` commands now support an `--all` option, which applies the action to all applicable Composer-installed plugins. ([#11373](https://github.com/craftcms/cms/discussions/11373), [#12218](https://github.com/craftcms/cms/pull/12218))\n- The `project-config/apply` command now supports a `--quiet` option, which reduces the command output. ([#12568](https://github.com/craftcms/cms/discussions/12568))\n- Added the `users/unlock` console command. ([#12345](https://github.com/craftcms/cms/discussions/12345))\n- The Asset Indexes utility no longer skips volumes if the root folder was completely empty. ([#12585](https://github.com/craftcms/cms/issues/12585), [#12604](https://github.com/craftcms/cms/pull/12604))\n- The Asset Indexes utility now has a \u201cList empty folders\u201d setting, which determines whether empty folders sholud be listed for deletion from the index. ([#12604](https://github.com/craftcms/cms/pull/12604))\n- The Asset Indexes utility now lists missing/empty folders and files separately in the review screen. ([#12604](https://github.com/craftcms/cms/pull/12604))\n- Relational condition rules for conditions that are saved to the project config now accept a Twig template which outputs a related element ID dynamically. ([#12679](https://github.com/craftcms/cms/pull/12679), [#12676](https://github.com/craftcms/cms/discussions/12676))\n- Image transform settings no longer show the \u201cDefault Focal Point\u201d setting when Mode is set to \u201cFit\u201d, as the setting had no effect. ([#12774](https://github.com/craftcms/cms/pull/12774))\n- Improved the CLI output for `index-assets` commands. ([#12604](https://github.com/craftcms/cms/pull/12604))\n\n### Development\n- Added the \u201cLetterbox\u201d (`letterbox`) image transform mode. ([#8848](https://github.com/craftcms/cms/discussions/8848), [#12214](https://github.com/craftcms/cms/pull/12214))\n- Added the `preloadSingles` config setting, which causes front-end Twig templates to automatically preload Single section entries which are referenced in the template. ([#12698](https://github.com/craftcms/cms/pull/12787))\n- Control panel-defined image transforms now have an \u201cAllow Upscaling\u201d setting, which will initially be set to the `upscaleImages` config setting for existing transforms. ([#12214](https://github.com/craftcms/cms/pull/12214))\n- Template-defined image transforms can now have an `upscale` setting. The `upscaleImages` config setting will be used by default if not set. ([#12214](https://github.com/craftcms/cms/pull/12214))\n- Added the `exec` command, which executes an individual PHP statement and outputs the result. ([#12528](https://github.com/craftcms/cms/pull/12528))\n- Added the `editable` and `savable` asset query params. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added the `savable` entry query param. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- The `editable` entry query param can now be set to `false` to only show entries that _can\u2019t_ be viewed by the current user. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added the `{% dump %}` tag, which dumps variables into a new \u201cDumps\u201d Debug Toolbar panel. ([#12506](https://github.com/craftcms/cms/pull/12506))\n- Added the `base64_decode` and `base64_encode` Twig filters. ([#12696](https://github.com/craftcms/cms/discussions/12696))\n- The `dump()` Twig function now utilizes `Craft::dump()`, and no longer requires Dev Mode to be active. ([#12486](https://github.com/craftcms/cms/pull/12486), [#12479](https://github.com/craftcms/cms/discussions/12479))\n- The `{% dd %}` Twig tag can now output the entire `context` array, if no variable is passed to it. ([#12486](https://github.com/craftcms/cms/pull/12486))\n- Added the `revisionNotes` field to elements queried via GraphQL. ([#12610](https://github.com/craftcms/cms/issues/12610))\n- Added `ancestors` and `descendants` fields to categories queried via GraphQL. ([#12427](https://github.com/craftcms/cms/issues/12427))\n- Added `craft\\elements\\Asset::getFormat()` and the `format` field for assets queried via GraphQL. ([#12398](https://github.com/craftcms/cms/pull/12398), [#12521](https://github.com/craftcms/cms/pull/12521))\n- `Craft::dump()`, `Craft::dd()`, the `dump()` Twig function, and the `{% dd %}` Twig tag now use Symfony\u2019s VarDumper. ([#12479](https://github.com/craftcms/cms/discussions/12479))\n- `Craft::dump()` now has a `$return` argument, which will cause the resulting dump to be returned as a string rather than output, if `true`.\n- `craft\\elements\\Asset::getMimeType()` now has a `$transform` argument, and assets\u2019 `mimeType` GraphQL fields now support a `@transform` directive. ([#12269](https://github.com/craftcms/cms/discussions/12269), [#12397](https://github.com/craftcms/cms/pull/12397), [#12522](https://github.com/craftcms/cms/pull/12522))\n- `craft\\helpers\\App::env()` now returns `null` if the original value was `'null'`. ([#12742](https://github.com/craftcms/cms/pull/12742))\n- `craft\\helpers\\Db::escapeParam()` now escapes `:empty:` and `:notempty:` strings. ([#12691](https://github.com/craftcms/cms/discussions/12691))\n\n### Extensibility\n- Added support for private plugins. ([#12716](https://github.com/craftcms/cms/pull/12716), [#8908](https://github.com/craftcms/cms/discussions/8908))\n- Added the `elements/revisions` action. ([#12211](https://github.com/craftcms/cms/pull/12211))\n- Console controllers that directly use `craft\\console\\ControllerTrait` no longer need to call `$this->checkTty()` or `$this->checkRootUser()` themselves; they are now called from `ControllerTrait::init()` and `beforeAction()`.\n- Element source definitions can now include a `defaultSourcePath` key.\n- Element custom field validation now respects the list of attributes passed to `validate()`.\n- Improving IDE autocompletion for chained query param calls. ([#12656](https://github.com/craftcms/cms/pull/12656))\n- Added `craft\\base\\ApplicationTrait::getEditionHandle()`.\n- Added `craft\\base\\BaseFsInterface`. ([#12709](https://github.com/craftcms/cms/pull/12709))\n- Added `craft\\base\\Batchable`.\n- Added `craft\\base\\Element::cpRevisionsUrl()`.\n- Added `craft\\base\\Element::indexElements()`.\n- Added `craft\\base\\ElementInterface::findSource()`.\n- Added `craft\\base\\ElementInterface::getCpRevisionsUrl()`.\n- Added `craft\\base\\ElementInterface::getUiLabelPath()`.\n- Added `craft\\base\\ElementInterface::indexElementCount()`.\n- Added `craft\\base\\ElementInterface::setUiLabelPath()`.\n- Added `craft\\base\\Event`, which provides a `once()` static method for registering an event handler that will only be triggered up to one time.\n- Added `craft\\console\\ControllerTrait::beforeAction()`.\n- Added `craft\\console\\ControllerTrait::failure()`.\n- Added `craft\\console\\ControllerTrait::init()`.\n- Added `craft\\console\\ControllerTrait::markdownToAnsi()`.\n- Added `craft\\console\\ControllerTrait::note()`.\n- Added `craft\\console\\ControllerTrait::options()`.\n- Added `craft\\console\\ControllerTrait::runAction()`.\n- Added `craft\\console\\ControllerTrait::success()`.\n- Added `craft\\console\\ControllerTrait::tip()`.\n- Added `craft\\console\\ControllerTrait::warning()`.\n- Added `craft\\db\\QueryBatcher`.\n- Added `craft\\debug\\DumpPanel`.\n- Added `craft\\elements\\conditions\\assets\\ViewableConditionRule`. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added `craft\\elements\\conditions\\ElementCondition::$referenceElement`.\n- Added `craft\\elements\\conditions\\entries\\ViewableConditionRule`. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Added `craft\\elements\\Entry::EVENT_DEFINE_PARENT_SELECTION_CRITERIA`. ([#12475](https://github.com/craftcms/cms/discussions/12475))\n- Added `craft\\events\\DefineInputOptionsEvent`. ([#12351](https://github.com/craftcms/cms/pull/12351))\n- Added `craft\\events\\ListVolumesEvent`.\n- Added `craft\\events\\UserPhotoEvent`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\fields\\BaseOptionsField::EVENT_DEFINE_OPTIONS`. ([#12351](https://github.com/craftcms/cms/pull/12351))\n- Added `craft\\fields\\BaseRelationField::$branchLimit`.\n- Added `craft\\fields\\BaseRelationField::$maintainHierarchy`.\n- Added `craft\\helpers\\Db::rawTableShortName()`.\n- Added `craft\\helpers\\ImageTransforms::generateTransform()`.\n- Added `craft\\helpers\\ImageTransforms::parseTransformString()`.\n- Added `craft\\helpers\\StringHelper::toHandle()`.\n- Added `craft\\helpers\\Template::fallback()`.\n- Added `craft\\helpers\\Template::fallbackExists()`.\n- Added `craft\\helpers\\Template::preloadSingles()`.\n- Added `craft\\image\\Raster::scaleToFitAndFill()`.\n- Added `craft\\image\\Raster::setFill()`.\n- Added `craft\\imagetransforms\\FallbackTransformer`.\n- Added `craft\\models\\CategoryGroup::$dateDeleted`.\n- Added `craft\\models\\ImageTransform::$fill`.\n- Added `craft\\models\\ImageTransform::$upscale`.\n- Added `craft\\models\\TagGroup::$dateDeleted`.\n- Added `craft\\models\\VolumeFolder::getHasChildren()`.\n- Added `craft\\models\\VolumeFolder::setHasChildren()`.\n- Added `craft\\queue\\BaseBatchedJob`. ([#12638](https://github.com/craftcms/cms/pull/12638))\n- Added `craft\\queue\\jobs\\GenerateImageTransform`. ([#12340](https://github.com/craftcms/cms/pull/12340))\n- Added `craft\\services\\Assets::createFolderQuery()`.\n- Added `craft\\services\\Assets::foldersExist()`.\n- Added `craft\\services\\Elements::deleteElementForSite()`.\n- Added `craft\\services\\Elements::deleteElementsForSite()`.\n- Added `craft\\services\\Elements::EVENT_AFTER_DELETE_FOR_SITE`. ([#12354](https://github.com/craftcms/cms/issues/12354))\n- Added `craft\\services\\Elements::EVENT_BEFORE_DELETE_FOR_SITE`. ([#12354](https://github.com/craftcms/cms/issues/12354))\n- Added `craft\\services\\Entries::getSingleEntriesByHandle()`. ([#12698](https://github.com/craftcms/cms/pull/12787))\n- Added `craft\\services\\Fields::getFieldsByType()`. ([#12381](https://github.com/craftcms/cms/discussions/12381))\n- Added `craft\\services\\Path::getImageTransformsPath()`.\n- Added `craft\\services\\Search::normalizeSearchQuery()`.\n- Added `craft\\services\\Users::EVENT_AFTER_DELETE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\services\\Users::EVENT_AFTER_SAVE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\services\\Users::EVENT_BEFORE_DELETE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\services\\Users::EVENT_BEFORE_SAVE_USER_PHOTO`. ([#12360](https://github.com/craftcms/cms/pull/12360))\n- Added `craft\\utilities\\AssetIndexes::EVENT_LIST_VOLUMES`. ([#12383](https://github.com/craftcms/cms/pull/12383), [#12443](https://github.com/craftcms/cms/pull/12443))\n- Renamed `craft\\elements\\conditions\\assets\\EditableConditionRule` to `SavableConditionRule`, while preserving the original class name with an alias. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- Renamed `craft\\elements\\conditions\\entries\\EditableConditionRule` to `SavableConditionRule`, while preserving the original class name with an alias. ([#12266](https://github.com/craftcms/cms/pull/12266))\n- `craft\\services\\AssetIndexer::startIndexingSession()` and `createIndexingSession()` now have a `$listEmptyFolders` argument. ([#12604](https://github.com/craftcms/cms/pull/12604))\n- `craft\\base\\ElementQuery::joinElementTable()` now accepts table names in the format of `{{%tablename}}`.\n- `craft\\models\\Volume` now implements `craft\\base\\BaseFsInterface`. ([#12709](https://github.com/craftcms/cms/pull/12709))\n- `craft\\services\\Categories::getGroupByHandle()` now has a `$withTrashed` argument.\n- `craft\\services\\Globals::getSetByHandle()` now has a `$withTrashed` argument.\n- `craft\\services\\Tags::getTagGroupByHandle()` now has a `$withTrashed` argument.\n- `craft\\services\\Users::sendActivationEmail()`, `sendNewEmailVerifyEmail()`, `sendPasswordResetEmail()`, `getActivationUrl()`, `getEmailVerifyUrl()`, `getPasswordResetUrl()`, and `setVerificationCodeOnUser()` will now throw a `craft\\errors\\InvalidElementException` if the user has a non-unique email. ([#12431](https://github.com/craftcms/cms/issues/12431), [#12712](https://github.com/craftcms/cms/pull/12712))\n- Deprecated `craft\\elements\\Asset::getFs()`. `getVolume()` should be used instead.\n- Deprecated `craft\\helpers\\Assets::sortFolderTree()`.\n- Deprecated `craft\\imagetransforms\\ImageTransformer::ensureTransformUrlByIndexModel()`. `getTransformUrl()` should be used instead.\n- Deprecated `craft\\imagetransforms\\ImageTransformer::procureTransformedImage()`. `generateTransform()` should be used instead.\n- Deprecated `craft\\queue\\jobs\\GeneratePendingTransforms`. `GenerateImageTransform` should be used instead. ([#12340](https://github.com/craftcms/cms/pull/12340))\n- Deprecated `craft\\services\\Assets::getFolderTreeByFolderId()`.\n- Deprecated `craft\\services\\Assets::getFolderTreeByVolumeIds`.\n- Added `Craft.Accordion`. ([#12189](https://github.com/craftcms/cms/pull/12189))\n- Added `Craft.AssetMover`.\n- Added `Craft.BaseElementIndex::getSourcePathActionLabel()`.\n- Added `Craft.BaseElementIndex::getSourcePathActions()`.\n- Added `Craft.BaseElementIndex::getSourcePathLabel()`.\n- Added `Craft.BaseElementIndex::onSourcePathChange()`.\n- Added `Craft.BaseElementIndex::sourcePath`.\n- Added `Craft.BaseElementSelectorModal::getElementIndexParams()`.\n- Added `Craft.BaseElementSelectorModal::getIndexSettings()`.\n- Added `Craft.BaseElementSelectorModal::hasSelection()`.\n- Added `Craft.ElementFieldSettings`.\n- Added `Craft.VolumeFolderSelectorModal`.\n- Added `Garnish.MultiFunctionBtn`.\n- The custom `activate` jQuery event will now trigger when the <kbd>Return</kbd> key is pressed.\n- The custom `activate` jQuery event will no longer trigger for <kbd>Ctrl</kbd>/<kbd>Command</kbd>-clicks.\n- Deprecated `Craft.CategorySelectInput`. `Craft.BaseElementSelectInput` should be used instead. ([#11749](https://github.com/craftcms/cms/pull/11749))\n\n### System\n- Improved element deletion performance. ([#12223](https://github.com/craftcms/cms/pull/12223))\n- Improved queue performance. ([#12274](https://github.com/craftcms/cms/issues/12274), [#12340](https://github.com/craftcms/cms/pull/12340))\n- \u201cApplying new propagation method to elements\u201d, \u201cPropagating [element type]\u201d, and \u201cResaving [element type]\u201d queue jobs are now splt up into batches of up to 100 items. ([#12638](https://github.com/craftcms/cms/pull/12638))\n- Assets\u2019 alternative text values are now included as search keywords.\n- Entry type, section, category group, and tag group deletion no longer involves looping through all affected entries/categories/tags and deleting each one individually via `craft\\services\\Elements::deleteElement()`. ([#12665](https://github.com/craftcms/cms/pull/12665))\n- Updated LitEmoji to v4. ([#12226](https://github.com/craftcms/cms/discussions/12226))\n- Fixed a database deadlock error that could occur when updating a relation or structure position for an element that was simultaneously being saved. ([#9905](https://github.com/craftcms/cms/issues/9905))\n- Fixed a bug where element query `select()` and `orderBy()` params could resolve element extension table column names to custom field columns, if a custom field had a conflicting handle. ([#12652](https://github.com/craftcms/cms/issues/12652))\n- Fixed a bug where it was possible to activate inactive users with non-unique emails. ([#12431](https://github.com/craftcms/cms/issues/12431), [#12712](https://github.com/craftcms/cms/pull/12712))\n- Fixed a bug where hint text within Selectize menus had extremely low contrast on hover. ([#12829](https://github.com/craftcms/cms/issues/12829))\n\n## 4.3.11 - 2023-03-07\n\n- Fixed a bug where `craft\\events\\RegisterElementSourcesEvent::$context` wasn\u2019t always set to `modal` when defining the available element sources for an element selection modal.\n- Fixed a styling bug where multi-line checkbox labels within the Customize Sources modal and View menu weren\u2019t wrapping properly. ([#12717](https://github.com/craftcms/cms/issues/12717))\n- Fixed a bug where asset thumbnails within collapsed Matrix blocks weren\u2019t loading when the block was expanded. ([#12720](https://github.com/craftcms/cms/issues/12720))\n- Fixed a bug where user activation/verification/reset-password URLs could be root-relative, if the `@web` alias was explicitly set to a root-relative URL.\n- Fixed a PHP error that could occur if an options field\u2019s condition rule wasn\u2019t configured with any values. ([#12713](https://github.com/craftcms/cms/pull/12713))\n- Fixed a bug where control panel notifications weren\u2019t being announced to screen readers. ([#12714](https://github.com/craftcms/cms/pull/12714))\n- Fixed a bug where localized relations could be moved to a newly-added site rather than copied, when applying project config changes. ([#12702](https://github.com/craftcms/cms/issues/12702))\n- Fixed a bug where element indexes\u2019 \u201cView\u201d buttons could be inconsistently positioned in the toolbar.\n- Fixed a bug where element selector modal footers could hide the modal contents. ([#12708](https://github.com/craftcms/cms/issues/12708))\n- Fixed a bug where asset thumbnails weren\u2019t respecting the `generateTransformsBeforePageLoad` config setting. ([#12750](https://github.com/craftcms/cms/issues/12750))\n- Fixed a bug where soft hyphens, non-breaking spaces, zero-width characters, invisible times characters, and invisible separators weren\u2019t getting stripped from sanitized asset filenames. ([#12741](https://github.com/craftcms/cms/issues/12741), [#12759](https://github.com/craftcms/cms/pull/12759))\n- Fixed a bug where custom fields\u2019 database columns would get deleted when applying project config changes, if the field type wasn\u2019t present. ([#12760](https://github.com/craftcms/cms/issues/12760))\n- Fixed an error that could occur if a non-numeric value was entered into an image transform\u2019s Width or Height settings. ([#12776](https://github.com/craftcms/cms/pull/12776))\n- Fixed a bug where Assets, Categories, and Tags fields weren\u2019t respecting their \u201cAllow self relations\u201d settings. ([#12769](https://github.com/craftcms/cms/issues/12769))\n- Fixed a bug where dynamically-generated entry titles weren\u2019t always generated with the site\u2019s formatting locale in place. ([12780](https://github.com/craftcms/cms/issues/12780))\n- Fixed a bug where element titles weren\u2019t getting a pointer cursor or underlines on hover, when selected on an element index page.\n- Fixed a bug where it wasn\u2019t possible to close modals that were opened by a custom select menu via the <kbd>Esc</kbd> key. ([#12814](https://github.com/craftcms/cms/pull/12814))\n- Fixed an error that could occur when saving an element with an eager-loaded Matrix field. ([#12815](https://github.com/craftcms/cms/issues/12815))\n- Fixed a bug where the \u201csend to Developer Support\u201d links within the Craft Support widget weren\u2019t working. ([#12822](https://github.com/craftcms/cms/issues/12822))\n\n## 4.3.10 - 2023-02-17\n\n- Fixed a bug where clicking on the scrollbar of a disclosure menu would close it. ([#12681](https://github.com/craftcms/cms/issues/12681))\n- Fixed an error that could occur when loading the Plugin Store, if there wasn\u2019t a `.env` file. ([#12687](https://github.com/craftcms/cms/issues/12687))\n- Fixed a bug where large asset thumbnails weren\u2019t centered within Assets fields. ([#12682](https://github.com/craftcms/cms/issues/12682))\n- Fixed a PHP error that could occur when versioning asset URLs. ([#12678](https://github.com/craftcms/cms/issues/12678))\n- Fixed a bug where the \u201cSite\u201d element condition rule was available for non-localizable element types\u2019 conditions. ([#12601](https://github.com/craftcms/cms/pull/12601))\n- Fixed a bug where it wasn\u2019t possible to sort assets within subfolders by anything besides the asset title. ([#12688](https://github.com/craftcms/cms/issues/12688))\n\n## 4.3.9 - 2023-02-14\n\n- Image thumbnails and previews are no longer versioned if their image URL doesn\u2019t begin with one of the asset\u2019s base filesystem URLs. ([#12663](https://github.com/craftcms/cms/issues/12663))\n- HTML Purifier now allows `oembed` tags. ([ckeditor#59](https://github.com/craftcms/ckeditor/issues/59))\n- Added `craft\\htmlpurifier\\VideoEmbedUrlDef`.\n- `craft\\helpers\\Assets::revUrl()` now has an `$fsOnly` argument.\n- Fixed a bug where entries that aren\u2019t propagated to the primary site weren\u2019t showing revision notes. ([#12641](https://github.com/craftcms/cms/issues/12641))\n- Fixed a bug where HTML tags weren\u2019t getting stripped from auto-generated Handle and URI Format setting values.\n- Fixed a JavaScript error that could occur if an object with `null` values was passed to `Craft.compare()`.\n- Fixed a bug where `craft\\elements\\db\\ElementQuery::toArray()` was calling getter methods whose names conflicted with custom field handles. ([#12635](https://github.com/craftcms/cms/pull/12635))\n\n## 4.3.8.2 - 2023-02-08\n\n- Fixed a PHP error that could occur if relational fields were getting eager-loaded for elements that the fields didn\u2019t belong to. ([#12648](https://github.com/craftcms/cms/issues/12648))\n\n## 4.3.8.1 - 2023-02-08\n\n- Fixed a PHP error that occurred after performing a Composer action within Craft. ([#12647](https://github.com/craftcms/cms/issues/12647))\n- Fixed a bug where element attributes weren\u2019t getting eager-loaded. ([#12646](https://github.com/craftcms/cms/pull/12646), [#12645](https://github.com/craftcms/cms/issues/12645))\n- Fixed a bug where image previews weren\u2019t getting versioned, unless the `revAssetUrls` config setting was enabled. ([#12603](https://github.com/craftcms/cms/issues/12603))\n\n## 4.3.8 - 2023-02-07\n\n- Updated Composer to 2.2.19, fixing a PHP error that could occur when performing a Composer action within Craft, when the autoload classmap was generated with Composer 2.5. ([#12482](https://github.com/craftcms/cms/issues/12482))\n- Fixed a bug where Matrix blocks weren\u2019t getting eager-loaded. ([#12631](https://github.com/craftcms/cms/issues/12631))\n- Fixed a PHP error that could occur when calling `craft\\services\\Assets::getAllDescendantFolders()` for the root folder. ([craftcms/feed-me#1231](https://github.com/craftcms/feed-me/issues/1231))\n- Fixed a bug where revision notes weren\u2019t always being retained for provisional drafts. ([#12641](https://github.com/craftcms/cms/issues/12641))\n- Fixed a bug where it wasn\u2019t possible to access the Customize Sources modal on element index pages, if all sources were disabled. ([#12634](https://github.com/craftcms/cms/issues/12634))\n\n## 4.3.7.1 - 2023-02-05\n\n- The `_includes/forms/checkbox.twig`, `select.twig`, and `text.twig` templates no longer add an `aria-labelledby` attribute to the input if an `aria-label` attribute is also specified.\n- `craft\\helpers\\Cp::dateTimeFieldHtml()` now returns inputs contained within a fieldset.\n- Fixed a bug where some inputs were getting `aria-labelledby` attributes that referenced a nonexistent label ID.\n- Fixed a bug where the first changes to entries weren\u2019t saving properly. ([#12623](https://github.com/craftcms/cms/issues/12623), [#12592](https://github.com/craftcms/cms/issues/12592))\n- Fixed a bug where `craft\\behaviors\\CustomFieldBehavior::$owner` was getting nullified by `craft\\base\\Element::fieldByHandle()`. ([#12624](https://github.com/craftcms/cms/issues/12624))\n\n## 4.3.7 - 2023-02-03\n\n- Improved the performance of the \u201cGenerating pending image transforms\u201d queue job. ([#12274](https://github.com/craftcms/cms/issues/12274))\n- Removed the \u201cTimeout\u201d setting from the Gmail and SMTP mailer transporters, as they aren\u2019t supported by Symfony Mailer\u2019s transport configuration.\n- Removed the \u201cEncryption Method\u201d setting from the SMTP mailer transporter, as Symfony Mailer already uses TLS when port 465 is used (as it is by default).\n- The \u201cPort\u201d setting on the SMTP mailer transporter is no longer required. It will default to 465 or 25 depending on whether OpenSSL is installed.\n- Added more reserved field handles to avoid conflicts with `craft\\base\\Element` properties. ([#12577](https://github.com/craftcms/cms/issues/12577))\n- Assets\u2019 `alt` properties are now automatically trimmed of leading/trailing whitespace.\n- Asset element components in the control panel now include a `data-alt` attribute. ([#12600](https://github.com/craftcms/cms/discussions/12600))\n- Control panel requests no longer override the `pageTrigger` config setting value to `'p'`. ([#12598](https://github.com/craftcms/cms/issues/12598), [#12614](https://github.com/craftcms/cms/pull/12614))\n- Fixed field status badge styling in some contexts. ([#12403](https://github.com/craftcms/cms/issues/12403))\n- Fixed a bug where exporting elements with multiple field layouts as a CSV file using the \u201cExpanded\u201d export type would result in mismatched column values.\n- Fixed a bug where cancelling a conflicting volume folder move would result in the moved folder getting deleted.\n- Fixed a bug where `craft\\elements\\Category::canDuplicate()` wasn\u2019t factoring in save permissions.\n- Fixed a bug where the horizontal scroll position wasn\u2019t being retained when refreshing Live Preview. ([#12504](https://github.com/craftcms/cms/issues/12504))\n- Fixed a bug where user group condition rules for the default user group weren\u2019t getting matched properly during public registration. ([#12283](https://github.com/craftcms/cms/issues/12283))\n- Fixed a bug where HTML tags within field labels, instructions, tips, and warnings weren\u2019t always getting escaped.\n- Fixed a bug where the sidebar scroll position wasn\u2019t retained when selecting a new source on element index pages. ([#12523](https://github.com/craftcms/cms/issues/12523))\n- Fixed a bug where `resave/*` commands\u2019 output didn\u2019t take the offset into account. ([#12526](https://github.com/craftcms/cms/issues/12526))\n- Fixed a bug where warnings were getting logged for video assets that were \u201cmissing\u201d their dimensions.\n- Fixed a bug where `craft\\services\\Assets::getAllDescendantFolders()` could return unexpected results for folders that contained an underscore.\n- Fixed a bug where accessing a custom field\u2019s magic property on an element would return the field\u2019s raw database value rather than `null`, if it didn\u2019t belong to the element\u2019s field layout anymore. ([#12539](https://github.com/craftcms/cms/issues/12539), [#12578](https://github.com/craftcms/cms/pull/12578))\n- Fixed a bug where previewing an asset could wipe out all `h1` tags within Redactor fields. ([#12545](https://github.com/craftcms/cms/issues/12545))\n- Fixed a bug where `craft\\image\\Raster::getIsTransparent()` wasn\u2019t working. ([#12565](https://github.com/craftcms/cms/issues/12565))\n- Fixed a bug where textual condition rules were still showing a text input when the \u201cis empty\u201d or \u201chas a value\u201d operators were selected. ([#12587](https://github.com/craftcms/cms/pull/12587))\n- Fixed a bug where the component name comments in project config YAML files would always lag behind the current project config a little. ([#12576](https://github.com/craftcms/cms/issues/12576), [#12581](https://github.com/craftcms/cms/pull/12581))\n- Fixed a SQL error that occurred when creating a database backup using the default backup command, when running MySQL 5.7.41+ or 8.0.32+. ([#12557](https://github.com/craftcms/cms/issues/12557), [#12560](https://github.com/craftcms/cms/pull/12560))\n- Fixed a bug where database backups weren\u2019t respecting SSL database connection settings if they were specified when using MySQL. ([#10351](https://github.com/craftcms/cms/issues/10351), [#11753](https://github.com/craftcms/cms/issues/11753), [#12596](https://github.com/craftcms/cms/pull/12596))\n- Fixed a bug where element indexes could stop showing their loading spinner prematurely if the element listing needed to be reloaded multiple times in rapid succession. ([#12595](https://github.com/craftcms/cms/issues/12595))\n- Fixed a bug where element editors wouldn\u2019t show tabs that didn\u2019t contain any characters that could be converted to ASCII. ([#12602](https://github.com/craftcms/cms/issues/12602))\n- Fixed a bug where asset thumbnails weren\u2019t getting versioned in the control panel, unless the `revAssetUrls` config setting was enabled. ([#12603](https://github.com/craftcms/cms/issues/12603))\n- Fixed a bug where entry relations could be lost when switching entry types, for relational fields that didn\u2019t exist on the prior entry type. ([#12592](https://github.com/craftcms/cms/issues/12592))\n- Fixed a bug where Matrix blocks weren\u2019t getting duplicated to other sites when first editing an unpublished draft. ([#11366](https://github.com/craftcms/cms/issues/11366))\n- Fixed a bug where element indexes would show show an expand/collapse toggle for structured elements that only had unsaved draft children, which aren\u2019t actually shown. ([#11253](https://github.com/craftcms/cms/issues/11253))\n- Fixed a SQL error that occurred when running the `index-assets` command on PostgreSQL. ([#12617](https://github.com/craftcms/cms/issues/12617))\n- Added `craft\\helpers\\Assets::revUrl()`.\n- Added `craft\\helpers\\Db::escapeForLike()`.\n- Added `craft\\web\\twig\\variables\\Paginate::$pageTrigger`. ([#12614](https://github.com/craftcms/cms/pull/12614))\n- `craft\\helpers\\Assets::revParams()` no longer takes the `revAssetUrls` config setting into account. That should be factored in by whatever is calling it.\n- `craft\\services\\Assets::getAllDescendantFolders()` now has a `$withParent` argument, which can be passed `false` to omit the parent folder from the results. ([#12536](https://github.com/craftcms/cms/issues/12536))\n- `craft\\services\\Matrix::duplicateBlocks()` now has a `$force` argument.\n- Deprecated `craft\\helpers\\DateTimeHelper::timeZoneAbbreviation()`.\n- Deprecated `craft\\helpers\\DateTimeHelper::timeZoneOffset()`.\n\n## 4.3.6.1 - 2023-01-09\n\n- Element edit pages now retain their previous scroll position when they\u2019re automatically refreshed to keep up with changes from another browser tab.\n- Fixed a bug where editing certain Matrix/Neo/Super Table fields could result in content loss. ([#12445](https://github.com/craftcms/cms/issues/12445))\n\n## 4.3.6 - 2023-01-04\n\n- Template caching is no longer enabled for tokenized requests. ([#12458](https://github.com/craftcms/cms/issues/12458))\n- Elisions are now stripped from search keywords. ([#12467](https://github.com/craftcms/cms/issues/12467), [#12474](https://github.com/craftcms/cms/pull/12474))\n- Added support for HEIC/HEIF images. ([#9115](https://github.com/craftcms/cms/discussions/9115))\n- The `allowedFileExtensions` config setting now includes `heic`, `heif`, and `hevc` by default. ([#12490](https://github.com/craftcms/cms/discussions/12490))\n- It\u2019s now possible to assign aliases `children` fields queried via GraphQL. ([#12494](https://github.com/craftcms/cms/pull/12494))\n- Added `craft\\helpers\\Image::isWebSafe()`.\n- Added `craft\\services\\Images::getSupportsHeic()`.\n- `Craft.MatrixInput` now fires `blockSortDragStop`, `beforeMoveBlockUp`, `moveBlockUp`, `beforeMoveBlockDown`, and `moveBlockDown` events. ([#12498](https://github.com/craftcms/cms/pull/12498))\n- Fixed a bug where deleting a field layout tab could result in duplicated tabs. ([#12459](https://github.com/craftcms/cms/issues/12459))\n- Fixed a bug where Feed widgets weren\u2019t showing feed items when they were first loaded. ([#12460](https://github.com/craftcms/cms/issues/12460))\n- Fixed an error that occurred when a Date field\u2019s condition rule was set to a relative range, \u201chas a value\u201d, or \u201cis empty\u201d. ([#12457](https://github.com/craftcms/cms/issues/12457))\n- Fixed an error that could occur when processing template caches in a console request, if a globally-scoped template cache was processed before it.\n- Fixed styling issues with large element thumbnail views. ([#12455](https://github.com/craftcms/cms/issues/12455))\n- Fixed a bug where it wasn\u2019t possible to retry all failed jobs when using a proxy queue. ([#12471](https://github.com/craftcms/cms/issues/12471))\n- Fixed a bug where the selected table columns would be forgotten if modified from a nested source. ([#12477](https://github.com/craftcms/cms/issues/12477))\n- Fixed a bug where some custom field property types in `craft\\behaviors\\CustomFieldBehavior` were incorrect.\n- Fixed an error that could occur if a Matrix sub-field\u2019s handle was too long. ([#12422](https://github.com/craftcms/cms/issues/12422))\n- Fixed a bug where element editor slideouts\u2019 submit buttons weren\u2019t always consistent with the full-page edit form. ([#12487](https://github.com/craftcms/cms/issues/12487))\n- Fixed an XSS vulnerability.\n\n## 4.3.5 - 2022-12-13\n\n- Fixed a bug where entry tab contents could remain visible when switching to other tabs, after changing the entry type.\n- Fixed a bug where it wasn\u2019t possible to enter `0` in Number fields, Money fields, and numeric column cells within editable tables, using certain keyboard layouts. ([#12412](https://github.com/craftcms/cms/issues/12412))\n- Fixed a bug where the default MySQL restore command would attempt to use credentials from `~/.my.cnf` if it existed, instead of Craft\u2019s configured database connection settings. ([#12349](https://github.com/craftcms/cms/issues/12349), [#12430](https://github.com/craftcms/cms/pull/12430))\n- Fixed a JavaScript error that could occur when autosaving an entry draft. ([#12445](https://github.com/craftcms/cms/issues/12445))\n- Added `craft\\base\\ApplicationTrait::onInit()`. ([#12439](https://github.com/craftcms/cms/pull/12439))\n- Added `craft\\console\\Controller::createDirectory()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::do()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::failure()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::note()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::success()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::tip()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::warning()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::writeJson()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\console\\Controller::writeToFile()`. ([#12438](https://github.com/craftcms/cms/pull/12438))\n- Added `craft\\helpers\\FileHelper::absolutePath()`.\n- Added `craft\\helpers\\FileHelper::findClosestFile()`.\n- Added `craft\\helpers\\FileHelper::isWithin()`.\n- Added `craft\\helpers\\FileHelper::relativePath()`.\n- Added `craft\\helpers\\Json::decodeFromFile()`.\n- Added `Craft.filterInputVal()`.\n- Added `Craft.filterNumberInputVal()`.\n\n## 4.3.4 - 2022-11-29\n\n- The `serve` command now routes requests for nonexistent files to Craft. ([#12310](https://github.com/craftcms/cms/pull/12310))\n- `craft\\base\\Element::includeSetStatusAction()` now returns `false` by default regardless of what `hasStatuses()` returns, fixing a bug where some element indexes were unexpectedly getting \u201cSet Status\u201d actions.\n- Query conditions generated by `craft\\helpers\\Db::parseParam()` no longer account for `null` values, due to a heavy performance impact. ([#11931](https://github.com/craftcms/cms/issues/11931))\n- Fixed a bug where the default MySQL backup command would attempt to use credentials from `~/.my.cnf` if it existed, instead of Craft\u2019s configured database connection settings. ([#12349](https://github.com/craftcms/cms/issues/12349))\n- Fixed a bug where it wasn\u2019t possible to access the Customize Sources modal if all sources were disabled. ([#12369](https://github.com/craftcms/cms/issues/12369))\n- Fixed a bug where Assets fields weren\u2019t taking their \u201cShow unpermitted volumes\u201d setting into account when defining the available input sources. ([#12364](https://github.com/craftcms/cms/issues/12364))\n- Fixed a bug where user slideouts included status toggles.\n- Updated Yii to 2.0.47.\n\n## 4.3.3 - 2022-11-17\n\n- Fixed an error that occurred if an arrow function was passed to the `|sort` Twig filter. ([#12334](https://github.com/craftcms/cms/issues/12334))\n- Fixed a bug where nested fields set to numbers could be inadvertently changed when an entry draft was created.\n- `craft\\services\\Fields::getFieldsWithContent()` and `getFieldsWithoutContent()` now have `$context` arguments.\n\n## 4.3.2.1 - 2022-11-16\n\n- Fixed a PHP error that could occur when generating an image transform. ([#12333](https://github.com/craftcms/cms/issues/12333))\n\n## 4.3.2 - 2022-11-16\n\n- `firstName` and `lastName` are now reserved field handles for the user field layout. ([#12241](https://github.com/craftcms/cms/issues/12241), [#12316](https://github.com/craftcms/cms/pull/12316))\n- Asset filenames are truncated in large thumbnail views, as they were before 4.3.0. ([#12236](https://github.com/craftcms/cms/discussions/12236))\n- Fixed an information disclosure vulnerability.\n- Fixed an XSS vulnerability.\n- Fixed asset indexing for Local filesystems that were configured to use a symlinked server path.\n- Fixed an error that could occur when calling `craft\\base\\Element::getCanonicalUid()` on a draft loaded for a site that the canonical element didn\u2019t exist on yet. ([#12228](https://github.com/craftcms/cms/issues/12228))\n- Fixed a bug where long words in asset titles weren\u2019t wrapping in the large thumbnail view. ([#12237](https://github.com/craftcms/cms/issues/12237))\n- Fixed a bug where the Users index page was showing a \u201cSet Status\u201d bulk action, making it possible to disable users.\n- Disabled users now identify themselves as disabled, and Edit User pages now provide a way for them to be re-enabled.\n- Fixed a layout issue that could occur on Assets fields using the \u201cLarge Thumbnails\u201d view mode. ([#12230](https://github.com/craftcms/cms/issues/12230))\n- Fixed a bug where elements that weren\u2019t viewable by the current user could still be hyperlinked in element indexes.\n- Fixed a bug where `craft\\helpers\\DateTimeHelper::toDateInterval()` could return a `DateInterval` that was off by an hour around daylight savings time changes.\n- Fixed a bug where sticky element index footers were obstructed when the Debug Toolbar was enabled. ([#12242](https://github.com/craftcms/cms/issues/12242))\n- Fixed a bug where it wasn\u2019t possible to change the sort attribute on element indexes while searching. ([#12256](https://github.com/craftcms/cms/issues/12256))\n- Fixed a bug where `resave/*` commands weren\u2019t catching exceptions thrown when applying the `--set` and `--to` options. ([#12262](https://github.com/craftcms/cms/issues/12262))\n- Fixed the position of field status indicators within Matrix fields in Live Preview. ([#12287](https://github.com/craftcms/cms/issues/12287))\n- Fixed PHP errors that could occur when executing GraphQL queries. ([#12271](https://github.com/craftcms/cms/pull/12271), [#12275](https://github.com/craftcms/cms/pull/12275))\n- Fixed a bug where it was possible to add a \u201cStatus\u201d condition rule to relational fields\u2019 selectable element conditions. ([#12289](https://github.com/craftcms/cms/issues/12289))\n- Fixed a PHP error that occurred if a field type stored enum values. ([#12297](https://github.com/craftcms/cms/issues/12297))\n- Fixed a bug where PHP errors and exceptions thrown when formatting a control panel screen response weren\u2019t being handled properly. ([#12308](https://github.com/craftcms/cms/issues/12308))\n- Fixed a bug where element indexes were showing the labels of empty Dropdown options when selected. ([#12319](https://github.com/craftcms/cms/issues/12319))\n- Fixed condition builder styling issues that occurred if any rules had exceptionally long names. ([#12311](https://github.com/craftcms/cms/issues/12311))\n- Fixed an error that occurred when saving an entry via GraphQL, if a parent entry was assigned that didn\u2019t exist on the requested site. ([#12291](https://github.com/craftcms/cms/issues/12291))\n- Fixed a bug where conditional fields weren\u2019t always saving for elements that didn\u2019t support autosaved drafts. ([#12166](https://github.com/craftcms/cms/issues/12166))\n- Fixed a bug where fields set to numbers could be inadvertently changed when an entry draft was created.\n- Added `craft\\base\\Element::includeSetStatusAction()`.\n- Added `craft\\services\\Fields::getFieldsWithoutContent()`.\n\n## 4.3.1 - 2022-10-27\n\n- Numeric values are no longer automatically formatted within element indexes. ([#12205](https://github.com/craftcms/cms/issues/12205))\n- When `craft\\base\\Element::EVENT_DEFINE_URL` event handlers set `craft\\events\\DefineUrlEvent::$url` to `null`, that will no longer be respected unless `$handled` was also set to `true`. ([#12210](https://github.com/craftcms/cms/issues/12210), [nystudio107/craft-imageoptimize#359](https://github.com/nystudio107/craft-imageoptimize/issues/359))\n- Asset folder and file names are now converted to ASCII using the primary site\u2019s language for character mappings, regardless of the current user\u2019s preferred language, when the `convertFilenamesToAscii` config setting is enabled. ([#12207](https://github.com/craftcms/cms/discussions/12207))\n- Fixed a bug where locked users\u2019 remaining cooldown times could be calculated incorrectly on PHP 8.0.\n- Fixed an infinite recursion bug that occurred when editing a Matrix field with a custom propagation method. ([#12176](https://github.com/craftcms/cms/issues/12176))\n- Fixed a bug where element index source lists were showing headings that didn\u2019t have any visible nested sources. ([#12193](https://github.com/craftcms/cms/issues/12193))\n- Fixed a JavaScript 404 error that occurred when users\u2019 Language was set to Chinese. ([#12194](https://github.com/craftcms/cms/issues/12194))\n- Fixed a bug where users couldn\u2019t delete their own addresses. ([craftcms/commerce#3011](https://github.com/craftcms/commerce/issues/3011))\n- Fixed a bug where the `users/save-address` action wasn\u2019t validating addresses properly.\n- Fixed an error that could occur during garbage collection, if any nested volume folders were missing their path. ([#12195](https://github.com/craftcms/cms/issues/12195))\n\n## 4.3.0 - 2022-10-25\n\n### Content Management\n- Added a \u201cView\u201d menu to element indexes, which enable users to customize the visible table columns for themselves, without affecting other users. ([#11915](https://github.com/craftcms/cms/pull/11915))\n- Added source setting menus to element index pages, which now contain the \u201cCustomize sources\u201d option when allowed, and \u201cNew subfolder\u201d, \u201cRename folder\u201d, and \u201cDelete folder\u201d actions on the Assets index page. ([#11906](https://github.com/craftcms/cms/pull/11906))\n- Added the \u201cEditable\u201d rule to asset and entry conditions. ([#11995](https://github.com/craftcms/cms/discussions/11995))\n- Improved control panel mobile support. ([#11963](https://github.com/craftcms/cms/pull/11963), [#12005](https://github.com/craftcms/cms/pull/12005))\n- Element indexes now respect field layouts\u2019 user conditions when determining which custom field columns to show. ([#11913](https://github.com/craftcms/cms/pull/11913))\n- Element index URLs now include the selected source key in a `source` query param, so all sources are now deep-linkable, including custom sources. ([#11996](https://github.com/craftcms/cms/discussions/11996))\n- Notifications are now shown after executing folder actions on the Assets index page. ([#11906](https://github.com/craftcms/cms/pull/11906))\n- Date range condition rules now support \u201cToday\u201d, \u201cThis week\u201d, \u201cThis month\u201d, \u201cThis year\u201d, \u201cPast 7 days\u201d, \u201cPast 30 days\u201d, \u201cPast 30 days\u201d, \u201cPast year\u201d, \u201cBefore\u2026\u201d, and \u201cAfter\u2026\u201d relative range types, in addition to specifying a custom date range. ([#10749](https://github.com/craftcms/cms/discussions/10749), [#11888](https://github.com/craftcms/cms/pull/11888))\n- Number condition rules now support an \u201cis between\u2026\u201d operator. ([#11950](https://github.com/craftcms/cms/pull/11950))\n- All text, number, and date range condition rules now support \u201chas a value\u201d and \u201cis empty\u201d operators. ([#11070](https://github.com/craftcms/cms/discussions/11070))\n- \u201cSave as a new [element type]\u201d actions will now discard any unsaved changes on the original element after the new element is created. ([#10204](https://github.com/craftcms/cms/issues/10204), [#11959](https://github.com/craftcms/cms/issues/11959), [#12102](https://github.com/craftcms/cms/issues/12102), [#12165](https://github.com/craftcms/cms/issues/12165))\n- If Live Preview is triggered while a draft is saving, it will now wait until the save completes before opening. ([#11858](https://github.com/craftcms/cms/issues/11858), [#11895](https://github.com/craftcms/cms/pull/11895))\n- Addresses now support change tracking.\n- It\u2019s now possible to restore assets that were deleted programmatically with `craft\\elements\\Asset::$keepFile` set to `true`. ([#11761](https://github.com/craftcms/cms/issues/11761))\n\n### Accessibility\n- Improved the styling of selected sidebar navigation items to meet contrast requirements. ([#11589](https://github.com/craftcms/cms/pull/11589))\n- Improved the styling of slideouts for screens under 600 pixels wide. ([#11636](https://github.com/craftcms/cms/pull/11636))\n- Improved the styling of the primary button on element index pages for small screens. ([#11963](https://github.com/craftcms/cms/pull/11963))\n- Improved the contrast of modal resize handles. ([#11727](https://github.com/craftcms/cms/pull/11727))\n- Improved the contrast of fields\u2019 searchable and translatable indicator icons on the Fields index page. ([#12169](https://github.com/craftcms/cms/pull/12169))\n- Improed the contrast of the \u201cSame as language\u201d text within the \u201cFormatting Locale\u201d user preference. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Improved the contrast of the selected options within combo boxes. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved the readability of the global navigation and date pickers when text is resized to 200%. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Improved focus management for HUD components. ([#11985](https://github.com/craftcms/cms/pull/11985))\n- Improved focus management for element index pagination links.  ([#11565](https://github.com/craftcms/cms/pull/11565)).\n- Improved focus management for editable tables. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Custom slider components now support <kbd>Home</kbd> and <kbd>End</kbd> key presses. ([#11578](https://github.com/craftcms/cms/pull/11578))\n- Improved the markup and keyboard control for exclusive button groups. ([#11942](https://github.com/craftcms/cms/pull/11942))\n- Improved keyboard control for the widget manager HUD on the Dashboard. ([#11578](https://github.com/craftcms/cms/pull/11578))\n- Improved New Widget and Quick Post action menus for screen readers. ([#11611](https://github.com/craftcms/cms/pull/11611))\n- Improved the widget manager HUD for screen readers. ([#11945](https://github.com/craftcms/cms/pull/11945))\n- Improved the Craft Support widget for screen readers. ([#11703](https://github.com/craftcms/cms/pull/11703))\n- Improved element index view mode buttons for screen readers. ([#11613](https://github.com/craftcms/cms/pull/11613))\n- Improved element type selects within \u201cRelated To\u201d condition rules for screen readers. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved element action modals for screen readers. ([#11905](https://github.com/craftcms/cms/issues/7377))\n- Improved field instructions, errors, and other visually-related text for screen readers. ([#11763](https://github.com/craftcms/cms/issues/7377))\n- Improved field translation indicators for screen readers. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved the parent selection button on structured entries\u2019 and categories\u2019 edit pages for screen readers. ([#11662](https://github.com/craftcms/cms/pull/11662))\n- Improved the Rotate button within Live Preview for screen readers. ([#11953](https://github.com/craftcms/cms/pull/11953))\n- Improved Date fields for screen readers. ([#10546](https://github.com/craftcms/cms/pull/10546))\n- Fixed a mismatch between the visible and accessibile text on the site name in the global sidebar. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Added alternative text to element status indicators. ([#11604](https://github.com/craftcms/cms/pull/11604))\n- Feed, Recent Entries, and Drafts widgets now use use semantic lists instead of tables. ([#11952](https://github.com/craftcms/cms/pull/11952))\n- Added autocomplete attributes to several address fields. ([#11767](https://github.com/craftcms/cms/pull/11767))\n- Implemented fieldsets and descriptive headings on user accounts\u2019 \u201cPreferences\u201d tab. ([#11534](https://github.com/craftcms/cms/pull/11534))\n- The \u201cAll\u201d status option within element index toolbars now uses a differentiated gradient icon. ([#11911](https://github.com/craftcms/cms/pull/11911))\n- Improved status indicator shapes, when the \u201cUse shapes to represent statuses\u201d user preference is enabled. ([#11911](https://github.com/craftcms/cms/pull/11911))\n- Boolean table columns within element indexes now use check icons to indicate `true` values. ([#11911](https://github.com/craftcms/cms/pull/11911))\n- Element titles are no longer truncated on edit pages. ([#11768](https://github.com/craftcms/cms/pull/11768))\n- Asset titles are no longer truncated in asset indexes. ([#11775](https://github.com/craftcms/cms/pull/11775))\n- Element source navigation now programmatically conveys structure imparted by headings. ([#11777](https://github.com/craftcms/cms/pull/11777))\n- Added a warning icon to related elements that contain validation errors. ([#11610](https://github.com/craftcms/cms/pull/11610))\n- Element index footers now stick to the bottom of the window, and element action triggers are now inserted into the footer rather than replacing the contents of the page\u2019s toolbar. ([#11844](https://github.com/craftcms/cms/pull/11844))\n\n### Administration\n- Added the `extraLastNamePrefixes` config setting. ([#11903](https://github.com/craftcms/cms/pull/11903))\n- Added the `extraNameSalutations` config setting. ([#11903](https://github.com/craftcms/cms/pull/11903))\n- Added the `extraNameSuffixes` config setting. ([#11903](https://github.com/craftcms/cms/pull/11903))\n- Element sources now have a \u201cDefault Sort\u201d setting in the Customize Sources modal. ([#12002](https://github.com/craftcms/cms/discussions/12002))\n- Control panel-defined image transforms can now have custom quality values. ([#9622](https://github.com/craftcms/cms/discussions/9622))\n- Added support for the `CRAFT_DOTENV_PATH` PHP constant. ([#11894](https://github.com/craftcms/cms/discussions/11894))\n- Added support for `CRAFT_WEB_URL` and `CRAFT_WEB_ROOT` environment variables/PHP constants, which can be used to set the default `@web` and `@webroot` alias values. ([#11912](https://github.com/craftcms/cms/pull/11912))\n\n### Development\n- Added the `canCreateDrafts()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canDelete()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canDeleteForSite()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canDuplicate()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canSave()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `canView()` Twig function. ([#11797](https://github.com/craftcms/cms/discussions/11797), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added the `|boolean` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Added the `|float` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Added the `|integer` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Added the `|string` Twig filter. ([#11792](https://github.com/craftcms/cms/pull/11792))\n- Twig templates now have `today`, `tomorrow`, and `yesterday` global variables available to them.\n- Element query date params now support passing `today`, `tomorrow`, and `yesterday`. ([#10485](https://github.com/craftcms/cms/issues/10485))\n- Element queries\u2019 `relatedTo` params now only check for relations in the same site as `siteId`, if set. ([#12000](https://github.com/craftcms/cms/issues/12000), [#12072](https://github.com/craftcms/cms/pull/12072))\n- Element queries now support passing ambiguous column names (e.g. `dateCreated`) and field handles into `select()`. ([#11790](https://github.com/craftcms/cms/pull/11790), [#11800](https://github.com/craftcms/cms/pull/11800))\n- Element queries\u2019 `collect()` methods eager-loaded elements now return `craft\\elements\\ElementCollection` objects, which extends `Illuminate\\Support\\Collection` with `ids()` and `with()` methods. ([#12113](https://github.com/craftcms/cms/discussions/12113))\n- `{% cache %}` tags now store any HTML registered with `{% html %}` tags. ([#11811](https://github.com/craftcms/cms/discussions/11811))\n- `{% cache %}` tags and GraphQL query caches now get a max cache duration based on the fetched/referenced entries\u2019 expiry dates. ([#8525](https://github.com/craftcms/cms/discussions/8525), [#11901](https://github.com/craftcms/cms/pull/11901))\n- Added the `siteHandle` field to elements queried via GraphQL. ([#10829](https://github.com/craftcms/cms/discussions/10829))\n- `users/session-info` responses now include a `csrfTokenName` key. ([#11706](https://github.com/craftcms/cms/pull/11706), [#11767](https://github.com/craftcms/cms/pull/11767))\n- The `elements/save-draft` action now supports being called from the front end. ([#12131](https://github.com/craftcms/cms/issues/12131))\n- The `users/upload-user-photo` action now includes a `photoId` key in the response data. ([#12175](https://github.com/craftcms/cms/pull/12175))\n\n### Extensibility\n- Added `craft\\base\\conditions\\BaseTextConditionRule::inputOptions()`.\n- Added `craft\\base\\Element::EVENT_DEFINE_URL`. ([#12168](https://github.com/craftcms/cms/pull/12168))\n- Added `craft\\base\\ExpirableElementInterface`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\controllers\\ElementsController::$element`.\n- Added `craft\\db\\ActiveQuery::collect()`. ([#11842](https://github.com/craftcms/cms/pull/11842))\n- Added `craft\\elements\\actions\\Restore::$restorableElementsOnly`.\n- Added `craft\\elements\\conditions\\assets\\EditableConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\EditableConditionRule`.\n- Added `craft\\elements\\ElementCollection`. ([#12113](https://github.com/craftcms/cms/discussions/12113))\n- Added `craft\\events\\AuthorizationCheckEvent::$element`.\n- Added `craft\\events\\CreateTwigEvent`.\n- Added `craft\\events\\DefineAddressFieldLabelEvent`.\n- Added `craft\\events\\DefineAddressFieldsEvent`.\n- Added `craft\\events\\DefineUrlEvent`. ([#12168](https://github.com/craftcms/cms/pull/12168))\n- Added `craft\\events\\ImageTransformerOperationEvent::$tempPath`.\n- Added `craft\\events\\SearchEvent::$scores`. ([#11882](https://github.com/craftcms/cms/discussions/11882))\n- Added `craft\\events\\UserGroupPermissionsEvent`.\n- Added `craft\\events\\UserPermissionsEvent`.\n- Added `craft\\helpers\\DateRange`.\n- Added `craft\\helpers\\DateTimeHelper::firstWeekDay()`.\n- Added `craft\\helpers\\DateTimeHelper::lastMonth()`.\n- Added `craft\\helpers\\DateTimeHelper::lastWeek()`.\n- Added `craft\\helpers\\DateTimeHelper::lastWeekDay()`.\n- Added `craft\\helpers\\DateTimeHelper::lastYear()`.\n- Added `craft\\helpers\\DateTimeHelper::nextMonth()`.\n- Added `craft\\helpers\\DateTimeHelper::nextWeek()`.\n- Added `craft\\helpers\\DateTimeHelper::nextYear()`.\n- Added `craft\\helpers\\DateTimeHelper::thisMonth()`.\n- Added `craft\\helpers\\DateTimeHelper::thisWeek()`.\n- Added `craft\\helpers\\DateTimeHelper::thisYear()`.\n- Added `craft\\helpers\\DateTimeHelper::today()`.\n- Added `craft\\helpers\\DateTimeHelper::tomorrow()`.\n- Added `craft\\helpers\\DateTimeHelper::yesterday()`.\n- Added `craft\\helpers\\ElementHelper::attributeHtml()`.\n- Added `craft\\helpers\\Html::svg()`. ([#11932](https://github.com/craftcms/cms/pull/11932))\n- Added `craft\\i18n\\FormatConverter::convertDatePhpToHuman()`. ([#10546](https://github.com/craftcms/cms/pull/10546))\n- Added `craft\\i18n\\Locale::FORMAT_HUMAN`.\n- Added `craft\\nameparsing\\CustomLanguage`.\n- Added `craft\\services\\Addresses::EVENT_DEFINE_FIELD_LABEL`. ([#11788](https://github.com/craftcms/cms/discussions/11788))\n- Added `craft\\services\\Addresses::EVENT_DEFINE_USED_FIELDS`. ([#11788](https://github.com/craftcms/cms/discussions/11788))\n- Added `craft\\services\\Addresses::EVENT_DEFINE_USED_SUBDIVISION_FIELDS`. ([#11788](https://github.com/craftcms/cms/discussions/11788))\n- Added `craft\\services\\Addresses::getFieldLabel()`.\n- Added `craft\\services\\Addresses::getUsedFields()`.\n- Added `craft\\services\\Addresses::getUsedSubdivisionFields()`.\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_CREATE_DRAFTS`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE_FOR_SITE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_DUPLICATE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_SAVE`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::EVENT_AUTHORIZE_VIEW`. ([#11759](https://github.com/craftcms/cms/discussions/11759), [#11808](https://github.com/craftcms/cms/pull/11808))\n- Added `craft\\services\\Elements::canCreateDrafts()`.\n- Added `craft\\services\\Elements::canDelete()`.\n- Added `craft\\services\\Elements::canDeleteForSite()`.\n- Added `craft\\services\\Elements::canDuplicate()`.\n- Added `craft\\services\\Elements::canSave()`.\n- Added `craft\\services\\Elements::canView()`.\n- Added `craft\\services\\Elements::getIsCollectingCacheInfo()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Elements::setCacheExpiryDate()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Elements::startCollectingCacheInfo()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Elements::stopCollectingCacheInfo()`. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Added `craft\\services\\Search::EVENT_BEFORE_SCORE_RESULTS`. ([#11882](https://github.com/craftcms/cms/discussions/11882))\n- Added `craft\\services\\UserPermissions::EVENT_AFTER_SAVE_GROUP_PERMISSIONS`. ([#12130](https://github.com/craftcms/cms/discussions/12130), [#12146](https://github.com/craftcms/cms/pull/12146))\n- Added `craft\\services\\UserPermissions::EVENT_AFTER_SAVE_USER_PERMISSIONS`. ([#12130](https://github.com/craftcms/cms/discussions/12130), [#12146](https://github.com/craftcms/cms/pull/12146))\n- Added `craft\\web\\Controller::currentUser()`. ([#11754](https://github.com/craftcms/cms/pull/11754), [#11916](https://github.com/craftcms/cms/pull/11916))\n- Added `craft\\web\\View::EVENT_AFTER_CREATE_TWIG`. ([#11774](https://github.com/craftcms/cms/pull/11774))\n- `craft\\elements\\Asset::EVENT_DEFINE_URL` now gets triggered after the default URL has been generated, and the URL will be passed to `craft\\events\\DefineAssetUrlEvent::$url`.\n- `craft\\elements\\db\\ElementQuery::collect()` and `craft\\base\\Element::getEagerLoadedElements()` now return `craft\\elements\\ElementCollection` instances. ([#12113](https://github.com/craftcms/cms/discussions/12113))\n- `craft\\events\\DraftEvent::$creatorId` is now nullable. ([#11904](https://github.com/craftcms/cms/issues/11904))\n- `craft\\fieldlayoutelements\\BaseField::statusClass()` and `statusLabel()` now return status info from the element for the attribute specified by `attribute()`.\n- `craft\\helpers\\Component::iconSvg()` now namespaces the SVG contents, and adds `aria-hidden=\"true\"`. ([#11703](https://github.com/craftcms/cms/pull/11703))\n- `craft\\services\\Drafts::createDraft()` now accepts `null` passed to its `$creatorId` argument. ([#11904](https://github.com/craftcms/cms/issues/11904))\n- `craft\\services\\Search::EVENT_AFTER_SEARCH` now includes the computed search result scores, set to `craft\\events\\SearchEvent::$scores`, and any changes made to it will be returned by `searchElements()`. ([#11882](https://github.com/craftcms/cms/discussions/11882))\n- `craft\\services\\Search::EVENT_BEFORE_INDEX_KEYWORDS` is now cancellable by setting `$event->isValid` to `false`. ([#11705](https://github.com/craftcms/cms/discussions/11705))\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_CREATE_DRAFTS`. `craft\\services\\Elements::EVENT_AUTHORIZE_CREATE_DRAFTS` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_DELETE_FOR_SITE`. `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE_FOR_SITE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_DELETE`. `craft\\services\\Elements::EVENT_AUTHORIZE_DELETE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_DUPLICATE`. `craft\\services\\Elements::EVENT_AUTHORIZE_DUPLICATE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_SAVE`. `craft\\services\\Elements::EVENT_AUTHORIZE_SAVE` should be used instead.\n- Deprecated `craft\\base\\Element::EVENT_AUTHORIZE_VIEW`. `craft\\services\\Elements::EVENT_AUTHORIZE_VIEW` should be used instead.\n- Deprecated `craft\\elements\\Address::addressAttributeLabel()`. `craft\\services\\Addresses::getFieldLabel()` should be used instead.\n- Deprecated `craft\\events\\DefineAssetUrlEvent::$asset`. `$sender` should be used instead.\n- Deprecated `craft\\services\\Elements::getIsCollectingCacheTags()`. `getIsCollectingCacheInfo()` should be used instead. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Deprecated `craft\\services\\Elements::startCollectingCacheTags()`. `startCollectingCacheInfo()` should be used instead. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- Deprecated `craft\\services\\Elements::stopCollectingCacheTags()`. `stopCollectingCacheInfo()` should be used instead. ([#11901](https://github.com/craftcms/cms/pull/11901))\n- `checkboxSelect` inputs without `showAllOption: true` now post an empty value if no options were selected. ([#11748](https://github.com/craftcms/cms/issues/11748))\n- Added the `Craft.useMobileStyles()` JavaScript method. ([#11636](https://github.com/craftcms/cms/pull/11636))\n- Added `Craft.BaseElementIndex::getParentSource()`.\n- Added `Craft.BaseElementIndex::getRootSource()`.\n- Added `Craft.BaseElementIndex::getSourceActions()`. ([#11906](https://github.com/craftcms/cms/pull/11906))\n- Added `Craft.BaseElementIndex::getSourceLevel()`.\n- `Craft.BaseElementSelectInput` now triggers a `change` event when elements are added programmatically or removed.\n\n### System\n- Name parsing now checks for common German salutations, suffixes, and last name prefixes.\n- \u201cGenerating pending image transforms\u201d jobs no longer attempt to process transforms that had previously failed. ([#11970](https://github.com/craftcms/cms/issues/11970))\n- The default system email template now sets the `lang` attribute on the `<html>` tag. ([#12156](https://github.com/craftcms/cms/pull/12156))\n- The default system email template now includes a `Content-Type` tag. ([#12156](https://github.com/craftcms/cms/pull/12156))\n- Improved GraphQL cache reliability. ([#11994](https://github.com/craftcms/cms/issues/11994), [#12086](https://github.com/craftcms/cms/pull/12086))\n- Control panel `.twig` templates are now prioritized over `.html`. ([#11809](https://github.com/craftcms/cms/discussions/11809), [#11840](https://github.com/craftcms/cms/pull/11840))\n- Updated Yii to 2.0.46.\n- Fixed a bug where addresses weren\u2019t validating their country codes. ([#12161](https://github.com/craftcms/cms/issues/12161))\n- Fixed a bug where Entry URI Format, Template, and Default Status switches were focusable within sections\u2019 Site Settings tables, for disabled sites.\n- Fixed a bug where `craft\\helpers\\Db::parseParam()` wasn\u2019t generating conditions that would include `null` values when it should have. ([#11931](https://github.com/craftcms/cms/issues/11931))\n\n## 4.2.8 - 2022-10-18\n\n### Changed\n- The `setup/keys` command will now set the application ID if `Craft::$app->id` is empty. ([#12103](https://github.com/craftcms/cms/pull/12103))\n\n### Fixed\n- Fixed an error that could occur when running tests. ([#12088](https://github.com/craftcms/cms/issues/12088), [#12089](https://github.com/craftcms/cms/issues/12089))\n- Fixed a bug where the `db/restore` command would output a warning about a missing `info` row, even if one existed in the imported database. ([#12101](https://github.com/craftcms/cms/issues/12101))\n- Fixed a bug where the \u201cYour session has ended\u201d modal could be shown on the control panel\u2019s login page. ([#12121](https://github.com/craftcms/cms/issues/12121))\n- Fixed a permission error that could occur when uploading a file to an Assets field.\n- Fixed a bug where custom log targets were getting removed when processing queue jobs. ([#12109](https://github.com/craftcms/cms/pull/12109))\n- Fixed a bug where Money fields weren\u2019t distinguishing between `0` and empty values. ([#12122](https://github.com/craftcms/cms/issues/12122), [#12132](https://github.com/craftcms/cms/pull/12132))\n- Fixed an error that could occur in the control panel. ([#12133](https://github.com/craftcms/cms/issues/12133))\n- Fixed a bug where assets uploaded from Assets fields weren\u2019t retaining their original filename for all but the initial site. ([#12142](https://github.com/craftcms/cms/pull/12142))\n- Fixed a bug where non-admin users couldn\u2019t always see the Temporary Uploads source when selecting assets from an Assets field. ([#12128](https://github.com/craftcms/cms/issues/12128))\n- Fixed a bug where image transforms that used the `fit` mode but didn\u2019t specify a width or height weren\u2019t getting their missing dimension set on the asset. ([#12137](https://github.com/craftcms/cms/issues/12137))\n\n## 4.2.7 - 2022-10-11\n\n### Added\n- Added the `setup/keys` command, which ensure Craft is configured with an application ID and security key.\n\n### Changed\n- The `install/craft` command now runs `setup/keys` before doing anything else.\n\n## 4.2.6 - 2022-10-11\n\n### Added\n- Added the `--as-json` option to the `help` command. ([#12017](https://github.com/craftcms/cms/pull/12017), [#12074](https://github.com/craftcms/cms/pull/12074))\n- Added `craft\\helpers\\ElementHelper::isAttributeEmpty()`.\n- Added `craft\\queue\\jobs\\ResaveElements::$ifEmpty`.\n- Added `craft\\queue\\jobs\\ResaveElements::$set`.\n- Added `craft\\queue\\jobs\\ResaveElements::$to`.\n- Added `craft\\queue\\jobs\\ResaveElements::$touch`.\n\n### Changed\n- When passing a PHP callback function to the `--to` option of a `resave/*` command, the `$element` argument is now optional.\n\n### Deprecated\n- Deprecated `craft\\web\\assets\\focusvisible\\FocusVisibleAsset`. ([#12037](https://github.com/craftcms/cms/pull/12037))\n\n### Fixed\n- Fixed an error that could occur when editing a draft of an element type that didn\u2019t have change tracking enabled.\n- Fixed an error that could occur when saving an entry with Matrix blocks, if the entry had been deleted for a site.\n- Fixed a bug where `resave/*` commands weren\u2019t respecting the `--set`, `--to`, or `--touch` options when `--queue` was passed. ([#11974](https://github.com/craftcms/cms/issues/11974))\n- Fixed a bug where `relatedTo` params didn\u2019t support collections.\n- Fixed an error that could occur when passing an element query to a `relatedTo` param, if the parent element query contained any closures. ([#11981](https://github.com/craftcms/cms/issues/11981))\n- Fixed a bug where `craft\\log\\MonologTarget::$allowLineBreaks` wasn\u2019t getting a default value. ([#12004](https://github.com/craftcms/cms/pull/12004))\n- Fixed a PHP error that occurred when attempting to edit an element by an invalid ID or UUID.\n- Fixed a bug where unsaved drafts could be unintentionally deleted when saved, if a plugin or module was blocking the save via `EVENT_BEFORE_SAVE`. ([#12015](https://github.com/craftcms/cms/issues/12015))\n- Fixed a bug where \u201cPropagating tags\u201d jobs would fail if two tags had similar titles.\n- Fixed a bug where pressing \u201cDisable focal point\u201d within asset preview modals would only reset the focal point position, but not delete it. ([#12030](https://github.com/craftcms/cms/issues/12030))\n- Fixed a bug where image transforms weren\u2019t getting sized correctly in some cases when `upscaleImages` was disabled. ([#12023](https://github.com/craftcms/cms/issues/12023))\n- Fixed a bug where table cells within Redactor fields could appear to be focused when they weren\u2019t. ([#12001](https://github.com/craftcms/cms/issues/12001), [#12037](https://github.com/craftcms/cms/pull/12037))\n- Fixed a bug where alerts saying a folder can\u2019t be renamed due to a naming conflict were showing the old folder name instead of the new one. ([#12049](https://github.com/craftcms/cms/pull/12049))\n- Fixed a bug where custom fields nested within Matrix fields weren\u2019t always updating properly within slideout editors. ([#11988](https://github.com/craftcms/cms/issues/11988), [#12058](https://github.com/craftcms/cms/issues/12058))\n- Fixed an error that could occur when adding new textual condition rules to a condition. ([#12077](https://github.com/craftcms/cms/pull/12077))\n- Fixed a bug where Table fields\u2019 Default Values settings were always showing at least one row, even if the setting had been saved without any rows. ([#12071](https://github.com/craftcms/cms/issues/12071))\n- Fixed a bug where existing rows in Table fields\u2019 Default Values settings were losing the ability to be reordered or deleted when the table columns were changed.\n- Fixed a bug where sending a password reset email for an inactive user would set them to a pending state. ([#12080](https://github.com/craftcms/cms/pull/12080))\n- Fixed a bug where some GraphQL results could be missing if multiple sets of nested elements were being queried using the same alias. ([#11982](https://github.com/craftcms/cms/issues/11982))\n\n### Security\n- Fixed information disclosure vulnerabilities.\n\n## 4.2.5.2 - 2022-10-03\n\n### Security\n- Updated Twig to 3.4. ([#12022](https://github.com/craftcms/cms/issues/12022))\n\n## 4.2.5.1 - 2022-09-21\n\n### Fixed\n- Fixed a bug where the \u201cNew category\u201d button could be missing from the Categories index page. ([#11977](https://github.com/craftcms/cms/issues/11977))\n- Fixed a bug where `Craft::t()` and the `|t` Twig filter were modifying digit-dash-digit sequences. ([#11980](https://github.com/craftcms/cms/issues/11980))\n- Fixed PHP errors that occurred if `webonyx/graphql-php` 14.11.17 was installed. ([#11979](https://github.com/craftcms/cms/issues/11979), [webonyx/graphql-php#1221](https://github.com/webonyx/graphql-php/issues/1221))\n- Fixed a PHP error that could occur when working with a draft. ([#11976](https://github.com/craftcms/cms/issues/11976))\n\n## 4.2.5 - 2022-09-20\n\n### Added\n- Added `craft\\helpers\\Image::targetDimensions()`.\n\n### Changed\n- Edit Asset pages now show the \u201cView\u201d button for all file types, not just images, PDFs, and text files. ([#11936](https://github.com/craftcms/cms/issues/11936))\n\n### Removed\n- Removed the Punycode PHP library. ([#11948](https://github.com/craftcms/cms/issues/11948))\n\n### Fixed\n- Fixed a bug where image transforms weren\u2019t always getting applied properly to all animation frames. ([#11937](https://github.com/craftcms/cms/pull/11937))\n- Fixed a bug where animated WebP images would lose their animation frames when transformed. ([#11937](https://github.com/craftcms/cms/pull/11937))\n- Fixed a bug where image transform dimensions could be calculated incorrectly when `upscaleImages` was `false`. ([#11837](https://github.com/craftcms/cms/issues/11837))\n- Fixed a bug where the `users/send-password-reset-email` action wasn\u2019t passing errors back to the template. ([#11933](https://github.com/craftcms/cms/issues/11933))\n- Fixed an error that occurred when setting a non-numeric `width` or `height` on an image transform. ([#11837](https://github.com/craftcms/cms/issues/11837))\n- Fixed a bug where the database connection wasn\u2019t being configured properly when fluent config methods and environment variable overrides were being used in combination. ([#11941](https://github.com/craftcms/cms/issues/11941))\n- Fixed a bug where slideouts lost their shadows when focused.\n- Fixed a bug where `relatedTo*` arguments weren\u2019t supported by `children` fields in GraphQL. ([#11918](https://github.com/craftcms/cms/issues/11918))\n- Fixed a bug where Image Editor and slideout action buttons were obstructed when the Debug Toolbar was enabled. ([#11965](https://github.com/craftcms/cms/issues/11965))\n- Fixed an error that occurred when installing Craft when MySQL\u2019s `sql_require_primary_key` setting was enabled. ([#11374](https://github.com/craftcms/cms/discussions/11374))\n- Fixed a bug subfolders created by Assets fields could be reported as missing when updating asset indexes, even if they contained assets. ([#11949](https://github.com/craftcms/cms/issues/11949))\n- Fixed a PHP error that could occur in a potential race condition when calling  `craft\\helpers\\FileHelper::clearDirectory()`.\n- Fixed a bug where Structure section entries that were duplicated via the \u201cSave as a new entry\u201d action on a provisional draft weren\u2019t being placed within the structure properly.\n- Fixed a bug where element\u2019s `searchScore` properties would be set to `null` when their original score was below 1, rather than rounding to 0 or 1. ([#11973](https://github.com/craftcms/cms/issues/11973))\n\n## 4.2.4 - 2022-09-13\n\n### Changed\n- The \u201cNew entry\u201d and \u201cNew category\u201d buttons on the Entries and Categories index pages now support <kbd>Ctrl</kbd>/<kbd>Command</kbd>/middle-clicking to open the edit page in a new window. ([#11870](https://github.com/craftcms/cms/issues/11870))\n- Control panel menus now automatically reposition themselves when the window is resized.\n- Improved the performance of some element queries on MySQL. ([#11825](https://github.com/craftcms/cms/pull/11825))\n- `resave/*` commands now have a `--touch` option. When passed, elements\u2019 `dateUpdated` timestamps will be updated as they\u2019re resaved. ([#11849](https://github.com/craftcms/cms/discussions/11849))\n- Underscores within query param values that begin/end with `*` are now escaped, so they aren\u2019t treated as wildcard characters by the `like` condition. ([#11898](https://github.com/craftcms/cms/issues/11898))\n- `craft\\services\\Elements::resaveElements()` now has a `$touch` argument.\n- Disable the preview button while drafts are saving ([#11858](https://github.com/craftcms/cms/issues/11858))\n\n### Fixed\n- Fixed an error that could occur when upgrading to Craft 4, if any Matrix blocks contained null `sortOrder` values. ([#11843](https://github.com/craftcms/cms/issues/11843))\n- Fixed a bug where image transform dimensions could be calculated incorrectly when `upscaleImages` was `false`. ([#11837](https://github.com/craftcms/cms/issues/11837))\n- Fixed an error that occurred when parsing an image transform string that was missing an interlace type. ([#11834](https://github.com/craftcms/cms/pull/11834))\n- Fixed a bug where element caches weren\u2019t being invalidated during garbage collection, so hard-deleted elements could appear to still exist.\n- Fixed a bug where image transforms were always getting saved with `dateIndexed` set to `null`. ([#11863](https://github.com/craftcms/cms/pull/11863))\n- Fixed an error that could occur when rendering front-end templates if there was a problem connecting to the database. ([#11855](https://github.com/craftcms/cms/issues/11855))\n- Fixed a bug where Edit Asset pages were showing the \u201cView\u201d button for assets in volumes without public URLs. ([#11860](https://github.com/craftcms/cms/issues/11860))\n- Fixed a bug where the Assets index page wasn\u2019t handling failed uploads properly. ([#11866](https://github.com/craftcms/cms/issues/11866))\n- Fixed a bug where it was possible to save an asset with a focal point outside its cropped area. ([#11875](https://github.com/craftcms/cms/issues/11875))\n- Fixed a bug where element index filter HUDs were unresponsive if another one was already active for a different site/source. ([#11880](https://github.com/craftcms/cms/issues/11880))\n- Fixed a bug where newly-created subfolders on the Assets index page could appear to have the wrong indentation.\n- Fixed a UI bug where renaming a newly-created volume subfolder didn\u2019t appear to have any effect.\n- Fixed a bug where empty URL fields would be marked as changed, even when no change was made to them. ([#11908](https://github.com/craftcms/cms/issues/11908))\n- Fixed a UI bug where autosuggest menus weren\u2019t getting filtered when first opened for inputs with existing values. ([#11896](https://github.com/craftcms/cms/issues/11896))\n- Fixed a bug where Entry Type condition rules weren\u2019t working for conditions that were applied to a single element. ([#11914](https://github.com/craftcms/cms/issues/11914))\n- Fixed a bug where Related To condition rules weren\u2019t working for conditions that were applied to a single element, for cross-site relations. ([#11892](https://github.com/craftcms/cms/issues/11892))\n- Fixed a bug where form action keyboard shortcuts weren\u2019t available when a custom select menu was focused. ([#11919](https://github.com/craftcms/cms/issues/11919))\n- Fixed a bug where transforming an animated GIF into a WebP file would only include the first frame. ([#11889](https://github.com/craftcms/cms/issues/11889))\n- Fixed a bug where `craft\\models\\FieldLayout::createFromConfig()` was ignoring `id`, `uid`, `type`, and `reservedFieldHandles` keys, if set. ([#11929](https://github.com/craftcms/cms/issues/11929))\n\n### Security\n- Fixed XSS vulnerabilities.\n- Password inputs no longer temporarily reveal the password when the <kbd>Alt</kbd> key is pressed. ([#11930](https://github.com/craftcms/cms/issues/11930))\n\n## 4.2.3 - 2022-08-26\n\n### Changed\n- If a plugin\u2019s license key is set to an empty environment variable, its trial license key will now be stored in `.env` rather than the project config. ([#11830](https://github.com/craftcms/cms/issues/11830))\n\n### Fixed\n- Fixed a PHP error that occurred when garbage collection was run on web requests. ([#11829](https://github.com/craftcms/cms/issues/11829))\n\n## 4.2.2 - 2022-08-23\n\n### Added\n- Added the `utils/fix-field-layout-uids` command. ([#11746](https://github.com/craftcms/cms/issues/11746))\n\n### Changed\n- Improved the styling of Categories fields.\n- The first field group is now automatically selected by default when creating a new custom field.\n- Improved console output for the `gc` command.\n- The `gc` command now runs garbage collection for data caches.\n- Exception JSON responses now include `name` and `code` keys. ([#11799](https://github.com/craftcms/cms/discussions/11799))\n- `elements/*` actions no longer include custom field values in the failure response data, improving performance. ([#11807](https://github.com/craftcms/cms/discussions/11807))\n\n### Fixed\n- Fixed a bug where keyboard focus wasn\u2019t being maintained when changing the element type within a \u201cRelated To\u201d condition rule.\n- Fixed a bug where keyboard focus wasn\u2019t being maintained when changing the country within an address\u2019s \u201cAdministrative Area\u201d condition rule.\n- Fixed a bug where Date fields\u2019 Timezone menus could be clipped. ([#11780](https://github.com/craftcms/cms/pull/11780))\n- Fixed an error that could occur when saving an unpublished draft, if any custom validation errors were added to it after its draft status had been removed. ([#11407](https://github.com/craftcms/cms/issues/11407))\n- Fixed a bug where custom validation errors would be shown twice for unpublished drafts, if they were added to it after its draft status had been removed. ([#11407](https://github.com/craftcms/cms/issues/11407))\n- Fixed PHP warnings that would occur when passing `0` into `craft\\helpers\\DateTimeHelper::humanDuration()`. ([#11787](https://github.com/craftcms/cms/issues/11787))\n- Fixed a bug where selected assets weren\u2019t getting automatically replaced when an image was edited and \u201cSave as a new asset\u201d was chosen. ([#11805](https://github.com/craftcms/cms/issues/11805))\n- Fixed a JavaScript error that occurred when editing a user via a slideout, if the user had any addresses. ([#11810](https://github.com/craftcms/cms/issues/11810))\n- Fixed a bug where some invalid slideout submissions weren\u2019t being handled properly. ([#11812](https://github.com/craftcms/cms/issues/11812))\n- Fixed a bug where `craft\\helpers\\DateTimeHelper::toDateInterval()` was returning negative interval durations when integers were passed in. ([#11814](https://github.com/craftcms/cms/pull/11814))\n- Fixed a bug where `iframeResizer.contentWindow.js` was getting loaded for all preview requests, not just Live Preview, and even when `useIframeResizer` was disabled. ([#11778](https://github.com/craftcms/cms/issues/11778))\n- Fixed a bug where deleted relations and Matrix blocks could persist if the edit form was submitted before they had been fully animated away. ([#11789](https://github.com/craftcms/cms/issues/11789))\n- Fixed a PHP error that could occur if `craft\\services\\Assets::getUserTemporaryUploadFolder()` was called when there was no logged-in user account. ([#11751](https://github.com/craftcms/cms/issues/11751))\n\n## 4.2.1.1 - 2022-08-10\n\n### Fixed\n- Fixed a bug where saving an element with invalid field values could result in some field values being forgotten. ([#11756](https://github.com/craftcms/cms/issues/11756))\n- Fixed a bug where it wasn\u2019t always possible to serve asset bundles via `webpack-dev-server` over SSL. ([#11758](https://github.com/craftcms/cms/pull/11758))\n\n## 4.2.1 - 2022-08-09\n\n### Added\n- Added the `project-config/export` command. ([#11733](https://github.com/craftcms/cms/pull/11733))\n- Added `craft\\config\\GeneralConfig::getRememberedUserSessionDuration()`.\n- Added `craft\\helpers\\DateTimeHelper::toDateInterval()`.\n\n### Changed\n- \u201cRelated To\u201d condition rules are now available for conditions that are stored in the project config. ([#11740](https://github.com/craftcms/cms/issues/11740))\n- Element index filters are now managed for each site and source, rather than just for each source. ([#11719](https://github.com/craftcms/cms/issues/11719))\n- `craft\\config\\DbConfig::dsn()` now parses the DSN string and populates the other DSN-settable config properties.\n- `craft\\helpers\\DateTimeHelper::humanDuration()` no longer returns the number of weeks, unless the number of days is divisible by 7. ([#11594](https://github.com/craftcms/cms/discussions/11594))\n- `craft\\helpers\\DateTimeHelper::humanDuration()` now accepts date interval strings to be passed in.\n- `craft\\helpers\\Db::url2config()` now returns `driver`, `server`, `port`, and `database` keys, when possible. ([#11735](https://github.com/craftcms/cms/issues/11735))\n- `craft\\services\\Assets::getImagePreviewUrl()` now throws a `yii\\base\\NotSupportedException` if a preview URL could not be generated for the asset, rather than causing a PHP error.\n\n### Deprecated\n- Deprecated `craft\\helpers\\DateTimeHelper::secondsToInterval()`. `toDateInterval()` should be used instead.\n\n### Fixed\n- Fixed a bug where database connections would always use port `3306` by default if `craft\\config\\DbConfig` had been configured via fluent methods, even for PostgreSQL.\n- Fixed a bug where system messages provided by Yii weren\u2019t getting translated in some cases. ([#11712](https://github.com/craftcms/cms/issues/11712))\n- Fixed a bug where the \u201cKeep me signed in\u201d checkbox label wasn\u2019t always accurately representing the `rememberedUserSessionDuration` config setting. ([#11594](https://github.com/craftcms/cms/discussions/11594))\n- Fixed a bug where the `Craft.cp.setSiteId()` JavaScript method wasn\u2019t updating `Craft.siteId`, or the base URLs used by `Craft.getActionUrl()`, `Craft.getCpUrl()`, and `Craft.getUrl()`.\n- Fixed an error that occurred when removing a Single section from the primary site, if it contained any Matrix blocks. ([#11669](https://github.com/craftcms/cms/issues/11669))\n- Fixed a bug where Matrix sub-fields weren\u2019t showing their validation errors when `autosaveDrafts` was `false`. ([#11731](https://github.com/craftcms/cms/issues/11731))\n- Fixed a bug where saving an element with invalid field values could result in the invalid values being forgotten, rather than re-validated. ([#11731](https://github.com/craftcms/cms/issues/11731))\n- Fixed a bug where the database connection would be misconfigured if the `url` connection setting was used. ([#11735](https://github.com/craftcms/cms/issues/11735))\n- Fixed a bug where the element index filter HUDs weren\u2019t always visually aligned with the search input. ([#11739](https://github.com/craftcms/cms/issues/11739))\n- Fixed a bug where it wasn\u2019t possible to preview or edit image assets if their filesystem and transform filesystem didn\u2019t have public URLs. ([#11686](https://github.com/craftcms/cms/issues/11686), [#11687](https://github.com/craftcms/cms/issues/11687))\n- Fixed a bug where not all project config changes would be applied if a site was deleted. ([#9567](https://github.com/craftcms/cms/issues/9567))\n- Fixed a bug where `$` characters in database connection passwords weren\u2019t being escaped property when backing up/restoring the database. ([#11750](https://github.com/craftcms/cms/issues/11750))\n\n### Security\n- Fixed XSS vulnerabilities.\n\n## 4.2.0.2 - 2022-07-27\n\n### Fixed\n- Fixed a bug where `Garnish.uiShortcutManager` was getting double-instantiated, causing some keyboard shortcuts to be triggered multiple times.\n- Fixed a JavaScript error that occurred when switching sites in the control panel. ([#11709](https://github.com/craftcms/cms/issues/11709))\n- Fixed a bug where some config settings set via fluent setters weren\u2019t getting normalized.\n- Fixed a bug where the database connection DSN string wasn\u2019t getting built properly when the connection settings were set via fluent setters.\n\n## 4.2.0.1 - 2022-07-26\n\n### Fixed\n- Fixed an error that could occur when passing an object into `craft\\helpers\\ArrayHelper::removeValue()` or the `|without` filter.\n\n## 4.2.0 - 2022-07-26\n\n### Added\n- The control panel is now translated into Ukrainian.\n- Element conditions can now include condition rules for Matrix fields. ([#11620](https://github.com/craftcms/cms/issues/11620))\n- Element conditions can now include condition rules for Money fields. ([#11560](https://github.com/craftcms/cms/issues/11560))\n- Added the \u201cNotification Duration\u201d user accessibility preference. ([#11612](https://github.com/craftcms/cms/pull/11612))\n- The `accessibilityDefaults` config setting now supports a `notificationDuration` key.\n- Added `craft\\behaviors\\SessionBehavior::getSuccess()`.\n- Added `craft\\behaviors\\SessionBehavior::setSuccess()`.\n- Added `craft\\config\\BaseConfig`. ([#11591](https://github.com/craftcms/cms/pull/11591), [#11656](https://github.com/craftcms/cms/pull/11656))\n- Added `craft\\controllers\\UsersController::EVENT_AFTER_FIND_LOGIN_USER`. ([#11645](https://github.com/craftcms/cms/pull/11645))\n- Added `craft\\controllers\\UsersController::EVENT_BEFORE_FIND_LOGIN_USER`. ([#11645](https://github.com/craftcms/cms/pull/11645))\n- Added `craft\\events\\DefineFieldLayoutCustomFieldsEvent`.\n- Added `craft\\events\\FindLoginUserEvent`.\n- Added `craft\\events\\IndexKeywordsEvent`.\n- Added `craft\\fields\\conditions\\EmptyFieldConditionRule`.\n- Added `craft\\helpers\\DateTimeHelper::humanDuration()`.\n- Added `craft\\helpers\\Template::resolveTemplatePathAndLine()`.\n- Added `craft\\models\\FieldLayout::EVENT_DEFINE_CUSTOM_FIELDS`. ([#11634](https://github.com/craftcms/cms/discussions/11634))\n- Added `craft\\services\\Config::getLoadingConfigFile()`.\n- Added `craft\\services\\Elements::EVENT_INVALIDATE_CACHES`. ([#11617](https://github.com/craftcms/cms/pull/11617))\n- Added `craft\\services\\Search::EVENT_BEFORE_INDEX_KEYWORDS`. ([#11575](https://github.com/craftcms/cms/discussions/11575))\n\n### Changed\n- Redesigned user notifications. ([#11612](https://github.com/craftcms/cms/pull/11612))\n- Most element notifications now include a link to the element. ([#11612](https://github.com/craftcms/cms/pull/11612))\n- Improved overall control panel accessibility. ([#11563](https://github.com/craftcms/cms/pull/11563), [#11543](https://github.com/craftcms/cms/pull/11543), [#11688](https://github.com/craftcms/cms/pull/11688), [#11699](https://github.com/craftcms/cms/pull/11699))\n- Improved condition builder accessibility. ([#11588](https://github.com/craftcms/cms/pull/11588), [#11643](https://github.com/craftcms/cms/pull/11643))\n- Improved Image Editor accessibility. ([#11496](https://github.com/craftcms/cms/pull/11496))\n- The \u201cKeep me signed in\u201d checkbox label on the control panel\u2019s login page now includes the remembered session duration, e.g. \u201cKeep me signed in for 2 weeks\u201d. ([#11594](https://github.com/craftcms/cms/discussions/11594))\n- Dashboard widgets no longer show a confirmation dialog when deleted. Their delete notifications include an \u201cUndo\u201d button instead. ([#11573](https://github.com/craftcms/cms/discussions/11573))\n- Element edit pages no longer jump down when the \u201cShowing your unsaved changes\u201d notice is added, unless there\u2019s not enough content to require a scroll bar. ([#11586](https://github.com/craftcms/cms/discussions/11586))\n- Matrix block previews now show selected option labels rather than their raw values. ([#11659](https://github.com/craftcms/cms/issues/11659))\n- Improved the behavior of some console commands for non-interactive shells. ([#11650](https://github.com/craftcms/cms/issues/11650))\n- The `utils/prune-revisions` console command now has a `--section` option. ([#8783](https://github.com/craftcms/cms/discussions/8783))\n- Deprecation warnings\u2019 stack traces now show source templates\u2019 paths and line numbers.\n- Exception JSON responses now include the previous exception details, recursively. ([#11694](https://github.com/craftcms/cms/discussions/11694))\n- `config/general.php` and `config/db.php` can now return `craft\\config\\GeneralConfig`/`DbConfig` objects, which can be defined using new fluent setter methods. ([#11591](https://github.com/craftcms/cms/pull/11591), [#11656](https://github.com/craftcms/cms/pull/11656))\n- The `|duration` Twig filter can now be used with an integer representing a number of seconds, and its `showSeconds` argument is no longer required. Seconds will be output if the duration is less than one minute by default.\n- The `|length` Twig filter now checks if the variable is a query, and if so, returns its count. ([#11625](https://github.com/craftcms/cms/discussions/11625))\n- The `|without` Twig filter no longer uses strict value comparisons by default. It has a new `$strict` argument that can be set to `true` to enforce strict comparisons if desired. ([#11695](https://github.com/craftcms/cms/issues/11695))\n- `craft\\base\\conditions\\BaseConditionRule::inputHtml()` is no longer abstract, and returns an empty string by default.\n- `craft\\behaviors\\SessionBehavior::setError()` now has a `$settings` argument.\n- `craft\\behaviors\\SessionBehavior::setNotice()` now has a `$settings` argument.\n- `craft\\db\\Query` now implements the `ArrayAccess` and `IteratorAggregate` interfaces, so queries (including element queries) can be treated as arrays.\n- `craft\\helpers\\ArrayHelper::removeValue()` no longer uses strict value comparisons by default. It has a new `$strict` argument that can be set to `true` to enforce strict comparisons if desired.\n- `craft\\web\\Controller::asSuccess()` now has a `$notificationSettings` argument.\n- `craft\\web\\Controller::setFailFlash()` now has a `$settings` argument.\n- `craft\\web\\Controller::setSuccessFlash()` now has a `$settings` argument.\n\n### Deprecated\n- Deprecated `craft\\helpers\\DateTimeHelper::humanDurationFromInterval()`. `humanDuration()` should be used instead.\n- Deprecated `craft\\helpers\\DateTimeHelper::secondsToHumanTimeDuration()`. `humanDuration()` should be used instead.\n\n### Fixed\n- Fixed a bug where new condition rules\u2019 type selectors weren\u2019t getting auto-focused.\n- Fixed a bug where Quick Post widgets weren\u2019t submitting custom field values.\n- Fixed a bug where assets\u2019 `getImg()` methods were returning `null` for assets in volumes without URLs, even if a transform was being used. ([#11614](https://github.com/craftcms/cms/issues/11614))\n- Fixed a bug where sensitive data wasn\u2019t getting redacted in the logs when Dev Mode was enabled. ([#11618](https://github.com/craftcms/cms/issues/11618))\n- Fixed a SQL error that could occur on MySQL 5. ([#11596](https://github.com/craftcms/cms/issues/11596))\n- Fixed an error that could occur when upgrading to Craft 4. ([#11644](https://github.com/craftcms/cms/issues/11644))\n- Fixed a bug where the green color used in lightswitches was too dark. ([#11653](https://github.com/craftcms/cms/issues/11653))\n- Fixed a bug where relational and Matrix fields were assuming their values hadn\u2019t been eager-loaded on element save. ([#11667](https://github.com/craftcms/cms/issues/11667), [#11670](https://github.com/craftcms/cms/issues/11670))\n- Fixed a bug where deprecation warnings for treating an element query as an array weren\u2019t getting logged with an origin, if they involved Twig\u2019s `|batch` filter. ([#11597](https://github.com/craftcms/cms/issues/11597))\n- Fixed a bug where `{% js %}`, `{% script %}`, and `{% css %}` tags weren\u2019t registering JavaScript and CSS code properly when used within a `{% cache %}` tag that contained an ungenerated image transform. ([#11602](https://github.com/craftcms/cms/issues/11602))\n- Fixed a bug where the \u201cUser saved\u201d notification was translated for the former language, when changing the current user\u2019s language preference.\n- Fixed a JavaScript error that occurred when removing a category from a Categories field, if any of its descendants were selected as well. ([#11641](https://github.com/craftcms/cms/issues/11641))\n- Fixed a bug where links to config settings from **Settings** \u2192 **General** didn\u2019t include the correct setting anchors. ([#11665](https://github.com/craftcms/cms/pull/11665))\n- Fixed styling issues with Live Preview in Firefox.\n\n### Security\n- Fixed an information disclosure vulnerability.\n\n## 4.1.4.1 - 2022-07-13\n\n### Fixed\n- Fixed a bug where `craft\\services\\Assets::getRootFolderByVolumeId()` wasn\u2019t returning the root folder. ([#11593](https://github.com/craftcms/cms/issues/11593))\n\n## 4.1.4 - 2022-07-12\n\n### Added\n- Added `craft\\models\\FieldLayout::getVisibleCustomFieldElements()`.\n\n### Changed\n- Relation fields now focus on the next related element\u2019s \u201cRemove\u201d button when an element is removed. ([#11577](https://github.com/craftcms/cms/issues/11577))\n\n### Deprecated\n- Deprecated `craft\\base\\FieldTrait::$required`. `craft\\fieldlayoutelements\\BaseField::$required` should be used instead.\n\n### Fixed\n- Fixed a bug where assets\u2019 native Alternative Text fields were getting mislabeled as translatable. ([#11576](https://github.com/craftcms/cms/issues/11576))\n- Fixed a bug where fields nested within Neo fields could be incorrectly validated as required. ([#11574](https://github.com/craftcms/cms/issues/11574))\n- Fixed a PHP error that occurred when editing a Date field with a Min Date setting set.\n- Fixed a bug where date range inputs weren\u2019t working on mobile. ([#11571](https://github.com/craftcms/cms/issues/11571))\n- Fixed a bug where the \u201cCraft Support\u201d Dashboard widget wasn\u2019t being labeled properly in the widget settings HUD and delete confirmation dialog. ([#11573](https://github.com/craftcms/cms/discussions/11573))\n- Fixed a bug where the project config cache was getting invalidated on each public GraphQL API request.\n\n## 4.1.3 - 2022-07-07\n\n### Changed\n- Address fields now show required indicators based on the configured validation rules. ([#11566](https://github.com/craftcms/cms/pull/11566))\n\n### Fixed\n- Fixed a JavaScript error that occurred on the Updates utility. ([#11567](https://github.com/craftcms/cms/issues/11567))\n- Fixed a bug where Craft\u2019s Composer commands could produce a malformed `composer.json` file. ([#11564](https://github.com/craftcms/cms/issues/11564))\n\n## 4.1.2 - 2022-07-06\n\n### Added\n- Added `craft\\helpers\\ProjectConfig::ensureAllFilesystemsProcessed()`.\n\n### Changed\n- Relational field condition rules now have the \u201cis related to\u201d operator selected by default. ([#11550](https://github.com/craftcms/cms/discussions/11550))\n\n### Fixed\n- Fixed a bug where the Updates utility wasn\u2019t checking for updates properly. ([#11552](https://github.com/craftcms/cms/issues/11552))\n- Fixed an error that could occur when deploying a Craft 4 upgrade to another server. ([#11558](https://github.com/craftcms/cms/issues/11558))\n- Fixed a bug where Assets fields were relocating assets when saving a revision.\n- Fixed a bug where asset bundles weren\u2019t getting registered on the front end. ([#11555](https://github.com/craftcms/cms/issues/11555))\n\n## 4.1.1 - 2022-07-05\n\n### Changed\n- Improved the control panel tab design. ([#11524](https://github.com/craftcms/cms/pull/11524))\n- Changed the order of relational field condition rule operators, so \u201cis related to\u201d is listed first. ([#11550](https://github.com/craftcms/cms/discussions/11550))\n- Template caching is now supported for console requests, for `{% cache %}` tags that have the `globally` param. ([#11551](https://github.com/craftcms/cms/issues/11551))\n- Updated Composer to 2.2.15. ([#11538](https://github.com/craftcms/cms/issues/11538))\n\n### Fixed\n- Fixed an error that could occur if any custom fields were missing their field group. ([#11522](https://github.com/craftcms/cms/discussions/11522))\n- Fixed a bug where custom selects weren\u2019t scrolling to the visually-focused option.\n- Fixed errors that could occur if an element condition contained any rules for deleted custom fields. ([#11526](https://github.com/craftcms/cms/issues/11526))\n- Fixed a bug where the \u201cDeactivate users by default\u201d user setting wasn\u2019t working. ([#11519](https://github.com/craftcms/cms/issues/11519))\n- Fixed a styling issue with the Edit Route modal. ([#11528](https://github.com/craftcms/cms/issues/11528))\n- Fixed a bug where assets uploaded from Assets fields weren\u2019t retaining their original filename. ([#11530](https://github.com/craftcms/cms/issues/11530))\n- Fixed a bug where project config changes made at the end of the request lifecycle weren\u2019t getting saved.\n- Fixed a bug where toggling entries\u2019 and categories\u2019 site-specific statuses from element editor slideouts wasn\u2019t working. ([#11547](https://github.com/craftcms/cms/issues/11547))\n- Fixed a SQL error that occurred when running the `utils/prune-provisional-drafts` command. ([#11548](https://github.com/craftcms/cms/issues/11548))\n- Fixed focus styling issues with the Edit Route modal.\n\n## 4.1.0.2 - 2022-06-28\n\n### Fixed\n- Fixed a PHP error. ([#11518](https://github.com/craftcms/cms/issues/11518))\n\n## 4.1.0.1 - 2022-06-28\n\n### Fixed\n- Fixed an infinite recursion bug. ([#11514](https://github.com/craftcms/cms/issues/11514))\n\n## 4.1.0 - 2022-06-28\n\n### Added\n- Field layouts can now have \u201cLine Break\u201d UI elements. ([#11328](https://github.com/craftcms/cms/discussions/11328))\n- Added the `db/drop-all-tables` command. ([#11288](https://github.com/craftcms/cms/pull/11288))\n- Added the `elements/delete` command.\n- Added the `elements/restore` command.\n- Added the `project-config/get` command. ([#11341](https://github.com/craftcms/cms/pull/11341))\n- Added the `project-config/remove` command. ([#11341](https://github.com/craftcms/cms/pull/11341))\n- Added the `project-config/set` command. ([#11341](https://github.com/craftcms/cms/pull/11341))\n- The `AdminTable` Vue component can now be included into other Vue apps, in addition to being used as a standalone app. ([#11107](https://github.com/craftcms/cms/pull/11107))\n- Added a `one()` alias for `first()` to collections. ([#11134](https://github.com/craftcms/cms/discussions/11134))\n- Added `craft\\base\\Element::EVENT_DEFINE_CACHE_TAGS`. ([#11171](https://github.com/craftcms/cms/discussions/11171))\n- Added `craft\\base\\Element::cacheTags()`.\n- Added `craft\\base\\FieldInterface::getLabelId()`.\n- Added `craft\\console\\controllers\\UsersController::$activate`.\n- Added `craft\\elements\\conditions\\ElementCondition::$sourceKey`.\n- Added `craft\\elements\\db\\ElementQuery::EVENT_AFTER_POPULATE_ELEMENTS`. ([#11262](https://github.com/craftcms/cms/discussions/11262))\n- Added `craft\\elements\\db\\ElementQuery::EVENT_DEFINE_CACHE_TAGS`. ([#11171](https://github.com/craftcms/cms/discussions/11171))\n- Added `craft\\events\\PopulateElementsEvent`.\n- Added `craft\\fieldlayoutelements\\BaseField::labelId()`.\n- Added `craft\\fieldlayoutelements\\LineBreak`.\n- Added `craft\\helpers\\DateTimeHelper::now()`.\n- Added `craft\\helpers\\DateTimeHelper::pause()`. ([#11130](https://github.com/craftcms/cms/pull/11130))\n- Added `craft\\helpers\\DateTimeHelper::resume()`. ([#11130](https://github.com/craftcms/cms/pull/11130))\n\n### Changed\n- Improved overall control panel accessibility. ([#11297](https://github.com/craftcms/cms/pull/11297), [#11296](https://github.com/craftcms/cms/pull/11296), [#11414](https://github.com/craftcms/cms/pull/11414), [#11452](https://github.com/craftcms/cms/pull/11452))\n- Improved pagination UI accessibility. ([#11126](https://github.com/craftcms/cms/pull/11126))\n- Improved element index accessibility. ([#11169](https://github.com/craftcms/cms/pull/11169), [#11200](https://github.com/craftcms/cms/pull/11200), [#11251](https://github.com/craftcms/cms/pull/11251))\n- Improved Dashboard accessibility. ([#11217](https://github.com/craftcms/cms/pull/11217), [#11297](https://github.com/craftcms/cms/pull/11297))\n- Improved address management accessibility. ([#11397](https://github.com/craftcms/cms/pull/11397))\n- Improved Matrix field accessibility. ([#11306](https://github.com/craftcms/cms/pull/11306))\n- Improved mobile support. ([#11323](https://github.com/craftcms/cms/pull/11323), [#11430](https://github.com/craftcms/cms/pull/11430))\n- Improved keyboard support for custom selects. ([#11414](https://github.com/craftcms/cms/pull/11414))\n- It\u2019s now possible to remove all selected elements from relational fields by pressing <kbd>Backspace</kbd> or <kbd>Delete</kbd> while one of them is focused.\n- Improved the UI of condition builders. ([#11386](https://github.com/craftcms/cms/pull/11386))\n- Entry Type condition rules now allow multiple selections. ([#11124](https://github.com/craftcms/cms/pull/11124))\n- Element index filters now only show condition rules for the custom fields that are used by the field layouts in the selected source, if a native source is selected. ([#11187](https://github.com/craftcms/cms/discussions/11187))\n- Element index filters now only show condition rules for custom fields used by field layouts created for the target element type, if no native source is selected.\n- Condition builders can now include multiple rules with the same label, as long as they\u2019re in different groups.\n- Asset indexes now have a \u201cLocation\u201d table attribute option. ([#11450](https://github.com/craftcms/cms/discussions/11450))\n- It\u2019s now possible to sort entries by their section and type. ([#9192](https://github.com/craftcms/cms/discussions/9192), [#11335](https://github.com/craftcms/cms/discussions/11335))\n- It\u2019s now possible to sort assets by their file kind.\n- Element editor metadata now lists elements\u2019 IDs.\n- Live Preview now always shows a \u201cRefresh\u201d button, regardless of whether the preview target has auto-refresh enabled. ([#11160](https://github.com/craftcms/cms/discussions/11160))\n- Sites\u2019 Language settings now display the locale IDs as option hints, rather than the languages\u2019 native names. ([#11195](https://github.com/craftcms/cms/discussions/11195))\n- Selectize options can now specify searchable `keywords` that won\u2019t be visible in the UI.\n- Selectize inputs will now include their options\u2019 values as search keywords.\n- Newly-created entries now get placeholder Post Date set on them, so they get sorted appropriately when querying for entries ordered by `postDate`. ([#11272](https://github.com/craftcms/cms/issues/11272))\n- Element queries can now pass columns into the `orderBy` param in addition to `score` when searching. ([#11470](https://github.com/craftcms/cms/pull/11470), [#11457](https://github.com/craftcms/cms/discussions/11457))\n- Field layout elements within field layout designers now support double-clicking to open their settings slideout. ([#11277](https://github.com/craftcms/cms/discussions/11277))\n- The control panel\u2019s JavaScript queue is now paused when the browser tab isn\u2019t visible. ([#10632](https://github.com/craftcms/cms/issues/10632))\n- The `db/restore` command now asks whether the database should be backed up, and whether all existing database tables should be dropped, prior to restoring the backup. ([#11288](https://github.com/craftcms/cms/pull/11288))\n- The `users/create` command now asks whether the user should be activated when saved.\n- The `maxBackups` config setting now impacts `.sql.zip` files in addition to `.sql` files. ([#11241](https://github.com/craftcms/cms/issues/11241))\n- Deprecation messages are now consistently referred to as \u201cdeprecation warnings\u201d in the control panel.\n- Callback functions returned by elements\u2019 `sortOptions()`/`defineSortOptions()` methods are now passed a `craft\\db\\Connection` object as a second argument.\n- All element sources now have a \u201cSet Status\u201d action, even if the element type\u2019s `defineActions()` method didn\u2019t include one, if the element type\u2019s `hasStatuses()` method returns `true`. ([#11383](https://github.com/craftcms/cms/discussions/11383))\n- All element sources now have a \u201cView\u201d action, even if the element type\u2019s `defineActions()` method didn\u2019t include one, if the element type\u2019s `hasUris()` method returns `true`. ([#11383](https://github.com/craftcms/cms/discussions/11383))\n- All element sources now have \u201cEdit\u201d and \u201cDelete\u201d actions, even if the element type\u2019s `defineActions()` method didn\u2019t include them. ([#11383](https://github.com/craftcms/cms/discussions/11383))\n- The \u201cSet Status\u201d and \u201cEdit\u201d element actions are now only available for elements whose `canSave()` method returned `true`.\n- Assets fields now reject uploaded files which don\u2019t pass their \u201cSelectable Assets Condition\u201d setting. ([#11433](https://github.com/craftcms/cms/issues/11433))\n- It\u2019s now possible to save new assets without setting their `filename` or `kind` attributes, as long as `newLocation` or `newFilename` is set. ([#11439](https://github.com/craftcms/cms/issues/11439))\n- The `searchindex` table is now uses the InnoDB storage engine by default for MySQL installs. ([#11374](https://github.com/craftcms/cms/discussions/11374))\n- The `_layouts/elementindex` control panel template now sets the page title based on the element\u2019s `pluralDisplayName()` method by default. ([#11502](https://github.com/craftcms/cms/pull/11502))\n- `craft\\test\\ActiveFixture::$data` is now populated with the active record instances, making them accessible to tests via `$this->tester->grabFixture('my-fixture', 'data-key')`. ([#11445](https://github.com/craftcms/cms/pull/11445))\n- Address validation rules are now defined by `defineRules()`. ([#11471](https://github.com/craftcms/cms/pull/11471))\n- `Garnish.DELETE_KEY` now refers to the actual <kbd>Delete</kbd> key code, and the <kbd>Backspace</kbd> key code is now referenced by `Garnish.BACKSPACE_KEY`.\n\n### Deprecated\n- Deprecated `craft\\elements\\actions\\DeleteAssets`. `craft\\elements\\actions\\Delete` should be used instead.\n\n### Removed\n- Removed `craft\\elements\\conditions\\entries\\EntryTypeCondition::$sectionUid`.\n- Removed `craft\\elements\\conditions\\entries\\EntryTypeCondition::$entryTypeUid`.\n\n## 4.0.6 - 2022-06-28\n\n### Added\n- Added `craft\\fields\\BaseOptionsField::encodeValue()`.\n\n### Changed\n- Improved the `install` command\u2019s error output when invalid options were passed.\n- `canonical` is now a reserved field handle. ([#11503](https://github.com/craftcms/cms/issues/11503))\n- `craft\\fields\\BaseOptionsField::translatedOptions()` now has an `$encode` argument.\n\n### Fixed\n- Fixed a bug where self relations within relational fields were being forgotten. ([#11461](https://github.com/craftcms/cms/issues/11461))\n- Fixed a bug where the `install` command required `--site-name`, `--site-url`, and `--language` options to be passed when project config YAML was already present. ([#11513](https://github.com/craftcms/cms/issues/11513))\n- Fixed a bug where `Garnish.setFocusWithin()` wasn\u2019t working if the first focusable element was a checkbox. ([#11498](https://github.com/craftcms/cms/discussions/11498))\n- Fixed a bug where Matrix blocks could be saved in the wrong order.\n- Fixed a bug where Checkboxes, Dropdown, Multi-select, and Radio Buttons fields could lose their values if their option values were set to integers. ([#11461](https://github.com/craftcms/cms/issues/11461))\n\n## 4.0.5.2 - 2022-06-24\n\n### Fixed\n- Fixed a SQL error that could occur on MySQL 5. ([#11493](https://github.com/craftcms/cms/issues/11493))\n- Fixed a bug where Craft\u2019s Composer commands weren\u2019t ensuring that `config.allow-plugins.yiisoft/yii2-composer` was `true` in `composer.json`. ([#11399](https://github.com/craftcms/cms/issues/11399))\n\n## 4.0.5.1 - 2022-06-22\n\n### Fixed\n- Fixed a bug where not all changes to entries and categories created via the \u201cSave and add another\u201d action were propagating to other sites. ([#11476](https://github.com/craftcms/cms/issues/11476))\n- Fixed a bug where it wasn\u2019t possible to rename assets.\n- Fixed a bug where a provisional draft could be created for an entry if its form was interacted with before the page had fully initialized. ([#11466](https://github.com/craftcms/cms/issues/11466))\n- Fixed exact phrase searching on PostgreSQL. ([#11486](https://github.com/craftcms/cms/issues/11486))\n\n## 4.0.5 - 2022-06-21\n\n### Added\n- Added `craft\\helpers\\Number::isIntOrFloat()`.\n\n### Changed\n- Categories now support change tracking.\n- Improved performance when working with temp asset folders.\n- Temp asset folders are no longer created until they\u2019re actually needed. ([#11427](https://github.com/craftcms/cms/issues/11427))\n- Element index queries are no longer cached if they contain a search term.\n- Search inputs within field layout designers now prevent the containing form from being submitted when the <kbd>Return</kbd> key is pressed. ([#11415](https://github.com/craftcms/cms/discussions/11415))\n\n### Deprecated\n- Deprecated `craft\\services\\Categories::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Globals::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Sections::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Tags::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Users::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n- Deprecated `craft\\services\\Volumes::pruneDeletedField()`. ([#11054](https://github.com/craftcms/cms/discussions/11054))\n\n### Fixed\n- Fixed an error that could occur when saving an element to a disabled site. ([#10499](https://github.com/craftcms/cms/issues/10499))\n- Fixed a bug where newly-added condition rules\u2019 types were still selectable for preexisting condition rules, when they shouldn\u2019t have been.\n- Fixed a bug where field layout designers were checking the wrong setting when determining whether to include UI elements (`customizableTabs` instead of `customizableUi`).\n- Fixed a bug where the Asset Indexes utility was analyzing image transform directories and files. ([#11362](https://github.com/craftcms/cms/issues/11362), [#11384](https://github.com/craftcms/cms/pull/11384))\n- Fixed a bug where focus was getting trapped within element editor slideouts\u2019 sidebars even for wide viewports where there was enough room to display the sidebar side-by-side with other slideout content. ([#11358](https://github.com/craftcms/cms/pull/11358))\n- Fixed a bug where users\u2019 Formatting Locale preferences weren\u2019t always being respected.\n- Fixed a bug where address card menus would linger around after an address was deleted.\n- Fixed a bug where the `index-assets` command could produce unexpected output. ([#11194](https://github.com/craftcms/cms/issues/11194)).\n- Fixed a bug where video controls within asset preview modals were inaccessible via the keyboard. ([#11371](https://github.com/craftcms/cms/pull/11371))\n- Fixed a bug where `transform` GraphQL directives weren\u2019t working for Assets fields. ([#10299](https://github.com/craftcms/cms/discussions/10299))\n- Fixed a PHP error that could occur when running the `help` command. ([#11423](https://github.com/craftcms/cms/issues/11423))\n- Fixed a bug where `craft\\helpers\\App::env()` was converting some values to integers or floats unexpectedly. ([#11422](https://github.com/craftcms/cms/issues/11422))\n- Fixed a bug where changes to existing Matrix blocks weren\u2019t saving for element types that supported drafts but not change tracking. ([#11419](https://github.com/craftcms/cms/issues/11419))\n- Fixed a bug where double-clicking on a related asset\u2019s thumbnail could open the asset\u2019s preview modal. ([#11424](https://github.com/craftcms/cms/issues/11424))\n- Fixed a bug where the control panel wasn\u2019t displaying file upload failure messages.\n- Fixed a bug where `action` query params were taking precedence over `actionTrigger` URI matches, when handling action requests. ([#11435](https://github.com/craftcms/cms/issues/11435))\n- Fixed a bug where image fields within Edit User pages and the Settings \u2192 General page weren\u2019t resetting properly after an image was deleted. ([#11436](https://github.com/craftcms/cms/issues/11436))\n- Fixed a bug where User Group condition rules set to the \u201cis not one of\u201d operator weren\u2019t being applied to individual elements correctly. ([#11444](https://github.com/craftcms/cms/discussions/11444))\n- Fixed a JavaScript error that occurred on element indexes for users that didn\u2019t have permission to edit any sites.\n- Fixed a bug where users without permission to create new entries in a section could duplicate existing entries. ([#11447](https://github.com/craftcms/cms/pull/11447))\n- Fixed a bug where element selection condition rules weren\u2019t working if an element ID was provided. ([#11451](https://github.com/craftcms/cms/pull/11451))\n- Fixed a PHP error that occurred when executing a GraphQL query using a token that wasn\u2019t set to a schema. ([#11453](https://github.com/craftcms/cms/issues/11453))\n- Fixed a PHP error that could occur when unserializing a `craft\\validator\\DateTimeValidator`, `LanguageValidator`, `StringValidator`, or `TimeValidator` object. ([#11454](https://github.com/craftcms/cms/issues/11454))\n- Fixed a bug where element types\u2019 `actions()` methods were getting called for all `element-indexes/*` action requests.\n- Fixed a bug where the `install` command would run non-interactively even if not all needed options were passed, resulting in an error after the database tables had been added. ([#11305](https://github.com/craftcms/cms/issues/11305))\n- Fixed a viewport clipping bug on the control panel\u2019s Login page. ([#11372](https://github.com/craftcms/cms/pull/11372))\n- Fixed a bug where filtering an element query by a relational field using `:empty:`/`:notempty:` wasn\u2019t factoring in the field\u2019s \u201cWhich site should entries be related from?\u201d setting properly.\n- Fixed a bug where filtering an element query by a relational field using `:empty:`/`:notempty:` wasn\u2019t factoring in the source elements\u2019 site IDs, for fields set to manage relations on a per-site basis. ([#11418](https://github.com/craftcms/cms/issues/11418))\n- Fixed a bug where the Temporary Uploads asset source wasn\u2019t including subfolders.\n- Fixed a bug where file upload progress bars weren\u2019t always going away when an upload error occurred.\n- Fixed a bug where Pashto was not being treated as an RTL langauge. ([#11428](https://github.com/craftcms/cms/issues/11428))\n- Fixed a bug where the `upscaleImages` config setting wasn\u2019t being respected for transforms where only a single image dimension was specified. ([#11398](https://github.com/craftcms/cms/issues/11398))\n- Fixed an error that could occur when executing a GraphQL query, if a section didn\u2019t have any entry types. ([#11273](https://github.com/craftcms/cms/issues/11273))\n- Fixed an error that could occur when changing the primary site on installs with a large number of users. ([#11459](https://github.com/craftcms/cms/issues/11459))\n- Fixed a bug where Assets fields within Vizy fields weren\u2019t getting relocated from the user\u2019s temp uploads folder. ([#11462](https://github.com/craftcms/cms/issues/11462))\n\n### Security\n- Environment-aware control panel fields no longer suggest environment variables that begin with `HTTP_`.\n- The Sendmail mailer no longer validates if the Sendmail Command setting is set to an enivornment variable that begins with `HTTP_`.\n\n## 4.0.4 - 2022-06-03\n\n### Added\n- Added support for querying for users with a `credentialed` status.\n- Added `craft\\elements\\db\\UserQuery::STATUS_CREDENTIALED`.\n- Added `craft\\errors\\FieldNotFoundException`.\n- Added `craft\\helpers\\Html::encodeSpaces()`.\n- Added `craft\\web\\twig\\variables\\Cp::getRequestedSite()`. ([#11082](https://github.com/craftcms/cms/discussions/11082))\n\n### Changed\n- `temp` is now a reserved volume handle.\n- Improved the performance of field layout designers. ([#11298](https://github.com/craftcms/cms/issues/11298))\n- All control panel pages now have a `site--<siteHandle>` class name on the `<body>`, based on the currently-selected site. ([#11303](https://github.com/craftcms/cms/discussions/11303))\n- Warnings are no longer logged when instantiating a field layout that references a deleted custom field. ([#11333](https://github.com/craftcms/cms/issues/11333))\n- Read/write splitting is now disabled for all console requests.\n- The `db/restore` command now prompts to clear data caches after the import is complete. ([#11327](https://github.com/craftcms/cms/issues/11327))\n- Entry queries no longer factor in seconds when looking for currently-live entries, without excluding entries that were published in the past minute. ([#5389](https://github.com/craftcms/cms/issues/5389))\n- `craft\\elements\\Asset::getUrl()` now encodes any spaces in the URL as `%20` entities.\n\n### Fixed\n- Fixed a bug where it wasn\u2019t possible to disable all table columns for an element source. ([#11291](https://github.com/craftcms/cms/issues/11291))\n- Fixed a bug where the Assets index page wasn\u2019t allowing any bulk actions for assets in the temporary volume. ([#11293](https://github.com/craftcms/cms/issues/11293))\n- Fixed a bug where PHP errors thrown while rendering a template weren\u2019t being handled properly. ([#11108](https://github.com/craftcms/cms/issues/11108))\n- Fixed a bug where site status labels were inconsistent on element edit pages. ([#11307](https://github.com/craftcms/cms/issues/11307))\n- Fixed a bug where addresses\u2019 County fields were mislablled. ([#11314](https://github.com/craftcms/cms/pull/11314))\n- Fixed a bug where the control panel\u2019s login form wasn\u2019t handling errors properly. ([#11319](https://github.com/craftcms/cms/pull/11319))\n- Fixed a bug where it wasn\u2019t possible to use a `{% redirect %}` tag in an error template. ([#11336](https://github.com/craftcms/cms/issues/11336))\n- Fixed an error that occurred when saving an entry via a GraphQL mutation. ([#11312](https://github.com/craftcms/cms/issues/11312))\n- Fixed a bug where all web requests were getting no-cache headers. ([#11346](https://github.com/craftcms/cms/issues/11346))\n- Fixed a bug where user caches weren\u2019t getting invalidated when users were changed to a pending or inactive state.\n- Fixed a bug where querying for users with an `active` status was returning suspended users. ([#11370](https://github.com/craftcms/cms/pull/11370))\n- Fixed a bug where it wasn\u2019t possible to drag assets within Assets fields by their thumbnails. ([#11364](https://github.com/craftcms/cms/issues/11364))\n- Fixed a bug where asset thumbnails weren\u2019t loading if their filename contained a space. ([#11350](https://github.com/craftcms/cms/issues/11350))\n- Fixed a bug where `craft\\services\\AssetIndexer::indexFile()` wasn\u2019t removing the filename from the file path when setting the directory on the listing. ([#11365](https://github.com/craftcms/cms/issues/11365))\n- Fixed a bug where links within custom field instructions were getting mangled. ([#11377](https://github.com/craftcms/cms/issues/11377))\n- Fixed a bug where project config paths that contained slashes weren\u2019t getting handled properly. ([#10774](https://github.com/craftcms/cms/issues/10774))\n- Fixed a bug where the Login page had a tab-focusable \u201cSkip to content\u201d button. ([#11375](https://github.com/craftcms/cms/issues/11375))\n\n## 4.0.3 - 2022-05-20\n\n### Added\n- Added `craft\\elements\\db\\ElementQuery::prepareSubquery()`.\n\n### Changed\n- Element edit pages now disable pointer events on the content container for 300 milliseconds after the \u201cShowing your unsaved changes\u201d notice is displayed. ([#11229](https://github.com/craftcms/cms/issues/11229))\n- Users can now create drafts for entries they have permission to view, but not save. ([#11249](https://github.com/craftcms/cms/issues/11249))\n- User Group condition rules are no longer available in element conditions when no user groups exist. ([#11252](https://github.com/craftcms/cms/issues/11252))\n- Matrix blocks now have `data-type-name` attributes. ([#11286](https://github.com/craftcms/cms/pull/11286))\n- Reversed the order of Lightswitch fields\u2019 \u201cON Label\u201d and \u201cOFF Label\u201d settings. ([#11259](https://github.com/craftcms/cms/issues/11259))\n- `craft\\services\\Elements::duplicateElement()` now has a `$trackDuplication` argument.\n- `craft\\services\\Matrix::duplicateBlocks()` now has a `$trackDuplications` argument.\n\n### Fixed\n- Fixed a bug where dynamically-defined image transforms weren\u2019t respecting the `format` param, unless the `generateTransformsBeforePageLoad` config setting was enabled.\n- Fixed a bug where Table fields with Min Rows and Max Rows set to `1` were still showing a delete button. ([#11211](https://github.com/craftcms/cms/issues/11211))\n- Fixed an error that could occur when saving an Assets field that was restricted to a single location, at the root of a volume. ([#11212](https://github.com/craftcms/cms/issues/11212))\n- Fixed an error that could occur after a queue job execution had finished. ([#11213](https://github.com/craftcms/cms/issues/11213))\n- Fixed an error that could occur when saving an entry with Matrix blocks. ([#11155](https://github.com/craftcms/cms/issues/11155))\n- Fixed an error that occurred when saving a GraphQL schema without a scope. ([#11240](https://github.com/craftcms/cms/issues/11240))\n- Fixed an error that could occur when editing the public GraphQL schema, if a public token existed in the project config, but not the database. ([#11218](https://github.com/craftcms/cms/issues/11218))\n- Fixed some bugs with inconsistent asset indexing on Windows. ([#11174](https://github.com/craftcms/cms/issues/11174)), ([#11219](https://github.com/craftcms/cms/issues/11219))\n- Fixed a bug where custom fields weren\u2019t available to be included as table attributes. ([#11222](https://github.com/craftcms/cms/issues/11222))\n- Fixed a bug where Alternative Text wasn\u2019t available to be included as a table attribute. ([#11222](https://github.com/craftcms/cms/issues/11222))`immediately`\n- Fixed a JavaScript error that broke Matrix fields with Min Blocks and Max Blocks both set to `1`. ([#11233](https://github.com/craftcms/cms/issues/11233))\n- Fixed a bug where request context logs could appear when nothing else was logged. ([#11141](https://github.com/craftcms/cms/issues/11141))\n- Fixed a bug where stack traces could be erroneously filtered from logs.\n- Fixed a bug where removing an element from a relational field within an element editor could cause the editor to create a provisional draft, even if the element type didn\u2019t support drafts. ([#11242](https://github.com/craftcms/cms/issues/11242))\n- Fixed a bug where draft editor pages had two identical \u201cSave and continue editing\u201d alternate form actions.\n- Fixed a JavaScript warning that occurred when viewing an element edit page, if the user didn\u2019t have permission to edit it.\n- Fixed a bug where asset selector modals weren\u2019t fully initializing for Assets fields, if they were targeting the user\u2019s temp folder. ([#11254](https://github.com/craftcms/cms/issues/11254))\n- Fixed an error that occurred when saving an entry via a GraphQL mutation. ([#11258](https://github.com/craftcms/cms/issues/11258))\n- Fixed a bug where Matrix block types\u2019 layout elements were getting new UUIDs assigned each time the Matrix field was edited. ([#11248](https://github.com/craftcms/cms/issues/11248))\n- Fixed a bug where the web-based installation wizard was throwing an exception if a database connection couldn\u2019t be established, and there was no `config/db.php` file. ([#11245](https://github.com/craftcms/cms/issues/11245))\n- Fixed a bug where editable tables\u2019 delete buttons\u2019 `aria-label` attributes weren\u2019t getting updated when table rows were reordered or deleted.\n- Fixed a bug where editable tables\u2019 delete buttons weren\u2019t visually disabled when the minimum number of rows had been reached.\n- Fixed a bug where all eager-loaded `srcset`-style transform sizes were relative to the first eager-loaded transform, rather than the prior one. ([#11209](https://github.com/craftcms/cms/issues/11209))\n- Fixed a bug where eager-loaded `srcset`-style transform sizes didn\u2019t reference the prior eager-loaded transform\u2019s `format`, `interlace`, `mode`, `position`, or `quality` settings. ([#11264](https://github.com/craftcms/cms/issues/11264))\n- Fixed a bug where the web-based installation wizard wouldn\u2019t show the database connection screen if a connection could be established but no database was selected. ([#11245](https://github.com/craftcms/cms/issues/11245))\n- Fixed an error that could occur when applying a multi-site draft with relational fields. ([#11220](https://github.com/craftcms/cms/issues/11220))\n- Fixed a bug where Matrix blocks could be deleted from newly-created multi-site entries, if the edit page was reloaded. ([#10906](https://github.com/craftcms/cms/issues/10906))\n\n## 4.0.2 - 2022-05-11\n\n### Added\n- Added `craft\\events\\LocateUploadedFilesEvent`.\n- Added `craft\\fields\\Assets::EVENT_LOCATE_UPLOADED_FILES`. ([#11123](https://github.com/craftcms/cms/discussions/11123))\n\n### Changed\n- `elements/*` actions no longer include custom field values in the response data, improving performance.\n- Garnish menu buttons are now aware of the `disabled` attribute. ([#11128](https://github.com/craftcms/cms/issues/11128))\n- Improved save performance for multi-site elements ([#11113](https://github.com/craftcms/cms/issues/11113))\n- Built-in Composer actions now ensure that `composer.json` allows the `craftcms/plugin-installer` Composer plugin.\n\n### Fixed\n- Fixed an error that occurred when searching for elements by a custom field. ([#11120](https://github.com/craftcms/cms/pull/11120))\n- Fixed a bug where asset upload failures weren\u2019t being handled properly. ([#11156](https://github.com/craftcms/cms/issues/11156))\n- Fixed a bug where warning and error logs were being sent to both `stdout` and `stderr` when `CRAFT_STREAM_LOG` was enabled. ([#11189](https://github.com/craftcms/cms/issues/11189))\n- Fixed an error that occurred when exporting elements with relational fields using the \u201cExpanded\u201d export type. ([#11127](https://github.com/craftcms/cms/issues/11127))\n- Fixed a PHP deprecation warning that occurred if the `tablePrefix` database connection setting was `null`.\n- Fixed a bug where category groups were being identified as \u201c{name}\u201d in user permission lists. ([#11132](https://github.com/craftcms/cms/issues/11132))\n- Fixed a bug where Assets fields\u2019 \u201cUpload files\u201d buttons weren\u2019t wrapping when there wasn\u2019t enough space to show them alongside \u201cAdd an asset\u201d. ([#11133](https://github.com/craftcms/cms/issues/11133))\n- Fixed a bug where `Craft.getUrl()` was appending empty query strings to URLs when they weren\u2019t needed. ([#11159](https://github.com/craftcms/cms/issues/11159))\n- Fixed a bug where addresses could validate the wrong set of required fields, if the validation rules were invoked before the country code was set. ([#11162](https://github.com/craftcms/cms/issues/11162))\n- Fixed an error that could occur when viewing the Temporary Uploads volume, if the Temp Uploads Location asset setting was set to \u201cIn the local temp folder\u201d. ([#11192](https://github.com/craftcms/cms/issues/11192))\n- Fixed an error that could occur when deleting a volume, if its filesystem had been deleted.\n- Fixed an error that could occur when rendering the thumbnail preview for an asset, if its file was missing. ([#11196](https://github.com/craftcms/cms/issues/11196))\n- Fixed a bug where soft-deleted drafts\u2019 search keywords weren\u2019t getting re-indexed if they were restored.\n- Fixed an error that occurred when transforming an SVG image without specifying a width or height. ([#11122](https://github.com/craftcms/cms/issues/11122))\n- Fixed an error that occurred when saving a Number field with a non-numeric value. ([#11164](https://github.com/craftcms/cms/issues/11164))\n- Fixed a bug where it wasn\u2019t possible to drag an item to the top in admin tables. ([#10781](https://github.com/craftcms/cms/issues/10781))\n- Fixed a bug where entries within Structure sections weren\u2019t expandable if their only descendants were unpublished drafts.\n- Fixed a bug where expanding a collapsed Structure section entry wouldn\u2019t reveal its descendants, if the parent was a draft. ([#11186](https://github.com/craftcms/cms/issues/11186))\n- Fixed a bug where element caches weren\u2019t getting cleared for elements when they were propagated to a newly-created site.\n\n## 4.0.1 - 2022-05-06\n\n### Fixed\n- Fixed a bug where Money field labels\u2019 `for` attributes weren\u2019t referencing the correct input ID. ([#11016](https://github.com/craftcms/cms/pull/11016))\n- Fixed a bug where Money field inputs weren\u2019t getting `aria-describedby` attributes. ([#11016](https://github.com/craftcms/cms/pull/11016))\n- Fixed an error that occurred when loading an edit screen for an element type that didn\u2019t have a field layout. ([#11110](https://github.com/craftcms/cms/pull/11110))\n- Fixed a bug where condition rules that weren\u2019t selectable (per `isSelectable()`) were still visible in the rule dropdown menu. ([#11104](https://github.com/craftcms/cms/pull/11104))\n- Fixed a bug where element edit pages could reload themselves immediately after saving the element. ([#11084](https://github.com/craftcms/cms/issues/11084))\n- Fixed a bug where tabs weren\u2019t interactive after changing an entry\u2019s type, if the new entry type didn\u2019t have a tab of the same name as the previously-selected tab. ([#11093](https://github.com/craftcms/cms/issues/11093))\n- Fixed a bug where Twig syntax errors weren\u2019t being handled properly. ([#11108](https://github.com/craftcms/cms/issues/11108))\n- Fixed an error that occurred when attempting to delete a global set. ([#11100](https://github.com/craftcms/cms/issues/11100))\n- Fixed an error that could occur when applying a draft. ([#11083](https://github.com/craftcms/cms/issues/11083))\n- Fixed a bug where element queries weren\u2019t returning any results if an element attribute table wasn\u2019t joined in, and the element query was set to an abstract element class. ([#11105](https://github.com/craftcms/cms/issues/11105))\n\n## 4.0.0.1 - 2022-05-04\n\n### Changed\n- The `setup` command now writes the application ID to a `CRAFT_APP_ID` environment variable.\n- The `setup` command now writes the security key to a `CRAFT_SECURITY_KEY` environment variable.\n\n## 4.0.0 - 2022-05-04\n\n### Added\n- Entries\u2019, categories\u2019, and assets\u2019 edit pages, and all element types via slideouts, now use a unified editing experience. ([#10467](https://github.com/craftcms/cms/pull/10467))\n- Categories now support drafts. ([#10467](https://github.com/craftcms/cms/pull/10467))\n- Element slideouts now support provisional drafts and autosaving, for element types that support them. ([#10467](https://github.com/craftcms/cms/pull/10467))\n- Element indexes can now be filtered by element attributes and custom field values. ([#9192](https://github.com/craftcms/cms/discussions/9192), [#9450](https://github.com/craftcms/cms/discussions/9450), [#9462](https://github.com/craftcms/cms/discussions/9462), [#9483](https://github.com/craftcms/cms/discussions/9483))\n- Admins can now create custom element sources from the Customize Sources modal. ([#8423](https://github.com/craftcms/cms/discussions/8423))\n- It\u2019s now possible to disable native element sources from the Customize Sources modal. ([#10676](https://github.com/craftcms/cms/discussions/10676))\n- Field layout tabs, fields, and UI elements can now be conditionally shown based on properties of the current user and/or element being edited. ([#8099](https://github.com/craftcms/cms/discussions/8099), [#8154](https://github.com/craftcms/cms/discussions/8154))\n- Assets, Entries, and Users fields have new condition settings that can be used to further limit which elements should be relatable, beyond the existing field settings. ([#10393](https://github.com/craftcms/cms/pull/10393))\n- Assets, Entries, and Users fields have new \u201cMin Relations\u201d settings, and their former \u201cLimit\u201d settings have been renamed to \u201cMax Relations\u201d. ([#8621](https://github.com/craftcms/cms/discussions/8621))\n- Added a dedicated \u201cFull Name\u201d field to users. \u201cFirst Name\u201d and \u201cLast Name\u201d are now parsed out from the full name automatically when a user is saved. ([#10405](https://github.com/craftcms/cms/discussions/10405))\n- Added the \u201cInactive\u201d user status, which can be used by users which can\u2019t be signed into. ([#8963](https://github.com/craftcms/cms/discussions/8963))\n- Added \u201cCredentialed\u201d and \u201cInactive\u201d user sources.\n- Added the \u201cDeactivate\u2026\u201d user action for pending and active users.\n- Users can now have an \u201cAddresses\u201d field. ([#10507](https://github.com/craftcms/cms/pull/10507))\n- Added the concept of \u201cfilesystems\u201d, which handle file operations, either locally or on a remote service like Amazon S3.\n- It\u2019s now possible to set sites\u2019 Status settings to environment variables. ([#3005](https://github.com/craftcms/cms/issues/3005))\n- Added the Money field type.\n- Craft now provides a native \u201cAlternative Text\u201d (`alt`) field for assets. ([#10302](https://github.com/craftcms/cms/discussions/10302))\n- Asset thumbnails in the control panel now have `alt` attributes, for assets with a filled-in Alternative Text value.\n- Added the `index-assets/cleanup` command.\n- Added the \u201cDeactivate users by default\u201d user registration setting, which replaces \u201cSuspend users by default\u201d. ([#5830](https://github.com/craftcms/cms/issues/5830))\n- Element source settings are now stored in the project config. ([#8616](https://github.com/craftcms/cms/discussions/8616))\n- Improved element index accessibility. ([#10629](https://github.com/craftcms/cms/pull/10629), [#10660](https://github.com/craftcms/cms/pull/10660))\n- Improved Live Preview accessibility for screen readers. ([#10688](https://github.com/craftcms/cms/pull/10688))\n- Slideouts, Live Preview, and Matrix blocks are no longer animated for browsers that have requested reduced motion. ([#10665](https://github.com/craftcms/cms/pull/10665))\n- Added support for `JSON` columns. ([#9089](https://github.com/craftcms/cms/pull/9089))\n- It\u2019s now possible to edit images\u2019 focal points from their preview modals. ([#8489](https://github.com/craftcms/cms/discussions/8489))\n- Added support for Monolog and the PSR-3 logging interface. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- Added the `|address` Twig filter.\n- Added the `|money` Twig filter.\n- Added the `collect()` Twig function.\n- Added the `assetUploaders`, `authors`, and `fullName` user query params.\n- Added the `primaryOwner` and `primaryOwnerId` Matrix block query params.\n- Added the `hasAlt` asset query param.\n- Added the `button`, `submitButton`, `fs`, `fsField`, `volume`, and `volumeField` macros to the `_includes/forms` control panel template.\n- Added the `buildId` general config. ([#10705](https://github.com/craftcms/cms/pull/10705))\n- Added support for setting custom config settings from `config/custom.php`, which are accessible via `Craft::$app->config->custom`. ([#10012](https://github.com/craftcms/cms/issues/10012))\n- Added the `addresses`, `address`, and `addressCount` GraphQL queries.\n- Added the `hasAlt` argument to asset GraphQL queries.\n- Added the `alt` field to assets queried via GraphQL.\n- Added the `fullName`, `assetUploaders`, and `authors` arguments to user GraphQL queries.\n- Added the `addresses` field to user GraphQL queries.\n- GraphQL schemas now include settings that determine which sites elements can be queried from. ([#10610](https://github.com/craftcms/cms/issues/10610))\n- Added the `assets/icon` action.\n- Added the `assets/update-focal-point` action.\n- Added the `categories/create` action.\n- Added the `elements/apply-draft` action.\n- Added the `elements/create` action.\n- Added the `elements/delete-draft` action.\n- Added the `elements/delete-for-site` action.\n- Added the `elements/delete` action.\n- Added the `elements/duplicate` action.\n- Added the `elements/edit` action.\n- Added the `elements/redirect` action.\n- Added the `elements/revert` action.\n- Added the `elements/save-draft` action.\n- Added the `elements/save` action.\n- Added the `users/delete-address` action.\n- Added the `users/save-address` action.\n- Added the `app/render-element` control panel controller action.\n- Added the `element-indexes/element-table-html` control panel controller action.\n- Added `craft\\base\\ApplicationTrait::getConditions()`.\n- Added `craft\\base\\ApplicationTrait::getElementSources()`, which replaces `getElementIndexes()`.\n- Added `craft\\base\\ApplicationTrait::getFs()`.\n- Added `craft\\base\\ApplicationTrait::getImageTransforms()`, which replaces `getAssetTransforms()`.\n- Added `craft\\base\\conditions\\BaseCondition`.\n- Added `craft\\base\\conditions\\BaseConditionRule`.\n- Added `craft\\base\\conditions\\BaseDateRangeConditionRule`.\n- Added `craft\\base\\conditions\\BaseElementSelectConditionRule`.\n- Added `craft\\base\\conditions\\BaseLightswitchConditionRule`.\n- Added `craft\\base\\conditions\\BaseMultiSelectConditionRule`.\n- Added `craft\\base\\conditions\\BaseNumberConditionRule`.\n- Added `craft\\base\\conditions\\BaseSelectConditionRule`.\n- Added `craft\\base\\conditions\\BaseTextConditionRule`.\n- Added `craft\\base\\conditions\\ConditionInterface`.\n- Added `craft\\base\\conditions\\ConditionRuleInterface`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_CREATE_DRAFTS`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_DELETE_FOR_SITE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_DELETE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_DUPLICATE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_SAVE`.\n- Added `craft\\base\\Element::EVENT_AUTHORIZE_VIEW`.\n- Added `craft\\base\\Element::EVENT_DEFINE_ADDITIONAL_BUTTONS`. ([#10420](https://github.com/craftcms/cms/discussions/10420))\n- Added `craft\\base\\Element::getParentId()`.\n- Added `craft\\base\\Element::hasNewParent()`.\n- Added `craft\\base\\Element::notesFieldHtml()`.\n- Added `craft\\base\\Element::setParentId()`.\n- Added `craft\\base\\Element::statusFieldHtml()`.\n- Added `craft\\base\\ElementInterface::canCreateDrafts()`.\n- Added `craft\\base\\ElementInterface::canDelete()`.\n- Added `craft\\base\\ElementInterface::canDeleteForSite()`.\n- Added `craft\\base\\ElementInterface::canDuplicate()`.\n- Added `craft\\base\\ElementInterface::canSave()`.\n- Added `craft\\base\\ElementInterface::canView()`.\n- Added `craft\\base\\ElementInterface::createAnother()`.\n- Added `craft\\base\\ElementInterface::createCondition()`.\n- Added `craft\\base\\ElementInterface::getAdditionalButtons()`.\n- Added `craft\\base\\ElementInterface::getPostEditUrl()`.\n- Added `craft\\base\\ElementInterface::getThumbAlt()`.\n- Added `craft\\base\\ElementInterface::hasRevisions()`.\n- Added `craft\\base\\ElementInterface::prepareEditScreen()`.\n- Added `craft\\base\\FieldInterface::getElementConditionRuleType()`.\n- Added `craft\\base\\FieldInterface::isRequirable()`.\n- Added `craft\\base\\FieldLayoutComponent`.\n- Added `craft\\base\\Fs`.\n- Added `craft\\base\\FsInterface`.\n- Added `craft\\base\\FsTrait`.\n- Added `craft\\base\\Image::heartbeat()`.\n- Added `craft\\base\\Image::setHeartbeatCallback()`.\n- Added `craft\\base\\imagetransforms\\EagerImageTransformerInterface`.\n- Added `craft\\base\\imagetransforms\\ImageEditorTransformerInterface`.\n- Added `craft\\base\\imagetransforms\\ImageTransformerInterface`.\n- Added `craft\\base\\LocalFsInterface`.\n- Added `craft\\base\\Model::defineBehaviors()`. ([#10691](https://github.com/craftcms/cms/pull/10691))\n- Added `craft\\base\\ModelInterface`.\n- Added `craft\\base\\NameTrait`.\n- Added `craft\\base\\PluginInterface::config()`. ([#11039](https://github.com/craftcms/cms/pull/11039))\n- Added `craft\\behaviors\\SessionBehavior::broadcastToJs()`.\n- Added `craft\\behaviors\\SessionBehavior::getError()`.\n- Added `craft\\behaviors\\SessionBehavior::getNotice()`.\n- Added `craft\\controllers\\AddressesController`.\n- Added `craft\\controllers\\AssetIndexesController`.\n- Added `craft\\controllers\\ConditionsController`.\n- Added `craft\\controllers\\ElementIndexesController::$condition`.\n- Added `craft\\controllers\\FsController`.\n- Added `craft\\controllers\\ImageTransformsController`.\n- Added `craft\\db\\Migration::archiveTableIfExists()`. ([#10827](https://github.com/craftcms/cms/discussions/10827))\n- Added `craft\\db\\Migration::dropAllForeignKeysToTable()`.\n- Added `craft\\db\\Migration::dropForeignKeyIfExists()`.\n- Added `craft\\db\\Migration::renameTable()`.\n- Added `craft\\db\\Query::collect()`, which returns the query results as an `Illuminate\\Support\\Collection` object rather than an array. ([#8513](https://github.com/craftcms/cms/discussions/8513))\n- Added `craft\\db\\Table::ADDRESSES`.\n- Added `craft\\db\\Table::ASSETINDEXINGSESSIONS`.\n- Added `craft\\db\\Table::IMAGETRANSFORMINDEX`.\n- Added `craft\\db\\Table::IMAGETRANSFORMS`.\n- Added `craft\\db\\Table::MATRIXBLOCKS_OWNERS`.\n- Added `craft\\debug\\LogTarget`.\n- Added `craft\\debug\\MailPanel`.\n- Added `craft\\elements\\Address`.\n- Added `craft\\elements\\Asset::$alt`.\n- Added `craft\\elements\\Asset::EVENT_AFTER_GENERATE_TRANSFORM`.\n- Added `craft\\elements\\Asset::EVENT_BEFORE_GENERATE_TRANSFORM`.\n- Added `craft\\elements\\Asset::getFs()`.\n- Added `craft\\elements\\Asset::setFilename()`.\n- Added `craft\\elements\\conditions\\addresses\\AddressCondition`.\n- Added `craft\\elements\\conditions\\addresses\\CountryConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\AssetCondition`.\n- Added `craft\\elements\\conditions\\assets\\DateModifiedConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\FilenameConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\FileSizeConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\FileTypeConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\HasAltConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\HeightConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\UploaderConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\VolumeConditionRule`.\n- Added `craft\\elements\\conditions\\assets\\WidthConditionRule`.\n- Added `craft\\elements\\conditions\\categories\\CategoryCondition`.\n- Added `craft\\elements\\conditions\\categories\\GroupConditionRule`.\n- Added `craft\\elements\\conditions\\DateCreatedConditionRule`.\n- Added `craft\\elements\\conditions\\DateUpdatedConditionRule`.\n- Added `craft\\elements\\conditions\\ElementCondition`.\n- Added `craft\\elements\\conditions\\ElementConditionInterface`.\n- Added `craft\\elements\\conditions\\ElementConditionRuleInterface`.\n- Added `craft\\elements\\conditions\\entries\\AuthorConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\AuthorGroupConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\EntryCondition`.\n- Added `craft\\elements\\conditions\\entries\\ExpiryDateConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\PostDateConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\SectionConditionRule`.\n- Added `craft\\elements\\conditions\\entries\\TypeConditionRule`.\n- Added `craft\\elements\\conditions\\HasUrlConditionRule`.\n- Added `craft\\elements\\conditions\\IdConditionRule`.\n- Added `craft\\elements\\conditions\\LevelConditionRule`.\n- Added `craft\\elements\\conditions\\RelatedToConditionRule`.\n- Added `craft\\elements\\conditions\\SlugConditionRule`.\n- Added `craft\\elements\\conditions\\tags\\GroupConditionRule`.\n- Added `craft\\elements\\conditions\\tags\\TagCondition`.\n- Added `craft\\elements\\conditions\\TitleConditionRule`.\n- Added `craft\\elements\\conditions\\UriConditionRule`.\n- Added `craft\\elements\\conditions\\users\\AdminConditionRule`.\n- Added `craft\\elements\\conditions\\users\\CredentialedConditionRule`.\n- Added `craft\\elements\\conditions\\users\\EmailConditionRule`.\n- Added `craft\\elements\\conditions\\users\\FirstNameConditionRule`.\n- Added `craft\\elements\\conditions\\users\\GroupConditionRule`.\n- Added `craft\\elements\\conditions\\users\\LastLoginDateConditionRule`.\n- Added `craft\\elements\\conditions\\users\\LastNameConditionRule`.\n- Added `craft\\elements\\conditions\\users\\UserCondition`.\n- Added `craft\\elements\\conditions\\users\\UsernameConditionRule`.\n- Added `craft\\elements\\db\\AddressQuery`.\n- Added `craft\\elements\\MatrixBlock::$primaryOwnerId`.\n- Added `craft\\elements\\MatrixBlock::$saveOwnership`.\n- Added `craft\\elements\\User::$active`.\n- Added `craft\\elements\\User::$fullName`.\n- Added `craft\\elements\\User::canAssignUserGroups()`.\n- Added `craft\\elements\\User::getAddresses()`.\n- Added `craft\\elements\\User::getIsCredentialed()`.\n- Added `craft\\elements\\User::STATUS_INACTIVE`.\n- Added `craft\\errors\\FsException`.\n- Added `craft\\errors\\FsObjectExistsException`.\n- Added `craft\\errors\\FsObjectNotFoundException`.\n- Added `craft\\errors\\ImageTransformException`.\n- Added `craft\\errors\\InvalidFsException`.\n- Added `craft\\errors\\MissingVolumeFolderException`.\n- Added `craft\\events\\AuthorizationCheckEvent`.\n- Added `craft\\events\\CreateElementCheckEvent`.\n- Added `craft\\events\\DefineElementEditorHtmlEvent`.\n- Added `craft\\events\\DefineElementInnerHtmlEvent`. ([#11035](https://github.com/craftcms/cms/pull/11035))\n- Added `craft\\events\\DefineHtmlEvent::$static`.\n- Added `craft\\events\\FsEvent`.\n- Added `craft\\events\\GenerateTransformEvent::$asset`.\n- Added `craft\\events\\GenerateTransformEvent::$transform`.\n- Added `craft\\events\\GenerateTransformEvent::$url`.\n- Added `craft\\events\\ImageTransformerOperationEvent`.\n- Added `craft\\events\\ImageTransformEvent`.\n- Added `craft\\events\\RegisterConditionRuleTypesEvent`.\n- Added `craft\\events\\TransformImageEvent`.\n- Added `craft\\fieldlayoutelements\\addresses\\AddressField`.\n- Added `craft\\fieldlayoutelements\\addresses\\CountryCodeField`.\n- Added `craft\\fieldlayoutelements\\addresses\\LabelField`.\n- Added `craft\\fieldlayoutelements\\addresses\\LatLongField`.\n- Added `craft\\fieldlayoutelements\\addresses\\OrganizationField`.\n- Added `craft\\fieldlayoutelements\\addresses\\OrganizationTaxIdField`.\n- Added `craft\\fieldlayoutelements\\assets\\AltField`.\n- Added `craft\\fieldlayoutelements\\BaseField::selectorLabel()`.\n- Added `craft\\fieldlayoutelements\\FullNameField`.\n- Added `craft\\fieldlayoutelements\\TextareaField`.\n- Added `craft\\fieldlayoutelements\\users\\AddressesField`.\n- Added `craft\\fields\\Assets::$allowSubfolders`.\n- Added `craft\\fields\\Assets::$restrictedDefaulUploadSubpath`.\n- Added `craft\\fields\\BaseRelationField::createSelectionCondition()`.\n- Added `craft\\fields\\BaseRelationField::getSelectionCondition()`.\n- Added `craft\\fields\\BaseRelationField::setSelectionCondition()`.\n- Added `craft\\fields\\conditions\\DateFieldConditionRule`.\n- Added `craft\\fields\\conditions\\FieldConditionRuleInterface`.\n- Added `craft\\fields\\conditions\\FieldConditionRuleTrait`.\n- Added `craft\\fields\\conditions\\LightswitchFieldConditionRule`.\n- Added `craft\\fields\\conditions\\NumberFieldConditionRule`.\n- Added `craft\\fields\\conditions\\OptionsFieldConditionRule`.\n- Added `craft\\fields\\conditions\\RelationalFieldConditionRule`.\n- Added `craft\\fields\\conditions\\TextFieldConditionRule`.\n- Added `craft\\fields\\Money`.\n- Added `craft\\fs\\Local`.\n- Added `craft\\fs\\MissingFs`.\n- Added `craft\\fs\\Temp`.\n- Added `craft\\gql\\arguments\\elements\\Address`.\n- Added `craft\\gql\\base\\SingularTypeInterface`.\n- Added `craft\\gql\\interfaces\\elements\\Address`.\n- Added `craft\\gql\\queries\\Address`.\n- Added `craft\\gql\\resolvers\\elements\\Address`.\n- Added `craft\\gql\\TypeManager::registerFieldDefinitions()`.\n- Added `craft\\gql\\types\\elements\\Address`.\n- Added `craft\\gql\\types\\generators\\AddressType`.\n- Added `craft\\helpers\\App::cliOption()`.\n- Added `craft\\helpers\\App::devMode()`.\n- Added `craft\\helpers\\App::envConfig()`. ([#10869](https://github.com/craftcms/cms/pull/10869))\n- Added `craft\\helpers\\App::isStreamLog()`.\n- Added `craft\\helpers\\App::normalizeValue()`.\n- Added `craft\\helpers\\Assets::downloadFile()`.\n- Added `craft\\helpers\\Assets::iconPath()`.\n- Added `craft\\helpers\\Assets::iconUrl()`.\n- Added `craft\\helpers\\Assets::revParams()`.\n- Added `craft\\helpers\\Cp::addressCardHtml()`.\n- Added `craft\\helpers\\Cp::addressCardsHtml()`.\n- Added `craft\\helpers\\Cp::addressFieldsHtml()`.\n- Added `craft\\helpers\\Cp::dateFieldHtml()`.\n- Added `craft\\helpers\\Cp::dateHtml()`.\n- Added `craft\\helpers\\Cp::elementSelectHtml()`.\n- Added `craft\\helpers\\Cp::EVENT_DEFINE_ELEMENT_INNER_HTML`. ([#11035](https://github.com/craftcms/cms/pull/11035))\n- Added `craft\\helpers\\Cp::fieldLayoutDesignerHtml()`.\n- Added `craft\\helpers\\Cp::lightswitchHtml()`.\n- Added `craft\\helpers\\Cp::multiSelectFieldHtml()`.\n- Added `craft\\helpers\\Cp::multiSelectHtml()`.\n- Added `craft\\helpers\\Cp::requestedSite()`.\n- Added `craft\\helpers\\Cp::textareaHtml()`.\n- Added `craft\\helpers\\Cp::textHtml()`.\n- Added `craft\\helpers\\Cp::timeFieldHtml()`.\n- Added `craft\\helpers\\Cp::timeHtml()`.\n- Added `craft\\helpers\\Db::dropAllForeignKeysToTable()`.\n- Added `craft\\helpers\\Db::dropForeignKeyIfExists()`.\n- Added `craft\\helpers\\Db::dropIndexIfExists()`.\n- Added `craft\\helpers\\Db::findForeignKey()`.\n- Added `craft\\helpers\\Db::findIndex()`.\n- Added `craft\\helpers\\Db::parseMoneyParam()`.\n- Added `craft\\helpers\\Db::parseNumericParam()`.\n- Added `craft\\helpers\\Db::prepareMoneyForDb()`.\n- Added `craft\\helpers\\Db::renameTable()`.\n- Added `craft\\helpers\\FileHelper::deleteFileAfterRequest()`.\n- Added `craft\\helpers\\FileHelper::deleteQueuedFiles()`.\n- Added `craft\\helpers\\Gql::getSchemaContainedEntryTypes)()`.\n- Added `craft\\helpers\\Html::hiddenLabel()`.\n- Added `craft\\helpers\\Html::unwrapCondition()`.\n- Added `craft\\helpers\\Html::unwrapNoscript()`.\n- Added `craft\\helpers\\ImageTransforms`.\n- Added `craft\\helpers\\Money`.\n- Added `craft\\helpers\\Number::isInt()`.\n- Added `craft\\helpers\\Number::toIntOrFloat()`.\n- Added `craft\\helpers\\ProjectConfig::encodeValueAsString()`.\n- Added `craft\\helpers\\ProjectConfig::ensureAllSectionsProcessed()`.\n- Added `craft\\helpers\\ProjectConfig::traverseDataArray()`.\n- Added `craft\\helpers\\Typecast`. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- Added `craft\\i18n\\Translation`.\n- Added `craft\\imagetransforms\\ImageTransformer`.\n- Added `craft\\log\\ContextProcessor`.\n- Added `craft\\log\\Dispatcher::getTargets()`.\n- Added `craft\\log\\MessageProcessor`.\n- Added `craft\\log\\MonologTarget`.\n- Added `craft\\models\\AssetIndexingSession`.\n- Added `craft\\models\\FieldLayout::getElementsByType()`.\n- Added `craft\\models\\FieldLayout::getFirstElementByType()`.\n- Added `craft\\models\\FieldLayout::getFirstVisibleElementByType()`.\n- Added `craft\\models\\FieldLayout::getVisibleCustomFields()`.\n- Added `craft\\models\\FieldLayout::getVisibleElementsByType()`.\n- Added `craft\\models\\FieldLayoutElement::$uid`.\n- Added `craft\\models\\FieldLayoutElement::getLayout()` and `setLayout()`.\n- Added `craft\\models\\FieldLayoutForm::getVisibleElements()`.\n- Added `craft\\models\\FieldLayoutFormTab::getTabId()`.\n- Added `craft\\models\\FieldLayoutFormTab::getUid()`.\n- Added `craft\\models\\FieldLayoutTab::getElements()` and `setElements()`.\n- Added `craft\\models\\FsListing`.\n- Added `craft\\models\\ImageTransform`.\n- Added `craft\\models\\ImageTransformIndex`.\n- Added `craft\\models\\ProjectConfigData`.\n- Added `craft\\models\\ReadOnlyProjectConfigData`.\n- Added `craft\\models\\Volume`.\n- Added `craft\\queue\\jobs\\Proxy`.\n- Added `craft\\queue\\Queue::$proxyQueue`, which can be set to another queue configuration that all jobs should be sent to as proxies. ([#10999](https://github.com/craftcms/cms/pull/10999))\n- Added `craft\\records\\Address`.\n- Added `craft\\records\\AssetIndexingSession`.\n- Added `craft\\records\\ImageTransform`.\n- Added `craft\\services\\Addresses`.\n- Added `craft\\services\\AssetIndexer::createIndexingSession()`.\n- Added `craft\\services\\AssetIndexer::getExistingIndexingSessions()`.\n- Added `craft\\services\\AssetIndexer::getIndexingSessionById()`.\n- Added `craft\\services\\AssetIndexer::getMissingEntriesForSession()`.\n- Added `craft\\services\\AssetIndexer::getSkippedItemsForSession()`.\n- Added `craft\\services\\AssetIndexer::indexFileByListing()`.\n- Added `craft\\services\\AssetIndexer::indexFolderByEntry()`.\n- Added `craft\\services\\AssetIndexer::indexFolderByListing()`.\n- Added `craft\\services\\AssetIndexer::processIndexSession()`.\n- Added `craft\\services\\AssetIndexer::removeCliIndexingSessions()`.\n- Added `craft\\services\\AssetIndexer::startIndexingSession()`.\n- Added `craft\\services\\AssetIndexer::stopIndexingSession()`.\n- Added `craft\\services\\Assets::getImagePreviewUrl()`.\n- Added `craft\\services\\AssetTransforms::deleteTransformIndexDataByAssetIds()`.\n- Added `craft\\services\\Conditions`.\n- Added `craft\\services\\Config::CATEGORY_CUSTOM`.\n- Added `craft\\services\\Config::getCustom()`.\n- Added `craft\\services\\Drafts::removeDraftData()`.\n- Added `craft\\services\\ElementSources`, which replaces `craft\\services\\ElementIndexes`.\n- Added `craft\\services\\Fields::createLayout()`.\n- Added `craft\\services\\Fs`.\n- Added `craft\\services\\Gc::hardDeleteElements()`.\n- Added `craft\\services\\Gc::removeEmptyTempFolders()`.\n- Added `craft\\services\\Gql::prepareFieldDefinitions()`.\n- Added `craft\\services\\ImageTransforms`.\n- Added `craft\\services\\Matrix::createRevisionBlocks()`.\n- Added `craft\\services\\Matrix::duplicateOwnership()`.\n- Added `craft\\services\\ProjectConfig::ASSOC_KEY`.\n- Added `craft\\services\\ProjectConfig::PATH_DATE_MODIFIED`.\n- Added `craft\\services\\ProjectConfig::PATH_ELEMENT_SOURCES`.\n- Added `craft\\services\\ProjectConfig::PATH_FS`.\n- Added `craft\\services\\ProjectConfig::PATH_META_NAMES`.\n- Added `craft\\services\\ProjectConfig::PATH_SCHEMA_VERSION`.\n- Added `craft\\services\\ProjectConfig::PATH_SYSTEM`.\n- Added `craft\\services\\ProjectConfig::rememberAppliedChanges()`.\n- Added `craft\\services\\Users::deactivateUser()`.\n- Added `craft\\services\\Users::ensureUserByEmail()`, which will return a user for the given email, creating one if it didn\u2019t exist yet.\n- Added `craft\\services\\Users::EVENT_AFTER_DEACTIVATE_USER`.\n- Added `craft\\services\\Users::EVENT_BEFORE_DEACTIVATE_USER`.\n- Added `craft\\services\\Users::removeCredentials()`.\n- Added `craft\\services\\Volumes::getTemporaryVolume()`.\n- Added `craft\\services\\Volumes::getUserPhotoVolume()`.\n- Added `craft\\validators\\MoneyValidator`.\n- Added `craft\\web\\assets\\conditionbuilder\\ConditionBuilderAsset`.\n- Added `craft\\web\\assets\\htmx\\HtmxAsset`.\n- Added `craft\\web\\assets\\money\\MoneyAsset`.\n- Added `craft\\web\\Controller::asCpScreen()`.\n- Added `craft\\web\\Controller::asFailure()`.\n- Added `craft\\web\\Controller::asModelFailure()`.\n- Added `craft\\web\\Controller::asModelSuccess()`.\n- Added `craft\\web\\Controller::asSuccess()`.\n- Added `craft\\web\\Controller::CpScreenResponseBehavior()`.\n- Added `craft\\web\\Controller::CpScreenResponseFormatter()`.\n- Added `craft\\web\\Controller::getPostedRedirectUrl()`.\n- Added `craft\\web\\Controller::TemplateResponseBehavior()`.\n- Added `craft\\web\\Controller::TemplateResponseFormatter()`.\n- Added `craft\\web\\twig\\Extension::addressFilter()`.\n- Added `craft\\web\\twig\\Extension::moneyFilter()`.\n- Added `craft\\web\\twig\\variables\\Cp::fieldLayoutDesigner()`.\n- Added `craft\\web\\twig\\variables\\Cp::getFsOptions()`.\n- Added `craft\\web\\twig\\variables\\Cp::getVolumeOptions()`.\n- Added `craft\\web\\View::clearCssFileBuffer()`.\n- Added `craft\\web\\View::clearJsFileBuffer()`.\n- Added `craft\\web\\View::startCssFileBuffer()`.\n- Added `craft\\web\\View::startJsFileBuffer()`.\n- Added the `Craft.appendBodyHtml()` JavaScript method, which replaces the now-deprecated `appendFootHtml()` method.\n- Added the `Craft.CpScreenSlideout` JavaScript class, which can be used to create slideouts from actions that return `$this->asCpScreen()`.\n- Added the `Craft.ElementEditor` JavaScript class.\n- Added the `Craft.ElementEditorSlideout` JavaScript class.\n- Added the `Craft.getPageUrl()` JavaScript method.\n- Added the `Craft.getQueryParam()` JavaScript method.\n- Added the `Craft.getQueryParams()` JavaScript method.\n- Added the `Craft.namespaceId()` JavaScript method.\n- Added the `Craft.namespaceInputName()` JavaScript method.\n- Added the `Craft.Preview.refresh()` JavaScript method.\n- Added the `Craft.Queue` JavaScript class.\n- Added the `Craft.setElementAttributes()` JavaScript method.\n- Added the `Craft.setPath()` JavaScript method.\n- Added the `Craft.setQueryParam()` JavaScript method.\n- Added the `Craft.setUrl()` JavaScript method.\n- Added the `Craft.ui.createButton()` JavaScript method.\n- Added the `Craft.ui.createSubmitButton()` JavaScript method.\n- Added the `htmx.org` JavaScript library.\n- Added the commerceguys/addressing package.\n- Added the illuminate/collections package. ([#8475](https://github.com/craftcms/cms/discussions/8475))\n- Added the moneyphp/money package.\n- Added the symfony/var-dumper package.\n- Added the theiconic/name-parser package.\n- Added the yiisoft/yii2-symfonymailer package.\n\n### Changed\n- Craft now requires PHP 8.0.2 or later.\n- Craft now requires MySQL 5.7.8 / MariaDB 10.2.7 / PostgreSQL 10.0 or later.\n- Craft now requires the [Intl](https://php.net/manual/en/book.intl.php) and [BCMath](https://www.php.net/manual/en/book.bc.php) PHP extensions.\n- Improved draft creation/application performance. ([#10577](https://github.com/craftcms/cms/pull/10577))\n- Improved revision creation performance. ([#10589](https://github.com/craftcms/cms/pull/10577))\n- The \u201cWhat\u2019s New\u201d HUD now displays an icon and label above each announcement, identifying where it came from (Craft CMS or a plugin). ([#9747](https://github.com/craftcms/cms/discussions/9747))\n- The control panel now keeps track of the currently-edited site on a per-tab basis by adding a `site` query string param to all control panel URLs. ([#8920](https://github.com/craftcms/cms/discussions/8920))\n- Element index pages\u2019 status and sort menu option selections are now coded into the page URL via `status` and `sort` query string params. ([#10669](https://github.com/craftcms/cms/discussions/10669))\n- Users are no longer required to have a username or email.\n- Users can now set their Formatting Locale to any known locale; not just the available Language options. ([#10519](https://github.com/craftcms/cms/pull/10519))\n- Users\u2019 Language and Formatting Locale settings now display locale names in the current language and their native languages. ([#10519](https://github.com/craftcms/cms/pull/10519))\n- User queries now return all users by default, rather than only active users.\n- Filtering users by `active`, `pending`, and `locked` statuses no longer excludes suspended users.\n- `credentialed` and `inactive` are now reserved user group handles.\n- Elements throughout the control panel are now automatically updated whenever they\u2019re saved by another browser tab.\n- Assets fields that are restricted to a single location can now be configured to allow selection within subfolders of that location. ([#9070](https://github.com/craftcms/cms/discussions/9070))\n- When an image is saved as a new asset from the Image Editor via an Assets field, the Assets field will now automatically replace the selected asset with the new one. ([#8974](https://github.com/craftcms/cms/discussions/8974))\n- `alt` is now a reserved field handle for volume field layouts.\n- Volumes no longer have \u201ctypes\u201d, and their file operations are now delegated to a filesystem selected by an \u201cAsset Filesystem\u201d setting on the volume.\n- Volumes now have \u201cTransform Filesystem\u201d and \u201cTransform Subpath\u201d settings, which can be used to choose where image transforms should be stored. (The volume\u2019s Asset Filesystem will be used by default.)\n- Asset thumbnails are now generated as image transforms.\n- It\u2019s now possible to create volumes directly from the User Settings page.\n- Images that are not web-safe now are always converted to JPEGs when transforming, if no format was specified.\n- Entry post dates are no longer set automatically until the entry is validated with the `live` scenario. ([#10093](https://github.com/craftcms/cms/pull/10093))\n- Entry queries\u2019 `authorGroup()` param method now accepts an array of `craft\\models\\UserGroup` objects.\n- Element queries\u2019 `revision` params can now be set to `null` to include normal and revision elements.\n- Element queries can no longer be traversed or accessed like an array. Use a query execution method such as `all()`, `collect()`, or `one()` to fetch the results before working with them.\n- Element queries\u2019 `title` params no longer treat values with commas as arrays. ([#10891](https://github.com/craftcms/cms/issues/10891))\n- User queries\u2019 `firstName` and `lastName` params no longer treat values with commas as arrays. ([#10891](https://github.com/craftcms/cms/issues/10891))\n- Relational fields now load elements in the current site rather than the primary site, if the source element isn\u2019t localizable. ([#7048](https://github.com/craftcms/cms/issues/7048))\n- Lightswitch fields can no longer be marked as required within field layouts. ([#10773](https://github.com/craftcms/cms/issues/10773))\n- Built-in queue jobs are now always translated for the current user\u2019s language. ([#9745](https://github.com/craftcms/cms/pull/9745))\n- Path options passed to console commands (e.g. `--basePath`) now take precedence over their enivronment variable/PHP constant counterparts.\n- Database backups are now named after the Craft version in the database, rather than the Composer-installed version. ([#9733](https://github.com/craftcms/cms/discussions/9733))\n- Template autosuggestions now include their filename. ([#9744](https://github.com/craftcms/cms/pull/9744))\n- Improved the look of loading spinners in the control panel. ([#9109](https://github.com/craftcms/cms/discussions/9109))\n- The default `subLeft` and `subRight` search query term options are now only applied to terms that don\u2019t include an asterisk at the beginning/end, e.g. `hello*`. ([#10613](https://github.com/craftcms/cms/discussions/10613))\n- `{% cache %}` tags now store any external JavaScript or CSS files registered with `{% js %}` and `{% css %}` tags. ([#9987](https://github.com/craftcms/cms/discussions/9987))\n- All control panel templates end in `.twig` now. ([#9743](https://github.com/craftcms/cms/pull/9743))\n- 404 requests are no longer logged by default. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- Log entries are now single-line by default when Dev Mode is disabled. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- Log files are now rotated once every 24 hours. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- `CRAFT_STREAM_LOG` no longer logs _in addition to_ other log targets. ([#10659](https://github.com/craftcms/cms/pull/10659))\n- The default log target no longer logs `debug` or `info` messages when Dev Mode is enabled. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- SQL query logs now use the `debug` log level, so they no longer get logged when Dev Mode is enabled. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- `yii\\db\\Connection::$enableLogging` and `$enableProfiling` are no longer enabled by default when Dev Mode is disabled. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- The `queue` log target no longer has special handling for Yii or `info` logs. ([#10916](https://github.com/craftcms/cms/pull/10916))\n- A warning is now logged if an element query is executed before Craft is fully initialized. ([#11033](https://github.com/craftcms/cms/issues/11033))\n- A warning is now logged if Twig is instantiated before Craft is fully initialized. ([#11033](https://github.com/craftcms/cms/issues/11033))\n- Craft\u2019s bootstrap script now attempts to create its configured system paths automatically. ([#10562](https://github.com/craftcms/cms/pull/10562))\n- When using GraphQL to mutate entries, the `enabled` status is now affected on a per-site basis when specifying both the `enabled` and `siteId` parameters. ([#9771](https://github.com/craftcms/cms/issues/9771))\n- The `forms/selectize` control panel template now supports `addOptionFn` and `addOptionLabel` params, which can be set to add new options to the list.\n- Editable tables now support `allowAdd`, `allowDelete`, and `allowReorder` settings, replacing `staticRows`. ([#10163](https://github.com/craftcms/cms/pull/10163))\n- Column definitions passed to the `_includes/forms/editableTable` control panel template can now specify a `width` key. ([#11062](https://github.com/craftcms/cms/pull/11062))\n- The `limitField` macro in the `_components/fieldtypes/elementfieldsettings` control panel template has been renamed to `limitFields`.\n- Renamed the `elements/get-categories-input-html` action to `categories/input-html`.\n- Renamed the `elements/get-modal-body` action to `element-selector-modals/body`.\n- The `entries/save-entry` action now returns a 400 HTTP status for JSON responses when the entry couldn\u2019t be saved.\n- The `users/save-user` action no longer includes a `unverifiedEmail` key in failure responses.\n- The `users/set-password` action now returns a 400 HTTP status when an invalid token is passed, if there\u2019s no URL to redirect to. ([#10592](https://github.com/craftcms/cms/discussions/10592))\n- `install/*`, `setup/*`, `db/*`, and `help` actions no longer output a warning if Craft can\u2019t connect to the database. ([#10851](https://github.com/craftcms/cms/pull/10851))\n- `createFoldersInVolume:<uid>` user permissions have been renamed to `createFolders:<uid>`.\n- `deleteFilesAndFoldersInVolume:<uid>` user permissions have been renamed to `deleteAssets:<uid>`.\n- `deletePeerFilesInVolume:<uid>` user permissions have been renamed to `deletePeerAssets:<uid>`.\n- `editCategories:<uid>` user permissions have been split into `viewCategories:<uid>`, `saveCategories:<uid>`, `deleteCategories:<uid>`, `viewPeerCategoryDrafts:<uid>`, `savePeerCategoryDrafts:<uid>`, and `deletePeerCategoryDrafts:<uid>`.\n- `editEntries:<uid>` user permissions have been renamed to `viewEntries:<uid>`.\n- `editImagesInVolume:<uid>` user permissions have been renamed to `editImages:<uid>`.\n- `editPeerEntries:<uid>` user permissions have been renamed to `viewPeerEntries:<uid>`.\n- `editPeerEntryDrafts:<uid>` user permissions have been split into `viewPeerEntryDrafts:<uid>` and `savePeerEntryDrafts:<uid>`.\n- `editPeerFilesInVolume:<uid>` user permissions have been renamed to `savePeerAssets:<uid>`.\n- `editPeerImagesInVolume:<uid>` user permissions have been renamed to `editPeerImages:<uid>`.\n- `publishEntries:<uid>` user permissions have been renamed to `saveEntries:<uid>`, and no longer differentiate between enabled and disabled entries. (Users with `viewEntries:<uid>` permissions will still be able to create drafts.)\n- `publishPeerEntries:<uid>` user permissions have been renamed to `savePeerEntries:<uid>`, and no longer differentiate between enabled and disabled entries. (Users with `viewPeerEntries:<uid>` permissions will still be able to create drafts.)\n- `replaceFilesInVolume:<uid>` user permissions have been renamed to `replaceFiles:<uid>`.\n- `replacePeerFilesInVolume:<uid>` user permissions have been renamed to `replacePeerFiles:<uid>`.\n- `saveAssetInVolume:<uid>` user permissions have been renamed to `saveAssets:<uid>`.\n- `viewPeerFilesInVolume:<uid>` user permissions have been renamed to `viewPeerAssets:<uid>`.\n- `viewVolume:<uid>` user permissions have been renamed to `viewAssets:<uid>`.\n- Elements\u2019 `searchScore` GraphQL fields are now returned as integers.\n- Element types must now override `craft\\base\\Element::isDeletable()` if its elements should be deletable from the index page.\n- Element types\u2019 `cpEditUrl()` methods no longer need to add a `site` param; one will be added automatically by `craft\\base\\Element::getCpEditUrl()`.\n- Element types\u2019 `defineActions()` methods\u2019 `$source` arguments should no longer accept `null`.\n- Element types\u2019 `defineSources()` methods\u2019 `$context` arguments should no longer accept `null`.\n- Element types\u2019 `getHtmlAttributes()` and `htmlAttributes()` methods must now return attribute arrays that are compatible with `craft\\helpers\\Html::renderTagAttributes()`.\n- Element types\u2019 `sources()` methods\u2019 `$context` arguments should no longer accept `null`.\n- Element types\u2019 `tableAttributes()` and `defineTableAttributes()` methods should no longer return a generic attribute for defining the header column heading at the beginning of the returned array. The header column heading is now set to the element type\u2019s display name, per its `displayName()` method.\n- Block element types\u2019 `getOwner()` methods can now return `null`.\n- Control panel resource locations are now cached, so resource requests can be resolved when Craft isn\u2019t installed yet, or a database connection can\u2019t be established. ([#10642](https://github.com/craftcms/cms/pull/10642))\n- Control panel resources are now served with cache headers, if the `buildId` config setting is set. ([#10705](https://github.com/craftcms/cms/pull/10705))\n- Empty subfolders within the temporary upload volume are now removed during garbage collection. ([#10746](https://github.com/craftcms/cms/issues/10746))\n- Most config settings can now be overridden via environment variables. ([#10573](https://github.com/craftcms/cms/pull/10573), [#10869](https://github.com/craftcms/cms/pull/10869))\n- It\u2019s now possible to configure the Debug Toolbar to store its data files on a filesystem, rather than within `storage/runtime/debug/`. ([#10825](https://github.com/craftcms/cms/pull/10825))\n- `craft\\base\\AssetPreviewHandlerInterface::getPreviewHtml()` now accepts an optional array of variable to pass on to the template.\n- `craft\\base\\Element::__get()` now clones custom field values before returning them. ([#8781](https://github.com/craftcms/cms/discussions/8781))\n- `craft\\base\\Element::fieldLayoutFields()` now has a `visibleOnly` argument.\n- `craft\\base\\Element::getFieldValue()` now returns eager-loaded element values for the field, when they exist. ([#10047](https://github.com/craftcms/cms/issues/10047))\n- `craft\\base\\Element::metaFieldsHtml()` now has a `static` argument.\n- `craft\\base\\Element::setFieldValue()` now unsets any previously-eager-loaded elements for the field. ([#11003](https://github.com/craftcms/cms/discussions/11003))\n- `craft\\base\\Element::slugFieldHtml()` now has a `static` argument.\n- `craft\\base\\ElementInterface::getEagerLoadedElements()` now returns an `Illuminate\\Support\\Collection` object instead of an array. ([#8513](https://github.com/craftcms/cms/discussions/8513))\n- `craft\\base\\ElementInterface::getSidebarHtml()` now has a `static` argument.\n- `craft\\base\\MemoizableArray` no longer extends `ArrayObject`, and now implements `IteratorAggregate` and `Countable` directly.\n- `craft\\base\\Model::__construct()` and `setAttributes()` now automatically typecast values that map to properties with `int`, `float`, `int|float`, `string`, `bool`, `array`, or `DateTime` type declarations. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- `craft\\base\\Model::datetimeAttributes()` is now called from the constructor, instead of the `init()` method.\n- `craft\\base\\Model::setAttributes()` now normalizes date attributes into `DateTime` objects.\n- `craft\\behaviors\\FieldLayoutBehavior::getFields()` has been renamed to `getCustomFields()`.\n- `craft\\elements\\Asset::getImg()` now sets the `alt` attribute to the native Alternative Text field value, if set.\n- `craft\\elements\\Asset::getVolume()` now returns an instance of `craft\\models\\Volume`.\n- `craft\\elements\\db\\ElementQuery::ids()` no longer accepts an array of criteria params.\n- `craft\\events\\DraftEvent::$source` has been renamed to `$canonical`.\n- `craft\\events\\GetAssetThumbUrlEvent` has been renamed to `DefineAssetThumbUrlEvent`.\n- `craft\\events\\GetAssetUrlEvent` has been renamed to `DefineAssetUrlEvent`.\n- `craft\\events\\RevisionEvent::$source` has been renamed to `$canonical`.\n- `craft\\fieldlayoutelements\\AssetTitleField` has been renamed to `craft\\fieldlayoutelements\\assets\\AssetTitleField`.\n- `craft\\fieldlayoutelements\\EntryTitleField` has been renamed to `craft\\fieldlayoutelements\\entries\\EntryTitleField`.\n- `craft\\fieldlayoutelements\\StandardField` has been renamed to `craft\\fieldlayoutelements\\BaseNativeField`.\n- `craft\\fieldlayoutelements\\StandardTextField` has been renamed to `craft\\fieldlayoutelements\\TextField`.\n- `craft\\fields\\Assets::$singleUploadLocationSource` has been renamed to `$restrictedLocationSource`.\n- `craft\\fields\\Assets::$singleUploadLocationSubpath` has been renamed to `$restrictedLocationSubpath`.\n- `craft\\fields\\Assets::$useSingleFolder` has been renamed to `$restrictLocation`.\n- `craft\\fields\\BaseRelationField::$limit` has been renamed to `$maxRelations`.\n- `craft\\fields\\BaseRelationField::elementType()` is now public.\n- `craft\\fields\\BaseRelationField::inputSelectionCriteria()` has been renamed to `getInputSelectionCriteria()`, and is now public.\n- `craft\\fields\\BaseRelationField::inputSources()` has been renamed to `getInputSources()`, and is now public.\n- `craft\\gql\\directives\\FormatDateTime::defaultTimezone()` has been renamed to `defaultTimeZone()`.\n- `craft\\gql\\TypeManager::EVENT_DEFINE_GQL_TYPE_FIELDS` is now triggered when actually resolving fields for a GraphQL type, rather than when the type is first created. ([#9626](https://github.com/craftcms/cms/issues/9626))\n- `craft\\helpers\\App::env()` now checks for a PHP constant as well, if the environment variable didn\u2019t exist.\n- `craft\\helpers\\App::env()` now returns `null` if a value couldn\u2019t be found, rather than `false`.\n- `craft\\helpers\\App::env()` now returns a boolean if the original value was `'true'` or `'false'`.\n- `craft\\helpers\\App::env()` now returns an integer or float if the original value was numeric.\n- `craft\\helpers\\ArrayHelper::getValue()` now supports keys in square bracket syntax, e.g. `foo[bar][baz]`.\n- `craft\\helpers\\Assets::generateUrl()` no longer accepts a transform index for date modified comparisons. A `DateTime` object is expected instead.\n- `craft\\helpers\\Assets::urlAppendix()` no longer accepts a transform index for date modified comparisons. A `DateTime` object is expected instead.\n- `craft\\helpers\\Component::createComponent()` now automatically typecasts values that map to properties with `int`, `float`, `int|float`, `string`, `bool`, `array`, or `DateTime` type declarations. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- `craft\\helpers\\Cp::elementHtml()` now has an `$autoReload` argument.\n- `craft\\helpers\\Db::batchInsert()`, `craft\\helpers\\Db::insert()`, `craft\\db\\Command::batchInsert()`, `craft\\db\\Command::insert()`, `craft\\db\\Migration::batchInsert()`, and `craft\\db\\Migration::insert()` no longer have `$includeAuditColumns` arguments, and now check if the table has `dateCreated`, `dateUpdated`, and/or `uid` columns before setting their values.\n- `craft\\helpers\\Db::parseParam()` now validates that numeric values are passed if the `$columnType` is set to a numeric column type. ([#9142](https://github.com/craftcms/cms/issues/9142))\n- `craft\\helpers\\Db::prepareDateForDb()` no longer has a `$stripSeconds` argument.\n- `craft\\helpers\\Db::prepareValueForDb()` now has a `$columnType` argument.\n- `craft\\helpers\\Db::truncateTable()` now returns `void` rather than `int`.\n- `craft\\helpers\\Db::update()`, `craft\\helpers\\Db::upsert()`, `craft\\db\\Command::update()`, `craft\\db\\Command::upsert()`, `craft\\db\\Migration::update()`\u2019 and `craft\\db\\Migration::upsert()`\u2019 `$includeAuditColumns` arguments have been renamed to `$updateTimestamp`, and only affect the `dateCreated` column now. All upserts now check if the table has `dateCreated`, `dateUpdated`, and/or `uid` columns before setting their values.\n- `craft\\helpers\\Db::upsert()`, `craft\\db\\Command::upsert()`, and `craft\\db\\Migration()` no longer merge the `$updateColumns` array into `$insertColumns`. The full array of `INSERT` column values should be passed to `$insertColumns` now.\n- `craft\\helpers\\Gql::getUnionType()` no longer requires a resolver function to be passed, if the union contains only element GraphQL types.\n- `craft\\helpers\\Html::beginForm()` not sets `accept-charset=\"UTF-8\"` by default.\n- `craft\\helpers\\Html` now supports defining `hx-*` and `data-hx-*` attributes via a `hx` and `data-hx` keys, similar to `aria` and `data`.\n- `craft\\helpers\\i18n\\Formatter::asPercent()` now chooses a default `$decimals` value based on the value given, if `null`.\n- `craft\\helpers\\i18n\\Formatter::asPercent()` now treats all empty values as `0`.\n- `craft\\helpers\\MailerHelper::normalizeEmails()` now returns an empty array instead of `null`.\n- `craft\\helpers\\MigrationHelper::dropAllIndexesOnTable()` no longer returns an array of the dropped indexes.\n- `craft\\helpers\\Queue::push()` now has a `$queue` argument.\n- `craft\\models\\FieldLayout::EVENT_DEFINE_STANDARD_FIELDS` has been renamed to `EVENT_DEFINE_NATIVE_FIELDS`.\n- `craft\\models\\FieldLayout::getAvailableStandardFields()` has been renamed to `getAvailableNativeFields()`.\n- `craft\\models\\FieldLayout::getFields()` has been renamed to `getCustomFields()`.\n- `craft\\queue\\Queue::$channel` is now set automatically based on the queue\u2019s application component ID.\n- `craft\\services\\Announcements::push()` no longer accepts callables to be passed to the `$heading` and `$body` arguments. `craft\\i18n\\Translation::prep()` should be used to prepare the messages to be lazy-translated instead.\n- `craft\\services\\AssetIndexer::storeIndexList()` now expects the first argument to be a generator that returns `craft\\models\\FsListing` objects.\n- `craft\\services\\Assets::ensureFolderByFullPathAndVolume()` now returns a `craft\\models\\VolumeFolder` object rather than a folder ID.\n- `craft\\services\\Assets::ensureTopFolder()` now returns a `craft\\models\\VolumeFolder` object rather than a folder ID.\n- `craft\\services\\Assets::EVENT_GET_ASSET_THUMB_URL` has been renamed to `EVENT_DEFINE_THUMB_URL`.\n- `craft\\services\\Assets::EVENT_GET_ASSET_URL` has been moved to `craft\\elements\\Asset::EVENT_DEFINE_URL`.\n- `craft\\services\\AssetTransforms::CONFIG_TRANSFORM_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_IMAGE_TRANSFORMS`.\n- `craft\\services\\Categories::CONFIG_CATEGORYROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_CATEGORY_GROUPS`.\n- `craft\\services\\Fields::CONFIG_FIELDGROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_FIELD_GROUPS`.\n- `craft\\services\\Fields::CONFIG_FIELDS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_FIELDS`.\n- `craft\\services\\Globals::CONFIG_GLOBALSETS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GLOBAL_SETS`.\n- `craft\\services\\Gql::CONFIG_GQL_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GRAPHQL`.\n- `craft\\services\\Gql::CONFIG_GQL_PUBLIC_TOKEN_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GRAPHQL_PUBLIC_TOKEN`.\n- `craft\\services\\Gql::CONFIG_GQL_SCHEMAS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_GRAPHQL_SCHEMAS`.\n- `craft\\services\\Matrix::CONFIG_BLOCKTYPE_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_MATRIX_BLOCK_TYPES`.\n- `craft\\services\\Matrix::duplicateBlocks()` now has a `$deleteOtherBlocks` argument.\n- `craft\\services\\Plugins::CONFIG_PLUGINS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_PLUGINS`.\n- `craft\\services\\Plugins::doesPluginRequireDatabaseUpdate()` has been renamed to `isPluginUpdatePending()`.\n- `craft\\services\\ProjectConfig::applyYamlChanges()` has been renamed to `applyExternalChanges()`.\n- `craft\\services\\ProjectConfig::getDoesYamlExist()` has been renamed to `getDoesExternalConfigExist()`.\n- `craft\\services\\ProjectConfig::getIsApplyingYamlChanges()` has been renamed to `getIsApplyingExternalChanges()`.\n- `craft\\services\\ProjectConfig::set()` now returns `true` or `false` depending on whether the project config was modified.\n- `craft\\services\\Revisions::createRevision()` now returns the ID of the revision, rather than the revision itself.\n- `craft\\services\\Routes::CONFIG_ROUTES_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_ROUTES`.\n- `craft\\services\\Sections::CONFIG_ENTRYTYPES_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_ENTRY_TYPES`.\n- `craft\\services\\Sections::CONFIG_SECTIONS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_PATH_SECTIONS`.\n- `craft\\services\\Sites::CONFIG_SITEGROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_SITE_GROUPS`.\n- `craft\\services\\Sites::CONFIG_SITES_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_SITES`.\n- `craft\\services\\Tags::CONFIG_TAGGROUP_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_TAG_GROUPS`.\n- `craft\\services\\Updates::getIsCraftDbMigrationNeeded()` has been renamed to `getIsCraftUpdatePending()`.\n- `craft\\services\\Updates::getIsPluginDbUpdateNeeded()` has been renamed to `getIsPluginUpdatePending()`.\n- `craft\\services\\UserGroups::CONFIG_USERPGROUPS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_USER_GROUPS`.\n- `craft\\services\\UserPermissions::getAllPermissions()` and `getAssignablePermissions()` now return permission groups as arrays with `heading` and `permission` sub-keys, fixing a bug where two groups with the same heading would conflict with each other. ([#7771](https://github.com/craftcms/cms/issues/7771))\n- `craft\\services\\Users::CONFIG_USERLAYOUT_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_USER_FIELD_LAYOUTS`.\n- `craft\\services\\Users::CONFIG_USERS_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_USERS`.\n- `craft\\services\\Volumes::CONFIG_VOLUME_KEY` has been moved to `craft\\services\\ProjectConfig::PATH_VOLUMES`.\n- `craft\\test\\fixtures\\elements\\BaseElementFixture` now validates elements with the `live` scenario if they are enabled, canonical, and not a provisional draft.\n- `craft\\test\\TestSetup::getMockApp()` has been renamed to `getMockModule()`, and its `$appClass` argument has been renamed to `$moduleClass`.\n- `craft\\web\\Request::getBodyParam()` now accepts nested param names in the `foo[bar][baz]` format.\n- `craft\\web\\Request::getBodyParams()` and `getBodyParam()` now check for an `X-Craft-Namespace` header. If present, only params that begin with its value will be returned, excluding the namespace.\n- `craft\\web\\View::renderString()` now has an `$escapeHtml` argument.\n- `craft\\web\\View::setNamespace()`\u2019 `$namespace` argument no longer has a default value of `null`.\n- The `Craft.getUrl()` JavaScript method now removes duplicate query string params when passing in a param that\u2019s already included in the base URL.\n- The `Craft.getUrl()` JavaScript method now encodes any query string params passed to it.\n- `Craft.broadcastChannel` has been split up into two broadcast channels: `Craft.broadcaster` and `Craft.messageReceiver`.\n- `Craft.cp.$tabs` now returns a collection of the tabs\u2019 `<a>` elements, as they no longer have wrapping `<li>` elements.\n- Local volumes no longer use Flysystem.\n- A selected volume for user photo storage if no longer displayed if no volume has been set.\n- The user photo volume can now only be set to a volume that has a public transform filesystem configured.\n- Craft now uses Symfony Mailer to send email. ([#10062](https://github.com/craftcms/cms/discussions/10062))\n- Updated Twig to 3.3.\n- Updated vue-autosuggest to 2.2.0.\n\n### Deprecated\n- Deprecated the `autosaveDrafts` config setting.\n- Deprecated the `anyStatus` element query param. `status(null)` should be used instead.\n- Deprecated the `immediately` argument for transforms created over GraphQL. It no longer has any effect.\n- Deprecated `craft\\base\\ApplicationTrait::getInstalledSchemaVersion()`.\n- Deprecated `craft\\base\\Model::datetimeAttributes()`. ([#10706](https://github.com/craftcms/cms/pull/10706))\n- Deprecated `craft\\elements\\User::getFullName()`. `$fullName` should be used instead.\n- Deprecated `craft\\gql\\TypeManager::flush()`. `craft\\services\\Gql::flushCaches()` should be used instead.\n- Deprecated `craft\\gql\\TypeManager::prepareFieldDefinitions()`. `craft\\services\\Gql::prepareFieldDefinitions()` should be used instead.\n- Deprecated `craft\\helpers\\ArrayHelper::append()`. `array_unshift()` should be used instead.\n- Deprecated `craft\\helpers\\ArrayHelper::prepend()`. `array_push()` should be used instead.\n- Deprecated `craft\\helpers\\MigrationHelper`.\n- Deprecated `craft\\i18n\\I18N::getIsIntlLoaded()`.\n- Deprecated `craft\\services\\Assets::getAssetUrl()`. `craft\\elements\\Asset::getUrl()` should be used instead.\n- Deprecated `craft\\services\\Assets::getIconPath()`. `craft\\helpers\\Assets::iconPath()` should be used instead.\n- Deprecated `craft\\web\\Controller::asErrorJson()`. `asFailure()` should be used instead.\n- Deprecated the `assets/save-asset` action. `elements/save` should be used instead.\n- Deprecated the `categories/save-category` action. `elements/save` should be used instead.\n- Deprecated the `Craft.appendFootHtml()` JavaScript method. `appendBodyHtml()` should be used instead.\n\n### Removed\n- Removed the \u201cHeader Column Heading\u201d element source setting.\n- Removed support for setting custom config settings from `config/general.php`. `config/custom.php` should be used instead. ([#10012](https://github.com/craftcms/cms/issues/10012))\n- Removed the `customAsciiCharMappings` config setting.\n- Removed the `siteName` config setting. Environment-specific site names can be defined via environment variables.\n- Removed the `siteUrl` config setting. Environment-specific site URLs can be defined via environment variables.\n- Removed the `suppressTemplateErrors` config setting.\n- Removed the `useCompressedJs` config setting.\n- Removed the `useProjectConfigFile` config setting. Override `craft\\services\\ProjectConfig::$writeYamlAutomatically` to opt into [manual YAML file generation](https://craftcms.com/docs/4.x/project-config.html#manual-yaml-file-generation).\n- Removed support for `config/volumes.php`. Volumes can now specify per-environment filesystems.\n- Removed support for the `CRAFT_SITE_URL` PHP constant. Environment-specific site URLs can be defined via environment variables.\n- Removed the `enabledForSite` GraphQL argument. `status` should be used instead.\n- Removed the `{% includeHiResCss %}` Twig tag.\n- Removed support for deprecated `DateTime` faux Twig methods `atom()`, `cookie()`, `iso8601()`, `rfc822()`, `rfc850()`, `rfc1036()`, `rfc1123()`, `rfc2822()`, `rfc3339()`, `rss()`, `w3c()`, `w3cDate()`, `mySqlDateTime()`, `localeDate()`, `localeTime()`, `year()`, `month()`, `day()`, `nice()`, and `uiTimestamp()`.\n- Removed the `locale` element property. `siteId` should be used instead.\n- Removed the `ownerLocale` Matrix block query param. `site` or `siteId` should be used instead.\n- Removed support for `sourceLocale` in `relatedTo` element query params. `sourceSite` should be used instead.\n- Removed the `craft.categoryGroups` Twig variable.\n- Removed the `craft.config` Twig variable.\n- Removed the `craft.deprecator` Twig variable.\n- Removed the `craft.elementIndexes` Twig variable.\n- Removed the `craft.emailMessages` Twig variable.\n- Removed the `craft.feeds` Twig variable.\n- Removed the `craft.fields` Twig variable.\n- Removed the `craft.globals` Twig variable.\n- Removed the `craft.i18n` Twig variable.\n- Removed the `craft.request` Twig variable.\n- Removed the `craft.sections` Twig variable.\n- Removed the `craft.session` Twig variable.\n- Removed the `craft.systemSettings` Twig variable.\n- Removed the `craft.userGroups` Twig variable.\n- Removed the `craft.userPermissions` Twig variable.\n- Removed the `assignUserGroups` user permission, which authorized users to assign other users to their own groups. Authorization must now be explicitly granted for each group. ([#10422](https://github.com/craftcms/cms/issues/10422))\n- Removed the `customizeSources` user permission. Only admins can customize element sources now, and only from an environment that allows admin changes.\n- Removed the `publishPeerEntryDrafts:<uid>` permissions, as they were pointless. (If a user is authorized to save an entry and view other users\u2019 drafts of it, there\u2019s nothing stopping them from making the same changes themselves.)\n- Removed the `assets/edit-asset` action.\n- Removed the `assets/thumb` action.\n- Removed the `categories/edit-category` action.\n- Removed the `categories/preview-category` action.\n- Removed the `categories/share-category` action.\n- Removed the `categories/view-shared-category` action.\n- Removed the `dashboard/get-feed-items` action.\n- Removed the `elements/get-editor-html` action.\n- Removed the `entries/switch-entry-type` action.\n- Removed `craft\\base\\ApplicationTrait::getEntryRevisions()`.\n- Removed `craft\\base\\ApplicationTrait::getFeed()`.\n- Removed `craft\\base\\Element::ATTR_STATUS_CONFLICTED`.\n- Removed `craft\\base\\Element::getHasFreshContent()`. `getIsFresh()` should be used instead.\n- Removed `craft\\base\\ElementInterface::getEditorHtml()`. Element edit forms are now exclusively driven by their field layout.\n- Removed `craft\\base\\FieldLayoutElementInterface`.\n- Removed `craft\\base\\FlysystemVolume`.\n- Removed `craft\\base\\LocalVolumeInterface`.\n- Removed `craft\\base\\Volume`.\n- Removed `craft\\base\\VolumeInterface`.\n- Removed `craft\\base\\VolumeTrait`.\n- Removed `craft\\behaviors\\FieldLayoutBehavior::setFields()`.\n- Removed `craft\\config\\DbConfig::updateDsn()`.\n- Removed `craft\\console\\Request::getIsSingleActionRequest()`.\n- Removed `craft\\controllers\\AssetTransformsController`.\n- Removed `craft\\controllers\\BaseUpdaterController::ACTION_COMPOSER_OPTIMIZE`.\n- Removed `craft\\controllers\\BaseUpdaterController::actionComposerOptimize()`.\n- Removed `craft\\controllers\\Drafts`.\n- Removed `craft\\controllers\\ElementIndexesController::$paginated`.\n- Removed `craft\\controllers\\EntriesController::EVENT_PREVIEW_ENTRY`.\n- Removed `craft\\controllers\\UtilitiesController::actionAssetIndexPerformAction()`.\n- Removed `craft\\db\\Connection::trimObjectName()`.\n- Removed `craft\\db\\Table::ASSETTRANSFORMINDEX`.\n- Removed `craft\\db\\Table::ASSETTRANSFORMS`.\n- Removed `craft\\elements\\actions\\SetStatus::$allowDisabledForSite`.\n- Removed `craft\\elements\\actions\\SetStatus::DISABLED_FOR_SITE`.\n- Removed `craft\\elements\\actions\\SetStatus::DISABLED_GLOBALLY`.\n- Removed `craft\\elements\\Asset::getSupportsPreview()`.\n- Removed `craft\\elements\\Asset::getTransformSource()`.\n- Removed `craft\\elements\\Asset::setTransformSource()`.\n- Removed `craft\\elements\\db\\ElementQuery::getIterator()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetExists()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetGet()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetSet()`.\n- Removed `craft\\elements\\db\\ElementQuery::offsetUnset()`.\n- Removed `craft\\elements\\User::mergePreferences()`.\n- Removed `craft\\errors\\AssetTransformException`.\n- Removed `craft\\errors\\FieldNotFoundException`.\n- Removed `craft\\errors\\InvalidVolumeException`.\n- Removed `craft\\errors\\MissingVolumeFolderException`.\n- Removed `craft\\errors\\VolumeException`.\n- Removed `craft\\errors\\VolumeObjectExistsException`.\n- Removed `craft\\errors\\VolumeObjectNotFoundException`.\n- Removed `craft\\events\\AssetTransformEvent`.\n- Removed `craft\\events\\AssetTransformImageEvent`.\n- Removed `craft\\events\\DefineComponentsEvent`.\n- Removed `craft\\events\\GenerateTransformEvent::$image`.\n- Removed `craft\\events\\GenerateTransformEvent::$tempPath`.\n- Removed `craft\\events\\GetAssetThumbEvent`.\n- Removed `craft\\events\\GetAssetThumbUrlEvent::$generate`.\n- Removed `craft\\events\\GetAssetThumbUrlEvent::$size`.\n- Removed `craft\\events\\GlobalSetContentEvent`.\n- Removed `craft\\events\\RegisterGqlPermissionsEvent`.\n- Removed `craft\\events\\SearchEvent::getElementIds()`.\n- Removed `craft\\events\\SearchEvent::setElementIds()`.\n- Removed `craft\\feeds\\Feeds`.\n- Removed `craft\\feeds\\GuzzleClient`.\n- Removed `craft\\fields\\BaseOptionsField::optionLabel()`.\n- Removed `craft\\fields\\Url::$placeholder`.\n- Removed `craft\\gql\\base\\Resolver::extractEagerLoadCondition()`.\n- Removed `craft\\gql\\base\\Resolver::getArrayableArguments()`.\n- Removed `craft\\gql\\base\\Resolver::prepareArguments()`.\n- Removed `craft\\helpers\\App::dbMutexConfig()`.\n- Removed `craft\\helpers\\App::getDefaultLogTargets()`.\n- Removed `craft\\helpers\\App::logConfig()`.\n- Removed `craft\\helpers\\Cp::editElementTitles()`.\n- Removed `craft\\helpers\\Localization::localeData()`.\n- Removed `craft\\helpers\\Stringy`.\n- Removed `craft\\i18n\\Locale::setDateTimeFormats()`.\n- Removed `craft\\log\\FileTarget`.\n- Removed `craft\\log\\StreamLogTarget`.\n- Removed `craft\\models\\AssetTransform`.\n- Removed `craft\\models\\AssetTransformIndex`.\n- Removed `craft\\models\\BaseEntryRevisionModel`.\n- Removed `craft\\models\\EntryDraft`.\n- Removed `craft\\models\\EntryVersion`.\n- Removed `craft\\models\\FieldLayout::setFields()`.\n- Removed `craft\\models\\FieldLayoutTab::getFields()`.\n- Removed `craft\\models\\Site::$originalBaseUrl`.\n- Removed `craft\\models\\Site::$originalName`.\n- Removed `craft\\models\\Site::overrideBaseUrl()`.\n- Removed `craft\\models\\Site::overrideName()`.\n- Removed `craft\\models\\VolumeListing`.\n- Removed `craft\\mutex\\DbMutexTrait`.\n- Removed `craft\\mutex\\FileMutex`.\n- Removed `craft\\mutex\\MysqlMutex`.\n- Removed `craft\\mutex\\PgsqlMutex`.\n- Removed `craft\\mutex\\PrefixedMutexTrait`.\n- Removed `craft\\queue\\jobs\\DeleteStaleTemplateCaches`.\n- Removed `craft\\records\\AssetTransform`.\n- Removed `craft\\records\\MatrixBlockType::$validateUniques`.\n- Removed `craft\\services\\AssetIndexer::deleteStaleIndexingData()`.\n- Removed `craft\\services\\AssetIndexer::extractFolderItemsFromIndexList()`.\n- Removed `craft\\services\\AssetIndexer::extractSkippedItemsFromIndexList()`.\n- Removed `craft\\services\\AssetIndexer::getIndexingSessionId()`.\n- Removed `craft\\services\\AssetIndexer::getMissingFiles()`.\n- Removed `craft\\services\\AssetIndexer::prepareIndexList()`.\n- Removed `craft\\services\\AssetIndexer::processIndexForVolume()`.\n- Removed `craft\\services\\Assets::$generatePendingTransformsViaQueue`.\n- Removed `craft\\services\\Assets::EVENT_GET_ASSET_THUMB_URL`.\n- Removed `craft\\services\\Assets::EVENT_GET_THUMB_PATH`.\n- Removed `craft\\services\\Assets::getThumbPath()`.\n- Removed `craft\\services\\AssetTransforms`.\n- Removed `craft\\services\\Composer::$disablePackagist`.\n- Removed `craft\\services\\Composer::optimize()`.\n- Removed `craft\\services\\Content::getContentRow()`.\n- Removed `craft\\services\\Content::populateElementContent()`.\n- Removed `craft\\services\\Drafts::EVENT_AFTER_MERGE_SOURCE_CHANGES`.\n- Removed `craft\\services\\Drafts::EVENT_AFTER_PUBLISH_DRAFT`.\n- Removed `craft\\services\\Drafts::EVENT_BEFORE_MERGE_SOURCE_CHANGES`.\n- Removed `craft\\services\\Drafts::EVENT_BEFORE_PUBLISH_DRAFT`.\n- Removed `craft\\services\\Drafts::publishDraft()`.\n- Removed `craft\\services\\EntryRevisions`.\n- Removed `craft\\services\\Fields::assembleLayout()`.\n- Removed `craft\\services\\Fields::getFieldIdsByLayoutId()`.\n- Removed `craft\\services\\Fields::getFieldsByElementType()`.\n- Removed `craft\\services\\Fields::getFieldsByLayoutId()`.\n- Removed `craft\\services\\Gql::getAllPermissions()`.\n- Removed `craft\\services\\Path::getAssetThumbsPath()`.\n- Removed `craft\\services\\ProjectConfig::CONFIG_ALL_KEY`.\n- Removed `craft\\services\\ProjectConfig::CONFIG_ALL_KEY`.\n- Removed `craft\\services\\ProjectConfig::CONFIG_KEY`.\n- Removed `craft\\services\\Sections::isSectionTemplateValid()`.\n- Removed `craft\\services\\SystemSettings`.\n- Removed `craft\\services\\TemplateCaches::deleteCacheById()`.\n- Removed `craft\\services\\TemplateCaches::deleteCachesByKey()`.\n- Removed `craft\\services\\TemplateCaches::deleteExpiredCaches()`.\n- Removed `craft\\services\\TemplateCaches::deleteExpiredCachesIfOverdue()`.\n- Removed `craft\\services\\TemplateCaches::EVENT_AFTER_DELETE_CACHES`.\n- Removed `craft\\services\\TemplateCaches::EVENT_BEFORE_DELETE_CACHES`.\n- Removed `craft\\services\\TemplateCaches::handleResponse()`.\n- Removed `craft\\services\\TemplateCaches::handleResponse()`.\n- Removed `craft\\services\\TemplateCaches::includeElementInTemplateCaches()`.\n- Removed `craft\\services\\TemplateCaches::includeElementQueryInTemplateCaches()`.\n- Removed `craft\\services\\Volumes::createVolume()`.\n- Removed `craft\\services\\Volumes::EVENT_REGISTER_VOLUME_TYPES`.\n- Removed `craft\\services\\Volumes::getAllVolumeTypes()`.\n- Removed `craft\\services\\Volumes::getVolumeOverrides()`.\n- Removed `craft\\volumes\\Local`.\n- Removed `craft\\volumes\\MissingVolume`.\n- Removed `craft\\volumes\\Temp`.\n- Removed `craft\\web\\AssetBundle::useCompressedJs()`.\n- Removed `craft\\web\\AssetManager::getPublishedPath()`.\n- Removed `craft\\web\\Request::getIsSingleActionRequest()`.\n- Removed `craft\\web\\twig\\Template`.\n- Removed `craft\\web\\twig\\variables\\CategoryGroups`.\n- Removed `craft\\web\\twig\\variables\\Config`.\n- Removed `craft\\web\\twig\\variables\\Deprecator`.\n- Removed `craft\\web\\twig\\variables\\ElementIndexes`.\n- Removed `craft\\web\\twig\\variables\\EmailMessages`.\n- Removed `craft\\web\\twig\\variables\\Feeds`.\n- Removed `craft\\web\\twig\\variables\\Fields`.\n- Removed `craft\\web\\twig\\variables\\Globals`.\n- Removed `craft\\web\\twig\\variables\\I18N`.\n- Removed `craft\\web\\twig\\variables\\Request`.\n- Removed `craft\\web\\twig\\variables\\Sections`.\n- Removed `craft\\web\\twig\\variables\\SystemSettings`.\n- Removed `craft\\web\\twig\\variables\\UserGroups`.\n- Removed `craft\\web\\twig\\variables\\UserPermissions`.\n- Removed `craft\\web\\twig\\variables\\UserSession`.\n- Removed `craft\\web\\User::destroyDebugPreferencesInSession()`.\n- Removed `craft\\web\\User::saveDebugPreferencesToSession()`.\n- Removed `craft\\web\\View::$minifyCss`.\n- Removed `craft\\web\\View::$minifyJs`.\n- Removed `craft\\web\\View::registerHiResCss()`.\n- Removed `craft\\web\\View::renderTemplateMacro()`.\n- Removed the `_layouts/element` control panel template.\n- Removed the `assets/_edit` control panel template.\n- Removed the `categories/_edit` control panel template.\n- Removed the `entries/_edit` control panel template.\n- Removed the `cp.assets.edit.content` control panel template hook.\n- Removed the `cp.assets.edit.details` control panel template hook.\n- Removed the `cp.assets.edit.meta` control panel template hook.\n- Removed the `cp.assets.edit.settings` control panel template hook.\n- Removed the `cp.assets.edit` control panel template hook.\n- Removed the `cp.categories.edit.content` control panel template hook.\n- Removed the `cp.categories.edit.details` control panel template hook.\n- Removed the `cp.categories.edit.meta` control panel template hook.\n- Removed the `cp.categories.edit.settings` control panel template hook.\n- Removed the `cp.categories.edit` control panel template hook.\n- Removed the `cp.elements.edit` control panel template hook.\n- Removed the `cp.entries.edit.content` control panel template hook.\n- Removed the `cp.entries.edit.details` control panel template hook.\n- Removed the `cp.entries.edit.meta` control panel template hook.\n- Removed the `cp.entries.edit.settings` control panel template hook.\n- Removed the `cp.entries.edit` control panel template hook.\n- Removed the `Craft.AssetEditor` JavaScript class.\n- Removed the `Craft.BaseElementEditor` JavaScript class.\n- Removed the `Craft.DraftEditor` JavaScript class.\n- Removed the `Craft.queueActionRequest()` JavaScript method. `Craft.queue.push()` can be used instead.\n- Removed the Flysystem package. The `craftcms/flysystem-adapter` package now provides a base Flysystem adapter class.\n- Removed the laminas-feed package.\n- Removed the yii2-swiftmailer package.\n\n### Fixed\n- Fixed a bug where pending project config changes in the YAML would get applied when other project config changes were made. ([#9660](https://github.com/craftcms/cms/issues/9660))\n- Fixed a bug where revisions weren\u2019t getting propagated when a section was enabled for new sites, or its Propagation Method was changed. ([#10634](https://github.com/craftcms/cms/issues/10634))\n\n### Security\n- Generated control panel URLs now begin with the `@web` alias value if the `baseCpUrl` config setting isn\u2019t defined.\n- HTML entities output within email body text are now escaped by default in HTML email bodies.\n", "{% import \"_includes/links\" as links %}\n\n{% macro resourceLink(config) %}\n    <a href=\"{{ config.link }}\" target=\"_blank\" rel=\"noopener\">\n        <h4 class=\"cs-resource-heading\">\n            <img class=\"cs-logo-image\" src=\"{{ config.bundleUrl }}{{ config.iconPath }}\" alt=\"{{ config.title }}\">\n        </h4>\n        <p>{{ config.description }} {{ links.externalLinkIcon() }}</p>\n    </a>\n{% endmacro %}\n\n{% macro screen(widget, showBackupOption, bundleUrl, screen, placeholder, resultsIcon, resultsHeading, formAction, submitText) %}\n    {% import \"_includes/forms\" as forms %}\n    {% set idPrefix = 'cs-'~screen~random() %}\n\n    <div id=\"cs-screen-{{ screen }}\" class=\"cs-screen cs-screen-2 cs-screen-{{ screen }}\" action=\"{{ formAction }}\" method=\"get\" target=\"_blank\" rel=\"noopener\">\n        {{ tag('h2', {\n            text: submitText,\n        }) }}\n        {{ forms.textareaField({\n            first: true,\n            class: 'cs-body-text',\n            label: placeholder|t('app'),\n            rows: 5\n        }) }}\n        <div class=\"cs-search-results-container hidden\">\n            <div class=\"cs-search-icon\">{{ svg(resultsIcon, sanitize=false) }}</div>\n            <h2>{{ resultsHeading }}</h2>\n            <ul class=\"cs-search-results\"></ul>\n        </div>\n        <div class=\"cs-forms\">\n            <form class=\"cs-search-form\" action=\"{{ formAction }}\" method=\"get\" target=\"_blank\" rel=\"noopener\">\n                <div class=\"cs-search-params\"></div>\n                {% tag 'div' with { class: 'cs-button-wrapper' }%}\n                    <button type=\"submit\" class=\"btn submit fullwidth disabled\">{{ submitText }}</button>\n                    {% if CraftEdition == CraftPro %}\n                        <p>{{ \"or <a>send to Developer Support</a>\"|t('app')|raw }}</p>\n                    {% endif %}\n                    {{ tag('button', {\n                        class: 'btn fullwidth cancel',\n                        type: 'button',\n                        text: 'Cancel'|t('app'),\n                    }) }}\n                {% endtag %}\n                <hr>\n                <h3 class=\"cs-more-resources-heading\">{{ 'More Resources'|t('app') }}</h3>\n                <div class=\"cs-logo-resources\">\n                    {{ _self.resourceLink({\n                        link: 'https://craftcms.com/partners',\n                        iconPath: '/logos/craft-partners.svg',\n                        title: 'Craft Partners',\n                        description: 'Find an official Craft Partner'|t('app'),\n                        bundleUrl: bundleUrl,\n                    }) }}\n                    {{ _self.resourceLink({\n                        link: 'https://craftcms.com/discord',\n                        iconPath: '/logos/discord.svg',\n                        title: 'Discord',\n                        description: 'Meet the Craft community'|t('app'),\n                        bundleUrl: bundleUrl,\n                    }) }}\n                    {{ _self.resourceLink({\n                        link: 'https://craftquest.io',\n                        iconPath: '/logos/craftquest.svg',\n                        title: 'CraftQuest',\n                        description: 'Unlimited video training'|t('app'),\n                        bundleUrl: bundleUrl,\n                    }) }}\n                </div>\n                <div class=\"cs-icon-resources\">\n                    {% set documentationLinkHtml %}\n                        {{ svg('@appicons/book.svg')|attr({ 'aria-hidden': 'true' }) }}\n                        <span>{{ 'Documentation'|t('app') }}</span>\n                    {% endset %}\n                    {% set knowledgeBaseLinkHtml %}\n                        {{ svg('@appicons/magnifying-glass.svg', namespace=true)|attr({ 'aria-hidden': 'true' }) }}\n                        <span>{{ 'Knowledge Base'|t('app') }}</span>\n                    {% endset %}\n                    {{ links.externalLink({\n                        link: 'https://craftcms.com/docs/4.x/',\n                        html: documentationLinkHtml\n                    }) }}\n                    {{ links.externalLink({\n                        link: 'https://craftcms.com/knowledge-base',\n                        html: knowledgeBaseLinkHtml\n                    }) }}\n                </div>\n            </form>\n            <form class=\"cs-support-form hidden\" action=\"{{ actionUrl('dashboard/send-support-request') }}\" method=\"post\" target=\"{{ idPrefix }}-iframe\" accept-charset=\"UTF-8\" enctype=\"multipart/form-data\">\n                {{ csrfInput() }}\n                {{ hiddenInput('widgetId', widget.id) }}\n                {{ hiddenInput('message', '', {class: 'cs-support-message'}) }}\n\n                {% set email = currentUser.email %}\n                {% if email in ['support@pixelandtonic.com', 'support@craftcms.com'] %}\n                    {% set email = '' %}\n                {% endif %}\n\n                {{ forms.textField({\n                    first: true,\n                    label: \"Your Email\"|t('app'),\n                    name: 'fromEmail',\n                    value: email\n                }) }}\n\n                <a class=\"fieldtoggle\" data-target=\"{{ idPrefix }}-support-more\">{{ \"More\"|t('app') }}</a>\n\n                <div id=\"{{ idPrefix }}-support-more\" class=\"cs-support-more hidden\">\n                    <fieldset>\n                        {{ forms.checkboxField({\n                            label: 'Attach error logs'|t('app'),\n                            name: 'attachLogs',\n                            checked: true\n                        }) }}\n\n                        {% if showBackupOption %}\n                            {{ forms.checkboxField({\n                                label: 'Attach a database backup'|t('app'),\n                                name: 'attachDbBackup',\n                                checked: true\n                            }) }}\n                        {% endif %}\n\n                        {{ forms.checkboxField({\n                            name: 'attachTemplates',\n                            checked: true,\n                            label: 'Include your template files'|t('app'),\n                        }) }}\n                    </fieldset>\n\n                    {{ forms.fileField({\n                        label: 'Attach an additional file'|t('app'),\n                        class: 'cs-support-attachment',\n                        name: 'attachAdditionalFile',\n                    }) }}\n                </div>\n\n                {{ forms.submitButton({\n                    class: ['fullwidth', 'disabled'],\n                    label: 'Send'|t('app'),\n                    spinner: true,\n                }) }}\n            </form>\n        </div>\n        <iframe id=\"{{ idPrefix }}-iframe\" name=\"{{ idPrefix }}-iframe\" class=\"hidden\"></iframe>\n    </div>\n{% endmacro %}\n\n{% from _self import screen %}\n\n\n<div class=\"cs-screen cs-screen-home\">\n    <button type=\"button\" class=\"cs-opt\" data-screen=\"help\" aria-controls=\"cs-screen-help\" aria-expanded=\"false\">\n        <div class=\"cs-opt-icon\">{{ svg(buoeyIcon, sanitize=false)|attr({ 'aria-hidden': 'true' }) }}</div>\n        <h2>{{ \"Get help\"|t('app') }}</h2>\n        <p>{{ \"How-to\u2019s and other questions\"|t('app') }}</p>\n    </button>\n    <button type=\"button\" class=\"cs-opt\" data-screen=\"feedback\" aria-controls=\"cs-screen-feedback\" aria-expanded=\"false\">\n        <div class=\"cs-opt-icon\">{{ svg(bullhornIcon, sanitize=false)|attr({ 'aria-hidden': 'true' }) }}</div>\n        <h2>{{ \"Give feedback\"|t('app') }}</h2>\n        <p>{{ \"Bug reports and feature requests\"|t('app') }}</p>\n    </button>\n</div>\n\n{{ screen(widget, showBackupOption, bundleUrl, 'help', \"Briefly describe your question.\"|t('app'), seIcon, \"Similar questions on Stack Exchange\"|t('app'), 'https://craftcms.stackexchange.com/questions/ask', \"Ask on Stack Exchange\"|t('app')) }}\n\n{{ screen(widget, showBackupOption, bundleUrl, 'feedback', \"Briefly describe your issue or idea.\"|t('app'), ghIcon, \"Similar issues on GitHub\"|t('app'), 'https://github.com/craftcms/cms/issues/new', \"Post on GitHub\"|t('app')) }}\n", "{% macro externalLinkIcon() %}\n    {{ tag('span', {\n        'data-icon': 'external',\n        'role': 'img',\n        'aria-label': 'Opens in a new window'|t('app'),\n    }) }}\n{% endmacro %}\n\n{% macro externalLink(config) %}\n    {% set linkAttributes = {\n        href: config.link,\n        target: '_blank',\n        rel: 'noopener',\n        html: (config.html ?? config.text|e) ~ _self.externalLinkIcon()\n    } %}\n    {{ tag('a', linkAttributes) }}\n{% endmacro %}\n"], "filenames": ["CHANGELOG.md", "src/templates/_components/widgets/CraftSupport/body.twig", "src/templates/_includes/links.twig"], "buggy_code_start_loc": [21, 81, 14], "buggy_code_end_loc": [22, 86, 18], "fixing_code_start_loc": [21, 81, 14], "fixing_code_end_loc": [22, 86, 18], "type": "CWE-79", "message": "Craft is a CMS for creating custom digital experiences on the web. A malformed RSS feed can deliver an XSS payload. This issue was patched in version 4.4.6.\n\n\n", "other": {"cve": {"id": "CVE-2023-33195", "sourceIdentifier": "security-advisories@github.com", "published": "2023-05-27T04:15:25.767", "lastModified": "2023-06-02T21:15:09.430", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Craft is a CMS for creating custom digital experiences on the web. A malformed RSS feed can deliver an XSS payload. This issue was patched in version 4.4.6.\n\n\n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.6, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.3.0", "versionEndExcluding": "4.4.6", "matchCriteriaId": "38B55817-F2ED-46B5-93BD-6B9BB1F9D3FD"}]}]}], "references": [{"url": "https://github.com/craftcms/cms/commit/b77cb3023bed4f4a37c11294c4d319ff9f598e1f", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/craftcms/cms/releases/tag/4.4.6", "source": "security-advisories@github.com"}, {"url": "https://github.com/craftcms/cms/security/advisories/GHSA-qpgm-gjgf-8c2x", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/craftcms/cms/commit/b77cb3023bed4f4a37c11294c4d319ff9f598e1f"}}