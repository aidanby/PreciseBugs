{"buggy_code": ["<?php\nif(!empty($_POST['data'])){\n\t$fname = $_POST['file'];\n\n\t//check if file name ends with .json\n\tif(substr($fname, -1, 5) != '.json') {\n\t\techo '<script>alert(\"ERROR: Incorrect file type submitted\")</script>';\n\t\treturn;\n\t}\n\n\t$data = $_POST['data'];\n\n\t$file = fopen($fname, \"w\");\n\tfwrite($file, $data);\n\tfclose($file);\n}\n?>"], "fixing_code": ["<?php\nif(!empty($_POST['data'])){\n\t$fname = $_POST['file'];\n\n\t//check if file name ends with .json\n\tif(substr($fname, -5) != '.json') {\n\t\techo '<script>alert(\"ERROR: Incorrect file type submitted\")</script>';\n\t\treturn;\n\t}\n\n\t$data = $_POST['data'];\n\n\t$file = fopen($fname, \"w\");\n\tfwrite($file, $data);\n\tfclose($file);\n}\n?>"], "filenames": ["www/include/filesave.php"], "buggy_code_start_loc": [6], "buggy_code_end_loc": [7], "fixing_code_start_loc": [6], "fixing_code_end_loc": [7], "type": "CWE-434", "message": "erohtar/Dasherr is a dashboard for self-hosted services. In affected versions unrestricted file upload allows any unauthenticated user to execute arbitrary code on the server. The file /www/include/filesave.php allows for any file to uploaded to anywhere. If an attacker uploads a php file they can execute code on the server. This issue has been addressed in version 1.05.00. Users are advised to upgrade. There are no known workarounds for this issue.", "other": {"cve": {"id": "CVE-2023-23607", "sourceIdentifier": "security-advisories@github.com", "published": "2023-01-20T21:15:11.167", "lastModified": "2023-02-03T14:46:36.173", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "erohtar/Dasherr is a dashboard for self-hosted services. In affected versions unrestricted file upload allows any unauthenticated user to execute arbitrary code on the server. The file /www/include/filesave.php allows for any file to uploaded to anywhere. If an attacker uploads a php file they can execute code on the server. This issue has been addressed in version 1.05.00. Users are advised to upgrade. There are no known workarounds for this issue."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dasherr_project:dasherr:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.05.00", "matchCriteriaId": "8BD184F8-3C80-4A3B-A198-5CA082851B8F"}]}]}], "references": [{"url": "https://github.com/erohtar/Dasherr/commit/445325c7cf1148a8cd38af3a90789c6cbf6c5112", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/erohtar/Dasherr/security/advisories/GHSA-6rgc-2x44-7phq", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/erohtar/Dasherr/commit/445325c7cf1148a8cd38af3a90789c6cbf6c5112"}}