{"buggy_code": ["<?php\n\t$mayModify = ($isSiteAdmin || ($isAclModify && $event['Event']['user_id'] == $me['id'] && $event['Orgc']['id'] == $me['org_id']) || ($isAclModifyOrg && $event['Orgc']['id'] == $me['org_id']));\n\t$mayPublish = ($isAclPublish && $event['Orgc']['id'] == $me['org_id']);\n\t$mayChangeCorrelation = !Configure::read('MISP.completely_disable_correlation') && ($isSiteAdmin || ($mayModify && Configure::read('MISP.allow_disabling_correlation')));\n\t$possibleAction = 'Proposal';\n\tif ($mayModify) $possibleAction = 'Attribute';\n\t$all = false;\n\tif (isset($this->params->params['paging']['Event']['page'])) {\n\t\tif ($this->params->params['paging']['Event']['page'] == 0) $all = true;\n\t\t$page = $this->params->params['paging']['Event']['page'];\n\t} else {\n\t\t$page = 0;\n\t}\n\t$fieldCount = 11;\n\tif (!empty($event['Sighting'])) {\n\t\tforeach ($sightingsData['data'] as $aid => $data) {\n\t\t\t$sightingsData['data'][$aid]['html'] = '';\n\t\t\tforeach ($data as $type => $typeData) {\n\t\t\t\t$name = (($type != 'expiration') ? Inflector::pluralize($type) : $type);\n\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<span class=\\'blue bold\\'>' . ucfirst(h($name)) . '</span><br />';\n\t\t\t\tforeach ($typeData['orgs'] as $org => $orgData) {\n\t\t\t\t\t$extra = (($org == $me['Organisation']['name']) ? \" class=\t'bold'\" : \"\");\n\t\t\t\t\tif ($type == 'expiration') {\n\t\t\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<span ' . $extra . '>' . h($org) . '</span>: <span class=\\'orange bold\\'>' . date('Y-m-d H:i:s', $orgData['date']) . '</span><br />';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<span ' . $extra . '>' . h($org) . '</span>: <span class=\\'' . (($type == 'sighting') ? 'green' : 'red') . ' bold\\'>' . h($orgData['count']) . ' (' . date('Y-m-d H:i:s', $orgData['date']) . ')</span><br />';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<br />';\n\t\t\t}\n\t\t}\n\t}\n\t$filtered = false;\n\tif(isset($passedArgsArray)){\n\t\tif (count($passedArgsArray) > 0) {\n\t\t\t$filtered = true;\n\t\t}\n\t}\n?>\n\t<div class=\"pagination\">\n\t\t<ul>\n\t\t<?php\n\t\t\t$params = $this->request->named;\n\t\t\tunset($params['focus']);\n\t\t\t$url = array_merge(array('controller' => 'events', 'action' => 'viewEventAttributes', $event['Event']['id']), $params);\n\t\t\t$this->Paginator->options(array(\n\t\t\t\t'url' => $url,\n\t\t\t\t'update' => '#attributes_div',\n\t\t\t\t'evalScripts' => true,\n\t\t\t\t'before' => '$(\".progress\").show()',\n\t\t\t\t'complete' => '$(\".progress\").hide()',\n\t\t\t));\n\t\t\techo $this->Paginator->prev('&laquo; ' . __('previous'), array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'prev disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t\techo $this->Paginator->numbers(array('modulus' => 60, 'separator' => '', 'tag' => 'li', 'currentClass' => 'red', 'currentTag' => 'span'));\n\t\t\techo $this->Paginator->next(__('next') . ' &raquo;', array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'next disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t?>\n\t\t<li class=\"all <?php if ($all) echo 'disabled'; ?>\">\n\t\t\t<?php\n\t\t\t\tif ($all):\n\t\t\t?>\n\t\t\t\t<span class=\"red\">view all</span>\n\t\t\t<?php\n\t\t\t\telse:\n\t\t\t\t\techo $this->Paginator->link(__('view all'), 'all');\n\t\t\t\tendif;\n\t\t\t?>\n\t\t</li>\n\t\t</ul>\n\t</div>\n<br />\n<div id=\"edit_object_div\">\n\t<?php\n\t\techo $this->Form->create('Attribute', array('id' => 'delete_selected', 'url' => '/attributes/deleteSelected/' . $event['Event']['id']));\n\t\techo $this->Form->input('ids_delete', array(\n\t\t\t'type' => 'text',\n\t\t\t'value' => 'test',\n\t\t\t'style' => 'display:none;',\n\t\t\t'label' => false,\n\t\t));\n\t\techo $this->Form->end();\n\t?>\n\t\t<?php\n\t\techo $this->Form->create('ShadowAttribute', array('id' => 'accept_selected', 'url' => '/shadow_attributes/acceptSelected/' . $event['Event']['id']));\n\t\techo $this->Form->input('ids_accept', array(\n\t\t\t'type' => 'text',\n\t\t\t'value' => '',\n\t\t\t'style' => 'display:none;',\n\t\t\t'label' => false,\n\t\t));\n\t\techo $this->Form->end();\n\t?>\n\t\t<?php\n\t\techo $this->Form->create('ShadowAttribute', array('id' => 'discard_selected', 'url' => '/shadow_attributes/discardSelected/' . $event['Event']['id']));\n\t\techo $this->Form->input('ids_discard', array(\n\t\t\t'type' => 'text',\n\t\t\t'value' => '',\n\t\t\t'style' => 'display:none;',\n\t\t\t'label' => false,\n\t\t));\n\t\techo $this->Form->end();\n\t\tif (!isset($attributeFilter)) $attributeFilter = 'all';\n\t?>\n</div>\n<div id=\"attributeList\" class=\"attributeListContainer\">\n\t<div class=\"tabMenu tabMenuEditBlock noPrint\">\n\t\t<span id=\"create-button\" title=\"Add attribute\" role=\"button\" tabindex=\"0\" aria-label=\"Add attribute\" class=\"icon-plus useCursorPointer\" onClick=\"clickCreateButton(<?php echo $event['Event']['id']; ?>, '<?php echo $possibleAction; ?>');\"></span>\n\t\t<span id=\"multi-edit-button\" title=\"Edit selected Attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Edit selected Attributes\" class=\"hidden icon-edit mass-select useCursorPointer\" onClick=\"editSelectedAttributes(<?php echo $event['Event']['id']; ?>);\"></span>\n\t\t<span id=\"multi-tag-button\" title=\"Tag selected Attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Tag selected Attributes\" class=\"hidden icon-tag mass-select useCursorPointer\" onClick=\"getPopup('selected/true', 'tags', 'selectTaxonomy');\"></span>\n\t\t<span id=\"multi-delete-button\" title=\"Delete selected Attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Delete selected Attributes\" class=\"hidden icon-trash mass-select useCursorPointer\" onClick=\"multiSelectAction(<?php echo $event['Event']['id']; ?>, 'deleteAttributes');\"></span>\n\t\t<span id=\"multi-accept-button\" title=\"Accept selected Proposals\" role=\"button\" tabindex=\"0\" aria-label=\"Accept selected Proposals\" class=\"hidden icon-ok mass-proposal-select useCursorPointer\" onClick=\"multiSelectAction(<?php echo $event['Event']['id']; ?>, 'acceptProposals');\"></span>\n\t\t<span id=\"multi-discard-button\" title=\"Discard selected Proposals\" role=\"button\" tabindex=\"0\" aria-label=\"Discard selected Proposals\" class=\"hidden icon-remove mass-proposal-select useCursorPointer\" onClick=\"multiSelectAction(<?php echo $event['Event']['id']; ?>, 'discardProposals');\"></span>\n\t\t<span id=\"multi-sighting-button\" title=\"Sightings display for selected attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Sightings display for selected attributes\" class=\"hidden icon-wrench mass-select useCursorPointer sightings_advanced_add\" data-object-id=\"selected\" data-object-context=\"attribute\"></span>\n\t</div>\n\t<div class=\"tabMenu tabMenuToolsBlock noPrint\">\n\t\t<?php if ($mayModify): ?>\n\t\t\t<span id=\"create-button\" title=\"Populate using a template\" role=\"button\" tabindex=\"0\" aria-label=\"Populate using a template\" class=\"icon-list-alt useCursorPointer\" onClick=\"getPopup(<?php echo $event['Event']['id']; ?>, 'templates', 'templateChoices');\"></span>\n\t\t<?php endif; ?>\n\t\t<span id=\"freetext-button\" title=\"Populate using the freetext import tool\" role=\"button\" tabindex=\"0\" aria-label=\"Populate using the freetext import tool\" class=\"icon-exclamation-sign icon-inverse useCursorPointer\" onClick=\"getPopup(<?php echo $event['Event']['id']; ?>, 'events', 'freeTextImport');\"></span>\n\t\t<?php if ($mayModify): ?>\n\t\t\t<span id=\"attribute-replace-button\" title=\"Replace all attributes of a category/type combination within the event\" role=\"button\" tabindex=\"0\" aria-label=\"Replace all attributes of a category/type combination within the event\" class=\"icon-random useCursorPointer\" onClick=\"getPopup(<?php echo $event['Event']['id']; ?>, 'attributes', 'attributeReplace');\"></span>\n\t\t<?php endif; ?>\n\t</div>\n\t<?php\n\t\t$target = h($event['Event']['id']);\n\t\tif ($extended) $target .= '/extended:1';\n\t?>\n\t<div class=\"tabMenu tabMenuFiltersBlock noPrint\" style=\"padding-right:0px !important;\">\n\t\t<span id=\"filter_header\" class=\"attribute_filter_header\">Filters: </span>\n\t\t<div id=\"filter_all\" title=\"Show all attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Show all attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'all') echo '_active'; ?>\" onClick=\"filterAttributes('all', '<?php echo $target; ?>');\">All</div>\n\t\t<?php\n\t\t\tforeach ($typeGroups as $group):\n\t\t?>\n\t\t\t\t<div id=\"filter_<?php echo h($group); ?>\" title=\"Only show <?php echo $group; ?> related attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show <?php echo h($group); ?> related attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == $group) echo '_active'; ?>\" onClick=\"filterAttributes('<?php echo $group; ?>', '<?php echo $target; ?>');\"><?php echo ucfirst($group); ?></div>\n\t\t<?php\n\t\t\tendforeach;\n\t\t?>\n\t\t<div id=\"filter_proposal\" title=\"Only show proposals\" role=\"button\" tabindex=\"0\" aria-label=\"Only show proposals\" class=\"attribute_filter_text<?php if ($attributeFilter == 'proposal') echo '_active'; ?>\" onClick=\"filterAttributes('proposal', '<?php echo h($event['Event']['id']); ?>');\">Proposal</div>\n\t\t<div id=\"filter_correlation\" title=\"Only show correlating attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show correlating attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'correlation') echo '_active'; ?>\" onClick=\"filterAttributes('correlation', '<?php echo h($event['Event']['id']); ?>');\">Correlation</div>\n\t\t<div id=\"filter_warning\" title=\"Only show potentially false positive attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show potentially false positive attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'warning') echo '_active'; ?>\" onClick=\"filterAttributes('warning', '<?php echo h($event['Event']['id']); ?>');\">Warnings</div>\n\t\t<?php if ($me['Role']['perm_sync'] || $event['Orgc']['id'] == $me['org_id']): ?>\n\t\t\t<div id=\"filter_deleted\" title=\"Include deleted attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Include deleted attributes\" class=\"attribute_filter_text<?php if ($deleted) echo '_active'; ?>\" onClick=\"toggleDeletedAttributes('<?php echo Router::url( $this->here, true );?>');\">Include deleted attributes</div>\n\t\t<?php endif; ?>\n\t\t<div id=\"show_context\" title=\"Show attribute context fields\" role=\"button\" tabindex=\"0\" aria-label=\"Show attribute context fields\" class=\"attribute_filter_text\" onClick=\"toggleContextFields();\">Show context fields</div>\n\t\t<div title=\"input filter\" tabindex=\"0\" aria-label=\"input filter\" class=\"attribute_filter_text\" style=\"padding-top:0px;\">\n\t\t\t<input type=\"text\" id=\"attributesFilterField\" style=\"height:20px;padding:0px;margin:0px;\" class=\"form-control\" data-eventid=\"<?php echo h($event['Event']['id']); ?>\" value=\"<?php if ($filtered) echo h($passedArgsArray['all']); ?>\"></input>\n\t\t\t\t<span id=\"attributesFilterButton\" role=\"button\" class=\"icon-search\" tabindex=\"0\" aria-label=\"Filter on attributes value\" onClick=\"filterAttributes('value', '<?php echo h($event['Event']['id']); ?>');\"></span>\n\t\t\t\t<?php if ($filtered):?>\n\t\t\t\t\t<span tabindex=\"0\" aria-label=\"Show all attributes\" title=\"Remove filters\" role=\"button\" onClick=\"filterAttributes('all', '<?php echo h($event['Event']['id']); ?>');\" class='icon-remove'></span>\n\t\t\t\t<?php endif;?>\n\t\t</div>\n\t</div>\n\n\t<table class=\"table table-striped table-condensed\">\n\t\t<tr>\n\t\t\t<?php\n\t\t\t\tif ($extended || ($mayModify && !empty($event['objects']))):\n\t\t\t\t\t$fieldCount += 1;\n\t\t\t?>\n\t\t\t\t\t<th><input class=\"select_all\" type=\"checkbox\" title=\"Select all\" role=\"button\" tabindex=\"0\" aria-label=\"Select all attributes/proposals on current page\" onClick=\"toggleAllAttributeCheckboxes();\" /></th>\n\t\t\t<?php\n\t\t\t\tendif;\n\t\t\t?>\n\t\t\t<th class=\"context hidden\"><?php echo $this->Paginator->sort('id');?></th>\n\t\t\t<th class=\"context hidden\">UUID</th>\n\t\t\t<th><?php echo $this->Paginator->sort('timestamp', 'Date');?></th>\n\t\t\t<?php\n\t\t\t\tif ($extended):\n\t\t\t?>\n\t\t\t\t\t<th class=\"event_id\"><?php echo $this->Paginator->sort('event_id', 'Event');?></th>\n\t\t\t<?php\n\t\tendif;\n\t\t\t?>\n\t\t\t<th><?php echo $this->Paginator->sort('Org.name', 'Org'); ?>\n\t\t\t<th><?php echo $this->Paginator->sort('category');?></th>\n\t\t\t<th><?php echo $this->Paginator->sort('type');?></th>\n\t\t\t<th><?php echo $this->Paginator->sort('value');?></th>\n\t\t\t<th>Tags</th>\n\t\t\t<th>Galaxies</th>\n\t\t\t<th><?php echo $this->Paginator->sort('comment');?></th>\n\t\t\t<th>Correlate</th>\n\t\t\t<th>Related Events</th>\n\t\t\t<th>Feed hits</th>\n\t\t\t<th title=\"<?php echo $attrDescriptions['signature']['desc'];?>\"><?php echo $this->Paginator->sort('to_ids', 'IDS');?></th>\n\t\t\t<th title=\"<?php echo $attrDescriptions['distribution']['desc'];?>\"><?php echo $this->Paginator->sort('distribution');?></th>\n\t\t\t<th>Sightings</th>\n\t\t\t<th>Activity</th>\n\t\t\t<th class=\"actions\">Actions</th>\n\t\t</tr>\n\t\t<?php\n\t\t\t$elements = array(\n\t\t\t\t0 => 'attribute',\n\t\t\t\t1 => 'proposal',\n\t\t\t\t2 => 'proposal_delete',\n\t\t\t\t3 => 'object'\n\t\t\t);\n\t\t\t$focusedRow = false;\n\t\t\tforeach ($event['objects'] as $k => $object) {\n\t\t\t\t$insertBlank = false;\n\t\t\t\techo $this->element('/Events/View/row_' . $object['objectType'], array(\n\t\t\t\t\t'object' => $object,\n\t\t\t\t\t'k' => $k,\n\t\t\t\t\t'mayModify' => $mayModify,\n\t\t\t\t\t'mayChangeCorrelation' => $mayChangeCorrelation,\n\t\t\t\t\t'page' => $page,\n\t\t\t\t\t'fieldCount' => $fieldCount\n\t\t\t\t));\n\t\t\t\tif (!empty($focus) && ($object['objectType'] == 'object' || $object['objectType'] == 'attribute') && $object['uuid'] == $focus) {\n\t\t\t\t\t$focusedRow = $k;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\t($object['objectType'] == 'attribute' && !empty($object['ShadowAttribute'])) ||\n\t\t\t\t\t$object['objectType'] == 'object'\n\t\t\t\t):\n\t\t?>\n\t\t\t\t\t<tr class=\"blank_table_row\"><td colspan=\"<?php echo $fieldCount; ?>\"></td></tr>\n\t\t<?php\n\t\t\t\tendif;\n\t\t\t}\n\t\t?>\n\t</table>\n</div>\n\t<?php if ($emptyEvent): ?>\n\t\t<div class=\"background-red bold\">\n\t\t\t<span>\n\t\t\t<?php\n\t\t\t\tif ($me['org_id'] != $event['Event']['orgc_id']) {\n\t\t\t\t\techo 'Attribute warning: This event doesn\\'t have any attributes visible to you. Either the owner of the event decided to have\na specific distribution scheme per attribute and wanted to still distribute the event alone either for notification or potential contribution with attributes without such restriction. Or the owner forgot to add the\nattributes or the appropriate distribution level. If you think there is a mistake or you can contribute attributes based on the event meta-information, feel free to make a proposal';\n\t\t\t\t} else {\n\t\t\t\t\techo 'Attribute warning: This event doesn\\'t contain any attribute. It\\'s strongly advised to populate the event with attributes (indicators, observables or information) to provide a meaningful event';\n\t\t\t\t}\n\t\t\t?>\n\t\t\t</span>\n\t\t</div>\n\t<?php endif;?>\n\t<div class=\"pagination\">\n\t\t<ul>\n\t\t<?php\n\t\t\t$this->Paginator->options(array(\n\t\t\t\t'url' => $url,\n\t\t\t\t'update' => '#attributes_div',\n\t\t\t\t'evalScripts' => true,\n\t\t\t\t'before' => '$(\".progress\").show()',\n\t\t\t\t'complete' => '$(\".progress\").hide()',\n\t\t\t));\n\t\t\techo $this->Paginator->prev('&laquo; ' . __('previous'), array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'prev disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t\techo $this->Paginator->numbers(array('modulus' => 60, 'separator' => '', 'tag' => 'li', 'currentClass' => 'red', 'currentTag' => 'span'));\n\t\t\techo $this->Paginator->next(__('next') . ' &raquo;', array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'next disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t?>\n\t\t<li class=\"all <?php if ($all) echo 'disabled'; ?>\">\n\t\t\t<?php\n\t\t\t\tif ($all):\n\t\t\t?>\n\t\t\t\t<span class=\"red\">view all</span>\n\t\t\t<?php\n\t\t\t\telse:\n\t\t\t\t\techo $this->Paginator->link(__('view all'), 'all');\n\t\t\t\tendif;\n\t\t\t?>\n\t\t</li>\n\t\t</ul>\n\t</div>\n<script type=\"text/javascript\">\n\tvar currentUri = \"<?php echo isset($currentUri) ? h($currentUri) : '/events/viewEventAttributes/' . h($event['Event']['id']); ?>\";\n\tvar ajaxResults = [];\n\tvar timer;\n\tvar lastSelected = false;\n\tvar deleted = <?php echo (isset($deleted) && $deleted) ? 'true' : 'false';?>;\n\t$(document).ready(function() {\n\t\t<?php\n\t\t\tif ($focusedRow !== false):\n\t\t?>\n\t\t\t//window.location.hash = '.row_' + '<?php echo h($focusedRow); ?>';\n\t\t\t//$.scrollTo('#row_' + '<?php echo h($k); ?>', 800, {easing:'elasout'});\n\t\t\t//$('html,body').animate({scrollTop: $('#row_' + '<?php echo h($k); ?>').offset().top}, 'slow');\n\t\t\t\t$('.row_' + '<?php echo h($focusedRow); ?>').focus();\n\t\t<?php\n\t\t\tendif;\n\t\t?>\n\t\tsetContextFields();\n\t\tpopoverStartup();\n\t\t$('.select_attribute').removeAttr('checked');\n\t\t$('.select_proposal').removeAttr('checked');\n\t\t$('.select_attribute').click(function(e) {\n\t\t\tif ($(this).is(':checked')) {\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\tselectAllInbetween(lastSelected, this.id);\n\t\t\t\t}\n\t\t\t\tlastSelected = this.id;\n\t\t\t}\n\t\t\tattributeListAnyAttributeCheckBoxesChecked();\n\t\t});\n\t\t$('.select_proposal').click(function(e){\n\t\t\tif ($(this).is(':checked')) {\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\tselectAllInbetween(lastSelected, this.id);\n\t\t\t\t}\n\t\t\t\tlastSelected = this.id;\n\t\t\t}\n\t\t\tattributeListAnyProposalCheckBoxesChecked();\n\t\t});\n\t\t$('.select_all').click(function() {\n\t\t\tattributeListAnyAttributeCheckBoxesChecked();\n\t\t\tattributeListAnyProposalCheckBoxesChecked();\n\t\t});\n\t\t$('.correlation-toggle').click(function() {\n\t\t\tvar attribute_id = $(this).data('attribute-id');\n\t\t\tgetPopup(attribute_id, 'attributes', 'toggleCorrelation', '', '#confirmation_box');\n\t\t\treturn false;\n\t\t});\n\t\t$('.screenshot').click(function() {\n\t\t\tscreenshotPopup($(this).attr('src'), $(this).attr('title'));\n\t\t});\n\t\t$('.sightings_advanced_add').click(function() {\n\t\t\tvar selected = [];\n\t\t\tvar object_context = $(this).data('object-context');\n\t\t\tvar object_id = $(this).data('object-id');\n\t\t\tif (object_id == 'selected') {\n\t\t\t\t$(\".select_attribute\").each(function() {\n\t\t\t\t\tif ($(this).is(\":checked\")) {\n\t\t\t\t\t\tselected.push($(this).data(\"id\"));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tobject_id = selected.join('|');\n\t\t\t}\n\t\t\turl = \"<?php echo $baseurl; ?>\" + \"/sightings/advanced/\" + object_id + \"/\" + object_context;\n\t\t\tgenericPopup(url, '#screenshot_box');\n\t\t});\n\t});\n\t$('#attributesFilterField').bind(\"keydown\", function(e) {\n\t\tvar eventid = $('#attributesFilterField').data(\"eventid\");\n\t\tif ((e.keyCode == 13 || e.keyCode == 10)) {\n\t\t\tfilterAttributes('value', eventid);\n\t\t}\n\t});\n\t$('.hex-value-convert').click(function() {\n\t\tvar val = $(this).parent().children(':first-child').text();\n\t\tif ($(this).parent().children(':first-child').attr('data-original-title') == 'Hexadecimal representation') {\n\t\t\tvar bin = [];\n\t\t\tvar temp;\n\t\t\tval.split('').forEach(function(entry) {\n\t\t\t\ttemp = parseInt(entry, 16).toString(2);\n\t\t\t\tbin.push(Array(5 - (temp.length)).join('0') + temp);\n\t\t\t});\n\t\t\tbin = bin.join(' ');\n\t\t\t$(this).parent().children(':first-child').text(bin);\n\t\t\t$(this).parent().children(':first-child').attr('data-original-title', 'Binary representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('data-original-title', 'Switch to hexadecimal representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('aria-label', 'Switch to hexadecimal representation');\n\t\t} else {\n\t\t\tval = val.split(' ');\n\t\t\thex = '';\n\t\t\tval.forEach(function(entry) {\n\t\t\t\thex += parseInt(entry , 2).toString(16).toUpperCase();\n\t\t\t});\n\t\t\t$(this).parent().children(':first-child').text(hex);\n\t\t\t$(this).parent().children(':first-child').attr('data-original-title', 'Hexadecimal representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('data-original-title', 'Switch to binary representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('aria-label', 'Switch to binary representation');\n\t\t}\n\t});\n</script>\n<?php\n\techo $this->Js->writeBuffer();\n?>\n"], "fixing_code": ["<?php\n\t$urlHere = $this->here;\n\t$urlHere = explode('/', $urlHere);\n\tforeach ($urlHere as $k => $v) {\n\t\t$urlHere[$k] = urlencode($v);\n\t}\n\t$urlHere = implode('/', $urlHere);\n\t$urlHere = $baseurl . $urlHere;\n\t$mayModify = ($isSiteAdmin || ($isAclModify && $event['Event']['user_id'] == $me['id'] && $event['Orgc']['id'] == $me['org_id']) || ($isAclModifyOrg && $event['Orgc']['id'] == $me['org_id']));\n\t$mayPublish = ($isAclPublish && $event['Orgc']['id'] == $me['org_id']);\n\t$mayChangeCorrelation = !Configure::read('MISP.completely_disable_correlation') && ($isSiteAdmin || ($mayModify && Configure::read('MISP.allow_disabling_correlation')));\n\t$possibleAction = 'Proposal';\n\tif ($mayModify) $possibleAction = 'Attribute';\n\t$all = false;\n\tif (isset($this->params->params['paging']['Event']['page'])) {\n\t\tif ($this->params->params['paging']['Event']['page'] == 0) $all = true;\n\t\t$page = $this->params->params['paging']['Event']['page'];\n\t} else {\n\t\t$page = 0;\n\t}\n\t$fieldCount = 11;\n\tif (!empty($event['Sighting'])) {\n\t\tforeach ($sightingsData['data'] as $aid => $data) {\n\t\t\t$sightingsData['data'][$aid]['html'] = '';\n\t\t\tforeach ($data as $type => $typeData) {\n\t\t\t\t$name = (($type != 'expiration') ? Inflector::pluralize($type) : $type);\n\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<span class=\\'blue bold\\'>' . ucfirst(h($name)) . '</span><br />';\n\t\t\t\tforeach ($typeData['orgs'] as $org => $orgData) {\n\t\t\t\t\t$extra = (($org == $me['Organisation']['name']) ? \" class=\t'bold'\" : \"\");\n\t\t\t\t\tif ($type == 'expiration') {\n\t\t\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<span ' . $extra . '>' . h($org) . '</span>: <span class=\\'orange bold\\'>' . date('Y-m-d H:i:s', $orgData['date']) . '</span><br />';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<span ' . $extra . '>' . h($org) . '</span>: <span class=\\'' . (($type == 'sighting') ? 'green' : 'red') . ' bold\\'>' . h($orgData['count']) . ' (' . date('Y-m-d H:i:s', $orgData['date']) . ')</span><br />';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$sightingsData['data'][$aid]['html'] .= '<br />';\n\t\t\t}\n\t\t}\n\t}\n\t$filtered = false;\n\tif(isset($passedArgsArray)){\n\t\tif (count($passedArgsArray) > 0) {\n\t\t\t$filtered = true;\n\t\t}\n\t}\n?>\n\t<div class=\"pagination\">\n\t\t<ul>\n\t\t<?php\n\t\t\t$params = $this->request->named;\n\t\t\tunset($params['focus']);\n\t\t\t$url = array_merge(array('controller' => 'events', 'action' => 'viewEventAttributes', $event['Event']['id']), $params);\n\t\t\t$this->Paginator->options(array(\n\t\t\t\t'url' => $url,\n\t\t\t\t'update' => '#attributes_div',\n\t\t\t\t'evalScripts' => true,\n\t\t\t\t'before' => '$(\".progress\").show()',\n\t\t\t\t'complete' => '$(\".progress\").hide()',\n\t\t\t));\n\t\t\techo $this->Paginator->prev('&laquo; ' . __('previous'), array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'prev disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t\techo $this->Paginator->numbers(array('modulus' => 60, 'separator' => '', 'tag' => 'li', 'currentClass' => 'red', 'currentTag' => 'span'));\n\t\t\techo $this->Paginator->next(__('next') . ' &raquo;', array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'next disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t?>\n\t\t<li class=\"all <?php if ($all) echo 'disabled'; ?>\">\n\t\t\t<?php\n\t\t\t\tif ($all):\n\t\t\t?>\n\t\t\t\t<span class=\"red\">view all</span>\n\t\t\t<?php\n\t\t\t\telse:\n\t\t\t\t\techo $this->Paginator->link(__('view all'), 'all');\n\t\t\t\tendif;\n\t\t\t?>\n\t\t</li>\n\t\t</ul>\n\t</div>\n<br />\n<div id=\"edit_object_div\">\n\t<?php\n\t\techo $this->Form->create('Attribute', array('id' => 'delete_selected', 'url' => '/attributes/deleteSelected/' . $event['Event']['id']));\n\t\techo $this->Form->input('ids_delete', array(\n\t\t\t'type' => 'text',\n\t\t\t'value' => 'test',\n\t\t\t'style' => 'display:none;',\n\t\t\t'label' => false,\n\t\t));\n\t\techo $this->Form->end();\n\t?>\n\t\t<?php\n\t\techo $this->Form->create('ShadowAttribute', array('id' => 'accept_selected', 'url' => '/shadow_attributes/acceptSelected/' . $event['Event']['id']));\n\t\techo $this->Form->input('ids_accept', array(\n\t\t\t'type' => 'text',\n\t\t\t'value' => '',\n\t\t\t'style' => 'display:none;',\n\t\t\t'label' => false,\n\t\t));\n\t\techo $this->Form->end();\n\t?>\n\t\t<?php\n\t\techo $this->Form->create('ShadowAttribute', array('id' => 'discard_selected', 'url' => '/shadow_attributes/discardSelected/' . $event['Event']['id']));\n\t\techo $this->Form->input('ids_discard', array(\n\t\t\t'type' => 'text',\n\t\t\t'value' => '',\n\t\t\t'style' => 'display:none;',\n\t\t\t'label' => false,\n\t\t));\n\t\techo $this->Form->end();\n\t\tif (!isset($attributeFilter)) $attributeFilter = 'all';\n\t?>\n</div>\n<div id=\"attributeList\" class=\"attributeListContainer\">\n\t<div class=\"tabMenu tabMenuEditBlock noPrint\">\n\t\t<span id=\"create-button\" title=\"Add attribute\" role=\"button\" tabindex=\"0\" aria-label=\"Add attribute\" class=\"icon-plus useCursorPointer\" onClick=\"clickCreateButton(<?php echo $event['Event']['id']; ?>, '<?php echo $possibleAction; ?>');\"></span>\n\t\t<span id=\"multi-edit-button\" title=\"Edit selected Attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Edit selected Attributes\" class=\"hidden icon-edit mass-select useCursorPointer\" onClick=\"editSelectedAttributes(<?php echo $event['Event']['id']; ?>);\"></span>\n\t\t<span id=\"multi-tag-button\" title=\"Tag selected Attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Tag selected Attributes\" class=\"hidden icon-tag mass-select useCursorPointer\" onClick=\"getPopup('selected/true', 'tags', 'selectTaxonomy');\"></span>\n\t\t<span id=\"multi-delete-button\" title=\"Delete selected Attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Delete selected Attributes\" class=\"hidden icon-trash mass-select useCursorPointer\" onClick=\"multiSelectAction(<?php echo $event['Event']['id']; ?>, 'deleteAttributes');\"></span>\n\t\t<span id=\"multi-accept-button\" title=\"Accept selected Proposals\" role=\"button\" tabindex=\"0\" aria-label=\"Accept selected Proposals\" class=\"hidden icon-ok mass-proposal-select useCursorPointer\" onClick=\"multiSelectAction(<?php echo $event['Event']['id']; ?>, 'acceptProposals');\"></span>\n\t\t<span id=\"multi-discard-button\" title=\"Discard selected Proposals\" role=\"button\" tabindex=\"0\" aria-label=\"Discard selected Proposals\" class=\"hidden icon-remove mass-proposal-select useCursorPointer\" onClick=\"multiSelectAction(<?php echo $event['Event']['id']; ?>, 'discardProposals');\"></span>\n\t\t<span id=\"multi-sighting-button\" title=\"Sightings display for selected attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Sightings display for selected attributes\" class=\"hidden icon-wrench mass-select useCursorPointer sightings_advanced_add\" data-object-id=\"selected\" data-object-context=\"attribute\"></span>\n\t</div>\n\t<div class=\"tabMenu tabMenuToolsBlock noPrint\">\n\t\t<?php if ($mayModify): ?>\n\t\t\t<span id=\"create-button\" title=\"Populate using a template\" role=\"button\" tabindex=\"0\" aria-label=\"Populate using a template\" class=\"icon-list-alt useCursorPointer\" onClick=\"getPopup(<?php echo $event['Event']['id']; ?>, 'templates', 'templateChoices');\"></span>\n\t\t<?php endif; ?>\n\t\t<span id=\"freetext-button\" title=\"Populate using the freetext import tool\" role=\"button\" tabindex=\"0\" aria-label=\"Populate using the freetext import tool\" class=\"icon-exclamation-sign icon-inverse useCursorPointer\" onClick=\"getPopup(<?php echo $event['Event']['id']; ?>, 'events', 'freeTextImport');\"></span>\n\t\t<?php if ($mayModify): ?>\n\t\t\t<span id=\"attribute-replace-button\" title=\"Replace all attributes of a category/type combination within the event\" role=\"button\" tabindex=\"0\" aria-label=\"Replace all attributes of a category/type combination within the event\" class=\"icon-random useCursorPointer\" onClick=\"getPopup(<?php echo $event['Event']['id']; ?>, 'attributes', 'attributeReplace');\"></span>\n\t\t<?php endif; ?>\n\t</div>\n\t<?php\n\t\t$target = h($event['Event']['id']);\n\t\tif ($extended) $target .= '/extended:1';\n\t?>\n\t<div class=\"tabMenu tabMenuFiltersBlock noPrint\" style=\"padding-right:0px !important;\">\n\t\t<span id=\"filter_header\" class=\"attribute_filter_header\">Filters: </span>\n\t\t<div id=\"filter_all\" title=\"Show all attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Show all attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'all') echo '_active'; ?>\" onClick=\"filterAttributes('all', '<?php echo $target; ?>');\">All</div>\n\t\t<?php\n\t\t\tforeach ($typeGroups as $group):\n\t\t?>\n\t\t\t\t<div id=\"filter_<?php echo h($group); ?>\" title=\"Only show <?php echo $group; ?> related attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show <?php echo h($group); ?> related attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == $group) echo '_active'; ?>\" onClick=\"filterAttributes('<?php echo $group; ?>', '<?php echo $target; ?>');\"><?php echo ucfirst($group); ?></div>\n\t\t<?php\n\t\t\tendforeach;\n\t\t?>\n\t\t<div id=\"filter_proposal\" title=\"Only show proposals\" role=\"button\" tabindex=\"0\" aria-label=\"Only show proposals\" class=\"attribute_filter_text<?php if ($attributeFilter == 'proposal') echo '_active'; ?>\" onClick=\"filterAttributes('proposal', '<?php echo h($event['Event']['id']); ?>');\">Proposal</div>\n\t\t<div id=\"filter_correlation\" title=\"Only show correlating attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show correlating attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'correlation') echo '_active'; ?>\" onClick=\"filterAttributes('correlation', '<?php echo h($event['Event']['id']); ?>');\">Correlation</div>\n\t\t<div id=\"filter_warning\" title=\"Only show potentially false positive attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Only show potentially false positive attributes\" class=\"attribute_filter_text<?php if ($attributeFilter == 'warning') echo '_active'; ?>\" onClick=\"filterAttributes('warning', '<?php echo h($event['Event']['id']); ?>');\">Warnings</div>\n\t\t<?php if ($me['Role']['perm_sync'] || $event['Orgc']['id'] == $me['org_id']): ?>\n\t\t\t<div id=\"filter_deleted\" title=\"Include deleted attributes\" role=\"button\" tabindex=\"0\" aria-label=\"Include deleted attributes\" class=\"attribute_filter_text<?php if ($deleted) echo '_active'; ?>\" onClick=\"toggleDeletedAttributes('<?php echo $urlHere;?>');\">Include deleted attributes</div>\n\t\t<?php endif; ?>\n\t\t<div id=\"show_context\" title=\"Show attribute context fields\" role=\"button\" tabindex=\"0\" aria-label=\"Show attribute context fields\" class=\"attribute_filter_text\" onClick=\"toggleContextFields();\">Show context fields</div>\n\t\t<div title=\"input filter\" tabindex=\"0\" aria-label=\"input filter\" class=\"attribute_filter_text\" style=\"padding-top:0px;\">\n\t\t\t<input type=\"text\" id=\"attributesFilterField\" style=\"height:20px;padding:0px;margin:0px;\" class=\"form-control\" data-eventid=\"<?php echo h($event['Event']['id']); ?>\" value=\"<?php if ($filtered) echo h($passedArgsArray['all']); ?>\"></input>\n\t\t\t\t<span id=\"attributesFilterButton\" role=\"button\" class=\"icon-search\" tabindex=\"0\" aria-label=\"Filter on attributes value\" onClick=\"filterAttributes('value', '<?php echo h($event['Event']['id']); ?>');\"></span>\n\t\t\t\t<?php if ($filtered):?>\n\t\t\t\t\t<span tabindex=\"0\" aria-label=\"Show all attributes\" title=\"Remove filters\" role=\"button\" onClick=\"filterAttributes('all', '<?php echo h($event['Event']['id']); ?>');\" class='icon-remove'></span>\n\t\t\t\t<?php endif;?>\n\t\t</div>\n\t</div>\n\n\t<table class=\"table table-striped table-condensed\">\n\t\t<tr>\n\t\t\t<?php\n\t\t\t\tif ($extended || ($mayModify && !empty($event['objects']))):\n\t\t\t\t\t$fieldCount += 1;\n\t\t\t?>\n\t\t\t\t\t<th><input class=\"select_all\" type=\"checkbox\" title=\"Select all\" role=\"button\" tabindex=\"0\" aria-label=\"Select all attributes/proposals on current page\" onClick=\"toggleAllAttributeCheckboxes();\" /></th>\n\t\t\t<?php\n\t\t\t\tendif;\n\t\t\t?>\n\t\t\t<th class=\"context hidden\"><?php echo $this->Paginator->sort('id');?></th>\n\t\t\t<th class=\"context hidden\">UUID</th>\n\t\t\t<th><?php echo $this->Paginator->sort('timestamp', 'Date');?></th>\n\t\t\t<?php\n\t\t\t\tif ($extended):\n\t\t\t?>\n\t\t\t\t\t<th class=\"event_id\"><?php echo $this->Paginator->sort('event_id', 'Event');?></th>\n\t\t\t<?php\n\t\t\t\tendif;\n\t\t\t?>\n\t\t\t<th><?php echo $this->Paginator->sort('Org.name', 'Org'); ?>\n\t\t\t<th><?php echo $this->Paginator->sort('category');?></th>\n\t\t\t<th><?php echo $this->Paginator->sort('type');?></th>\n\t\t\t<th><?php echo $this->Paginator->sort('value');?></th>\n\t\t\t<th>Tags</th>\n\t\t\t<th>Galaxies</th>\n\t\t\t<th><?php echo $this->Paginator->sort('comment');?></th>\n\t\t\t<th>Correlate</th>\n\t\t\t<th>Related Events</th>\n\t\t\t<th>Feed hits</th>\n\t\t\t<th title=\"<?php echo $attrDescriptions['signature']['desc'];?>\"><?php echo $this->Paginator->sort('to_ids', 'IDS');?></th>\n\t\t\t<th title=\"<?php echo $attrDescriptions['distribution']['desc'];?>\"><?php echo $this->Paginator->sort('distribution');?></th>\n\t\t\t<th>Sightings</th>\n\t\t\t<th>Activity</th>\n\t\t\t<th class=\"actions\">Actions</th>\n\t\t</tr>\n\t\t<?php\n\t\t\t$elements = array(\n\t\t\t\t0 => 'attribute',\n\t\t\t\t1 => 'proposal',\n\t\t\t\t2 => 'proposal_delete',\n\t\t\t\t3 => 'object'\n\t\t\t);\n\t\t\t$focusedRow = false;\n\t\t\tforeach ($event['objects'] as $k => $object) {\n\t\t\t\t$insertBlank = false;\n\t\t\t\techo $this->element('/Events/View/row_' . $object['objectType'], array(\n\t\t\t\t\t'object' => $object,\n\t\t\t\t\t'k' => $k,\n\t\t\t\t\t'mayModify' => $mayModify,\n\t\t\t\t\t'mayChangeCorrelation' => $mayChangeCorrelation,\n\t\t\t\t\t'page' => $page,\n\t\t\t\t\t'fieldCount' => $fieldCount\n\t\t\t\t));\n\t\t\t\tif (!empty($focus) && ($object['objectType'] == 'object' || $object['objectType'] == 'attribute') && $object['uuid'] == $focus) {\n\t\t\t\t\t$focusedRow = $k;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\t($object['objectType'] == 'attribute' && !empty($object['ShadowAttribute'])) ||\n\t\t\t\t\t$object['objectType'] == 'object'\n\t\t\t\t):\n\t\t?>\n\t\t\t\t\t<tr class=\"blank_table_row\"><td colspan=\"<?php echo $fieldCount; ?>\"></td></tr>\n\t\t<?php\n\t\t\t\tendif;\n\t\t\t}\n\t\t?>\n\t</table>\n</div>\n\t<?php if ($emptyEvent): ?>\n\t\t<div class=\"background-red bold\">\n\t\t\t<span>\n\t\t\t<?php\n\t\t\t\tif ($me['org_id'] != $event['Event']['orgc_id']) {\n\t\t\t\t\techo 'Attribute warning: This event doesn\\'t have any attributes visible to you. Either the owner of the event decided to have\na specific distribution scheme per attribute and wanted to still distribute the event alone either for notification or potential contribution with attributes without such restriction. Or the owner forgot to add the\nattributes or the appropriate distribution level. If you think there is a mistake or you can contribute attributes based on the event meta-information, feel free to make a proposal';\n\t\t\t\t} else {\n\t\t\t\t\techo 'Attribute warning: This event doesn\\'t contain any attribute. It\\'s strongly advised to populate the event with attributes (indicators, observables or information) to provide a meaningful event';\n\t\t\t\t}\n\t\t\t?>\n\t\t\t</span>\n\t\t</div>\n\t<?php endif;?>\n\t<div class=\"pagination\">\n\t\t<ul>\n\t\t<?php\n\t\t\t$this->Paginator->options(array(\n\t\t\t\t'url' => $url,\n\t\t\t\t'update' => '#attributes_div',\n\t\t\t\t'evalScripts' => true,\n\t\t\t\t'before' => '$(\".progress\").show()',\n\t\t\t\t'complete' => '$(\".progress\").hide()',\n\t\t\t));\n\t\t\techo $this->Paginator->prev('&laquo; ' . __('previous'), array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'prev disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t\techo $this->Paginator->numbers(array('modulus' => 60, 'separator' => '', 'tag' => 'li', 'currentClass' => 'red', 'currentTag' => 'span'));\n\t\t\techo $this->Paginator->next(__('next') . ' &raquo;', array('tag' => 'li', 'escape' => false), null, array('tag' => 'li', 'class' => 'next disabled', 'escape' => false, 'disabledTag' => 'span'));\n\t\t?>\n\t\t<li class=\"all <?php if ($all) echo 'disabled'; ?>\">\n\t\t\t<?php\n\t\t\t\tif ($all):\n\t\t\t?>\n\t\t\t\t<span class=\"red\">view all</span>\n\t\t\t<?php\n\t\t\t\telse:\n\t\t\t\t\techo $this->Paginator->link(__('view all'), 'all');\n\t\t\t\tendif;\n\t\t\t?>\n\t\t</li>\n\t\t</ul>\n\t</div>\n<script type=\"text/javascript\">\n\tvar currentUri = \"<?php echo isset($currentUri) ? h($currentUri) : '/events/viewEventAttributes/' . h($event['Event']['id']); ?>\";\n\tvar ajaxResults = [];\n\tvar timer;\n\tvar lastSelected = false;\n\tvar deleted = <?php echo (isset($deleted) && $deleted) ? 'true' : 'false';?>;\n\t$(document).ready(function() {\n\t\t<?php\n\t\t\tif ($focusedRow !== false):\n\t\t?>\n\t\t\t//window.location.hash = '.row_' + '<?php echo h($focusedRow); ?>';\n\t\t\t//$.scrollTo('#row_' + '<?php echo h($k); ?>', 800, {easing:'elasout'});\n\t\t\t//$('html,body').animate({scrollTop: $('#row_' + '<?php echo h($k); ?>').offset().top}, 'slow');\n\t\t\t\t$('.row_' + '<?php echo h($focusedRow); ?>').focus();\n\t\t<?php\n\t\t\tendif;\n\t\t?>\n\t\tsetContextFields();\n\t\tpopoverStartup();\n\t\t$('.select_attribute').removeAttr('checked');\n\t\t$('.select_proposal').removeAttr('checked');\n\t\t$('.select_attribute').click(function(e) {\n\t\t\tif ($(this).is(':checked')) {\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\tselectAllInbetween(lastSelected, this.id);\n\t\t\t\t}\n\t\t\t\tlastSelected = this.id;\n\t\t\t}\n\t\t\tattributeListAnyAttributeCheckBoxesChecked();\n\t\t});\n\t\t$('.select_proposal').click(function(e){\n\t\t\tif ($(this).is(':checked')) {\n\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\tselectAllInbetween(lastSelected, this.id);\n\t\t\t\t}\n\t\t\t\tlastSelected = this.id;\n\t\t\t}\n\t\t\tattributeListAnyProposalCheckBoxesChecked();\n\t\t});\n\t\t$('.select_all').click(function() {\n\t\t\tattributeListAnyAttributeCheckBoxesChecked();\n\t\t\tattributeListAnyProposalCheckBoxesChecked();\n\t\t});\n\t\t$('.correlation-toggle').click(function() {\n\t\t\tvar attribute_id = $(this).data('attribute-id');\n\t\t\tgetPopup(attribute_id, 'attributes', 'toggleCorrelation', '', '#confirmation_box');\n\t\t\treturn false;\n\t\t});\n\t\t$('.screenshot').click(function() {\n\t\t\tscreenshotPopup($(this).attr('src'), $(this).attr('title'));\n\t\t});\n\t\t$('.sightings_advanced_add').click(function() {\n\t\t\tvar selected = [];\n\t\t\tvar object_context = $(this).data('object-context');\n\t\t\tvar object_id = $(this).data('object-id');\n\t\t\tif (object_id == 'selected') {\n\t\t\t\t$(\".select_attribute\").each(function() {\n\t\t\t\t\tif ($(this).is(\":checked\")) {\n\t\t\t\t\t\tselected.push($(this).data(\"id\"));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tobject_id = selected.join('|');\n\t\t\t}\n\t\t\turl = \"<?php echo $baseurl; ?>\" + \"/sightings/advanced/\" + object_id + \"/\" + object_context;\n\t\t\tgenericPopup(url, '#screenshot_box');\n\t\t});\n\t});\n\t$('#attributesFilterField').bind(\"keydown\", function(e) {\n\t\tvar eventid = $('#attributesFilterField').data(\"eventid\");\n\t\tif ((e.keyCode == 13 || e.keyCode == 10)) {\n\t\t\tfilterAttributes('value', eventid);\n\t\t}\n\t});\n\t$('.hex-value-convert').click(function() {\n\t\tvar val = $(this).parent().children(':first-child').text();\n\t\tif ($(this).parent().children(':first-child').attr('data-original-title') == 'Hexadecimal representation') {\n\t\t\tvar bin = [];\n\t\t\tvar temp;\n\t\t\tval.split('').forEach(function(entry) {\n\t\t\t\ttemp = parseInt(entry, 16).toString(2);\n\t\t\t\tbin.push(Array(5 - (temp.length)).join('0') + temp);\n\t\t\t});\n\t\t\tbin = bin.join(' ');\n\t\t\t$(this).parent().children(':first-child').text(bin);\n\t\t\t$(this).parent().children(':first-child').attr('data-original-title', 'Binary representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('data-original-title', 'Switch to hexadecimal representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('aria-label', 'Switch to hexadecimal representation');\n\t\t} else {\n\t\t\tval = val.split(' ');\n\t\t\thex = '';\n\t\t\tval.forEach(function(entry) {\n\t\t\t\thex += parseInt(entry , 2).toString(16).toUpperCase();\n\t\t\t});\n\t\t\t$(this).parent().children(':first-child').text(hex);\n\t\t\t$(this).parent().children(':first-child').attr('data-original-title', 'Hexadecimal representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('data-original-title', 'Switch to binary representation');\n\t\t\t$(this).parent().children(':nth-child(2)').attr('aria-label', 'Switch to binary representation');\n\t\t}\n\t});\n</script>\n<?php\n\techo $this->Js->writeBuffer();\n?>\n"], "filenames": ["app/View/Elements/eventattribute.ctp"], "buggy_code_start_loc": [1], "buggy_code_end_loc": [172], "fixing_code_start_loc": [2], "fixing_code_end_loc": [179], "type": "CWE-79", "message": "An issue was discovered in MISP 2.4.91. A vulnerability in app/View/Elements/eventattribute.ctp allows reflected XSS if a user clicks on a malicious link for an event view and then clicks on the deleted attributes quick filter.", "other": {"cve": {"id": "CVE-2018-11562", "sourceIdentifier": "cve@mitre.org", "published": "2018-05-30T20:29:00.313", "lastModified": "2018-06-29T18:03:09.317", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in MISP 2.4.91. A vulnerability in app/View/Elements/eventattribute.ctp allows reflected XSS if a user clicks on a malicious link for an event view and then clicks on the deleted attributes quick filter."}, {"lang": "es", "value": "Se ha descubierto un problema en MISP 2.4.91. Una vulnerabilidad en app/View/Elements/eventattribute.ctp permite Cross-Site Scripting (XSS) reflejado si un usuario hace clic en un enlace malicioso para una vista de eventos y luego hace clic en el filtro r\u00e1pido de atributos eliminados."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:misp:misp:2.4.91:*:*:*:*:*:*:*", "matchCriteriaId": "CF1578B2-981C-4EDB-91E4-5616E393AE47"}]}]}], "references": [{"url": "https://github.com/MISP/MISP/commit/10080096879d1076756f62760d6daf582b6db722", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/MISP/MISP/commit/10080096879d1076756f62760d6daf582b6db722"}}