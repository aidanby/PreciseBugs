{"buggy_code": ["<?php\ndefine('MODX_CORE_PATH', dirname(dirname(__FILE__)).'/core/');\ndefine('MODX_CONFIG_KEY', 'config');\n?>", "<div id=\"analytics-panel-widget\">\n    <div id=\"tab1\" class=\"x-hide-display\">\n        <div id=\"tab1-holder\">\n        <table class=\"classy\" style=\"width:100%\">\n        \n        <thead>\n        <tr>\n            <th>{$_langs.date}</th>\n            <th>{$_langs.visits}</th>\n            <th>{$_langs.unique_visitors}</th>\n            <th>{$_langs.pageviews_visits}</th>\n            <th>{$_langs.pageviews}</th>\n            <th>{$_langs.site_time}</th>\n            <th>{$_langs.new_visits}</th>\n            <th>{$_langs.bounce_rate}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {foreach from=$visitsarr.rows item=visits}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$visits.0}</td>\n                <td>{$visits.1}</td>\n                <td>{$visits.2}</td>\n                <td>{$visits.4|number_format:2:\",\":\".\"}</td>\n                <td>{$visits.3}</td>\n                <td>{$visits.5|number_format:2}</td>\n                <td>{$visits.6|number_format:2:\",\":\".\"} %</td>\n                <td>{$visits.7|number_format:2:\",\":\".\"} %</td>\n        </tr>\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        <tr>\n                <td>{$_langs.total}</td>\n                <td>{$visitsarr.totalsForAllResults.visits}</td>\n                <td>{$visitsarr.totalsForAllResults.visitors}</td>\n                <td>{$visitsarr.totalsForAllResults.pageviewsPerVisit|number_format:2:\",\":\".\"}</td>\n                <td>{$visitsarr.totalsForAllResults.pageviews}</td>\n                <td>{$visitsarr.totalsForAllResults.avgTimeOnSite|number_format:2}</td>\n                <td>{$visitsarr.totalsForAllResults.percentNewVisits|number_format:2:\",\":\".\"} %</td>\n                <td>{$visitsarr.totalsForAllResults.visitBounceRate|number_format:2:\",\":\".\"} %</td>\n        </tr>\n        </tbody>\n        </table>\n        </div>\n    </div>\n    <div id=\"tab2\" class=\"x-hide-display\">\n\t\t\t\t\n        <div id=\"tab2-holder\">\n            <h2>{$_langs.top_sources}</h2>\n            <table class=\"classy\" style=\"width: 48%; float:left; margin-right:2%;\">\n            \n\t            <thead>\n\t            <tr>\n\t                <th>{$_langs.sources}</th>\n\t                <th>{$_langs.visits}</th>\n\t                <th>% {$_langs.new_visits}</th>\n\t            </tr>\n\t            </thead>\n\t            <tbody>\n\t            {$i = 0}\n\t            {foreach from=$toptrafficsource.rows item=toptraffic}\n\t\t            {if $i == 5}{break}{/if}\n\t\t\t            <tr class=\"{cycle values=',odd'}\">\n\t\t\t                    <td>{$toptraffic.0}</td>\n\t\t\t                    <td>{$toptraffic.1}</td>\n\t\t\t                    <td>{$toptraffic.5|number_format:2:\",\":\".\"} %</td>\n\t\t\t            </tr>\n\t\t            {$i = $i+1}\n\t\t            {foreachelse}\n\t\t            <tr>\n\t\t                <th colspan=\"5\">{$_langs.connection_error}</th>\n\t\t            </tr>\n\t            {/foreach}\n            </tbody>\n            </table>\n            <table class=\"classy\" style=\"width: 48%; float:left; margin-right:2%;\">\n\t            <thead>\n\t            <tr>\n\t                <th>{$_langs.keywords}</th>\n\t                <th>{$_langs.visits}</th>\n\t                <th>% {$_langs.new_visits}</th>\n\t            </tr>\n\t            </thead>\n\t            <tbody>\n\n\t            {$i = 0}\n\t            {foreach from=$keywords.rows item=keyword}\n\t\t            {if $keyword.keyword != '(not set)'}\n\t\t\t            {if $i == 5}{break}{/if}\n\t\t\t            <tr class=\"{cycle values=',odd'}\">\n\t\t\t\t                    <td>{$keyword.0}</td>\n\t\t\t\t                    <td>{$keyword.1}</td>\n\t\t\t\t                    <td>{$keyword.3|number_format:2:\",\":\".\"} %</td>\n\t\t\t\t            </tr>\n\t\t\t            {$i = $i+1}\n\t\t            {/if}\n\t            {foreachelse}\n\t            <tr>\n\t                <th colspan=\"5\">{$_langs.connection_error}</th>\n\t            </tr>\n\t            {/foreach}\n            </tbody>\n            </table>\n            <p style=\"clear:both;\"></p>\n            <h2>{$_langs.referring_sites}</h2>\n            <table class=\"classy\" style=\"width: 100%;\">\n            \n            <thead>\n            <tr>\n                <th>{$_langs.sources}</th>\n                <th>{$_langs.visits}</th>\n                <th>{$_langs.pages_visits}</th>\n                <th>{$_langs.average_site_time}</th>\n                <th>% {$_langs.new_visits}</th>\n                <th>{$_langs.bounce_rate}</th>\n            </tr>\n            </thead>\n            <tbody>\n            {$i = 0}\n            {foreach from=$toptrafficsource.rows item=trafficreffered}\n                 {if $trafficreffered.0 != 'google' && $trafficreffered.0 != '(direct)' && $trafficreffered.0 != 'localhost' && $trafficreffered.0 != 'bing' && $trafficreffered.0 != 'google.nl'}\n                 {if $i == 10}{break}{/if}\n\n            <tr class=\"{cycle values=',odd'}\">\n                    <td>{$trafficreffered.0}</td>\n                    <td>{$trafficreffered.1}</td>\n                    <td>{$trafficreffered.3|number_format:2:\",\":\".\"} %</td>\n                    <td>{$trafficreffered.4|number_format:2}</td>\n                    <td>{$trafficreffered.5|number_format:2:\",\":\".\"} %</td>\n                    <td>{$trafficreffered.6|number_format:2:\",\":\".\"} %</td>\n            </tr>\n            {$i = $i+1}\n\n            {/if}\n            {foreachelse}\n            <tr>\n                <th colspan=\"5\">{$_langs.connection_error}</th>\n            </tr>\n            {/foreach}\n\n            </tbody>\n            </table>\n        </div>\n    </div>\n    <div id=\"tab3\" class=\"x-hide-display\">\n        <h2>{$_langs.top_landing_pages}</h2>\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th style=\"width: 40%;\">{$_langs.page}</th>\n            <th style=\"width: 20%;\">{$_langs.entrances}</th>\n            <th style=\"width: 20%;\">{$_langs.bounces}</th>\n            <th style=\"width: 20%;\">{$_langs.bounce_rate}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n        {foreach from=$toplandingspages.rows item=toppage}\n        {if $i == 10}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$toppage.0}</td>\n                <td>{$toppage.1}</td>\n                <td>{$toppage.2}</td>\n                <td>{$toppage.3|number_format:2:\",\":\".\"} %</td>\n\n        </tr>\n         {$i = $i+1}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n        <h2>{$_langs.top_exit_pages}</h2>\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th style=\"width: 40%;\">{$_langs.page}</th>\n            <th style=\"width: 20%;\">{$_langs.exits}</th>\n            <th style=\"width: 20%;\">{$_langs.pageviews}</th>\n            <th style=\"width: 20%;\">% {$_langs.exit}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n         {foreach from=$topexitpages.rows item=exitpage}\n        {if $i == 10}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$exitpage.0}</td>\n                <td>{$exitpage.1}</td>\n                <td>{$exitpage.2}</td>\n                <td>{$exitpage.3|number_format:2:\",\":\".\"} %</td>\n\n        </tr>\n         {$i = $i+1}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n\n    </div>\n    <div id=\"tab4\" class=\"x-hide-display\">\n        <div id=\"goals-holder\">\n        <h2>{$_langs.goals_part1} {$general.allGoals} {$_langs.goals_part2}</h2>\n        <table class=\"classy\" style=\"width: 48%;\">\n        <thead>\n        <tr>\n            <th>{$_langs.goals}</th>\n            <th>{$_langs.conversions}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {foreach from=$goalstable item=goal}\n        <tr class=\"{cycle values=',odd'}\">\n            <td>{$goal.goalname}</td>\n            <td>{$goal.completions}</td>\n        </tr>\n         {/foreach}\n        </tbody>\n        </table>\n        </div>\n\n    </div>\n    <div id=\"tab5\" class=\"x-hide-display\">\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th>{$_langs.keywords}</th>\n            <th>{$_langs.visits}</th>\n            <th>{$_langs.pages_visits}</th>\n            <th>{$_langs.average_site_time}</th>\n            <th>% {$_langs.new_visits}</th>\n            <th>{$_langs.bounce_rate}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n         {foreach from=$keywords.rows item=keyword}\n         {if $keyword.keyword != '(not set)'}\n         {if $i == 20}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$keyword.0}</td>\n                <td>{$keyword.1}</td>\n                <td>{$keyword.2|number_format:2:\",\":\".\"} %</td>\n                <td>{$keyword.3|number_format:2}</td>\n                <td>{$keyword.4|number_format:2:\",\":\".\"} %</td>\n                <td>{$keyword.5|number_format:2:\",\":\".\"} %</td>\n        </tr>\n        {$i = $i+1}\n        {/if}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n\n    </div>\n    <div id=\"tab6\" class=\"x-hide-display\">\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th>{$_langs.search_keyword}</th>\n            <th>{$_langs.search_uniques}</th>\n            <th>{$_langs.search_result_views}</th>\n            <th>% {$_langs.search_exits}</th>\n            <th>{$_langs.search_duration}</th>\n            <th>{$_langs.search_depth}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n         {foreach from=$sitesearches.rows item=sitesearch}\n         {if $i == 20}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$sitesearch.0}</td>\n                <td>{$sitesearch.1}</td>\n                <td>{$sitesearch.2}</td>\n                <td>{$sitesearch.3|number_format:2:\",\":\".\"}  %</td>\n                <td>{$sitesearch.4}</td>\n                <td>{$sitesearch.5}</td>\n        </tr>\n        {$i = $i+1}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.no_result}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n\n    </div>\n</div>\n", "<?php\n/**\n * @var modX $modx\n * @var array $scriptProperties\n */\n$setting = $modx->getObject('modSystemSetting', 'analyticsdashboardwidget.days');\n$days = $setting->get('value');\n$modx->getCacheManager();\n\n$analytics = $modx->cacheManager->get($days.'-analytics');\n\n$data = trim($_GET['data']);\n$format = trim($_GET['format']);\nif(isset($analytics)){\n\tif($format == 'json'){\n\t\tif(in_array($data, array('trafficsourceschararr', 'mobile', 'goalstable', 'profiles'))){\n\t\t\tprint(json_encode($analytics[$data]));\n\t\t}else{\n\t\t\tprint(json_encode($analytics[$data]['rows']));\n\t\t}\n\t}else{\n\t\tif(in_array($data, array('trafficsourceschararr', 'mobile', 'goalstable'))){\n\t\t\tprint_r($analytics[$data]);\n\t\t}else{\n\t\t\tprint_r($analytics[$data]['rows']);\n\t\t}\n\t}\n}\ndie();"], "fixing_code": ["<?php\ndefine('MODX_CORE_PATH', '/var/www/vhosts/modx2/corDvn78h87wvse/');\ndefine('MODX_CONFIG_KEY', 'config');", "<div id=\"analytics-panel-widget\">\n    <div id=\"tab1\" class=\"x-hide-display\">\n        <div id=\"tab1-holder\">\n        <table class=\"classy\" style=\"width:100%\">\n        \n        <thead>\n        <tr>\n            <th>{$_langs.date}</th>\n            <th>{$_langs.visits}</th>\n            <th>{$_langs.unique_visitors}</th>\n            <th>{$_langs.pageviews_visits}</th>\n            <th>{$_langs.pageviews}</th>\n            <th>{$_langs.site_time}</th>\n            <th>{$_langs.new_visits}</th>\n            <th>{$_langs.bounce_rate}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {foreach from=$visitsarr.rows item=visits}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$visits.0}</td>\n                <td>{$visits.1}</td>\n                <td>{$visits.2}</td>\n                <td>{$visits.4|number_format:2:\",\":\".\"}</td>\n                <td>{$visits.3}</td>\n                <td>{$visits.5|number_format:2}</td>\n                <td>{$visits.6|number_format:2:\",\":\".\"} %</td>\n                <td>{$visits.7|number_format:2:\",\":\".\"} %</td>\n        </tr>\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        <tr>\n                <td>{$_langs.total}</td>\n                <td>{$visitsarr.totalsForAllResults.visits}</td>\n                <td>{$visitsarr.totalsForAllResults.visitors}</td>\n                <td>{$visitsarr.totalsForAllResults.pageviewsPerVisit|number_format:2:\",\":\".\"}</td>\n                <td>{$visitsarr.totalsForAllResults.pageviews}</td>\n                <td>{$visitsarr.totalsForAllResults.avgTimeOnSite|number_format:2}</td>\n                <td>{$visitsarr.totalsForAllResults.percentNewVisits|number_format:2:\",\":\".\"} %</td>\n                <td>{$visitsarr.totalsForAllResults.visitBounceRate|number_format:2:\",\":\".\"} %</td>\n        </tr>\n        </tbody>\n        </table>\n        </div>\n    </div>\n    <div id=\"tab2\" class=\"x-hide-display\">\n\t\t\t\t\n        <div id=\"tab2-holder\">\n            <h2>{$_langs.top_sources}</h2>\n            <table class=\"classy\" style=\"width: 48%; float:left; margin-right:2%;\">\n            \n\t            <thead>\n\t            <tr>\n\t                <th>{$_langs.sources|escape:\"html\"}</th>\n\t                <th>{$_langs.visits}</th>\n\t                <th>% {$_langs.new_visits}</th>\n\t            </tr>\n\t            </thead>\n\t            <tbody>\n\t            {$i = 0}\n\t            {foreach from=$toptrafficsource.rows item=toptraffic}\n\t\t            {if $i == 5}{break}{/if}\n\t\t\t            <tr class=\"{cycle values=',odd'}\">\n\t\t\t                    <td>{$toptraffic.0|escape:\"html\"}</td>\n\t\t\t                    <td>{$toptraffic.1}</td>\n\t\t\t                    <td>{$toptraffic.5|number_format:2:\",\":\".\"} %</td>\n\t\t\t            </tr>\n\t\t            {$i = $i+1}\n\t\t            {foreachelse}\n\t\t            <tr>\n\t\t                <th colspan=\"5\">{$_langs.connection_error}</th>\n\t\t            </tr>\n\t            {/foreach}\n            </tbody>\n            </table>\n            <table class=\"classy\" style=\"width: 48%; float:left; margin-right:2%;\">\n\t            <thead>\n\t            <tr>\n\t                <th>{$_langs.keywords|escape:\"html\"}</th>\n\t                <th>{$_langs.visits}</th>\n\t                <th>% {$_langs.new_visits}</th>\n\t            </tr>\n\t            </thead>\n\t            <tbody>\n\n\t            {$i = 0}\n\t            {foreach from=$keywords.rows item=keyword}\n\t\t            {if $keyword.keyword != '(not set)'}\n\t\t\t            {if $i == 5}{break}{/if}\n\t\t\t            <tr class=\"{cycle values=',odd'}\">\n\t\t\t\t                    <td>{$keyword.0|escape:\"html\"}</td>\n\t\t\t\t                    <td>{$keyword.1}</td>\n\t\t\t\t                    <td>{$keyword.3|number_format:2:\",\":\".\"} %</td>\n\t\t\t\t            </tr>\n\t\t\t            {$i = $i+1}\n\t\t            {/if}\n\t            {foreachelse}\n\t            <tr>\n\t                <th colspan=\"5\">{$_langs.connection_error}</th>\n\t            </tr>\n\t            {/foreach}\n            </tbody>\n            </table>\n            <p style=\"clear:both;\"></p>\n            <h2>{$_langs.referring_sites}</h2>\n            <table class=\"classy\" style=\"width: 100%;\">\n            \n            <thead>\n            <tr>\n                <th>{$_langs.sources|escape:\"html\"}</th>\n                <th>{$_langs.visits}</th>\n                <th>{$_langs.pages_visits}</th>\n                <th>{$_langs.average_site_time}</th>\n                <th>% {$_langs.new_visits}</th>\n                <th>{$_langs.bounce_rate}</th>\n            </tr>\n            </thead>\n            <tbody>\n            {$i = 0}\n            {foreach from=$toptrafficsource.rows item=trafficreffered}\n                 {if $trafficreffered.0 != 'google' && $trafficreffered.0 != '(direct)' && $trafficreffered.0 != 'localhost' && $trafficreffered.0 != 'bing' && $trafficreffered.0 != 'google.nl'}\n                 {if $i == 10}{break}{/if}\n\n            <tr class=\"{cycle values=',odd'}\">\n                    <td>{$trafficreffered.0|escape:\"html\"}</td>\n                    <td>{$trafficreffered.1}</td>\n                    <td>{$trafficreffered.3|number_format:2:\",\":\".\"} %</td>\n                    <td>{$trafficreffered.4|number_format:2}</td>\n                    <td>{$trafficreffered.5|number_format:2:\",\":\".\"} %</td>\n                    <td>{$trafficreffered.6|number_format:2:\",\":\".\"} %</td>\n            </tr>\n            {$i = $i+1}\n\n            {/if}\n            {foreachelse}\n            <tr>\n                <th colspan=\"5\">{$_langs.connection_error}</th>\n            </tr>\n            {/foreach}\n\n            </tbody>\n            </table>\n        </div>\n    </div>\n    <div id=\"tab3\" class=\"x-hide-display\">\n        <h2>{$_langs.top_landing_pages}</h2>\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th style=\"width: 40%;\">{$_langs.page|escape:\"html\"}</th>\n            <th style=\"width: 20%;\">{$_langs.entrances}</th>\n            <th style=\"width: 20%;\">{$_langs.bounces}</th>\n            <th style=\"width: 20%;\">{$_langs.bounce_rate}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n        {foreach from=$toplandingspages.rows item=toppage}\n        {if $i == 10}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$toppage.0|escape:\"html\"}</td>\n                <td>{$toppage.1}</td>\n                <td>{$toppage.2}</td>\n                <td>{$toppage.3|number_format:2:\",\":\".\"} %</td>\n\n        </tr>\n         {$i = $i+1}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n        <h2>{$_langs.top_exit_pages}</h2>\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th style=\"width: 40%;\">{$_langs.page}</th>\n            <th style=\"width: 20%;\">{$_langs.exits}</th>\n            <th style=\"width: 20%;\">{$_langs.pageviews}</th>\n            <th style=\"width: 20%;\">% {$_langs.exit}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n         {foreach from=$topexitpages.rows item=exitpage}\n        {if $i == 10}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$exitpage.0}</td>\n                <td>{$exitpage.1}</td>\n                <td>{$exitpage.2}</td>\n                <td>{$exitpage.3|number_format:2:\",\":\".\"} %</td>\n\n        </tr>\n         {$i = $i+1}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n\n    </div>\n    <div id=\"tab4\" class=\"x-hide-display\">\n        <div id=\"goals-holder\">\n        <h2>{$_langs.goals_part1} {$general.allGoals} {$_langs.goals_part2}</h2>\n        <table class=\"classy\" style=\"width: 48%;\">\n        <thead>\n        <tr>\n            <th>{$_langs.goals}</th>\n            <th>{$_langs.conversions}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {foreach from=$goalstable item=goal}\n        <tr class=\"{cycle values=',odd'}\">\n            <td>{$goal.goalname}</td>\n            <td>{$goal.completions}</td>\n        </tr>\n         {/foreach}\n        </tbody>\n        </table>\n        </div>\n\n    </div>\n    <div id=\"tab5\" class=\"x-hide-display\">\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th>{$_langs.keywords|escape:\"html\"}</th>\n            <th>{$_langs.visits}</th>\n            <th>{$_langs.pages_visits}</th>\n            <th>{$_langs.average_site_time}</th>\n            <th>% {$_langs.new_visits}</th>\n            <th>{$_langs.bounce_rate}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n         {foreach from=$keywords.rows item=keyword}\n         {if $keyword.keyword != '(not set)'}\n         {if $i == 20}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$keyword.0|escape:\"html\"}</td>\n                <td>{$keyword.1}</td>\n                <td>{$keyword.2|number_format:2:\",\":\".\"} %</td>\n                <td>{$keyword.3|number_format:2}</td>\n                <td>{$keyword.4|number_format:2:\",\":\".\"} %</td>\n                <td>{$keyword.5|number_format:2:\",\":\".\"} %</td>\n        </tr>\n        {$i = $i+1}\n        {/if}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.connection_error}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n\n    </div>\n    <div id=\"tab6\" class=\"x-hide-display\">\n            <table class=\"classy\" style=\"width: 100%;\">\n        <thead>\n        <tr>\n            <th>{$_langs.search_keyword|escape:\"html\"}</th>\n            <th>{$_langs.search_uniques}</th>\n            <th>{$_langs.search_result_views}</th>\n            <th>% {$_langs.search_exits}</th>\n            <th>{$_langs.search_duration}</th>\n            <th>{$_langs.search_depth}</th>\n        </tr>\n        </thead>\n        <tbody>\n        {$i = 0}\n         {foreach from=$sitesearches.rows item=sitesearch}\n         {if $i == 20}{break}{/if}\n        <tr class=\"{cycle values=',odd'}\">\n                <td>{$sitesearch.0|escape:\"html\"}</td>\n                <td>{$sitesearch.1}</td>\n                <td>{$sitesearch.2}</td>\n                <td>{$sitesearch.3|number_format:2:\",\":\".\"}  %</td>\n                <td>{$sitesearch.4}</td>\n                <td>{$sitesearch.5}</td>\n        </tr>\n        {$i = $i+1}\n        {foreachelse}\n        <tr>\n            <th colspan=\"5\">{$_langs.no_result}</th>\n        </tr>\n        {/foreach}\n        </tbody>\n        </table>\n\n    </div>\n</div>\n", "<?php\n/**\n * @var modX $modx\n * @var array $scriptProperties\n */\n$setting = $modx->getObject('modSystemSetting', 'analyticsdashboardwidget.days');\n$days = $setting->get('value');\n$modx->getCacheManager();\n\n$analytics = $modx->cacheManager->get($days.'-analytics');\n\n$data = trim($_GET['data']);\n$format = trim($_GET['format']);\nif(isset($analytics)){\n\tif($format == 'json'){\n\t\tif(in_array($data, array('trafficsourceschararr', 'mobile', 'goalstable', 'profiles'))){\n\t\t    $data = $analytics[$data];\n\t\t\tprint(json_encode($data));\n\t\t}else{\n\t\t\tprint(json_encode($analytics[$data]['rows']));\n\t\t}\n\t}else{\n\t\tif(in_array($data, array('trafficsourceschararr', 'mobile', 'goalstable'))){\n\t\t\tprint_r($analytics[$data]);\n\t\t}else{\n\t\t\tprint_r($analytics[$data]['rows']);\n\t\t}\n\t}\n}\ndie();"], "filenames": ["config.core.php", "core/components/analyticsdashboardwidget/elements/tpl/widget.analytics.tpl", "core/components/analyticsdashboardwidget/processors/data.php"], "buggy_code_start_loc": [2, 57, 17], "buggy_code_end_loc": [5, 285, 18], "fixing_code_start_loc": [2, 57, 17], "fixing_code_end_loc": [4, 285, 19], "type": "CWE-79", "message": "A vulnerability was found in Sterc Google Analytics Dashboard for MODX up to 1.0.5. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file core/components/analyticsdashboardwidget/elements/tpl/widget.analytics.tpl of the component Internal Search. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 1.0.6 is able to address this issue. The name of the patch is 855d9560d3782c105568eedf9b22a769fbf29cc0. It is recommended to upgrade the affected component. The identifier VDB-217069 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2017-20155", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-30T23:15:08.883", "lastModified": "2023-01-06T19:05:20.837", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in Sterc Google Analytics Dashboard for MODX up to 1.0.5. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file core/components/analyticsdashboardwidget/elements/tpl/widget.analytics.tpl of the component Internal Search. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 1.0.6 is able to address this issue. The name of the patch is 855d9560d3782c105568eedf9b22a769fbf29cc0. It is recommended to upgrade the affected component. The identifier VDB-217069 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sterc:google_analytics_dashboard_for_modx:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.0.5", "matchCriteriaId": "41021BB5-14F4-4C48-8C4A-7376B9703258"}]}]}], "references": [{"url": "https://github.com/Sterc/Analytics-dashboard-widget/commit/855d9560d3782c105568eedf9b22a769fbf29cc0", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Sterc/Analytics-dashboard-widget/issues/11", "source": "cna@vuldb.com", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/Sterc/Analytics-dashboard-widget/milestone/2", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/Sterc/Analytics-dashboard-widget/pull/12", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217069", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217069", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Sterc/Analytics-dashboard-widget/commit/855d9560d3782c105568eedf9b22a769fbf29cc0"}}