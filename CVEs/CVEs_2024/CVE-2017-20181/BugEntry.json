{"buggy_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"at.hgz.vocabletrainer\"\n    android:versionCode=\"9\"\n    android:versionName=\"1.3.0\" >\n\n    <uses-sdk\n        android:minSdkVersion=\"14\"\n        android:targetSdkVersion=\"21\" />\n\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\n\n    <application\n        android:name=\".TrainingApplication\"\n        android:allowBackup=\"true\"\n        android:icon=\"@drawable/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:theme=\"@style/AppTheme\" >\n        <activity\n            android:name=\".DictionaryListActivity\"\n            android:label=\"@string/app_name\" >\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n        </activity>\n        <activity\n            android:name=\".TrainingActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".MultipleChoiceActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".VocableListActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".ConfigActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".ImportActivity\"\n            android:label=\"@string/title_activity_import\" >\n        </activity>\n        <activity\n            android:name=\".AboutActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".LicenseActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".ViewActivity\"\n            android:label=\"@string/app_name\"\n            android:noHistory=\"true\" >\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\" />\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <data android:mimeType=\"application/vnd.hgz.vocabletrainer\"/>\n                <data android:pathPattern=\".*\\\\.vt\" />\n            </intent-filter>\n        </activity>\n        <meta-data\n            android:name=\"com.google.android.gms.version\"\n            android:value=\"@integer/google_play_services_version\" />\n        <provider\n            android:name=\"at.hgz.vocabletrainer.VocableTrainerProvider\"\n            android:authorities=\"at.hgz.vocabletrainer.provider\"\n            android:exported=\"true\" />      \n    </application>\n\n</manifest>\n", "package at.hgz.vocabletrainer;\r\n\r\nimport java.io.File;\r\nimport java.io.FileNotFoundException;\r\n\r\nimport android.content.ContentProvider;\r\nimport android.content.ContentValues;\r\nimport android.database.Cursor;\r\nimport android.net.Uri;\r\nimport android.os.ParcelFileDescriptor;\r\nimport android.util.Log;\r\n\r\npublic class VocableTrainerProvider extends ContentProvider {\r\n\t\r\n\t@Override\r\n\tpublic ParcelFileDescriptor openFile(Uri uri, String mode) throws FileNotFoundException {       \r\n\t     File cacheDir = getContext().getCacheDir();\r\n\t     File privateFile = new File(cacheDir, uri.getLastPathSegment());\r\n\r\n\t     return ParcelFileDescriptor.open(privateFile, ParcelFileDescriptor.MODE_READ_ONLY);\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic int delete(Uri arg0, String arg1, String[] arg2) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic String getType(Uri arg0) {\r\n\t\treturn \"application/vnd.hgz.vocabletrainer\";\r\n\t}\r\n\r\n\t@Override\r\n\tpublic Uri insert(Uri arg0, ContentValues arg1) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn null;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic boolean onCreate() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn false;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic Cursor query(Uri arg0, String[] arg1, String arg2, String[] arg3,\r\n\t\t\tString arg4) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn null;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic int update(Uri arg0, ContentValues arg1, String arg2, String[] arg3) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn 0;\r\n\t}\r\n\r\n}\r\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    package=\"at.hgz.vocabletrainer\"\n    android:versionCode=\"10\"\n    android:versionName=\"1.3.1\" >\n\n    <uses-sdk\n        android:minSdkVersion=\"14\"\n        android:targetSdkVersion=\"21\" />\n\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\n\n    <application\n        android:name=\".TrainingApplication\"\n        android:allowBackup=\"true\"\n        android:icon=\"@drawable/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:theme=\"@style/AppTheme\" >\n        <activity\n            android:name=\".DictionaryListActivity\"\n            android:label=\"@string/app_name\" >\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n        </activity>\n        <activity\n            android:name=\".TrainingActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".MultipleChoiceActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".VocableListActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".ConfigActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".ImportActivity\"\n            android:label=\"@string/title_activity_import\" >\n        </activity>\n        <activity\n            android:name=\".AboutActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".LicenseActivity\"\n            android:label=\"@string/app_name\" >\n        </activity>\n        <activity\n            android:name=\".ViewActivity\"\n            android:label=\"@string/app_name\"\n            android:noHistory=\"true\" >\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\" />\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <data android:mimeType=\"application/vnd.hgz.vocabletrainer\"/>\n                <data android:pathPattern=\".*\\\\.vt\" />\n            </intent-filter>\n        </activity>\n        <meta-data\n            android:name=\"com.google.android.gms.version\"\n            android:value=\"@integer/google_play_services_version\" />\n        <provider\n            android:name=\"at.hgz.vocabletrainer.VocableTrainerProvider\"\n            android:authorities=\"at.hgz.vocabletrainer.provider\"\n            android:exported=\"true\" />      \n    </application>\n\n</manifest>\n", "package at.hgz.vocabletrainer;\r\n\r\nimport java.io.File;\r\nimport java.io.FileNotFoundException;\r\nimport java.io.IOException;\r\n\r\nimport android.content.ContentProvider;\r\nimport android.content.ContentValues;\r\nimport android.database.Cursor;\r\nimport android.net.Uri;\r\nimport android.os.ParcelFileDescriptor;\r\nimport android.util.Log;\r\n\r\npublic class VocableTrainerProvider extends ContentProvider {\r\n\t\r\n\t@Override\r\n\tpublic ParcelFileDescriptor openFile(Uri uri, String mode) throws FileNotFoundException {\r\n\t\ttry {\r\n\t\t\tString cacheDir = getContext().getCacheDir().toString();\r\n\t\t\tFile privateFile = new File(cacheDir, uri.getLastPathSegment());\r\n\r\n\t\t\tif (!privateFile.getCanonicalPath().startsWith(cacheDir)) {\r\n\t\t\t\tthrow new IllegalArgumentException();\r\n\t\t\t}\r\n\r\n\t\t\treturn ParcelFileDescriptor.open(privateFile, ParcelFileDescriptor.MODE_READ_ONLY);\r\n\t\t} catch (IOException e) {\r\n\t\t\tthrow new RuntimeException(e.getMessage(), e);\r\n\t\t}\r\n\t}\r\n\t\r\n\t@Override\r\n\tpublic int delete(Uri arg0, String arg1, String[] arg2) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic String getType(Uri arg0) {\r\n\t\treturn \"application/vnd.hgz.vocabletrainer\";\r\n\t}\r\n\r\n\t@Override\r\n\tpublic Uri insert(Uri arg0, ContentValues arg1) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn null;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic boolean onCreate() {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn false;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic Cursor query(Uri arg0, String[] arg1, String arg2, String[] arg3,\r\n\t\t\tString arg4) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn null;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic int update(Uri arg0, ContentValues arg1, String arg2, String[] arg3) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\treturn 0;\r\n\t}\r\n\r\n}\r\n"], "filenames": ["AndroidManifest.xml", "src/at/hgz/vocabletrainer/VocableTrainerProvider.java"], "buggy_code_start_loc": [4, 4], "buggy_code_end_loc": [6, 21], "fixing_code_start_loc": [4, 5], "fixing_code_end_loc": [6, 30], "type": "CWE-22", "message": "A vulnerability classified as critical was found in hgzojer Vocable Trainer up to 1.3.0. This vulnerability affects unknown code of the file src/at/hgz/vocabletrainer/VocableTrainerProvider.java. The manipulation leads to path traversal. Attacking locally is a requirement. Upgrading to version 1.3.1 is able to address this issue. The name of the patch is accf6838078f8eb105cfc7865aba5c705fb68426. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-222328.", "other": {"cve": {"id": "CVE-2017-20181", "sourceIdentifier": "cna@vuldb.com", "published": "2023-03-07T00:15:09.040", "lastModified": "2023-03-14T17:53:51.463", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as critical was found in hgzojer Vocable Trainer up to 1.3.0. This vulnerability affects unknown code of the file src/at/hgz/vocabletrainer/VocableTrainerProvider.java. The manipulation leads to path traversal. Attacking locally is a requirement. Upgrading to version 1.3.1 is able to address this issue. The name of the patch is accf6838078f8eb105cfc7865aba5c705fb68426. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-222328."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vocable_trainer_project:vocable_trainer:*:*:*:*:*:android:*:*", "versionEndExcluding": "1.3.1", "matchCriteriaId": "DAF5A5E0-952A-4CAA-A6E7-BFB0ADB49796"}]}]}], "references": [{"url": "https://github.com/hgzojer/vocabletrainer/commit/accf6838078f8eb105cfc7865aba5c705fb68426", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/hgzojer/vocabletrainer/releases/tag/v1.3.1", "source": "cna@vuldb.com", "tags": ["Release Notes"]}, {"url": "https://vuldb.com/?ctiid.222328", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.222328", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/hgzojer/vocabletrainer/commit/accf6838078f8eb105cfc7865aba5c705fb68426"}}