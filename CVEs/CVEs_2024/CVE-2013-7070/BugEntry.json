{"buggy_code": ["3.3.0  - 12-Aug-2013\n====================\n- Added a complete statistical Wowza Media Server graph.\n\t(suggested by Daniele Ilardo, kkstyle21 AT gmail.com)\n- Added a complete statistical PHP-APC graph.\n\t(suggested by Petr \u0160vec, petr.svec AT pak.izscr.cz)\n- Reimplemented the alarm signal handler placing it inside the main loop in\n  order to be able to control the timeouts in the 'disk' graph (and others).\n  This should avoid a complete freeze if the network goes down when monitoring\n  NFS filesystems. [#10]\n- Reimplemented the 'theme' option.\n- Implemented a complete email reporting mechanism. [#11]\n- Added the label 'Total' in the main graph of 'apache'.\n- Added a new option called 'show_gaps' to be able to see the gaps produced by\n  missing data in graphs.\n\t(suggested by Skibbi, skibbi AT gmail.com)\n- Add a check during the initialization of the 'nvidia' graph, to test for the\n  existence of the 'nvidia-smi' command.\n- Add a check during the initialization of the 'nfss' graph, to test if there\n  is the '/proc/net/rpc/nfsd' file.\n- Add a check during the initialization of the 'nfsc' graph, to test if there\n  is the '/proc/net/rpc/nfs' file.\n- Added the option 'url_prefix' in the 'traffacct' graph.\n- Added the option 'global_zoom' to all graphs.\n- Fixed a bug that prevented from seeing stats in the 'nfss' graph.\n- Fixed in 'nginx' graph the name of the iptables rules which prevented working\n  the network traffic graph. [#22]\n- Fixed a bug that prevented a correctly data collection in the 'fail2ban'\n  graph. [#23]\n- Fixed the description of 'netstats_in_bps' in monitorix.conf(5) man page.\n- Fixed a message of 'Argument \"\" isn't numeric in int ...' in 'nvidia' graph\n  when using newer official drivers.\n- Fixed a bug in Groups (Multihost view) that prevented from seeing the remote\n  server's graphs of the selected group.\n\t(thanks to Mauro Medda, m.medda AT tiscali.it)\n- Little code cleaning.\n\n\n3.2.1  - 03-Jun-2013\n====================\n- Changed the source from where is collected the memory usage in the 'squid'\n  graph. Now the shown values are more real and accurate.\n- Added user/password authentication options in the built-in HTTP server. [#14]\n- Added the script 'htpasswd.pl' to be able to encrypt passwords. [#14]\n- Added the options 'hosts_allow' and 'hosts_deny' to restrict access by IP\n  address to the built-in HTTP server. [#14]\n- Added the ability to specify an optional host address for the built-in HTTP\n  server to bind to. [#19]\n- Added a new option in the 'disk' graph called 'accept_invalid_disk' that\n  permits continue working even if some of the device names defined are invalid\n  or non-existent. This is specially useful to monitor external disks that\n  aren't permanently connected to the system.\n- Updated the 'monitorix.service' file. [#20]\n\t(thanks to Christopher Meng, rpm AT cicku.me)\n- Fixed a bug that prevented from seeing the Core temperatures in the 'lmsens'\n  graph.\n\t(thanks to Bryan Guidroz, bryanguidroz AT hotmail.com)\n- Fixed a typo and escaped a pair of hyphens in the monitorix.conf(5) man page.\n\n\n3.2.0  - 13-May-2013\n====================\n- Added a complete Raspberry Pi sensors graph. [#10, #13]\n\t(thanks to graysky, graysky AT archlinux.us)\n- Improved a bit the MySQL documentation in the monitorix.conf(5) man page.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Added a new option called 'temperature_scale' to be able to toggle between\n  values in Celsius or in Fahrenheit.\n\t(suggested by Bryan Guidroz, bryanguidroz AT hotmail.com)\n- Added support for Simplified Chinese language in the monthly reports.\n\t(thanks to Christopher Meng, rpm AT cicku.me)\n- Added support for the ATI graph cards through the 'gpu' keys in the 'lmsens'\n  graph. As in the NVIDIA case, it requires the ATI official drivers. [#8]\n- Changed the default charset in the built-in HTTP server to UTF-8.\n\t(thanks to Akong, ak6783 AT gmail.com for pointing this out)\n- Added verbosity to the 'undefined configuration' of MySQL graph.\n- Fixed a typo in an iptables rule in the Nginx graph.\n\t(thanks to Faustin Lammler, faustin AT dejadejoder.com)\n- Fixed the Squid graph in order to honour the 'netstat_in_bps' option.\n\t(suggested to Ignacio Freyre, nachofw AT adinet.com.uy)\n- Fixed in 'port' graph to show the minimum number of graphs between the value\n  of 'max' and the number of ports really defined. This fixes the error messages\n  of uninitialized values in lines 410 and 411.\n- Fixed to honour the support of RAID controller parameters in the disk device\n  names defined in the disk graph. [#12]\n- Small fixes in the alerting system of 'fs', 'system' and 'mail' graphs.\n- Fixed a bug in 'traffacct' graph that prevented accounting traffic if the\n  <desc> option was empty. Also, Socket module has been added.\n- Fixed to get the correct graph of the right group number in the 'fs' graph\n  when using 'silent=imagetag' option. [#16]\n\n\n3.1.0  - 15-Mar-2013\n====================\n- Added a complete statistical FTP graph.\n- The 'serv' graph now uses 'secure_log' log file to get FTP login statistics.\n  Alternatively the 'ftp_log_date_format' option has been renamed to\n  'secure_log_date_format'.\n- Fixed in 'nginx' and 'port' graphs to properly use '-m conntrack --ctstate'\n  instead of '-m state --state' in all iptables rules and avoid an annoying\n  iptables message about using an obsolete option.\n- Fixed to delimit the values in 'disk->list->[n]' by \", \" (comma + space).\n- Fixed to detect if a device name defined in 'disk->list->[n]' does really\n  exist in the system.\n- Fixed a missing initialization of some data arrays in 'lmsens' which generated\n  the message \"ERROR: while updating /var/lib/monitorix/lmsens.rrd: expected 52\n  data source readings (got 10) from N\" if the 'sensors' command is missing.\n- Fixed in 'lmsens' to better handle the returned value (an error) when the\n  'nvidia-smi' command is not installed in the system.\n- Fixed a bad temperature values extraction from the 'sensors' command in the\n  'lmsens' graph.\n\t(thanks to C\u00e9dric Girard for pointing this out)\n- Fixed in 'nginx' to avoid the use of uninitialized values and to show an error\n  message when Monitorix is unable to connect to the Nginx server.\n- Fixed in 'apache' to show an error message when Monitorix is unable to\n  connect to the Apache server.\n- Fixed in 'lighttpd' to show an error message when Monitorix is unable to\n  connect to the Lighttpd server.\n- Fixed in 'icecast' to show an error message when Monitorix is unable to\n  connect to the Icecast server.\n- Fixed in 'traffact' to show an error message when Monitorix is unable to\n  connect to the HTTP server.\n- Fixed to make sure to kill the built-in HTTP server if Monitorix exits\n  unexpectedly.\n- Fixed messages of type 'Use of uninitialized value ...' in 'system', 'kern'\n  and 'fs' graphs on FreeBSD systems.\n- Fixed to extract correctly the minor number of kernel version on FreeBSD\n  systems.\n- Fixed a bug in 'user' graph that prevented counting correctly the number of\n  users currently logged in FreeBSD systems.\n- Fixed a bug in how data was collected using 'ipfw' that affected the 'port'\n  graph which was showing more activity than real.\n\n\n3.0.0  - 18-Feb-2013\n====================\n- Added an HTTP built-in server.\n- Changed the path 'cgi-bin' to 'cgi'.\n- Fixed color sequence in the 'fs' graph. \n- Fixed a division by zero in 'mysql' graph.\n- Fixed excessive bottom padding in 'fs' graph.\n- Fixed to use always the same colors for '/', 'swap' and '/boot' values in 'fs'\n  graph.\n- Fixed a bad naming in the title of 'traffacct' graph.\n- Fixed all URLs of the .png files.\n\n\n3.0.0B2- 01-Feb-2013\n====================\n- Lot of improvements in the MySQL graph, which includes adding a new value\n  called 'Query_Cache_Hit_Rate\", the number of select querys also includes\n  the value of Qcache_hits, new query type called Com_stmt_execute and the new\n  value Temp_tables_to_disk.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Added a systemd service file template.\n\t(thanks to graysky, graysky AT archlinux.us)\n- Alerts have been reimplemented and they are now configured independently for\n  each graph.\n- Added two new alerts in the 'mail' graph: one to control the number of\n  delivered messages per minute and the other for the number of messages in the\n  mail queue.\n- Added the ability to also support outgoing connections in the 'port' graph.\n- Fixed a pair of typos in the section explaining 'hptemp' in the man page\n  monitorix.conf.5.\n- Fixed from using unitialized variables in 'fs'.\n- Fixed a bad assigning in 'mail' that prevented from seeing the greylisting\n  values in the graph.\n- Fixed a bug in CGI the prevented honoring the 'hostname' configuration option.\n\t(thanks to graysky, graysky AT archlinux.us)\n- Fixed in 'mysql' to use \"show global status' in all operations instead of\n  \"show status\" since the latter only refers to the current thread.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Fixed to add Qcache_hits value to Com_select in order to get the real value\n  (assuming that query caching is on).\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n\n\n3.0.0B1- 11-Jan-2013\n====================\n- Complete rewrite.\n- Added a new option in 'port' to define the number of graphs per row.\n- Added two new options 'ftp_log' and 'ftp_log_date_format' to be able to\n  read FTP connections from its own log file.\n\t(suggested by Luca Ferrario, luca AT ferrario.net)\n- Fixed a missing description in the first entry of each network interface in\n  the options list.\n- Fixed a missing argument on each *_init() function preventing show an \"Ok\"\n  message when debugging is enabled.\n- Fixed some bugs in Groups.\n- Fixed a typo in the percentage variable in FS alert.\n- Fixed variables naming in 'mail' graph when using Postfix MTA that prevented\n  to see the values bounced, discarded and forwarded.\n- Fixed a number of small bugs.\n- Fixed a bad naming of the bitrate variables when creating the Bitrate graph\n  of the Icecast Streaming Media Server.\n- Fixed to include the username and password when connecting to MySQL using a\n  socket.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n\nChanges introduced to 2.6.0 version:\n- Introduced some modifications to the device name detection for FreeBSD.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Improved support of Linux NFSv4 spliting the operation names in two different\n  arrays (client and server).\n- Fixed a typo in 'monitorix.cgi' that prevented honoring the NFSC_VERSION\n  option.\n- Fixed an intermix usage of alarm() and sleep() substituting it by alarm() and\n  pause().\n- Fixed a bug in multihost introduced by the groups code.\n\n\n2.6.0  - 19-Sep-2012\n====================\n- Added a complete statistical BIND graph.\n- Added support for NetBSD systems.\n- Added support for grouping remote servers in the Multihost view.\n\t(thanks to Hartmut W\u00f6hrle, hartmut AT hartmut-woehrle.ch)\n- The Disk and Filesystems Usage and I/O Activity graphs have been completely\n  rewriten.\n\t(suggested by Konstantinos Skarlatos, k.skarlatos AT gmail.com)\n- Added support to monitor unlimited number of disk drives.\n- Added support to monitor unlimited number of filesystems.\n- Reorganized the legend in the Disk drive temperatures and health graph.\n- Changed the shebang to be more portable among different systems.\n- Completely rewritten the Debian/Ubuntu init script.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Minor changes in the header of the Debian/Ubuntu init script.\n\t(thanks to Uwe Heidrich, uweheidrich AT hotmail.com)\n- Expanded to 15 characters the description in network ports.\n- Changed to lines a bit thicker some graphs with few values.\n- Added a new feature to enable/disable the use of javascript:void function when\n  clicking on a zoomable graph.\n\t(thanks to Florian E.J. Fruth, fejf AT gmx.de)\n- Fixed a bug that mixed the collected values when monitoring multiple MySQL\n  servers.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Fixed a bad percentage calculation in the dentries and inodes values.\n- Removed useless code when collecting Squid stats.\n- Fixed a typo in a MySQL graph.\n\n\n2.5.2  - 21-May-2012\n====================\n- Modified iptables/ipfw accounting rules handling and fixed some bugs.\n- Added to backup .rrd files every time it changes their internal structure.\n\t(suggested by Michael Mansour, mmansour AT ostech.com.au)\n- Fixed a bug that prevented the creation of the 'mysql.rrd' file. The error\n  message was \"ERROR: while creating /var/lib/monitorix/mysql.rrd: you must\n  define at least one Data Source\".\n\t(thanks to Darryl Yeoh Gim Hong, drl AT bsd.my for pointing this out)\n- Fixed to avoid modifying read-only values in chomp() function.\n\t(thanks to Julio Cifuentes, jcifuentes AT mail.com for pointing this out)\n\n\n2.5.1  - 23-Apr-2012\n====================\n- Modified the regexp in 'mgr:ipcache' listing to support newer Squid versions.\n- Changed some information and debug messages to be more verbose and clear.\n- Force termination with exit(0) when receiving a SIGINT.\n- Added support to use the socket file for the connection to the MySQL server.\n\t(suggested by Darryl Yeoh Gim Hong, drl AT bsd.my)\n- Added the new option IMAP_DATE_LOG_FORMAT to match with the Dovecot date log\n  format.\n- Refreshed the COPYING file to reflect the current contents of the GPLv2 at\n  http://www.gnu.org/licenses/gpl-2.0.txt.\n- Complete English correction in the monitorix.conf(5) man page.\n\t(thanks to Paul Rupp, paulrupp AT acorp.net)\n- Fixed a bug that prevented monitoring multiple MySQL servers.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Fixed the vertical label of network traffic in Mail graph to honour the\n  NETSTATS_IN_BPS option.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Fixed a bug that prevented collecting IMAP data from wu-imap server.\n- Fixed padding on big values in the Nginx stats.\n\n\n2.5.0  - 21-Mar-2012\n====================\n- Added a complete statistical Fail2ban graph.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added a complete statistical Lighttpd graph.\n- Added full support for the Postfix MTA in the Mail statistics graph.\n- Extended the number of information in the Mail statistics graph.\n- Added support to monitor unlimited number of local or remote Apache servers.\n- Added support to monitor unlimited number of local or remote MySQL servers.\n- Added support for Dovecot 2.0 log format.\n- Optimized a lot of code including more regular expressions. \n- Replaced hardcoded graph titles with the strings in the configuration file.\n- Modified the RedHat init script to let Monitorix create itself the pidfile.\n  This should improve the support on modern Linux systems using 'systemd'.\n\t(thanks to a IRC user called 'dashbad' for pointing this out)\n- Improved the init script to be more LSB-compliant.\n- Changed to the '-A' parameter in 'smartctl' to avoid waking up disks when\n  collecting their temperatures and health values.\n\t(thanks to Michael Perry, mike AT serensilver.co.uk)\n- Fixed some titles in the list box of the main page.\n- Fixed color overriding in the IMAP and POP3 services graph.\n- Fixed the title in some graphs.\n- Fixed a typo in the debug array name that prevented individual debug working\n  properly.\n- Fixed a typo in the configuration file.\n\t(thanks to a IRC user called 'gangsterlicious' for pointing this out)\n- Fixed a bug in the Squid graph that prevented of being counted the Aborted\n  clients.\n- Fixed numbering in some graphs.\n\n\n2.4.1  - 09-Jan-2012\n====================\n- Added support for Dovecot 1.2 log format.\n- Added Polish language support in the monthly traffic report.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Added 'hour' timeframe in 'monitorix.cgi' to accept unsupported queries not\n  comming from the main page.\n- Added support for fail2ban bans in the System Services Demand graph.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added support for CommuniGate mail server logs in the System Services Demand\n  graph.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added the ability to show more debug information introducing extra values to\n  the -d parameter. The monitorix(8) manpage has been updated to reflect these\n  changes.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added the sensor real names in the Voltages graph.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Removed duplicated newline character in logger() calls.\n- Added disabling automatic page reloading when $REFRESH_RATE is 0.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added a new option in configuration file to change the favicon image.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added support for SpamAssassin and Clamav logs to catch email-spam and\n  email-virus.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Grouped all the mail related services to the small graphs in the System\n  Services Demand graph. This only implied changing the IMAP position.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Fixed the main interrupt graph in order to avoid running out of colors on\n  systems with lot of interrupts.\n- Fixed to honour the limit of 15 characters of the mountpoint names in the\n  Icecast graph.\n- Fixed the column layout of the text mode in the LM-Sensors graph.\n- Fixed to set standard locale LC_TYPE,\"C\".\n\n\n2.4.0  - 28-Nov-2011\n====================\n- Added a complete statistical Squid Proxy Web Cache graph.\n\t(suggested by Michael Mansour, mmansour AT ostech.com.au)\n- Added a complete statistical NTP multigraph.\n- Added a complete statistical Icecast Streaming Media Server multigraph.\n\t(suggested by Kamil Weiser, crx AT lordcyber.net)\n- Error messages now use the internal logger() function so all these messages\n  will have the date and time prefixed.\n- Added support for network port monitoring on FreeBSD and OpenBSD systems.\n- Added support for Nginx network traffic monitoring on FreeBSD and OpenBSD\n  systems.\n- Added the number of instances (1) in the specified time key (day, week, month\n  or year). This also introduces some changes in the name of the .png files and\n  will break backwards compatibility with old (2.3-) Monitorix with Multihost\n  feature enabled.\n- Removed some inadequate calls to 'die' taking proper actions on each case.\n- Introduced small optimizations.\n- Removed the '--lower-limit=0' in the Voltages graph that prevented seeing\n  negatives values.\n- Fixed some typos in the variable name $PNG_DIR in 'monitorix.cgi'.\n- Fixed to avoid a 'divide by zero' message on certain NVIDIA driver version.\n\n\n2.3.0  - 05-Sep-2011\n====================\n- Added a complete statistical NFS (v2, v3 and v4) server graph.\n- Added a complete statistical NFS (v2, v3 and v4) client graph.\n- Improved support for newer NVIDIA drivers and fixed some bugs.\n- Added the 'condrestart' option in the RedHat init script.\n\t(suggested by Yury V. Zaytsev, yury AT shurup.com)\n- Added a new option in the configuration file to toggle all network values\n  between bits and bytes per second.\n- Some cosmetic changes.\n- Fixed to sanitize a trailing space in the '/proc/stat' file that prevented to\n  show values in the disk I/O graphs on certain systems with Linux kernel 2.4.\n\t(thanks to Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Fixed the Connections_usage value in the MySQL graph avoiding to be greater\n  than 100%.\n- Fixed to avoid showing the device interrupts called 'Dynamic-irq'.\n\t(thanks to Michael Mansour, mmansour AT ostech.com.au)\n- Fixed to avoid showing the additional parameter in disk drives.\n\t(thanks to Michael Mansour, mmansour AT ostech.com.au)\n- Fixed to add more colors in order to support more interrupt devices.\n\t(thanks to Dan Criel, dancriel AT gmail.com)\n- Fixed a bad calculation of network traffic in 'text' interface of Ports graph.\n- Fixed an extra 'optgroup' close tag in 'index.html' for each graph disabled.\n\n\n2.2.0  - 21-Jun-2011\n====================\n- Added support for OpenBSD systems.\n\t(thanks to Devio.us team)\n- Added a complete statistical MySQL graph.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- (missed in previous version) Prefixed with full path the 'sysctl' command to\n  retrieve the boot time. This is specially needed when using the lighttpd web\n  server on FreeBSD systems.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Added the Fork rate (new processes started per second) in the Context Switches\n  graph. It includes two new values: the number of forks and vforks, being the\n  later only for FreeBSD and OpenBSD systems.\n- Added support for the new NVIDIA driver 270.41.03.\n- Added support for the names 'BusyServers' and 'IdleServers' given by Apache\n  when ExtendedStatus is disabled.\n- Added support to show the interrupt names on Xen guest systems.\n- Added to force a standard locale to avoid problems with decimal point/comma.\n\t(thanks to Vadim Beljaev, anon333 AT mail.com)\n- Workarounded the well-known problem with SIG{CHLD} and system() function that\n  returns -1 on *BSD systems.\n- Included a Debian init script.\n\t(thanks to J\u00f6rg Alpers, JAlpers AT gmx.net)\n- Fixed the LINE2 of VFS graph and the swap device in FS graph.\n- Fixed a bug when counting total of users on systems with large number of users\n  logged in.\n- Fixed a bug in 'monitorix.spec' that prevented a correct installation on\n  systems with no 'apache' user defined, and added cosmetic changes.\n- Fixed to show only the graphs of the PC LAN defined in @PC_LIST even when\n  $PC_MAX is greater.\n- Fixed a bug that could remove some Network Port 'iptables' rules under \n  certain circumstances.\n- Fixed a bug that prevented to put in the email of monthly reports the listing\n  with the daily usage of all the hosts.\n- Fixed a missing import of the 'File::Basename' module.\n- Fixed some typos in the man pages and aligned texts in some graphs.\n\n\n2.1.2  - 04-May-2011\n====================\n- Added a new command line parameter to save the PID into the specified file\n  in order to make life easier to 'rc' scripts.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Prefixed with full path the 'sysctl' command to retrieve the boot time. This\n  is specially needed when using the lighttpd web server on FreeBSD systems.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Added to change to the / directory before parsing the command line parameters,\n  and after that, a change to a safety directory, either /tmp or /lost+found.\n- Improved the code that detects the physical device name where the / filesystem\n  resides.\n- Changed the way how are handled the command line options.\n- Removed the 'Tahoma' font name from all 'font face' HTML tags.\n- Hidden the unused values in the 'LM-Sensors and GPU temperatures' graphs.\n- Fixed to remove correctly the 'iptables' rules when some defined port has been\n  removed from the configuration file.\n- Fixed to show only the graphs of the ports defined in @PORT_LIST even when\n  $PORT_MAX is greater.\n- Fixed a missing variable initialization that generated an 'illegal division by\n  zero' message if the filesystem defined does not existed, and the system\n  didn't had a valid swap device.\n\t(thanks to Mowd, mowd8574 AT gmail.com)\n- Fixed to show the PID number even when started as a foreground process.\n- Fixed the padding of the Voltages values.\n- Fixed a bug that prevented to gather correctly the disk I/O values of the /\n  filesystem on Linux systems with kernel 2.4.\n\n\n2.1.1  - 12-Apr-2011\n====================\n- Reflect the SIGHUP reception with a message also in the new reopened log file.\n- Added support for the new 'Idrop' column in the output of 'netstat' command\n  appeared in FreeBSD 8.0 and newer versions.\n\t(thanks to Sean, strumming AT thestrings.com)\n- Fixed an illegal division by zero message if the swap device is not used at\n  all, which caused to not collect any data and, at the same time, prevented to\n  see any results in the Filesystems usage and I/O activity graphs.\n\t(thanks to Daniel Constantinov, daniel AT k9tecnologia.com.br)\n- Fixed to not show a broken graph if there is no data defined in any of the\n  three possible arrays of the HP Temperatures graphs.\n- Fixed to rename the files in the $USAGE_DIR directory once they are already\n  sent in the monthly reports.\n- Fixed to create correctly the iptables rules for PC LAN traffic accounting.\n\t(thanks to Daniel Constantinov, daniel AT k9tecnologia.com.br)\n\n\n2.1.0  - 09-Mar-2011\n====================\n- Completed the monthly traffic reports for PCs.\n- Added a better signal handling.\n- Added the SIGHUP signal handler in order to close and open a new log file.\n- Modified the monitorix(8) manpage to reflect that new feature.\n- Darkened the grey color of the CUPS usage in the Network Services graphs.\n- Fixed annoying messages in log file when PC_MAX is actually greater than the\n  number of entries in PC_LIST or PC_IP:\n\n*** DNS problem with: \n*** pc_update(): Usage: Socket::inet_ntoa(ip_address_sv) at /usr/bin/monitorix line 3548.\n\n- Fixed to show only the entries defined in PC_LIST even when PC_MAX has a\n  greater value.\n- Fixed to correctly handle the SIGCHLD signal to prevent an accumulation of\n  defunct or \"zombie\" processes in old Perl versions.\n- Fixed a regexp in 'fs.rrd' that prevented monitoring non-local filesystems.\n- Fixed a typo in monitorix(8) man page when referencing the monitorix.conf(5)\n  man page.\n- Fixed in 'monitorix.cgi' to accept the 'silent' option in PCs graphs.\n- Fixed to LINE2 type the lines plotted in the Greylisting zoomed graph.\n\n\n2.0.0  - 01-Feb-2011\n====================\nThis new version is a complete rewrite, including new features and graphs,\ncleaned up all the code, updated and enhanced a number of aspects in some\ngraphs, and fixed a lot of bugs. The most important change is that it no longer\nrequires 'crond' to work, instead Monitorix is now a complete standalone Perl\ndaemon being started and stopped like any other system service.\n\nPlease read the 'News' and 'Features' sections in the Monitorix web site to\ngive you an idea of all the changes and new features that include.\n\nI want to give a huge thanks to the people that has contributed testing and\nreporting bugs during its beta phase.\n\n\n1.5.2  - 18-Nov-2010\n====================\n- Added an new alert based on the usage of the root filesystem. It follows\n  the same logic than the CPU alert, so the alert script is practically the\n  same.\n\t(thanks to Ramchander, ramchan10 AT gmail.com)\n- Modified the man page of the configuration file to reflect the new alert\n  capability.\n- Added a protection mechanism when collecting the filesystem disk usage. It\n  prevents possible timeout scenarios on those filesystems mounted using NFS.\n\t(thanks to Ramchander, ramchan10 AT gmail.com)\n- Fixed to remove the netmask suffix when collecting the network traffic if\n  the IP belongs to a hostname instead of a network.\n\t(anonymous contribution)\n\n\n1.5.1  - 23-Jun-2010\n====================\n- Changed the default $ENABLE_MAIL option to 'N'.\n- Added a second decimal in the Mail statistics graph in order to have more\n  accurated values.\n- Added a missing \"--lower-limit=0\" to all graphs (except MTA stats).\n- Changed the default value of rigid (RIGID = 2) to 0 in all network port graphs.\n- Included a number of necessary adjustments in the install.sh script to adapt\n  it better to the FreeBSD installation process.\n\t(thanks to Michael Brune, admin AT mjbrune.org)\n- Added the description of the @NET_RIGID and @NET_LIMIT arrays in the man page\n  monitorix.conf(5).\n- Fixed some bugs and a bad code design in the Interrupts graph that prevented\n  showing correctly the graph on systems with some interrupts numbers greater\n  than 256.\n\t(thanks to Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Fixed the Memory graph to display correctly the value in MB. This bug affected\n  only the FreeBSD systems.\n- Fixed to be able to enable only the LAN devices monitoring without having to have\n  enabled the network ports monitoring.\n\t(thanks to Niklas Janzon, niklas.janzon AT gmail.com)\n- Fixed the iptables rules section in order to avoid its execution on FreeBSD\n  systems.\n- Fixed a bug in the init script that prevented executing it during the system\n  shutdown on RedHat/Fedora/CentOS systems. The path of the lock file has\n  changed from /var/lock/ to /var/lock/subsys.\n\n\n1.5.0  - 06-Apr-2010\n====================\n- Added a new graph to show complete MTA (Sendmail) statistics.\n- Added support for those lines in the 'sensors' command output that include\n  a newline character and have the result in the next line.\n\t(thanks to Balazs Denes, dnsdns AT gmail.com)\n- Reused a lot of temporal variables in the CGI file.\n- Fixed to not show error messages on certain virtual servers if the file\n  '/proc/diskstats' does not exist.\n\t(thanks to an anonymous IRC user called 'gangsterlicious')\n- Fixed the rigid control in the 3rd graph of the Nginx statistics.\n- Fixed the colors scheme in the main page when using the 'white' theme.\n\n\n1.4.2  - 10-Feb-2010\n====================\n- Removed the width=1 from the top table in the graphs page.\n- Changed to grey the color of all links.\n- Added automatic detection of total amount of memory in the system.\n- Modified the install.sh script in order to remove the already supported\n  distribution Gentoo and to include some warnings saying that the script is\n  not the recommended method of installing Monitorix.\n- Added a new $OSTYPE key called \"Linux-Arch\" to include support for Arch Linux\n  distribution.\n\t(thanks to graysky, da_audiophile AT yahoo.com)\n- Fixed the URL of the images if is being called through a secure web server.\n\t(thanks to an anonymous IRC user called 'dobermai')\n- Fixed those no named interrupts that generated the annoying message\n  \"substr outside of string at /var/www/cgi-bin/monitorix.cgi line 4775,\n  <INTERRUPTS> line n.\" in the Apache error log.\n\t(thanks to Mac, redleader25 AT hotmail.com)\n\n\n1.4.1  - 04-Jan-2010\n====================\n- Updated the monitorix.spec and monitorix.conf files for SuSE Linux packages.\n\t(thanks to Oliver Kaltenecker, oliver.kaltenecker AT wittwer.de)\n- Modified the wide of the mount point column in the disk usage graph in order\n  to fit longer pathnames.\n- Substituted the pair of bottom logos (black and white) for a new one with\n  background transparency.\n- Changed the initial logo image by a new one with background transparency and\n  removed the slogan which reduced its size.\n- Removed the configuration option $IDATE.\n- Removed the envelope image as with the new mailing list it doesn't make sense\n  to be there anymore.\n- Fixed to honour the color theme even in the main page and simplified its\n  layout.\n- Fixed some annoying error messages in the web server logs about the use of\n  an uninitialized value in 4781 line.\n\t(thanks to Edgar Barranco, ebarranco AT gmail.com)\n- Fixed a bug in how are collected the hardware temperatures in HP ProLiant\n  ML310 and ML350 models.\n\t(thanks to Rene Kapeller, rene.kapeller AT psi.ch)\n- Fixed an overflow in the CPU array in systems with more than 8 processors,\n  that prevented seeing the rest of graphs.\n  \t(thanks to Robin Friedrich, Robin.Friedrich AT itt.com)\n\n\n1.4.0  - 05-Oct-2009\n====================\n- Optimized the iptables command used to collect Chain statistics.\n- Added the ability to show the results in plain text instead of using rendered\n  graphs. This will make life easier either for people with vision impairments\n  and for automatic processing of the information.\n\t(thanks to Christoph Doeren, cd AT yuyumo.de)\n- Added an alert system based on the last 15 minutes of the CPU load average.\n\t(suggested by Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Fixed a bug in monitorix.cgi that messed up the way how are displayed the\n  individual processors' graphs.\n\n\n1.3.2  - 01-Sep-2009\n====================\n- Improved a lot the support for FreeBSD systems.\n\t(thanks to Pavlin Vatev, anex AT smrad.net)\n- Added support for Enterprise Volume Management System (EVMS) to show the\n  I/O disk activity of the root filesystem.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Added a new option in monitorix.conf called %MAIL_LOG with the paths for the\n  mail log file of each Operating System. This removes the old path hard coded.\n- Changed the \"use\" line of the LWP::UserAgent module, now is only loaded if\n  Nginx statistics are enabled. This creates less dependences for all people\n  that don't need the Nginx statistics.\n- Optimized the accounting process of SSH connections using the same code for\n  Linux and for FreeBSD. Linux SSH connections using public keys are also\n  counted now.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Rewritten the Monitorix init script for Gentoo Linux.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Added a zero pading in the name of the proc.png files.\n- Fixed to show 0% of usage if a filesystem defined in MNT_LIST has been\n  umounted, instead of returning the same disk usage of its parent filesystem.\n- Fixed the %HTTP_LOG path in the monitorix.conf file for Linux-Gentoo.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Fixed the missing monitorixico.png file in the install script.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Fixed to not create the network ports counters if $ENABLE_PORT is \"N\".\n\n\n1.3.1  - 05-Jul-2009\n====================\n- Fixed a location problem for the logo files on a fresh installation using the\n  Linux-Debian option.\n- Fixed a critical permission problem during a fresh installation (using the\n  Linux-Debian option) that prevented seeing all the graphs.\n  \t(thanks to Rubla Georgian, deletet.file AT yahoo.com)\n- Fixed some annoying error messages in the web server log when the $PORTnn and\n  $PORTnn_NAME aren't correctly defined in /etc/monitorix.conf.\n  \t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Removed the un_install.sh script.\n\n\n1.3.0  - 14-Jul-2009\n====================\n- Added the monitorix.conf(5) man page to be the main place to get help.\n- Added support for the Nginx web server statistics.\n  \t(thanks to Aleksandr Miroshnychenko, al.miroshnychenko AT gmail.com)\n- Removed the unused $EMAIL option. The $PC_DEFMAIL option is the one used when\n  sending the monthly reports.\n- Removed the $PC_MAX option as its value is now hard coded.\n- Reorganized a bit the monitorix.conf file and cleared the syntax.\n- Improved the install.sh script with the 'install' command instead of using\n  'mkdir', 'cp' and friends.\n- Fixed some missing HTML closing tags.\n- Fixed to match the default value of $ENABLE_LMTEMP in monitorix.pl.\n- Fixed a bad counting of the number of current Samba shares when there wasn't\n  any share on the list.\n  \t(thanks to Luca Ferrario, luca AT ferrario.net)\n\n\n1.2.4  - 06-Apr-2009\n====================\n- Isolated a Linux dependant code that prevented running Monitorix correctly\n  on FreeBSD systems.\n- Included support to recognize correctly the temperatures and RPM values when\n  in some weird cases, the FAN and CPU labels (in the lm_sensors output) share\n  the same name.\n  \t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Fixed a duplication in the Monitorix iptables rules during a restart.\n- Added support for systems with device interrupt numbers greater than 255.\n- Added support for openSuSE/SLES Linux distribution.\n\t(thanks to Alessandro Soraruf, soraruf AT ntd.homelinux.org)\n\n\n1.2.3  - 14-Jan-2009\n====================\n- Fixed the way how Monitorix creates the iptables rules. Now it uses the\n  parameter -I instead the -A in order to insert those rules in the top of\n  each chain so the data get recorded.\n  \t(thanks to Andrei Ioachim, andrei AT inteligis.com)\n- Added support for the Postfix MTA in the SMTP counter of the Network Services\n  Demand graph.\n  \t(thanks to Andrei Ioachim, andrei AT inteligis.com)\n- Fixed a typo in the declaration of $HTDOCS in the install.sh that only\n  affected to Gentoo installations.\n\t(thanks to Carlos Perez, cpa.admin AT gmail.com)\n- Removed the dependence of the 'lockfile' command in the init-script.\n\t(suggested by Carlos Perez, cpa.admin AT gmail.com)\n- Fixed to detect and show better the interrupt names.\n- Added a minimal support for interrupt numbers bigger than 255. This minimal\n  support will let you see the names of those interrupts that have those big\n  numbers but their activity will rest still void.\n\t(thanks to Brian Lopeman, brian.lopeman AT ctrh.org)\n- Fixed a missing '127.0.0.1' in the URL of the graph images when\n  'monitorix.cgi' is called from the command line.\n  \t(thanks to David Tiberio, dave AT cheapbooks.com)\n\n\n1.2.2  - 20-Nov-2008\n====================\n- Fixed a missing '/' when removing /var/www/monitorix in the un_install.sh\n  script.\n\t(thanks to Tamas Marki, tamas AT gnsdm.com)\n- Fixed to really accept more than three network devices. There were some parts\n  that were not correctly upgraded to five.\n        (thanks to Milos Prudek, prudek AT bvx.cz)\n- Added the parameter -w during the hddtemp call just to make sure that it will\n  awaken the disk (if needed).\n- Removed the .sh extension and the she-bang in the crond script for all Linux\n  distributions, although only in the Debian based ones people experienced\n  problems.\n- Added a new configuration option to disable the crond mail related to\n  Monitorix errors.\n\t(suggested by Detlef Neubauer, detlef.neubauer AT wzrz.de)\n- Fixed to include the \"Linux-Generic\" as a supported OSTYPE.\n- Fixed to include the monthly report files for the Italian language in the RPM\n  package.\n- Removed the htmlentity of the ampersand character introduced in the previous\n  version, as the last RRDtool version seems not complaining anymore.\n- Improved the way how the root filesystem device is detected including support\n  for the partitions with two digits like /dev/sda10.\n\t(suggested by Dimitri Yioulos, dyioulos AT firstbhph.com)\n\n\n1.2.1  - 01-Oct-2008\n====================\n- Added support for the new RRDtool 1.3 version.\n- Fixed the alignment of the MB & CPU temperatures graph legend.\n- Forced the font type to 'Mono' for the RRDtool 1.3 version.\n- Fixed one identifier to count better the total messages sent/received in\n  /var/log/maillog.\n- Added support for some virtualized systems where the rootfs device name does\n  not appears in /proc/diskstats and the only way to collect the i/o values is\n  using the partition device name.\n\t(thanks to Travis Wu, twu AT capitalsystems.com)\n- Added support for Linux software RAID devices of the form /dev/md/*.\n\t(thanks to an anonymous IRC user called 'emilio')\n- Added Italian language support in the monthly traffic report.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Fixed the ampersand character to be an entity to avoid complaining messages\n  of Pango in the RRDtool 1.3 version.\n- Included the \"Linux-Generic\" OSTYPE key that for a strange reason it was\n  missing.\n- Fixed in the cover web page to only include the graphs that the system can\n  really offer. That will avoid to see more ethernets graphs than the number\n  of real ethernet devices and the same for the number of processors.\n\n\n1.2.0  - 02-Apr-2008\n====================\n- Added support for systems based on LVM structure on top of a CCISS RAID of\n  disk drives.\n\t(thanks to Bob McClure, Jr., bob AT bobcatos.com)\n- Removed the full path of the 'pvs' command as it complicates the portability\n  of Monitorix to other Linux distributions.\n\t(thanks to Eric, teknologist AT gmail.com)\n- Added the \"no warnings\" pragma to temporarily block warnings while calling\n  the 'sensors' command.\n- Fixed a bug introduced in the last version that prevented to see the interrupt\n  names on systems with 2.4 Linux kernels.\n- Fixed the graph of disk temperatures in order to preserve the page layout\n  when there's no defined any disk device in the HDDTEMP_LIST array.\n\t(thanks to Eric, teknologist AT gmail.com)\n- Fixed to tolerate if @HDDTEMP_LIST was badly defined with just a void entry\n  instead of no entries at all. That's if someone defined incorrectly the array\n  as @HDDTEMP_LIST = \"\"; instead of simply as @HDDTEMP_LIST;\n\t(thanks to Eric, teknologist AT gmail.com)\n- Removed the error messages when it has been defined in /etc/monitorix.conf a\n  network interface that it doesn't exist in the system.\n- Fixed the error message \"Use of uninitialized value in string eq at\n  /var/www/cgi-bin/monitorix.cgi line 454.\" that appeared in the Apache error\n  logs when using Multihost feature.\n\n\n1.1.2  - 25-Feb-2008\n====================\n- Added the execution of the \"pvs -a\" command each time Monitorix is restarted,\n  just to make sure to remove a strange message about \"Medium not found\"\n  appeared on fresh CentOS 5 installations using LVM.\n- Converted automatically into a link the URL that appears in the bottom of\n  each graph (if enabled by $MULTIHOST_FOOTER) in the Multihost mode.\n- Fixed to put the zero character instead of NULL when there's no value, in the\n  monthly file of traffic during the daily collecting of counters.\n- Fixed a bug in the interrupt names that removed its first character affecting\n  only (mostly old) machines with \"local-APIC-edge\" support.\n\n\n1.1.1  - 16-Nov-2007\n====================\n- Fixed a stupid bug that prevented showing the graphs of network ports.\n\n\n1.1.0  - 15-Nov-2007\n====================\n- Added support for Gentoo Linux distribution.\n\t(thanks to Matej Povazaj, ybdaba AT gmail.com)\n- Added support for Slackware Linux distribution.\n\t(thanks to Bogdan Radulescu, from http://nimblex.net>\n- Changed the way how is the data collected in the Kernel Usage graph. From now\n  on, this graph will show its data in a more accurated way than before. People\n  can continue using the Real and Stacked modes though.\n\t(thanks to Christian Meusel, christian.meusel AT inf.tu-dresden.de)\n- Definitely fixed (I really hope so) a persistent bug during the numeric\n  extraction of the alpha numeric string of the lm_sensors temperatures.\n- Fixed support for HP ML310 ProLiant server in the motherboard temperatures\n  graph.\n- Changed the main page form method from POST to GET in order to be able to\n  remove the old /cgi-bin/monitorix.cgi and call localhost.cgi directly.\n  So now on, the localhost.cgi is renamed as monitorix.cgi and it's placed in\n  the same place where it was the old one, removing the /cgi-bin/monitorix\n  directory as it will not longer be used.\n- Fixed to show the graph when using multihost feature and select only the\n  Context Switches graph.\n- Improved how are showed the images when using multihost feature selecting\n  only individual hosts. Now they are bigger.\n\n\n1.0.1  - 03-Oct-2007\n====================\n- Fixed some annoying messages like \"Argument \"+46M-BM-0C\" isn't numeric in int \n  at /usr/bin/monitorix.pl line > 2710, <SENSORS> line 13.\". Now it extracts\n  correctly numbers from an alpha numeric string.\n\t(thanks to Russell Morris, rmorris AT rkmorris.us)\n- Changed from area-based to line-based the HP IPL temperature graphs in order\n  to follow the same aspect than the new LM-Sensors graph.\n- Added a permanent \"lower-limit=0\" in the following graphs: Context Switches,\n  LM-Sensors, Network Packet Traffic and Network Error Traffic.\n- Fixed the alignment of the legend in the FAN speeds graph on systems still\n  using the old RRDtool branch version 1.0.\n\n\n1.0.0  - 04-Sep-2007\n====================\n- Added a new graph to see the temperatures of the system motherboard, CPUs,\n  fan speeds and hard disk drives using lm_sensors and the hddtemp tool. Such\n  graph is disabled by default since there are still a lot of motherboards with\n  unsupported sensors out there. This new graph can be combined with the HP\n  specific temperatures graph.\n- Fixed some adjustments in the temperatures collector in newer HP ProLiant\n  servers with newer IML.\n- Added the ability to select the percentages layout in the Kernel Usage\n  statistics. The possible options are (R)eal or (S)tacked.\n\t(suggested by Andrzej Pokrywko, Andrzej.Pokrywko AT onet.pl)\n- Fixed a bug that prevented to display correctly the interrupt names on newer\n  systems that use PCI-MSI instead of IO-APIC.\n- Added the ability to change the refresh rate value in the statistics web\n  page. The default value remains unchanged to 150 seconds.\n- Added some adjustments in the Monitorix init script.\n- Extended the environment variable PATH to cover more root directories.\n- Changed the default NET_RIGID from 2 to 0.\n- Changed the default network configuration from two interfaces to only one, as\n  it seems the most of people have only one network interface installed.\n- Removed some \"Use of uninitialized value ...\" annoying messages in the Apache\n  error_log.\n\n\n0.9.2  - 12-Jun-2007\n====================\n- Special Debian contribution.\n  + Added support for Debian distribution.\n  + Added the missing \"monitorixico.png\" file during the install process using\n    the install.sh shell-script.\n\t(thanks to Uwe Heidrich, uweheidrich AT hotmail.com)\n- Added German language support in the monthly report.\n\t(thanks to Uwe Heidrich, uweheidrich AT hotmail.com)\n- Added support for systems using Linux RAID systems under LVM.\n- Fixed in the localhost.cgi and in monitorix.pl files to not include a second\n  configuration file if the first one already exists.\n- Fixed the graphs legend lines adding blank lines in order to have a better\n  formatting. That only affected those who have RRDtool version above 1.2.13.\n- Added the Zoom feature that, when enabled, it will permits to see a larger\n  picture just clicking inside any graph image.\n\t(suggested by Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Removed the degree symbol in all the temperature graphs.\n- Some little code cleanup.\n\n\n0.9.1  - 09-Jan-2007\n====================\n- Fixed some annoying cron messages about uninitialized value during an addition\n  and a multiplication, only on 2.4 kernels.\n- Fixed the line and area colors in the kernel-related new graphs.\n\n\n0.9.0  - 03-Jan-2007\n====================\n- Fixed the background color of the graphs in Multihost feature.\n- Added a lot of new colors to cover as many hardware interrupts as they exist.\n- Added the Monitorix shortcut icon.\n- Fixed a bad closing in the global <html> tag.\n- Fixed and optimized the start routine in the init script.\n- Added a new composed-graph to see the Linux kernel usage per processor. The\n  graph will be divided by three parts (as always) only using, right now, the\n  biggest and the first one of the last two. The graph will show the global\n  percentages of total user time, nice time, system time, idle time and io-wait\n  time and separately, the number of context switches. Finally if the system\n  has multiprocessors there will be an individual graph per processor showing\n  the percentages of its CPU times (up to 8 processors).\n\t(suggested by Michael Berger, MBerger AT scrippsops.com)\n- Added a configuration switch (Y/N) per graph to enable or disable its\n  processing. This will help specially on embedded systems (where there is not\n  much disk space) to monitorize only what it is really needed.\n- IMPORTANT NOTICE: The configuration file (/etc/monitorix.conf) has been\n  extended with important changes.\n\n\n0.8.3  - 16-Oct-2006\n====================\n- Added the word \"easier\" to the Monitorix slogan.\n- Added support for CCISS Compaq RAID driver under 2.6 Linux kernels.\n- Changed the color for the first mounted filesystem in the disk usage, now is\n  darker.\n- Changed all the white colors to gray in order to be more visible when using\n  the white theme.\n- Changed the Fax color (from white to orange).\n- Adjusted three colors in the interrupt activity graphs: from gray to orange,\n  from black to dark-gray and from white to light-gray.\n- Changed the color of the running processes (from dark blue to red).\n- Changed the HTML font from the Arial,Helvetica to Verdana,Tahoma, and switched\n  to lowercase all the HTML tags.\n- Fixed a problem when finding the root disk on LVM systems with multiple disks\n  on the same logical volume.\n\t(thanks to Bon, bon AT bugstudio.net)\n- Consolidated to only one internal function all temperature graphs concerning\n  to the Hewlett-Packard server models.\n- Fixed a broken image in the third temperature graph on some Hewlett-Packard\n  server models.\n- Added support for up to 255 hardware interrupts to take advantatge of the\n  APIC feature in newer Linux systems. The \"int.rrd\" database will be upgraded\n  automatically.\n- Because of the new support for so many interrupts, the interrupt graphs no\n  longer displays the unused ones.\n- Added support for up to 5 NICs. The \"net.rrd\" database will be upgraded\n  automatically.\n  \t(suggested by Mike Harris, MikeDawg AT addictz.org)\n- Removed the use of the generation number from the HP ProLiant servers, because\n  there are no differencies In the number of processors between the current\n  generations. Now the server names are changed from ML350G3 to simply ML350.\n\n\n0.8.2  - 04-Jul-2006\n====================\n- Changed from dark-gray to orange the color of the last mount point in the\n  disk usage graph.\n- Added error handling during the creation of the RRDs database files.\n- Fixed a graph creation error when trying to view the PC LANs on systems with\n  RRDtool v1.2+.\n- Fixed a graph creation error during the monthly report creation on systems\n  with RRDtool v1.2+.\n- Fixed to take care about the color selected when creating the monthly report\n  graphs.\n- Fixed a typo when cutting the last digit of $root_disk.\n\t(thanks to Christoph Fritsche, Christoph.Fritsche AT fh-telekom-leipzig.de)\n- Added the new parameter \"silent=imagetag\" which among of the image\n  generation it will return the HTML <IMG SRC> tag for the specified image.\n- Fixed the annoying old behaviour of the Multihost feature that obligates to\n  reload the page two times every time you want to see the most up to date\n  remote server graphs.\n- Some cosmetic changes.\n\n\n0.8.1  - 17-May-2006\n====================\n- Fixed problems while creating the ip counters when the network port variables\n  $PORT01, $PORT02, ... are removed or not defined in the configuration file.\n- Added better support for Linux Software RAID devices (/dev/md0, /dev/md1, ...).\n- Added specific colored logo images for black and white themes.\n- Optimized the way how are used the chomp() functions, using now multiple\n  arguments.\n- Optimized all the code that was using system commands to collect information.\n- Dramatically reduced the CPU load average on most systems specially on slow or\n  old systems. As an example of that, a Pentium at 133Mhz sees reduced to 50%\n  its CPU load.\n- More code cleaning.\n\n\n0.8.0  - 27-Mar-2006\n====================\n- Almost complete support for FreeBSD based systems.\n\t(thanks to Roger \"Rocky\" Vetterberg, roger AT vetterberg.com)\n\t(thanks to the twenty4help, http://www.twenty4help.com)\n- Code prepared to be more easily portable to other UNIX/Linux systems.\n- Changed the location of the configuration file to /etc/monitorix.conf.\n- Fixed a \"grep\" condition problem with LVM based systems not using LVM.\n\t(thanks to Yazhir, admin AT pazeng.co.il)\n- Fixed to escape more possible colons on interrupt device names.\n- Fixed graph font size for RRDtool versions 1.2+.\n- Better support for RRDtool version 1.2.\n- Fixed the counter of the amount of Samba locked files.\n- Better monitorization in the detection of VirusMail (requires MailScanner).\n- Improved the Active Processes graph, now includes the sleeping and running\n  processes in order to know better the amount of concurrent processes the\n  server has.\n- Now the cron file is automatically created taking care the OS usual paths.\n- Removed the default names for the unused interrupt devices. Now all the unused\n  interrupts will be marked as \"unused\".\n- Fixed the order of collected data in disk activity graphs.\n- More code cleaning and removed some unused variables.\n\n\n0.7.14 - 17-Jan-2006\n====================\n- Fixed to be more accurate the way how are detected the ports that are down.\n- Removing annoying cron messages and added again the locking mechanism.\n\n\n0.7.13 - 16-Jan-2006\n====================\n- Added an automatic space-padding control to the MNT_LIST mount points names.\n- Fixed \"val\" and \"mode\" declarations and added a hint into README file for\n  users coming from other Linux distributions.\n\t(thanks to Christoph Fritsche, s03315 AT fh-telekom-leipzig.de )\n- Really added the parameter \"-P\" in the \"df\" lines. In the previous version it\n  was only commented in the ChangeLog.\n- Added a new file in the /etc/httpd/conf.d/ which will make the alias\n  \"/monitorix\", and will facilitate the installation with different html root\n  directories.\n- Added an initial support for LVM (Logical Volume Manager) based systems.\n- Added a warning indicator (changing the color background to red) on the 12\n  port graphs for each selected port if it seems to be down.\n- Removed temporaly the locked mechanism introduced in the previous version\n  because it produces annoying cron messages everyday at midnight.\n- Some little code cleaning.\n\n\n0.7.12 - 07-Nov-2005\n====================\n- Fixed the stat() function that prevented to collect Samba and NetAtalk data.\n- Escape colons in Interrupt names (INT_NAME) for rrdtool 1.2 branch versions.\n\t(thanks to Marcos Andre, foca AT siagri.com.br)\n- Added the parameter \"-P\" in order to prevent multi-line output from \"df\".\n\t(thanks to Rene Kapeller, rene.kapeller AT psi.ch)\n- Added a locking mechanism to prevent concurrent executions of Monitorix, that\n  will be useful on very high loaded servers.\n\t(thanks to Rene Kapeller, rene.kapeller AT psi.ch)\n\n\n0.7.11 - 06-Oct-2005\n====================\n- Now the POP3 section is looking for pop3 string (not pop-3) in log entries.\n- It handles possible DNS no resolution for defined PC LANs.\n- Added English language support for the monthly reports.\n- Removed the PC_DS list. Monitorix only will use PC_LIST and PC_IP if needed.\n- Remove the hard-coded command paths in order to be more distro compatible.\n- Added some checks in order to warn if some directories or files can't be read.\n- Fix to escape only colons for rrdtool 1.2 branch versions.\n\n\n0.7.10 - 26-Sep-2005\n====================\n- Reduced the size of the Monitorix logo in the startup screen.\n- Finally fixed the problem with disk i/o on 2.6 kernels.\n- Fixed some incompatibilities in order to support RRDtool v1.2.\n\t(thanks to Alex Shiffer, refys AT zelacom.com)\n- Removed MONITORIX_VER variable from the configuration file.\n\n\n0.7.9  - 12-Sep-2005\n====================\n- Some cleanups in the Configuration.help file.\n- Remove annoying samba messages in cron when samba is not running.\n- Fixed bug when collecting disk i/o on kernels 2.6 (/proc/diskstats).\n\t(thanks to Alf Tanner, alf.tanner AT gmail.com)\n\n\n0.7.8  - 11-Sep-2005\n====================\n- Initial public release.\n\n", "#\n# Monitorix - A lightweight system monitoring tool.\n#\n# Copyright (C) 2005-2013 by Jordi Sanfeliu <jordi@fibranet.cat>\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; either version 2 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License along\n# with this program; if not, write to the Free Software Foundation, Inc.,\n# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n#\n\npackage HTTPServer;\n\nuse strict;\nuse warnings;\nuse Monitorix qw(trim);\nuse POSIX qw(strftime);\nuse HTTP::Server::Simple::CGI;\nuse base qw(HTTP::Server::Simple::CGI);\nuse MIME::Base64 qw(decode_base64);\nuse Socket;\n\nsub logger {\n\tmy ($url, $type) = @_;\n\n\tif(open(OUT, \">> $main::config{httpd_builtin}->{log_file}\")) {\n\t\tif($type eq \"OK\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] \\\"$ENV{REQUEST_METHOD} $url - $ENV{HTTP_USER_AGENT}\\\"\\n\";\n\t\t} elsif($type eq \"NOTEXIST\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] File does not exist: $url\\n\";\n\t\t} elsif($type eq \"AUTHERR\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] Authentication error: $url\\n\";\n\t\t} elsif($type eq \"NOTALLOWED\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] Access not allowed: $url\\n\";\n\t\t} else {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] $url\\n\";\n\t\t}\n\t\tclose(OUT);\n\t} else {\n\t\tprint STDERR localtime() . \" - ERROR: unable to open logfile '$main::config{httpd_builtin}->{log_file}'.\\n\";\n\t}\n}\n\nsub check_passwd {\n\tmy ($user, $pass) = @_;\n\n\tif(open(IN, $main::config{httpd_builtin}->{auth}->{htpasswd})) {\n\t\twhile(<IN>) {\n\t\t\tmy %pair = split(':', $_);\n\t\t\tif($pair{$user || \"\"}) {\n\t\t\t\tchomp($pair{$user});\n\t\t\t\tif(crypt($pass, $pair{$user}) ne $pair{$user}) {\n\t\t\t\t\tnext;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\tclose(IN);\n\t} else {\n\t\tprint STDERR localtime() . \" - ERROR: can't open file '$main::config{httpd_builtin}->{auth}->{htpasswd}'.\\n\";\n\t}\n\treturn 1;\n}\n\nsub ip_validity {\n\tmy ($myip, $hosts) = @_;\n\tmy $valid = 0;\n\n\tforeach my $address (split(',', $hosts)) {\n\t\tmy $myip_bin = inet_aton($myip);\n\n\t\t$address = \"0.0.0.0/0\" if $address eq \"all\";\n\t\tmy ($ip, $netmask) = split('/', trim($address) . \"/\");\n\t\tmy $ip_bin = inet_aton($ip);\n\n\t\t$netmask = \"255.255.255.255\" if $netmask eq \"\";\n\t\t$netmask = unpack(\"%32b*\", inet_aton($netmask)) if length($netmask) > 2;\n\t\tmy $netmask_bin = ~pack(\"N\", (2**(32-$netmask))-1);\n\n\t\tmy $first_valid = unpack(\"N\", $ip_bin & $netmask_bin) + ($netmask eq \"32\" ? 0 : 1);\n\t\tmy $last_valid = unpack(\"N\", $ip_bin | ~$netmask_bin) - ($netmask eq \"32\" ? 0 : 1);\n\n\t\t$myip_bin = unpack(\"N\", $myip_bin);\n\t\tif($myip_bin >= $first_valid && $myip_bin <= $last_valid) {\n\t\t\t$valid++;\n\t\t}\n\t}\n\treturn $valid;\n}\n\nsub http_header {\n\tmy ($code, $mimetype) = @_;\n\tmy $msg = $main::config{httpd_builtin}->{auth}->{msg} || \"\";\n\n\tif($code eq \"200\") {\n\t\tprint \"HTTP/1.0 200 OK\\r\\n\";\n\t} elsif($code eq \"401\") {\n\t\tmy (undef, $encoded_str) = split(' ', $ENV{HTTP_AUTHORIZATION} || \"\");\n\t\tmy ($user, $pass) = split(':', decode_base64($encoded_str || \":\"));\n\n\t\tif(check_passwd($user, $pass)) {\n\t\t\tprint \"HTTP/1.0 401 Access Denied\\r\\n\";\n\t\t\tprint \"WWW-Authenticate: Basic realm=\\\"$msg\\\"\\r\\n\";\n\t\t\tprint \"Content-Length: 0\\r\\n\";\n\t\t\tprint \"\\r\\n\";\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t} elsif($code eq \"404\") {\n\t\tprint \"HTTP/1.0 404 Not found\\r\\n\";\n\t} else {\n\t\tprint \"HTTP/1.0 403 Forbidden\\r\\n\";\n\t}\n\n\tprint \"Date: \" . strftime(\"%a, %d %b %Y %H:%M:%S %z\", localtime) . \"\\r\\n\";\n\tprint \"Server: Monitorix HTTP Server\\r\\n\";\n\tprint \"Connection: close\\r\\n\";\n\n\tif($mimetype =~ m/(html|cgi)/) {\n\t\tprint \"Content-Type: text/html; charset=UTF-8\\r\\n\";\n\t} else {\n\t\tprint \"Content-Type: image/$mimetype;\\r\\n\";\n\t}\n\n\tprint \"\\r\\n\";\n\treturn 0;\n}\n\nsub handle_request {\n\tmy ($self, $cgi) = @_;\n\tmy $base_url = $main::config{base_url};\n\tmy $base_cgi = $main::config{base_cgi};\n\tmy $host = $main::config{httpd_builtin}->{host} || \"localhost\";\n\tmy $port = $main::config{httpd_builtin}->{port} || \"8080\";\n\tmy $hosts_deny = $main::config{httpd_builtin}->{hosts_deny} || \"\";\n\tmy $hosts_allow = $main::config{httpd_builtin}->{hosts_allow} || \"\";\n\tmy $auth = lc($main::config{httpd_builtin}->{auth}->{enabled});\n\tmy $mimetype;\n\tmy $target;\n\tmy $target_cgi;\n\tmy @data;\n\n\treturn if fork();\t# parent returns\n\n\tmy $url = $cgi->path_info();\n\t$0 = \"monitorix-httpd\";\t# change process' name\n\n\t# check if the IP address is allowed to connect\n\tmy $denied;\n\tmy $allowed = ip_validity($ENV{REMOTE_ADDR}, $hosts_allow);\n\t$denied = ip_validity($ENV{REMOTE_ADDR}, $hosts_deny) if !$allowed;\n\tif(!$allowed && $denied) {\n\t\thttp_header(\"403\", \"html\");\n\t\tprint \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\\r\\n\";\n\t\tprint \"<html><head>\\r\\n\";\n\t\tprint \"<title>403 Forbidden</title>\\r\\n\";\n\t\tprint \"</head><body>\\r\\n\";\n\t\tprint \"<h1>Forbidden</h1>\\r\\n\";\n\t\tprint \"<p>You don't have permission to access $url\\r\\n\";\n\t\tprint \"on this server.</p>\\r\\n\";\n\t\tprint \"<hr>\\r\\n\";\n\t\tprint \"<address>Monitorix HTTP Server listening at $host Port $port</address>\\r\\n\";\n\t\tprint \"</body></html>\\r\\n\";\n\t\tlogger($url, \"NOTALLOWED\");\n\t\texit(0);\n\t}\n\n\t# sanitizes the $target\n\t$target = $url;\n\twhile() {\n\t\tmy $cur = length($target);\n\t\t$target =~ s/\\.\\.\\///;\n\t\t$target =~ s/^\\///;\n\t\t$target =~ s/\\/$//;\n\t\tlast unless $cur ne length($target);\n\t}\n\t$target = $target_cgi = \"/$target\";\n\n\t$target =~ s/^$base_url//;\t# removes the 'base_url' part\n\t$target_cgi =~ s/^$base_cgi//;\t# removes the 'base_cgi' part\n\tif(!$target || $target eq $base_url) {\n\t\t$target = \"index.html\" unless $target;\n\t}\n\t($mimetype) = ($target =~ m/.*\\.(html|cgi|png)$/);\n\n\t$target =~ s/^\\///;\t\t# removes leading slash\n\t$target_cgi =~ s/^\\///;\t\t# removes leading slash\n\tif($target_cgi eq \"monitorix.cgi\") {\n\t\tchdir(\"cgi\");\n\t\topen(EXEC, \"./$target_cgi |\");\n\t\t@data = <EXEC>;\n\t\tclose(EXEC);\n\t} elsif($target) {\n\t\tif(open(IN, $target)) {\n\t\t\t@data = <IN>;\n\t\t\tclose(IN);\n\t\t}\n\t}\n\n\tif(scalar(@data)) {\n\t\tif($auth eq \"y\") {\n\t\t\tif(http_header(\"401\", $mimetype)) {\n\t\t\t\tprint \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\\r\\n\";\n\t\t\t\tprint \"<html><head>\\r\\n\";\n\t\t\t\tprint \"<title>401 Authorization Required</title>\\r\\n\";\n\t\t\t\tprint \"</head><body>\\r\\n\";\n\t\t\t\tprint \"<h1>Authorization Required</h1>\\r\\n\";\n\t\t\t\tprint \"<p>This server could not verify that you\\r\\n\";\n\t\t\t\tprint \"are authorized to access the document\\r\\n\";\n\t\t\t\tprint \"requested.  Either you supplied the wrong\\r\\n\";\n\t\t\t\tprint \"credentials (e.g., bad password), or your\\r\\n\";\n\t\t\t\tprint \"browser doesn't understand how to supply\\r\\n\";\n\t\t\t\tprint \"the credentials required.</p>\\r\\n\";\n\t\t\t\tprint \"</body></html>\\r\\n\";\n\t\t\t\tlogger($url, \"AUTHERR\");\n\t\t\t\texit(0);\n\t\t\t}\n\t\t}\n\t\thttp_header(\"200\", $mimetype);\n\t\tforeach(@data) {\n\t\t\tprint $_;\n\t\t}\n\t\tlogger($url, \"OK\");\n\t} else {\n\t\thttp_header(\"404\", \"html\");\n\t\tprint \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\\r\\n\";\n\t\tprint \"<html><head>\\r\\n\";\n\t\tprint \"<title>404 Not Found</title>\\r\\n\";\n\t\tprint \"</head><body>\\r\\n\";\n\t\tprint \"<h1>Not Found</h1>\\r\\n\";\n\t\tprint \"The requested URL $url was not found on this server.<p>\\r\\n\";\n\t\tprint \"<hr>\\r\\n\";\n\t\tprint \"<address>Monitorix HTTP Server listening at $host Port $port</address>\\r\\n\";\n\t\tprint \"</body></html>\\r\\n\";\n\t\tlogger($url, \"NOTEXIST\");\n\t}\n\n\texit(0);\n}\n\n1;\n"], "fixing_code": ["3.3.1  - 21-Nov-2013\n====================\n- Fixed to correctly sanitize the input string in the built-in HTTP server\n  which led a number of security vulnerabilities. [#30]\n\n\n3.3.0  - 12-Aug-2013\n====================\n- Added a complete statistical Wowza Media Server graph.\n\t(suggested by Daniele Ilardo, kkstyle21 AT gmail.com)\n- Added a complete statistical PHP-APC graph.\n\t(suggested by Petr \u0160vec, petr.svec AT pak.izscr.cz)\n- Reimplemented the alarm signal handler placing it inside the main loop in\n  order to be able to control the timeouts in the 'disk' graph (and others).\n  This should avoid a complete freeze if the network goes down when monitoring\n  NFS filesystems. [#10]\n- Reimplemented the 'theme' option.\n- Implemented a complete email reporting mechanism. [#11]\n- Added the label 'Total' in the main graph of 'apache'.\n- Added a new option called 'show_gaps' to be able to see the gaps produced by\n  missing data in graphs.\n\t(suggested by Skibbi, skibbi AT gmail.com)\n- Add a check during the initialization of the 'nvidia' graph, to test for the\n  existence of the 'nvidia-smi' command.\n- Add a check during the initialization of the 'nfss' graph, to test if there\n  is the '/proc/net/rpc/nfsd' file.\n- Add a check during the initialization of the 'nfsc' graph, to test if there\n  is the '/proc/net/rpc/nfs' file.\n- Added the option 'url_prefix' in the 'traffacct' graph.\n- Added the option 'global_zoom' to all graphs.\n- Fixed a bug that prevented from seeing stats in the 'nfss' graph.\n- Fixed in 'nginx' graph the name of the iptables rules which prevented working\n  the network traffic graph. [#22]\n- Fixed a bug that prevented a correctly data collection in the 'fail2ban'\n  graph. [#23]\n- Fixed the description of 'netstats_in_bps' in monitorix.conf(5) man page.\n- Fixed a message of 'Argument \"\" isn't numeric in int ...' in 'nvidia' graph\n  when using newer official drivers.\n- Fixed a bug in Groups (Multihost view) that prevented from seeing the remote\n  server's graphs of the selected group.\n\t(thanks to Mauro Medda, m.medda AT tiscali.it)\n- Little code cleaning.\n\n\n3.2.1  - 03-Jun-2013\n====================\n- Changed the source from where is collected the memory usage in the 'squid'\n  graph. Now the shown values are more real and accurate.\n- Added user/password authentication options in the built-in HTTP server. [#14]\n- Added the script 'htpasswd.pl' to be able to encrypt passwords. [#14]\n- Added the options 'hosts_allow' and 'hosts_deny' to restrict access by IP\n  address to the built-in HTTP server. [#14]\n- Added the ability to specify an optional host address for the built-in HTTP\n  server to bind to. [#19]\n- Added a new option in the 'disk' graph called 'accept_invalid_disk' that\n  permits continue working even if some of the device names defined are invalid\n  or non-existent. This is specially useful to monitor external disks that\n  aren't permanently connected to the system.\n- Updated the 'monitorix.service' file. [#20]\n\t(thanks to Christopher Meng, rpm AT cicku.me)\n- Fixed a bug that prevented from seeing the Core temperatures in the 'lmsens'\n  graph.\n\t(thanks to Bryan Guidroz, bryanguidroz AT hotmail.com)\n- Fixed a typo and escaped a pair of hyphens in the monitorix.conf(5) man page.\n\n\n3.2.0  - 13-May-2013\n====================\n- Added a complete Raspberry Pi sensors graph. [#10, #13]\n\t(thanks to graysky, graysky AT archlinux.us)\n- Improved a bit the MySQL documentation in the monitorix.conf(5) man page.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Added a new option called 'temperature_scale' to be able to toggle between\n  values in Celsius or in Fahrenheit.\n\t(suggested by Bryan Guidroz, bryanguidroz AT hotmail.com)\n- Added support for Simplified Chinese language in the monthly reports.\n\t(thanks to Christopher Meng, rpm AT cicku.me)\n- Added support for the ATI graph cards through the 'gpu' keys in the 'lmsens'\n  graph. As in the NVIDIA case, it requires the ATI official drivers. [#8]\n- Changed the default charset in the built-in HTTP server to UTF-8.\n\t(thanks to Akong, ak6783 AT gmail.com for pointing this out)\n- Added verbosity to the 'undefined configuration' of MySQL graph.\n- Fixed a typo in an iptables rule in the Nginx graph.\n\t(thanks to Faustin Lammler, faustin AT dejadejoder.com)\n- Fixed the Squid graph in order to honour the 'netstat_in_bps' option.\n\t(suggested to Ignacio Freyre, nachofw AT adinet.com.uy)\n- Fixed in 'port' graph to show the minimum number of graphs between the value\n  of 'max' and the number of ports really defined. This fixes the error messages\n  of uninitialized values in lines 410 and 411.\n- Fixed to honour the support of RAID controller parameters in the disk device\n  names defined in the disk graph. [#12]\n- Small fixes in the alerting system of 'fs', 'system' and 'mail' graphs.\n- Fixed a bug in 'traffacct' graph that prevented accounting traffic if the\n  <desc> option was empty. Also, Socket module has been added.\n- Fixed to get the correct graph of the right group number in the 'fs' graph\n  when using 'silent=imagetag' option. [#16]\n\n\n3.1.0  - 15-Mar-2013\n====================\n- Added a complete statistical FTP graph.\n- The 'serv' graph now uses 'secure_log' log file to get FTP login statistics.\n  Alternatively the 'ftp_log_date_format' option has been renamed to\n  'secure_log_date_format'.\n- Fixed in 'nginx' and 'port' graphs to properly use '-m conntrack --ctstate'\n  instead of '-m state --state' in all iptables rules and avoid an annoying\n  iptables message about using an obsolete option.\n- Fixed to delimit the values in 'disk->list->[n]' by \", \" (comma + space).\n- Fixed to detect if a device name defined in 'disk->list->[n]' does really\n  exist in the system.\n- Fixed a missing initialization of some data arrays in 'lmsens' which generated\n  the message \"ERROR: while updating /var/lib/monitorix/lmsens.rrd: expected 52\n  data source readings (got 10) from N\" if the 'sensors' command is missing.\n- Fixed in 'lmsens' to better handle the returned value (an error) when the\n  'nvidia-smi' command is not installed in the system.\n- Fixed a bad temperature values extraction from the 'sensors' command in the\n  'lmsens' graph.\n\t(thanks to C\u00e9dric Girard for pointing this out)\n- Fixed in 'nginx' to avoid the use of uninitialized values and to show an error\n  message when Monitorix is unable to connect to the Nginx server.\n- Fixed in 'apache' to show an error message when Monitorix is unable to\n  connect to the Apache server.\n- Fixed in 'lighttpd' to show an error message when Monitorix is unable to\n  connect to the Lighttpd server.\n- Fixed in 'icecast' to show an error message when Monitorix is unable to\n  connect to the Icecast server.\n- Fixed in 'traffact' to show an error message when Monitorix is unable to\n  connect to the HTTP server.\n- Fixed to make sure to kill the built-in HTTP server if Monitorix exits\n  unexpectedly.\n- Fixed messages of type 'Use of uninitialized value ...' in 'system', 'kern'\n  and 'fs' graphs on FreeBSD systems.\n- Fixed to extract correctly the minor number of kernel version on FreeBSD\n  systems.\n- Fixed a bug in 'user' graph that prevented counting correctly the number of\n  users currently logged in FreeBSD systems.\n- Fixed a bug in how data was collected using 'ipfw' that affected the 'port'\n  graph which was showing more activity than real.\n\n\n3.0.0  - 18-Feb-2013\n====================\n- Added an HTTP built-in server.\n- Changed the path 'cgi-bin' to 'cgi'.\n- Fixed color sequence in the 'fs' graph. \n- Fixed a division by zero in 'mysql' graph.\n- Fixed excessive bottom padding in 'fs' graph.\n- Fixed to use always the same colors for '/', 'swap' and '/boot' values in 'fs'\n  graph.\n- Fixed a bad naming in the title of 'traffacct' graph.\n- Fixed all URLs of the .png files.\n\n\n3.0.0B2- 01-Feb-2013\n====================\n- Lot of improvements in the MySQL graph, which includes adding a new value\n  called 'Query_Cache_Hit_Rate\", the number of select querys also includes\n  the value of Qcache_hits, new query type called Com_stmt_execute and the new\n  value Temp_tables_to_disk.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Added a systemd service file template.\n\t(thanks to graysky, graysky AT archlinux.us)\n- Alerts have been reimplemented and they are now configured independently for\n  each graph.\n- Added two new alerts in the 'mail' graph: one to control the number of\n  delivered messages per minute and the other for the number of messages in the\n  mail queue.\n- Added the ability to also support outgoing connections in the 'port' graph.\n- Fixed a pair of typos in the section explaining 'hptemp' in the man page\n  monitorix.conf.5.\n- Fixed from using unitialized variables in 'fs'.\n- Fixed a bad assigning in 'mail' that prevented from seeing the greylisting\n  values in the graph.\n- Fixed a bug in CGI the prevented honoring the 'hostname' configuration option.\n\t(thanks to graysky, graysky AT archlinux.us)\n- Fixed in 'mysql' to use \"show global status' in all operations instead of\n  \"show status\" since the latter only refers to the current thread.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Fixed to add Qcache_hits value to Com_select in order to get the real value\n  (assuming that query caching is on).\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n\n\n3.0.0B1- 11-Jan-2013\n====================\n- Complete rewrite.\n- Added a new option in 'port' to define the number of graphs per row.\n- Added two new options 'ftp_log' and 'ftp_log_date_format' to be able to\n  read FTP connections from its own log file.\n\t(suggested by Luca Ferrario, luca AT ferrario.net)\n- Fixed a missing description in the first entry of each network interface in\n  the options list.\n- Fixed a missing argument on each *_init() function preventing show an \"Ok\"\n  message when debugging is enabled.\n- Fixed some bugs in Groups.\n- Fixed a typo in the percentage variable in FS alert.\n- Fixed variables naming in 'mail' graph when using Postfix MTA that prevented\n  to see the values bounced, discarded and forwarded.\n- Fixed a number of small bugs.\n- Fixed a bad naming of the bitrate variables when creating the Bitrate graph\n  of the Icecast Streaming Media Server.\n- Fixed to include the username and password when connecting to MySQL using a\n  socket.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n\nChanges introduced to 2.6.0 version:\n- Introduced some modifications to the device name detection for FreeBSD.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Improved support of Linux NFSv4 spliting the operation names in two different\n  arrays (client and server).\n- Fixed a typo in 'monitorix.cgi' that prevented honoring the NFSC_VERSION\n  option.\n- Fixed an intermix usage of alarm() and sleep() substituting it by alarm() and\n  pause().\n- Fixed a bug in multihost introduced by the groups code.\n\n\n2.6.0  - 19-Sep-2012\n====================\n- Added a complete statistical BIND graph.\n- Added support for NetBSD systems.\n- Added support for grouping remote servers in the Multihost view.\n\t(thanks to Hartmut W\u00f6hrle, hartmut AT hartmut-woehrle.ch)\n- The Disk and Filesystems Usage and I/O Activity graphs have been completely\n  rewriten.\n\t(suggested by Konstantinos Skarlatos, k.skarlatos AT gmail.com)\n- Added support to monitor unlimited number of disk drives.\n- Added support to monitor unlimited number of filesystems.\n- Reorganized the legend in the Disk drive temperatures and health graph.\n- Changed the shebang to be more portable among different systems.\n- Completely rewritten the Debian/Ubuntu init script.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Minor changes in the header of the Debian/Ubuntu init script.\n\t(thanks to Uwe Heidrich, uweheidrich AT hotmail.com)\n- Expanded to 15 characters the description in network ports.\n- Changed to lines a bit thicker some graphs with few values.\n- Added a new feature to enable/disable the use of javascript:void function when\n  clicking on a zoomable graph.\n\t(thanks to Florian E.J. Fruth, fejf AT gmx.de)\n- Fixed a bug that mixed the collected values when monitoring multiple MySQL\n  servers.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Fixed a bad percentage calculation in the dentries and inodes values.\n- Removed useless code when collecting Squid stats.\n- Fixed a typo in a MySQL graph.\n\n\n2.5.2  - 21-May-2012\n====================\n- Modified iptables/ipfw accounting rules handling and fixed some bugs.\n- Added to backup .rrd files every time it changes their internal structure.\n\t(suggested by Michael Mansour, mmansour AT ostech.com.au)\n- Fixed a bug that prevented the creation of the 'mysql.rrd' file. The error\n  message was \"ERROR: while creating /var/lib/monitorix/mysql.rrd: you must\n  define at least one Data Source\".\n\t(thanks to Darryl Yeoh Gim Hong, drl AT bsd.my for pointing this out)\n- Fixed to avoid modifying read-only values in chomp() function.\n\t(thanks to Julio Cifuentes, jcifuentes AT mail.com for pointing this out)\n\n\n2.5.1  - 23-Apr-2012\n====================\n- Modified the regexp in 'mgr:ipcache' listing to support newer Squid versions.\n- Changed some information and debug messages to be more verbose and clear.\n- Force termination with exit(0) when receiving a SIGINT.\n- Added support to use the socket file for the connection to the MySQL server.\n\t(suggested by Darryl Yeoh Gim Hong, drl AT bsd.my)\n- Added the new option IMAP_DATE_LOG_FORMAT to match with the Dovecot date log\n  format.\n- Refreshed the COPYING file to reflect the current contents of the GPLv2 at\n  http://www.gnu.org/licenses/gpl-2.0.txt.\n- Complete English correction in the monitorix.conf(5) man page.\n\t(thanks to Paul Rupp, paulrupp AT acorp.net)\n- Fixed a bug that prevented monitoring multiple MySQL servers.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Fixed the vertical label of network traffic in Mail graph to honour the\n  NETSTATS_IN_BPS option.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Fixed a bug that prevented collecting IMAP data from wu-imap server.\n- Fixed padding on big values in the Nginx stats.\n\n\n2.5.0  - 21-Mar-2012\n====================\n- Added a complete statistical Fail2ban graph.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added a complete statistical Lighttpd graph.\n- Added full support for the Postfix MTA in the Mail statistics graph.\n- Extended the number of information in the Mail statistics graph.\n- Added support to monitor unlimited number of local or remote Apache servers.\n- Added support to monitor unlimited number of local or remote MySQL servers.\n- Added support for Dovecot 2.0 log format.\n- Optimized a lot of code including more regular expressions. \n- Replaced hardcoded graph titles with the strings in the configuration file.\n- Modified the RedHat init script to let Monitorix create itself the pidfile.\n  This should improve the support on modern Linux systems using 'systemd'.\n\t(thanks to a IRC user called 'dashbad' for pointing this out)\n- Improved the init script to be more LSB-compliant.\n- Changed to the '-A' parameter in 'smartctl' to avoid waking up disks when\n  collecting their temperatures and health values.\n\t(thanks to Michael Perry, mike AT serensilver.co.uk)\n- Fixed some titles in the list box of the main page.\n- Fixed color overriding in the IMAP and POP3 services graph.\n- Fixed the title in some graphs.\n- Fixed a typo in the debug array name that prevented individual debug working\n  properly.\n- Fixed a typo in the configuration file.\n\t(thanks to a IRC user called 'gangsterlicious' for pointing this out)\n- Fixed a bug in the Squid graph that prevented of being counted the Aborted\n  clients.\n- Fixed numbering in some graphs.\n\n\n2.4.1  - 09-Jan-2012\n====================\n- Added support for Dovecot 1.2 log format.\n- Added Polish language support in the monthly traffic report.\n\t(thanks to Piotr Smalira, p.smalira AT g16-lublin.eu)\n- Added 'hour' timeframe in 'monitorix.cgi' to accept unsupported queries not\n  comming from the main page.\n- Added support for fail2ban bans in the System Services Demand graph.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added support for CommuniGate mail server logs in the System Services Demand\n  graph.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added the ability to show more debug information introducing extra values to\n  the -d parameter. The monitorix(8) manpage has been updated to reflect these\n  changes.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added the sensor real names in the Voltages graph.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Removed duplicated newline character in logger() calls.\n- Added disabling automatic page reloading when $REFRESH_RATE is 0.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added a new option in configuration file to change the favicon image.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Added support for SpamAssassin and Clamav logs to catch email-spam and\n  email-virus.\n\t(thanks to Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Grouped all the mail related services to the small graphs in the System\n  Services Demand graph. This only implied changing the IMAP position.\n\t(suggested by Andreas Itzchak Rehberg, izzy AT qumran.org)\n- Fixed the main interrupt graph in order to avoid running out of colors on\n  systems with lot of interrupts.\n- Fixed to honour the limit of 15 characters of the mountpoint names in the\n  Icecast graph.\n- Fixed the column layout of the text mode in the LM-Sensors graph.\n- Fixed to set standard locale LC_TYPE,\"C\".\n\n\n2.4.0  - 28-Nov-2011\n====================\n- Added a complete statistical Squid Proxy Web Cache graph.\n\t(suggested by Michael Mansour, mmansour AT ostech.com.au)\n- Added a complete statistical NTP multigraph.\n- Added a complete statistical Icecast Streaming Media Server multigraph.\n\t(suggested by Kamil Weiser, crx AT lordcyber.net)\n- Error messages now use the internal logger() function so all these messages\n  will have the date and time prefixed.\n- Added support for network port monitoring on FreeBSD and OpenBSD systems.\n- Added support for Nginx network traffic monitoring on FreeBSD and OpenBSD\n  systems.\n- Added the number of instances (1) in the specified time key (day, week, month\n  or year). This also introduces some changes in the name of the .png files and\n  will break backwards compatibility with old (2.3-) Monitorix with Multihost\n  feature enabled.\n- Removed some inadequate calls to 'die' taking proper actions on each case.\n- Introduced small optimizations.\n- Removed the '--lower-limit=0' in the Voltages graph that prevented seeing\n  negatives values.\n- Fixed some typos in the variable name $PNG_DIR in 'monitorix.cgi'.\n- Fixed to avoid a 'divide by zero' message on certain NVIDIA driver version.\n\n\n2.3.0  - 05-Sep-2011\n====================\n- Added a complete statistical NFS (v2, v3 and v4) server graph.\n- Added a complete statistical NFS (v2, v3 and v4) client graph.\n- Improved support for newer NVIDIA drivers and fixed some bugs.\n- Added the 'condrestart' option in the RedHat init script.\n\t(suggested by Yury V. Zaytsev, yury AT shurup.com)\n- Added a new option in the configuration file to toggle all network values\n  between bits and bytes per second.\n- Some cosmetic changes.\n- Fixed to sanitize a trailing space in the '/proc/stat' file that prevented to\n  show values in the disk I/O graphs on certain systems with Linux kernel 2.4.\n\t(thanks to Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Fixed the Connections_usage value in the MySQL graph avoiding to be greater\n  than 100%.\n- Fixed to avoid showing the device interrupts called 'Dynamic-irq'.\n\t(thanks to Michael Mansour, mmansour AT ostech.com.au)\n- Fixed to avoid showing the additional parameter in disk drives.\n\t(thanks to Michael Mansour, mmansour AT ostech.com.au)\n- Fixed to add more colors in order to support more interrupt devices.\n\t(thanks to Dan Criel, dancriel AT gmail.com)\n- Fixed a bad calculation of network traffic in 'text' interface of Ports graph.\n- Fixed an extra 'optgroup' close tag in 'index.html' for each graph disabled.\n\n\n2.2.0  - 21-Jun-2011\n====================\n- Added support for OpenBSD systems.\n\t(thanks to Devio.us team)\n- Added a complete statistical MySQL graph.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- (missed in previous version) Prefixed with full path the 'sysctl' command to\n  retrieve the boot time. This is specially needed when using the lighttpd web\n  server on FreeBSD systems.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Added the Fork rate (new processes started per second) in the Context Switches\n  graph. It includes two new values: the number of forks and vforks, being the\n  later only for FreeBSD and OpenBSD systems.\n- Added support for the new NVIDIA driver 270.41.03.\n- Added support for the names 'BusyServers' and 'IdleServers' given by Apache\n  when ExtendedStatus is disabled.\n- Added support to show the interrupt names on Xen guest systems.\n- Added to force a standard locale to avoid problems with decimal point/comma.\n\t(thanks to Vadim Beljaev, anon333 AT mail.com)\n- Workarounded the well-known problem with SIG{CHLD} and system() function that\n  returns -1 on *BSD systems.\n- Included a Debian init script.\n\t(thanks to J\u00f6rg Alpers, JAlpers AT gmx.net)\n- Fixed the LINE2 of VFS graph and the swap device in FS graph.\n- Fixed a bug when counting total of users on systems with large number of users\n  logged in.\n- Fixed a bug in 'monitorix.spec' that prevented a correct installation on\n  systems with no 'apache' user defined, and added cosmetic changes.\n- Fixed to show only the graphs of the PC LAN defined in @PC_LIST even when\n  $PC_MAX is greater.\n- Fixed a bug that could remove some Network Port 'iptables' rules under \n  certain circumstances.\n- Fixed a bug that prevented to put in the email of monthly reports the listing\n  with the daily usage of all the hosts.\n- Fixed a missing import of the 'File::Basename' module.\n- Fixed some typos in the man pages and aligned texts in some graphs.\n\n\n2.1.2  - 04-May-2011\n====================\n- Added a new command line parameter to save the PID into the specified file\n  in order to make life easier to 'rc' scripts.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Prefixed with full path the 'sysctl' command to retrieve the boot time. This\n  is specially needed when using the lighttpd web server on FreeBSD systems.\n\t(thanks to Chris Rees, utisoft AT gmail.com)\n- Added to change to the / directory before parsing the command line parameters,\n  and after that, a change to a safety directory, either /tmp or /lost+found.\n- Improved the code that detects the physical device name where the / filesystem\n  resides.\n- Changed the way how are handled the command line options.\n- Removed the 'Tahoma' font name from all 'font face' HTML tags.\n- Hidden the unused values in the 'LM-Sensors and GPU temperatures' graphs.\n- Fixed to remove correctly the 'iptables' rules when some defined port has been\n  removed from the configuration file.\n- Fixed to show only the graphs of the ports defined in @PORT_LIST even when\n  $PORT_MAX is greater.\n- Fixed a missing variable initialization that generated an 'illegal division by\n  zero' message if the filesystem defined does not existed, and the system\n  didn't had a valid swap device.\n\t(thanks to Mowd, mowd8574 AT gmail.com)\n- Fixed to show the PID number even when started as a foreground process.\n- Fixed the padding of the Voltages values.\n- Fixed a bug that prevented to gather correctly the disk I/O values of the /\n  filesystem on Linux systems with kernel 2.4.\n\n\n2.1.1  - 12-Apr-2011\n====================\n- Reflect the SIGHUP reception with a message also in the new reopened log file.\n- Added support for the new 'Idrop' column in the output of 'netstat' command\n  appeared in FreeBSD 8.0 and newer versions.\n\t(thanks to Sean, strumming AT thestrings.com)\n- Fixed an illegal division by zero message if the swap device is not used at\n  all, which caused to not collect any data and, at the same time, prevented to\n  see any results in the Filesystems usage and I/O activity graphs.\n\t(thanks to Daniel Constantinov, daniel AT k9tecnologia.com.br)\n- Fixed to not show a broken graph if there is no data defined in any of the\n  three possible arrays of the HP Temperatures graphs.\n- Fixed to rename the files in the $USAGE_DIR directory once they are already\n  sent in the monthly reports.\n- Fixed to create correctly the iptables rules for PC LAN traffic accounting.\n\t(thanks to Daniel Constantinov, daniel AT k9tecnologia.com.br)\n\n\n2.1.0  - 09-Mar-2011\n====================\n- Completed the monthly traffic reports for PCs.\n- Added a better signal handling.\n- Added the SIGHUP signal handler in order to close and open a new log file.\n- Modified the monitorix(8) manpage to reflect that new feature.\n- Darkened the grey color of the CUPS usage in the Network Services graphs.\n- Fixed annoying messages in log file when PC_MAX is actually greater than the\n  number of entries in PC_LIST or PC_IP:\n\n*** DNS problem with: \n*** pc_update(): Usage: Socket::inet_ntoa(ip_address_sv) at /usr/bin/monitorix line 3548.\n\n- Fixed to show only the entries defined in PC_LIST even when PC_MAX has a\n  greater value.\n- Fixed to correctly handle the SIGCHLD signal to prevent an accumulation of\n  defunct or \"zombie\" processes in old Perl versions.\n- Fixed a regexp in 'fs.rrd' that prevented monitoring non-local filesystems.\n- Fixed a typo in monitorix(8) man page when referencing the monitorix.conf(5)\n  man page.\n- Fixed in 'monitorix.cgi' to accept the 'silent' option in PCs graphs.\n- Fixed to LINE2 type the lines plotted in the Greylisting zoomed graph.\n\n\n2.0.0  - 01-Feb-2011\n====================\nThis new version is a complete rewrite, including new features and graphs,\ncleaned up all the code, updated and enhanced a number of aspects in some\ngraphs, and fixed a lot of bugs. The most important change is that it no longer\nrequires 'crond' to work, instead Monitorix is now a complete standalone Perl\ndaemon being started and stopped like any other system service.\n\nPlease read the 'News' and 'Features' sections in the Monitorix web site to\ngive you an idea of all the changes and new features that include.\n\nI want to give a huge thanks to the people that has contributed testing and\nreporting bugs during its beta phase.\n\n\n1.5.2  - 18-Nov-2010\n====================\n- Added an new alert based on the usage of the root filesystem. It follows\n  the same logic than the CPU alert, so the alert script is practically the\n  same.\n\t(thanks to Ramchander, ramchan10 AT gmail.com)\n- Modified the man page of the configuration file to reflect the new alert\n  capability.\n- Added a protection mechanism when collecting the filesystem disk usage. It\n  prevents possible timeout scenarios on those filesystems mounted using NFS.\n\t(thanks to Ramchander, ramchan10 AT gmail.com)\n- Fixed to remove the netmask suffix when collecting the network traffic if\n  the IP belongs to a hostname instead of a network.\n\t(anonymous contribution)\n\n\n1.5.1  - 23-Jun-2010\n====================\n- Changed the default $ENABLE_MAIL option to 'N'.\n- Added a second decimal in the Mail statistics graph in order to have more\n  accurated values.\n- Added a missing \"--lower-limit=0\" to all graphs (except MTA stats).\n- Changed the default value of rigid (RIGID = 2) to 0 in all network port graphs.\n- Included a number of necessary adjustments in the install.sh script to adapt\n  it better to the FreeBSD installation process.\n\t(thanks to Michael Brune, admin AT mjbrune.org)\n- Added the description of the @NET_RIGID and @NET_LIMIT arrays in the man page\n  monitorix.conf(5).\n- Fixed some bugs and a bad code design in the Interrupts graph that prevented\n  showing correctly the graph on systems with some interrupts numbers greater\n  than 256.\n\t(thanks to Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Fixed the Memory graph to display correctly the value in MB. This bug affected\n  only the FreeBSD systems.\n- Fixed to be able to enable only the LAN devices monitoring without having to have\n  enabled the network ports monitoring.\n\t(thanks to Niklas Janzon, niklas.janzon AT gmail.com)\n- Fixed the iptables rules section in order to avoid its execution on FreeBSD\n  systems.\n- Fixed a bug in the init script that prevented executing it during the system\n  shutdown on RedHat/Fedora/CentOS systems. The path of the lock file has\n  changed from /var/lock/ to /var/lock/subsys.\n\n\n1.5.0  - 06-Apr-2010\n====================\n- Added a new graph to show complete MTA (Sendmail) statistics.\n- Added support for those lines in the 'sensors' command output that include\n  a newline character and have the result in the next line.\n\t(thanks to Balazs Denes, dnsdns AT gmail.com)\n- Reused a lot of temporal variables in the CGI file.\n- Fixed to not show error messages on certain virtual servers if the file\n  '/proc/diskstats' does not exist.\n\t(thanks to an anonymous IRC user called 'gangsterlicious')\n- Fixed the rigid control in the 3rd graph of the Nginx statistics.\n- Fixed the colors scheme in the main page when using the 'white' theme.\n\n\n1.4.2  - 10-Feb-2010\n====================\n- Removed the width=1 from the top table in the graphs page.\n- Changed to grey the color of all links.\n- Added automatic detection of total amount of memory in the system.\n- Modified the install.sh script in order to remove the already supported\n  distribution Gentoo and to include some warnings saying that the script is\n  not the recommended method of installing Monitorix.\n- Added a new $OSTYPE key called \"Linux-Arch\" to include support for Arch Linux\n  distribution.\n\t(thanks to graysky, da_audiophile AT yahoo.com)\n- Fixed the URL of the images if is being called through a secure web server.\n\t(thanks to an anonymous IRC user called 'dobermai')\n- Fixed those no named interrupts that generated the annoying message\n  \"substr outside of string at /var/www/cgi-bin/monitorix.cgi line 4775,\n  <INTERRUPTS> line n.\" in the Apache error log.\n\t(thanks to Mac, redleader25 AT hotmail.com)\n\n\n1.4.1  - 04-Jan-2010\n====================\n- Updated the monitorix.spec and monitorix.conf files for SuSE Linux packages.\n\t(thanks to Oliver Kaltenecker, oliver.kaltenecker AT wittwer.de)\n- Modified the wide of the mount point column in the disk usage graph in order\n  to fit longer pathnames.\n- Substituted the pair of bottom logos (black and white) for a new one with\n  background transparency.\n- Changed the initial logo image by a new one with background transparency and\n  removed the slogan which reduced its size.\n- Removed the configuration option $IDATE.\n- Removed the envelope image as with the new mailing list it doesn't make sense\n  to be there anymore.\n- Fixed to honour the color theme even in the main page and simplified its\n  layout.\n- Fixed some annoying error messages in the web server logs about the use of\n  an uninitialized value in 4781 line.\n\t(thanks to Edgar Barranco, ebarranco AT gmail.com)\n- Fixed a bug in how are collected the hardware temperatures in HP ProLiant\n  ML310 and ML350 models.\n\t(thanks to Rene Kapeller, rene.kapeller AT psi.ch)\n- Fixed an overflow in the CPU array in systems with more than 8 processors,\n  that prevented seeing the rest of graphs.\n  \t(thanks to Robin Friedrich, Robin.Friedrich AT itt.com)\n\n\n1.4.0  - 05-Oct-2009\n====================\n- Optimized the iptables command used to collect Chain statistics.\n- Added the ability to show the results in plain text instead of using rendered\n  graphs. This will make life easier either for people with vision impairments\n  and for automatic processing of the information.\n\t(thanks to Christoph Doeren, cd AT yuyumo.de)\n- Added an alert system based on the last 15 minutes of the CPU load average.\n\t(suggested by Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Fixed a bug in monitorix.cgi that messed up the way how are displayed the\n  individual processors' graphs.\n\n\n1.3.2  - 01-Sep-2009\n====================\n- Improved a lot the support for FreeBSD systems.\n\t(thanks to Pavlin Vatev, anex AT smrad.net)\n- Added support for Enterprise Volume Management System (EVMS) to show the\n  I/O disk activity of the root filesystem.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Added a new option in monitorix.conf called %MAIL_LOG with the paths for the\n  mail log file of each Operating System. This removes the old path hard coded.\n- Changed the \"use\" line of the LWP::UserAgent module, now is only loaded if\n  Nginx statistics are enabled. This creates less dependences for all people\n  that don't need the Nginx statistics.\n- Optimized the accounting process of SSH connections using the same code for\n  Linux and for FreeBSD. Linux SSH connections using public keys are also\n  counted now.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Rewritten the Monitorix init script for Gentoo Linux.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Added a zero pading in the name of the proc.png files.\n- Fixed to show 0% of usage if a filesystem defined in MNT_LIST has been\n  umounted, instead of returning the same disk usage of its parent filesystem.\n- Fixed the %HTTP_LOG path in the monitorix.conf file for Linux-Gentoo.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Fixed the missing monitorixico.png file in the install script.\n  \t(thanks to Markus Rennings, mren AT mrmx.de)\n- Fixed to not create the network ports counters if $ENABLE_PORT is \"N\".\n\n\n1.3.1  - 05-Jul-2009\n====================\n- Fixed a location problem for the logo files on a fresh installation using the\n  Linux-Debian option.\n- Fixed a critical permission problem during a fresh installation (using the\n  Linux-Debian option) that prevented seeing all the graphs.\n  \t(thanks to Rubla Georgian, deletet.file AT yahoo.com)\n- Fixed some annoying error messages in the web server log when the $PORTnn and\n  $PORTnn_NAME aren't correctly defined in /etc/monitorix.conf.\n  \t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Removed the un_install.sh script.\n\n\n1.3.0  - 14-Jul-2009\n====================\n- Added the monitorix.conf(5) man page to be the main place to get help.\n- Added support for the Nginx web server statistics.\n  \t(thanks to Aleksandr Miroshnychenko, al.miroshnychenko AT gmail.com)\n- Removed the unused $EMAIL option. The $PC_DEFMAIL option is the one used when\n  sending the monthly reports.\n- Removed the $PC_MAX option as its value is now hard coded.\n- Reorganized a bit the monitorix.conf file and cleared the syntax.\n- Improved the install.sh script with the 'install' command instead of using\n  'mkdir', 'cp' and friends.\n- Fixed some missing HTML closing tags.\n- Fixed to match the default value of $ENABLE_LMTEMP in monitorix.pl.\n- Fixed a bad counting of the number of current Samba shares when there wasn't\n  any share on the list.\n  \t(thanks to Luca Ferrario, luca AT ferrario.net)\n\n\n1.2.4  - 06-Apr-2009\n====================\n- Isolated a Linux dependant code that prevented running Monitorix correctly\n  on FreeBSD systems.\n- Included support to recognize correctly the temperatures and RPM values when\n  in some weird cases, the FAN and CPU labels (in the lm_sensors output) share\n  the same name.\n  \t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Fixed a duplication in the Monitorix iptables rules during a restart.\n- Added support for systems with device interrupt numbers greater than 255.\n- Added support for openSuSE/SLES Linux distribution.\n\t(thanks to Alessandro Soraruf, soraruf AT ntd.homelinux.org)\n\n\n1.2.3  - 14-Jan-2009\n====================\n- Fixed the way how Monitorix creates the iptables rules. Now it uses the\n  parameter -I instead the -A in order to insert those rules in the top of\n  each chain so the data get recorded.\n  \t(thanks to Andrei Ioachim, andrei AT inteligis.com)\n- Added support for the Postfix MTA in the SMTP counter of the Network Services\n  Demand graph.\n  \t(thanks to Andrei Ioachim, andrei AT inteligis.com)\n- Fixed a typo in the declaration of $HTDOCS in the install.sh that only\n  affected to Gentoo installations.\n\t(thanks to Carlos Perez, cpa.admin AT gmail.com)\n- Removed the dependence of the 'lockfile' command in the init-script.\n\t(suggested by Carlos Perez, cpa.admin AT gmail.com)\n- Fixed to detect and show better the interrupt names.\n- Added a minimal support for interrupt numbers bigger than 255. This minimal\n  support will let you see the names of those interrupts that have those big\n  numbers but their activity will rest still void.\n\t(thanks to Brian Lopeman, brian.lopeman AT ctrh.org)\n- Fixed a missing '127.0.0.1' in the URL of the graph images when\n  'monitorix.cgi' is called from the command line.\n  \t(thanks to David Tiberio, dave AT cheapbooks.com)\n\n\n1.2.2  - 20-Nov-2008\n====================\n- Fixed a missing '/' when removing /var/www/monitorix in the un_install.sh\n  script.\n\t(thanks to Tamas Marki, tamas AT gnsdm.com)\n- Fixed to really accept more than three network devices. There were some parts\n  that were not correctly upgraded to five.\n        (thanks to Milos Prudek, prudek AT bvx.cz)\n- Added the parameter -w during the hddtemp call just to make sure that it will\n  awaken the disk (if needed).\n- Removed the .sh extension and the she-bang in the crond script for all Linux\n  distributions, although only in the Debian based ones people experienced\n  problems.\n- Added a new configuration option to disable the crond mail related to\n  Monitorix errors.\n\t(suggested by Detlef Neubauer, detlef.neubauer AT wzrz.de)\n- Fixed to include the \"Linux-Generic\" as a supported OSTYPE.\n- Fixed to include the monthly report files for the Italian language in the RPM\n  package.\n- Removed the htmlentity of the ampersand character introduced in the previous\n  version, as the last RRDtool version seems not complaining anymore.\n- Improved the way how the root filesystem device is detected including support\n  for the partitions with two digits like /dev/sda10.\n\t(suggested by Dimitri Yioulos, dyioulos AT firstbhph.com)\n\n\n1.2.1  - 01-Oct-2008\n====================\n- Added support for the new RRDtool 1.3 version.\n- Fixed the alignment of the MB & CPU temperatures graph legend.\n- Forced the font type to 'Mono' for the RRDtool 1.3 version.\n- Fixed one identifier to count better the total messages sent/received in\n  /var/log/maillog.\n- Added support for some virtualized systems where the rootfs device name does\n  not appears in /proc/diskstats and the only way to collect the i/o values is\n  using the partition device name.\n\t(thanks to Travis Wu, twu AT capitalsystems.com)\n- Added support for Linux software RAID devices of the form /dev/md/*.\n\t(thanks to an anonymous IRC user called 'emilio')\n- Added Italian language support in the monthly traffic report.\n\t(thanks to Luca Ferrario, luca AT ferrario.net)\n- Fixed the ampersand character to be an entity to avoid complaining messages\n  of Pango in the RRDtool 1.3 version.\n- Included the \"Linux-Generic\" OSTYPE key that for a strange reason it was\n  missing.\n- Fixed in the cover web page to only include the graphs that the system can\n  really offer. That will avoid to see more ethernets graphs than the number\n  of real ethernet devices and the same for the number of processors.\n\n\n1.2.0  - 02-Apr-2008\n====================\n- Added support for systems based on LVM structure on top of a CCISS RAID of\n  disk drives.\n\t(thanks to Bob McClure, Jr., bob AT bobcatos.com)\n- Removed the full path of the 'pvs' command as it complicates the portability\n  of Monitorix to other Linux distributions.\n\t(thanks to Eric, teknologist AT gmail.com)\n- Added the \"no warnings\" pragma to temporarily block warnings while calling\n  the 'sensors' command.\n- Fixed a bug introduced in the last version that prevented to see the interrupt\n  names on systems with 2.4 Linux kernels.\n- Fixed the graph of disk temperatures in order to preserve the page layout\n  when there's no defined any disk device in the HDDTEMP_LIST array.\n\t(thanks to Eric, teknologist AT gmail.com)\n- Fixed to tolerate if @HDDTEMP_LIST was badly defined with just a void entry\n  instead of no entries at all. That's if someone defined incorrectly the array\n  as @HDDTEMP_LIST = \"\"; instead of simply as @HDDTEMP_LIST;\n\t(thanks to Eric, teknologist AT gmail.com)\n- Removed the error messages when it has been defined in /etc/monitorix.conf a\n  network interface that it doesn't exist in the system.\n- Fixed the error message \"Use of uninitialized value in string eq at\n  /var/www/cgi-bin/monitorix.cgi line 454.\" that appeared in the Apache error\n  logs when using Multihost feature.\n\n\n1.1.2  - 25-Feb-2008\n====================\n- Added the execution of the \"pvs -a\" command each time Monitorix is restarted,\n  just to make sure to remove a strange message about \"Medium not found\"\n  appeared on fresh CentOS 5 installations using LVM.\n- Converted automatically into a link the URL that appears in the bottom of\n  each graph (if enabled by $MULTIHOST_FOOTER) in the Multihost mode.\n- Fixed to put the zero character instead of NULL when there's no value, in the\n  monthly file of traffic during the daily collecting of counters.\n- Fixed a bug in the interrupt names that removed its first character affecting\n  only (mostly old) machines with \"local-APIC-edge\" support.\n\n\n1.1.1  - 16-Nov-2007\n====================\n- Fixed a stupid bug that prevented showing the graphs of network ports.\n\n\n1.1.0  - 15-Nov-2007\n====================\n- Added support for Gentoo Linux distribution.\n\t(thanks to Matej Povazaj, ybdaba AT gmail.com)\n- Added support for Slackware Linux distribution.\n\t(thanks to Bogdan Radulescu, from http://nimblex.net>\n- Changed the way how is the data collected in the Kernel Usage graph. From now\n  on, this graph will show its data in a more accurated way than before. People\n  can continue using the Real and Stacked modes though.\n\t(thanks to Christian Meusel, christian.meusel AT inf.tu-dresden.de)\n- Definitely fixed (I really hope so) a persistent bug during the numeric\n  extraction of the alpha numeric string of the lm_sensors temperatures.\n- Fixed support for HP ML310 ProLiant server in the motherboard temperatures\n  graph.\n- Changed the main page form method from POST to GET in order to be able to\n  remove the old /cgi-bin/monitorix.cgi and call localhost.cgi directly.\n  So now on, the localhost.cgi is renamed as monitorix.cgi and it's placed in\n  the same place where it was the old one, removing the /cgi-bin/monitorix\n  directory as it will not longer be used.\n- Fixed to show the graph when using multihost feature and select only the\n  Context Switches graph.\n- Improved how are showed the images when using multihost feature selecting\n  only individual hosts. Now they are bigger.\n\n\n1.0.1  - 03-Oct-2007\n====================\n- Fixed some annoying messages like \"Argument \"+46M-BM-0C\" isn't numeric in int \n  at /usr/bin/monitorix.pl line > 2710, <SENSORS> line 13.\". Now it extracts\n  correctly numbers from an alpha numeric string.\n\t(thanks to Russell Morris, rmorris AT rkmorris.us)\n- Changed from area-based to line-based the HP IPL temperature graphs in order\n  to follow the same aspect than the new LM-Sensors graph.\n- Added a permanent \"lower-limit=0\" in the following graphs: Context Switches,\n  LM-Sensors, Network Packet Traffic and Network Error Traffic.\n- Fixed the alignment of the legend in the FAN speeds graph on systems still\n  using the old RRDtool branch version 1.0.\n\n\n1.0.0  - 04-Sep-2007\n====================\n- Added a new graph to see the temperatures of the system motherboard, CPUs,\n  fan speeds and hard disk drives using lm_sensors and the hddtemp tool. Such\n  graph is disabled by default since there are still a lot of motherboards with\n  unsupported sensors out there. This new graph can be combined with the HP\n  specific temperatures graph.\n- Fixed some adjustments in the temperatures collector in newer HP ProLiant\n  servers with newer IML.\n- Added the ability to select the percentages layout in the Kernel Usage\n  statistics. The possible options are (R)eal or (S)tacked.\n\t(suggested by Andrzej Pokrywko, Andrzej.Pokrywko AT onet.pl)\n- Fixed a bug that prevented to display correctly the interrupt names on newer\n  systems that use PCI-MSI instead of IO-APIC.\n- Added the ability to change the refresh rate value in the statistics web\n  page. The default value remains unchanged to 150 seconds.\n- Added some adjustments in the Monitorix init script.\n- Extended the environment variable PATH to cover more root directories.\n- Changed the default NET_RIGID from 2 to 0.\n- Changed the default network configuration from two interfaces to only one, as\n  it seems the most of people have only one network interface installed.\n- Removed some \"Use of uninitialized value ...\" annoying messages in the Apache\n  error_log.\n\n\n0.9.2  - 12-Jun-2007\n====================\n- Special Debian contribution.\n  + Added support for Debian distribution.\n  + Added the missing \"monitorixico.png\" file during the install process using\n    the install.sh shell-script.\n\t(thanks to Uwe Heidrich, uweheidrich AT hotmail.com)\n- Added German language support in the monthly report.\n\t(thanks to Uwe Heidrich, uweheidrich AT hotmail.com)\n- Added support for systems using Linux RAID systems under LVM.\n- Fixed in the localhost.cgi and in monitorix.pl files to not include a second\n  configuration file if the first one already exists.\n- Fixed the graphs legend lines adding blank lines in order to have a better\n  formatting. That only affected those who have RRDtool version above 1.2.13.\n- Added the Zoom feature that, when enabled, it will permits to see a larger\n  picture just clicking inside any graph image.\n\t(suggested by Dimitri Yioulos, dyioulos AT firstbhph.com)\n- Removed the degree symbol in all the temperature graphs.\n- Some little code cleanup.\n\n\n0.9.1  - 09-Jan-2007\n====================\n- Fixed some annoying cron messages about uninitialized value during an addition\n  and a multiplication, only on 2.4 kernels.\n- Fixed the line and area colors in the kernel-related new graphs.\n\n\n0.9.0  - 03-Jan-2007\n====================\n- Fixed the background color of the graphs in Multihost feature.\n- Added a lot of new colors to cover as many hardware interrupts as they exist.\n- Added the Monitorix shortcut icon.\n- Fixed a bad closing in the global <html> tag.\n- Fixed and optimized the start routine in the init script.\n- Added a new composed-graph to see the Linux kernel usage per processor. The\n  graph will be divided by three parts (as always) only using, right now, the\n  biggest and the first one of the last two. The graph will show the global\n  percentages of total user time, nice time, system time, idle time and io-wait\n  time and separately, the number of context switches. Finally if the system\n  has multiprocessors there will be an individual graph per processor showing\n  the percentages of its CPU times (up to 8 processors).\n\t(suggested by Michael Berger, MBerger AT scrippsops.com)\n- Added a configuration switch (Y/N) per graph to enable or disable its\n  processing. This will help specially on embedded systems (where there is not\n  much disk space) to monitorize only what it is really needed.\n- IMPORTANT NOTICE: The configuration file (/etc/monitorix.conf) has been\n  extended with important changes.\n\n\n0.8.3  - 16-Oct-2006\n====================\n- Added the word \"easier\" to the Monitorix slogan.\n- Added support for CCISS Compaq RAID driver under 2.6 Linux kernels.\n- Changed the color for the first mounted filesystem in the disk usage, now is\n  darker.\n- Changed all the white colors to gray in order to be more visible when using\n  the white theme.\n- Changed the Fax color (from white to orange).\n- Adjusted three colors in the interrupt activity graphs: from gray to orange,\n  from black to dark-gray and from white to light-gray.\n- Changed the color of the running processes (from dark blue to red).\n- Changed the HTML font from the Arial,Helvetica to Verdana,Tahoma, and switched\n  to lowercase all the HTML tags.\n- Fixed a problem when finding the root disk on LVM systems with multiple disks\n  on the same logical volume.\n\t(thanks to Bon, bon AT bugstudio.net)\n- Consolidated to only one internal function all temperature graphs concerning\n  to the Hewlett-Packard server models.\n- Fixed a broken image in the third temperature graph on some Hewlett-Packard\n  server models.\n- Added support for up to 255 hardware interrupts to take advantatge of the\n  APIC feature in newer Linux systems. The \"int.rrd\" database will be upgraded\n  automatically.\n- Because of the new support for so many interrupts, the interrupt graphs no\n  longer displays the unused ones.\n- Added support for up to 5 NICs. The \"net.rrd\" database will be upgraded\n  automatically.\n  \t(suggested by Mike Harris, MikeDawg AT addictz.org)\n- Removed the use of the generation number from the HP ProLiant servers, because\n  there are no differencies In the number of processors between the current\n  generations. Now the server names are changed from ML350G3 to simply ML350.\n\n\n0.8.2  - 04-Jul-2006\n====================\n- Changed from dark-gray to orange the color of the last mount point in the\n  disk usage graph.\n- Added error handling during the creation of the RRDs database files.\n- Fixed a graph creation error when trying to view the PC LANs on systems with\n  RRDtool v1.2+.\n- Fixed a graph creation error during the monthly report creation on systems\n  with RRDtool v1.2+.\n- Fixed to take care about the color selected when creating the monthly report\n  graphs.\n- Fixed a typo when cutting the last digit of $root_disk.\n\t(thanks to Christoph Fritsche, Christoph.Fritsche AT fh-telekom-leipzig.de)\n- Added the new parameter \"silent=imagetag\" which among of the image\n  generation it will return the HTML <IMG SRC> tag for the specified image.\n- Fixed the annoying old behaviour of the Multihost feature that obligates to\n  reload the page two times every time you want to see the most up to date\n  remote server graphs.\n- Some cosmetic changes.\n\n\n0.8.1  - 17-May-2006\n====================\n- Fixed problems while creating the ip counters when the network port variables\n  $PORT01, $PORT02, ... are removed or not defined in the configuration file.\n- Added better support for Linux Software RAID devices (/dev/md0, /dev/md1, ...).\n- Added specific colored logo images for black and white themes.\n- Optimized the way how are used the chomp() functions, using now multiple\n  arguments.\n- Optimized all the code that was using system commands to collect information.\n- Dramatically reduced the CPU load average on most systems specially on slow or\n  old systems. As an example of that, a Pentium at 133Mhz sees reduced to 50%\n  its CPU load.\n- More code cleaning.\n\n\n0.8.0  - 27-Mar-2006\n====================\n- Almost complete support for FreeBSD based systems.\n\t(thanks to Roger \"Rocky\" Vetterberg, roger AT vetterberg.com)\n\t(thanks to the twenty4help, http://www.twenty4help.com)\n- Code prepared to be more easily portable to other UNIX/Linux systems.\n- Changed the location of the configuration file to /etc/monitorix.conf.\n- Fixed a \"grep\" condition problem with LVM based systems not using LVM.\n\t(thanks to Yazhir, admin AT pazeng.co.il)\n- Fixed to escape more possible colons on interrupt device names.\n- Fixed graph font size for RRDtool versions 1.2+.\n- Better support for RRDtool version 1.2.\n- Fixed the counter of the amount of Samba locked files.\n- Better monitorization in the detection of VirusMail (requires MailScanner).\n- Improved the Active Processes graph, now includes the sleeping and running\n  processes in order to know better the amount of concurrent processes the\n  server has.\n- Now the cron file is automatically created taking care the OS usual paths.\n- Removed the default names for the unused interrupt devices. Now all the unused\n  interrupts will be marked as \"unused\".\n- Fixed the order of collected data in disk activity graphs.\n- More code cleaning and removed some unused variables.\n\n\n0.7.14 - 17-Jan-2006\n====================\n- Fixed to be more accurate the way how are detected the ports that are down.\n- Removing annoying cron messages and added again the locking mechanism.\n\n\n0.7.13 - 16-Jan-2006\n====================\n- Added an automatic space-padding control to the MNT_LIST mount points names.\n- Fixed \"val\" and \"mode\" declarations and added a hint into README file for\n  users coming from other Linux distributions.\n\t(thanks to Christoph Fritsche, s03315 AT fh-telekom-leipzig.de )\n- Really added the parameter \"-P\" in the \"df\" lines. In the previous version it\n  was only commented in the ChangeLog.\n- Added a new file in the /etc/httpd/conf.d/ which will make the alias\n  \"/monitorix\", and will facilitate the installation with different html root\n  directories.\n- Added an initial support for LVM (Logical Volume Manager) based systems.\n- Added a warning indicator (changing the color background to red) on the 12\n  port graphs for each selected port if it seems to be down.\n- Removed temporaly the locked mechanism introduced in the previous version\n  because it produces annoying cron messages everyday at midnight.\n- Some little code cleaning.\n\n\n0.7.12 - 07-Nov-2005\n====================\n- Fixed the stat() function that prevented to collect Samba and NetAtalk data.\n- Escape colons in Interrupt names (INT_NAME) for rrdtool 1.2 branch versions.\n\t(thanks to Marcos Andre, foca AT siagri.com.br)\n- Added the parameter \"-P\" in order to prevent multi-line output from \"df\".\n\t(thanks to Rene Kapeller, rene.kapeller AT psi.ch)\n- Added a locking mechanism to prevent concurrent executions of Monitorix, that\n  will be useful on very high loaded servers.\n\t(thanks to Rene Kapeller, rene.kapeller AT psi.ch)\n\n\n0.7.11 - 06-Oct-2005\n====================\n- Now the POP3 section is looking for pop3 string (not pop-3) in log entries.\n- It handles possible DNS no resolution for defined PC LANs.\n- Added English language support for the monthly reports.\n- Removed the PC_DS list. Monitorix only will use PC_LIST and PC_IP if needed.\n- Remove the hard-coded command paths in order to be more distro compatible.\n- Added some checks in order to warn if some directories or files can't be read.\n- Fix to escape only colons for rrdtool 1.2 branch versions.\n\n\n0.7.10 - 26-Sep-2005\n====================\n- Reduced the size of the Monitorix logo in the startup screen.\n- Finally fixed the problem with disk i/o on 2.6 kernels.\n- Fixed some incompatibilities in order to support RRDtool v1.2.\n\t(thanks to Alex Shiffer, refys AT zelacom.com)\n- Removed MONITORIX_VER variable from the configuration file.\n\n\n0.7.9  - 12-Sep-2005\n====================\n- Some cleanups in the Configuration.help file.\n- Remove annoying samba messages in cron when samba is not running.\n- Fixed bug when collecting disk i/o on kernels 2.6 (/proc/diskstats).\n\t(thanks to Alf Tanner, alf.tanner AT gmail.com)\n\n\n0.7.8  - 11-Sep-2005\n====================\n- Initial public release.\n\n", "#\n# Monitorix - A lightweight system monitoring tool.\n#\n# Copyright (C) 2005-2013 by Jordi Sanfeliu <jordi@fibranet.cat>\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; either version 2 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License along\n# with this program; if not, write to the Free Software Foundation, Inc.,\n# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n#\n\npackage HTTPServer;\n\nuse strict;\nuse warnings;\nuse Monitorix qw(trim);\nuse POSIX qw(strftime);\nuse HTTP::Server::Simple::CGI;\nuse base qw(HTTP::Server::Simple::CGI);\nuse MIME::Base64 qw(decode_base64);\nuse Socket;\n\nsub logger {\n\tmy ($url, $type) = @_;\n\n\tif(open(OUT, \">> $main::config{httpd_builtin}->{log_file}\")) {\n\t\tif($type eq \"OK\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] \\\"$ENV{REQUEST_METHOD} $url - $ENV{HTTP_USER_AGENT}\\\"\\n\";\n\t\t} elsif($type eq \"NOTEXIST\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] File does not exist: $url\\n\";\n\t\t} elsif($type eq \"AUTHERR\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] Authentication error: $url\\n\";\n\t\t} elsif($type eq \"NOTALLOWED\") {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] Access not allowed: $url\\n\";\n\t\t} else {\n\t\t\tprint OUT localtime() . \" - $type - [$ENV{REMOTE_ADDR}] $url\\n\";\n\t\t}\n\t\tclose(OUT);\n\t} else {\n\t\tprint STDERR localtime() . \" - ERROR: unable to open logfile '$main::config{httpd_builtin}->{log_file}'.\\n\";\n\t}\n}\n\nsub check_passwd {\n\tmy ($user, $pass) = @_;\n\n\tif(open(IN, $main::config{httpd_builtin}->{auth}->{htpasswd})) {\n\t\twhile(<IN>) {\n\t\t\tmy %pair = split(':', $_);\n\t\t\tif($pair{$user || \"\"}) {\n\t\t\t\tchomp($pair{$user});\n\t\t\t\tif(crypt($pass, $pair{$user}) ne $pair{$user}) {\n\t\t\t\t\tnext;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\tclose(IN);\n\t} else {\n\t\tprint STDERR localtime() . \" - ERROR: can't open file '$main::config{httpd_builtin}->{auth}->{htpasswd}'.\\n\";\n\t}\n\treturn 1;\n}\n\nsub ip_validity {\n\tmy ($myip, $hosts) = @_;\n\tmy $valid = 0;\n\n\tforeach my $address (split(',', $hosts)) {\n\t\tmy $myip_bin = inet_aton($myip);\n\n\t\t$address = \"0.0.0.0/0\" if $address eq \"all\";\n\t\tmy ($ip, $netmask) = split('/', trim($address) . \"/\");\n\t\tmy $ip_bin = inet_aton($ip);\n\n\t\t$netmask = \"255.255.255.255\" if $netmask eq \"\";\n\t\t$netmask = unpack(\"%32b*\", inet_aton($netmask)) if length($netmask) > 2;\n\t\tmy $netmask_bin = ~pack(\"N\", (2**(32-$netmask))-1);\n\n\t\tmy $first_valid = unpack(\"N\", $ip_bin & $netmask_bin) + ($netmask eq \"32\" ? 0 : 1);\n\t\tmy $last_valid = unpack(\"N\", $ip_bin | ~$netmask_bin) - ($netmask eq \"32\" ? 0 : 1);\n\n\t\t$myip_bin = unpack(\"N\", $myip_bin);\n\t\tif($myip_bin >= $first_valid && $myip_bin <= $last_valid) {\n\t\t\t$valid++;\n\t\t}\n\t}\n\treturn $valid;\n}\n\nsub http_header {\n\tmy ($code, $mimetype) = @_;\n\tmy $msg = $main::config{httpd_builtin}->{auth}->{msg} || \"\";\n\n\tif($code eq \"200\") {\n\t\tprint \"HTTP/1.0 200 OK\\r\\n\";\n\t} elsif($code eq \"401\") {\n\t\tmy (undef, $encoded_str) = split(' ', $ENV{HTTP_AUTHORIZATION} || \"\");\n\t\tmy ($user, $pass) = split(':', decode_base64($encoded_str || \":\"));\n\n\t\tif(check_passwd($user, $pass)) {\n\t\t\tprint \"HTTP/1.0 401 Access Denied\\r\\n\";\n\t\t\tprint \"WWW-Authenticate: Basic realm=\\\"$msg\\\"\\r\\n\";\n\t\t\tprint \"Content-Length: 0\\r\\n\";\n\t\t\tprint \"\\r\\n\";\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t} elsif($code eq \"404\") {\n\t\tprint \"HTTP/1.0 404 Not found\\r\\n\";\n\t} else {\n\t\tprint \"HTTP/1.0 403 Forbidden\\r\\n\";\n\t}\n\n\tprint \"Date: \" . strftime(\"%a, %d %b %Y %H:%M:%S %z\", localtime) . \"\\r\\n\";\n\tprint \"Server: Monitorix HTTP Server\\r\\n\";\n\tprint \"Connection: close\\r\\n\";\n\n\tif($mimetype =~ m/(html|cgi)/) {\n\t\tprint \"Content-Type: text/html; charset=UTF-8\\r\\n\";\n\t} else {\n\t\tprint \"Content-Type: image/$mimetype;\\r\\n\";\n\t}\n\n\tprint \"\\r\\n\";\n\treturn 0;\n}\n\nsub handle_request {\n\tmy ($self, $cgi) = @_;\n\tmy $base_url = $main::config{base_url};\n\tmy $base_cgi = $main::config{base_cgi};\n\tmy $host = $main::config{httpd_builtin}->{host} || \"localhost\";\n\tmy $port = $main::config{httpd_builtin}->{port} || \"8080\";\n\tmy $hosts_deny = $main::config{httpd_builtin}->{hosts_deny} || \"\";\n\tmy $hosts_allow = $main::config{httpd_builtin}->{hosts_allow} || \"\";\n\tmy $auth = lc($main::config{httpd_builtin}->{auth}->{enabled});\n\tmy $mimetype;\n\tmy $target;\n\tmy $target_cgi;\n\tmy @data;\n\tmy $OK_CHARS='-a-zA-Z0-9_./';\t# a restrictive list of valid chars\n\n\treturn if fork();\t# parent returns\n\n\tmy $url = $cgi->path_info();\n\t$0 = \"monitorix-httpd\";\t# change process' name\n\n\t# check if the IP address is allowed to connect\n\tmy $denied;\n\tmy $allowed = ip_validity($ENV{REMOTE_ADDR}, $hosts_allow);\n\t$denied = ip_validity($ENV{REMOTE_ADDR}, $hosts_deny) if !$allowed;\n\tif(!$allowed && $denied) {\n\t\thttp_header(\"403\", \"html\");\n\t\tprint \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\\r\\n\";\n\t\tprint \"<html><head>\\r\\n\";\n\t\tprint \"<title>403 Forbidden</title>\\r\\n\";\n\t\tprint \"</head><body>\\r\\n\";\n\t\tprint \"<h1>Forbidden</h1>\\r\\n\";\n\t\tprint \"<p>You don't have permission to access $url\\r\\n\";\n\t\tprint \"on this server.</p>\\r\\n\";\n\t\tprint \"<hr>\\r\\n\";\n\t\tprint \"<address>Monitorix HTTP Server listening at $host Port $port</address>\\r\\n\";\n\t\tprint \"</body></html>\\r\\n\";\n\t\tlogger($url, \"NOTALLOWED\");\n\t\texit(0);\n\t}\n\n\t# sanitizes the $target\n\t$target = $url;\n\twhile() {\n\t\tmy $cur = length($target);\n\t\t$target =~ s/\\.\\.\\///;\n\t\t$target =~ s/^\\///;\n\t\t$target =~ s/\\/$//;\n\t\tlast unless $cur ne length($target);\n\t}\n\t$target = $target_cgi = \"/$target\";\n\n\t$target =~ s/^$base_url//;\t# removes the 'base_url' part\n\t$target_cgi =~ s/^$base_cgi//;\t# removes the 'base_cgi' part\n\tif(!$target || $target eq $base_url) {\n\t\t$target = \"index.html\" unless $target;\n\t}\n\t($mimetype) = ($target =~ m/.*\\.(html|cgi|png)$/);\n\n\t$target =~ s/^\\/*//;\t\t# removes leading slashes\n\t$target_cgi =~ s/^\\/*//;\t# removes leading slashes\n\n\t$target =~ s/[^$OK_CHARS]/_/go;\t\t# only $OK_CHARS are allowed\n\t$target_cgi =~ s/[^$OK_CHARS]/_/go;\t# only $OK_CHARS are allowed\n\n\tif($target_cgi eq \"monitorix.cgi\") {\n\t\tchdir(\"cgi\");\n\t\topen(EXEC, \"./$target_cgi |\");\n\t\t@data = <EXEC>;\n\t\tclose(EXEC);\n\t} elsif($target) {\n\t\tif(open(IN, $target)) {\n\t\t\t@data = <IN>;\n\t\t\tclose(IN);\n\t\t}\n\t}\n\n\tif(scalar(@data)) {\n\t\tif($auth eq \"y\") {\n\t\t\tif(http_header(\"401\", $mimetype)) {\n\t\t\t\tprint \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\\r\\n\";\n\t\t\t\tprint \"<html><head>\\r\\n\";\n\t\t\t\tprint \"<title>401 Authorization Required</title>\\r\\n\";\n\t\t\t\tprint \"</head><body>\\r\\n\";\n\t\t\t\tprint \"<h1>Authorization Required</h1>\\r\\n\";\n\t\t\t\tprint \"<p>This server could not verify that you\\r\\n\";\n\t\t\t\tprint \"are authorized to access the document\\r\\n\";\n\t\t\t\tprint \"requested.  Either you supplied the wrong\\r\\n\";\n\t\t\t\tprint \"credentials (e.g., bad password), or your\\r\\n\";\n\t\t\t\tprint \"browser doesn't understand how to supply\\r\\n\";\n\t\t\t\tprint \"the credentials required.</p>\\r\\n\";\n\t\t\t\tprint \"</body></html>\\r\\n\";\n\t\t\t\tlogger($url, \"AUTHERR\");\n\t\t\t\texit(0);\n\t\t\t}\n\t\t}\n\t\thttp_header(\"200\", $mimetype);\n\t\tforeach(@data) {\n\t\t\tprint $_;\n\t\t}\n\t\tlogger($url, \"OK\");\n\t} else {\n\t\thttp_header(\"404\", \"html\");\n\t\tprint \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\\r\\n\";\n\t\tprint \"<html><head>\\r\\n\";\n\t\tprint \"<title>404 Not Found</title>\\r\\n\";\n\t\tprint \"</head><body>\\r\\n\";\n\t\tprint \"<h1>Not Found</h1>\\r\\n\";\n\t\tprint \"The requested URL $url was not found on this server.<p>\\r\\n\";\n\t\tprint \"<hr>\\r\\n\";\n\t\tprint \"<address>Monitorix HTTP Server listening at $host Port $port</address>\\r\\n\";\n\t\tprint \"</body></html>\\r\\n\";\n\t\tlogger($url, \"NOTEXIST\");\n\t}\n\n\texit(0);\n}\n\n1;\n"], "filenames": ["Changes", "lib/HTTPServer.pm"], "buggy_code_start_loc": [0, 150], "buggy_code_end_loc": [0, 197], "fixing_code_start_loc": [1, 151], "fixing_code_end_loc": [7, 202], "type": "CWE-74", "message": "The handle_request function in lib/HTTPServer.pm in Monitorix before 3.3.1 allows remote attackers to execute arbitrary commands via shell metacharacters in the URI.", "other": {"cve": {"id": "CVE-2013-7070", "sourceIdentifier": "cve@mitre.org", "published": "2019-12-31T20:15:11.137", "lastModified": "2020-01-09T19:00:22.263", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "The handle_request function in lib/HTTPServer.pm in Monitorix before 3.3.1 allows remote attackers to execute arbitrary commands via shell metacharacters in the URI."}, {"lang": "es", "value": "La funci\u00f3n handle_request en la biblioteca lib/HTTPServer.pm en Monitorix versiones anteriores a la versi\u00f3n 3.3.1, permite a atacantes remotos ejecutar comandos arbitrarios por medio de metacaracteres de shell en el URI."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fibranet:monitorix:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.3.1", "matchCriteriaId": "BD765DEE-B255-41B5-8A39-502B8891DD8B"}]}]}], "references": [{"url": "http://openwall.com/lists/oss-security/2013/12/12/8", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/mikaku/Monitorix/commit/ff80441be7089f774448dfe4b49e6fced70e71cb", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/mikaku/Monitorix/issues/30", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/mikaku/Monitorix/commit/ff80441be7089f774448dfe4b49e6fced70e71cb"}}