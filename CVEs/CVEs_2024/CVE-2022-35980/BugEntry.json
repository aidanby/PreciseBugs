{"buggy_code": ["## 2022-08-11 Version 2.2.0.0\n\nCompatible with OpenSearch 2.2.0\n\n### Test Fix\n\n* Abstract waitForInit to minimize duplication and improve test reliability ([#1935](https://github.com/opensearch-project/security/pull/1935))\n* Create a manually started workflow for bulk run of integration tests ([#1937](https://github.com/opensearch-project/security/pull/1937))\n\n### Maintenance\n\n* Update to Gradle 7.5 ([#1963](https://github.com/opensearch-project/security/pull/1963))\n* Increment version to 2.2.0.0 ([#1948](https://github.com/opensearch-project/security/pull/1948))\n* Force netty-transport-native-unix-common version ([#1945](https://github.com/opensearch-project/security/pull/1945))\n"], "fixing_code": ["## 2022-08-11 Version 2.2.0.0\n\nCompatible with OpenSearch 2.2.0\n\n### Enhancements\n\n* Adds a basic sanity test to run against a remote cluster ([#1958](https://github.com/opensearch-project/security/pull/1958))\n* Create a manually started workflow for bulk run of integration tests ([#1937](https://github.com/opensearch-project/security/pull/1937))\n\n### Bug Fixes\n\n* Use Collections.synchronizedSet and Collections.synchronizedMap for roles, securityRoles and attributes in User ([#1970](https://github.com/opensearch-project/security/pull/1970))\n\n### Maintenance\n\n* Update to Gradle 7.5 ([#1963](https://github.com/opensearch-project/security/pull/1963))\n* Increment version to 2.2.0.0 ([#1948](https://github.com/opensearch-project/security/pull/1948))\n* Force netty-transport-native-unix-common version ([#1945](https://github.com/opensearch-project/security/pull/1945))\n* Add release notes for 2.2.0.0 release ([#1974](https://github.com/opensearch-project/security/pull/1974))\n* Staging for version increment automation ([#1932](https://github.com/opensearch-project/security/pull/1932))\n* Fix breaking API change introduced in Lucene 9.3.0 ([#1988](https://github.com/opensearch-project/security/pull/1988))\n* Update indices resolution to be clearer ([#1999](https://github.com/opensearch-project/security/pull/1999))\n\n### Refactoring\n\n* Abstract waitForInit to minimize duplication and improve test reliability ([#1935](https://github.com/opensearch-project/security/pull/1935))\n"], "filenames": ["release-notes/opensearch-security.release-notes-2.2.0.0.md"], "buggy_code_start_loc": [5], "buggy_code_end_loc": [14], "fixing_code_start_loc": [5], "fixing_code_end_loc": [27], "type": "NVD-CWE-Other", "message": "OpenSearch Security is a plugin for OpenSearch that offers encryption, authentication and authorization. Versions 2.0.0.0 and 2.1.0.0 of the security plugin are affected by an information disclosure vulnerability. Requests to an OpenSearch cluster configured with advanced access control features document level security (DLS), field level security (FLS), and/or field masking will not be filtered when the query's search pattern matches an aliased index. OpenSearch Dashboards creates an alias to `.kibana` by default, so filters with the index pattern of `*` to restrict access to documents or fields will not be applied. This issue allows requests to access sensitive information when customer have acted to restrict access that specific information. OpenSearch 2.2.0, which is compatible with OpenSearch Security 2.2.0.0, contains the fix for this issue. There is no recommended work around.", "other": {"cve": {"id": "CVE-2022-35980", "sourceIdentifier": "security-advisories@github.com", "published": "2022-08-12T18:15:13.510", "lastModified": "2022-08-16T15:32:31.143", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "OpenSearch Security is a plugin for OpenSearch that offers encryption, authentication and authorization. Versions 2.0.0.0 and 2.1.0.0 of the security plugin are affected by an information disclosure vulnerability. Requests to an OpenSearch cluster configured with advanced access control features document level security (DLS), field level security (FLS), and/or field masking will not be filtered when the query's search pattern matches an aliased index. OpenSearch Dashboards creates an alias to `.kibana` by default, so filters with the index pattern of `*` to restrict access to documents or fields will not be applied. This issue allows requests to access sensitive information when customer have acted to restrict access that specific information. OpenSearch 2.2.0, which is compatible with OpenSearch Security 2.2.0.0, contains the fix for this issue. There is no recommended work around."}, {"lang": "es", "value": "OpenSearch Security es un plugin para OpenSearch que ofrece cifrado, autenticaci\u00f3n y autorizaci\u00f3n. Las versiones 2.0.0.0 y 2.1.0.0 del plugin de seguridad est\u00e1n afectadas por una vulnerabilidad de divulgaci\u00f3n de informaci\u00f3n. Las peticiones a un cl\u00faster de OpenSearch configurado con las funciones de control de acceso avanzado de seguridad a nivel de documento (DLS), seguridad a nivel de campo (FLS) y/o enmascaramiento de campos no son filtradas cuando el patr\u00f3n de b\u00fasqueda de la consulta coincida con un \u00edndice de alias. OpenSearch Dashboards crea un alias a \".kibana\" por defecto, por lo que los filtros con el patr\u00f3n de \u00edndice de \"*\" para restringir el acceso a documentos o campos no ser\u00e1n aplicados. Este problema permite que las peticiones accedan a informaci\u00f3n confidencial cuando el cliente ha actuado para restringir el acceso a esa informaci\u00f3n espec\u00edfica. OpenSearch versi\u00f3n 2.2.0, que es compatible con OpenSearch Security versi\u00f3n 2.2.0.0, contiene la correcci\u00f3n de este problema. No se presenta ninguna mitigaci\u00f3n recomendada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-612"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:amazon:opensearch:2.0.0:*:*:*:*:docker:*:*", "matchCriteriaId": "C945CD2E-F116-4E29-A8B0-1093165EB9E9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:amazon:opensearch:2.1.0:*:*:*:*:docker:*:*", "matchCriteriaId": "EF025C8F-AFEB-47E4-A540-95949DBEA74B"}]}]}], "references": [{"url": "https://github.com/opensearch-project/security/commit/7eaaafec2939d7db23a02ffca9cc68e0343de246", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/opensearch-project/security/pull/1999", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/opensearch-project/security/security/advisories/GHSA-f4qr-f4xx-hjxw", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/opensearch-project/security/commit/7eaaafec2939d7db23a02ffca9cc68e0343de246"}}