{"buggy_code": ["package ejbs;\n\nimport java.util.List;\n\nimport javax.ejb.Stateless;\nimport javax.persistence.EntityManager;\nimport javax.persistence.PersistenceContext;\nimport javax.persistence.Query;\n\nimport common.News;\n\n/**\n * Session Bean implementation class NewsBean\n */\n@Stateless\npublic class NewsBean implements NewsBeanRemote {\n\t\n\t@PersistenceContext(name = \"TestPersistence\")\n\tprivate EntityManager em;\n\n    /**\n     * Default constructor. \n     */\n    public NewsBean() {\n        // TODO Auto-generated constructor stub\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar todas as not\ufffdcias\n     * @return lista de not\ufffdcias\n     */\n    public List<News> getNews(){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n\");\n    \t\n    \t @SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n   \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias ordenadas por data (+ recentes primeiro)\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsSortedByDate(String region){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n WHERE region = :r ORDER BY date DESC\");\n    \tquery.setParameter(\"r\", region);\n    \t\n    \t @SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias de um autor\n     * @param author\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsFromAuthor(String author){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n INNER JOIN n.authors a WHERE a.name LIKE :author ORDER BY date DESC\");\n    \tquery.setParameter(\"author\", author);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias de um autor\n     * @param author\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsFromAuthor(String author, String region){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n INNER JOIN n.authors a WHERE n.region LIKE :r AND a.name LIKE :author ORDER BY date DESC\");\n    \tquery.setParameter(\"r\", region);\n    \tquery.setParameter(\"author\", author);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias mais recentes que uma data\n     * @param date\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsMoreRecentThan(String date){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n WHERE n.date > :d ORDER BY date DESC\");\n    \tquery.setParameter(\"d\", date);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    public List<News> newsMoreRecentThan(String date, String region){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n WHERE n.region LIKE :r AND n.date > :d ORDER BY date DESC\");\n    \tquery.setParameter(\"r\", region);\n    \tquery.setParameter(\"d\", date);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias em que os highlights t\ufffdm uma determinada palavra.\n     * @param word\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsWithHighlightWord(String word){\n    \t//String query = \"SELECT n FROM News n INNER JOIN n.highlights h WHERE h LIKE '%\"+word+\"%' ORDER BY date DESC\";\n    \tString query = \"select * from news n \"\n    \t\t\t+ \"inner join newshighlights h on n.newsid=h.newsid and h.highlight like '%murder%' order by date desc\";\n    \tList<News> news = null;\n    \t\n    \t\n    \t//news = (List<News>) em.createQuery(query).getResultList();\n    \t news = (List<News>) em.createNativeQuery(query).getResultList();\n    \t\n\t\treturn news;\n    }\n}\n", "<%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\" pageEncoding=\"ISO-8859-1\"%>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<%@page import=\"java.util.List\"%>\n<%@page import=\"java.util.ArrayList\"%>\n<%@page import=\"common.News\"%>\n<%@page import=\"common.User\"%>\n<%@page import=\"ejbs.NewsBeanRemote\"%>\n<%@page import=\"javax.naming.InitialContext\" %>\n<%@taglib uri=\"http://java.sun.com/jsp/jstl/core\" prefix=\"c\" %>\n<%@taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\" %>\n<%@taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\" %>\n\n<html>\n\t<head>\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n\t<title>CNN News - All the news</title>\n\t\n\t<!-- BOOTSTRAP -->\n\t<link href=\"bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t<link href=\"bootstrap/css/font-awesome.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t<link href=\"bootstrap/css/style.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/dropdown.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/transition.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/collapse.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/bootstrap.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/bootstrap.min.js\"></script>\n\t\n\t</head>\n\t<body>\n\t\t<jsp:include page=\"auth_verification.jsp\"></jsp:include>\n\t\t\n\t\t<!-- HEADER -->\n\t\t<nav class=\"navbar navbar-default\" role=\"navigation\">\n\t\t\t<div class=\"container\">\n\t\t\t\t<!-- Logo CNN -->\n\t\t\t\t<div class=\"navbar-header\">\n\t\t\t\t\t<button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-menu\">\n\t\t\t\t\t\t<i class=\"icon-reorder\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a class=\"navbar-brand\" href=\"Menu.jsp\"><img src=\"bootstrap/img/cnn_logo.gif\"/></a>\n\t\t\t\t</div>\n\t\t\t\t<!-- Informa\u00e7\u00e3o do utilizador -->\n\t\t\t\t<%  \n\t\t\t\t\tUser userdata = (User) session.getAttribute(\"user\");\n\t\t        %>\n\t\t\t\t<div class=\"collapse navbar-collapse navbar-menu\">\n\t\t\t\t\t<div class=\"nav navbar-nav navbar-right\">\n\t\t\t\t\t\t<ul class=\"nav navbar-nav navbar-right\">\n\t\t\t\t\t\t\t<li><a href=\"#US\">US</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#AFRICA\">AFRICA</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#ASIA\">ASIA</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#EUROPE\">EUROPE</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#LATINAMERICA\">LATIN AMERICA</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#MIDDLEEAST\">MIDDLE EAST</a></li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class=\"btn-group\">\n\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">\n\t\t\t\t\t\t\t\t    \tLogged as <strong><%= userdata.getUsername() %></strong> <span class=\"caret\"></span>\n\t\t\t\t\t\t\t\t  \t</button>\n\t\t\t\t\t\t\t\t  \t<ul class=\"dropdown-menu\" role=\"menu\">\n\t\t\t\t\t\t\t\t\t    <li><a href=\"EditProfile.jsp\">Edit profile</a></li>\n\t\t\t\t\t\t\t\t\t    <li><a href=\"DeleteAccount.jsp\">Delete account</a></li>\n\t\t\t\t\t\t\t\t\t    <li class=\"divider\"></li>\n\t\t\t\t\t\t\t\t\t    <li><a href=\"Logout.jsp\">Logout</a></li>\n\t\t\t\t\t\t\t\t  \t</ul>\n\t\t\t\t\t\t\t  \t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n\n\t\t<%  \n        \tNewsBeanRemote newsbean = (NewsBeanRemote) session.getAttribute(\"newsBean\");\n\t        \n\t        List<String> regioes = new ArrayList<String>(); // Lista de regi\u00f5es\n\t        List<News> allNews = newsbean.getNews(); // Lista de not\u00edcias\n\t        \n\t        // Percorrer lista de not\u00edcias para preencher lista de regi\u00f5es\n\t        for(int i=0; i<allNews.size();i++){\n\t        \tif(!regioes.contains(allNews.get(i).getRegion())){\n\t        \t\tregioes.add(allNews.get(i).getRegion());\n\t        \t}\n\t        }\n\t       \t\n\t        // Para cada regi\u00e3o, apresenta as not\u00edcias ordenadas por data (as mais recentes primeiro)\n\t        for(int j=0; j<regioes.size(); j++){\n\t        \tList<News> news = newsbean.newsSortedByDate(regioes.get(j));\n\t        \tpageContext.setAttribute(\"newsList\", news);\n\t        \t//Integer count = new Integer(news.get(j).getAuthors().size());\n\t        \t//pageContext.setAttribute(\"count\", count);\n        %>\n        \n        <!-- CONTEUDO -->\n        \t\t<!-- Regi\u00e3o -->\n\t\t\t\t<h1 id=\"<%= regioes.get(j) %>\"><%= regioes.get(j) %></h1>\n\t\t\t\t<div class=\"panel-group\" id=\"accordion\">\n\t\t\t\t\t<!-- Not\u00edcias -->\n\t\t\t\t    <c:forEach var=\"news\" items=\"${newsList}\" varStatus=\"status\">\n\t\t\t\t\t\t<div class=\"panel panel-default\">\n\t\t\t\t\t\t\t<div class=\"panel-heading\">\n\t\t\t\t\t\t\t\t<!-- T\u00edtulo da not\u00edcia -->\n\t\t\t\t\t\t\t\t<h3 class=\"panel-title\">\n\t\t\t\t\t\t\t\t    <a class=\"accordion-toggle\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse${news.region}${status.index}\">\n\t\t\t\t\t\t\t\t    \t<c:out value=\"${news.title}\"/>\n\t\t\t\t\t\t\t\t    </a>\n\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div id=\"collapse${news.region}${status.index}\" class=\"panel-collapse collapse\">\n\t\t\t\t\t\t\t\t<div class=\"panel-body\">\n\t\t\t\t\t\t\t\t\t<!-- Autor(es) -->\n\t\t\t\t\t\t\t\t\t<!-- \n\t\t\t\t\t\t\t\t\t<c:set var=\"string2\" value=\"This is second String.\"/>\n\t\t\t\t\t\t\t\t\t<c:set var=\"numAuthors\" value=\"${fn:length(string2)}\"/>\n\t\t\t\t\t\t\t\t\t<p>Length of String (2) : ${numAuthors}</p>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t  \t\t<c:if test=\"${numAuthors > 0}\">\n \t\t\t\t\t\t\t  \t\t\tby \n\t\t\t\t\t\t\t\t  \t\t<c:choose>\n\t\t\t\t\t\t\t\t\t\t\t<c:when test=\"${numAuthors==1}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<b><c:out value=\"${news.authors[0]}\"/></b>,\n\t\t\t\t\t\t\t\t\t\t\t</c:when>\n\t\t\t\t\t\t\t\t\t\t\t<c:when test=\"${numAuthors==2}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<b><c:out value=\"${news.authors[0]}\"/></b> and <b><c:out value=\"${news.authors[1]}\"/></b>,\n\t\t\t\t\t\t\t\t\t\t\t</c:when >\n\t\t\t\t\t\t\t\t\t\t\t<c:otherwise>\n\t\t\t\t\t\t\t\t\t\t\t\t<b><c:out value=\"${news.authors[0]}\"/></b>, <b><c:out value=\"${news.authors[1]}\"/></b> and <b>c:out value=\"${news.authors[2]}\"/></b>,\n\t\t\t\t\t\t\t\t\t\t\t</c:otherwise>\n\t\t\t\t\t\t\t\t\t\t</c:choose>\n\t\t\t\t\t\t\t\t\t</c:if>\n\t\t\t\t\t\t\t\t\t -->\n\t\t\t\t\t\t\t\t\t<!-- Data -->\n \t\t\t\t\t\t\t\t\ton \n \t\t\t\t\t\t\t\t\t<fmt:formatDate pattern=\"yyyy/MM/dd HH:mm\" value=\"${news.date}\" />\n\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t<!-- Highlights -->\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<c:forEach var=\"highlight\" items=\"${news.highlights}\" varStatus=\"hlstatus\">\n\t\t\t\t\t\t\t    \t\t\t<li><c:out value=\"${highlight}\"/></li>\n\t\t\t\t\t\t\t    \t\t</c:forEach>\n\t\t\t\t\t\t\t\t    </ul>\n\t\t\t\t\t\t\t\t\t<!-- Foto -->\n\t\t\t\t\t\t\t    \t<div class=\"row\"> \n\t\t\t\t\t\t\t\t\t  \t<div class=\"col-xs-5\"> \n\t\t\t\t\t\t\t\t\t  \t\t<c:if test=\"${news.photoURL != ''}\">\n\t\t\t\t\t\t\t\t  \t\t\t\t<a href=\"${news.photoURL}\" class=\"thumbnail\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t      \t\t<img src=\"${news.photoURL}\"/>\n\t\t\t\t\t\t\t\t\t\t    \t</a>\n\t\t\t\t\t\t\t\t\t  \t\t</c:if>\n\t\t\t\t\t\t\t\t  \t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<!-- Video -->\n\t\t\t\t\t\t\t\t\t<div class=\"video\">\n\t\t\t\t\t\t\t\t\t\t<c:if test=\"${news.videoURL != ''}\">\n\t\t\t\t\t\t\t\t  \t\t\t<a class=\"btn btn-primary btn-lg\" role=\"button\" href=\"${news.videoURL}\" target=\"_blank\"><span class=\"glyphicon glyphicon-film\"></span> Video</a>\n\t\t\t\t\t\t\t\t  \t\t</c:if>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t\t<!-- Texto da not\u00edcia -->\n\t\t\t\t\t\t\t\t\t<div class=\"texto\">\n\t\t\t\t\t\t\t\t\t\t<c:out value=\"${news.text}\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t\t<!-- Fonte -->\n\t\t\t\t\t\t\t\t\t<div class=\"source\">\n\t\t\t\t\t\t\t\t\t\tSource: <a href=\"${news.url}\" style=\"color: #FF0000\" target=\"_blank\">CNN</a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t</c:forEach>\n\t\t\t\t</div>\n\t\t\t\t<% } %>\n        \n\t</body>\n</html>", "<%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\" pageEncoding=\"ISO-8859-1\"%>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<%@page import=\"java.util.List\"%>\n<%@page import=\"java.util.ArrayList\"%>\n<%@page import=\"common.News\"%>\n<%@page import=\"common.User\"%>\n<%@page import=\"ejbs.NewsBeanRemote\"%>\n<%@page import=\"javax.naming.InitialContext\" %>\n\n<html>\n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n\t\t<title>CNN News - News more recent than</title>\n\t\t\n\t\t<!-- BOOTSTRAP -->\n\t\t<link href=\"bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/font-awesome.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/style.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"></script>\n\t\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/dropdown.js\"></script>\n\t\t\n\t</head>\n\t<body>\n\t\t<jsp:include page=\"auth_verification.jsp\"></jsp:include>\n\t\t\n\t\t<!-- HEADER -->\n\t\t<nav class=\"navbar navbar-default\" role=\"navigation\">\n\t\t\t<div class=\"container\">\n\t\t\t\t<!-- Logo CNN -->\n\t\t\t\t<div class=\"navbar-header\">\n\t\t\t\t\t<button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-menu\">\n\t\t\t\t\t\t<i class=\"icon-reorder\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a class=\"navbar-brand\" href=\"Menu.jsp\"><img src=\"bootstrap/img/cnn_logo.gif\"/></a>\n\t\t\t\t</div>\n\t\t\t\t<!-- Informa\u00e7\u00e3o do utilizador -->\n\t\t\t\t<%  \n\t\t\t\t\tUser userdata = (User) session.getAttribute(\"user\");\n\t\t        %>\n\t\t\t\t<div class=\"btn-group nav navbar-nav navbar-right\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">\n\t\t\t\t    \tLogged as <strong><%= userdata.getUsername() %></strong> <span class=\"caret\"></span>\n\t\t\t\t  \t</button>\n\t\t\t\t  \t<ul class=\"dropdown-menu\" role=\"menu\">\n\t\t\t\t\t    <li><a href=\"EditProfile.jsp\">Edit profile</a></li>\n\t\t\t\t\t    <li><a href=\"DeleteAccount.jsp\">Delete account</a></li>\n\t\t\t\t\t    <li class=\"divider\"></li>\n\t\t\t\t\t    <li><a href=\"Logout.jsp\">Logout</a></li>\n\t\t\t\t  \t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n\t\t\n\t\t<% \n\t\t\tString date = session.getAttribute(\"date\").toString();\n\t\t%>\n\t\t<h1>News more recent than <%= date %></h1>\n\t\t\n\t\t<%  \n        \tNewsBeanRemote newsbean = (NewsBeanRemote) session.getAttribute(\"newsBean\");\n\t        \n\t        List<String> regioes = new ArrayList<String>();\n\t        List<News> newsDate = newsbean.newsMoreRecentThan(date);\n\t        \n\t        for(int i=0; i<newsDate.size();i++){\n\t        \tif(!regioes.contains(newsDate.get(i).getRegion())){\n\t        \t\tregioes.add(newsDate.get(i).getRegion());\n\t        \t}\n\t        }\n\t        \n\t        for(int j=0; j<regioes.size(); j++){\n\t        \tList<News> newsDateRegion = newsbean.newsMoreRecentThan(date, regioes.get(j));\n        %>\n\t\t\t\t<h3><%= regioes.get(j) %></h3>\n\t\t\t\t<table border=\"1\" align=\"center\">\n\t\t            <tr>\n\t\t                <th>Title</th>\n\t\t                <th>url</th>\n\t\t            </tr>\n\t\t            <%  \t\n\t\t            \tfor(int i=0; i<newsDateRegion.size(); i++){ \n\t\t            %>\n\t\t            <tr>\n\t\t                <td> <%= newsDateRegion.get(i).getTitle() %> </td>\n\t\t                <td align=\"center\"> <%= newsDateRegion.get(i).getUrl() %> </td>\n\t\t            </tr>\n\t\t            <%\n\t\t                }\n\t\t            %>\n\t\t        </table>\n\t\t        <% } %>\n        \n\t</body>\n</html>", "<%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\" pageEncoding=\"ISO-8859-1\"%>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<%@page import=\"common.User\"%>\n\n<html>\n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n\t\t<title>CNN - Main Menu</title>\n\t\t\n\t\t<!-- BOOTSTRAP -->\n\t\t<link href=\"bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/font-awesome.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/style.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"></script>\n\t\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/dropdown.js\"></script>\n\t\t\n\t\t<!-- VERIFICA\u00c7\u00c3O DOS CAMPOS DO FORMUL\u00c1RIO -->\n\t\t<script type=\"text/javascript\" language=\"javascript\">\n            function validateForm(campo) {\n            \tif(campo == 'author'){\n\t                if (document.getElementById(\"authorName\").value == \"\") {\n\t                    alert(\"Author's name not defined\");\n\t                    document.getElementById(\"authorName\").focus();\n\t                    return false;\n\t                }\n\t                else{\n\t                    document.getElementById(\"login_form\").submit();\n\t                }\n\t            }\n            \telse if(campo == 'word'){\n            \t\tif (document.getElementById(\"word\").value == \"\") {\n\t                    alert(\"Word not defined\");\n\t                    document.getElementById(\"word\").focus();\n\t                    return false;\n\t                }\n\t                else{\n\t                    document.getElementById(\"login_form\").submit();\n\t                }\n            \t}\n            \telse if(campo == 'date'){\n            \t\tif (document.getElementById(\"date\").value == \"\") {\n\t                    alert(\"Date not defined\");\n\t                    document.getElementById(\"date\").focus();\n\t                    return false;\n\t                }\n\t                else{\n\t                    document.getElementById(\"login_form\").submit();\n\t                }\n            \t}\n            }\n            \n            function confirmar(){\n            \tvar txt;\n                var r = confirm(\"Are you sure you want to delete your account?\\nPress Ok to delete, Cancel to quit!\");\n                if (r == true) {\n                    txt = \"Ok\";\n                    document.location.href=\"DeleteAccountServlet\";\n                } else {\n                    txt = \"Cancel\";\n                }\n            }\n        </script>\n\t\n\t</head>\n\t\n\t<body>\n\t\t<jsp:include page=\"auth_verification.jsp\"></jsp:include>\n\t\n\t\t<!-- HEADER -->\n\t\t<nav class=\"navbar navbar-default\" role=\"navigation\">\n\t\t\t<div class=\"container\">\n\t\t\t\t<!-- Logo CNN -->\n\t\t\t\t<div class=\"navbar-header\">\n\t\t\t\t\t<button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-menu\">\n\t\t\t\t\t\t<i class=\"icon-reorder\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a class=\"navbar-brand\" href=\"#\"><img src=\"bootstrap/img/cnn_logo.gif\"/></a>\n\t\t\t\t</div>\n\t\t        <!-- Informa\u00e7\u00e3o do utilizador -->\n\t\t\t\t<%  \n\t\t\t\t\tUser userdata = (User) session.getAttribute(\"user\");\n\t\t        %>\n\t\t\t\t<div class=\"btn-group nav navbar-nav navbar-right\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">\n\t\t\t\t    \tLogged as <strong><%= userdata.getUsername() %></strong> <span class=\"caret\"></span>\n\t\t\t\t  \t</button>\n\t\t\t\t  \t<ul class=\"dropdown-menu\" role=\"menu\">\n\t\t\t\t\t    <li><a href=\"EditProfile.jsp\">Edit profile</a></li>\n\t\t\t\t\t    <li><a onclick=\"return confirmar()\">Delete account</a></li>\n\t\t\t\t\t    <li class=\"divider\"></li>\n\t\t\t\t\t    <li><a href=\"Logout.jsp\">Logout</a></li>\n\t\t\t\t  \t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n\t\t\n\t\t<h1>Welcome to CNN News</h1>\n\t\t\n\t\t<div>\n            <a href=\"AllNews.jsp\">\n                List all the news\n            </a>\n        </div>\n        \n        <form action=\"AuthorNewsServlet\" method=\"POST\" id=\"login_form\" onsubmit=\"return validateForm('author')\">\n\t\t\t\t<p>\n\t\t\t\t\tList news from <input type=\"text\" name=\"authorName\" id=\"authorName\" />\n\t\t\t\t\t<input type=\"SUBMIT\" value=\"Ok\" />\n\t\t\t\t</p>\n\t\t</form>\n        \n        <form action=\"DateNewsServlet\" method=\"GET\" id=\"login_form\" onsubmit=\"return validateForm('date')\">\n\t\t\t\t<p>\n\t\t\t\t\tList news more recent than <input type=\"text\" name=\"date\" id=\"date\" />\n\t\t\t\t\t<input type=\"SUBMIT\" value=\"Ok\" />\n\t\t\t\t</p>\n\t\t</form>\n        \n\t\t<form action=\"HighlightNewsServlet\" method=\"POST\" id=\"login_form\" onsubmit=\"return validateForm('word')\">\n\t\t\t\t<p>\n\t\t\t\t\tList news which highlights contains <input type=\"text\" name=\"word\" id=\"word\" />\n\t\t\t\t\t<input type=\"SUBMIT\" value=\"Ok\" />\n\t\t\t\t</p>\n\t\t</form>\n\t\t\n\t</body>\n</html>"], "fixing_code": ["package ejbs;\n\nimport java.util.List;\n\nimport javax.ejb.Stateless;\nimport javax.persistence.EntityManager;\nimport javax.persistence.PersistenceContext;\nimport javax.persistence.Query;\n\nimport common.News;\n\n/**\n * Session Bean implementation class NewsBean\n */\n@Stateless\npublic class NewsBean implements NewsBeanRemote {\n\t\n\t@PersistenceContext(name = \"TestPersistence\")\n\tprivate EntityManager em;\n\n    /**\n     * Default constructor. \n     */\n    public NewsBean() {\n        // TODO Auto-generated constructor stub\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar todas as not\ufffdcias\n     * @return lista de not\ufffdcias\n     */\n    public List<News> getNews(){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n\");\n    \t\n    \t @SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n   \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias ordenadas por data (+ recentes primeiro)\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsSortedByDate(String region){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n WHERE region = :r ORDER BY date DESC\");\n    \tquery.setParameter(\"r\", region);\n    \t\n    \t @SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias de um autor\n     * @param author\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsFromAuthor(String author){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n INNER JOIN n.authors a WHERE a.name LIKE :author ORDER BY date DESC\");\n    \tquery.setParameter(\"author\", author);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias de um autor\n     * @param author\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsFromAuthor(String author, String region){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n INNER JOIN n.authors a WHERE n.region LIKE :r AND a.name LIKE :author ORDER BY date DESC\");\n    \tquery.setParameter(\"r\", region);\n    \tquery.setParameter(\"author\", author);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias mais recentes que uma data\n     * @param date\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsMoreRecentThan(String date){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n WHERE n.date > '\"+date+\"' ORDER BY date DESC\");\n    \t//query.setParameter(\"d\", date);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    public List<News> newsMoreRecentThan(String date, String region){\n    \tQuery query = em.createQuery(\"SELECT n FROM News n WHERE n.region LIKE :r AND n.date > '\"+date+\"' ORDER BY date DESC\");\n    \tquery.setParameter(\"r\", region);\n    \t//query.setParameter(\"d\", date);\n    \t\n    \t@SuppressWarnings(\"unchecked\")\n\t\tList<News> news = query.getResultList();\n    \t\n\t\treturn news;\n    }\n    \n    \n    /**\n     * M\ufffdtodo para ir buscar as not\ufffdcias em que os highlights t\ufffdm uma determinada palavra.\n     * @param word\n     * @return lista de not\ufffdcias ordenadas\n     */\n    public List<News> newsWithHighlightWord(String word){\n    \t//String query = \"SELECT n FROM News n INNER JOIN n.highlights h WHERE h LIKE '%\"+word+\"%' ORDER BY date DESC\";\n    \tString query = \"select * from news n \"\n    \t\t\t+ \"inner join newshighlights h on n.newsid=h.newsid and h.highlight like '%murder%' order by date desc\";\n    \tList<News> news = null;\n    \t\n    \t\n    \t//news = (List<News>) em.createQuery(query).getResultList();\n    \t news = (List<News>) em.createNativeQuery(query).getResultList();\n    \t\n\t\treturn news;\n    }\n}\n", "<%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\" pageEncoding=\"ISO-8859-1\"%>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<%@page import=\"java.util.List\"%>\n<%@page import=\"java.util.ArrayList\"%>\n<%@page import=\"common.News\"%>\n<%@page import=\"common.User\"%>\n<%@page import=\"ejbs.NewsBeanRemote\"%>\n<%@page import=\"javax.naming.InitialContext\" %>\n<%@taglib uri=\"http://java.sun.com/jsp/jstl/core\" prefix=\"c\" %>\n<%@taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\" %>\n<%@taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\" %>\n\n<html>\n\t<head>\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n\t<title>CNN News - All the news</title>\n\t\n\t<!-- BOOTSTRAP -->\n\t<link href=\"bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t<link href=\"bootstrap/css/font-awesome.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t<link href=\"bootstrap/css/style.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/dropdown.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/transition.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/collapse.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/bootstrap.js\"></script>\n\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/bootstrap.min.js\"></script>\n\t\n\t</head>\n\t<body>\n\t\t<jsp:include page=\"auth_verification.jsp\"></jsp:include>\n\t\t\n\t\t<!-- HEADER -->\n\t\t<nav class=\"navbar navbar-default\" role=\"navigation\">\n\t\t\t<div class=\"container\">\n\t\t\t\t<!-- Logo CNN -->\n\t\t\t\t<div class=\"navbar-header\">\n\t\t\t\t\t<button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-menu\">\n\t\t\t\t\t\t<i class=\"icon-reorder\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a class=\"navbar-brand\" href=\"Menu.jsp\"><img src=\"bootstrap/img/cnn_logo.gif\"/></a>\n\t\t\t\t</div>\n\t\t\t\t<!-- Informa\u00e7\u00e3o do utilizador -->\n\t\t\t\t<%  \n\t\t\t\t\tUser userdata = (User) session.getAttribute(\"user\");\n\t\t        %>\n\t\t\t\t<div class=\"collapse navbar-collapse navbar-menu\">\n\t\t\t\t\t<div class=\"nav navbar-nav navbar-right\">\n\t\t\t\t\t\t<ul class=\"nav navbar-nav navbar-right\">\n\t\t\t\t\t\t\t<li><a href=\"#US\">US</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#AFRICA\">AFRICA</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#ASIA\">ASIA</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#EUROPE\">EUROPE</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#LATINAMERICA\">LATIN AMERICA</a></li>\n\t\t\t\t\t\t\t<li><a href=\"#MIDDLEEAST\">MIDDLE EAST</a></li>\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class=\"btn-group\">\n\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">\n\t\t\t\t\t\t\t\t    \tLogged as <strong><%= userdata.getUsername() %></strong> <span class=\"caret\"></span>\n\t\t\t\t\t\t\t\t  \t</button>\n\t\t\t\t\t\t\t\t  \t<ul class=\"dropdown-menu\" role=\"menu\">\n\t\t\t\t\t\t\t\t\t    <li><a href=\"EditProfile.jsp\">Edit profile</a></li>\n\t\t\t\t\t\t\t\t\t    <li><a href=\"DeleteAccount.jsp\">Delete account</a></li>\n\t\t\t\t\t\t\t\t\t    <li class=\"divider\"></li>\n\t\t\t\t\t\t\t\t\t    <li><a href=\"Logout.jsp\">Logout</a></li>\n\t\t\t\t\t\t\t\t  \t</ul>\n\t\t\t\t\t\t\t  \t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n\n\t\t<%  \n        \tNewsBeanRemote newsbean = (NewsBeanRemote) session.getAttribute(\"newsBean\");\n\t        \n\t        List<String> regioes = new ArrayList<String>(); // Lista de regi\u00f5es\n\t        List<News> allNews = newsbean.getNews(); // Lista de not\u00edcias\n\t        \n\t        // Percorrer lista de not\u00edcias para preencher lista de regi\u00f5es\n\t        for(int i=0; i<allNews.size();i++){\n\t        \tif(!regioes.contains(allNews.get(i).getRegion())){\n\t        \t\tregioes.add(allNews.get(i).getRegion());\n\t        \t}\n\t        }\n\t       \t\n\t        // Para cada regi\u00e3o, apresenta as not\u00edcias ordenadas por data (as mais recentes primeiro)\n\t        for(int j=0; j<regioes.size(); j++){\n\t        \tList<News> news = newsbean.newsSortedByDate(regioes.get(j));\n\t        \tpageContext.setAttribute(\"newsList\", news);\n\t        \t//Integer count = new Integer(news.get(j).getAuthors().size());\n\t        \t//pageContext.setAttribute(\"count\", count);\n        %>\n        \n        <!-- CONTEUDO -->\n        \t\t<!-- Regi\u00e3o -->\n\t\t\t\t<h1 id=\"<%= regioes.get(j) %>\"><%= regioes.get(j) %></h1>\n\t\t\t\t<div class=\"panel-group\" id=\"accordion\">\n\t\t\t\t\t<!-- Not\u00edcias -->\n\t\t\t\t    <c:forEach var=\"news\" items=\"${newsList}\" varStatus=\"status\">\n\t\t\t\t\t\t<div class=\"panel panel-default\">\n\t\t\t\t\t\t\t<div class=\"panel-heading\">\n\t\t\t\t\t\t\t\t<!-- T\u00edtulo da not\u00edcia -->\n\t\t\t\t\t\t\t\t<h3 class=\"panel-title\">\n\t\t\t\t\t\t\t\t    <a class=\"accordion-toggle\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse${news.region}${status.index}\">\n\t\t\t\t\t\t\t\t    \t<c:out value=\"${news.title}\"/>\n\t\t\t\t\t\t\t\t    </a>\n\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div id=\"collapse${news.region}${status.index}\" class=\"panel-collapse collapse\">\n\t\t\t\t\t\t\t\t<div class=\"panel-body\">\n\t\t\t\t\t\t\t\t\t<!-- Autor(es) -->\n\t\t\t\t\t\t\t\t\t<!-- \n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t  \t\t<c:if test=\"${numAuthors > 0}\">\n \t\t\t\t\t\t\t  \t\t\tby \n\t\t\t\t\t\t\t\t  \t\t<c:choose>\n\t\t\t\t\t\t\t\t\t\t\t<c:when test=\"${numAuthors==1}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<b><c:out value=\"${news.authors[0]}\"/></b>,\n\t\t\t\t\t\t\t\t\t\t\t</c:when>\n\t\t\t\t\t\t\t\t\t\t\t<c:when test=\"${numAuthors==2}\">\n\t\t\t\t\t\t\t\t\t\t\t\t<b><c:out value=\"${news.authors[0]}\"/></b> and <b><c:out value=\"${news.authors[1]}\"/></b>,\n\t\t\t\t\t\t\t\t\t\t\t</c:when >\n\t\t\t\t\t\t\t\t\t\t\t<c:otherwise>\n\t\t\t\t\t\t\t\t\t\t\t\t<b><c:out value=\"${news.authors[0]}\"/></b>, <b><c:out value=\"${news.authors[1]}\"/></b> and <b>c:out value=\"${news.authors[2]}\"/></b>,\n\t\t\t\t\t\t\t\t\t\t\t</c:otherwise>\n\t\t\t\t\t\t\t\t\t\t</c:choose>\n\t\t\t\t\t\t\t\t\t</c:if>\n\t\t\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t\t\t<!-- Data -->\n \t\t\t\t\t\t\t\t\ton \n \t\t\t\t\t\t\t\t\t<fmt:formatDate pattern=\"yyyy/MM/dd HH:mm\" value=\"${news.date}\" />\n\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t<!-- Highlights -->\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<c:forEach var=\"highlight\" items=\"${news.highlights}\" varStatus=\"hlstatus\">\n\t\t\t\t\t\t\t    \t\t\t<li><c:out value=\"${highlight}\"/></li>\n\t\t\t\t\t\t\t    \t\t</c:forEach>\n\t\t\t\t\t\t\t\t    </ul>\n\t\t\t\t\t\t\t\t\t<!-- Foto -->\n\t\t\t\t\t\t\t    \t<div class=\"row\"> \n\t\t\t\t\t\t\t\t\t  \t<div class=\"col-xs-5\"> \n\t\t\t\t\t\t\t\t\t  \t\t<c:if test=\"${news.photoURL != ''}\">\n\t\t\t\t\t\t\t\t  \t\t\t\t<a href=\"${news.photoURL}\" class=\"thumbnail\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t      \t\t<img src=\"${news.photoURL}\"/>\n\t\t\t\t\t\t\t\t\t\t    \t</a>\n\t\t\t\t\t\t\t\t\t  \t\t</c:if>\n\t\t\t\t\t\t\t\t  \t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<!-- Video -->\n\t\t\t\t\t\t\t\t\t<div class=\"video\">\n\t\t\t\t\t\t\t\t\t\t<c:if test=\"${news.videoURL != ''}\">\n\t\t\t\t\t\t\t\t  \t\t\t<a class=\"btn btn-primary btn-lg\" role=\"button\" href=\"${news.videoURL}\" target=\"_blank\"><span class=\"glyphicon glyphicon-film\"></span> Video</a>\n\t\t\t\t\t\t\t\t  \t\t</c:if>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t\t<!-- Texto da not\u00edcia -->\n\t\t\t\t\t\t\t\t\t<div class=\"texto\">\n\t\t\t\t\t\t\t\t\t\t<c:out value=\"${news.text}\"/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t\t<!-- Fonte -->\n\t\t\t\t\t\t\t\t\t<div class=\"source\">\n\t\t\t\t\t\t\t\t\t\tSource: <a href=\"${news.url}\" style=\"color: #FF0000\" target=\"_blank\">CNN</a>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t</c:forEach>\n\t\t\t\t</div>\n\t\t\t\t<% } %>\n        \n\t</body>\n</html>", "<%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\" pageEncoding=\"ISO-8859-1\"%>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<%@page import=\"java.util.List\"%>\n<%@page import=\"java.util.ArrayList\"%>\n<%@page import=\"common.News\"%>\n<%@page import=\"common.User\"%>\n<%@page import=\"ejbs.NewsBeanRemote\"%>\n<%@page import=\"javax.naming.InitialContext\" %>\n\n<html>\n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n\t\t<title>CNN News - News more recent than</title>\n\t\t\n\t\t<!-- BOOTSTRAP -->\n\t\t<link href=\"bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/font-awesome.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/style.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"></script>\n\t\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/dropdown.js\"></script>\n\t\t\n\t</head>\n\t<body>\n\t\t<jsp:include page=\"auth_verification.jsp\"></jsp:include>\n\t\t\n\t\t<!-- HEADER -->\n\t\t<nav class=\"navbar navbar-default\" role=\"navigation\">\n\t\t\t<div class=\"container\">\n\t\t\t\t<!-- Logo CNN -->\n\t\t\t\t<div class=\"navbar-header\">\n\t\t\t\t\t<button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-menu\">\n\t\t\t\t\t\t<i class=\"icon-reorder\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a class=\"navbar-brand\" href=\"Menu.jsp\"><img src=\"bootstrap/img/cnn_logo.gif\"/></a>\n\t\t\t\t</div>\n\t\t\t\t<!-- Informa\u00e7\u00e3o do utilizador -->\n\t\t\t\t<%  \n\t\t\t\t\tUser userdata = (User) session.getAttribute(\"user\");\n\t\t        %>\n\t\t\t\t<div class=\"btn-group nav navbar-nav navbar-right\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">\n\t\t\t\t    \tLogged as <strong><%= userdata.getUsername() %></strong> <span class=\"caret\"></span>\n\t\t\t\t  \t</button>\n\t\t\t\t  \t<ul class=\"dropdown-menu\" role=\"menu\">\n\t\t\t\t\t    <li><a href=\"EditProfile.jsp\">Edit profile</a></li>\n\t\t\t\t\t    <li><a href=\"DeleteAccount.jsp\">Delete account</a></li>\n\t\t\t\t\t    <li class=\"divider\"></li>\n\t\t\t\t\t    <li><a href=\"Logout.jsp\">Logout</a></li>\n\t\t\t\t  \t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n\t\t\n\t\t<% \n\t\t\tString date = session.getAttribute(\"date\").toString();\n\t\t\t//System.out.println(\"DATA: \" + date);\n\t\t%>\n\t\t<h1>News more recent than <%= date %></h1>\n\t\t\n\t\t<%  \n        \tNewsBeanRemote newsbean = (NewsBeanRemote) session.getAttribute(\"newsBean\");\n\t        \n\t        List<String> regioes = new ArrayList<String>();\n\t        List<News> newsDate = newsbean.newsMoreRecentThan(date);\n\t        \n\t        for(int i=0; i<newsDate.size();i++){\n\t        \tif(!regioes.contains(newsDate.get(i).getRegion())){\n\t        \t\tregioes.add(newsDate.get(i).getRegion());\n\t        \t}\n\t        }\n\t        \n\t        for(int j=0; j<regioes.size(); j++){\n\t        \tList<News> newsDateRegion = newsbean.newsMoreRecentThan(date, regioes.get(j));\n        %>\n\t\t\t\t<h3><%= regioes.get(j) %></h3>\n\t\t\t\t<table border=\"1\" align=\"center\">\n\t\t            <tr>\n\t\t                <th>Title</th>\n\t\t                <th>url</th>\n\t\t            </tr>\n\t\t            <%  \t\n\t\t            \tfor(int i=0; i<newsDateRegion.size(); i++){ \n\t\t            %>\n\t\t            <tr>\n\t\t                <td> <%= newsDateRegion.get(i).getTitle() %> </td>\n\t\t                <td align=\"center\"> <%= newsDateRegion.get(i).getUrl() %> </td>\n\t\t            </tr>\n\t\t            <%\n\t\t                }\n\t\t            %>\n\t\t        </table>\n\t\t        <% } %>\n        \n\t</body>\n</html>", "<%@ page language=\"java\" contentType=\"text/html; charset=ISO-8859-1\" pageEncoding=\"ISO-8859-1\"%>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n\n<%@page import=\"common.User\"%>\n\n<html>\n\t<head>\n\t\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\">\n\t\t<title>CNN - Main Menu</title>\n\t\t\n\t\t<!-- BOOTSTRAP -->\n\t\t<link href=\"bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/font-awesome.min.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<link href=\"bootstrap/css/style.css\" rel=\"stylesheet\" media=\"screen\"/>\n\t\t<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js\"></script>\n\t\t<script language=\"javascript\" type=\"text/javascript\" src=\"bootstrap/js/dropdown.js\"></script>\n\t\t\n\t\t<!-- VERIFICA\u00c7\u00c3O DOS CAMPOS DO FORMUL\u00c1RIO -->\n\t\t<script type=\"text/javascript\" language=\"javascript\">\n            function validateForm(campo) {\n            \tif(campo == 'author'){\n\t                if (document.getElementById(\"authorName\").value == \"\") {\n\t                    alert(\"Author's name not defined\");\n\t                    document.getElementById(\"authorName\").focus();\n\t                    return false;\n\t                }\n\t                else{\n\t                    document.getElementById(\"login_form\").submit();\n\t                }\n\t            }\n            \telse if(campo == 'word'){\n            \t\tif (document.getElementById(\"word\").value == \"\") {\n\t                    alert(\"Word not defined\");\n\t                    document.getElementById(\"word\").focus();\n\t                    return false;\n\t                }\n\t                else{\n\t                    document.getElementById(\"login_form\").submit();\n\t                }\n            \t}\n            \telse if(campo == 'date'){\n            \t\tif (document.getElementById(\"date\").value == \"\") {\n\t                    alert(\"Date not defined\");\n\t                    document.getElementById(\"date\").focus();\n\t                    return false;\n\t                }\n\t                else{\n\t                    document.getElementById(\"login_form\").submit();\n\t                }\n            \t}\n            }\n            \n            function confirmar(){\n            \tvar txt;\n                var r = confirm(\"Are you sure you want to delete your account?\\nPress Ok to delete, Cancel to quit!\");\n                if (r == true) {\n                    txt = \"Ok\";\n                    document.location.href=\"DeleteAccountServlet\";\n                } else {\n                    txt = \"Cancel\";\n                }\n            }\n        </script>\n\t\n\t</head>\n\t\n\t<body>\n\t\t<jsp:include page=\"auth_verification.jsp\"></jsp:include>\n\t\n\t\t<!-- HEADER -->\n\t\t<nav class=\"navbar navbar-default\" role=\"navigation\">\n\t\t\t<div class=\"container\">\n\t\t\t\t<!-- Logo CNN -->\n\t\t\t\t<div class=\"navbar-header\">\n\t\t\t\t\t<button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\".navbar-menu\">\n\t\t\t\t\t\t<i class=\"icon-reorder\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t<a class=\"navbar-brand\" href=\"#\"><img src=\"bootstrap/img/cnn_logo.gif\"/></a>\n\t\t\t\t</div>\n\t\t        <!-- Informa\u00e7\u00e3o do utilizador -->\n\t\t\t\t<%  \n\t\t\t\t\tUser userdata = (User) session.getAttribute(\"user\");\n\t\t        %>\n\t\t\t\t<div class=\"btn-group nav navbar-nav navbar-right\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">\n\t\t\t\t    \tLogged as <strong><%= userdata.getUsername() %></strong> <span class=\"caret\"></span>\n\t\t\t\t  \t</button>\n\t\t\t\t  \t<ul class=\"dropdown-menu\" role=\"menu\">\n\t\t\t\t\t    <li><a href=\"EditProfile.jsp\">Edit profile</a></li>\n\t\t\t\t\t    <li><a onclick=\"return confirmar()\">Delete account</a></li>\n\t\t\t\t\t    <li class=\"divider\"></li>\n\t\t\t\t\t    <li><a href=\"Logout.jsp\">Logout</a></li>\n\t\t\t\t  \t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</nav>\n\t\t\n\t\t<h1>Welcome to CNN News</h1>\n\t\t\n\t\t<div>\n            <a href=\"AllNews.jsp\">\n                List all the news\n            </a>\n        </div>\n        \n        <form action=\"AuthorNewsServlet\" method=\"POST\" id=\"login_form\" onsubmit=\"return validateForm('author')\">\n\t\t\t\t<p>\n\t\t\t\t\tList news from <input type=\"text\" name=\"authorName\" id=\"authorName\" />\n\t\t\t\t\t<input type=\"SUBMIT\" value=\"Ok\" />\n\t\t\t\t</p>\n\t\t</form>\n        \n        <form action=\"DateNewsServlet\" method=\"GET\" id=\"login_form\" onsubmit=\"return validateForm('date')\">\n\t\t\t\t<p>\n\t\t\t\t\tList news more recent than <input type=\"datetime-local\" name=\"date\" id=\"date\" />\n\t\t\t\t\t<input type=\"SUBMIT\" value=\"Ok\" />\n\t\t\t\t</p>\n\t\t</form>\n        \n\t\t<form action=\"HighlightNewsServlet\" method=\"POST\" id=\"login_form\" onsubmit=\"return validateForm('word')\">\n\t\t\t\t<p>\n\t\t\t\t\tList news which highlights contains <input type=\"text\" name=\"word\" id=\"word\" />\n\t\t\t\t\t<input type=\"SUBMIT\" value=\"Ok\" />\n\t\t\t\t</p>\n\t\t</form>\n\t\t\n\t</body>\n</html>"], "filenames": ["Cnn-EJB/ejbModule/ejbs/NewsBean.java", "Cnn-Web/WebContent/AllNews.jsp", "Cnn-Web/WebContent/DateNews.jsp", "Cnn-Web/WebContent/Menu.jsp"], "buggy_code_start_loc": [96, 116, 56, 115], "buggy_code_end_loc": [109, 135, 56, 116], "fixing_code_start_loc": [96, 115, 57, 115], "fixing_code_end_loc": [109, 132, 58, 116], "type": "CWE-89", "message": "A vulnerability has been found in IS_Projecto2 and classified as critical. This vulnerability affects unknown code of the file Cnn-EJB/ejbModule/ejbs/NewsBean.java. The manipulation of the argument date leads to sql injection. The name of the patch is aa128b2c9c9fdcbbf5ecd82c1e92103573017fe0. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-217192.", "other": {"cve": {"id": "CVE-2014-125038", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-02T18:15:18.913", "lastModified": "2023-01-09T19:00:10.300", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability has been found in IS_Projecto2 and classified as critical. This vulnerability affects unknown code of the file Cnn-EJB/ejbModule/ejbs/NewsBean.java. The manipulation of the argument date leads to sql injection. The name of the patch is aa128b2c9c9fdcbbf5ecd82c1e92103573017fe0. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-217192."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:is_projecto2_project:is_projecto2:*:*:*:*:*:*:*:*", "versionEndExcluding": "2014-11-12", "matchCriteriaId": "DA687ECF-19DD-42FC-8642-22B96F7FFAD3"}]}]}], "references": [{"url": "https://github.com/rfsimoes/IS_Projecto2/commit/aa128b2c9c9fdcbbf5ecd82c1e92103573017fe0", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217192", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217192", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/rfsimoes/IS_Projecto2/commit/aa128b2c9c9fdcbbf5ecd82c1e92103573017fe0"}}