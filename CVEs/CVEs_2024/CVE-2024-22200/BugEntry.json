{"buggy_code": ["FROM node:16 as node\n\nLABEL maintainer=\"Bart van Beusekom <b.vanbeusekom@iknl.nl>, Frank Martin <f.martin@iknl.nl>\"\n\n# copy and install\nWORKDIR /app\nCOPY . /app\nRUN npm install\nRUN npm run build --prod\n\n# run\nFROM nginx:alpine\nCOPY --from=node /app/dist/vantage6-UI /usr/share/nginx/html\n\n# When the container starts, replace the env.js with values from environment variables and then startup app\nCMD [\"/bin/sh\",  \"-c\",  \"envsubst < /usr/share/nginx/html/assets/env.template.js > /usr/share/nginx/html/assets/env.js && exec nginx -g 'daemon off;'\"]"], "fixing_code": ["FROM node:16 as node\n\nLABEL maintainer=\"Bart van Beusekom <b.vanbeusekom@iknl.nl>, Frank Martin <f.martin@iknl.nl>\"\n\n# copy and install\nWORKDIR /app\nCOPY . /app\nRUN npm install\nRUN npm run build --prod\n\n# run\nFROM nginx:alpine\nCOPY --from=node /app/dist/vantage6-UI /usr/share/nginx/html\n\n\n# add option to not share server info to nginx config file. Be sure to do this\n# in the http block, which is achieved by matching that line\nRUN sed -i '/http {/a \\ \\ \\ \\ server_tokens off;' /etc/nginx/nginx.conf\n\n# When the container starts, replace the env.js with values from environment variables and then startup app\nCMD [\"/bin/sh\",  \"-c\",  \"envsubst < /usr/share/nginx/html/assets/env.template.js > /usr/share/nginx/html/assets/env.js && exec nginx -g 'daemon off;'\"]"], "filenames": ["Dockerfile"], "buggy_code_start_loc": [14], "buggy_code_end_loc": [14], "fixing_code_start_loc": [15], "fixing_code_end_loc": [20], "type": "NVD-CWE-noinfo", "message": "vantage6-UI is the User Interface for vantage6. The docker image used to run the UI leaks the nginx version. To mitigate the vulnerability, users can run the UI as an angular application.  This vulnerability was patched in 4.2.0.\n", "other": {"cve": {"id": "CVE-2024-22200", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-30T16:15:48.553", "lastModified": "2024-02-08T17:01:25.927", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "vantage6-UI is the User Interface for vantage6. The docker image used to run the UI leaks the nginx version. To mitigate the vulnerability, users can run the UI as an angular application.  This vulnerability was patched in 4.2.0.\n"}, {"lang": "es", "value": "vantage6-UI es la interfaz de usuario de vantage6. La imagen de la ventana acoplable utilizada para ejecutar la interfaz de usuario filtra la versi\u00f3n de nginx. Para mitigar la vulnerabilidad, los usuarios pueden ejecutar la interfaz de usuario como una aplicaci\u00f3n de angular. Esta vulnerabilidad fue parcheada en 4.2.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.3, "baseSeverity": "LOW"}, "exploitabilityScore": 1.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vantage6:vantage6-ui:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.2.0", "matchCriteriaId": "CDABDC62-80CD-4CBD-A86D-7C8A5F054290"}]}]}], "references": [{"url": "https://github.com/vantage6/vantage6-UI/commit/92e0fb5102b544d5bcc23980d973573733e2e020", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/vantage6/vantage6-UI/security/advisories/GHSA-8wxq-346h-xmr8", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/vantage6/vantage6-UI/commit/92e0fb5102b544d5bcc23980d973573733e2e020"}}