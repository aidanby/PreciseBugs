{"buggy_code": ["                      User-Visible pam-krb5 Changes\n\npam-krb5 4.9 (unreleased)\n\n    SECURITY: All previous versions of this module could overflow the\n    buffer provided by the underlying Kerberos library for the response to\n    a prompt by writing a single nul character past the end of the buffer.\n\n    Support use_pkinit with MIT Kerberos.  (Debian Bug#871699)\n\n    Reject passwords as long or longer than PAM_MAX_RESP_SIZE (normally\n    512 octets), since extremely long passwords can be used for a denial\n    of service attack via the Kerberos string to key function.  Thanks to\n    Florian Best for pointing out this issue and suggesting a good fix.\n\n    Use explicit_bzero instead of memset, where available, to overwrite\n    the memory used by PAM responses before freeing.  This reduces the\n    lifetime of passwords and other secrets in memory.\n\n    Return more accurate errors from the Kerberos prompter function if it\n    was unable to prompt for the password.  This may translate into better\n    debug log messages and, in some situations, returning the slightly\n    more accurate PAM_AUTHINFO_UNAVAIL instead of PAM_AUTH_ERR.\n\n    Ensure the module/basic test will run properly when the system\n    krb5.conf file does not specify a default realm.  Reported by TBK.\n\n    Update to rra-c-util 8.2:\n\n    * Fix support for configuring the test suite with a krb5.conf file.\n    * Drop support for Perl 5.6.\n    * Reformat all C source using clang-format 10.\n    * Remove bogus snprintf tests.\n    * Fix misplaced va_end in the pam-util putil_log_failure function.\n    * Skip checking for krb5-config on the path if a prefix was given.\n    * Add SPDX-License-Identifier headers to all substantial source files.\n\n    Update to C TAP Harness 4.6:\n\n    * Fixed malloc error checking in bstrndup.\n    * Fix (harmless) allocation error in runtests driver.\n    * Add support for valgrind testing via test list options.\n    * Report test failures as left and right, not wanted and seen.\n    * Fix is_string comparisons involving NULL pointers and \"(null)\".\n    * Add SPDX-License-Identifier headers to all substantial source files.\n\npam-krb5 4.8 (2017-12-30)\n\n    When verifying that an expired password can still be used to get\n    kadmin/changepw credentials, correctly set the credential options for\n    getting password change credentials, not for getting initial\n    credentials.  This should fix password change issues when, for\n    example, krb5.conf requests that all tickets be proxiable but\n    kadmin/changepw doesn't allow proxiable credentials.  Thanks to\n    Florian Best for the bug report.\n\n    When built against recent versions of Heimdal with richer status codes\n    from PKINIT attempts, report to the user the reason for a PKINIT\n    failure.  Based on work by Henry Jacques.\n\n    Document the test suite configuration files required to run the PKINIT\n    tests.\n\n    Fix expired password tests to work with Heimdal 7.0.1 and later.\n\n    Better document that the default Kerberos library ticket cache\n    location is not used (and why), and how to set configuration\n    parameters in krb5.conf.  Thanks, Matthew Gabeler-Lee.  (Debian\n    Bug#872943)\n\n    Compile cleanly under GCC 7 and Clang warnings and Clang's static\n    analyzer.\n\n    Rename the script to bootstrap from a Git checkout to bootstrap,\n    matching the emerging consensus in the Autoconf world.\n\n    Update to rra-c-util 7.0:\n\n    * Fix new warnings in GCC 7.\n    * Support a warning build under Clang.\n    * Avoid zero-length allocations in reallocarray and vector.\n    * Probe for warning flags instead of hard-coding a list.\n    * New test for obsolete URLs and email addresses.\n    * Remove unused portable replacements for strlcpy and strlcat.\n    * Use C_TAP_SOURCE and C_TAP_BUILD environment variables in tests.\n    * Fix portability defines for anonymous principal strings.\n    * Clear errno on pam_modutil_getpwnam to improve other testing.\n    * Add portability defines for macOS's PAM implementation.\n    * Add new Autoconf macro to probe for pam_strerror const usage.\n    * Support Solaris 10's included Kerberos.\n\n    Update to C TAP Harness 4.2:\n\n    * Avoid zero-length allocations in breallocarray.\n    * Add is_blob and is_bool functions.\n    * Use C_TAP_SOURCE and C_TAP_BUILD environment variables in tests.\n    * Fix segfault in runtests with an empty test list.\n    * Display verbose test results with -v or C_TAP_VERBOSE.\n    * Test infrastructure builds cleanly with Clang warnings.\n\npam-krb5 4.7 (2014-12-25)\n\n    Add a no_update_user option that disables the normal update of the\n    PAM_USER PAM variable after canonicalization of the username.  When\n    this is set, pam-krb5 will not convert full principal names to local\n    usernames where possible for the rest of the PAM stack.\n\n    Suppress spurious password prompt from Heimdal when authenticating\n    with PKINIT.\n\n    Map unknown realm errors from the Kerberos libraries to the PAM error\n    code PAM_AUTHINFO_UNAVAIL instead of PAM_AUTH_ERR.\n\n    Treat an KRB5_GET_IN_TKT_LOOP error as an incorrect password.  Heimdal\n    KDCs sometimes return it, and Heimdal kinit treats it this way.\n    Similarly, treat a KRB5_BAD_ENCTYPE error as an incorrect password,\n    since this error is returned by a Heimdal 1.6-rc2 KDC for incorrect\n    preauth from a MIT Kerberos 1.12.1 client.\n\n    Add the version number at which each module option was added with its\n    current meaning to the documentatation.\n\n    Update to rra-c-util 5.6:\n\n    * Suppress warnings from Kerberos headers in non-system paths.\n    * Fix probing for Heimdal's libroken to work with older versions.\n    * Fix Kerberos header detection if root or include paths are given.\n    * Pass --deps to krb5-config in the non-reduced-dependencies case.\n    * Provide a reallocarray replacement for platforms without it.\n    * Use reallocarray where appropriate.\n    * Drop checks for NULL before freeing pointers.\n    * Drop explicit pointer initialization to NULL and rely on calloc.\n    * Check the return status of snprintf and vsnprintf properly.\n    * Preserve errno if snprintf fails in vasprintf replacement.\n    * Suppress a dummy symbol in the client library that could leak.\n    * Fix syntax errors when building with a C++ compiler.\n    * Avoid test suite failures where tested functions are macros.\n\n    Update to C TAP Harness 3.2:\n\n    * Reopen standard input to /dev/null when running a test list.\n    * Don't leak extraneous file descriptors to tests.\n    * Suppress lazy plans and test summaries if the test failed with bail.\n    * bail and sysbail now exit with status 255 to match Test::More.\n    * runtests now treats the command line as a list of tests by default.\n    * The full test executable path can now be passed to runtests -o.\n    * Improved harness output for tests with lazy plans.\n    * Improved harness output to a terminal for some abort cases.\n    * Flush harness output after each test even when not on a terminal.\n\npam-krb5 4.6 (2012-06-02)\n\n    Add an anon_fast option that attempts anonymous authentication\n    (generally implemented via anonymous PKINIT inside the Kerberos\n    library) and then, if successful, uses those credentials for FAST\n    armor.  If fast_ccache and anon_fast are both specified, anonymous\n    authentication will be used as a fallback if the specified FAST ticket\n    cache doesn't exist.  Based on patches from Yair Yarom.\n\n    Add a user_realm option to only set the realm for unqualified user\n    principals.  This differs from the existing realm option in that realm\n    also changes the default realm for authorization decisions and for\n    verification of credentials.  Update the realm option documentation to\n    clarify the differences and remove incorrect information.  Patch from\n    Roland C. Dowdeswell.\n\n    Add a no_prompt option to suppress the PAM module's prompt for the\n    user's password and defer all prompting to the Kerberos library.  This\n    allows the Kerberos library to have complete control of the prompting\n    process, which may be desirable if authentication mechanisms other\n    than password are in use.  Be aware that, with this option set, the\n    PAM module has no control over the contents of the prompt and cannot\n    store the user's password in the PAM data.  Based on a patch by Yair\n    Yarom.\n\n    Add a silent option to force the module to behave as if the\n    application had passed in PAM_SILENT and suppress text messages and\n    errors from the Kerberos library.  Patch from Yair Yarom.\n\n    Add preliminary support for Kerberos trace logging via a trace option\n    that enables trace logging if supported by the underlying Kerberos\n    library.  The option takes as an argument the file name to which to\n    log trace output.  This option does not yet work with any released\n    version of Kerberos, but may work with the next release of MIT\n    Kerberos.\n\n    MIT Kerberos does not add a colon and space to its password prompts,\n    but Heimdal does.  pam-krb5 previously unconditionally added a colon\n    and space, resulting in doubled colons with Heimdal.  Work around this\n    inconsistency by not adding the colon and space if already present.\n\n    Fix alt_auth_map support to preserve the realm of the authentication\n    identity when forming the alternate authentication principal, matching\n    the documentation.\n\n    Document that the alt_auth_map format may contain a realm to force all\n    mapped principals to be in that realm.  In that case, don't add the\n    realm of the authentication identity.  Note that this can be used as a\n    simple way to attempt authentication in an alternate realm first and\n    then fall back to the local realm, although any complex attempt at\n    authentication in multiple realms should instead run the module\n    multiple times with different realm settings.\n\n    Avoid a NULL pointer dereference if krb5_init_context fails.\n\n    Fix initialization of time values in the module configuration on\n    platforms (like S/390X) where krb5_deltat is not equivalent to long.\n\n    Close a memory leak when search_k5login is set but the user has no\n    .k5login file.\n\n    Close several memory leaks in alt_auth_map support.\n\n    Suppress bogus error messages about unknown option for the realm\n    option.  The option was being parsed and honored despite the error.\n\n    Retry authentication under try_first_pass on several other errors in\n    addition to decrypt integrity check errors to handle a wider array of\n    possible \"password incorrect\" error messages from the KDC.\n\n    Update to rra-c-util 4.4:\n\n    * Replacement strndup now works with non-nul-terminated strings.\n    * New Kerberos test setup that simplifies writing tests.\n    * Add -D_FORTIFY_SOURCE=2 to the make warnings flags.\n    * Use --deps flag to krb5-config by default.\n    * Suppress __alloc_size__ attribute with older versions of gcc.\n    * Suppress attribute warnings for non-gcc compilers.\n\n    Update to C TAP Harness 1.12:\n\n    * Add bstrndup to the basic C TAP library.\n    * Only use feature-test macros when requested or built with gcc -ansi.\n    * New tests/tap/macros.h header with some common definitions.\n    * Drop is_double from the C TAP library to avoid requiring -lm.\n    * Avoid using local in the shell libtap.sh library.\n\npam-krb5 4.5 (2011-12-24)\n\n    Suppress the notice that the password is being changed because it's\n    expired if force_first_pass or use_first_pass is set in the password\n    stack, indicating that it's stacked with another module that's also\n    doing password changes.  This is arguable, but without this change the\n    notification message of why the password is being changed shows up\n    confusingly in the middle of the password change interaction.  Based\n    on a patch by William Yang.\n\n    Some old versions of Heimdal (0.7.2 in OpenBSD 4.9, specifically)\n    reportedly return KRB5KDC_ERR_KEY_EXP for accounts with expired\n    keys even if the supplied password is wrong.  Work around this by\n    confirming that the PAM module can obtain tickets for kadmin/changepw\n    before returning a password expiration error instead of an invalid\n    password error.  Based on a patch by William Yang.\n\n    The location of the temporary root-owned ticket cache created during\n    the authentication process is now also controlled by the ccache_dir\n    option (but not the ccache option) rather than forced to be in /tmp.\n    This will allow system administrators to configure an alternative\n    cache directory so that pam-krb5 can continue working when /tmp is\n    full.\n\n    Report more specific errors in syslog if authorization checks (such as\n    .k5login checks) fail.\n\n    Pass a NULL principal to krb5_set_password with MIT client libraries\n    to prefer the older change password protocol for compatibility with\n    older KDCs.  This is not necessary on Heimdal since Heimdal's\n    krb5_set_password tries both protocols.\n\n    Improve logging and authorization checks when defer_pwchange is set\n    and a user authenticates with an expired password.\n\n    When probing for Kerberos libraries, always add any supplemental\n    libraries found to that point to the link command.  This will fix\n    configure failures on platforms without working transitive shared\n    library dependencies.\n\n    Close some memory leaks where unparsed Kerberos principal names were\n    never freed.\n\n    Restructure the code to work with OpenPAM's default PAM build\n    machinery, which exports a struct containing module entry points\n    rather than public pam_sm_* functions.  Thanks to Fredrik Pettai for\n    the information.\n\n    In debug logging, report symbolic names for PAM flags on PAM function\n    entry rather than the numeric PAM flags.  This helps with automated\n    testing and with debugging PAM problems on different operating\n    systems.\n\n    Include <krb5/krb5.h> if <krb5.h> is missing, which permits finding\n    the header file on NetBSD systems.  Thanks to Fredrik Pettai for the\n    report.\n\n    Replace the Kerberos compatibility layer with equivalent but\n    better-structured code from rra-c-util 4.0.\n\n    Avoid krb5-config and use manual library probing if --with-krb5-lib or\n    --with-krb5-include were given to configure.  This avoids having to\n    point configure at a nonexistent krb5-config to override its results.\n\n    Use PATH_KRB5_CONFIG instead of KRB5_CONFIG to locate krb5-config in\n    configure, to avoid a conflict with the variable used by the Kerberos\n    libraries to find krb5.conf.\n\n    Change references to Kerberos v5 to just Kerberos in the\n    documentation.  Kerberos v5 has been the default version of Kerberos\n    for over ten years now.\n\n    Update to rra-c-util 4.0:\n\n    * Add notices to all files copied over from rra-c-util.\n    * Include strings.h for additional POSIX functions where found.\n    * Fix detection of whether PAM uses const on FreeBSD.\n    * Update warning flags for make warnings for GCC 4.6.1.\n    * Limit symbol exports even on systems without GNU ld.\n    * Fix replacement mkstemp to use long long where available.\n    * Improve stripping of /usr/include from krb5-config results.\n    * Use issetugid where available, not the misnamed issetuidgid.\n\n    Update to C TAP Harness 1.9:\n\n    * Add bmalloc, bcalloc, brealloc, and bstrdup TAP library functions.\n    * Fix runtests to honor -s even if BUILD and -b aren't given.\n    * Add test_tmpdir and test_tmpdir_free to TAP library.\n    * runtests now frees all allocated resources on exit.\n\npam-krb5 4.4 (2010-12-31)\n\n    Do not prompt for a password when try_pkinit is set and the module is\n    built against MIT Kerberos.  This fixes a spurious password prompt\n    introduced in 4.1, but partly reintroduces the bug fixed in 4.1 where\n    the user's password is not saved in the PAM data if the authentication\n    falls back to password when PKINIT fails.  This requires more work\n    to fix and will be addressed in a subsequent release.  Thanks to\n    \u0411\u0440\u0430\u043d\u043a\u043e \u041c\u0430\u0458\u0438\u045b (Branko Majic) for the report.\n\n    Reorganize the configuration section of the pam_krb5 man page to\n    divide the many PAM module options into sections.\n\n    When probing for <ibm_svc/krb5_svc.h> (part of AIX's bundled Kerberos\n    implementation), include <krb5.h> before attempting to include that\n    header to quiet confusing Autoconf warnings.  Reported by Wilfried\n    Weiss.\n\n    Update to rra-c-util 3.0:\n\n    * Fix compilation of the replacement snprintf for old systems.\n    * Look for krb5-config in /usr/kerberos/bin for Red Hat systems.\n    * Fix compilation with OpenBSD's Heimdal without separate libroken.\n\npam-krb5 4.3 (2010-06-09)\n\n    Add a fast_ccache option that, if set, points to a Kerberos ticket\n    cache used for Flexible Authentication Secure Tunneling (FAST) to\n    protect the authentication.  FAST is a mechanism to protect Kerberos\n    against password guessing attacks and provide other security\n    improvements.  This option is only available when built against\n    Kerberos libraries with FAST support (currently only MIT Kerberos 1.7\n    or later).  Patch from Sam Hartman.\n\n    Fix error in freeing a previous alt_auth_map setting when parsing\n    configuration options.  Patch from Sam Hartman.\n\n    Fix the linker flags for Solaris with the native compiler.  Thanks,\n    Kevin Sumner.\n\npam-krb5 4.2 (2009-11-25)\n\n    Add a new fail_pwchange option, which suppresses password changes for\n    expired passwords and treats expired passwords the same as incorrect\n    passwords.\n\n    Include all the new header files from the portability code so that\n    it will actually compile on non-Linux platforms.\n\npam-krb5 4.1 (2009-11-20)\n\n    Return PAM_SUCCESS, not PAM_USER_UNKNOWN, for ignored users in\n    pam_setcred.  It's safe to return success when doing nothing in\n    pam_setcred because the stack has already been frozen after the\n    authentication step, and returning an error causes the stack to fail\n    on some other Linux PAM implementations.  Thanks, Ian Ward Comfort.\n\n    In the second pass through the password group, prompt for the new\n    password and store it in the PAM data even if the user is being\n    ignored.  This is required to allow this module to be stacked with\n    another module that uses use_authtok.  Without this behavior, the\n    second module won't be able to work for any ignored user since it will\n    see no saved password and use_authtok will reject the password change.\n\n    Fix return status from pam_sm_acct_mgmt if we were unable to retrieve\n    PAM_USER.\n\n    Log successful authentications to syslog with priority LOG_INFO,\n    including the Kerberos principal used for authentication.\n\n    Log failed authentication to syslog with priority LOG_NOTICE,\n    including roughly the same additional information that the Linux PAM\n    pam_unix logs by default.\n\n    Use pam_syslog for logging where available.  This means pam-krb5 log\n    messages will look like all other log messages for Linux PAM modules\n    on Linux.  Change the format of log messages on all platforms to\n    hopefully be somewhat clearer.\n\n    Rationalize logging.  The module should now follow the recommendations\n    of the Linux PAM Module Writers' Guide for log levels.  More errors\n    are logged at LOG_ERR instead of LOG_DEBUG, and system resource errors\n    are now logged at LOG_CRIT instead of LOG_ERR.\n\n    Add additional error and debug logging in places where significant\n    actions or failures may happen without previously being logged.  Also\n    add failure information from PAM or Kerberos libraries to messages\n    where appropriate.\n\n    Add replacement snprintf, vsnprintf, and mkstemp functions for\n    pointless portability to ancient systems.\n\npam-krb5 4.0 (2009-11-13)\n\n    UPGRADE WARNING: If you were using pam_krb5 with the use_authtok\n    parameter in the password group, you will need to add use_first_pass\n    to your configuration to keep the same behavior.  See below for\n    details.\n\n    UPGRADE WARNING: If you used the use_authtok parameter in the\n    authentication group, you should change it to force_first_pass.\n\n    Previous versions of this module incorrectly implemented the standard\n    use_authtok parameter.  use_authtok applies only to the password group\n    and says to use the new password stored in the PAM data rather than\n    prompting for a new password.  It doesn't imply anything about where\n    to obtain the old password, but it was implemented as requiring both\n    the old and new password be in the PAM stack already.  This doesn't\n    work when stacked with pam_cracklib.  Change use_authtok to have the\n    correct meaning, which means that password group configurations may\n    need to add use_first_pass to use_authtok to get the desired behavior.\n\n    use_first_pass and try_first_pass no longer affect how the new\n    password is obtained during password changes.  To use a password\n    obtained by a previous module, use use_authtok instead.\n\n    A new option, force_first_pass, is now supported for both the\n    authentication and password groups.  It tells the module to always get\n    the user's current password from the PAM data and fail without\n    prompting if it isn't already set.  This is the meaning that\n    use_authtok previously had for the current password.\n\n    use_authtok no longer has any meaning for the authentication stack.\n    Use force_first_pass instead, which does the same as use_authtok used\n    to do.  use_authtok will be temporarily converted to force_first_pass\n    in the authentication group and log a diagnostic, but this will be\n    removed in the future.\n\n    Stop returning PAM_IGNORE from pam_setcred if the user is ignored or\n    didn't log in via Kerberos and instead return PAM_USER_UNKNOWN.  This\n    fixes problems with the Linux PAM library where returning PAM_IGNORE\n    would cause pam_setcred to fail even if other modules succeeded.\n    Since pam_authenticate never returned PAM_IGNORE, this change should\n    not cause any differences in behavior.\n\n    Do not use issetugid on Solaris to determine when to avoid refreshing\n    the ticket cache named in KRB5CCNAME during pam_setcred.  Instead,\n    compare effective and real UID and GID and permit KRB5CCNAME to be\n    trusted if they match.  This allows setuid screensavers on Solaris to\n    refresh ticket caches and makes behavior on Solaris match other\n    platforms.  Using issetugid is arguably safer since it protects\n    programs that switch users via setuid to a user other than the calling\n    user but still should not trust the original environment, but such\n    programs are rare in the PAM context and should not be calling\n    pam_setcred anyway unless the calling user is permitted to generally\n    act as the target user.  Thanks, William Yang.\n\n    Do the same logging in pam_sm_open_session and pam_sm_close_session as\n    we do with the other functions.  This will mean pam_sm_open_session\n    calls will be logged as pam_sm_open_session, not as pam_sm_setcred as\n    before.\n\n    pam-krb5 is now built using Automake and Libtool to bring it more in\n    line with other software packages.  This means that it now relies on\n    Libtool to know how to generate a loadable module rather than\n    hand-configured linker rules.  This may improve portability on some\n    platforms and may hurt it on other platforms.\n\n    If configured with a prefix of /usr on Linux, use /lib, /lib32, or\n    /lib64 as an installation path based on the size of an integer in the\n    compilation environment rather than based on known 64-bit Linux\n    variants.\n\n    Update to rra-c-util 2.0:\n\n    * Sanity-check the results of krb5-config before proceeding.\n    * Fall back on manual probing if krb5-config results don't work.\n    * Don't break if the user clobbers CPPFLAGS at build time.\n\npam-krb5 3.15 (2009-07-21)\n\n    Fix a segfault (null pointer dereference) if pam-krb5 is configured\n    with use_first_pass or use_authtok and there is no password stored in\n    the PAM stack.  Thanks to Jonathan Guthrie for the bug report.\n\npam-krb5 3.14 (2009-07-18)\n\n    Return PAM_IGNORE instead of PAM_PERM_DENIED from pam_chauthtok for\n    ignored users.  This allows making the Kerberos PAM module mandatory\n    for password changes and still falling back to other PAM modules for\n    ignored users.  Thanks, Steve Langasek.\n\n    Always treat the empty password as an authentication failure rather\n    than passing it to the Kerberos libraries.  The Kerberos libraries\n    may treat it as equivalent to no password and prompt for a password\n    without our knowledge, leading to the user authenticating with a\n    different password than the one stored in the PAM stack.  This could\n    cause unexpected problems with some PAM configurations.  It's safer\n    to make the assumption that the empty password is always invalid and\n    reject it outside of the Kerberos libraries.  Thanks, Sanjay Sha.\n\n    Fix error handling if ticket cache initialization fails.\n    Authentication will still fail, but this avoids a segfault from a\n    double-free of the ticket cache structure.  The most common cause of\n    this problem was having the attempt to initialize the ticket cache\n    be blocked by AppArmor.  Thanks to Alex Mauer for the report.\n\n    Call krb5_free_error_string correctly, fixing a portability issue\n    when building against Heimdal.  Thanks, Andrew Drake.\n\n    Work around a deficiency in pam_putenv on FreeBSD 7.2 that doesn't\n    allow deleting environment variables, only setting them to empty\n    values.  Thanks, Andrew Elble.\n\npam-krb5 3.13 (2009-02-11)\n\n    SECURITY: When built against MIT Kerberos, if pam_krb5 is called in a\n    setuid context (effective UID or GID doesn't match the real UID or\n    GID), use krb5_init_secure_context instead of krb5_init_context.  This\n    ignores environment variable settings for the local Kerberos\n    configuration and keytab.  Previous versions could allow a local\n    attacker to point a setuid program that used PAM authentication at a\n    different Kerberos configuration under the attacker's control,\n    possibly resulting in privilege escalation.  Heimdal handles this\n    logic within the Kerberos libraries and therefore was not affected.\n    (CVE-2009-0360)\n\n    SECURITY: Disable pam_setcred(PAM_REINITIALIZE_CREDS) for setuid\n    applications.  If pam_krb5 detects this call in a setuid context, it\n    now logs an error and returns success without doing anything.  Solaris\n    su calls pam_setcred with that option rather than PAM_ESTABLISH_CREDS\n    after authentication and without wiping the environment, leading\n    previous versions of pam_krb5 to trust the KRB5CCNAME environment\n    variable for the ticket cache location.  This permitted an attacker to\n    use previous versions of pam_krb5 to overwrite arbitrary files with\n    Kerberos credential caches that were left owned by the attacker.\n    Setuid screen lock programs may also be affected.  Discovered by Derek\n    Chan and reported by Steven Luo.  Thanks to Sam Hartman and Jeffrey\n    Hutzelman for additional analysis.  (CVE-2009-0361)\n\n    If a prefix of /usr is requested at configure time, install the PAM\n    module into /lib/security or /lib64/security on Linux, matching the\n    standard Linux-PAM module location.  Use lib64 instead of lib on\n    64-bit SPARC, PowerPC, and S390 Linux as well as x86_64.  Patch from\n    Peter Breitenlohner.\n\n    Fix a build problem when builddir != srcdir introduced in 3.11.  Patch\n    from Peter Breitenlohner.\n\n    Add support for the old Heimdal krb5_get_error_string interface.\n    Thanks, Chaskiel Grundman.\n\n    Add --with-krb5-include and --with-krb5-lib configure options to allow\n    more specific setting of paths if necessary.\n\n    If krb5-config isn't available, attempt to determine if the library\n    directory for the Kerberos libraries is lib32 or lib64 instead of lib\n    and set LDFLAGS accordingly.  Based on an idea from the CMU Autoconf\n    macros.\n\npam-krb5 3.12 (2008-11-13)\n\n    Add alt_auth_map configuration option, which allows mapping of\n    usernames to alternative Kerberos principals, useful primarily for\n    using particular instances for access to a given PAM-authenticated\n    service.  Also added force_alt_auth and only_alt_auth options to\n    control when alternative Kerberos principals are used.  Patch from\n    Booker Bense.\n\n    Fix incorrect error handling for bad .k5login ownership when\n    search_k5login is set, leading to a NULL pointer dereference and a\n    segfault.  Thanks, Andrew Deason.\n\n    Fix double-free of the ticket cache structure if creation of the\n    ticket cache in the session module fails.  Thanks, Jens Jorgensen.\n\n    Log all syslog messages to LOG_AUTHPRIV, or LOG_AUTH if the system\n    doesn't define LOG_AUTHPRIV.  Thanks, Mark Painter.\n\n    Fix portability to AIX's bundled Kerberos.  Thanks, Markus Moeller.\n\n    When debugging is enabled, log an exit status of PAM_IGNORE as ignore\n    rather than failure.\n\n    Document that pam-krb5 must be listed in the session group as well as\n    the auth group for interactive logins or OpenSSH won't set up the\n    user's credential cache properly.\n\n    Document adding ignore=ignore to complex [] action configuration for\n    the session and account groups since the module now returns PAM_IGNORE\n    instead of PAM_SUCCESS for accounts that didn't use Kerberos.\n\npam-krb5 3.11 (2008-07-10)\n\n    pam_setcred, pam_open_session, and pam_acct_mgmt now return PAM_IGNORE\n    for ignored users or non-Kerberos logins rather than PAM_SUCCESS.\n    This return code tells the PAM library to continue as if the module\n    were not present in the configuration and allows sufficient to be\n    meaningful for pam-krb5 in account and session groups.\n    pam_authenticate continues to return failure for ignored users;\n    PAM_IGNORE would arguably be more correct, but increases the risk of\n    security holes through incorrect configuration.\n\n    Support correct password expiration handling according to the PAM\n    standard (returning success from pam_authenticate and an error from\n    pam_acct_mgmt and completing the authentication after pam_chauthotk).\n    This is not the default since it opens security holes with broken\n    applications that don't call pam_acct_mgmt or ignore its exit status.\n    To enable it, set the PAM option defer_pwchange for applications known\n    to make the correct PAM calls and check return codes.\n\n    Add a new option to attempt change of expired passwords during\n    pam_authenticate if Kerberos authentication returns a password expired\n    error.  Normally, the Kerberos library will do this for you, but some\n    Kerberos libraries (notably Solaris) disable that code.  This option\n    allows simulation of the normal Kerberos library behavior on those\n    platforms.\n\n    Work around an apparent Heimdal bug when krb5_free_cred_contents is\n    called on an all-zero credential structure.  It's not clear what's\n    going on here and the Heimdal code looks correct, but avoiding the\n    call fixes the problem.\n\n    Warn if more than one of use_authtok, use_first_pass, and\n    try_first_pass is set and use the strongest of the one set.\n\n    Remove the workaround for versions of MIT Kerberos that didn't\n    initialize a krb5_get_init_creds_opt structure on opt_alloc.  This bug\n    was only present in early versions of 1.6; the correct fix is to\n    upgrade.\n\n    Add an additional header check for AIX's bundled Kerberos.\n\n    If KRB5_CONFIG was explicitly set in the environment, don't use a\n    different krb5-config based on --with-krb5.  If krb5-config isn't\n    executable, don't use it.  This allows one to force library probing by\n    setting KRB5_CONFIG to point to a nonexistent file.\n\n    Sanity-check the results of krb5-config before proceeding and error\n    out in configure if they don't work.\n\n    For Kerberos libraries without krb5-config, also check for networking\n    libraries (-lsocket and friends) before checking for Kerberos\n    libraries in case shared library dependencies are broken.\n\n    Fix Autoconf syntax error when probing for libkrb5support.  Thanks,\n    Mike Garrison.\n\n    Set an explicit visibility of hidden for all internal functions at\n    compile time if gcc is used to permit better optimization.  Hide all\n    functions except the official interfaces using a version script on\n    Linux.  This protects against leaking symbols into the application\n    namespace and provides some mild optimization benefit.\n\n    Fix the probing of PAM headers for const on Mac OS X.  This will\n    suppress some harmless compiler warnings there.  Thanks, Markus\n    Moeller.\n\npam-krb5 3.10 (2007-12-28)\n\n    The workaround for krb5_get_init_creds_opt_alloc problems in MIT\n    Kerberos 1.6 broke PKINIT support with Heimdal.  Only apply that\n    workaround when building against the MIT Kerberos libraries.  Thanks\n    to Jaakko Pero for the detailed report.\n\n    If no_ccache is set, always exit successfully from pam_setcred or\n    pam_open_session, even if we couldn't retrieve module data.  Thanks,\n    Markus Moeller.\n\n    When keytab is set, properly handle failure to create a keytab cursor\n    and don't assume that the cursor is valid.  Thanks, Markus Moeller.\n\n    Define _ALL_SOURCE on AIX to get prototypes for snprintf.\n\n    Add additional portability glue and Autoconf probes to support\n    building against the version of Kerberos bundled with AIX.  Support\n    for this should be considered alpha in this release.  Thanks to Markus\n    Moeller for the initial patch.\n\npam-krb5 3.9 (2007-11-12)\n\n    If use_authtok is set, fail even if we can retrieve the stored PAM\n    password if that password is set to NULL.  Apparently that can happen\n    in some cases, such as with pam_cracklib.  Thanks to Christian Holler\n    for the diagnosis and a patch.\n\n    Add a new clear_on_fail option for the password group.  If set, when a\n    password change fails, set PAM_AUTHTOK to NULL so that subsequent\n    modules in the PAM stack with use_authtok set will also fail.  Just\n    returning failure doesn't abort the stack on the second pass when\n    actual password changes are made.  This is not the default since it\n    interferes with other desirable PAM configurations.  It's useful\n    primarily when using the PAM stack to synchronize passwords between\n    multiple environments.  Thanks to Christian Holler and Tomas Mraz for\n    the analysis.\n\n    Fix portability issues with Heimdal, versions of PAM that don't\n    provide pam_modutil_getpwnam, and compiler warnings when building\n    PKINIT support.  Thanks, Martin von Gagern.\n\n    Fix parsing of the keytab PAM option.  Thanks, Markus Moeller.\n\n    Return PAM_AUTHINFO_UNAVAIL instead of PAM_AUTH_ERR when unable to\n    resolve the Kerberos realm.  Thanks, Frank Cornelissen.\n\n    Add a new debugging section to the README.\n\npam-krb5 3.8 (2007-09-30)\n\n    krb5_get_init_creds_opt_alloc doesn't initialize the returned\n    structure with the default flags in MIT Kerberos 1.6, which meant that\n    users with expired passwords were not being prompted to change their\n    password but just rejected.  Fixed by always calling _init before\n    setting the credential flags, regardless of the provenance of the opt\n    structure.  Thanks, Michael Richters.\n\n    Fix configure and Makefile glue so that Mac OS X and HP-UX have a\n    chance of working (still untested).\n\n    Add a make warnings target with aggressive gcc warning options.  Treat\n    negative minimum UIDs as zero so that UID comparisons can always be\n    done unsigned.  Add casts and unused attributes as needed.\n\npam-krb5 3.7 (2007-09-29)\n\n    If given an explicit keytab path to use for credential verification,\n    use the first principal found in that keytab as the principal for\n    verification rather than the library default (which is normally the\n    host/* principal for the local system and may not be found in that\n    keytab).\n\n    When authenticating, don't store our context data until after\n    authentication has succeeded.  Otherwise, we may destroy the ticket\n    cache of a previous successful authentication.  This bug would only\n    affect configurations where pam_krb5 was run multiple times with\n    different settings, such as multiple realms.  Thanks to Dave Botsch\n    for the report.\n\n    Use pam_modutil_getpwnam instead of getpwnam if available for better\n    thread safety.\n\n    Don't store PAM data unless we're saving a ticket cache.  All other\n    calls use it for is to find the ticket cache, so without a cache it's\n    pointless and means we run the risk of stomping on ourselves in\n    multithreaded programs.\n\n    Still canonicalize the PAM user before returning when not saving a\n    ticket cache.\n\n    Fix determination of linker flags on non-x86_64 Linux.  Always link\n    with -fPIC when using GCC, just in case.\n\n    Add compilation options for Mac OS X and HP-UX (untested).\n\n    Use pam_krb5 instead of ctx for our PAM data name to reduce the\n    chances of collision.\n\npam-krb5 3.6 (2007-09-18)\n\n    When the local user doesn't exist and search_k5login is enabled, fall\n    back to simple Kerberos authentication just as if the account existed\n    with no .k5login file.  This avoids trying to verify an all-zero\n    credentials structure, leading to non-expoloitable segfaults on x86_64\n    systems.  Be more careful in general about setting error codes in the\n    search_k5login implementation.\n\n    Explicitly clear the forwardable and proxiable options and don't ask\n    for renewable tickets when getting a ticket for the password changing\n    service.  Otherwise, system-wide defaults and PAM configuration will\n    apply to those tickets as well and the resulting ticket request may be\n    rejected based on KDC configuration.  Based on a patch by Sergio\n    Gelato.\n\n    Do username canonicalization earlier so that .k5login checking and\n    similar work uses the correct username but only change the PAM\n    username if authentication succeeds.  Document that username\n    canonicalization won't work with unmodified OpenSSH and with several\n    common PAM modules.  Thanks to R. Scott Bailey for the bug report and\n    analysis.\n\n    Add a prompt_principal option which, if set, causes the PAM module to\n    prompt the user for the Kerberos principal to use for authentication\n    before prompting for the password.\n\n    Try to determine whether the PAM headers use const in the prototypes\n    of such things as pam_get_item and adjust accordingly.  This should\n    address most compiler warnings on Solaris.  Thanks, Markus Moeller.\n\n    Change lib to lib64 on x86_64 Linux to allow for the magical $ISA\n    parameter in Red Hat's PAM configuration.  Hopefully this won't cause\n    problems elsewhere.\n\n    Support DESTDIR for make install.\n\npam-krb5 3.5 (2007-04-10)\n\n    Don't try to chown non-FILE ticket caches, which among other things\n    breaks using pam-krb5 with Heimdal KCM caches.  Thanks, Jeremy\n    Jackson.\n\n    When logging session deletion via pam_setcred or pam_close_session,\n    don't look for the username in the PAM context after it's been freed.\n    Thanks, Markus Moeller.\n\n    Map more Kerberos status codes to PAM status codes for authentication\n    errors.\n\npam-krb5 3.4 (2007-01-28)\n\n    More compilation fixes for Heimdal 0.7, which has a pkinit function\n    but takes a different number of arguments.  Thanks, Morgan LEFIEUX.\n\n    Never call error_message directly on Heimdal.  krb5_get_err_text can\n    cope with a NULL context and krb5-config on Heimdal doesn't include\n    -lcom_err.\n\n    Handle a NULL return from krb5_get_error_message, since that seems\n    possible in some edge cases.\n\n    Call krb5_get_error_message on Heimdal as well if it's available,\n    since it's supported by the 0.8 release candidates.\n\npam-krb5 3.3 (2007-01-24)\n\n    Support the new MIT Kerberos error message functions.\n\n    Fix compilation errors in the Heimdal PKINIT support and don't be\n    confused by a similar function in the MIT Kerberos PKINIT branch.\n    Thanks to Douglas E. Engert for the testing and patch.\n\n    Fix compilation errors with Heimdal 0.7, which has some of the PKINIT\n    functions but doesn't define the same error codes.  Thanks, Morgan\n    LEFIEUX.\n\n    Initial support for the MIT Kerberos PKINIT branch, which uses a\n    different mechanism for configuring PKINIT support than Heimdal.  Also\n    support configuration of general preauth parameters for the MIT\n    preauth plugin system via the preauth_opt option.  Thanks to Douglas\n    E. Engert for the initial patch.\n\n    If use_pkinit is set in the PAM configuration and PKINIT isn't\n    available or cannot be forced, always fail authentication.\n\npam-krb5 3.2 (2007-01-16)\n\n    This release fixes numerous bugs all identified by Douglas E. Engert\n    while testing with Heimdal and PKINIT support.  Thank you!\n\n    Rewrite the code to drop the credlist data structure since we only\n    ever have one set of credentials, allocate new krb5_creds objects, and\n    do proper memory management, which should plug some memory leaks of\n    the contents of krb5_creds objects.\n\n    Probe for the correct Heimdal function to set default initial\n    credential options.\n\n    Prefix the default cache path with \"FILE:\" to make the cache type\n    explicit.\n\n    Fix installation of the manual page when building from a different\n    directory than the source directory.\n\n    Fix several compilation errors with the PKINIT support with Heimdal\n    0.8rc1 or later.  This code should still be considered alpha-quality.\n\npam-krb5 3.1 (2007-01-03)\n\n    Fix an infinite loop with failed Kerberos authentication and a doubled\n    colon that causes a syntax error with some compilers.  Thanks, Markus\n    Moeller.\n\n    Move the check for users we should ignore to pam_sm_authenticate\n    from pamk5_password_auth so that it's consistently done in the API\n    function.  This also avoids bogus log messages when authenticating as\n    an ignored user with debug enabled.\n\npam-krb5 3.0 (2006-12-18)\n\n    Add preliminary PKINIT support, contributed by Douglas E. Engert.\n    I reorganized and refactored the code extensively and it therefore may\n    not compile; until it has received more testing, it should be\n    considered alpha-quality.  Currently, PKINIT support requires Heimdal\n    0.8rc1 or later.\n\n    Add a keytab configuration option to use a different keytab for\n    initial credential validation.\n\n    Add a ticket_lifetime configuration option to set the lifetime of\n    obtained credentials.\n\n    Add the banner and expose_account configuration options, which control\n    the prompts for authentication and password changing.  Provide more\n    informative prompts when changing passwords.\n\n    Work around a bug in MIT Kerberos prior to 1.4 causing the library to\n    cache the default realm and assume a particular realm even if the\n    default realm is later changed.  This bug prevented running two\n    instances of pam-krb5 with different realm settings in the same PAM\n    stack.  Thanks, Dave Botsch.\n\n    Honor PAM_SILENT when the Kerberos library prompts for more\n    information, passing to the application only prompts.\n\n    If PAM_USER is set to a fully-qualified principal that the Kerberos\n    library can map to a local account name, reset PAM_USER to that local\n    account name after authentication.\n\n    Avoid memory leaks in the Kerberos prompter by freeing the PAM\n    response strings.  We were already doing this elsewhere and the world\n    didn't end, so assume that it's safe for the PAM module to do this.\n    Also avoid memory leaks in some unusual error conditions.\n\n    Return unknown user rather than internal error when attempting\n    authentication of a user we're supposed to ignore.\n\n    When debug is enabled, report the principal for which we're attempting\n    authentication to help catch realm configuration errors.\n\n    Document the broken behavior of old versions of OpenSSH, which tell\n    PAM to refresh credentials rather than opening a session.  Thanks,\n    Michael C. Garrison.\n\n    Add a link to the distribution page to the pam-krb5 man page.\n\n    Extensive refactoring and reorganization of the code.\n\npam-krb5 2.6 (2006-11-28)\n\n    Don't assume the pointer set by pam_get_user is usable over the life\n    of the PAM module; instead, save a local copy.\n\n    Avoid a use of already freed memory when debugging is enabled.\n\n    Use __func__ instead of __FUNCTION__ and provide a fallback for older\n    versions of gcc and for systems that support neither.  Should fix\n    compilation issues with Sun's C compiler.\n\n    On platforms where we know the appropriate compiler flags, try to\n    build the module so that symbols are resolved within the module in\n    preference to any externally available symbols.  Also add the\n    hopefully correct compiler flags for Sun's C compiler.\n\npam-krb5 2.5 (2006-11-03)\n\n    Don't free the results of pam_get_item(PAM_AUTHTOK) when changing\n    passwords.  Thanks, Arne Nordmark.\n\n    Be a bit more thorough when checking authorization in\n    pam_sm_acct_mgmt.  Re-retrieve the value of user in case the\n    application changed it, and if we have a ticket cache (we may not even\n    after a successful authentication if no_ccache was specified),\n    retrieve the principal from it rather than using the principal from\n    the context.\n\n    Overwrite passwords with 0 before freeing them, just out of paranoia\n    (and because PAM also does this internally).\n\npam-krb5 2.4 (2006-10-05)\n\n    Fix compilation problems with Heimdal.  Thanks, Matthijs Mohlmann and\n    Douglas Engert.\n\n    Check for memory allocation failures when parsing PAM options rather\n    than segfaulting.\n\n    Fix several places where an uninitialized context could have been\n    passed into the argument parsing function.\n\n    Refactor the code to read configuration from krb5.conf to be easier\n    to read and understand.  Parse renew_lifetime immediately and always\n    report an error rather than deferring time parsing until acquiring\n    tickets.\n\n    Log errors (not just authentication failures) at the LOG_ERR level\n    to match (some of) the recommendations of the Linux PAM documentation.\n\n    Log an error when an unknown option is passed via the PAM\n    configuration.\n\npam-krb5 2.3 (2006-09-03)\n\n    Fix the interface between the Kerberos prompting function and the\n    PAM conversation function on Linux.  Prior to this fix, the PAM module\n    would only work on Solaris if Kerberos passed multiple prompts, which\n    happens when an account requires a password change.  Solaris and Linux\n    PAM implementations expect a different structure of pam_message\n    structs in the conversation function; use a workaround to cater to\n    both of them.  Based on a patch by Joachim Keltsch.\n\n    Implement retain_after_close, which specifies that the PAM module\n    should never destroy the user's ticket cache, even on session end.\n\n    Adjust for the differences in Solaris's PAM libraries:  Include\n    pam_appl.h everywhere for structure and type definitions, and add\n    portability workarounds for the return statuses missing from the\n    Solaris implementation.\n\npam-krb5 2.2 (2006-08-28)\n\n    Allow the default realm to be overridden in the PAM options.\n\n    Use the realm, default or otherwise, when reading options from\n    krb5.conf so that realm-specific sections in [appdefaults] work\n    correctly.\n\n    Update the build and installation documentation for the new\n    Autoconf-based build system.  This should have been in the last\n    release but was missed.\n\n    Initialize ticket options correctly when built with Heimdal.\n\n    Fix a typo that caused the Heimdal support not to compile.  Thanks,\n    Matthijs Mohlmann.\n\npam-krb5 2.1 (2006-08-26)\n\n    Strip off a FILE: prefix from the cache path before creating it in\n    case the user set ccache or ccache_dir with a cache type prefix.\n    Thanks to Bj\u00f6rn Torkelsson for the patch.\n\n    Added an Autoconf script to distinguish between Heimdal and MIT\n    Kerberos and take care of other portability issues.  Rewrote the\n    Makefile accordingly.\n\n    Added portability and error reporting fixes for Heimdal, thanks to\n    Matthijs Mohlmann.\n\npam-krb5 2.0 (2006-08-11)\n\n    Always use a disk cache for temporary storage of credentials between\n    authentication and setcred or session initialization.  This allows the\n    module to work correctly with OpenSSH ChallengeResponseAuthentication.\n\n    Add support for some PAM options that were supported by the\n    Sourceforge K5 PAM module, most notably minimum_uid and\n    renew_lifetime.\n\n    Support setting many PAM options from krb5.conf as well as on the PAM\n    command line, using the same application section as the Sourceforge\n    PAM module.  Use the profile reading functions provided by the\n    Kerberos libraries.\n\n    Add support for use_authtok, which is like use_first_pass except that\n    it will never prompt even if no password is currently set.\n\n    Add a search_k5login option to check the user's password against every\n    principal listed in .k5login, to support use of this module to\n    authenticate user access to shared accounts.\n\n    Add an ignore_k5login option that bypasses all checks of .k5login\n    files entirely and relies solely on krb5_aname_to_localname checks.\n\n    Re-add the ccache option to specify the exact file name of the ticket\n    cache, and allow for randomization using mkstemp even when this option\n    is used.\n\n    Only call krb5_kuserok (the .k5login check) when the account to which\n    the user is authenticating is a local account.  It's up to the\n    application to handle authorization checks for non-local accounts.\n\n    Support preliminary checks for password changing by using that to\n    obtain the user's current credentials.  Correctly handle saved\n    passwords from previous authentications or password changes when\n    changing passwords, and correctly set the saved passwords for\n    subsequent password changes in the PAM stack.\n\n    Only initialize the ticket cache once, no matter how many times\n    setcred is called.  This saves duplicate work and works around a bug\n    in X.org xdm that otherwise causes it to lose the PAM environment.\n\n    When reinitializing a ticket cache, never reinitialize the temporary\n    cache created by the authentication call.  Instead, fall back to the\n    default ticket cache name if KRB5CCNAME isn't set.\n\n    Improve support for no_ccache.  Now, it doesn't even generate a\n    temporary ticket cache during authentication but only uses an\n    in-memory credential list.\n\n    Do user ticket validation using the standard Kerberos library call\n    rather than rolling our own code.  This means that the user can now\n    set options in krb5.conf to control whether that call should fail if\n    the local keytab isn't readable or contains no usable keys.\n\n    Completely rewrite the man page.  Clean it up and make it more\n    readable and fully document all of the options.  Also rewrite the\n    README file and clean up the rest of the package documentation.\n\n    Don't create a ticket cache until after successful authentication.\n\n    Understand the FILE: prefix to Kerberos ticket cache names and compare\n    and chown ticket caches properly with that prefix.\n\n    Add a trailing nul to the password in the Kerberos prompter function,\n    since some code relies on it being there.\n\n    Review the return status of each PAM function and ensure that we only\n    return failure statuses that are supported for that function.\n\n    Rename all internal functions with a pamk5_* prefix to avoid\n    conflicting with any application or system library functions.\n\n    Eliminate global variables in the PAM module and do a better job at\n    cleaning up memory usage.  There are still a few places where the PAM\n    conversation functions may leak memory due to an incomplete\n    specification in the PAM API on who should free what memory.\n\n    The logging messages produced when debug is set should now be more\n    consistent and more complete.\n\npam-krb5 1.2 (2005-09-27)\n\n    Don't reinitialize the ticket cache if the old and new cache have the\n    same name, since otherwise we end up destroying it.\n\n    Always set KRB5CCNAME, even when reinitializing.\n\n    When reinitializing, look for the ticket cache in the saved context\n    even if KRB5CCNAME isn't set.  OpenSSH calls it this way.\n\n    Drop the ccache option and add ccache_dir instead, which only\n    specifies the directory for ticket caches and is therefore easier to\n    implement.\n\npam-krb5 1.1 (2005-08-31)\n\n    Add support for reinitialization/refreshing of credentials in\n    pam_sm_setcred.\n\n    Set PAM_AUTHTOK and PAM_OLDAUTHTOK when authenticating to better\n    support stacking this module with others.\n\n    Add an ignore_root option to not do anything when the account to which\n    the user is authenticating is root.  This allows one to log in via\n    console as root even when the network is down (thereby breaking the\n    PAM module in ways that login doesn't like due to timeouts in the\n    Kerberos libraries).\n\n    Store the entire context structure in PAM's memory rather than just\n    the name of the ticket cache so that we can pass around more data to\n    ourself.\n\n    Bring errors more in line with the official PAM specification.\n\n    Move prompt generation into the PAM module rather than letting the\n    Kerberos library generate the prompt.  This way we don't leak\n    principal information to the caller, and the non-standard prompt also\n    broke some applications like gksudo.\n\n    Support session management and destruction of the ticket cache on\n    close of session.\n\n    Don't require that the user have a local account on the system.\n\n    Include the user UID in the default ticket cache name so that rpc.gssd\n    and similar programs can find it.\n"], "fixing_code": ["                      User-Visible pam-krb5 Changes\n\npam-krb5 4.9 (unreleased)\n\n    SECURITY: All previous versions of this module could overflow the\n    buffer provided by the underlying Kerberos library for the response to\n    a prompt by writing a single nul character past the end of the buffer.\n    (CVE-2020-10595)\n\n    Support use_pkinit with MIT Kerberos.  (Debian Bug#871699)\n\n    Reject passwords as long or longer than PAM_MAX_RESP_SIZE (normally\n    512 octets), since extremely long passwords can be used for a denial\n    of service attack via the Kerberos string to key function.  Thanks to\n    Florian Best for pointing out this issue and suggesting a good fix.\n\n    Use explicit_bzero instead of memset, where available, to overwrite\n    the memory used by PAM responses before freeing.  This reduces the\n    lifetime of passwords and other secrets in memory.\n\n    Return more accurate errors from the Kerberos prompter function if it\n    was unable to prompt for the password.  This may translate into better\n    debug log messages and, in some situations, returning the slightly\n    more accurate PAM_AUTHINFO_UNAVAIL instead of PAM_AUTH_ERR.\n\n    Ensure the module/basic test will run properly when the system\n    krb5.conf file does not specify a default realm.  Reported by TBK.\n\n    Update to rra-c-util 8.2:\n\n    * Fix support for configuring the test suite with a krb5.conf file.\n    * Drop support for Perl 5.6.\n    * Reformat all C source using clang-format 10.\n    * Remove bogus snprintf tests.\n    * Fix misplaced va_end in the pam-util putil_log_failure function.\n    * Skip checking for krb5-config on the path if a prefix was given.\n    * Add SPDX-License-Identifier headers to all substantial source files.\n\n    Update to C TAP Harness 4.6:\n\n    * Fixed malloc error checking in bstrndup.\n    * Fix (harmless) allocation error in runtests driver.\n    * Add support for valgrind testing via test list options.\n    * Report test failures as left and right, not wanted and seen.\n    * Fix is_string comparisons involving NULL pointers and \"(null)\".\n    * Add SPDX-License-Identifier headers to all substantial source files.\n\npam-krb5 4.8 (2017-12-30)\n\n    When verifying that an expired password can still be used to get\n    kadmin/changepw credentials, correctly set the credential options for\n    getting password change credentials, not for getting initial\n    credentials.  This should fix password change issues when, for\n    example, krb5.conf requests that all tickets be proxiable but\n    kadmin/changepw doesn't allow proxiable credentials.  Thanks to\n    Florian Best for the bug report.\n\n    When built against recent versions of Heimdal with richer status codes\n    from PKINIT attempts, report to the user the reason for a PKINIT\n    failure.  Based on work by Henry Jacques.\n\n    Document the test suite configuration files required to run the PKINIT\n    tests.\n\n    Fix expired password tests to work with Heimdal 7.0.1 and later.\n\n    Better document that the default Kerberos library ticket cache\n    location is not used (and why), and how to set configuration\n    parameters in krb5.conf.  Thanks, Matthew Gabeler-Lee.  (Debian\n    Bug#872943)\n\n    Compile cleanly under GCC 7 and Clang warnings and Clang's static\n    analyzer.\n\n    Rename the script to bootstrap from a Git checkout to bootstrap,\n    matching the emerging consensus in the Autoconf world.\n\n    Update to rra-c-util 7.0:\n\n    * Fix new warnings in GCC 7.\n    * Support a warning build under Clang.\n    * Avoid zero-length allocations in reallocarray and vector.\n    * Probe for warning flags instead of hard-coding a list.\n    * New test for obsolete URLs and email addresses.\n    * Remove unused portable replacements for strlcpy and strlcat.\n    * Use C_TAP_SOURCE and C_TAP_BUILD environment variables in tests.\n    * Fix portability defines for anonymous principal strings.\n    * Clear errno on pam_modutil_getpwnam to improve other testing.\n    * Add portability defines for macOS's PAM implementation.\n    * Add new Autoconf macro to probe for pam_strerror const usage.\n    * Support Solaris 10's included Kerberos.\n\n    Update to C TAP Harness 4.2:\n\n    * Avoid zero-length allocations in breallocarray.\n    * Add is_blob and is_bool functions.\n    * Use C_TAP_SOURCE and C_TAP_BUILD environment variables in tests.\n    * Fix segfault in runtests with an empty test list.\n    * Display verbose test results with -v or C_TAP_VERBOSE.\n    * Test infrastructure builds cleanly with Clang warnings.\n\npam-krb5 4.7 (2014-12-25)\n\n    Add a no_update_user option that disables the normal update of the\n    PAM_USER PAM variable after canonicalization of the username.  When\n    this is set, pam-krb5 will not convert full principal names to local\n    usernames where possible for the rest of the PAM stack.\n\n    Suppress spurious password prompt from Heimdal when authenticating\n    with PKINIT.\n\n    Map unknown realm errors from the Kerberos libraries to the PAM error\n    code PAM_AUTHINFO_UNAVAIL instead of PAM_AUTH_ERR.\n\n    Treat an KRB5_GET_IN_TKT_LOOP error as an incorrect password.  Heimdal\n    KDCs sometimes return it, and Heimdal kinit treats it this way.\n    Similarly, treat a KRB5_BAD_ENCTYPE error as an incorrect password,\n    since this error is returned by a Heimdal 1.6-rc2 KDC for incorrect\n    preauth from a MIT Kerberos 1.12.1 client.\n\n    Add the version number at which each module option was added with its\n    current meaning to the documentatation.\n\n    Update to rra-c-util 5.6:\n\n    * Suppress warnings from Kerberos headers in non-system paths.\n    * Fix probing for Heimdal's libroken to work with older versions.\n    * Fix Kerberos header detection if root or include paths are given.\n    * Pass --deps to krb5-config in the non-reduced-dependencies case.\n    * Provide a reallocarray replacement for platforms without it.\n    * Use reallocarray where appropriate.\n    * Drop checks for NULL before freeing pointers.\n    * Drop explicit pointer initialization to NULL and rely on calloc.\n    * Check the return status of snprintf and vsnprintf properly.\n    * Preserve errno if snprintf fails in vasprintf replacement.\n    * Suppress a dummy symbol in the client library that could leak.\n    * Fix syntax errors when building with a C++ compiler.\n    * Avoid test suite failures where tested functions are macros.\n\n    Update to C TAP Harness 3.2:\n\n    * Reopen standard input to /dev/null when running a test list.\n    * Don't leak extraneous file descriptors to tests.\n    * Suppress lazy plans and test summaries if the test failed with bail.\n    * bail and sysbail now exit with status 255 to match Test::More.\n    * runtests now treats the command line as a list of tests by default.\n    * The full test executable path can now be passed to runtests -o.\n    * Improved harness output for tests with lazy plans.\n    * Improved harness output to a terminal for some abort cases.\n    * Flush harness output after each test even when not on a terminal.\n\npam-krb5 4.6 (2012-06-02)\n\n    Add an anon_fast option that attempts anonymous authentication\n    (generally implemented via anonymous PKINIT inside the Kerberos\n    library) and then, if successful, uses those credentials for FAST\n    armor.  If fast_ccache and anon_fast are both specified, anonymous\n    authentication will be used as a fallback if the specified FAST ticket\n    cache doesn't exist.  Based on patches from Yair Yarom.\n\n    Add a user_realm option to only set the realm for unqualified user\n    principals.  This differs from the existing realm option in that realm\n    also changes the default realm for authorization decisions and for\n    verification of credentials.  Update the realm option documentation to\n    clarify the differences and remove incorrect information.  Patch from\n    Roland C. Dowdeswell.\n\n    Add a no_prompt option to suppress the PAM module's prompt for the\n    user's password and defer all prompting to the Kerberos library.  This\n    allows the Kerberos library to have complete control of the prompting\n    process, which may be desirable if authentication mechanisms other\n    than password are in use.  Be aware that, with this option set, the\n    PAM module has no control over the contents of the prompt and cannot\n    store the user's password in the PAM data.  Based on a patch by Yair\n    Yarom.\n\n    Add a silent option to force the module to behave as if the\n    application had passed in PAM_SILENT and suppress text messages and\n    errors from the Kerberos library.  Patch from Yair Yarom.\n\n    Add preliminary support for Kerberos trace logging via a trace option\n    that enables trace logging if supported by the underlying Kerberos\n    library.  The option takes as an argument the file name to which to\n    log trace output.  This option does not yet work with any released\n    version of Kerberos, but may work with the next release of MIT\n    Kerberos.\n\n    MIT Kerberos does not add a colon and space to its password prompts,\n    but Heimdal does.  pam-krb5 previously unconditionally added a colon\n    and space, resulting in doubled colons with Heimdal.  Work around this\n    inconsistency by not adding the colon and space if already present.\n\n    Fix alt_auth_map support to preserve the realm of the authentication\n    identity when forming the alternate authentication principal, matching\n    the documentation.\n\n    Document that the alt_auth_map format may contain a realm to force all\n    mapped principals to be in that realm.  In that case, don't add the\n    realm of the authentication identity.  Note that this can be used as a\n    simple way to attempt authentication in an alternate realm first and\n    then fall back to the local realm, although any complex attempt at\n    authentication in multiple realms should instead run the module\n    multiple times with different realm settings.\n\n    Avoid a NULL pointer dereference if krb5_init_context fails.\n\n    Fix initialization of time values in the module configuration on\n    platforms (like S/390X) where krb5_deltat is not equivalent to long.\n\n    Close a memory leak when search_k5login is set but the user has no\n    .k5login file.\n\n    Close several memory leaks in alt_auth_map support.\n\n    Suppress bogus error messages about unknown option for the realm\n    option.  The option was being parsed and honored despite the error.\n\n    Retry authentication under try_first_pass on several other errors in\n    addition to decrypt integrity check errors to handle a wider array of\n    possible \"password incorrect\" error messages from the KDC.\n\n    Update to rra-c-util 4.4:\n\n    * Replacement strndup now works with non-nul-terminated strings.\n    * New Kerberos test setup that simplifies writing tests.\n    * Add -D_FORTIFY_SOURCE=2 to the make warnings flags.\n    * Use --deps flag to krb5-config by default.\n    * Suppress __alloc_size__ attribute with older versions of gcc.\n    * Suppress attribute warnings for non-gcc compilers.\n\n    Update to C TAP Harness 1.12:\n\n    * Add bstrndup to the basic C TAP library.\n    * Only use feature-test macros when requested or built with gcc -ansi.\n    * New tests/tap/macros.h header with some common definitions.\n    * Drop is_double from the C TAP library to avoid requiring -lm.\n    * Avoid using local in the shell libtap.sh library.\n\npam-krb5 4.5 (2011-12-24)\n\n    Suppress the notice that the password is being changed because it's\n    expired if force_first_pass or use_first_pass is set in the password\n    stack, indicating that it's stacked with another module that's also\n    doing password changes.  This is arguable, but without this change the\n    notification message of why the password is being changed shows up\n    confusingly in the middle of the password change interaction.  Based\n    on a patch by William Yang.\n\n    Some old versions of Heimdal (0.7.2 in OpenBSD 4.9, specifically)\n    reportedly return KRB5KDC_ERR_KEY_EXP for accounts with expired\n    keys even if the supplied password is wrong.  Work around this by\n    confirming that the PAM module can obtain tickets for kadmin/changepw\n    before returning a password expiration error instead of an invalid\n    password error.  Based on a patch by William Yang.\n\n    The location of the temporary root-owned ticket cache created during\n    the authentication process is now also controlled by the ccache_dir\n    option (but not the ccache option) rather than forced to be in /tmp.\n    This will allow system administrators to configure an alternative\n    cache directory so that pam-krb5 can continue working when /tmp is\n    full.\n\n    Report more specific errors in syslog if authorization checks (such as\n    .k5login checks) fail.\n\n    Pass a NULL principal to krb5_set_password with MIT client libraries\n    to prefer the older change password protocol for compatibility with\n    older KDCs.  This is not necessary on Heimdal since Heimdal's\n    krb5_set_password tries both protocols.\n\n    Improve logging and authorization checks when defer_pwchange is set\n    and a user authenticates with an expired password.\n\n    When probing for Kerberos libraries, always add any supplemental\n    libraries found to that point to the link command.  This will fix\n    configure failures on platforms without working transitive shared\n    library dependencies.\n\n    Close some memory leaks where unparsed Kerberos principal names were\n    never freed.\n\n    Restructure the code to work with OpenPAM's default PAM build\n    machinery, which exports a struct containing module entry points\n    rather than public pam_sm_* functions.  Thanks to Fredrik Pettai for\n    the information.\n\n    In debug logging, report symbolic names for PAM flags on PAM function\n    entry rather than the numeric PAM flags.  This helps with automated\n    testing and with debugging PAM problems on different operating\n    systems.\n\n    Include <krb5/krb5.h> if <krb5.h> is missing, which permits finding\n    the header file on NetBSD systems.  Thanks to Fredrik Pettai for the\n    report.\n\n    Replace the Kerberos compatibility layer with equivalent but\n    better-structured code from rra-c-util 4.0.\n\n    Avoid krb5-config and use manual library probing if --with-krb5-lib or\n    --with-krb5-include were given to configure.  This avoids having to\n    point configure at a nonexistent krb5-config to override its results.\n\n    Use PATH_KRB5_CONFIG instead of KRB5_CONFIG to locate krb5-config in\n    configure, to avoid a conflict with the variable used by the Kerberos\n    libraries to find krb5.conf.\n\n    Change references to Kerberos v5 to just Kerberos in the\n    documentation.  Kerberos v5 has been the default version of Kerberos\n    for over ten years now.\n\n    Update to rra-c-util 4.0:\n\n    * Add notices to all files copied over from rra-c-util.\n    * Include strings.h for additional POSIX functions where found.\n    * Fix detection of whether PAM uses const on FreeBSD.\n    * Update warning flags for make warnings for GCC 4.6.1.\n    * Limit symbol exports even on systems without GNU ld.\n    * Fix replacement mkstemp to use long long where available.\n    * Improve stripping of /usr/include from krb5-config results.\n    * Use issetugid where available, not the misnamed issetuidgid.\n\n    Update to C TAP Harness 1.9:\n\n    * Add bmalloc, bcalloc, brealloc, and bstrdup TAP library functions.\n    * Fix runtests to honor -s even if BUILD and -b aren't given.\n    * Add test_tmpdir and test_tmpdir_free to TAP library.\n    * runtests now frees all allocated resources on exit.\n\npam-krb5 4.4 (2010-12-31)\n\n    Do not prompt for a password when try_pkinit is set and the module is\n    built against MIT Kerberos.  This fixes a spurious password prompt\n    introduced in 4.1, but partly reintroduces the bug fixed in 4.1 where\n    the user's password is not saved in the PAM data if the authentication\n    falls back to password when PKINIT fails.  This requires more work\n    to fix and will be addressed in a subsequent release.  Thanks to\n    \u0411\u0440\u0430\u043d\u043a\u043e \u041c\u0430\u0458\u0438\u045b (Branko Majic) for the report.\n\n    Reorganize the configuration section of the pam_krb5 man page to\n    divide the many PAM module options into sections.\n\n    When probing for <ibm_svc/krb5_svc.h> (part of AIX's bundled Kerberos\n    implementation), include <krb5.h> before attempting to include that\n    header to quiet confusing Autoconf warnings.  Reported by Wilfried\n    Weiss.\n\n    Update to rra-c-util 3.0:\n\n    * Fix compilation of the replacement snprintf for old systems.\n    * Look for krb5-config in /usr/kerberos/bin for Red Hat systems.\n    * Fix compilation with OpenBSD's Heimdal without separate libroken.\n\npam-krb5 4.3 (2010-06-09)\n\n    Add a fast_ccache option that, if set, points to a Kerberos ticket\n    cache used for Flexible Authentication Secure Tunneling (FAST) to\n    protect the authentication.  FAST is a mechanism to protect Kerberos\n    against password guessing attacks and provide other security\n    improvements.  This option is only available when built against\n    Kerberos libraries with FAST support (currently only MIT Kerberos 1.7\n    or later).  Patch from Sam Hartman.\n\n    Fix error in freeing a previous alt_auth_map setting when parsing\n    configuration options.  Patch from Sam Hartman.\n\n    Fix the linker flags for Solaris with the native compiler.  Thanks,\n    Kevin Sumner.\n\npam-krb5 4.2 (2009-11-25)\n\n    Add a new fail_pwchange option, which suppresses password changes for\n    expired passwords and treats expired passwords the same as incorrect\n    passwords.\n\n    Include all the new header files from the portability code so that\n    it will actually compile on non-Linux platforms.\n\npam-krb5 4.1 (2009-11-20)\n\n    Return PAM_SUCCESS, not PAM_USER_UNKNOWN, for ignored users in\n    pam_setcred.  It's safe to return success when doing nothing in\n    pam_setcred because the stack has already been frozen after the\n    authentication step, and returning an error causes the stack to fail\n    on some other Linux PAM implementations.  Thanks, Ian Ward Comfort.\n\n    In the second pass through the password group, prompt for the new\n    password and store it in the PAM data even if the user is being\n    ignored.  This is required to allow this module to be stacked with\n    another module that uses use_authtok.  Without this behavior, the\n    second module won't be able to work for any ignored user since it will\n    see no saved password and use_authtok will reject the password change.\n\n    Fix return status from pam_sm_acct_mgmt if we were unable to retrieve\n    PAM_USER.\n\n    Log successful authentications to syslog with priority LOG_INFO,\n    including the Kerberos principal used for authentication.\n\n    Log failed authentication to syslog with priority LOG_NOTICE,\n    including roughly the same additional information that the Linux PAM\n    pam_unix logs by default.\n\n    Use pam_syslog for logging where available.  This means pam-krb5 log\n    messages will look like all other log messages for Linux PAM modules\n    on Linux.  Change the format of log messages on all platforms to\n    hopefully be somewhat clearer.\n\n    Rationalize logging.  The module should now follow the recommendations\n    of the Linux PAM Module Writers' Guide for log levels.  More errors\n    are logged at LOG_ERR instead of LOG_DEBUG, and system resource errors\n    are now logged at LOG_CRIT instead of LOG_ERR.\n\n    Add additional error and debug logging in places where significant\n    actions or failures may happen without previously being logged.  Also\n    add failure information from PAM or Kerberos libraries to messages\n    where appropriate.\n\n    Add replacement snprintf, vsnprintf, and mkstemp functions for\n    pointless portability to ancient systems.\n\npam-krb5 4.0 (2009-11-13)\n\n    UPGRADE WARNING: If you were using pam_krb5 with the use_authtok\n    parameter in the password group, you will need to add use_first_pass\n    to your configuration to keep the same behavior.  See below for\n    details.\n\n    UPGRADE WARNING: If you used the use_authtok parameter in the\n    authentication group, you should change it to force_first_pass.\n\n    Previous versions of this module incorrectly implemented the standard\n    use_authtok parameter.  use_authtok applies only to the password group\n    and says to use the new password stored in the PAM data rather than\n    prompting for a new password.  It doesn't imply anything about where\n    to obtain the old password, but it was implemented as requiring both\n    the old and new password be in the PAM stack already.  This doesn't\n    work when stacked with pam_cracklib.  Change use_authtok to have the\n    correct meaning, which means that password group configurations may\n    need to add use_first_pass to use_authtok to get the desired behavior.\n\n    use_first_pass and try_first_pass no longer affect how the new\n    password is obtained during password changes.  To use a password\n    obtained by a previous module, use use_authtok instead.\n\n    A new option, force_first_pass, is now supported for both the\n    authentication and password groups.  It tells the module to always get\n    the user's current password from the PAM data and fail without\n    prompting if it isn't already set.  This is the meaning that\n    use_authtok previously had for the current password.\n\n    use_authtok no longer has any meaning for the authentication stack.\n    Use force_first_pass instead, which does the same as use_authtok used\n    to do.  use_authtok will be temporarily converted to force_first_pass\n    in the authentication group and log a diagnostic, but this will be\n    removed in the future.\n\n    Stop returning PAM_IGNORE from pam_setcred if the user is ignored or\n    didn't log in via Kerberos and instead return PAM_USER_UNKNOWN.  This\n    fixes problems with the Linux PAM library where returning PAM_IGNORE\n    would cause pam_setcred to fail even if other modules succeeded.\n    Since pam_authenticate never returned PAM_IGNORE, this change should\n    not cause any differences in behavior.\n\n    Do not use issetugid on Solaris to determine when to avoid refreshing\n    the ticket cache named in KRB5CCNAME during pam_setcred.  Instead,\n    compare effective and real UID and GID and permit KRB5CCNAME to be\n    trusted if they match.  This allows setuid screensavers on Solaris to\n    refresh ticket caches and makes behavior on Solaris match other\n    platforms.  Using issetugid is arguably safer since it protects\n    programs that switch users via setuid to a user other than the calling\n    user but still should not trust the original environment, but such\n    programs are rare in the PAM context and should not be calling\n    pam_setcred anyway unless the calling user is permitted to generally\n    act as the target user.  Thanks, William Yang.\n\n    Do the same logging in pam_sm_open_session and pam_sm_close_session as\n    we do with the other functions.  This will mean pam_sm_open_session\n    calls will be logged as pam_sm_open_session, not as pam_sm_setcred as\n    before.\n\n    pam-krb5 is now built using Automake and Libtool to bring it more in\n    line with other software packages.  This means that it now relies on\n    Libtool to know how to generate a loadable module rather than\n    hand-configured linker rules.  This may improve portability on some\n    platforms and may hurt it on other platforms.\n\n    If configured with a prefix of /usr on Linux, use /lib, /lib32, or\n    /lib64 as an installation path based on the size of an integer in the\n    compilation environment rather than based on known 64-bit Linux\n    variants.\n\n    Update to rra-c-util 2.0:\n\n    * Sanity-check the results of krb5-config before proceeding.\n    * Fall back on manual probing if krb5-config results don't work.\n    * Don't break if the user clobbers CPPFLAGS at build time.\n\npam-krb5 3.15 (2009-07-21)\n\n    Fix a segfault (null pointer dereference) if pam-krb5 is configured\n    with use_first_pass or use_authtok and there is no password stored in\n    the PAM stack.  Thanks to Jonathan Guthrie for the bug report.\n\npam-krb5 3.14 (2009-07-18)\n\n    Return PAM_IGNORE instead of PAM_PERM_DENIED from pam_chauthtok for\n    ignored users.  This allows making the Kerberos PAM module mandatory\n    for password changes and still falling back to other PAM modules for\n    ignored users.  Thanks, Steve Langasek.\n\n    Always treat the empty password as an authentication failure rather\n    than passing it to the Kerberos libraries.  The Kerberos libraries\n    may treat it as equivalent to no password and prompt for a password\n    without our knowledge, leading to the user authenticating with a\n    different password than the one stored in the PAM stack.  This could\n    cause unexpected problems with some PAM configurations.  It's safer\n    to make the assumption that the empty password is always invalid and\n    reject it outside of the Kerberos libraries.  Thanks, Sanjay Sha.\n\n    Fix error handling if ticket cache initialization fails.\n    Authentication will still fail, but this avoids a segfault from a\n    double-free of the ticket cache structure.  The most common cause of\n    this problem was having the attempt to initialize the ticket cache\n    be blocked by AppArmor.  Thanks to Alex Mauer for the report.\n\n    Call krb5_free_error_string correctly, fixing a portability issue\n    when building against Heimdal.  Thanks, Andrew Drake.\n\n    Work around a deficiency in pam_putenv on FreeBSD 7.2 that doesn't\n    allow deleting environment variables, only setting them to empty\n    values.  Thanks, Andrew Elble.\n\npam-krb5 3.13 (2009-02-11)\n\n    SECURITY: When built against MIT Kerberos, if pam_krb5 is called in a\n    setuid context (effective UID or GID doesn't match the real UID or\n    GID), use krb5_init_secure_context instead of krb5_init_context.  This\n    ignores environment variable settings for the local Kerberos\n    configuration and keytab.  Previous versions could allow a local\n    attacker to point a setuid program that used PAM authentication at a\n    different Kerberos configuration under the attacker's control,\n    possibly resulting in privilege escalation.  Heimdal handles this\n    logic within the Kerberos libraries and therefore was not affected.\n    (CVE-2009-0360)\n\n    SECURITY: Disable pam_setcred(PAM_REINITIALIZE_CREDS) for setuid\n    applications.  If pam_krb5 detects this call in a setuid context, it\n    now logs an error and returns success without doing anything.  Solaris\n    su calls pam_setcred with that option rather than PAM_ESTABLISH_CREDS\n    after authentication and without wiping the environment, leading\n    previous versions of pam_krb5 to trust the KRB5CCNAME environment\n    variable for the ticket cache location.  This permitted an attacker to\n    use previous versions of pam_krb5 to overwrite arbitrary files with\n    Kerberos credential caches that were left owned by the attacker.\n    Setuid screen lock programs may also be affected.  Discovered by Derek\n    Chan and reported by Steven Luo.  Thanks to Sam Hartman and Jeffrey\n    Hutzelman for additional analysis.  (CVE-2009-0361)\n\n    If a prefix of /usr is requested at configure time, install the PAM\n    module into /lib/security or /lib64/security on Linux, matching the\n    standard Linux-PAM module location.  Use lib64 instead of lib on\n    64-bit SPARC, PowerPC, and S390 Linux as well as x86_64.  Patch from\n    Peter Breitenlohner.\n\n    Fix a build problem when builddir != srcdir introduced in 3.11.  Patch\n    from Peter Breitenlohner.\n\n    Add support for the old Heimdal krb5_get_error_string interface.\n    Thanks, Chaskiel Grundman.\n\n    Add --with-krb5-include and --with-krb5-lib configure options to allow\n    more specific setting of paths if necessary.\n\n    If krb5-config isn't available, attempt to determine if the library\n    directory for the Kerberos libraries is lib32 or lib64 instead of lib\n    and set LDFLAGS accordingly.  Based on an idea from the CMU Autoconf\n    macros.\n\npam-krb5 3.12 (2008-11-13)\n\n    Add alt_auth_map configuration option, which allows mapping of\n    usernames to alternative Kerberos principals, useful primarily for\n    using particular instances for access to a given PAM-authenticated\n    service.  Also added force_alt_auth and only_alt_auth options to\n    control when alternative Kerberos principals are used.  Patch from\n    Booker Bense.\n\n    Fix incorrect error handling for bad .k5login ownership when\n    search_k5login is set, leading to a NULL pointer dereference and a\n    segfault.  Thanks, Andrew Deason.\n\n    Fix double-free of the ticket cache structure if creation of the\n    ticket cache in the session module fails.  Thanks, Jens Jorgensen.\n\n    Log all syslog messages to LOG_AUTHPRIV, or LOG_AUTH if the system\n    doesn't define LOG_AUTHPRIV.  Thanks, Mark Painter.\n\n    Fix portability to AIX's bundled Kerberos.  Thanks, Markus Moeller.\n\n    When debugging is enabled, log an exit status of PAM_IGNORE as ignore\n    rather than failure.\n\n    Document that pam-krb5 must be listed in the session group as well as\n    the auth group for interactive logins or OpenSSH won't set up the\n    user's credential cache properly.\n\n    Document adding ignore=ignore to complex [] action configuration for\n    the session and account groups since the module now returns PAM_IGNORE\n    instead of PAM_SUCCESS for accounts that didn't use Kerberos.\n\npam-krb5 3.11 (2008-07-10)\n\n    pam_setcred, pam_open_session, and pam_acct_mgmt now return PAM_IGNORE\n    for ignored users or non-Kerberos logins rather than PAM_SUCCESS.\n    This return code tells the PAM library to continue as if the module\n    were not present in the configuration and allows sufficient to be\n    meaningful for pam-krb5 in account and session groups.\n    pam_authenticate continues to return failure for ignored users;\n    PAM_IGNORE would arguably be more correct, but increases the risk of\n    security holes through incorrect configuration.\n\n    Support correct password expiration handling according to the PAM\n    standard (returning success from pam_authenticate and an error from\n    pam_acct_mgmt and completing the authentication after pam_chauthotk).\n    This is not the default since it opens security holes with broken\n    applications that don't call pam_acct_mgmt or ignore its exit status.\n    To enable it, set the PAM option defer_pwchange for applications known\n    to make the correct PAM calls and check return codes.\n\n    Add a new option to attempt change of expired passwords during\n    pam_authenticate if Kerberos authentication returns a password expired\n    error.  Normally, the Kerberos library will do this for you, but some\n    Kerberos libraries (notably Solaris) disable that code.  This option\n    allows simulation of the normal Kerberos library behavior on those\n    platforms.\n\n    Work around an apparent Heimdal bug when krb5_free_cred_contents is\n    called on an all-zero credential structure.  It's not clear what's\n    going on here and the Heimdal code looks correct, but avoiding the\n    call fixes the problem.\n\n    Warn if more than one of use_authtok, use_first_pass, and\n    try_first_pass is set and use the strongest of the one set.\n\n    Remove the workaround for versions of MIT Kerberos that didn't\n    initialize a krb5_get_init_creds_opt structure on opt_alloc.  This bug\n    was only present in early versions of 1.6; the correct fix is to\n    upgrade.\n\n    Add an additional header check for AIX's bundled Kerberos.\n\n    If KRB5_CONFIG was explicitly set in the environment, don't use a\n    different krb5-config based on --with-krb5.  If krb5-config isn't\n    executable, don't use it.  This allows one to force library probing by\n    setting KRB5_CONFIG to point to a nonexistent file.\n\n    Sanity-check the results of krb5-config before proceeding and error\n    out in configure if they don't work.\n\n    For Kerberos libraries without krb5-config, also check for networking\n    libraries (-lsocket and friends) before checking for Kerberos\n    libraries in case shared library dependencies are broken.\n\n    Fix Autoconf syntax error when probing for libkrb5support.  Thanks,\n    Mike Garrison.\n\n    Set an explicit visibility of hidden for all internal functions at\n    compile time if gcc is used to permit better optimization.  Hide all\n    functions except the official interfaces using a version script on\n    Linux.  This protects against leaking symbols into the application\n    namespace and provides some mild optimization benefit.\n\n    Fix the probing of PAM headers for const on Mac OS X.  This will\n    suppress some harmless compiler warnings there.  Thanks, Markus\n    Moeller.\n\npam-krb5 3.10 (2007-12-28)\n\n    The workaround for krb5_get_init_creds_opt_alloc problems in MIT\n    Kerberos 1.6 broke PKINIT support with Heimdal.  Only apply that\n    workaround when building against the MIT Kerberos libraries.  Thanks\n    to Jaakko Pero for the detailed report.\n\n    If no_ccache is set, always exit successfully from pam_setcred or\n    pam_open_session, even if we couldn't retrieve module data.  Thanks,\n    Markus Moeller.\n\n    When keytab is set, properly handle failure to create a keytab cursor\n    and don't assume that the cursor is valid.  Thanks, Markus Moeller.\n\n    Define _ALL_SOURCE on AIX to get prototypes for snprintf.\n\n    Add additional portability glue and Autoconf probes to support\n    building against the version of Kerberos bundled with AIX.  Support\n    for this should be considered alpha in this release.  Thanks to Markus\n    Moeller for the initial patch.\n\npam-krb5 3.9 (2007-11-12)\n\n    If use_authtok is set, fail even if we can retrieve the stored PAM\n    password if that password is set to NULL.  Apparently that can happen\n    in some cases, such as with pam_cracklib.  Thanks to Christian Holler\n    for the diagnosis and a patch.\n\n    Add a new clear_on_fail option for the password group.  If set, when a\n    password change fails, set PAM_AUTHTOK to NULL so that subsequent\n    modules in the PAM stack with use_authtok set will also fail.  Just\n    returning failure doesn't abort the stack on the second pass when\n    actual password changes are made.  This is not the default since it\n    interferes with other desirable PAM configurations.  It's useful\n    primarily when using the PAM stack to synchronize passwords between\n    multiple environments.  Thanks to Christian Holler and Tomas Mraz for\n    the analysis.\n\n    Fix portability issues with Heimdal, versions of PAM that don't\n    provide pam_modutil_getpwnam, and compiler warnings when building\n    PKINIT support.  Thanks, Martin von Gagern.\n\n    Fix parsing of the keytab PAM option.  Thanks, Markus Moeller.\n\n    Return PAM_AUTHINFO_UNAVAIL instead of PAM_AUTH_ERR when unable to\n    resolve the Kerberos realm.  Thanks, Frank Cornelissen.\n\n    Add a new debugging section to the README.\n\npam-krb5 3.8 (2007-09-30)\n\n    krb5_get_init_creds_opt_alloc doesn't initialize the returned\n    structure with the default flags in MIT Kerberos 1.6, which meant that\n    users with expired passwords were not being prompted to change their\n    password but just rejected.  Fixed by always calling _init before\n    setting the credential flags, regardless of the provenance of the opt\n    structure.  Thanks, Michael Richters.\n\n    Fix configure and Makefile glue so that Mac OS X and HP-UX have a\n    chance of working (still untested).\n\n    Add a make warnings target with aggressive gcc warning options.  Treat\n    negative minimum UIDs as zero so that UID comparisons can always be\n    done unsigned.  Add casts and unused attributes as needed.\n\npam-krb5 3.7 (2007-09-29)\n\n    If given an explicit keytab path to use for credential verification,\n    use the first principal found in that keytab as the principal for\n    verification rather than the library default (which is normally the\n    host/* principal for the local system and may not be found in that\n    keytab).\n\n    When authenticating, don't store our context data until after\n    authentication has succeeded.  Otherwise, we may destroy the ticket\n    cache of a previous successful authentication.  This bug would only\n    affect configurations where pam_krb5 was run multiple times with\n    different settings, such as multiple realms.  Thanks to Dave Botsch\n    for the report.\n\n    Use pam_modutil_getpwnam instead of getpwnam if available for better\n    thread safety.\n\n    Don't store PAM data unless we're saving a ticket cache.  All other\n    calls use it for is to find the ticket cache, so without a cache it's\n    pointless and means we run the risk of stomping on ourselves in\n    multithreaded programs.\n\n    Still canonicalize the PAM user before returning when not saving a\n    ticket cache.\n\n    Fix determination of linker flags on non-x86_64 Linux.  Always link\n    with -fPIC when using GCC, just in case.\n\n    Add compilation options for Mac OS X and HP-UX (untested).\n\n    Use pam_krb5 instead of ctx for our PAM data name to reduce the\n    chances of collision.\n\npam-krb5 3.6 (2007-09-18)\n\n    When the local user doesn't exist and search_k5login is enabled, fall\n    back to simple Kerberos authentication just as if the account existed\n    with no .k5login file.  This avoids trying to verify an all-zero\n    credentials structure, leading to non-expoloitable segfaults on x86_64\n    systems.  Be more careful in general about setting error codes in the\n    search_k5login implementation.\n\n    Explicitly clear the forwardable and proxiable options and don't ask\n    for renewable tickets when getting a ticket for the password changing\n    service.  Otherwise, system-wide defaults and PAM configuration will\n    apply to those tickets as well and the resulting ticket request may be\n    rejected based on KDC configuration.  Based on a patch by Sergio\n    Gelato.\n\n    Do username canonicalization earlier so that .k5login checking and\n    similar work uses the correct username but only change the PAM\n    username if authentication succeeds.  Document that username\n    canonicalization won't work with unmodified OpenSSH and with several\n    common PAM modules.  Thanks to R. Scott Bailey for the bug report and\n    analysis.\n\n    Add a prompt_principal option which, if set, causes the PAM module to\n    prompt the user for the Kerberos principal to use for authentication\n    before prompting for the password.\n\n    Try to determine whether the PAM headers use const in the prototypes\n    of such things as pam_get_item and adjust accordingly.  This should\n    address most compiler warnings on Solaris.  Thanks, Markus Moeller.\n\n    Change lib to lib64 on x86_64 Linux to allow for the magical $ISA\n    parameter in Red Hat's PAM configuration.  Hopefully this won't cause\n    problems elsewhere.\n\n    Support DESTDIR for make install.\n\npam-krb5 3.5 (2007-04-10)\n\n    Don't try to chown non-FILE ticket caches, which among other things\n    breaks using pam-krb5 with Heimdal KCM caches.  Thanks, Jeremy\n    Jackson.\n\n    When logging session deletion via pam_setcred or pam_close_session,\n    don't look for the username in the PAM context after it's been freed.\n    Thanks, Markus Moeller.\n\n    Map more Kerberos status codes to PAM status codes for authentication\n    errors.\n\npam-krb5 3.4 (2007-01-28)\n\n    More compilation fixes for Heimdal 0.7, which has a pkinit function\n    but takes a different number of arguments.  Thanks, Morgan LEFIEUX.\n\n    Never call error_message directly on Heimdal.  krb5_get_err_text can\n    cope with a NULL context and krb5-config on Heimdal doesn't include\n    -lcom_err.\n\n    Handle a NULL return from krb5_get_error_message, since that seems\n    possible in some edge cases.\n\n    Call krb5_get_error_message on Heimdal as well if it's available,\n    since it's supported by the 0.8 release candidates.\n\npam-krb5 3.3 (2007-01-24)\n\n    Support the new MIT Kerberos error message functions.\n\n    Fix compilation errors in the Heimdal PKINIT support and don't be\n    confused by a similar function in the MIT Kerberos PKINIT branch.\n    Thanks to Douglas E. Engert for the testing and patch.\n\n    Fix compilation errors with Heimdal 0.7, which has some of the PKINIT\n    functions but doesn't define the same error codes.  Thanks, Morgan\n    LEFIEUX.\n\n    Initial support for the MIT Kerberos PKINIT branch, which uses a\n    different mechanism for configuring PKINIT support than Heimdal.  Also\n    support configuration of general preauth parameters for the MIT\n    preauth plugin system via the preauth_opt option.  Thanks to Douglas\n    E. Engert for the initial patch.\n\n    If use_pkinit is set in the PAM configuration and PKINIT isn't\n    available or cannot be forced, always fail authentication.\n\npam-krb5 3.2 (2007-01-16)\n\n    This release fixes numerous bugs all identified by Douglas E. Engert\n    while testing with Heimdal and PKINIT support.  Thank you!\n\n    Rewrite the code to drop the credlist data structure since we only\n    ever have one set of credentials, allocate new krb5_creds objects, and\n    do proper memory management, which should plug some memory leaks of\n    the contents of krb5_creds objects.\n\n    Probe for the correct Heimdal function to set default initial\n    credential options.\n\n    Prefix the default cache path with \"FILE:\" to make the cache type\n    explicit.\n\n    Fix installation of the manual page when building from a different\n    directory than the source directory.\n\n    Fix several compilation errors with the PKINIT support with Heimdal\n    0.8rc1 or later.  This code should still be considered alpha-quality.\n\npam-krb5 3.1 (2007-01-03)\n\n    Fix an infinite loop with failed Kerberos authentication and a doubled\n    colon that causes a syntax error with some compilers.  Thanks, Markus\n    Moeller.\n\n    Move the check for users we should ignore to pam_sm_authenticate\n    from pamk5_password_auth so that it's consistently done in the API\n    function.  This also avoids bogus log messages when authenticating as\n    an ignored user with debug enabled.\n\npam-krb5 3.0 (2006-12-18)\n\n    Add preliminary PKINIT support, contributed by Douglas E. Engert.\n    I reorganized and refactored the code extensively and it therefore may\n    not compile; until it has received more testing, it should be\n    considered alpha-quality.  Currently, PKINIT support requires Heimdal\n    0.8rc1 or later.\n\n    Add a keytab configuration option to use a different keytab for\n    initial credential validation.\n\n    Add a ticket_lifetime configuration option to set the lifetime of\n    obtained credentials.\n\n    Add the banner and expose_account configuration options, which control\n    the prompts for authentication and password changing.  Provide more\n    informative prompts when changing passwords.\n\n    Work around a bug in MIT Kerberos prior to 1.4 causing the library to\n    cache the default realm and assume a particular realm even if the\n    default realm is later changed.  This bug prevented running two\n    instances of pam-krb5 with different realm settings in the same PAM\n    stack.  Thanks, Dave Botsch.\n\n    Honor PAM_SILENT when the Kerberos library prompts for more\n    information, passing to the application only prompts.\n\n    If PAM_USER is set to a fully-qualified principal that the Kerberos\n    library can map to a local account name, reset PAM_USER to that local\n    account name after authentication.\n\n    Avoid memory leaks in the Kerberos prompter by freeing the PAM\n    response strings.  We were already doing this elsewhere and the world\n    didn't end, so assume that it's safe for the PAM module to do this.\n    Also avoid memory leaks in some unusual error conditions.\n\n    Return unknown user rather than internal error when attempting\n    authentication of a user we're supposed to ignore.\n\n    When debug is enabled, report the principal for which we're attempting\n    authentication to help catch realm configuration errors.\n\n    Document the broken behavior of old versions of OpenSSH, which tell\n    PAM to refresh credentials rather than opening a session.  Thanks,\n    Michael C. Garrison.\n\n    Add a link to the distribution page to the pam-krb5 man page.\n\n    Extensive refactoring and reorganization of the code.\n\npam-krb5 2.6 (2006-11-28)\n\n    Don't assume the pointer set by pam_get_user is usable over the life\n    of the PAM module; instead, save a local copy.\n\n    Avoid a use of already freed memory when debugging is enabled.\n\n    Use __func__ instead of __FUNCTION__ and provide a fallback for older\n    versions of gcc and for systems that support neither.  Should fix\n    compilation issues with Sun's C compiler.\n\n    On platforms where we know the appropriate compiler flags, try to\n    build the module so that symbols are resolved within the module in\n    preference to any externally available symbols.  Also add the\n    hopefully correct compiler flags for Sun's C compiler.\n\npam-krb5 2.5 (2006-11-03)\n\n    Don't free the results of pam_get_item(PAM_AUTHTOK) when changing\n    passwords.  Thanks, Arne Nordmark.\n\n    Be a bit more thorough when checking authorization in\n    pam_sm_acct_mgmt.  Re-retrieve the value of user in case the\n    application changed it, and if we have a ticket cache (we may not even\n    after a successful authentication if no_ccache was specified),\n    retrieve the principal from it rather than using the principal from\n    the context.\n\n    Overwrite passwords with 0 before freeing them, just out of paranoia\n    (and because PAM also does this internally).\n\npam-krb5 2.4 (2006-10-05)\n\n    Fix compilation problems with Heimdal.  Thanks, Matthijs Mohlmann and\n    Douglas Engert.\n\n    Check for memory allocation failures when parsing PAM options rather\n    than segfaulting.\n\n    Fix several places where an uninitialized context could have been\n    passed into the argument parsing function.\n\n    Refactor the code to read configuration from krb5.conf to be easier\n    to read and understand.  Parse renew_lifetime immediately and always\n    report an error rather than deferring time parsing until acquiring\n    tickets.\n\n    Log errors (not just authentication failures) at the LOG_ERR level\n    to match (some of) the recommendations of the Linux PAM documentation.\n\n    Log an error when an unknown option is passed via the PAM\n    configuration.\n\npam-krb5 2.3 (2006-09-03)\n\n    Fix the interface between the Kerberos prompting function and the\n    PAM conversation function on Linux.  Prior to this fix, the PAM module\n    would only work on Solaris if Kerberos passed multiple prompts, which\n    happens when an account requires a password change.  Solaris and Linux\n    PAM implementations expect a different structure of pam_message\n    structs in the conversation function; use a workaround to cater to\n    both of them.  Based on a patch by Joachim Keltsch.\n\n    Implement retain_after_close, which specifies that the PAM module\n    should never destroy the user's ticket cache, even on session end.\n\n    Adjust for the differences in Solaris's PAM libraries:  Include\n    pam_appl.h everywhere for structure and type definitions, and add\n    portability workarounds for the return statuses missing from the\n    Solaris implementation.\n\npam-krb5 2.2 (2006-08-28)\n\n    Allow the default realm to be overridden in the PAM options.\n\n    Use the realm, default or otherwise, when reading options from\n    krb5.conf so that realm-specific sections in [appdefaults] work\n    correctly.\n\n    Update the build and installation documentation for the new\n    Autoconf-based build system.  This should have been in the last\n    release but was missed.\n\n    Initialize ticket options correctly when built with Heimdal.\n\n    Fix a typo that caused the Heimdal support not to compile.  Thanks,\n    Matthijs Mohlmann.\n\npam-krb5 2.1 (2006-08-26)\n\n    Strip off a FILE: prefix from the cache path before creating it in\n    case the user set ccache or ccache_dir with a cache type prefix.\n    Thanks to Bj\u00f6rn Torkelsson for the patch.\n\n    Added an Autoconf script to distinguish between Heimdal and MIT\n    Kerberos and take care of other portability issues.  Rewrote the\n    Makefile accordingly.\n\n    Added portability and error reporting fixes for Heimdal, thanks to\n    Matthijs Mohlmann.\n\npam-krb5 2.0 (2006-08-11)\n\n    Always use a disk cache for temporary storage of credentials between\n    authentication and setcred or session initialization.  This allows the\n    module to work correctly with OpenSSH ChallengeResponseAuthentication.\n\n    Add support for some PAM options that were supported by the\n    Sourceforge K5 PAM module, most notably minimum_uid and\n    renew_lifetime.\n\n    Support setting many PAM options from krb5.conf as well as on the PAM\n    command line, using the same application section as the Sourceforge\n    PAM module.  Use the profile reading functions provided by the\n    Kerberos libraries.\n\n    Add support for use_authtok, which is like use_first_pass except that\n    it will never prompt even if no password is currently set.\n\n    Add a search_k5login option to check the user's password against every\n    principal listed in .k5login, to support use of this module to\n    authenticate user access to shared accounts.\n\n    Add an ignore_k5login option that bypasses all checks of .k5login\n    files entirely and relies solely on krb5_aname_to_localname checks.\n\n    Re-add the ccache option to specify the exact file name of the ticket\n    cache, and allow for randomization using mkstemp even when this option\n    is used.\n\n    Only call krb5_kuserok (the .k5login check) when the account to which\n    the user is authenticating is a local account.  It's up to the\n    application to handle authorization checks for non-local accounts.\n\n    Support preliminary checks for password changing by using that to\n    obtain the user's current credentials.  Correctly handle saved\n    passwords from previous authentications or password changes when\n    changing passwords, and correctly set the saved passwords for\n    subsequent password changes in the PAM stack.\n\n    Only initialize the ticket cache once, no matter how many times\n    setcred is called.  This saves duplicate work and works around a bug\n    in X.org xdm that otherwise causes it to lose the PAM environment.\n\n    When reinitializing a ticket cache, never reinitialize the temporary\n    cache created by the authentication call.  Instead, fall back to the\n    default ticket cache name if KRB5CCNAME isn't set.\n\n    Improve support for no_ccache.  Now, it doesn't even generate a\n    temporary ticket cache during authentication but only uses an\n    in-memory credential list.\n\n    Do user ticket validation using the standard Kerberos library call\n    rather than rolling our own code.  This means that the user can now\n    set options in krb5.conf to control whether that call should fail if\n    the local keytab isn't readable or contains no usable keys.\n\n    Completely rewrite the man page.  Clean it up and make it more\n    readable and fully document all of the options.  Also rewrite the\n    README file and clean up the rest of the package documentation.\n\n    Don't create a ticket cache until after successful authentication.\n\n    Understand the FILE: prefix to Kerberos ticket cache names and compare\n    and chown ticket caches properly with that prefix.\n\n    Add a trailing nul to the password in the Kerberos prompter function,\n    since some code relies on it being there.\n\n    Review the return status of each PAM function and ensure that we only\n    return failure statuses that are supported for that function.\n\n    Rename all internal functions with a pamk5_* prefix to avoid\n    conflicting with any application or system library functions.\n\n    Eliminate global variables in the PAM module and do a better job at\n    cleaning up memory usage.  There are still a few places where the PAM\n    conversation functions may leak memory due to an incomplete\n    specification in the PAM API on who should free what memory.\n\n    The logging messages produced when debug is set should now be more\n    consistent and more complete.\n\npam-krb5 1.2 (2005-09-27)\n\n    Don't reinitialize the ticket cache if the old and new cache have the\n    same name, since otherwise we end up destroying it.\n\n    Always set KRB5CCNAME, even when reinitializing.\n\n    When reinitializing, look for the ticket cache in the saved context\n    even if KRB5CCNAME isn't set.  OpenSSH calls it this way.\n\n    Drop the ccache option and add ccache_dir instead, which only\n    specifies the directory for ticket caches and is therefore easier to\n    implement.\n\npam-krb5 1.1 (2005-08-31)\n\n    Add support for reinitialization/refreshing of credentials in\n    pam_sm_setcred.\n\n    Set PAM_AUTHTOK and PAM_OLDAUTHTOK when authenticating to better\n    support stacking this module with others.\n\n    Add an ignore_root option to not do anything when the account to which\n    the user is authenticating is root.  This allows one to log in via\n    console as root even when the network is down (thereby breaking the\n    PAM module in ways that login doesn't like due to timeouts in the\n    Kerberos libraries).\n\n    Store the entire context structure in PAM's memory rather than just\n    the name of the ticket cache so that we can pass around more data to\n    ourself.\n\n    Bring errors more in line with the official PAM specification.\n\n    Move prompt generation into the PAM module rather than letting the\n    Kerberos library generate the prompt.  This way we don't leak\n    principal information to the caller, and the non-standard prompt also\n    broke some applications like gksudo.\n\n    Support session management and destruction of the ticket cache on\n    close of session.\n\n    Don't require that the user have a local account on the system.\n\n    Include the user UID in the default ticket cache name so that rpc.gssd\n    and similar programs can find it.\n"], "filenames": ["NEWS"], "buggy_code_start_loc": [7], "buggy_code_end_loc": [7], "fixing_code_start_loc": [8], "fixing_code_end_loc": [9], "type": "CWE-120", "message": "pam-krb5 before 4.9 has a buffer overflow that might cause remote code execution in situations involving supplemental prompting by a Kerberos library. It may overflow a buffer provided by the underlying Kerberos library by a single '\\0' byte if an attacker responds to a prompt with an answer of a carefully chosen length. The effect may range from heap corruption to stack corruption depending on the structure of the underlying Kerberos library, with unknown effects but possibly including code execution. This code path is not used for normal authentication, but only when the Kerberos library does supplemental prompting, such as with PKINIT or when using the non-standard no_prompt PAM configuration option.", "other": {"cve": {"id": "CVE-2020-10595", "sourceIdentifier": "cve@mitre.org", "published": "2020-03-31T13:15:13.130", "lastModified": "2020-04-04T00:15:23.717", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "pam-krb5 before 4.9 has a buffer overflow that might cause remote code execution in situations involving supplemental prompting by a Kerberos library. It may overflow a buffer provided by the underlying Kerberos library by a single '\\0' byte if an attacker responds to a prompt with an answer of a carefully chosen length. The effect may range from heap corruption to stack corruption depending on the structure of the underlying Kerberos library, with unknown effects but possibly including code execution. This code path is not used for normal authentication, but only when the Kerberos library does supplemental prompting, such as with PKINIT or when using the non-standard no_prompt PAM configuration option."}, {"lang": "es", "value": "pam-krb5 versiones anteriores a 4.9, presenta un desbordamiento del b\u00fafer que puede causar una ejecuci\u00f3n de c\u00f3digo remota en situaciones que involucran una sugerencia suplementaria para una biblioteca de Kerberos. Esto puede desbordar un b\u00fafer proporcionado por la biblioteca Kerberos subyacente por un solo byte \"\\0\" si un atacante responde a un aviso con una respuesta de una longitud cuidadosamente elegida. El efecto puede variar desde una corrupci\u00f3n en la regi\u00f3n heap hasta una corrupci\u00f3n en la regi\u00f3n stack dependiendo de la estructura de la biblioteca de Kerberos subyacente, con efectos desconocidos pero posiblemente incluyendo una ejecuci\u00f3n de c\u00f3digo. Esta ruta de c\u00f3digo no es usada para una autenticaci\u00f3n normal, sino solo cuando la biblioteca de Kerberos realiza una sugerencia suplementaria, tal y como con PKINIT o cuando se utiliza la opci\u00f3n de configuraci\u00f3n no_prompt PAM no est\u00e1ndar."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-120"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pam-krb5_project:pam-krb5:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.9", "matchCriteriaId": "BF19D71B-DDDF-48C8-89F2-7561C6A8972C"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2020/03/31/1", "source": "cve@mitre.org", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/rra/pam-krb5/commit/e7879e27a37119fad4faf133a9f70bdcdc75d760", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/04/msg00000.html", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4314-1/", "source": "cve@mitre.org"}, {"url": "https://www.debian.org/security/2020/dsa-4648", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://www.eyrie.org/~eagle/software/pam-krb5/security/2020-03-30.html", "source": "cve@mitre.org"}]}, "github_commit_url": "https://github.com/rra/pam-krb5/commit/e7879e27a37119fad4faf133a9f70bdcdc75d760"}}