{"buggy_code": ["import url from '../url'\n\ndescribe('url validator', () => {\n  it('should validate empty string', () => {\n    expect(url('')).toBe(true)\n  })\n\n  const correctUrls = [\n    'http://foo.com/blah_blah',\n    'HTTP://FOO.COM/BLAH_BLAH',\n    'HTTP://FOO.COM/blah_blah',\n    'http://foo.com/blah_blah/',\n    'http://foo.com/blah_blah_(wikipedia)',\n    'http://foo.com/blah_blah_(wikipedia)_(again)',\n    'http://www.example.com/wpstyle/?p=364',\n    'https://www.example.com/foo/?bar=baz&inga=42&quux',\n    'http://\u272adf.ws/123',\n    'http://userid:password@example.com:8080',\n    'http://userid:password@example.com:8080/',\n    'http://userid@example.com',\n    'http://userid@example.com/',\n    'http://userid@example.com:8080',\n    'http://userid@example.com:8080/',\n    'http://userid:password@example.com',\n    'http://userid:password@example.com/',\n    'http://142.42.1.1/',\n    'http://142.42.1.1:8080/',\n    'http://\u27a1.ws/\u4a39',\n    'http://\u2318.ws',\n    'http://\u2318.ws/',\n    'http://foo.com/blah_(wikipedia)#cite-1',\n    'http://foo.com/blah_(wikipedia)_blah#cite-1',\n    'http://foo.com/unicode_(\u272a)_in_parens',\n    'http://foo.com/(something)?after=parens',\n    'http://\u263a.damowmow.com/',\n    'http://code.google.com/events/#&product=browser',\n    'http://j.mp',\n    'ftp://foo.bar/baz',\n    'http://foo.bar/?q=Test%20URL-encoded%20stuff',\n    'http://\u0645\u062b\u0627\u0644.\u0625\u062e\u062a\u0628\u0627\u0631',\n    'http://\u4f8b\u5b50.\u6d4b\u8bd5',\n    'http://\u0909\u0926\u093e\u0939\u0930\u0923.\u092a\u0930\u0940\u0915\u094d\u0937\u093e',\n    \"http://-.~_!$&'()*+,;=:%40:80%2f::::::@example.com\",\n    'http://1337.net',\n    'http://a.b-c.de',\n    'http://223.255.255.254'\n  ]\n  const incorrectUrls = [\n    'http://',\n    'http://.',\n    'http://..',\n    'http://../',\n    'http://?',\n    'http://??',\n    'http://??/',\n    'http://#',\n    'http://##',\n    'http://##/',\n    'http://foo.bar?q=Spaces should be encoded',\n    '//',\n    '//a',\n    '///a',\n    '///',\n    'http:///a',\n    'foo.com',\n    'rdar://1234',\n    'h://test',\n    'http:// shouldfail.com',\n    ':// should fail',\n    'http://foo.bar/foo(bar)baz quux',\n    'ftps://foo.bar/',\n    'http://-error-.invalid/',\n    'http://-a.b.co',\n    'http://a.b-.co',\n    'http://0.0.0.0',\n    'http://10.1.1.0',\n    'http://10.1.1.255',\n    'http://224.1.1.1',\n    'http://1.1.1.1.1',\n    'http://123.123.123',\n    'http://3628126748',\n    'http://.www.foo.bar/',\n    'http://www.foo.bar./',\n    'http://.www.foo.bar./',\n    'http://10.1.1.1',\n    'http://10.1.1.254'\n  ]\n\n  correctUrls.forEach((urlString) => {\n    it(`should validate correct url ${urlString}`, () => {\n      expect(url(urlString)).toBe(true)\n    })\n  })\n\n  incorrectUrls.forEach((urlString) => {\n    it(`should not validate incorrect url ${urlString}`, () => {\n      expect(url(urlString)).toBe(false)\n    })\n  })\n})\n", "import { regex } from '../common'\n\nconst urlRegex = /^(?:(?:https?|ftp):\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\n\nexport default regex(urlRegex)\n"], "fixing_code": ["import url from '../url'\n\ndescribe('url validator', () => {\n  it('should validate empty string', () => {\n    expect(url('')).toBe(true)\n  })\n\n  const correctUrls = [\n    'http://foo.com/blah_blah',\n    'HTTP://FOO.COM/BLAH_BLAH',\n    'HTTP://FOO.COM/blah_blah',\n    'http://foo.com/blah_blah/',\n    /** domains ending with a dot at the end are valid, {@see http://www.dns-sd.org/trailingdotsindomainnames.html} */\n    'http://www.foo.bar./',\n    'http://www.foo.bar.',\n    'http://foo.bar.',\n    'http://foo.bar./',\n    'http://foo.com/blah_blah_(wikipedia)',\n    'http://foo.com/blah_blah_(wikipedia)_(again)',\n    'http://www.example.com/wpstyle/?p=364',\n    'https://www.example.com/foo/?bar=baz&inga=42&quux',\n    'http://\u272adf.ws/123',\n    'http://userid:password@example.com:8080',\n    'http://userid:password@example.com:8080/',\n    'http://userid@example.com',\n    'http://userid@example.com/',\n    'http://userid@example.com:8080',\n    'http://userid@example.com:8080/',\n    'http://userid:password@example.com',\n    'http://userid:password@example.com/',\n    'http://142.42.1.1/',\n    'http://142.42.1.1:8080/',\n    'http://\u27a1.ws/\u4a39',\n    'http://\u2318.ws',\n    'http://\u2318.ws/',\n    'http://foo.com/blah_(wikipedia)#cite-1',\n    'http://foo.com/blah_(wikipedia)_blah#cite-1',\n    'http://foo.com/unicode_(\u272a)_in_parens',\n    'http://foo.com/(something)?after=parens',\n    'http://\u263a.damowmow.com/',\n    'http://code.google.com/events/#&product=browser',\n    'http://j.mp',\n    'ftp://foo.bar/baz',\n    'http://foo.bar/?q=Test%20URL-encoded%20stuff',\n    'http://\u0645\u062b\u0627\u0644.\u0625\u062e\u062a\u0628\u0627\u0631',\n    'http://\u4f8b\u5b50.\u6d4b\u8bd5',\n    'http://\u0909\u0926\u093e\u0939\u0930\u0923.\u092a\u0930\u0940\u0915\u094d\u0937\u093e',\n    'http://-.~_!$&\\'()*+,;=:%40:80%2f::::::@example.com',\n    'http://1337.net',\n    'http://a.b-c.de',\n    'http://223.255.255.254'\n  ]\n  const incorrectUrls = [\n    'http://',\n    'http://.',\n    'http://..',\n    'http://../',\n    'http://?',\n    'http://??',\n    'http://??/',\n    'http://#',\n    'http://##',\n    'http://##/',\n    'http://foo.bar?q=Spaces should be encoded',\n    '//',\n    '//a',\n    '///a',\n    '///',\n    'http:///a',\n    'foo.com',\n    'rdar://1234',\n    'h://test',\n    'http:// shouldfail.com',\n    ':// should fail',\n    'http://foo.bar/foo(bar)baz quux',\n    'ftps://foo.bar/',\n    'http://-error-.invalid/',\n    'http://-a.b.co',\n    'http://a.b-.co',\n    'http://0.0.0.0',\n    'http://10.1.1.0',\n    'http://10.1.1.255',\n    'http://224.1.1.1',\n    'http://1.1.1.1.1',\n    'http://123.123.123',\n    'http://3628126748',\n    'http://.www.foo.bar/',\n    'http://.www.foo.bar./',\n    'http://10.1.1.1',\n    'http://10.1.1.254'\n  ]\n\n  it.each(correctUrls)('should validate correct url %s', (urlString) => {\n    expect(url(urlString)).toBe(true)\n  })\n\n  it.each(incorrectUrls)('should not validate incorrect url %s', (urlString) => {\n    expect(url(urlString)).toBe(false)\n  })\n})\n", "import { regex } from '../common'\n\n/**\n * Regex taken from {@link https://gist.github.com/dperini/729294}\n */\nconst urlRegex = /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\n\nexport default regex(urlRegex)\n"], "filenames": ["packages/validators/src/raw/__tests__/url.spec.js", "packages/validators/src/raw/url.js"], "buggy_code_start_loc": [12, 3], "buggy_code_end_loc": [99, 4], "fixing_code_start_loc": [13, 3], "fixing_code_end_loc": [99, 7], "type": "NVD-CWE-Other", "message": "vuelidate is vulnerable to Inefficient Regular Expression Complexity", "other": {"cve": {"id": "CVE-2021-3794", "sourceIdentifier": "security@huntr.dev", "published": "2021-09-15T13:15:08.167", "lastModified": "2022-07-29T16:50:46.620", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "vuelidate is vulnerable to Inefficient Regular Expression Complexity"}, {"lang": "es", "value": "vuelidate es vulnerable a una Complejidad de Expresiones Regulares Ineficientes"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1333"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.0.0", "matchCriteriaId": "A31695D7-DE0F-4260-8C9D-17E6891997EC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha0:*:*:*:node.js:*:*", "matchCriteriaId": "9210EC31-BB83-4DD2-92A8-03673FDA2BA7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha1:*:*:*:node.js:*:*", "matchCriteriaId": "DB7FF45B-FF41-4821-A8B3-627F1161E97F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha10:*:*:*:node.js:*:*", "matchCriteriaId": "EDE4579F-3044-4EDE-9E5C-3A3CD5AAF965"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha11:*:*:*:node.js:*:*", "matchCriteriaId": "CEFDD7DD-CBC1-4FB2-9F47-52F412CB98B4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha12:*:*:*:node.js:*:*", "matchCriteriaId": "95527626-8101-4963-ADB8-E55AD47C558E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha13:*:*:*:node.js:*:*", "matchCriteriaId": "77A43419-EF8D-4E34-85D9-04160E514672"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha14:*:*:*:node.js:*:*", "matchCriteriaId": "E6C1F6D6-5997-4324-A6DC-B2BAAC21EE03"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha15:*:*:*:node.js:*:*", "matchCriteriaId": "0DD5689F-0B31-4B18-8D46-5D7D6F176E41"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha16:*:*:*:node.js:*:*", "matchCriteriaId": "AB822BE7-8134-4018-8DDB-11422D84DD51"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha17:*:*:*:node.js:*:*", "matchCriteriaId": "C04561B4-0FF4-45F5-9BE0-0345B9F57910"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha18:*:*:*:node.js:*:*", "matchCriteriaId": "D41665A2-E896-47F9-B4DA-0CA78E6DE9A2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha19:*:*:*:node.js:*:*", "matchCriteriaId": "744F0626-3222-4D00-B717-4A0482F3C0A7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha2:*:*:*:node.js:*:*", "matchCriteriaId": "7840BE23-CCEB-47CB-8049-63ED86BAEDEC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha20:*:*:*:node.js:*:*", "matchCriteriaId": "1B45272F-0F16-4A21-9A1D-5596878D32BB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha21:*:*:*:node.js:*:*", "matchCriteriaId": "617E50F8-1C1C-4948-B11F-CD4F325F2770"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha22:*:*:*:node.js:*:*", "matchCriteriaId": "6732AECD-9A61-481A-9979-244BA9969DD1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha23:*:*:*:node.js:*:*", "matchCriteriaId": "236CF336-679B-4669-BB30-DD61C05F0662"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha24:*:*:*:node.js:*:*", "matchCriteriaId": "0282780C-7899-401E-8A84-3DA48538447D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha25:*:*:*:node.js:*:*", "matchCriteriaId": "5627F791-AE3D-4BE0-92EA-C95AE755C210"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha3:*:*:*:node.js:*:*", "matchCriteriaId": "DC8FA1B8-53E1-4DDC-B303-D1E16A057A3F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha4:*:*:*:node.js:*:*", "matchCriteriaId": "9AF4EE6F-A37C-4FDD-A715-8C272B8C4F33"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha5:*:*:*:node.js:*:*", "matchCriteriaId": "98BE313E-1DB8-4123-912D-7F5A30569BFF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha6:*:*:*:node.js:*:*", "matchCriteriaId": "21927CBB-EE3A-4399-9522-DF78A1CAF7F5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha7:*:*:*:node.js:*:*", "matchCriteriaId": "CCA4214A-45BD-4E24-844E-48586ACD1E1C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha8:*:*:*:node.js:*:*", "matchCriteriaId": "C5D75959-3CC6-435B-8FD9-DCF9F5BD6EFE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:vuelidate_project:vuelidate:2.0.0:alpha9:*:*:*:node.js:*:*", "matchCriteriaId": "1CBFF882-17DF-424B-A770-8C15EA632995"}]}]}], "references": [{"url": "https://github.com/vuelidate/vuelidate/commit/1f0ca31c30e5032f00dbd14c4791b5ee7928f71d", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/d8201b98-fb91-4c12-a6f7-181b4a20d9b7", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/vuelidate/vuelidate/commit/1f0ca31c30e5032f00dbd14c4791b5ee7928f71d"}}