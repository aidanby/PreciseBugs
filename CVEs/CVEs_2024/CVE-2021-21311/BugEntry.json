{"buggy_code": ["<?php\n$drivers[\"clickhouse\"] = \"ClickHouse (alpha)\";\n\nif (isset($_GET[\"clickhouse\"])) {\n\tdefine(\"DRIVER\", \"clickhouse\");\n\n\tclass Min_DB {\n\t\tvar $extension = \"JSON\", $server_info, $errno, $_result, $error, $_url;\n\t\tvar $_db = 'default';\n\n\t\tfunction rootQuery($db, $query) {\n\t\t\t@ini_set('track_errors', 1); // @ - may be disabled\n\t\t\t$file = @file_get_contents(\"$this->_url/?database=$db\", false, stream_context_create(array('http' => array(\n\t\t\t\t'method' => 'POST',\n\t\t\t\t'content' => $this->isQuerySelectLike($query) ? \"$query FORMAT JSONCompact\" : $query,\n\t\t\t\t'header' => 'Content-type: application/x-www-form-urlencoded',\n\t\t\t\t'ignore_errors' => 1, // available since PHP 5.2.10\n\t\t\t))));\n\n\t\t\tif ($file === false) {\n\t\t\t\t$this->error = $php_errormsg;\n\t\t\t\treturn $file;\n\t\t\t}\n\t\t\tif (!preg_match('~^HTTP/[0-9.]+ 2~i', $http_response_header[0])) {\n\t\t\t\t$this->error = $file;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t$return = json_decode($file, true);\n\t\t\tif ($return === null) {\n\t\t\t\tif (!$this->isQuerySelectLike($query) && $file === '') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t$this->errno = json_last_error();\n\t\t\t\tif (function_exists('json_last_error_msg')) {\n\t\t\t\t\t$this->error = json_last_error_msg();\n\t\t\t\t} else {\n\t\t\t\t\t$constants = get_defined_constants(true);\n\t\t\t\t\tforeach ($constants['json'] as $name => $value) {\n\t\t\t\t\t\tif ($value == $this->errno && preg_match('~^JSON_ERROR_~', $name)) {\n\t\t\t\t\t\t\t$this->error = $name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn new Min_Result($return);\n\t\t}\n\n\t\tfunction isQuerySelectLike($query) {\n\t\t\treturn (bool) preg_match('~^(select|show)~i', $query);\n\t\t}\n\n\t\tfunction query($query) {\n\t\t\treturn $this->rootQuery($this->_db, $query);\n\t\t}\n\n\t\tfunction connect($server, $username, $password) {\n\t\t\tpreg_match('~^(https?://)?(.*)~', $server, $match);\n\t\t\t$this->_url = ($match[1] ? $match[1] : \"http://\") . \"$username:$password@$match[2]\";\n\t\t\t$return = $this->query('SELECT 1');\n\t\t\treturn (bool) $return;\n\t\t}\n\n\t\tfunction select_db($database) {\n\t\t\t$this->_db = $database;\n\t\t\treturn true;\n\t\t}\n\n\t\tfunction quote($string) {\n\t\t\treturn \"'\" . addcslashes($string, \"\\\\'\") . \"'\";\n\t\t}\n\n\t\tfunction multi_query($query) {\n\t\t\treturn $this->_result = $this->query($query);\n\t\t}\n\n\t\tfunction store_result() {\n\t\t\treturn $this->_result;\n\t\t}\n\n\t\tfunction next_result() {\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction result($query, $field = 0) {\n\t\t\t$result = $this->query($query);\n\t\t\treturn $result['data'];\n\t\t}\n\t}\n\n\tclass Min_Result {\n\t\tvar $num_rows, $_rows, $columns, $meta, $_offset = 0;\n\n\t\tfunction __construct($result) {\n\t\t\t$this->num_rows = $result['rows'];\n\t\t\t$this->_rows = $result['data'];\n\t\t\t$this->meta = $result['meta'];\n\t\t\t$this->columns = array_column($this->meta, 'name');\n\t\t\treset($this->_rows);\n\t\t}\n\n\t\tfunction fetch_assoc() {\n\t\t\t$row = current($this->_rows);\n\t\t\tnext($this->_rows);\n\t\t\treturn $row === false ? false : array_combine($this->columns, $row);\n\t\t}\n\n\t\tfunction fetch_row() {\n\t\t\t$row = current($this->_rows);\n\t\t\tnext($this->_rows);\n\t\t\treturn $row;\n\t\t}\n\n\t\tfunction fetch_field() {\n\t\t\t$column = $this->_offset++;\n\t\t\t$return = new stdClass;\n\t\t\tif ($column < count($this->columns)) {\n\t\t\t\t$return->name = $this->meta[$column]['name'];\n\t\t\t\t$return->orgname = $return->name;\n\t\t\t\t$return->type = $this->meta[$column]['type'];\n\t\t\t}\n\t\t\treturn $return;\n\t\t}\n\t}\n\n\n\tclass Min_Driver extends Min_SQL {\n\t\tfunction delete($table, $queryWhere, $limit = 0) {\n\t\t\tif ($queryWhere === '') {\n\t\t\t\t$queryWhere = 'WHERE 1=1';\n\t\t\t}\n\t\t\treturn queries(\"ALTER TABLE \" . table($table) . \" DELETE $queryWhere\");\n\t\t}\n\n\t\tfunction update($table, $set, $queryWhere, $limit = 0, $separator = \"\\n\") {\n\t\t\t$values = array();\n\t\t\tforeach ($set as $key => $val) {\n\t\t\t\t$values[] = \"$key = $val\";\n\t\t\t}\n\t\t\t$query = $separator . implode(\",$separator\", $values);\n\t\t\treturn queries(\"ALTER TABLE \" . table($table) . \" UPDATE $query$queryWhere\");\n\t\t}\n\t}\n\n\tfunction idf_escape($idf) {\n\t\treturn \"`\" . str_replace(\"`\", \"``\", $idf) . \"`\";\n\t}\n\n\tfunction table($idf) {\n\t\treturn idf_escape($idf);\n\t}\n\n\tfunction explain($connection, $query) {\n\t\treturn '';\n\t}\n\n\tfunction found_rows($table_status, $where) {\n\t\t$rows = get_vals(\"SELECT COUNT(*) FROM \" . idf_escape($table_status[\"Name\"]) . ($where ? \" WHERE \" . implode(\" AND \", $where) : \"\"));\n\t\treturn empty($rows) ? false : $rows[0];\n\t}\n\n\tfunction alter_table($table, $name, $fields, $foreign, $comment, $engine, $collation, $auto_increment, $partitioning) {\n\t\t$alter = $order = array();\n\t\tforeach ($fields as $field) {\n\t\t\tif ($field[1][2] === \" NULL\") {\n\t\t\t\t$field[1][1] = \" Nullable({$field[1][1]})\";\n\t\t\t} elseif ($field[1][2] === ' NOT NULL') {\n\t\t\t\t$field[1][2] = '';\n\t\t\t}\n\n\t\t\tif ($field[1][3]) {\n\t\t\t\t$field[1][3] = '';\n\t\t\t}\n\n\t\t\t$alter[] = ($field[1]\n\t\t\t\t? ($table != \"\" ? ($field[0] != \"\" ? \"MODIFY COLUMN \" : \"ADD COLUMN \") : \" \") . implode($field[1])\n\t\t\t\t: \"DROP COLUMN \" . idf_escape($field[0])\n\t\t\t);\n\n\t\t\t$order[] = $field[1][0];\n\t\t}\n\n\t\t$alter = array_merge($alter, $foreign);\n\t\t$status = ($engine ? \" ENGINE \" . $engine : \"\");\n\t\tif ($table == \"\") {\n\t\t\treturn queries(\"CREATE TABLE \" . table($name) . \" (\\n\" . implode(\",\\n\", $alter) . \"\\n)$status$partitioning\" . ' ORDER BY (' . implode(',', $order) . ')');\n\t\t}\n\t\tif ($table != $name) {\n\t\t\t$result = queries(\"RENAME TABLE \" . table($table) . \" TO \" . table($name));\n\t\t\tif ($alter) {\n\t\t\t\t$table = $name;\n\t\t\t} else {\n\t\t\t\treturn $result;\n\t\t\t}\n\t\t}\n\t\tif ($status) {\n\t\t\t$alter[] = ltrim($status);\n\t\t}\n\t\treturn ($alter || $partitioning ? queries(\"ALTER TABLE \" . table($table) . \"\\n\" . implode(\",\\n\", $alter) . $partitioning) : true);\n\t}\n\n\tfunction truncate_tables($tables) {\n\t\treturn apply_queries(\"TRUNCATE TABLE\", $tables);\n\t}\n\n\tfunction drop_views($views) {\n\t\treturn drop_tables($views);\n\t}\n\n\tfunction drop_tables($tables) {\n\t\treturn apply_queries(\"DROP TABLE\", $tables);\n\t}\n\n\tfunction connect() {\n\t\tglobal $adminer;\n\t\t$connection = new Min_DB;\n\t\t$credentials = $adminer->credentials();\n\t\tif ($connection->connect($credentials[0], $credentials[1], $credentials[2])) {\n\t\t\treturn $connection;\n\t\t}\n\t\treturn $connection->error;\n\t}\n\n\tfunction get_databases($flush) {\n\t\tglobal $connection;\n\t\t$result = get_rows('SHOW DATABASES');\n\n\t\t$return = array();\n\t\tforeach ($result as $row) {\n\t\t\t$return[] = $row['name'];\n\t\t}\n\t\tsort($return);\n\t\treturn $return;\n\t}\n\n\tfunction limit($query, $where, $limit, $offset = 0, $separator = \" \") {\n\t\treturn \" $query$where\" . ($limit !== null ? $separator . \"LIMIT $limit\" . ($offset ? \", $offset\" : \"\") : \"\");\n\t}\n\n\tfunction limit1($table, $query, $where, $separator = \"\\n\") {\n\t\treturn limit($query, $where, 1, 0, $separator);\n\t}\n\n\tfunction db_collation($db, $collations) {\n\t}\n\n\tfunction engines() {\n\t\treturn array('MergeTree');\n\t}\n\n\tfunction logged_user() {\n\t\tglobal $adminer;\n\t\t$credentials = $adminer->credentials();\n\t\treturn $credentials[1];\n\t}\n\n\tfunction tables_list() {\n\t\t$result = get_rows('SHOW TABLES');\n\t\t$return = array();\n\t\tforeach ($result as $row) {\n\t\t\t$return[$row['name']] = 'table';\n\t\t}\n\t\tksort($return);\n\t\treturn $return;\n\t}\n\n\tfunction count_tables($databases) {\n\t\treturn array();\n\t}\n\n\tfunction table_status($name = \"\", $fast = false) {\n\t\tglobal $connection;\n\t\t$return = array();\n\t\t$tables = get_rows(\"SELECT name, engine FROM system.tables WHERE database = \" . q($connection->_db));\n\t\tforeach ($tables as $table) {\n\t\t\t$return[$table['name']] = array(\n\t\t\t\t'Name' => $table['name'],\n\t\t\t\t'Engine' => $table['engine'],\n\t\t\t);\n\t\t\tif ($name === $table['name']) {\n\t\t\t\treturn $return[$table['name']];\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction is_view($table_status) {\n\t\treturn false;\n\t}\n\n\tfunction fk_support($table_status) {\n\t\treturn false;\n\t}\n\n\tfunction convert_field($field) {\n\t}\n\n\tfunction unconvert_field($field, $return) {\n\t\tif (in_array($field['type'], array(\"Int8\", \"Int16\", \"Int32\", \"Int64\", \"UInt8\", \"UInt16\", \"UInt32\", \"UInt64\", \"Float32\", \"Float64\"))) {\n\t\t\treturn \"to$field[type]($return)\";\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction fields($table) {\n\t\t$return = array();\n\t\t$result = get_rows(\"SELECT name, type, default_expression FROM system.columns WHERE \" . idf_escape('table') . \" = \" . q($table));\n\t\tforeach ($result as $row) {\n\t\t\t$type = trim($row['type']);\n\t\t\t$nullable = strpos($type, 'Nullable(') === 0;\n\t\t\t$return[trim($row['name'])] = array(\n\t\t\t\t\"field\" => trim($row['name']),\n\t\t\t\t\"full_type\" => $type,\n\t\t\t\t\"type\" => $type,\n\t\t\t\t\"default\" => trim($row['default_expression']),\n\t\t\t\t\"null\" => $nullable,\n\t\t\t\t\"auto_increment\" => '0',\n\t\t\t\t\"privileges\" => array(\"insert\" => 1, \"select\" => 1, \"update\" => 0),\n\t\t\t);\n\t\t}\n\n\t\treturn $return;\n\t}\n\n\tfunction indexes($table, $connection2 = null) {\n\t\treturn array();\n\t}\n\n\tfunction foreign_keys($table) {\n\t\treturn array();\n\t}\n\n\tfunction collations() {\n\t\treturn array();\n\t}\n\n\tfunction information_schema($db) {\n\t\treturn false;\n\t}\n\n\tfunction error() {\n\t\tglobal $connection;\n\t\treturn h($connection->error);\n\t}\n\n\tfunction types() {\n\t\treturn array();\n\t}\n\n\tfunction schemas() {\n\t\treturn array();\n\t}\n\n\tfunction get_schema() {\n\t\treturn \"\";\n\t}\n\n\tfunction set_schema($schema) {\n\t\treturn true;\n\t}\n\n\tfunction auto_increment() {\n\t\treturn '';\n\t}\n\n\tfunction last_id() {\n\t\treturn 0; // ClickHouse doesn't have it\n\t}\n\n\tfunction support($feature) {\n\t\treturn preg_match(\"~^(columns|sql|status|table|drop_col)$~\", $feature);\n\t}\n\n\t$jush = \"clickhouse\";\n\t$types = array();\n\t$structured_types = array();\n\tforeach (array( //! arrays\n\t\tlang('Numbers') => array(\"Int8\" => 3, \"Int16\" => 5, \"Int32\" => 10, \"Int64\" => 19, \"UInt8\" => 3, \"UInt16\" => 5, \"UInt32\" => 10, \"UInt64\" => 20, \"Float32\" => 7, \"Float64\" => 16, 'Decimal' => 38, 'Decimal32' => 9, 'Decimal64' => 18, 'Decimal128' => 38),\n\t\tlang('Date and time') => array(\"Date\" => 13, \"DateTime\" => 20),\n\t\tlang('Strings') => array(\"String\" => 0),\n\t\tlang('Binary') => array(\"FixedString\" => 0),\n\t) as $key => $val) {\n\t\t$types += $val;\n\t\t$structured_types[$key] = array_keys($val);\n\t}\n\t$unsigned = array();\n\t$operators = array(\"=\", \"<\", \">\", \"<=\", \">=\", \"!=\", \"~\", \"!~\", \"LIKE\", \"LIKE %%\", \"IN\", \"IS NULL\", \"NOT LIKE\", \"NOT IN\", \"IS NOT NULL\", \"SQL\");\n\t$functions = array();\n\t$grouping = array(\"avg\", \"count\", \"count distinct\", \"max\", \"min\", \"sum\");\n\t$edit_functions = array();\n}\n", "<?php\n$drivers[\"elastic\"] = \"Elasticsearch (beta)\";\n\nif (isset($_GET[\"elastic\"])) {\n\t$possible_drivers = array(\"json + allow_url_fopen\");\n\tdefine(\"DRIVER\", \"elastic\");\n\n\tif (function_exists('json_decode') && ini_bool('allow_url_fopen')) {\n\t\tclass Min_DB {\n\t\t\tvar $extension = \"JSON\", $server_info, $errno, $error, $_url;\n\n\t\t\t/** Performs query\n\t\t\t * @param string\n\t\t\t * @param array\n\t\t\t * @param string\n\t\t\t * @return mixed\n\t\t\t */\n\t\t\tfunction rootQuery($path, $content = array(), $method = 'GET') {\n\t\t\t\t@ini_set('track_errors', 1); // @ - may be disabled\n\t\t\t\t$file = @file_get_contents(\"$this->_url/\" . ltrim($path, '/'), false, stream_context_create(array('http' => array(\n\t\t\t\t\t'method' => $method,\n\t\t\t\t\t'content' => $content === null ? $content : json_encode($content),\n\t\t\t\t\t'header' => 'Content-Type: application/json',\n\t\t\t\t\t'ignore_errors' => 1, // available since PHP 5.2.10\n\t\t\t\t))));\n\t\t\t\tif (!$file) {\n\t\t\t\t\t$this->error = $php_errormsg;\n\t\t\t\t\treturn $file;\n\t\t\t\t}\n\t\t\t\tif (!preg_match('~^HTTP/[0-9.]+ 2~i', $http_response_header[0])) {\n\t\t\t\t\t$this->error = $file;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t$return = json_decode($file, true);\n\t\t\t\tif ($return === null) {\n\t\t\t\t\t$this->errno = json_last_error();\n\t\t\t\t\tif (function_exists('json_last_error_msg')) {\n\t\t\t\t\t\t$this->error = json_last_error_msg();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$constants = get_defined_constants(true);\n\t\t\t\t\t\tforeach ($constants['json'] as $name => $value) {\n\t\t\t\t\t\t\tif ($value == $this->errno && preg_match('~^JSON_ERROR_~', $name)) {\n\t\t\t\t\t\t\t\t$this->error = $name;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn $return;\n\t\t\t}\n\n\t\t\t/** Performs query relative to actual selected DB\n\t\t\t * @param string\n\t\t\t * @param array\n\t\t\t * @param string\n\t\t\t * @return mixed\n\t\t\t */\n\t\t\tfunction query($path, $content = array(), $method = 'GET') {\n\t\t\t\treturn $this->rootQuery(($this->_db != \"\" ? \"$this->_db/\" : \"/\") . ltrim($path, '/'), $content, $method);\n\t\t\t}\n\n\t\t\tfunction connect($server, $username, $password) {\n\t\t\t\tpreg_match('~^(https?://)?(.*)~', $server, $match);\n\t\t\t\t$this->_url = ($match[1] ? $match[1] : \"http://\") . \"$username:$password@$match[2]\";\n\t\t\t\t$return = $this->query('');\n\t\t\t\tif ($return) {\n\t\t\t\t\t$this->server_info = $return['version']['number'];\n\t\t\t\t}\n\t\t\t\treturn (bool) $return;\n\t\t\t}\n\n\t\t\tfunction select_db($database) {\n\t\t\t\t$this->_db = $database;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tfunction quote($string) {\n\t\t\t\treturn $string;\n\t\t\t}\n\n\t\t}\n\n\t\tclass Min_Result {\n\t\t\tvar $num_rows, $_rows;\n\n\t\t\tfunction __construct($rows) {\n\t\t\t\t$this->num_rows = count($rows);\n\t\t\t\t$this->_rows = $rows;\n\t\t\t\treset($this->_rows);\n\t\t\t}\n\n\t\t\tfunction fetch_assoc() {\n\t\t\t\t$return = current($this->_rows);\n\t\t\t\tnext($this->_rows);\n\t\t\t\treturn $return;\n\t\t\t}\n\n\t\t\tfunction fetch_row() {\n\t\t\t\treturn array_values($this->fetch_assoc());\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tclass Min_Driver extends Min_SQL {\n\n\t\tfunction select($table, $select, $where, $group, $order = array(), $limit = 1, $page = 0, $print = false) {\n\t\t\tglobal $adminer;\n\t\t\t$data = array();\n\t\t\t$query = \"$table/_search\";\n\t\t\tif ($select != array(\"*\")) {\n\t\t\t\t$data[\"fields\"] = $select;\n\t\t\t}\n\t\t\tif ($order) {\n\t\t\t\t$sort = array();\n\t\t\t\tforeach ($order as $col) {\n\t\t\t\t\t$col = preg_replace('~ DESC$~', '', $col, 1, $count);\n\t\t\t\t\t$sort[] = ($count ? array($col => \"desc\") : $col);\n\t\t\t\t}\n\t\t\t\t$data[\"sort\"] = $sort;\n\t\t\t}\n\t\t\tif ($limit) {\n\t\t\t\t$data[\"size\"] = +$limit;\n\t\t\t\tif ($page) {\n\t\t\t\t\t$data[\"from\"] = ($page * $limit);\n\t\t\t\t}\n\t\t\t}\n\t\t\tforeach ($where as $val) {\n\t\t\t\tlist($col, $op, $val) = explode(\" \", $val, 3);\n\t\t\t\tif ($col == \"_id\") {\n\t\t\t\t\t$data[\"query\"][\"ids\"][\"values\"][] = $val;\n\t\t\t\t}\n\t\t\t\telseif ($col . $val != \"\") {\n\t\t\t\t\t$term = array(\"term\" => array(($col != \"\" ? $col : \"_all\") => $val));\n\t\t\t\t\tif ($op == \"=\") {\n\t\t\t\t\t\t$data[\"query\"][\"filtered\"][\"filter\"][\"and\"][] = $term;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$data[\"query\"][\"filtered\"][\"query\"][\"bool\"][\"must\"][] = $term;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($data[\"query\"] && !$data[\"query\"][\"filtered\"][\"query\"] && !$data[\"query\"][\"ids\"]) {\n\t\t\t\t$data[\"query\"][\"filtered\"][\"query\"] = array(\"match_all\" => array());\n\t\t\t}\n\t\t\t$start = microtime(true);\n\t\t\t$search = $this->_conn->query($query, $data);\n\t\t\tif ($print) {\n\t\t\t\techo $adminer->selectQuery(\"$query: \" . json_encode($data), $start, !$search);\n\t\t\t}\n\t\t\tif (!$search) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t$return = array();\n\t\t\tforeach ($search['hits']['hits'] as $hit) {\n\t\t\t\t$row = array();\n\t\t\t\tif ($select == array(\"*\")) {\n\t\t\t\t\t$row[\"_id\"] = $hit[\"_id\"];\n\t\t\t\t}\n\t\t\t\t$fields = $hit['_source'];\n\t\t\t\tif ($select != array(\"*\")) {\n\t\t\t\t\t$fields = array();\n\t\t\t\t\tforeach ($select as $key) {\n\t\t\t\t\t\t$fields[$key] = $hit['fields'][$key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tforeach ($fields as $key => $val) {\n\t\t\t\t\tif ($data[\"fields\"]) {\n\t\t\t\t\t\t$val = $val[0];\n\t\t\t\t\t}\n\t\t\t\t\t$row[$key] = (is_array($val) ? json_encode($val) : $val); //! display JSON and others differently\n\t\t\t\t}\n\t\t\t\t$return[] = $row;\n\t\t\t}\n\t\t\treturn new Min_Result($return);\n\t\t}\n\n\t\tfunction update($type, $record, $queryWhere, $limit = 0, $separator = \"\\n\") {\n\t\t\t//! use $limit\n\t\t\t$parts = preg_split('~ *= *~', $queryWhere);\n\t\t\tif (count($parts) == 2) {\n\t\t\t\t$id = trim($parts[1]);\n\t\t\t\t$query = \"$type/$id\";\n\t\t\t\treturn $this->_conn->query($query, $record, 'POST');\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction insert($type, $record) {\n\t\t\t$id = \"\"; //! user should be able to inform _id\n\t\t\t$query = \"$type/$id\";\n\t\t\t$response = $this->_conn->query($query, $record, 'POST');\n\t\t\t$this->_conn->last_id = $response['_id'];\n\t\t\treturn $response['created'];\n\t\t}\n\n\t\tfunction delete($type, $queryWhere, $limit = 0) {\n\t\t\t//! use $limit\n\t\t\t$ids = array();\n\t\t\tif (is_array($_GET[\"where\"]) && $_GET[\"where\"][\"_id\"]) {\n\t\t\t\t$ids[] = $_GET[\"where\"][\"_id\"];\n\t\t\t}\n\t\t\tif (is_array($_POST['check'])) {\n\t\t\t\tforeach ($_POST['check'] as $check) {\n\t\t\t\t\t$parts = preg_split('~ *= *~', $check);\n\t\t\t\t\tif (count($parts) == 2) {\n\t\t\t\t\t\t$ids[] = trim($parts[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t$this->_conn->affected_rows = 0;\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$query = \"{$type}/{$id}\";\n\t\t\t\t$response = $this->_conn->query($query, '{}', 'DELETE');\n\t\t\t\tif (is_array($response) && $response['found'] == true) {\n\t\t\t\t\t$this->_conn->affected_rows++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn $this->_conn->affected_rows;\n\t\t}\n\t}\n\n\n\n\tfunction connect() {\n\t\tglobal $adminer;\n\t\t$connection = new Min_DB;\n\t\tlist($server, $username, $password) = $adminer->credentials();\n\t\tif ($password != \"\" && $connection->connect($server, $username, \"\")) {\n\t\t\treturn lang('Database does not support password.');\n\t\t}\n\t\tif ($connection->connect($server, $username, $password)) {\n\t\t\treturn $connection;\n\t\t}\n\t\treturn $connection->error;\n\t}\n\n\tfunction support($feature) {\n\t\treturn preg_match(\"~database|table|columns~\", $feature);\n\t}\n\n\tfunction logged_user() {\n\t\tglobal $adminer;\n\t\t$credentials = $adminer->credentials();\n\t\treturn $credentials[1];\n\t}\n\n\tfunction get_databases() {\n\t\tglobal $connection;\n\t\t$return = $connection->rootQuery('_aliases');\n\t\tif ($return) {\n\t\t\t$return = array_keys($return);\n\t\t\tsort($return, SORT_STRING);\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction collations() {\n\t\treturn array();\n\t}\n\n\tfunction db_collation($db, $collations) {\n\t}\n\t\n\tfunction engines() {\n\t\treturn array();\n\t}\n\n\tfunction count_tables($databases) {\n\t\tglobal $connection;\n\t\t$return = array();\n\t\t$result = $connection->query('_stats');\n\t\tif ($result && $result['indices']) {\n\t\t\t$indices = $result['indices'];\n\t\t\tforeach ($indices as $indice => $stats) {\n\t\t\t\t$indexing = $stats['total']['indexing'];\n\t\t\t\t$return[$indice] = $indexing['index_total'];\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction tables_list() {\n\t\tglobal $connection;\n\t\t$return = $connection->query('_mapping');\n\t\tif ($return) {\n\t\t\t$return = array_fill_keys(array_keys($return[$connection->_db][\"mappings\"]), 'table');\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction table_status($name = \"\", $fast = false) {\n\t\tglobal $connection;\n\t\t$search = $connection->query(\"_search\", array(\n\t\t\t\"size\" => 0,\n\t\t\t\"aggregations\" => array(\n\t\t\t\t\"count_by_type\" => array(\n\t\t\t\t\t\"terms\" => array(\n\t\t\t\t\t\t\"field\" => \"_type\"\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t), \"POST\");\n\t\t$return = array();\n\t\tif ($search) {\n\t\t\t$tables = $search[\"aggregations\"][\"count_by_type\"][\"buckets\"];\n\t\t\tforeach ($tables as $table) {\n\t\t\t\t$return[$table[\"key\"]] = array(\n\t\t\t\t\t\"Name\" => $table[\"key\"],\n\t\t\t\t\t\"Engine\" => \"table\",\n\t\t\t\t\t\"Rows\" => $table[\"doc_count\"],\n\t\t\t\t);\n\t\t\t\tif ($name != \"\" && $name == $table[\"key\"]) {\n\t\t\t\t\treturn $return[$name];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction error() {\n\t\tglobal $connection;\n\t\treturn h($connection->error);\n\t}\n\n\tfunction information_schema() {\n\t}\n\n\tfunction is_view($table_status) {\n\t}\n\n\tfunction indexes($table, $connection2 = null) {\n\t\treturn array(\n\t\t\tarray(\"type\" => \"PRIMARY\", \"columns\" => array(\"_id\")),\n\t\t);\n\t}\n\n\tfunction fields($table) {\n\t\tglobal $connection;\n\t\t$result = $connection->query(\"$table/_mapping\");\n\t\t$return = array();\n\t\tif ($result) {\n\t\t\t$mappings = $result[$table]['properties'];\n\t\t\tif (!$mappings) {\n\t\t\t\t$mappings = $result[$connection->_db]['mappings'][$table]['properties'];\n\t\t\t}\n\t\t\tif ($mappings) {\n\t\t\t\tforeach ($mappings as $name => $field) {\n\t\t\t\t\t$return[$name] = array(\n\t\t\t\t\t\t\"field\" => $name,\n\t\t\t\t\t\t\"full_type\" => $field[\"type\"],\n\t\t\t\t\t\t\"type\" => $field[\"type\"],\n\t\t\t\t\t\t\"privileges\" => array(\"insert\" => 1, \"select\" => 1, \"update\" => 1),\n\t\t\t\t\t);\n\t\t\t\t\tif ($field[\"properties\"]) { // only leaf fields can be edited\n\t\t\t\t\t\tunset($return[$name][\"privileges\"][\"insert\"]);\n\t\t\t\t\t\tunset($return[$name][\"privileges\"][\"update\"]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction foreign_keys($table) {\n\t\treturn array();\n\t}\n\n\tfunction table($idf) {\n\t\treturn $idf;\n\t}\n\n\tfunction idf_escape($idf) {\n\t\treturn $idf;\n\t}\n\n\tfunction convert_field($field) {\n\t}\n\n\tfunction unconvert_field($field, $return) {\n\t\treturn $return;\n\t}\n\n\tfunction fk_support($table_status) {\n\t}\n\n\tfunction found_rows($table_status, $where) {\n\t\treturn null;\n\t}\n\n\t/** Create index\n\t* @param string\n\t* @return mixed\n\t*/\n\tfunction create_database($db) {\n\t\tglobal $connection;\n\t\treturn $connection->rootQuery(urlencode($db), null, 'PUT');\n\t}\n\n\t/** Remove index\n\t* @param array\n\t* @return mixed\n\t*/\n\tfunction drop_databases($databases) {\n\t\tglobal $connection;\n\t\treturn $connection->rootQuery(urlencode(implode(',', $databases)), array(), 'DELETE');\n\t}\n\n\t/** Alter type\n\t* @param array\n\t* @return mixed\n\t*/\n\tfunction alter_table($table, $name, $fields, $foreign, $comment, $engine, $collation, $auto_increment, $partitioning) {\n\t\tglobal $connection;\n\t\t$properties = array();\n\t\tforeach ($fields as $f) {\n\t\t\t$field_name = trim($f[1][0]);\n\t\t\t$field_type = trim($f[1][1] ? $f[1][1] : \"text\");\n\t\t\t$properties[$field_name] = array(\n\t\t\t\t'type' => $field_type\n\t\t\t);\n\t\t}\n\t\tif (!empty($properties)) {\n\t\t\t$properties = array('properties' => $properties);\n\t\t}\n\t\treturn $connection->query(\"_mapping/{$name}\", $properties, 'PUT');\n\t}\n\n\t/** Drop types\n\t* @param array\n\t* @return bool\n\t*/\n\tfunction drop_tables($tables) {\n\t\tglobal $connection;\n\t\t$return = true;\n\t\tforeach ($tables as $table) { //! convert to bulk api\n\t\t\t$return = $return && $connection->query(urlencode($table), array(), 'DELETE');\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction last_id() {\n\t\tglobal $connection;\n\t\treturn $connection->last_id;\n\t}\n\n\t$jush = \"elastic\";\n\t$operators = array(\"=\", \"query\");\n\t$functions = array();\n\t$grouping = array();\n\t$edit_functions = array(array(\"json\"));\n\t$types = array(); ///< @var array ($type => $maximum_unsigned_length, ...)\n\t$structured_types = array(); ///< @var array ($description => array($type, ...), ...)\n\tforeach (array(\n\t\tlang('Numbers') => array(\"long\" => 3, \"integer\" => 5, \"short\" => 8, \"byte\" => 10, \"double\" => 20, \"float\" => 66, \"half_float\" => 12, \"scaled_float\" => 21),\n\t\tlang('Date and time') => array(\"date\" => 10),\n\t\tlang('Strings') => array(\"string\" => 65535, \"text\" => 65535),\n\t\tlang('Binary') => array(\"binary\" => 255),\n\t) as $key => $val) {\n\t\t$types += $val;\n\t\t$structured_types[$key] = array_keys($val);\n\t}\n}\n", "Adminer 4.7.9-dev:\nRe-enable PHP warnings (regression from 4.7.8)\n\nAdminer 4.7.8 (released 2020-12-06):\nSupport PHP 8\nDisallow connecting to privileged ports (bug #769)\n\nAdminer 4.7.7 (released 2020-05-11):\nFix open redirect if Adminer is accessible at //adminer.php%2F@\n\nAdminer 4.7.6 (released 2020-01-31):\nSpeed up alter table form (regression from 4.4.0)\nFix clicking on non-input fields in alter table (regression from 4.6.2)\nDisplay time of procedure execution\nDisallow connecting to ports > 65535 (bug #730)\nMySQL: Always set foreign_key_checks in export\nPostgreSQL: Support exporting views\nEditor: Fix focusing foreign key search in select\n\nAdminer 4.7.5 (released 2019-11-13):\nAdd id=\"\" to cells with failed inline edit (bug #708)\nPostgreSQL: Fix getting default value in PostgreSQL 12 (bug #719)\nPostgreSQL, Oracle: Set schema for EXPLAIN queries in SQL command (bug #706)\nClickHouse: SQL command\nSwedish translation\n\nAdminer 4.7.4 (released 2019-10-22):\nFix XSS if Adminer is accessible at URL /data:\n\nAdminer 4.7.3 (released 2019-08-27):\nAllow editing foreign keys pointing to tables in other database/schema (bug #694)\nFix blocking of concurrent instances in PHP >7.2 (bug #703)\nMySQL: Speed up displaying tables in large databases (bug #700, regression from 4.7.2)\nMySQL: Allow editing rows identified by negative floats (bug #695)\nMySQL: Skip editing generated columns\nSQLite: Quote strings stored in integer columns in export (bug #696)\nSQLite: Handle error in altering table (bug #697)\nSQLite: Allow setting auto increment for empty tables\nSQLite: Preserve auto increment when recreating table\nMS SQL: Support foreign keys to other DB\nMongoDB: Allow setting authSource from environment variable \n\nAdminer 4.7.2 (released 2019-07-18):\nDo not attempt logging in without password (bug #676)\nStretch footer over the whole table width (bug #624)\nAllow overwriting tables when copying them\nFix displaying SQL command after Save and continue edit\nCache busting for adminer.css\nMySQL: Fix displaying multi-columns foreign keys (bug #675, regression from 4.7.0)\nMySQL: Fix creating users and changing password in MySQL 8 (bug #663)\nMySQL: Pass SRID to GeomFromText\nPostgreSQL: Fix setting column comments on new table\nPostgreSQL: Display definitions of materialized views (bug #682)\nPostgreSQL: Fix table status in PostgreSQL 12 (bug #683)\nMS SQL: Support comments\nElasticsearch: Fix setting number of rows\n\nAdminer 4.7.1 (released 2019-01-24):\nDisplay the tables scrollbar (bug #647)\nRemember visible columns in Create Table form (bug #493)\nAdd autocomplete attributes to login form\nPHP <5.4 compatibility even with ClickHouse enabled (regression from 4.7.0)\nSQLite: Hide server field in login form\nEditor: Allow disabling boolean fields in PostgreSQL (bug #640)\n\nAdminer 4.7.0 (released 2018-11-24):\nSimplify storing executed SQL queries to bookmarks\nWarn when using password with leading or trailing spaces\nHide import from server if importServerPath() returns an empty string\nFix inline editing of empty cells (regression from 4.6.3)\nAllow adding more than two indexes and forign key columns at a time (regression from 4.4.0)\nAvoid overwriting existing tables when copying tables (bug #642)\nFix function change with set data type\nIncrease username maxlength to 80 (bug #623)\nMake maxlength in all fields a soft limit\nMake tables horizontally scrollable\nMySQL: Support foreign keys created with ANSI quotes (bug #620)\nMySQL: Recognize ON UPDATE current_timestamp() (bug #632, bug #638)\nMySQL: Descending indexes in MySQL 8 (bug #643)\nPostgreSQL: Quote array values in export (bug #621)\nPostgreSQL: Export DESC indexes (bug #639)\nPostgreSQL: Support GENERATED BY DEFAULT AS IDENTITY in PostgreSQL 10\nMS SQL: Pass database when connecting\nClickHouse: Connect, databases list, tables list, select, SQL command\nGeorgian translation\n\nAdminer 4.6.3 (released 2018-06-28):\nDisallow using password-less databases\nCopy triggers when copying table\nStop session before connecting\nSimplify running slow queries\nDecrease timeout for running slow queries from 5 seconds to 2 seconds\nFix displaying info about non-alphabetical objects (bug #599)\nUse secure cookies on HTTP if session.cookie_secure is set\nPDO: Support binary fields download\nMySQL: Disallow LOAD DATA LOCAL INFILE\nMySQL: Use CONVERT() only when searching for non-ASCII (bug #603)\nMySQL: Order database names in MySQL 8 (bug #613)\nPostgreSQL: Fix editing data in views (bug #605, regression from 4.6.0)\nPostgreSQL: Do not cast date/time/number/uuid searches to text (bug #608)\nPostgreSQL: Export false as 0 in PDO (bug #619)\nMS SQL: Support port with sqlsrv\nEditor: Do not check boolean checkboxes with false in PostgreSQL (bug #607)\n\nAdminer 4.6.2 (released 2018-02-20):\nSemi-transparent border on table actions\nShorten JSON values in select (bug #594)\nSpeed up alter table form (regression from 4.4.0)\nStore current version without authentication and in Editor\nPostgreSQL: Fix exporting string default values\nPostgreSQL: Fix exporting sequences in PostgreSQL 10\nPostgreSQL: Add IF EXISTS to DROP SEQUENCE in export (bug #595)\nEditor: Fix displaying of true boolean values (regression from 4.5.0)\n\nAdminer 4.6.1 (released 2018-02-09):\nSticky position of table actions\nSpeed up rendering of long tables (regression from 4.4.0)\nDisplay notification about performing action after relogin\nAdd system tables help links\nMySQL: Support non-utf8 charset in search in column\nMySQL: Support geometry in MySQL 8 (bug #574)\nMariaDB: Links to documentation\nSQLite: Allow deleting PRIMARY KEY from tables with auto increment\nPostgreSQL: Support binary files in bytea fields\nPostgreSQL: Don't treat interval type as number (bug #474)\nPostgreSQL: Cast to string when searching using LIKE (bug #325)\nPostgreSQL: Fix condition for selecting no rows\nPostgreSQL: Support TRUNCATE+INSERT export\nCustomization: Support connecting to MySQL via SSL\nCustomization: Allow specifying server name displayed in breadcrumbs\n\nAdminer 4.6.0 (released 2018-02-05):\nFix counting selected rows after going back to select page\nPHP <5.3 compatibility even with Elasticsearch enabled\nFully support functions in default values\nStop redirecting links via adminer.org\nSupport X-Forwarded-Prefix\nDisplay options for timestamp columns when creating a new table\nDisable autocompleting password on create user page\nUse primary key to edit rows even if not selected\nMySQL, PostgreSQL: Display warnings\nMySQL: Add floor and ceil select functions\nMySQL: Add FIND_IN_SET search operator\nMariaDB: Support JSON since MariaDB 10.2\nSQLite, PostgreSQL: Limit rows in data manipulation without unique key\nPostgreSQL: Support routines\nPostgreSQL: Allow editing views with uppercase letters (bug #467)\nPostgreSQL: Allow now() as default value (bug #525)\nSimpleDB: Document that allow_url_fopen is required\nMalay translation\n\nAdminer 4.5.0 (released 2018-01-24):\nDisplay name of the object in confirmation when dropping it\nDisplay newlines in column comments (bug #573)\nSupport current_timestamp() as default of time fields (bug #572)\nHide window.opener from pages opened in a new window (bug #561)\nDisplay error when getting row to edit\nStore current Adminer version server-side to avoid excessive requests\nAdminer: Fix Search data in tables (regression from 4.4.0)\nCSP: Allow any styles, images, media and fonts, disallow base-uri\nMySQL: Support geometry in MySQL 8 (bug #574)\nMySQL: Support routines with comments in parameters (bug #460)\nMariaDB: Support fulltext and spatial indexes in InnoDB (bug #583)\nSQLite: Enable foreign key checks\nPostgreSQL: Respect NULL default value\nPostgreSQL: Display foreign tables (bug #576)\nPostgreSQL: Do not export triggers if not requested\nPostgreSQL: Export DROP SEQUENCE if dropping table\nPostgreSQL: Display boolean values as code (bug #562)\nMS SQL: Support freetds\nnon-MySQL: Avoid CONVERT() (bug #509)\nElasticsearch: Insert, update, delete\nMongoDB: Support mongodb PHP extension\nEditor: Fix displaying of false values in PostgreSQL (bug #568)\n\nAdminer 4.4.0 (released 2018-01-17):\nAdd Content Security Policy\nDisallow scripts without nonce\nRate limit password-less login attempts from the same IP address\nDisallow connecting to privileged ports\nAdd nosniff header\nPHP 7.1: Prevent warning when using empty limit\nPHP 7.2: Prevent warning when searching in select\nMySQL: Remove dedicated view for replication status (added in 4.3.0)\nPostgreSQL: Sort table names (regression from 4.3.1)\nEditor: Don't set time zone from PHP, fixes DST\nEditor: Display field comment's text inside [] only in edit form\nEditor: Fix doubleclick on database page\nEditor: Fix Search data in tables\nCustomization: Always send security headers\nHebrew translation\n\nAdminer 4.3.1 (released 2017-04-14):\nFix permanent login after logout (bug #539)\nFix SQL command autofocus (regression from 4.0.0)\nPostgreSQL: Support JSON and JSONB data types\nPostgreSQL: Fix index size computation in PostgreSQL < 9.0 (regression from 4.3.0)\nPostgreSQL: Fix nullable fields in export\n\nAdminer 4.3.0 (released 2017-03-15):\nMake maxlength in edit fields a soft limit\nAdd accessibility labels\nAdd Cache-Control: immutable to static files\nMySQL: Support MySQL 8\nMySQL: Support JSON data type\nMySQL: Add dedicated view for replication status\nMySQL: Support spatial indexes\nPostgreSQL: Export\nPostgreSQL: Don't treat partial indexes as unique\nMS SQL: Support pdo_dblib\nElasticsearch: Support HTTPS by inputting https://server\n\nAdminer 4.2.5 (released 2016-06-01):\nFix remote execution in SQLite query\nSQLite: Require credentials to use\nPostgreSQL: Support KILL\n\nAdminer 4.2.4 (released 2016-02-06):\nFix remote execution in SQLite query\nMySQL: Support PHP 7\nBosnian translation\nFinnish translation\n\nAdminer 4.2.3 (released 2015-11-15):\nFix XSS in indexes (non-MySQL only)\nSupport PHP 7\nGreek translation\nGalician translation\nBulgarian translation\n\nAdminer 4.2.2 (released 2015-08-05):\nFix XSS in alter table (found by HP Fortify)\n\nAdminer 4.2.1 (released 2015-03-10):\nSend referrer header to the same domain\nMySQL: Fix usage of utf8mb4 if the client library doesn't support it\nMySQL: Use utf8mb4 in export only if required\nSQLite: Use EXPLAIN QUERY PLAN in SQL query\n\nAdminer 4.2.0 (released 2015-02-07):\nFix XSS in login form (bug #436)\nAllow limiting number of displayed rows in SQL command\nFix reading routine column collations\nUnlock session in alter database\nMake master key unreadable to others (bug #410)\nFix edit by long non-utf8 string\nSpecify encoding for PHP 5.6 with invalid default_charset\nFix saving NULL value, bug since Adminer 4.0.3\nSend 403 for auth error\nReport offline and other AJAX errors (bug #419)\nDon't alter table comment if not changed\nAdd links to documentation on table status page\nFix handling of 64 bit numbers in auto_increment\nAdd referrer: never meta tag\nMySQL: Use utf8mb4 if available\nMySQL: Support foreign keys in NDB storage\nPostgreSQL: Materialized views\nSQLite: Support CURRENT_* default values (bug #417)\nElasticsearch: Use where in select\nFirebird: Alpha version\nDanish translation\n\nAdminer 4.1.0 (released 2014-04-18):\nProvide size of all databases in the overview\nPrevent against brute force login attempts from the same IP address\nCompute number of tables in the overview explicitly\nDisplay edit form after error in clone or multi-edit\nTrim trailing non-breaking spaces in SQL textarea\nDisplay time of the select command\nPrint elapsed time in HTML instead of SQL command comment\nImprove gzip export ratio (bug #387)\nUse rel=\"noreferrer\" for external links, skip adminer.org redirect in WebKit\nMySQL: Fix enum types in routines (bug #391)\nMySQL: Fix editing rows by binary values, bug since Adminer 3.7.1\nMySQL: Respect daylight saving time in dump, bug since Adminer 3.6.4\nMySQL 5.6.5+: Support ON UPDATE on datatime column\nSQLite: Support UPDATE OF triggers\nSQLite: Display auto-created unique indexes, bug since Adminer 3.5.0\nEditor: Fix login() method, bug since Adminer 4.0.0\nTranslate numbers in ar, bn, fa\nVietnamese translation\n\nAdminer 4.0.3 (released 2014-02-01)\nMongoDB: insert, truncate, indexes\nSimpleDB, MongoDB: insert more fields at once\nSQLite: Fix creating table and altering primary key, bug since Adminer 4.0.0\nDon't store invalid credentials to session, bug since Adminer 4.0.0\nNorweigan translation\n\nAdminer 4.0.2 (released 2014-01-11):\nFix handling of long text in SQL textarea\nSupport paste to SQL textarea in Opera\n\nAdminer 4.0.1 (released 2014-01-11):\nDon't use type=number if a SQL function is used\nDisable highlighting in textareas with long texts\nDon't autofocus SQL textarea in Firefox\nDon't link NULL foreign key values\nFix displaying images in Editor, bug since Adminer 3.6.0\nFix uploading files, bug since Adminer 4.0.0\nMongoDB: Count tables, display ObjectIds, sort, limit, offset, count rows\nElasticsearch: Fix compiled version, create and drop DB, drop table\n\nAdminer 4.0.0 (released 2014-01-08):\nDriver for SimpleDB, MongoDB and Elasticsearch\nHighlight SQL in textareas\nSave and continue edit by AJAX\nSplit SQL command and import\nAdd a new column in alter table on key press\nMark length as required for strings\nAdd label to database selection, move logout button\nAdd button for dropping an index\nDisplay number of selected rows\nAdd links to documentation\nDisable underlining links\nDifferentiate views in navigation\nImprove speed of CSV import\nKeep form values after refresh in Firefox\nMark auto_increment fields in edit\nDon't append newlines to uploaded files, bug since Adminer 3.7.0\nDon't display SQL edit form on Ctrl+click on the select query, introduced in Adminer 3.6.4\nUse MD5 for editing long keys only in supported drivers, bug since Adminer 3.6.4\nDon't reset column when searching for an empty value with Enter, bug since Adminer 3.6.4\nEncrypt passwords stored in session by a key stored in cookie\nDon't execute external JavaScript when verifying version\nInclude JUSH in the compiled version\nProtect CSRF token against BREACH\nNon-MySQL: View triggers\nSQLite: Allow editing primary key\nSQLite: Allow editing foreign keys\nPostgreSQL: Fix handling of nextval() default values\nPostgreSQL: Support creating array columns\nCustomization: Provide schemas()\nPortugal Portuguese translation\nThai translation\n\nAdminer 3.7.1 (released 2013-06-29):\nIncrease click target for checkboxes\nUse shadow for highlighting default button\nDon't use LIMIT 1 if inline updating unique row\nDon't check previous checkbox on added column in create table (bug #3614245)\nOrder table list by name\nVerify UTF-8 encoding of CSV import\nNotify user about expired master password for permanent login\nHighlight table being altered in navigation\nSend 404 for invalid database and schema\nFix title and links on invalid table pages\nDisplay error on invalid alter table and view pages\nMySQL: Speed up updating rows without numeric or UTF-8 primary key\nNon-MySQL: Descending indexes\nPostgreSQL: Fix detecting oid column in PDO\nPostgreSQL: Handle timestamp types (bug #3614086)\nAdd Korean translation\n\nAdminer 3.7.0 (released 2013-05-19):\nAllow more SQL files to be uploaded at the same time\nPrint run time next to executed queries\nDon't drop original view and routine before creating the new one\nHighlight default submit button\nAdd server placeholder to login form\nDisable SQL export when applying functions in select\nAllow using lang() in plugins (customization)\nRemove bzip2 compression support\nConstraint memory used in TAR export\nAllow exporting views dependent on each other (bug #3459151)\nFix resetting search (bug #3612507)\nDon't use LIMIT 1 if updating unique row (bug #3613109)\nRestrict editing rows without unique identifier to search results\nDisplay navigation bellow main content on mobile browsers\nGet number of rows on export page asynchronously\nRespect 'whole result' even if some rows are checked (bug #339 since Adminer 3.7.0)\nMySQL: Optimize create table page and Editor navigation\nMySQL: Display bit type as binary number\nMySQL: Improve export of binary data types\nMySQL: Fix handling of POINT data type (bug #3582578)\nMySQL: Don't export binary and geometry columns twice in select\nMySQL: Fix EXPLAIN in MySQL < 5.1, bug since Adminer 3.6.4\nSQLite: Export views\nPostgreSQL: Fix swapped NULL and NOT NULL columns in PDO\n\nAdminer 3.6.4 (released 2013-04-26):\nDisplay pagination on a fixed position\nIncrease default select limit to 50\nDisplay SQL edit form on Ctrl+click on the select query\nDisplay SQL history from newest\nRecover original view, trigger, routine if creating fails\nDo not store plain text password to history in creating user\nSelectable ON UPDATE CURRENT_TIMESTAMP field in create table\nOpen database to a new window after selecting it with Ctrl\nClear column name after resetting search (bug #3601200)\nExplain partitions in SQL query (bug #3600150)\nAllow loading more data with inline edit (bug #3605531)\nStay on the same page after deleting rows (bug #3605845)\nRespect checked tables in export filename (bug #3245464)\nRespect PHP configuration max_input_vars\nFix unsetting permanent login after logout\nDisable autocapitalize in identifiers on mobile browsers\nMySQL: Compatibility with MySQL 5.6\nMySQL: Move ALTER export to plugin\nMySQL: Use numeric time zone in export\nMySQL: Link processlist documentation\nSQLite: Export indexes\n\nAdminer 3.6.3 (released 2013-01-23):\nDisplay error code in SQL query\nAllow specifying external links\nTreat Meta key same as Ctrl\nFix XSS in displaying non-UTF-8 strings\nDon't use type=\"number\" for decimal numbers\n\nAdminer 3.6.2 (released 2012-12-21):\nEdit values by Ctrl+click instead of double click\nDon't select row on double click\nSupport NULL in routine calls\nShorten printed values in varchar fields\nDisplay table default values on wide screens\nDisplay date in SQL history\nHTML5 input fields\nDisplay warning for missing UPDATE privilege\nFix switching language on first load\nSupport enabled mbstring.func_overload\nMySQL: Prolong comment length since MySQL 5.5\nPostgreSQL: Fix process list in version 9.2\nMS SQL: Support databases starting with number\n\nAdminer 3.6.1 (released 2012-09-17):\nFix compiled version on PHP with multibyte support\n\nAdminer 3.6.0 (released 2012-09-16):\nLoad more data in select\nEdit strings with \\n in textarea\nTime out long running database list and select count\nUse VALUES() in INSERT+UPDATE export\nStyle logout button as link\nStore selected database to permanent login\nCtrl+click and Shift+click on button opens form to a blank window\nSwitch language by POST\nCompress translations\nMySQL: Support geometry data types\nselectQueryBuild() method (customization)\nSerbian translation\n\nAdminer 3.5.1 (released 2012-08-10):\nSupport same name fields in CSV export\nSupport Shift+click in export\n\nAdminer 3.5.0 (released 2012-08-05):\nLinks for column search in select\nAutohide column context menu in select\nAutodisplay long table names in tables list\nDisplay assigned auto_increment after clone\nSQLite: Full alter table\nSQLite: Better editing in tables without primary key\nSQLite: Display number of rows in database overview\n\nAdminer 3.4.0 (released 2012-06-30):\nLink to descending order\nShift+click on checkbox to select consecutive rows\nPrint current time next to executed SQL queries\nWarn about selecting data without index\nAllow specifying database in login form\nLink to original table in EXPLAIN of SELECT * FROM table t\nFormat numbers in translations\nMySQL: inform about disabled event_scheduler\nSQLite: support binary data\nPostgreSQL: approximate row count in table overview\nPostgreSQL: improve PDO support in SQL command\nOracle: schema, processlist, table overview numbers\nSimplify work with NULL values (customization)\nUse namespace in login form (customization)\nCustomizable export filename (customization)\nReplace JSMin by better JavaScript minifier\nDon't use AJAX links and forms\nIndonesian translation\nUkrainian translation\nBengali translation\n\nAdminer 3.3.4 (released 2012-03-07):\nForeign keys default actions (bug #3397606)\nSET DEFAULT foreign key action\nFix minor parser bug in SQL command with webserver file\nCtrl+click on button opens form to a blank window\nTrim table and column names (bug #3405309)\nError message with no response from server in AJAX\nEsc to cancel AJAX request\nMove AJAX loading indicator to the right\nDon't quote bit type in export\nDon't check row while selecting text\nFix invalid references line position on Database schema\nDisable selecting text on Database schema\nAbility to disable export (customization)\nExtensible list of databases (customization)\nMySQL: set autocommit after connect\nSQLite, PostgreSQL: vacuum\nSQLite, PostgreSQL: don't use LIKE for numbers (bug #3420408)\nPostgreSQL: fix alter foreign key\nPostgreSQL over PDO: connect if the eponymous database does not exist (bug #3391619)\nBoolean search (Editor)\nPersian translation\n\nAdminer 3.3.3 (released 2011-08-12):\nHighlight checked rows\nTitles of links in database overview and navigation\nFix trigger export (SQLite)\nDefault trigger statement (SQLite, PostgreSQL)\nRemove search by expression (PostgreSQL, MS SQL)\n\nAdminer 3.3.2 (released 2011-08-08):\nDisplay error with non-existent row in edit\nFix minor parser bug in SQL command with webserver file\nFix SQL command Stop on error\nDon't scroll with AJAX select order and alter move column\nFast number of rows with big tables (PostgreSQL)\nSort databases and schemas (PostgreSQL)\n\nAdminer 3.3.1 (released 2011-07-27):\nFix XSS introduced in Adminer 3.2.0\nFix altering default values (PostgreSQL)\nProcess list (PostgreSQL)\n\nAdminer 3.3.0 (released 2011-07-19):\nUse Esc to disable in-place edit\nShortcut for database privileges\nEditable index names\nAppend new index with auto index selection (bug #3282127)\nPreserve original timestamp value in multiple update (bug #3312614)\nBit type default value\nDisplay foreign key name in tooltip\nDisplay default column value in table overview\nDisplay column collation in tooltip\nKeyboard shortcuts: Alt+Shift+1 for homepage, Ctrl+Shift+Enter for Save and continue edit\nShow only errors with Webserver file SQL command\nRemember select export and import options\nLink tables and indexes from SQL command EXPLAIN (MySQL)\nDisplay error with all wrong SQL commands (MySQL)\nDisplay foreign keys from other schemas (PostgreSQL)\nPagination support (Oracle)\nAutocomplete for big foreign keys (Editor)\nDisplay name of the referenced record in PostgreSQL (Editor)\nPrefer NULL to empty string (Editor, bug #3323800)\nDisplay searched columns (Editor)\nCustomizable favicon (customization)\nMethod name can return a link (customization)\nEasier sending of default headers (customization)\nLithuanian and Romanian translation\n\nAdminer 3.2.2 (released 2011-03-28):\nFix AJAX history after reload\n\nAdminer 3.2.1 (released 2011-03-23):\nAbility to save expression in edit\nRespect default database collation (bug #3191489)\nDon't export triggers without table (bug #3193489)\nEsc to focus next field in Tab textarea\nSend forms by Ctrl+Enter on <select>\nEnum editor and textarea Ctrl+Enter working in IE\nAJAX forms in Google Chrome\nParse UTF-16 and UTF-8 BOM in all text uploads\nDisplay ; in history\nUse DELIMITER in history\nShow databases even with skip_show_database in MySQL 5\nDisable maxlength with functions in edit\nBetter placement of AJAX icon\nTable header in CSV export (Editor)\nTime format hint (Editor)\nRespect order after search (Editor)\nSet MySQL time zone by PHP setting (Editor)\nAllow own code in <head> (customization)\nPolish translation\n\nAdminer 3.2.0 (released 2011-02-24):\nGet long texts and slow information by AJAX\nMost links and forms by AJAX in browsers with support for history.pushState\nCopy tables\nAbility to search by expression in select\nExport SQL command result (bug #3116854)\nFocus first field with insert (bug #3126501)\nPermanent link in schema\nDisplay total time in show only errors mode in SQL command\nHistory: edit all\nMS SQL: auto primary and foreign key\nSQLite: display 0\nCreate table default data type: int\nFocus upper/lower fields by Ctrl+Up/Ctrl+Down\nHide credentials for SQLite\nUtilize oids in PostgreSQL\nHomepage customization\nUse IN for search in numeric fields (Editor)\nUse password input for _md5 and _sha1 fields (Editor)\nWork without session.use_cookies (bug #3138640)\nFix saving schema to cookie in Opera\nPortuguese, Slovenian and Turkish translation\n\nAdminer 3.1.0 (released 2010-11-16):\nTSV export and import\nCustomizable export\nOption to show only errors in SQL command\nLink to bookmark SQL command\nRecognize $$ strings in SQL command (PostgreSQL)\nHighlight and edit SQL command in processlist\nAlways display all drivers\nTimestamp at the end of export\nLink to refresh database cache (bug #3102451)\nSupport for virtual foreign keys\nDisable XSS \"protection\" of IE8\nImmunity against zend.ze1_compatibility_mode (bug #3089645)\nFix last page with empty result set\nArabic translation and RTL support\nDual licensing: Apache or GPL\n\nAdminer 3.0.1 (released 2010-10-18):\nSend the form by Ctrl+Enter in all textareas\nDisable creating SQLite databases with extension other than db, sdb, sqlite\nAbility to use Adminer in a frame through customization\nCatalan translation\nMS SQL 2005 compatibility\nPostgreSQL: connect if the eponymous database does not exist\n\nAdminer 3.0.0 (released 2010-10-15):\nDrivers for MS SQL, SQLite, PostgreSQL, Oracle\nAllow concurrent logins on the same server\nAllow permanent login without customization\nIn-place editation in select\nForeign key options in Table creation\nTreat binary type as hex\nShow number of tables in server overview\nOperator LIKE %%\nRemember export parameters in cookie\nAllow semicolon as CSV separator\nSchemas, sequences and types support (PostgreSQL)\nAutofocus username in login form\nAllow to insert Tab in SQL textareas and send the form by Ctrl+Enter\nDisable spellchecking in SQL textareas\nDisplay auto_increment value of inserted item\nAllow disabling auto_increment value export\nPrefill auto_increment column name\nAbility to jump to any page in select by JavaScript\nDisplay comment in table overview\nLink last page above data in select\nLink table names in SQL queries\nHungarian, Japanese and Tamil translation\nDefer table information in database overview to JavaScript (performance)\nBig tables optimizations (performance)\n\nAdminer 2.3.2 (released 2010-04-21):\nFix COUNT(*) link\nFix Save and continue edit\n\nAdminer 2.3.1 (released 2010-04-06):\nAdd Drop button to Alter pages (regression from 2.0.0)\nLink COUNT(*) result to listing\nNewlines in select query edit\nReturn to referrer after edit\nRespect session.auto_start (bug #2967284)\n\nAdminer 2.3.0 (released 2010-02-26):\nSupport for permanent login (customization required)\nSearch in all tables\nShow status variables\nPrint sums in tables overview\nAdd Delete button to Edit page (regression from 2.0.0)\nPrint error summary in SQL command\nSimplify SQL syntax error message\nShow SQL query info if available\nDelete length when changing type in alter table\nAbility to check table prefix in export\n\nAdminer 2.2.1 (released 2009-11-26):\nHighlight current links\nImprove concurrency\nMove number of tables to DB info (performance)\nSearch by foreign keys (Editor)\nLink new item in backward keys (Editor)\n\nAdminer 2.2.0 (released 2009-10-20):\nDatabase list - bulk drop, number of tables\nEnlarge field for enum and set definition\nDisplay table links above table structure\nLink URLs in select\nDisplay number of manipulated rows in JS confirm\nSet required memory in SQL command\nFix removed default in ALTER\nDisplay whitespace in texts (bug #2858042)\nClickJacking protection in modern browsers\nE-mail attachments (Editor)\nOptional year in date (Editor)\nSearch operators (Editor)\nAlign numbers to right in select (Editor)\nMove <h1> to $adminer->navigation (customization)\nRename get_dbh to connection (customization)\n\nAdminer 2.1.0 (released 2009-09-12):\nEdit default values directly in table creation\nExecute SQL file stored on server disk\nDisplay EXPLAIN in SQL query\nCompress export and import\nDisplay column comments in table overview\nUse ON DUPLICATE KEY UPDATE for CSV import\nPrint ALTER export instead of executing it\nClick on row selects it\nFix Editor date format\nFix long SQL query crash (bug #2839231)\nSpeed up simple alter table\nTraditional Chinese translation\n\nAdminer 2.0.0 (released 2009-08-06):\nEditor: User friendly data editor\nCustomization: Adminer class\nCreate single column foreign key in table structure\nTable relations (Editor)\nSend e-mails (Editor)\nDisplay images in blob (Editor)\nLocalize date (Editor)\nTreat tinyint(1) as bool (Editor)\nDivide types to groups in table creation\nLink e-mails in select\nShow type in field name title\nPreselect now() for timestamp columns\nClear history\nPrefill insert by foreign key searches\nPrint number of rows in SQL command\nRemove Delete button from Edit page - use mass operation for it\nFaster multiple update, clone and delete\nFaster table list in navigation\nDownload version checker and syntax highlighting from HTTPS\nUse HTML Strict instead of XHTML\nRemove function minification in favor of performance and customization\nFix grant ALL PRIVILEGES with GRANT OPTION\nFix CSV import\nFix work with default values\n\nAdminer 1.11.1 (released 2009-07-03):\nFix problem with enabled Filter extension\n\nAdminer 1.11.0 (released 2009-07-02):\nConnection through socket by server :/path/to/socket\nSimplify export\nDisplay execution time in SQL query\nRelative date and time functions\nVersion checker\nSave queries to history and display it on SQL page\nDisplay MySQL variables\nAbility to select all rows on current page of select\nSeparate JavaScript functions\nAlways use the default style before the external one\nAlways try to use the syntax highlighter\nAll privileges in user rights\nFix FOUND_ROWS() in SQL command\nExport only selected columns in select\nBulk database creation\nInclude views in drop and move on database overview\nHide fieldsets in select\nAutomatically add new fields in table creation\nUse \\n in SQL commands\n\nphpMinAdmin 1.10.1 (released 2009-05-07):\nHighlight odd and hover rows\nPartition editing comfort (bug #2783446)\nAllow full length in limited int\n\nphpMinAdmin 1.10.0 (released 2009-04-28):\nPartitioning (MySQL 5.1)\nCSV import\nPlus and minus functions\nOption to stop on error in SQL command\nCross links to select and table (bug #2236232), link new item\nSuhosin compatibility\nRemove max_allowed_packet from export\nRead style from phpMinAdmin.css if exists\nSize reduction by minification of variables and functions\nRussian translation\n\nphpMinAdmin 1.9.1 (released 2008-10-27):\nUpdate translations\n\nphpMinAdmin 1.9.0 (released 2008-10-16):\nList of tables and views with maintenance commands\nClone rows\nBulk edit and clone\nFunction results in edit\nNOT operators in select\nSearch without column restriction\nUse type=password for unhashed password\nOnly one button for each action in select\nChoose language through option-list\nXHTML syntax errors\nDon't set global variable in export\nSHOW DATABASES can be revoked\nOrder by function result working also in older MySQL versions\nTested on IIS\n\nphpMinAdmin 1.8.0 (released 2008-09-12):\nEvents (MySQL 5.1)\nAccess without login - accept ?username=\nPrint SQL query in select, messages and warnings\nDisplay number of found rows\nDon't wrap lines in select table\nItalian and Estonian translation\nOrder by COUNT(*)\n\nphpMinAdmin 1.7.0 (released 2008-08-26):\nCustomizable export (select objects to export, SQL or CSV)\nAbility to alter existing tables and drop old tables in export\nChoose columns in select, aggregation\nOrder rows by clicking on table heading\nTruncate only search results\nAutomatically select name for trigger\nChinese and French translation\nPreserve default values when altering table\nMaintain auto_increment when moving columns\nSmaller multilingual file\nCache static files\nFaster checking of number of results\n\nphpMinAdmin 1.6.1 (released 2008-05-22):\nSet session parameters only if not session.auto_start\n\nphpMinAdmin 1.6.0 (released 2008-05-16):\nOrder of columns in table\nSet max_allowed_packet in dump and use extended insert\nSpanish and German translations\nUse images for editing buttons\nProtection against big POST data\nLogout by POST\nInformation about logged user\nSeparate stylesheet\nLast-Modified header for files\nSeveral bug fixes\n\nphpMinAdmin 1.5.0 (released 2008-01-09):\nMass delete\nVertical privileges\nSpecify connection port by colon in server\nIgnore length in date and time types\nBoolean fulltext search for all columns in MyISAM\nShrink compiled output\nRemove maxlength from server and username\nUncheck NULL by change\nMark shortened fields in select\n\nphpMinAdmin 1.4.0 (released 2007-08-15):\nPrivileges\nNew design\nDutch translation\nUse NULL for auto_increment (bug #1768966)\nFix dropping procedure parameters\n\nphpMinAdmin 1.3.2 (released 2007-08-06):\nNext field by JavaScript in foreign keys\nSet time zone in dump\nRefresh lang cookie\nRemember drop result in case of faulty create\nMove vertical lines in schema properly\nFix maximum page in select\n\nphpMinAdmin 1.3.1 (released 2007-07-31):\nMove references lines in schema\nFix dump\nFix update links\n\nphpMinAdmin 1.3.0 (released 2007-07-27):\nBreadcrumb navigation\nOperator IN\nTimestamp default values\nDraggable tables in schema\nNumber of rows in navigation\nDisplay MySQL version and used PHP extension\nMore friendly user interface\nSlovak translation\n\nphpMinAdmin 1.2.0 (released 2007-07-25):\nManipulate triggers\nPDO Abstraction\nAuto_increment value\nJavaScript for adding rows\n\nphpMinAdmin 1.1.0 (released 2007-07-19):\nRoutines manipulation\nViews manipulation\nForeign keys manipulation\nDatabase schema with references\nProcesslist\nIndex length\nDump individual tables\nJavaScript for next rows in table edit\nCache databases list\n\nphpMinAdmin 1.0.0 (released 2007-07-11):\nFirst official release\n"], "fixing_code": ["<?php\n$drivers[\"clickhouse\"] = \"ClickHouse (alpha)\";\n\nif (isset($_GET[\"clickhouse\"])) {\n\tdefine(\"DRIVER\", \"clickhouse\");\n\n\tclass Min_DB {\n\t\tvar $extension = \"JSON\", $server_info, $errno, $_result, $error, $_url;\n\t\tvar $_db = 'default';\n\n\t\tfunction rootQuery($db, $query) {\n\t\t\t@ini_set('track_errors', 1); // @ - may be disabled\n\t\t\t$file = @file_get_contents(\"$this->_url/?database=$db\", false, stream_context_create(array('http' => array(\n\t\t\t\t'method' => 'POST',\n\t\t\t\t'content' => $this->isQuerySelectLike($query) ? \"$query FORMAT JSONCompact\" : $query,\n\t\t\t\t'header' => 'Content-type: application/x-www-form-urlencoded',\n\t\t\t\t'ignore_errors' => 1, // available since PHP 5.2.10\n\t\t\t))));\n\n\t\t\tif ($file === false) {\n\t\t\t\t$this->error = $php_errormsg;\n\t\t\t\treturn $file;\n\t\t\t}\n\t\t\tif (!preg_match('~^HTTP/[0-9.]+ 2~i', $http_response_header[0])) {\n\t\t\t\t$this->error = lang('Invalid credentials.') . \" $http_response_header[0]\";\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t$return = json_decode($file, true);\n\t\t\tif ($return === null) {\n\t\t\t\tif (!$this->isQuerySelectLike($query) && $file === '') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t$this->errno = json_last_error();\n\t\t\t\tif (function_exists('json_last_error_msg')) {\n\t\t\t\t\t$this->error = json_last_error_msg();\n\t\t\t\t} else {\n\t\t\t\t\t$constants = get_defined_constants(true);\n\t\t\t\t\tforeach ($constants['json'] as $name => $value) {\n\t\t\t\t\t\tif ($value == $this->errno && preg_match('~^JSON_ERROR_~', $name)) {\n\t\t\t\t\t\t\t$this->error = $name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn new Min_Result($return);\n\t\t}\n\n\t\tfunction isQuerySelectLike($query) {\n\t\t\treturn (bool) preg_match('~^(select|show)~i', $query);\n\t\t}\n\n\t\tfunction query($query) {\n\t\t\treturn $this->rootQuery($this->_db, $query);\n\t\t}\n\n\t\tfunction connect($server, $username, $password) {\n\t\t\tpreg_match('~^(https?://)?(.*)~', $server, $match);\n\t\t\t$this->_url = ($match[1] ? $match[1] : \"http://\") . \"$username:$password@$match[2]\";\n\t\t\t$return = $this->query('SELECT 1');\n\t\t\treturn (bool) $return;\n\t\t}\n\n\t\tfunction select_db($database) {\n\t\t\t$this->_db = $database;\n\t\t\treturn true;\n\t\t}\n\n\t\tfunction quote($string) {\n\t\t\treturn \"'\" . addcslashes($string, \"\\\\'\") . \"'\";\n\t\t}\n\n\t\tfunction multi_query($query) {\n\t\t\treturn $this->_result = $this->query($query);\n\t\t}\n\n\t\tfunction store_result() {\n\t\t\treturn $this->_result;\n\t\t}\n\n\t\tfunction next_result() {\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction result($query, $field = 0) {\n\t\t\t$result = $this->query($query);\n\t\t\treturn $result['data'];\n\t\t}\n\t}\n\n\tclass Min_Result {\n\t\tvar $num_rows, $_rows, $columns, $meta, $_offset = 0;\n\n\t\tfunction __construct($result) {\n\t\t\t$this->num_rows = $result['rows'];\n\t\t\t$this->_rows = $result['data'];\n\t\t\t$this->meta = $result['meta'];\n\t\t\t$this->columns = array_column($this->meta, 'name');\n\t\t\treset($this->_rows);\n\t\t}\n\n\t\tfunction fetch_assoc() {\n\t\t\t$row = current($this->_rows);\n\t\t\tnext($this->_rows);\n\t\t\treturn $row === false ? false : array_combine($this->columns, $row);\n\t\t}\n\n\t\tfunction fetch_row() {\n\t\t\t$row = current($this->_rows);\n\t\t\tnext($this->_rows);\n\t\t\treturn $row;\n\t\t}\n\n\t\tfunction fetch_field() {\n\t\t\t$column = $this->_offset++;\n\t\t\t$return = new stdClass;\n\t\t\tif ($column < count($this->columns)) {\n\t\t\t\t$return->name = $this->meta[$column]['name'];\n\t\t\t\t$return->orgname = $return->name;\n\t\t\t\t$return->type = $this->meta[$column]['type'];\n\t\t\t}\n\t\t\treturn $return;\n\t\t}\n\t}\n\n\n\tclass Min_Driver extends Min_SQL {\n\t\tfunction delete($table, $queryWhere, $limit = 0) {\n\t\t\tif ($queryWhere === '') {\n\t\t\t\t$queryWhere = 'WHERE 1=1';\n\t\t\t}\n\t\t\treturn queries(\"ALTER TABLE \" . table($table) . \" DELETE $queryWhere\");\n\t\t}\n\n\t\tfunction update($table, $set, $queryWhere, $limit = 0, $separator = \"\\n\") {\n\t\t\t$values = array();\n\t\t\tforeach ($set as $key => $val) {\n\t\t\t\t$values[] = \"$key = $val\";\n\t\t\t}\n\t\t\t$query = $separator . implode(\",$separator\", $values);\n\t\t\treturn queries(\"ALTER TABLE \" . table($table) . \" UPDATE $query$queryWhere\");\n\t\t}\n\t}\n\n\tfunction idf_escape($idf) {\n\t\treturn \"`\" . str_replace(\"`\", \"``\", $idf) . \"`\";\n\t}\n\n\tfunction table($idf) {\n\t\treturn idf_escape($idf);\n\t}\n\n\tfunction explain($connection, $query) {\n\t\treturn '';\n\t}\n\n\tfunction found_rows($table_status, $where) {\n\t\t$rows = get_vals(\"SELECT COUNT(*) FROM \" . idf_escape($table_status[\"Name\"]) . ($where ? \" WHERE \" . implode(\" AND \", $where) : \"\"));\n\t\treturn empty($rows) ? false : $rows[0];\n\t}\n\n\tfunction alter_table($table, $name, $fields, $foreign, $comment, $engine, $collation, $auto_increment, $partitioning) {\n\t\t$alter = $order = array();\n\t\tforeach ($fields as $field) {\n\t\t\tif ($field[1][2] === \" NULL\") {\n\t\t\t\t$field[1][1] = \" Nullable({$field[1][1]})\";\n\t\t\t} elseif ($field[1][2] === ' NOT NULL') {\n\t\t\t\t$field[1][2] = '';\n\t\t\t}\n\n\t\t\tif ($field[1][3]) {\n\t\t\t\t$field[1][3] = '';\n\t\t\t}\n\n\t\t\t$alter[] = ($field[1]\n\t\t\t\t? ($table != \"\" ? ($field[0] != \"\" ? \"MODIFY COLUMN \" : \"ADD COLUMN \") : \" \") . implode($field[1])\n\t\t\t\t: \"DROP COLUMN \" . idf_escape($field[0])\n\t\t\t);\n\n\t\t\t$order[] = $field[1][0];\n\t\t}\n\n\t\t$alter = array_merge($alter, $foreign);\n\t\t$status = ($engine ? \" ENGINE \" . $engine : \"\");\n\t\tif ($table == \"\") {\n\t\t\treturn queries(\"CREATE TABLE \" . table($name) . \" (\\n\" . implode(\",\\n\", $alter) . \"\\n)$status$partitioning\" . ' ORDER BY (' . implode(',', $order) . ')');\n\t\t}\n\t\tif ($table != $name) {\n\t\t\t$result = queries(\"RENAME TABLE \" . table($table) . \" TO \" . table($name));\n\t\t\tif ($alter) {\n\t\t\t\t$table = $name;\n\t\t\t} else {\n\t\t\t\treturn $result;\n\t\t\t}\n\t\t}\n\t\tif ($status) {\n\t\t\t$alter[] = ltrim($status);\n\t\t}\n\t\treturn ($alter || $partitioning ? queries(\"ALTER TABLE \" . table($table) . \"\\n\" . implode(\",\\n\", $alter) . $partitioning) : true);\n\t}\n\n\tfunction truncate_tables($tables) {\n\t\treturn apply_queries(\"TRUNCATE TABLE\", $tables);\n\t}\n\n\tfunction drop_views($views) {\n\t\treturn drop_tables($views);\n\t}\n\n\tfunction drop_tables($tables) {\n\t\treturn apply_queries(\"DROP TABLE\", $tables);\n\t}\n\n\tfunction connect() {\n\t\tglobal $adminer;\n\t\t$connection = new Min_DB;\n\t\t$credentials = $adminer->credentials();\n\t\tif ($connection->connect($credentials[0], $credentials[1], $credentials[2])) {\n\t\t\treturn $connection;\n\t\t}\n\t\treturn $connection->error;\n\t}\n\n\tfunction get_databases($flush) {\n\t\tglobal $connection;\n\t\t$result = get_rows('SHOW DATABASES');\n\n\t\t$return = array();\n\t\tforeach ($result as $row) {\n\t\t\t$return[] = $row['name'];\n\t\t}\n\t\tsort($return);\n\t\treturn $return;\n\t}\n\n\tfunction limit($query, $where, $limit, $offset = 0, $separator = \" \") {\n\t\treturn \" $query$where\" . ($limit !== null ? $separator . \"LIMIT $limit\" . ($offset ? \", $offset\" : \"\") : \"\");\n\t}\n\n\tfunction limit1($table, $query, $where, $separator = \"\\n\") {\n\t\treturn limit($query, $where, 1, 0, $separator);\n\t}\n\n\tfunction db_collation($db, $collations) {\n\t}\n\n\tfunction engines() {\n\t\treturn array('MergeTree');\n\t}\n\n\tfunction logged_user() {\n\t\tglobal $adminer;\n\t\t$credentials = $adminer->credentials();\n\t\treturn $credentials[1];\n\t}\n\n\tfunction tables_list() {\n\t\t$result = get_rows('SHOW TABLES');\n\t\t$return = array();\n\t\tforeach ($result as $row) {\n\t\t\t$return[$row['name']] = 'table';\n\t\t}\n\t\tksort($return);\n\t\treturn $return;\n\t}\n\n\tfunction count_tables($databases) {\n\t\treturn array();\n\t}\n\n\tfunction table_status($name = \"\", $fast = false) {\n\t\tglobal $connection;\n\t\t$return = array();\n\t\t$tables = get_rows(\"SELECT name, engine FROM system.tables WHERE database = \" . q($connection->_db));\n\t\tforeach ($tables as $table) {\n\t\t\t$return[$table['name']] = array(\n\t\t\t\t'Name' => $table['name'],\n\t\t\t\t'Engine' => $table['engine'],\n\t\t\t);\n\t\t\tif ($name === $table['name']) {\n\t\t\t\treturn $return[$table['name']];\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction is_view($table_status) {\n\t\treturn false;\n\t}\n\n\tfunction fk_support($table_status) {\n\t\treturn false;\n\t}\n\n\tfunction convert_field($field) {\n\t}\n\n\tfunction unconvert_field($field, $return) {\n\t\tif (in_array($field['type'], array(\"Int8\", \"Int16\", \"Int32\", \"Int64\", \"UInt8\", \"UInt16\", \"UInt32\", \"UInt64\", \"Float32\", \"Float64\"))) {\n\t\t\treturn \"to$field[type]($return)\";\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction fields($table) {\n\t\t$return = array();\n\t\t$result = get_rows(\"SELECT name, type, default_expression FROM system.columns WHERE \" . idf_escape('table') . \" = \" . q($table));\n\t\tforeach ($result as $row) {\n\t\t\t$type = trim($row['type']);\n\t\t\t$nullable = strpos($type, 'Nullable(') === 0;\n\t\t\t$return[trim($row['name'])] = array(\n\t\t\t\t\"field\" => trim($row['name']),\n\t\t\t\t\"full_type\" => $type,\n\t\t\t\t\"type\" => $type,\n\t\t\t\t\"default\" => trim($row['default_expression']),\n\t\t\t\t\"null\" => $nullable,\n\t\t\t\t\"auto_increment\" => '0',\n\t\t\t\t\"privileges\" => array(\"insert\" => 1, \"select\" => 1, \"update\" => 0),\n\t\t\t);\n\t\t}\n\n\t\treturn $return;\n\t}\n\n\tfunction indexes($table, $connection2 = null) {\n\t\treturn array();\n\t}\n\n\tfunction foreign_keys($table) {\n\t\treturn array();\n\t}\n\n\tfunction collations() {\n\t\treturn array();\n\t}\n\n\tfunction information_schema($db) {\n\t\treturn false;\n\t}\n\n\tfunction error() {\n\t\tglobal $connection;\n\t\treturn h($connection->error);\n\t}\n\n\tfunction types() {\n\t\treturn array();\n\t}\n\n\tfunction schemas() {\n\t\treturn array();\n\t}\n\n\tfunction get_schema() {\n\t\treturn \"\";\n\t}\n\n\tfunction set_schema($schema) {\n\t\treturn true;\n\t}\n\n\tfunction auto_increment() {\n\t\treturn '';\n\t}\n\n\tfunction last_id() {\n\t\treturn 0; // ClickHouse doesn't have it\n\t}\n\n\tfunction support($feature) {\n\t\treturn preg_match(\"~^(columns|sql|status|table|drop_col)$~\", $feature);\n\t}\n\n\t$jush = \"clickhouse\";\n\t$types = array();\n\t$structured_types = array();\n\tforeach (array( //! arrays\n\t\tlang('Numbers') => array(\"Int8\" => 3, \"Int16\" => 5, \"Int32\" => 10, \"Int64\" => 19, \"UInt8\" => 3, \"UInt16\" => 5, \"UInt32\" => 10, \"UInt64\" => 20, \"Float32\" => 7, \"Float64\" => 16, 'Decimal' => 38, 'Decimal32' => 9, 'Decimal64' => 18, 'Decimal128' => 38),\n\t\tlang('Date and time') => array(\"Date\" => 13, \"DateTime\" => 20),\n\t\tlang('Strings') => array(\"String\" => 0),\n\t\tlang('Binary') => array(\"FixedString\" => 0),\n\t) as $key => $val) {\n\t\t$types += $val;\n\t\t$structured_types[$key] = array_keys($val);\n\t}\n\t$unsigned = array();\n\t$operators = array(\"=\", \"<\", \">\", \"<=\", \">=\", \"!=\", \"~\", \"!~\", \"LIKE\", \"LIKE %%\", \"IN\", \"IS NULL\", \"NOT LIKE\", \"NOT IN\", \"IS NOT NULL\", \"SQL\");\n\t$functions = array();\n\t$grouping = array(\"avg\", \"count\", \"count distinct\", \"max\", \"min\", \"sum\");\n\t$edit_functions = array();\n}\n", "<?php\n$drivers[\"elastic\"] = \"Elasticsearch (beta)\";\n\nif (isset($_GET[\"elastic\"])) {\n\t$possible_drivers = array(\"json + allow_url_fopen\");\n\tdefine(\"DRIVER\", \"elastic\");\n\n\tif (function_exists('json_decode') && ini_bool('allow_url_fopen')) {\n\t\tclass Min_DB {\n\t\t\tvar $extension = \"JSON\", $server_info, $errno, $error, $_url;\n\n\t\t\t/** Performs query\n\t\t\t * @param string\n\t\t\t * @param array\n\t\t\t * @param string\n\t\t\t * @return mixed\n\t\t\t */\n\t\t\tfunction rootQuery($path, $content = array(), $method = 'GET') {\n\t\t\t\t@ini_set('track_errors', 1); // @ - may be disabled\n\t\t\t\t$file = @file_get_contents(\"$this->_url/\" . ltrim($path, '/'), false, stream_context_create(array('http' => array(\n\t\t\t\t\t'method' => $method,\n\t\t\t\t\t'content' => $content === null ? $content : json_encode($content),\n\t\t\t\t\t'header' => 'Content-Type: application/json',\n\t\t\t\t\t'ignore_errors' => 1, // available since PHP 5.2.10\n\t\t\t\t))));\n\t\t\t\tif (!$file) {\n\t\t\t\t\t$this->error = $php_errormsg;\n\t\t\t\t\treturn $file;\n\t\t\t\t}\n\t\t\t\tif (!preg_match('~^HTTP/[0-9.]+ 2~i', $http_response_header[0])) {\n\t\t\t\t\t$this->error = lang('Invalid credentials.') . \" $http_response_header[0]\";\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t$return = json_decode($file, true);\n\t\t\t\tif ($return === null) {\n\t\t\t\t\t$this->errno = json_last_error();\n\t\t\t\t\tif (function_exists('json_last_error_msg')) {\n\t\t\t\t\t\t$this->error = json_last_error_msg();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$constants = get_defined_constants(true);\n\t\t\t\t\t\tforeach ($constants['json'] as $name => $value) {\n\t\t\t\t\t\t\tif ($value == $this->errno && preg_match('~^JSON_ERROR_~', $name)) {\n\t\t\t\t\t\t\t\t$this->error = $name;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn $return;\n\t\t\t}\n\n\t\t\t/** Performs query relative to actual selected DB\n\t\t\t * @param string\n\t\t\t * @param array\n\t\t\t * @param string\n\t\t\t * @return mixed\n\t\t\t */\n\t\t\tfunction query($path, $content = array(), $method = 'GET') {\n\t\t\t\treturn $this->rootQuery(($this->_db != \"\" ? \"$this->_db/\" : \"/\") . ltrim($path, '/'), $content, $method);\n\t\t\t}\n\n\t\t\tfunction connect($server, $username, $password) {\n\t\t\t\tpreg_match('~^(https?://)?(.*)~', $server, $match);\n\t\t\t\t$this->_url = ($match[1] ? $match[1] : \"http://\") . \"$username:$password@$match[2]\";\n\t\t\t\t$return = $this->query('');\n\t\t\t\tif ($return) {\n\t\t\t\t\t$this->server_info = $return['version']['number'];\n\t\t\t\t}\n\t\t\t\treturn (bool) $return;\n\t\t\t}\n\n\t\t\tfunction select_db($database) {\n\t\t\t\t$this->_db = $database;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tfunction quote($string) {\n\t\t\t\treturn $string;\n\t\t\t}\n\n\t\t}\n\n\t\tclass Min_Result {\n\t\t\tvar $num_rows, $_rows;\n\n\t\t\tfunction __construct($rows) {\n\t\t\t\t$this->num_rows = count($rows);\n\t\t\t\t$this->_rows = $rows;\n\t\t\t\treset($this->_rows);\n\t\t\t}\n\n\t\t\tfunction fetch_assoc() {\n\t\t\t\t$return = current($this->_rows);\n\t\t\t\tnext($this->_rows);\n\t\t\t\treturn $return;\n\t\t\t}\n\n\t\t\tfunction fetch_row() {\n\t\t\t\treturn array_values($this->fetch_assoc());\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\n\tclass Min_Driver extends Min_SQL {\n\n\t\tfunction select($table, $select, $where, $group, $order = array(), $limit = 1, $page = 0, $print = false) {\n\t\t\tglobal $adminer;\n\t\t\t$data = array();\n\t\t\t$query = \"$table/_search\";\n\t\t\tif ($select != array(\"*\")) {\n\t\t\t\t$data[\"fields\"] = $select;\n\t\t\t}\n\t\t\tif ($order) {\n\t\t\t\t$sort = array();\n\t\t\t\tforeach ($order as $col) {\n\t\t\t\t\t$col = preg_replace('~ DESC$~', '', $col, 1, $count);\n\t\t\t\t\t$sort[] = ($count ? array($col => \"desc\") : $col);\n\t\t\t\t}\n\t\t\t\t$data[\"sort\"] = $sort;\n\t\t\t}\n\t\t\tif ($limit) {\n\t\t\t\t$data[\"size\"] = +$limit;\n\t\t\t\tif ($page) {\n\t\t\t\t\t$data[\"from\"] = ($page * $limit);\n\t\t\t\t}\n\t\t\t}\n\t\t\tforeach ($where as $val) {\n\t\t\t\tlist($col, $op, $val) = explode(\" \", $val, 3);\n\t\t\t\tif ($col == \"_id\") {\n\t\t\t\t\t$data[\"query\"][\"ids\"][\"values\"][] = $val;\n\t\t\t\t}\n\t\t\t\telseif ($col . $val != \"\") {\n\t\t\t\t\t$term = array(\"term\" => array(($col != \"\" ? $col : \"_all\") => $val));\n\t\t\t\t\tif ($op == \"=\") {\n\t\t\t\t\t\t$data[\"query\"][\"filtered\"][\"filter\"][\"and\"][] = $term;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$data[\"query\"][\"filtered\"][\"query\"][\"bool\"][\"must\"][] = $term;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($data[\"query\"] && !$data[\"query\"][\"filtered\"][\"query\"] && !$data[\"query\"][\"ids\"]) {\n\t\t\t\t$data[\"query\"][\"filtered\"][\"query\"] = array(\"match_all\" => array());\n\t\t\t}\n\t\t\t$start = microtime(true);\n\t\t\t$search = $this->_conn->query($query, $data);\n\t\t\tif ($print) {\n\t\t\t\techo $adminer->selectQuery(\"$query: \" . json_encode($data), $start, !$search);\n\t\t\t}\n\t\t\tif (!$search) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t$return = array();\n\t\t\tforeach ($search['hits']['hits'] as $hit) {\n\t\t\t\t$row = array();\n\t\t\t\tif ($select == array(\"*\")) {\n\t\t\t\t\t$row[\"_id\"] = $hit[\"_id\"];\n\t\t\t\t}\n\t\t\t\t$fields = $hit['_source'];\n\t\t\t\tif ($select != array(\"*\")) {\n\t\t\t\t\t$fields = array();\n\t\t\t\t\tforeach ($select as $key) {\n\t\t\t\t\t\t$fields[$key] = $hit['fields'][$key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tforeach ($fields as $key => $val) {\n\t\t\t\t\tif ($data[\"fields\"]) {\n\t\t\t\t\t\t$val = $val[0];\n\t\t\t\t\t}\n\t\t\t\t\t$row[$key] = (is_array($val) ? json_encode($val) : $val); //! display JSON and others differently\n\t\t\t\t}\n\t\t\t\t$return[] = $row;\n\t\t\t}\n\t\t\treturn new Min_Result($return);\n\t\t}\n\n\t\tfunction update($type, $record, $queryWhere, $limit = 0, $separator = \"\\n\") {\n\t\t\t//! use $limit\n\t\t\t$parts = preg_split('~ *= *~', $queryWhere);\n\t\t\tif (count($parts) == 2) {\n\t\t\t\t$id = trim($parts[1]);\n\t\t\t\t$query = \"$type/$id\";\n\t\t\t\treturn $this->_conn->query($query, $record, 'POST');\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction insert($type, $record) {\n\t\t\t$id = \"\"; //! user should be able to inform _id\n\t\t\t$query = \"$type/$id\";\n\t\t\t$response = $this->_conn->query($query, $record, 'POST');\n\t\t\t$this->_conn->last_id = $response['_id'];\n\t\t\treturn $response['created'];\n\t\t}\n\n\t\tfunction delete($type, $queryWhere, $limit = 0) {\n\t\t\t//! use $limit\n\t\t\t$ids = array();\n\t\t\tif (is_array($_GET[\"where\"]) && $_GET[\"where\"][\"_id\"]) {\n\t\t\t\t$ids[] = $_GET[\"where\"][\"_id\"];\n\t\t\t}\n\t\t\tif (is_array($_POST['check'])) {\n\t\t\t\tforeach ($_POST['check'] as $check) {\n\t\t\t\t\t$parts = preg_split('~ *= *~', $check);\n\t\t\t\t\tif (count($parts) == 2) {\n\t\t\t\t\t\t$ids[] = trim($parts[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t$this->_conn->affected_rows = 0;\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$query = \"{$type}/{$id}\";\n\t\t\t\t$response = $this->_conn->query($query, '{}', 'DELETE');\n\t\t\t\tif (is_array($response) && $response['found'] == true) {\n\t\t\t\t\t$this->_conn->affected_rows++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn $this->_conn->affected_rows;\n\t\t}\n\t}\n\n\n\n\tfunction connect() {\n\t\tglobal $adminer;\n\t\t$connection = new Min_DB;\n\t\tlist($server, $username, $password) = $adminer->credentials();\n\t\tif ($password != \"\" && $connection->connect($server, $username, \"\")) {\n\t\t\treturn lang('Database does not support password.');\n\t\t}\n\t\tif ($connection->connect($server, $username, $password)) {\n\t\t\treturn $connection;\n\t\t}\n\t\treturn $connection->error;\n\t}\n\n\tfunction support($feature) {\n\t\treturn preg_match(\"~database|table|columns~\", $feature);\n\t}\n\n\tfunction logged_user() {\n\t\tglobal $adminer;\n\t\t$credentials = $adminer->credentials();\n\t\treturn $credentials[1];\n\t}\n\n\tfunction get_databases() {\n\t\tglobal $connection;\n\t\t$return = $connection->rootQuery('_aliases');\n\t\tif ($return) {\n\t\t\t$return = array_keys($return);\n\t\t\tsort($return, SORT_STRING);\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction collations() {\n\t\treturn array();\n\t}\n\n\tfunction db_collation($db, $collations) {\n\t}\n\t\n\tfunction engines() {\n\t\treturn array();\n\t}\n\n\tfunction count_tables($databases) {\n\t\tglobal $connection;\n\t\t$return = array();\n\t\t$result = $connection->query('_stats');\n\t\tif ($result && $result['indices']) {\n\t\t\t$indices = $result['indices'];\n\t\t\tforeach ($indices as $indice => $stats) {\n\t\t\t\t$indexing = $stats['total']['indexing'];\n\t\t\t\t$return[$indice] = $indexing['index_total'];\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction tables_list() {\n\t\tglobal $connection;\n\t\t$return = $connection->query('_mapping');\n\t\tif ($return) {\n\t\t\t$return = array_fill_keys(array_keys($return[$connection->_db][\"mappings\"]), 'table');\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction table_status($name = \"\", $fast = false) {\n\t\tglobal $connection;\n\t\t$search = $connection->query(\"_search\", array(\n\t\t\t\"size\" => 0,\n\t\t\t\"aggregations\" => array(\n\t\t\t\t\"count_by_type\" => array(\n\t\t\t\t\t\"terms\" => array(\n\t\t\t\t\t\t\"field\" => \"_type\"\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t), \"POST\");\n\t\t$return = array();\n\t\tif ($search) {\n\t\t\t$tables = $search[\"aggregations\"][\"count_by_type\"][\"buckets\"];\n\t\t\tforeach ($tables as $table) {\n\t\t\t\t$return[$table[\"key\"]] = array(\n\t\t\t\t\t\"Name\" => $table[\"key\"],\n\t\t\t\t\t\"Engine\" => \"table\",\n\t\t\t\t\t\"Rows\" => $table[\"doc_count\"],\n\t\t\t\t);\n\t\t\t\tif ($name != \"\" && $name == $table[\"key\"]) {\n\t\t\t\t\treturn $return[$name];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction error() {\n\t\tglobal $connection;\n\t\treturn h($connection->error);\n\t}\n\n\tfunction information_schema() {\n\t}\n\n\tfunction is_view($table_status) {\n\t}\n\n\tfunction indexes($table, $connection2 = null) {\n\t\treturn array(\n\t\t\tarray(\"type\" => \"PRIMARY\", \"columns\" => array(\"_id\")),\n\t\t);\n\t}\n\n\tfunction fields($table) {\n\t\tglobal $connection;\n\t\t$result = $connection->query(\"$table/_mapping\");\n\t\t$return = array();\n\t\tif ($result) {\n\t\t\t$mappings = $result[$table]['properties'];\n\t\t\tif (!$mappings) {\n\t\t\t\t$mappings = $result[$connection->_db]['mappings'][$table]['properties'];\n\t\t\t}\n\t\t\tif ($mappings) {\n\t\t\t\tforeach ($mappings as $name => $field) {\n\t\t\t\t\t$return[$name] = array(\n\t\t\t\t\t\t\"field\" => $name,\n\t\t\t\t\t\t\"full_type\" => $field[\"type\"],\n\t\t\t\t\t\t\"type\" => $field[\"type\"],\n\t\t\t\t\t\t\"privileges\" => array(\"insert\" => 1, \"select\" => 1, \"update\" => 1),\n\t\t\t\t\t);\n\t\t\t\t\tif ($field[\"properties\"]) { // only leaf fields can be edited\n\t\t\t\t\t\tunset($return[$name][\"privileges\"][\"insert\"]);\n\t\t\t\t\t\tunset($return[$name][\"privileges\"][\"update\"]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction foreign_keys($table) {\n\t\treturn array();\n\t}\n\n\tfunction table($idf) {\n\t\treturn $idf;\n\t}\n\n\tfunction idf_escape($idf) {\n\t\treturn $idf;\n\t}\n\n\tfunction convert_field($field) {\n\t}\n\n\tfunction unconvert_field($field, $return) {\n\t\treturn $return;\n\t}\n\n\tfunction fk_support($table_status) {\n\t}\n\n\tfunction found_rows($table_status, $where) {\n\t\treturn null;\n\t}\n\n\t/** Create index\n\t* @param string\n\t* @return mixed\n\t*/\n\tfunction create_database($db) {\n\t\tglobal $connection;\n\t\treturn $connection->rootQuery(urlencode($db), null, 'PUT');\n\t}\n\n\t/** Remove index\n\t* @param array\n\t* @return mixed\n\t*/\n\tfunction drop_databases($databases) {\n\t\tglobal $connection;\n\t\treturn $connection->rootQuery(urlencode(implode(',', $databases)), array(), 'DELETE');\n\t}\n\n\t/** Alter type\n\t* @param array\n\t* @return mixed\n\t*/\n\tfunction alter_table($table, $name, $fields, $foreign, $comment, $engine, $collation, $auto_increment, $partitioning) {\n\t\tglobal $connection;\n\t\t$properties = array();\n\t\tforeach ($fields as $f) {\n\t\t\t$field_name = trim($f[1][0]);\n\t\t\t$field_type = trim($f[1][1] ? $f[1][1] : \"text\");\n\t\t\t$properties[$field_name] = array(\n\t\t\t\t'type' => $field_type\n\t\t\t);\n\t\t}\n\t\tif (!empty($properties)) {\n\t\t\t$properties = array('properties' => $properties);\n\t\t}\n\t\treturn $connection->query(\"_mapping/{$name}\", $properties, 'PUT');\n\t}\n\n\t/** Drop types\n\t* @param array\n\t* @return bool\n\t*/\n\tfunction drop_tables($tables) {\n\t\tglobal $connection;\n\t\t$return = true;\n\t\tforeach ($tables as $table) { //! convert to bulk api\n\t\t\t$return = $return && $connection->query(urlencode($table), array(), 'DELETE');\n\t\t}\n\t\treturn $return;\n\t}\n\n\tfunction last_id() {\n\t\tglobal $connection;\n\t\treturn $connection->last_id;\n\t}\n\n\t$jush = \"elastic\";\n\t$operators = array(\"=\", \"query\");\n\t$functions = array();\n\t$grouping = array();\n\t$edit_functions = array(array(\"json\"));\n\t$types = array(); ///< @var array ($type => $maximum_unsigned_length, ...)\n\t$structured_types = array(); ///< @var array ($description => array($type, ...), ...)\n\tforeach (array(\n\t\tlang('Numbers') => array(\"long\" => 3, \"integer\" => 5, \"short\" => 8, \"byte\" => 10, \"double\" => 20, \"float\" => 66, \"half_float\" => 12, \"scaled_float\" => 21),\n\t\tlang('Date and time') => array(\"date\" => 10),\n\t\tlang('Strings') => array(\"string\" => 65535, \"text\" => 65535),\n\t\tlang('Binary') => array(\"binary\" => 255),\n\t) as $key => $val) {\n\t\t$types += $val;\n\t\t$structured_types[$key] = array_keys($val);\n\t}\n}\n", "Adminer 4.7.9-dev:\nElasticsearch, ClickHouse: Do not print response if HTTP code is not 200\nRe-enable PHP warnings (regression from 4.7.8)\n\nAdminer 4.7.8 (released 2020-12-06):\nSupport PHP 8\nDisallow connecting to privileged ports (bug #769)\n\nAdminer 4.7.7 (released 2020-05-11):\nFix open redirect if Adminer is accessible at //adminer.php%2F@\n\nAdminer 4.7.6 (released 2020-01-31):\nSpeed up alter table form (regression from 4.4.0)\nFix clicking on non-input fields in alter table (regression from 4.6.2)\nDisplay time of procedure execution\nDisallow connecting to ports > 65535 (bug #730)\nMySQL: Always set foreign_key_checks in export\nPostgreSQL: Support exporting views\nEditor: Fix focusing foreign key search in select\n\nAdminer 4.7.5 (released 2019-11-13):\nAdd id=\"\" to cells with failed inline edit (bug #708)\nPostgreSQL: Fix getting default value in PostgreSQL 12 (bug #719)\nPostgreSQL, Oracle: Set schema for EXPLAIN queries in SQL command (bug #706)\nClickHouse: SQL command\nSwedish translation\n\nAdminer 4.7.4 (released 2019-10-22):\nFix XSS if Adminer is accessible at URL /data:\n\nAdminer 4.7.3 (released 2019-08-27):\nAllow editing foreign keys pointing to tables in other database/schema (bug #694)\nFix blocking of concurrent instances in PHP >7.2 (bug #703)\nMySQL: Speed up displaying tables in large databases (bug #700, regression from 4.7.2)\nMySQL: Allow editing rows identified by negative floats (bug #695)\nMySQL: Skip editing generated columns\nSQLite: Quote strings stored in integer columns in export (bug #696)\nSQLite: Handle error in altering table (bug #697)\nSQLite: Allow setting auto increment for empty tables\nSQLite: Preserve auto increment when recreating table\nMS SQL: Support foreign keys to other DB\nMongoDB: Allow setting authSource from environment variable \n\nAdminer 4.7.2 (released 2019-07-18):\nDo not attempt logging in without password (bug #676)\nStretch footer over the whole table width (bug #624)\nAllow overwriting tables when copying them\nFix displaying SQL command after Save and continue edit\nCache busting for adminer.css\nMySQL: Fix displaying multi-columns foreign keys (bug #675, regression from 4.7.0)\nMySQL: Fix creating users and changing password in MySQL 8 (bug #663)\nMySQL: Pass SRID to GeomFromText\nPostgreSQL: Fix setting column comments on new table\nPostgreSQL: Display definitions of materialized views (bug #682)\nPostgreSQL: Fix table status in PostgreSQL 12 (bug #683)\nMS SQL: Support comments\nElasticsearch: Fix setting number of rows\n\nAdminer 4.7.1 (released 2019-01-24):\nDisplay the tables scrollbar (bug #647)\nRemember visible columns in Create Table form (bug #493)\nAdd autocomplete attributes to login form\nPHP <5.4 compatibility even with ClickHouse enabled (regression from 4.7.0)\nSQLite: Hide server field in login form\nEditor: Allow disabling boolean fields in PostgreSQL (bug #640)\n\nAdminer 4.7.0 (released 2018-11-24):\nSimplify storing executed SQL queries to bookmarks\nWarn when using password with leading or trailing spaces\nHide import from server if importServerPath() returns an empty string\nFix inline editing of empty cells (regression from 4.6.3)\nAllow adding more than two indexes and forign key columns at a time (regression from 4.4.0)\nAvoid overwriting existing tables when copying tables (bug #642)\nFix function change with set data type\nIncrease username maxlength to 80 (bug #623)\nMake maxlength in all fields a soft limit\nMake tables horizontally scrollable\nMySQL: Support foreign keys created with ANSI quotes (bug #620)\nMySQL: Recognize ON UPDATE current_timestamp() (bug #632, bug #638)\nMySQL: Descending indexes in MySQL 8 (bug #643)\nPostgreSQL: Quote array values in export (bug #621)\nPostgreSQL: Export DESC indexes (bug #639)\nPostgreSQL: Support GENERATED BY DEFAULT AS IDENTITY in PostgreSQL 10\nMS SQL: Pass database when connecting\nClickHouse: Connect, databases list, tables list, select, SQL command\nGeorgian translation\n\nAdminer 4.6.3 (released 2018-06-28):\nDisallow using password-less databases\nCopy triggers when copying table\nStop session before connecting\nSimplify running slow queries\nDecrease timeout for running slow queries from 5 seconds to 2 seconds\nFix displaying info about non-alphabetical objects (bug #599)\nUse secure cookies on HTTP if session.cookie_secure is set\nPDO: Support binary fields download\nMySQL: Disallow LOAD DATA LOCAL INFILE\nMySQL: Use CONVERT() only when searching for non-ASCII (bug #603)\nMySQL: Order database names in MySQL 8 (bug #613)\nPostgreSQL: Fix editing data in views (bug #605, regression from 4.6.0)\nPostgreSQL: Do not cast date/time/number/uuid searches to text (bug #608)\nPostgreSQL: Export false as 0 in PDO (bug #619)\nMS SQL: Support port with sqlsrv\nEditor: Do not check boolean checkboxes with false in PostgreSQL (bug #607)\n\nAdminer 4.6.2 (released 2018-02-20):\nSemi-transparent border on table actions\nShorten JSON values in select (bug #594)\nSpeed up alter table form (regression from 4.4.0)\nStore current version without authentication and in Editor\nPostgreSQL: Fix exporting string default values\nPostgreSQL: Fix exporting sequences in PostgreSQL 10\nPostgreSQL: Add IF EXISTS to DROP SEQUENCE in export (bug #595)\nEditor: Fix displaying of true boolean values (regression from 4.5.0)\n\nAdminer 4.6.1 (released 2018-02-09):\nSticky position of table actions\nSpeed up rendering of long tables (regression from 4.4.0)\nDisplay notification about performing action after relogin\nAdd system tables help links\nMySQL: Support non-utf8 charset in search in column\nMySQL: Support geometry in MySQL 8 (bug #574)\nMariaDB: Links to documentation\nSQLite: Allow deleting PRIMARY KEY from tables with auto increment\nPostgreSQL: Support binary files in bytea fields\nPostgreSQL: Don't treat interval type as number (bug #474)\nPostgreSQL: Cast to string when searching using LIKE (bug #325)\nPostgreSQL: Fix condition for selecting no rows\nPostgreSQL: Support TRUNCATE+INSERT export\nCustomization: Support connecting to MySQL via SSL\nCustomization: Allow specifying server name displayed in breadcrumbs\n\nAdminer 4.6.0 (released 2018-02-05):\nFix counting selected rows after going back to select page\nPHP <5.3 compatibility even with Elasticsearch enabled\nFully support functions in default values\nStop redirecting links via adminer.org\nSupport X-Forwarded-Prefix\nDisplay options for timestamp columns when creating a new table\nDisable autocompleting password on create user page\nUse primary key to edit rows even if not selected\nMySQL, PostgreSQL: Display warnings\nMySQL: Add floor and ceil select functions\nMySQL: Add FIND_IN_SET search operator\nMariaDB: Support JSON since MariaDB 10.2\nSQLite, PostgreSQL: Limit rows in data manipulation without unique key\nPostgreSQL: Support routines\nPostgreSQL: Allow editing views with uppercase letters (bug #467)\nPostgreSQL: Allow now() as default value (bug #525)\nSimpleDB: Document that allow_url_fopen is required\nMalay translation\n\nAdminer 4.5.0 (released 2018-01-24):\nDisplay name of the object in confirmation when dropping it\nDisplay newlines in column comments (bug #573)\nSupport current_timestamp() as default of time fields (bug #572)\nHide window.opener from pages opened in a new window (bug #561)\nDisplay error when getting row to edit\nStore current Adminer version server-side to avoid excessive requests\nAdminer: Fix Search data in tables (regression from 4.4.0)\nCSP: Allow any styles, images, media and fonts, disallow base-uri\nMySQL: Support geometry in MySQL 8 (bug #574)\nMySQL: Support routines with comments in parameters (bug #460)\nMariaDB: Support fulltext and spatial indexes in InnoDB (bug #583)\nSQLite: Enable foreign key checks\nPostgreSQL: Respect NULL default value\nPostgreSQL: Display foreign tables (bug #576)\nPostgreSQL: Do not export triggers if not requested\nPostgreSQL: Export DROP SEQUENCE if dropping table\nPostgreSQL: Display boolean values as code (bug #562)\nMS SQL: Support freetds\nnon-MySQL: Avoid CONVERT() (bug #509)\nElasticsearch: Insert, update, delete\nMongoDB: Support mongodb PHP extension\nEditor: Fix displaying of false values in PostgreSQL (bug #568)\n\nAdminer 4.4.0 (released 2018-01-17):\nAdd Content Security Policy\nDisallow scripts without nonce\nRate limit password-less login attempts from the same IP address\nDisallow connecting to privileged ports\nAdd nosniff header\nPHP 7.1: Prevent warning when using empty limit\nPHP 7.2: Prevent warning when searching in select\nMySQL: Remove dedicated view for replication status (added in 4.3.0)\nPostgreSQL: Sort table names (regression from 4.3.1)\nEditor: Don't set time zone from PHP, fixes DST\nEditor: Display field comment's text inside [] only in edit form\nEditor: Fix doubleclick on database page\nEditor: Fix Search data in tables\nCustomization: Always send security headers\nHebrew translation\n\nAdminer 4.3.1 (released 2017-04-14):\nFix permanent login after logout (bug #539)\nFix SQL command autofocus (regression from 4.0.0)\nPostgreSQL: Support JSON and JSONB data types\nPostgreSQL: Fix index size computation in PostgreSQL < 9.0 (regression from 4.3.0)\nPostgreSQL: Fix nullable fields in export\n\nAdminer 4.3.0 (released 2017-03-15):\nMake maxlength in edit fields a soft limit\nAdd accessibility labels\nAdd Cache-Control: immutable to static files\nMySQL: Support MySQL 8\nMySQL: Support JSON data type\nMySQL: Add dedicated view for replication status\nMySQL: Support spatial indexes\nPostgreSQL: Export\nPostgreSQL: Don't treat partial indexes as unique\nMS SQL: Support pdo_dblib\nElasticsearch: Support HTTPS by inputting https://server\n\nAdminer 4.2.5 (released 2016-06-01):\nFix remote execution in SQLite query\nSQLite: Require credentials to use\nPostgreSQL: Support KILL\n\nAdminer 4.2.4 (released 2016-02-06):\nFix remote execution in SQLite query\nMySQL: Support PHP 7\nBosnian translation\nFinnish translation\n\nAdminer 4.2.3 (released 2015-11-15):\nFix XSS in indexes (non-MySQL only)\nSupport PHP 7\nGreek translation\nGalician translation\nBulgarian translation\n\nAdminer 4.2.2 (released 2015-08-05):\nFix XSS in alter table (found by HP Fortify)\n\nAdminer 4.2.1 (released 2015-03-10):\nSend referrer header to the same domain\nMySQL: Fix usage of utf8mb4 if the client library doesn't support it\nMySQL: Use utf8mb4 in export only if required\nSQLite: Use EXPLAIN QUERY PLAN in SQL query\n\nAdminer 4.2.0 (released 2015-02-07):\nFix XSS in login form (bug #436)\nAllow limiting number of displayed rows in SQL command\nFix reading routine column collations\nUnlock session in alter database\nMake master key unreadable to others (bug #410)\nFix edit by long non-utf8 string\nSpecify encoding for PHP 5.6 with invalid default_charset\nFix saving NULL value, bug since Adminer 4.0.3\nSend 403 for auth error\nReport offline and other AJAX errors (bug #419)\nDon't alter table comment if not changed\nAdd links to documentation on table status page\nFix handling of 64 bit numbers in auto_increment\nAdd referrer: never meta tag\nMySQL: Use utf8mb4 if available\nMySQL: Support foreign keys in NDB storage\nPostgreSQL: Materialized views\nSQLite: Support CURRENT_* default values (bug #417)\nElasticsearch: Use where in select\nFirebird: Alpha version\nDanish translation\n\nAdminer 4.1.0 (released 2014-04-18):\nProvide size of all databases in the overview\nPrevent against brute force login attempts from the same IP address\nCompute number of tables in the overview explicitly\nDisplay edit form after error in clone or multi-edit\nTrim trailing non-breaking spaces in SQL textarea\nDisplay time of the select command\nPrint elapsed time in HTML instead of SQL command comment\nImprove gzip export ratio (bug #387)\nUse rel=\"noreferrer\" for external links, skip adminer.org redirect in WebKit\nMySQL: Fix enum types in routines (bug #391)\nMySQL: Fix editing rows by binary values, bug since Adminer 3.7.1\nMySQL: Respect daylight saving time in dump, bug since Adminer 3.6.4\nMySQL 5.6.5+: Support ON UPDATE on datatime column\nSQLite: Support UPDATE OF triggers\nSQLite: Display auto-created unique indexes, bug since Adminer 3.5.0\nEditor: Fix login() method, bug since Adminer 4.0.0\nTranslate numbers in ar, bn, fa\nVietnamese translation\n\nAdminer 4.0.3 (released 2014-02-01)\nMongoDB: insert, truncate, indexes\nSimpleDB, MongoDB: insert more fields at once\nSQLite: Fix creating table and altering primary key, bug since Adminer 4.0.0\nDon't store invalid credentials to session, bug since Adminer 4.0.0\nNorweigan translation\n\nAdminer 4.0.2 (released 2014-01-11):\nFix handling of long text in SQL textarea\nSupport paste to SQL textarea in Opera\n\nAdminer 4.0.1 (released 2014-01-11):\nDon't use type=number if a SQL function is used\nDisable highlighting in textareas with long texts\nDon't autofocus SQL textarea in Firefox\nDon't link NULL foreign key values\nFix displaying images in Editor, bug since Adminer 3.6.0\nFix uploading files, bug since Adminer 4.0.0\nMongoDB: Count tables, display ObjectIds, sort, limit, offset, count rows\nElasticsearch: Fix compiled version, create and drop DB, drop table\n\nAdminer 4.0.0 (released 2014-01-08):\nDriver for SimpleDB, MongoDB and Elasticsearch\nHighlight SQL in textareas\nSave and continue edit by AJAX\nSplit SQL command and import\nAdd a new column in alter table on key press\nMark length as required for strings\nAdd label to database selection, move logout button\nAdd button for dropping an index\nDisplay number of selected rows\nAdd links to documentation\nDisable underlining links\nDifferentiate views in navigation\nImprove speed of CSV import\nKeep form values after refresh in Firefox\nMark auto_increment fields in edit\nDon't append newlines to uploaded files, bug since Adminer 3.7.0\nDon't display SQL edit form on Ctrl+click on the select query, introduced in Adminer 3.6.4\nUse MD5 for editing long keys only in supported drivers, bug since Adminer 3.6.4\nDon't reset column when searching for an empty value with Enter, bug since Adminer 3.6.4\nEncrypt passwords stored in session by a key stored in cookie\nDon't execute external JavaScript when verifying version\nInclude JUSH in the compiled version\nProtect CSRF token against BREACH\nNon-MySQL: View triggers\nSQLite: Allow editing primary key\nSQLite: Allow editing foreign keys\nPostgreSQL: Fix handling of nextval() default values\nPostgreSQL: Support creating array columns\nCustomization: Provide schemas()\nPortugal Portuguese translation\nThai translation\n\nAdminer 3.7.1 (released 2013-06-29):\nIncrease click target for checkboxes\nUse shadow for highlighting default button\nDon't use LIMIT 1 if inline updating unique row\nDon't check previous checkbox on added column in create table (bug #3614245)\nOrder table list by name\nVerify UTF-8 encoding of CSV import\nNotify user about expired master password for permanent login\nHighlight table being altered in navigation\nSend 404 for invalid database and schema\nFix title and links on invalid table pages\nDisplay error on invalid alter table and view pages\nMySQL: Speed up updating rows without numeric or UTF-8 primary key\nNon-MySQL: Descending indexes\nPostgreSQL: Fix detecting oid column in PDO\nPostgreSQL: Handle timestamp types (bug #3614086)\nAdd Korean translation\n\nAdminer 3.7.0 (released 2013-05-19):\nAllow more SQL files to be uploaded at the same time\nPrint run time next to executed queries\nDon't drop original view and routine before creating the new one\nHighlight default submit button\nAdd server placeholder to login form\nDisable SQL export when applying functions in select\nAllow using lang() in plugins (customization)\nRemove bzip2 compression support\nConstraint memory used in TAR export\nAllow exporting views dependent on each other (bug #3459151)\nFix resetting search (bug #3612507)\nDon't use LIMIT 1 if updating unique row (bug #3613109)\nRestrict editing rows without unique identifier to search results\nDisplay navigation bellow main content on mobile browsers\nGet number of rows on export page asynchronously\nRespect 'whole result' even if some rows are checked (bug #339 since Adminer 3.7.0)\nMySQL: Optimize create table page and Editor navigation\nMySQL: Display bit type as binary number\nMySQL: Improve export of binary data types\nMySQL: Fix handling of POINT data type (bug #3582578)\nMySQL: Don't export binary and geometry columns twice in select\nMySQL: Fix EXPLAIN in MySQL < 5.1, bug since Adminer 3.6.4\nSQLite: Export views\nPostgreSQL: Fix swapped NULL and NOT NULL columns in PDO\n\nAdminer 3.6.4 (released 2013-04-26):\nDisplay pagination on a fixed position\nIncrease default select limit to 50\nDisplay SQL edit form on Ctrl+click on the select query\nDisplay SQL history from newest\nRecover original view, trigger, routine if creating fails\nDo not store plain text password to history in creating user\nSelectable ON UPDATE CURRENT_TIMESTAMP field in create table\nOpen database to a new window after selecting it with Ctrl\nClear column name after resetting search (bug #3601200)\nExplain partitions in SQL query (bug #3600150)\nAllow loading more data with inline edit (bug #3605531)\nStay on the same page after deleting rows (bug #3605845)\nRespect checked tables in export filename (bug #3245464)\nRespect PHP configuration max_input_vars\nFix unsetting permanent login after logout\nDisable autocapitalize in identifiers on mobile browsers\nMySQL: Compatibility with MySQL 5.6\nMySQL: Move ALTER export to plugin\nMySQL: Use numeric time zone in export\nMySQL: Link processlist documentation\nSQLite: Export indexes\n\nAdminer 3.6.3 (released 2013-01-23):\nDisplay error code in SQL query\nAllow specifying external links\nTreat Meta key same as Ctrl\nFix XSS in displaying non-UTF-8 strings\nDon't use type=\"number\" for decimal numbers\n\nAdminer 3.6.2 (released 2012-12-21):\nEdit values by Ctrl+click instead of double click\nDon't select row on double click\nSupport NULL in routine calls\nShorten printed values in varchar fields\nDisplay table default values on wide screens\nDisplay date in SQL history\nHTML5 input fields\nDisplay warning for missing UPDATE privilege\nFix switching language on first load\nSupport enabled mbstring.func_overload\nMySQL: Prolong comment length since MySQL 5.5\nPostgreSQL: Fix process list in version 9.2\nMS SQL: Support databases starting with number\n\nAdminer 3.6.1 (released 2012-09-17):\nFix compiled version on PHP with multibyte support\n\nAdminer 3.6.0 (released 2012-09-16):\nLoad more data in select\nEdit strings with \\n in textarea\nTime out long running database list and select count\nUse VALUES() in INSERT+UPDATE export\nStyle logout button as link\nStore selected database to permanent login\nCtrl+click and Shift+click on button opens form to a blank window\nSwitch language by POST\nCompress translations\nMySQL: Support geometry data types\nselectQueryBuild() method (customization)\nSerbian translation\n\nAdminer 3.5.1 (released 2012-08-10):\nSupport same name fields in CSV export\nSupport Shift+click in export\n\nAdminer 3.5.0 (released 2012-08-05):\nLinks for column search in select\nAutohide column context menu in select\nAutodisplay long table names in tables list\nDisplay assigned auto_increment after clone\nSQLite: Full alter table\nSQLite: Better editing in tables without primary key\nSQLite: Display number of rows in database overview\n\nAdminer 3.4.0 (released 2012-06-30):\nLink to descending order\nShift+click on checkbox to select consecutive rows\nPrint current time next to executed SQL queries\nWarn about selecting data without index\nAllow specifying database in login form\nLink to original table in EXPLAIN of SELECT * FROM table t\nFormat numbers in translations\nMySQL: inform about disabled event_scheduler\nSQLite: support binary data\nPostgreSQL: approximate row count in table overview\nPostgreSQL: improve PDO support in SQL command\nOracle: schema, processlist, table overview numbers\nSimplify work with NULL values (customization)\nUse namespace in login form (customization)\nCustomizable export filename (customization)\nReplace JSMin by better JavaScript minifier\nDon't use AJAX links and forms\nIndonesian translation\nUkrainian translation\nBengali translation\n\nAdminer 3.3.4 (released 2012-03-07):\nForeign keys default actions (bug #3397606)\nSET DEFAULT foreign key action\nFix minor parser bug in SQL command with webserver file\nCtrl+click on button opens form to a blank window\nTrim table and column names (bug #3405309)\nError message with no response from server in AJAX\nEsc to cancel AJAX request\nMove AJAX loading indicator to the right\nDon't quote bit type in export\nDon't check row while selecting text\nFix invalid references line position on Database schema\nDisable selecting text on Database schema\nAbility to disable export (customization)\nExtensible list of databases (customization)\nMySQL: set autocommit after connect\nSQLite, PostgreSQL: vacuum\nSQLite, PostgreSQL: don't use LIKE for numbers (bug #3420408)\nPostgreSQL: fix alter foreign key\nPostgreSQL over PDO: connect if the eponymous database does not exist (bug #3391619)\nBoolean search (Editor)\nPersian translation\n\nAdminer 3.3.3 (released 2011-08-12):\nHighlight checked rows\nTitles of links in database overview and navigation\nFix trigger export (SQLite)\nDefault trigger statement (SQLite, PostgreSQL)\nRemove search by expression (PostgreSQL, MS SQL)\n\nAdminer 3.3.2 (released 2011-08-08):\nDisplay error with non-existent row in edit\nFix minor parser bug in SQL command with webserver file\nFix SQL command Stop on error\nDon't scroll with AJAX select order and alter move column\nFast number of rows with big tables (PostgreSQL)\nSort databases and schemas (PostgreSQL)\n\nAdminer 3.3.1 (released 2011-07-27):\nFix XSS introduced in Adminer 3.2.0\nFix altering default values (PostgreSQL)\nProcess list (PostgreSQL)\n\nAdminer 3.3.0 (released 2011-07-19):\nUse Esc to disable in-place edit\nShortcut for database privileges\nEditable index names\nAppend new index with auto index selection (bug #3282127)\nPreserve original timestamp value in multiple update (bug #3312614)\nBit type default value\nDisplay foreign key name in tooltip\nDisplay default column value in table overview\nDisplay column collation in tooltip\nKeyboard shortcuts: Alt+Shift+1 for homepage, Ctrl+Shift+Enter for Save and continue edit\nShow only errors with Webserver file SQL command\nRemember select export and import options\nLink tables and indexes from SQL command EXPLAIN (MySQL)\nDisplay error with all wrong SQL commands (MySQL)\nDisplay foreign keys from other schemas (PostgreSQL)\nPagination support (Oracle)\nAutocomplete for big foreign keys (Editor)\nDisplay name of the referenced record in PostgreSQL (Editor)\nPrefer NULL to empty string (Editor, bug #3323800)\nDisplay searched columns (Editor)\nCustomizable favicon (customization)\nMethod name can return a link (customization)\nEasier sending of default headers (customization)\nLithuanian and Romanian translation\n\nAdminer 3.2.2 (released 2011-03-28):\nFix AJAX history after reload\n\nAdminer 3.2.1 (released 2011-03-23):\nAbility to save expression in edit\nRespect default database collation (bug #3191489)\nDon't export triggers without table (bug #3193489)\nEsc to focus next field in Tab textarea\nSend forms by Ctrl+Enter on <select>\nEnum editor and textarea Ctrl+Enter working in IE\nAJAX forms in Google Chrome\nParse UTF-16 and UTF-8 BOM in all text uploads\nDisplay ; in history\nUse DELIMITER in history\nShow databases even with skip_show_database in MySQL 5\nDisable maxlength with functions in edit\nBetter placement of AJAX icon\nTable header in CSV export (Editor)\nTime format hint (Editor)\nRespect order after search (Editor)\nSet MySQL time zone by PHP setting (Editor)\nAllow own code in <head> (customization)\nPolish translation\n\nAdminer 3.2.0 (released 2011-02-24):\nGet long texts and slow information by AJAX\nMost links and forms by AJAX in browsers with support for history.pushState\nCopy tables\nAbility to search by expression in select\nExport SQL command result (bug #3116854)\nFocus first field with insert (bug #3126501)\nPermanent link in schema\nDisplay total time in show only errors mode in SQL command\nHistory: edit all\nMS SQL: auto primary and foreign key\nSQLite: display 0\nCreate table default data type: int\nFocus upper/lower fields by Ctrl+Up/Ctrl+Down\nHide credentials for SQLite\nUtilize oids in PostgreSQL\nHomepage customization\nUse IN for search in numeric fields (Editor)\nUse password input for _md5 and _sha1 fields (Editor)\nWork without session.use_cookies (bug #3138640)\nFix saving schema to cookie in Opera\nPortuguese, Slovenian and Turkish translation\n\nAdminer 3.1.0 (released 2010-11-16):\nTSV export and import\nCustomizable export\nOption to show only errors in SQL command\nLink to bookmark SQL command\nRecognize $$ strings in SQL command (PostgreSQL)\nHighlight and edit SQL command in processlist\nAlways display all drivers\nTimestamp at the end of export\nLink to refresh database cache (bug #3102451)\nSupport for virtual foreign keys\nDisable XSS \"protection\" of IE8\nImmunity against zend.ze1_compatibility_mode (bug #3089645)\nFix last page with empty result set\nArabic translation and RTL support\nDual licensing: Apache or GPL\n\nAdminer 3.0.1 (released 2010-10-18):\nSend the form by Ctrl+Enter in all textareas\nDisable creating SQLite databases with extension other than db, sdb, sqlite\nAbility to use Adminer in a frame through customization\nCatalan translation\nMS SQL 2005 compatibility\nPostgreSQL: connect if the eponymous database does not exist\n\nAdminer 3.0.0 (released 2010-10-15):\nDrivers for MS SQL, SQLite, PostgreSQL, Oracle\nAllow concurrent logins on the same server\nAllow permanent login without customization\nIn-place editation in select\nForeign key options in Table creation\nTreat binary type as hex\nShow number of tables in server overview\nOperator LIKE %%\nRemember export parameters in cookie\nAllow semicolon as CSV separator\nSchemas, sequences and types support (PostgreSQL)\nAutofocus username in login form\nAllow to insert Tab in SQL textareas and send the form by Ctrl+Enter\nDisable spellchecking in SQL textareas\nDisplay auto_increment value of inserted item\nAllow disabling auto_increment value export\nPrefill auto_increment column name\nAbility to jump to any page in select by JavaScript\nDisplay comment in table overview\nLink last page above data in select\nLink table names in SQL queries\nHungarian, Japanese and Tamil translation\nDefer table information in database overview to JavaScript (performance)\nBig tables optimizations (performance)\n\nAdminer 2.3.2 (released 2010-04-21):\nFix COUNT(*) link\nFix Save and continue edit\n\nAdminer 2.3.1 (released 2010-04-06):\nAdd Drop button to Alter pages (regression from 2.0.0)\nLink COUNT(*) result to listing\nNewlines in select query edit\nReturn to referrer after edit\nRespect session.auto_start (bug #2967284)\n\nAdminer 2.3.0 (released 2010-02-26):\nSupport for permanent login (customization required)\nSearch in all tables\nShow status variables\nPrint sums in tables overview\nAdd Delete button to Edit page (regression from 2.0.0)\nPrint error summary in SQL command\nSimplify SQL syntax error message\nShow SQL query info if available\nDelete length when changing type in alter table\nAbility to check table prefix in export\n\nAdminer 2.2.1 (released 2009-11-26):\nHighlight current links\nImprove concurrency\nMove number of tables to DB info (performance)\nSearch by foreign keys (Editor)\nLink new item in backward keys (Editor)\n\nAdminer 2.2.0 (released 2009-10-20):\nDatabase list - bulk drop, number of tables\nEnlarge field for enum and set definition\nDisplay table links above table structure\nLink URLs in select\nDisplay number of manipulated rows in JS confirm\nSet required memory in SQL command\nFix removed default in ALTER\nDisplay whitespace in texts (bug #2858042)\nClickJacking protection in modern browsers\nE-mail attachments (Editor)\nOptional year in date (Editor)\nSearch operators (Editor)\nAlign numbers to right in select (Editor)\nMove <h1> to $adminer->navigation (customization)\nRename get_dbh to connection (customization)\n\nAdminer 2.1.0 (released 2009-09-12):\nEdit default values directly in table creation\nExecute SQL file stored on server disk\nDisplay EXPLAIN in SQL query\nCompress export and import\nDisplay column comments in table overview\nUse ON DUPLICATE KEY UPDATE for CSV import\nPrint ALTER export instead of executing it\nClick on row selects it\nFix Editor date format\nFix long SQL query crash (bug #2839231)\nSpeed up simple alter table\nTraditional Chinese translation\n\nAdminer 2.0.0 (released 2009-08-06):\nEditor: User friendly data editor\nCustomization: Adminer class\nCreate single column foreign key in table structure\nTable relations (Editor)\nSend e-mails (Editor)\nDisplay images in blob (Editor)\nLocalize date (Editor)\nTreat tinyint(1) as bool (Editor)\nDivide types to groups in table creation\nLink e-mails in select\nShow type in field name title\nPreselect now() for timestamp columns\nClear history\nPrefill insert by foreign key searches\nPrint number of rows in SQL command\nRemove Delete button from Edit page - use mass operation for it\nFaster multiple update, clone and delete\nFaster table list in navigation\nDownload version checker and syntax highlighting from HTTPS\nUse HTML Strict instead of XHTML\nRemove function minification in favor of performance and customization\nFix grant ALL PRIVILEGES with GRANT OPTION\nFix CSV import\nFix work with default values\n\nAdminer 1.11.1 (released 2009-07-03):\nFix problem with enabled Filter extension\n\nAdminer 1.11.0 (released 2009-07-02):\nConnection through socket by server :/path/to/socket\nSimplify export\nDisplay execution time in SQL query\nRelative date and time functions\nVersion checker\nSave queries to history and display it on SQL page\nDisplay MySQL variables\nAbility to select all rows on current page of select\nSeparate JavaScript functions\nAlways use the default style before the external one\nAlways try to use the syntax highlighter\nAll privileges in user rights\nFix FOUND_ROWS() in SQL command\nExport only selected columns in select\nBulk database creation\nInclude views in drop and move on database overview\nHide fieldsets in select\nAutomatically add new fields in table creation\nUse \\n in SQL commands\n\nphpMinAdmin 1.10.1 (released 2009-05-07):\nHighlight odd and hover rows\nPartition editing comfort (bug #2783446)\nAllow full length in limited int\n\nphpMinAdmin 1.10.0 (released 2009-04-28):\nPartitioning (MySQL 5.1)\nCSV import\nPlus and minus functions\nOption to stop on error in SQL command\nCross links to select and table (bug #2236232), link new item\nSuhosin compatibility\nRemove max_allowed_packet from export\nRead style from phpMinAdmin.css if exists\nSize reduction by minification of variables and functions\nRussian translation\n\nphpMinAdmin 1.9.1 (released 2008-10-27):\nUpdate translations\n\nphpMinAdmin 1.9.0 (released 2008-10-16):\nList of tables and views with maintenance commands\nClone rows\nBulk edit and clone\nFunction results in edit\nNOT operators in select\nSearch without column restriction\nUse type=password for unhashed password\nOnly one button for each action in select\nChoose language through option-list\nXHTML syntax errors\nDon't set global variable in export\nSHOW DATABASES can be revoked\nOrder by function result working also in older MySQL versions\nTested on IIS\n\nphpMinAdmin 1.8.0 (released 2008-09-12):\nEvents (MySQL 5.1)\nAccess without login - accept ?username=\nPrint SQL query in select, messages and warnings\nDisplay number of found rows\nDon't wrap lines in select table\nItalian and Estonian translation\nOrder by COUNT(*)\n\nphpMinAdmin 1.7.0 (released 2008-08-26):\nCustomizable export (select objects to export, SQL or CSV)\nAbility to alter existing tables and drop old tables in export\nChoose columns in select, aggregation\nOrder rows by clicking on table heading\nTruncate only search results\nAutomatically select name for trigger\nChinese and French translation\nPreserve default values when altering table\nMaintain auto_increment when moving columns\nSmaller multilingual file\nCache static files\nFaster checking of number of results\n\nphpMinAdmin 1.6.1 (released 2008-05-22):\nSet session parameters only if not session.auto_start\n\nphpMinAdmin 1.6.0 (released 2008-05-16):\nOrder of columns in table\nSet max_allowed_packet in dump and use extended insert\nSpanish and German translations\nUse images for editing buttons\nProtection against big POST data\nLogout by POST\nInformation about logged user\nSeparate stylesheet\nLast-Modified header for files\nSeveral bug fixes\n\nphpMinAdmin 1.5.0 (released 2008-01-09):\nMass delete\nVertical privileges\nSpecify connection port by colon in server\nIgnore length in date and time types\nBoolean fulltext search for all columns in MyISAM\nShrink compiled output\nRemove maxlength from server and username\nUncheck NULL by change\nMark shortened fields in select\n\nphpMinAdmin 1.4.0 (released 2007-08-15):\nPrivileges\nNew design\nDutch translation\nUse NULL for auto_increment (bug #1768966)\nFix dropping procedure parameters\n\nphpMinAdmin 1.3.2 (released 2007-08-06):\nNext field by JavaScript in foreign keys\nSet time zone in dump\nRefresh lang cookie\nRemember drop result in case of faulty create\nMove vertical lines in schema properly\nFix maximum page in select\n\nphpMinAdmin 1.3.1 (released 2007-07-31):\nMove references lines in schema\nFix dump\nFix update links\n\nphpMinAdmin 1.3.0 (released 2007-07-27):\nBreadcrumb navigation\nOperator IN\nTimestamp default values\nDraggable tables in schema\nNumber of rows in navigation\nDisplay MySQL version and used PHP extension\nMore friendly user interface\nSlovak translation\n\nphpMinAdmin 1.2.0 (released 2007-07-25):\nManipulate triggers\nPDO Abstraction\nAuto_increment value\nJavaScript for adding rows\n\nphpMinAdmin 1.1.0 (released 2007-07-19):\nRoutines manipulation\nViews manipulation\nForeign keys manipulation\nDatabase schema with references\nProcesslist\nIndex length\nDump individual tables\nJavaScript for next rows in table edit\nCache databases list\n\nphpMinAdmin 1.0.0 (released 2007-07-11):\nFirst official release\n"], "filenames": ["adminer/drivers/clickhouse.inc.php", "adminer/drivers/elastic.inc.php", "changes.txt"], "buggy_code_start_loc": [25, 31, 1], "buggy_code_end_loc": [26, 32, 1], "fixing_code_start_loc": [25, 31, 2], "fixing_code_end_loc": [26, 32, 3], "type": "CWE-918", "message": "Adminer is an open-source database management in a single PHP file. In adminer from version 4.0.0 and before 4.7.9 there is a server-side request forgery vulnerability. Users of Adminer versions bundling all drivers (e.g. `adminer.php`) are affected. This is fixed in version 4.7.9.", "other": {"cve": {"id": "CVE-2021-21311", "sourceIdentifier": "security-advisories@github.com", "published": "2021-02-11T21:15:13.820", "lastModified": "2021-06-24T12:50:46.897", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Adminer is an open-source database management in a single PHP file. In adminer from version 4.0.0 and before 4.7.9 there is a server-side request forgery vulnerability. Users of Adminer versions bundling all drivers (e.g. `adminer.php`) are affected. This is fixed in version 4.7.9."}, {"lang": "es", "value": "Adminer es una administraci\u00f3n de base de datos de c\u00f3digo abierto en un solo archivo PHP.&#xa0;En el administrador de la versi\u00f3n 4.0.0 y antes de la 4.7.9, se presenta una vulnerabilidad de tipo server-side request forgery.&#xa0;Los usuarios de las versiones Adminer que incluyen todos los controladores (por ejemplo, \"adminer.php\") est\u00e1n afectados.&#xa0;Esto es corregido en la versi\u00f3n 4.7.9"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 6.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-918"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:adminer:adminer:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.7.9", "matchCriteriaId": "F5E19DCC-D7A6-4325-8E91-E601C9967B8F"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}]}]}], "references": [{"url": "https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/vrana/adminer/security/advisories/GHSA-x5r2-hj5c-8jx6", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2021/03/msg00002.html", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://packagist.org/packages/vrana/adminer", "source": "security-advisories@github.com", "tags": ["Product", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351"}}