{"buggy_code": ["<?php\n/**\n * @var League\\Plates\\Template\\Template $this\n * @var App\\Auth $auth\n * @var App\\Acl $acl\n * @var App\\Http\\Router $router\n * @var App\\Session\\Flash $flash\n * @var App\\Customization $customization\n * @var App\\Version $version\n * @var App\\Http\\ServerRequest $request\n * @var App\\Environment $environment\n * @var App\\Entity\\User $user\n * @var App\\View\\GlobalSections $sections\n */\n\n$manual ??= false;\n$title ??= null;\n$header ??= null;\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $customization->getLocale()->getHtmlLang() ?>\" data-theme=\"<?= $customization->getTheme()->value ?>\">\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    <title><?= $customization->getPageTitle($title) ?></title>\n\n    <?= $this->fetch('partials/head') ?>\n\n    <script src=\"<?= $this->assetUrl('dist/lib/sweetalert2/sweetalert2.min.js') ?>\" defer></script>\n\n    <?= $sections->get('head') ?>\n\n    <style>\n        <?=$customization->getCustomInternalCss() ?>\n    </style>\n</head>\n<body class=\"page-full <?= $page_class ?? '' ?> <?php\nif ($sections->has('sidebar')): ?>has-sidebar<?php\nendif; ?>\">\n\n<?= $this->fetch('partials/bodyjs') ?>\n\n<script>\n    <?php\n    $csrfJson = 'null';\n    $csrf = $request->getAttribute(App\\Http\\ServerRequest::ATTR_SESSION_CSRF);\n    if ($csrf instanceof App\\Session\\Csrf) {\n        $csrfToken = $csrf->generate(App\\Middleware\\Auth\\ApiAuth::API_CSRF_NAMESPACE);\n        $csrfJson = json_encode($csrfToken, JSON_THROW_ON_ERROR);\n    }\n    ?>\n\n    App.api_csrf = <?=$csrfJson ?>;\n</script>\n\n<?= $sections->get('bodyjs') ?>\n\n<a class=\"sr-only sr-only-focusable\" href=\"#content\"><?= __('Skip to main content') ?></a>\n\n<header class=\"navbar bg-primary-dark shadow-sm fixed-top\">\n    <?php\n    if ($sections->has('sidebar')): ?>\n        <button aria-controls=\"sidebar\" aria-expanded=\"false\" aria-label=\"<?= __(\n            'Toggle Sidebar'\n        ) ?>\" class=\"navbar-toggler d-inline-flex d-lg-none mr-3\" data-breakpoint=\"lg\" data-target=\"#sidebar\"\n                data-toggle=\"navdrawer\" data-type=\"permanent\">\n            <span class=\"navbar-toggler-icon\"></span>\n        </button>\n    <?php\n    endif; ?>\n\n    <a class=\"navbar-brand ml-0 mr-auto\" href=\"<?= $router->named('dashboard') ?>\">\n        azura<strong>cast</strong> <?php\n        if (!empty($customization->getInstanceName())): ?>\n            <small><?= $this->e($customization->getInstanceName()) ?></small><?php\n        endif; ?>\n    </a>\n\n    <div id=\"radio-player-controls\"></div>\n\n    <div class=\"dropdown ml-3 d-inline-flex align-items-center\">\n        <div class=\"mr-2\">\n            <?= $user->getDisplayName() ?>\n        </div>\n\n        <button aria-expanded=\"false\" aria-haspopup=\"true\" class=\"navbar-toggler\" aria-label=\"<?= __(\n            'Toggle Menu'\n        ) ?>\" data-toggle=\"dropdown\" type=\"button\">\n            <i class=\"material-icons\" aria-hidden=\"true\">menu_open</i>\n        </button>\n        <ul class=\"dropdown-menu dropdown-menu-right\">\n            <li>\n                <a class=\"dropdown-item\" href=\"<?= $router->named('dashboard') ?>\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">home</i>\n                    <?= __('Dashboard') ?>\n                </a>\n            </li>\n            <li class=\"dropdown-divider\">&nbsp;</li>\n            <?php\n            if ($acl->isAllowed(App\\Enums\\GlobalPermissions::View)): ?>\n                <li>\n                    <a class=\"dropdown-item\" href=\"<?= $router->named('admin:index:index') ?>\">\n                        <i class=\"material-icons\" aria-hidden=\"true\">settings</i>\n                        <?= __('System Administration') ?>\n                    </a>\n                </li>\n            <?php\n            endif; ?>\n            <li>\n                <a class=\"dropdown-item\" href=\"<?= $router->named('profile:index') ?>\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">account_circle</i>\n                    <?= __('My Account') ?>\n                </a>\n            </li>\n            <li>\n                <a class=\"dropdown-item\" href=\"<?= $router->named('profile:theme') ?>\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">invert_colors</i>\n                    <?= __('Switch Theme') ?>\n                </a>\n            </li>\n            <li>\n                <a class=\"dropdown-item\" href=\"https://docs.azuracast.com/en/user-guide/troubleshooting\"\n                   target=\"_blank\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">help</i>\n                    <?= __('Help') ?>\n                </a>\n            </li>\n            <li class=\"dropdown-divider\">&nbsp;</li>\n            <?php\n            if ($auth->isMasqueraded()): ?>\n                <li>\n                    <a class=\"dropdown-item\" href=\"<?= $router->named('account:endmasquerade') ?>\">\n                        <i class=\"material-icons\" aria-hidden=\"true\">exit_to_app</i>\n                        <?= __('End Session') ?>\n                    </a>\n                </li>\n            <?php\n            else: ?>\n                <li>\n                    <a class=\"dropdown-item\" href=\"<?= $router->named('account:logout') ?>\">\n                        <i class=\"material-icons\" aria-hidden=\"true\">exit_to_app</i>\n                        <?= __('Sign Out') ?></a></li>\n            <?php\n            endif; ?>\n        </ul>\n    </div>\n</header>\n\n<?php\nif ($sections->has('sidebar')): ?>\n    <div class=\"navdrawer navdrawer-permanent-lg navdrawer-permanent-clipped\" id=\"sidebar\" tabindex=\"-1\">\n        <nav class=\"navdrawer-content\" aria-label=\"<?= __('Sidebar') ?>\">\n            <?= $sections->get('sidebar') ?>\n        </nav>\n    </div>\n<?php\nendif; ?>\n\n<section id=\"main\">\n    <main id=\"content\" <?php\n    if (!$sections->has('sidebar')): ?>class=\"content-alt\"<?php\n    endif; ?>>\n        <div class=\"container\">\n            <?php\n            if ($manual): ?>\n                <?= $this->section('content') ?>\n            <?php\n            else: ?>\n                <?php\n                if ($header): ?>\n                    <div class=\"block-header\">\n                        <h2><?= $header ?></h2>\n                    </div>\n                <?php\n                endif; ?>\n                <div class=\"card mb-3\" role=\"region\">\n                    <div class=\"card-header bg-primary-dark\">\n                        <h3 class=\"card-title\"><?=$title?></h3>\n                    </div>\n                    <div class=\"card-body\">\n                        <?=$this->section('content')?>\n                    </div>\n                </div>\n            <?php\n            endif; ?>\n        </div>\n    </main>\n</section>\n\n<footer id=\"footer\" <?php\nif (!$sections->has('sidebar')): ?>class=\"footer-alt\"<?php\nendif; ?> role=\"contentinfo\" aria-label=\"<?= __('Footer') ?>\">\n    <?= sprintf(\n        __('Powered by %s'),\n        '<a href=\"https://www.azuracast.com/\" target=\"_blank\">' . $environment->getAppName(\n        ) . '</a> &bull; ' . $version->getVersionText() . ' &bull; ' . ($environment->isDocker(\n        ) ? 'Docker' : 'Ansible') . ' &bull; PHP ' . \\PHP_MAJOR_VERSION . '.' . \\PHP_MINOR_VERSION\n    ) ?>\n    <br>\n    <?= __('Like our software?') ?> <a href=\"https://docs.azuracast.com/en/contribute/donate\"><?= __(\n            'Donate to support AzuraCast!'\n        ) ?></a>\n</footer>\n\n<div id=\"radio-player\"></div>\n</body>\n</html>\n"], "fixing_code": ["<?php\n/**\n * @var League\\Plates\\Template\\Template $this\n * @var App\\Auth $auth\n * @var App\\Acl $acl\n * @var App\\Http\\Router $router\n * @var App\\Session\\Flash $flash\n * @var App\\Customization $customization\n * @var App\\Version $version\n * @var App\\Http\\ServerRequest $request\n * @var App\\Environment $environment\n * @var App\\Entity\\User $user\n * @var App\\View\\GlobalSections $sections\n */\n\n$manual ??= false;\n$title ??= null;\n$header ??= null;\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $customization->getLocale()->getHtmlLang() ?>\" data-theme=\"<?= $customization->getTheme()->value ?>\">\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    <title><?= $customization->getPageTitle($title) ?></title>\n\n    <?= $this->fetch('partials/head') ?>\n\n    <script src=\"<?= $this->assetUrl('dist/lib/sweetalert2/sweetalert2.min.js') ?>\" defer></script>\n\n    <?= $sections->get('head') ?>\n\n    <style>\n        <?=$customization->getCustomInternalCss() ?>\n    </style>\n</head>\n<body class=\"page-full <?= $page_class ?? '' ?> <?php\nif ($sections->has('sidebar')): ?>has-sidebar<?php\nendif; ?>\">\n\n<?= $this->fetch('partials/bodyjs') ?>\n\n<script>\n    <?php\n    $csrfJson = 'null';\n    $csrf = $request->getAttribute(App\\Http\\ServerRequest::ATTR_SESSION_CSRF);\n    if ($csrf instanceof App\\Session\\Csrf) {\n        $csrfToken = $csrf->generate(App\\Middleware\\Auth\\ApiAuth::API_CSRF_NAMESPACE);\n        $csrfJson = json_encode($csrfToken, JSON_THROW_ON_ERROR);\n    }\n    ?>\n\n    App.api_csrf = <?=$csrfJson ?>;\n</script>\n\n<?= $sections->get('bodyjs') ?>\n\n<a class=\"sr-only sr-only-focusable\" href=\"#content\"><?= __('Skip to main content') ?></a>\n\n<header class=\"navbar bg-primary-dark shadow-sm fixed-top\">\n    <?php\n    if ($sections->has('sidebar')): ?>\n        <button aria-controls=\"sidebar\" aria-expanded=\"false\" aria-label=\"<?= __(\n            'Toggle Sidebar'\n        ) ?>\" class=\"navbar-toggler d-inline-flex d-lg-none mr-3\" data-breakpoint=\"lg\" data-target=\"#sidebar\"\n                data-toggle=\"navdrawer\" data-type=\"permanent\">\n            <span class=\"navbar-toggler-icon\"></span>\n        </button>\n    <?php\n    endif; ?>\n\n    <a class=\"navbar-brand ml-0 mr-auto\" href=\"<?= $router->named('dashboard') ?>\">\n        azura<strong>cast</strong> <?php\n        if (!empty($customization->getInstanceName())): ?>\n            <small><?= $this->e($customization->getInstanceName()) ?></small><?php\n        endif; ?>\n    </a>\n\n    <div id=\"radio-player-controls\"></div>\n\n    <div class=\"dropdown ml-3 d-inline-flex align-items-center\">\n        <div class=\"mr-2\">\n            <?= $this->e($user->getDisplayName()) ?>\n        </div>\n\n        <button aria-expanded=\"false\" aria-haspopup=\"true\" class=\"navbar-toggler\" aria-label=\"<?= __(\n            'Toggle Menu'\n        ) ?>\" data-toggle=\"dropdown\" type=\"button\">\n            <i class=\"material-icons\" aria-hidden=\"true\">menu_open</i>\n        </button>\n        <ul class=\"dropdown-menu dropdown-menu-right\">\n            <li>\n                <a class=\"dropdown-item\" href=\"<?= $router->named('dashboard') ?>\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">home</i>\n                    <?= __('Dashboard') ?>\n                </a>\n            </li>\n            <li class=\"dropdown-divider\">&nbsp;</li>\n            <?php\n            if ($acl->isAllowed(App\\Enums\\GlobalPermissions::View)): ?>\n                <li>\n                    <a class=\"dropdown-item\" href=\"<?= $router->named('admin:index:index') ?>\">\n                        <i class=\"material-icons\" aria-hidden=\"true\">settings</i>\n                        <?= __('System Administration') ?>\n                    </a>\n                </li>\n            <?php\n            endif; ?>\n            <li>\n                <a class=\"dropdown-item\" href=\"<?= $router->named('profile:index') ?>\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">account_circle</i>\n                    <?= __('My Account') ?>\n                </a>\n            </li>\n            <li>\n                <a class=\"dropdown-item\" href=\"<?= $router->named('profile:theme') ?>\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">invert_colors</i>\n                    <?= __('Switch Theme') ?>\n                </a>\n            </li>\n            <li>\n                <a class=\"dropdown-item\" href=\"https://docs.azuracast.com/en/user-guide/troubleshooting\"\n                   target=\"_blank\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">help</i>\n                    <?= __('Help') ?>\n                </a>\n            </li>\n            <li class=\"dropdown-divider\">&nbsp;</li>\n            <?php\n            if ($auth->isMasqueraded()): ?>\n                <li>\n                    <a class=\"dropdown-item\" href=\"<?= $router->named('account:endmasquerade') ?>\">\n                        <i class=\"material-icons\" aria-hidden=\"true\">exit_to_app</i>\n                        <?= __('End Session') ?>\n                    </a>\n                </li>\n            <?php\n            else: ?>\n                <li>\n                    <a class=\"dropdown-item\" href=\"<?= $router->named('account:logout') ?>\">\n                        <i class=\"material-icons\" aria-hidden=\"true\">exit_to_app</i>\n                        <?= __('Sign Out') ?></a></li>\n            <?php\n            endif; ?>\n        </ul>\n    </div>\n</header>\n\n<?php\nif ($sections->has('sidebar')): ?>\n    <div class=\"navdrawer navdrawer-permanent-lg navdrawer-permanent-clipped\" id=\"sidebar\" tabindex=\"-1\">\n        <nav class=\"navdrawer-content\" aria-label=\"<?= __('Sidebar') ?>\">\n            <?= $sections->get('sidebar') ?>\n        </nav>\n    </div>\n<?php\nendif; ?>\n\n<section id=\"main\">\n    <main id=\"content\" <?php\n    if (!$sections->has('sidebar')): ?>class=\"content-alt\"<?php\n    endif; ?>>\n        <div class=\"container\">\n            <?php\n            if ($manual): ?>\n                <?= $this->section('content') ?>\n            <?php\n            else: ?>\n                <?php\n                if ($header): ?>\n                    <div class=\"block-header\">\n                        <h2><?= $header ?></h2>\n                    </div>\n                <?php\n                endif; ?>\n                <div class=\"card mb-3\" role=\"region\">\n                    <div class=\"card-header bg-primary-dark\">\n                        <h3 class=\"card-title\"><?=$title?></h3>\n                    </div>\n                    <div class=\"card-body\">\n                        <?=$this->section('content')?>\n                    </div>\n                </div>\n            <?php\n            endif; ?>\n        </div>\n    </main>\n</section>\n\n<footer id=\"footer\" <?php\nif (!$sections->has('sidebar')): ?>class=\"footer-alt\"<?php\nendif; ?> role=\"contentinfo\" aria-label=\"<?= __('Footer') ?>\">\n    <?= sprintf(\n        __('Powered by %s'),\n        '<a href=\"https://www.azuracast.com/\" target=\"_blank\">' . $environment->getAppName(\n        ) . '</a> &bull; ' . $version->getVersionText() . ' &bull; ' . ($environment->isDocker(\n        ) ? 'Docker' : 'Ansible') . ' &bull; PHP ' . \\PHP_MAJOR_VERSION . '.' . \\PHP_MINOR_VERSION\n    ) ?>\n    <br>\n    <?= __('Like our software?') ?> <a href=\"https://docs.azuracast.com/en/contribute/donate\"><?= __(\n            'Donate to support AzuraCast!'\n        ) ?></a>\n</footer>\n\n<div id=\"radio-player\"></div>\n</body>\n</html>\n"], "filenames": ["templates/main.phtml"], "buggy_code_start_loc": [85], "buggy_code_end_loc": [86], "fixing_code_start_loc": [85], "fixing_code_end_loc": [86], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository azuracast/azuracast prior to 0.18.", "other": {"cve": {"id": "CVE-2023-2191", "sourceIdentifier": "security@huntr.dev", "published": "2023-04-20T02:15:06.757", "lastModified": "2023-04-29T02:48:44.317", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository azuracast/azuracast prior to 0.18."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 0.9, "impactScore": 2.5}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:azuracast:azuracast:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.18.0", "matchCriteriaId": "820C3983-35D4-4942-AC2B-42FE4BD71EB7"}]}]}], "references": [{"url": "https://github.com/azuracast/azuracast/commit/24276cb4166b2057de73569ec33046a80a8bb437", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/0814f5f9-8b58-40e5-b08c-7c488947cf31", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/azuracast/azuracast/commit/24276cb4166b2057de73569ec33046a80a8bb437"}}