{"buggy_code": ["<div data-controller=\"alert\"\n  data-alert-dismiss-after-value=\"5000\"\n  data-alert-remove-delay-value=\"0\"\n  class=\"<%= classes %>\"\n  >\n  <div class=\"px-2\">\n    <div class=\"flex h-full\">\n      <div class=\"flex items-center min-h-full\">\n        <%= helpers.svg icon, class: \"h-6\" %>\n      </div>\n      <div class=\"ml-3 w-0 flex-1 pt-0.5\">\n        <p class=\"text-sm leading-5 font-semibold\">\n          <%== message %>\n        </p>\n      </div>\n      <div class=\"ml-4 flex-shrink-0 flex items-center\">\n        <button data-action=\"alert#close\" class=\"inline-flex text-white focus:outline-none focus:text-gray-300 transition ease-in-out duration-150\">\n          <svg class=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/>\n          </svg>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n", "<%= content_tag :div,\n  class: classes,\n  style: style,\n  data: data do %>\n  <div class=\"h-full <% if stacked? %> md:pt-4 <% else %> md:pt-0 md:h-14 <% end %> pt-4 flex self-start items-center flex-shrink-0 <%= @field.get_html(:classes, view: view, element: :label) %> w-48 <% if compact? %> md:w-48 xl:w-64 <% else %> md:w-64 <% end %> px-6 uppercase font-semibold text-gray-500 text-sm\" data-slot=\"label\">\n    <% if form.present? %>\n      <%= form.label field.id, label %>\n    <% else %>\n      <%= field.name %>\n    <% end %>\n    <% if on_edit? && field.is_required? %> <span class=\"text-red-600 ml-1\">*</span> <% end %>\n  </div>\n  <div class=\"flex-1 flex flex-row md:min-h-inherit py-2 <% if stacked? %> pb-4 <% else %><% end %> px-6 <%= @field.get_html(:classes, view: view, element: :content) %>\" data-slot=\"value\">\n    <div class=\"self-center w-full <% unless full_width? || compact? || stacked? %> md:w-8/12 <% end %>\">\n      <% if on_show? %>\n        <% if field.value.blank? and dash_if_blank %>\n          \u2014\n        <% else %>\n          <%= content %>\n        <% end %>\n      <% elsif on_edit? %>\n        <%= content %>\n        <% if record.present? and record.errors.include? field.id %>\n          <div class=\"text-red-600 mt-2 text-sm\"><%= record.errors.full_messages_for(field.id).to_sentence %></div>\n        <% end %>\n        <% if help.present? %>\n          <div class=\"text-gray-600 mt-2 text-sm\"><%== help %></div>\n        <% end %>\n      <% end %>\n    </div>\n  </div>\n  <% if params[:avo_debug].present? %>\n    <!-- Raw value: -->\n    <!-- <%== field.value.inspect %> -->\n  <% end %>\n<% end %>\n", "<div class=\"flex items-start py-1 leading-tight bg-gray-100 text-gray-500 text-xs\">\n  <div class=\"py-2 px-6 h-full w-full\">\n    <% if empty %>\n    <% elsif value.present? %>\n      <% if as_html %>\n        <%== value %>\n      <% else %>\n        <div class=\"font-semibold uppercase\"><%= value %></div>\n      <% end %>\n    <% else %>\n      \u2014\n    <% end %>\n  </div>\n</div>\n", "<%= field_wrapper **field_wrapper_args, full_width: true do %>\n  <%= content_tag :div,\n    class: \"relative block overflow-x-auto max-w-full\",\n    data: {\n      controller: \"trix-field\",\n      trix_field_target: \"controller\",\n      resource_name: resource_name,\n      resource_id: resource_id,\n      attachments_disabled: @field.attachments_disabled,\n      attachment_key: @field.attachment_key,\n      hide_attachment_filename: @field.hide_attachment_filename,\n      hide_attachment_filesize: @field.hide_attachment_filesize,\n      hide_attachment_url: @field.hide_attachment_url,\n    } do %>\n    <%= content_tag 'trix-editor',\n      class: 'trix-content',\n      data: {\n        \"trix-field-target\": \"editor\",\n        **@field.get_html(:data, view: view, element: :input)\n      },\n      input: trix_id,\n      placeholder: @field.placeholder do %>\n      <%== @field.value %>\n    <% end %>\n    <%= @form.text_area @field.id,\n      class: classes(\"w-full hidden\"),\n      data: @field.get_html(:data, view: view, element: :input),\n      disabled: disabled?,\n      id: trix_id,\n      placeholder: @field.placeholder,\n      style: @field.get_html(:style, view: view, element: :input)\n    %>\n  <% end %>\n<% end %>\n", "<%= field_wrapper **field_wrapper_args do %>\n  <%\n    content_classes = 'trix-content py-2'\n    content_classes << ' hidden' unless @field.always_show\n  %>\n  <div data-controller=\"hidden-input\">\n    <% unless @field.always_show %>\n      <%= link_to t('avo.show_content'), 'javascript:void(0);', class: 'font-bold inline-block', data: { action: 'click->hidden-input#showContent' } %>\n    <% end %>\n    <div class=\"<%= content_classes %> \" data-hidden-input-target=\"content\">\n      <%== @field.value %>\n    </div>\n  </div>\n<% end %>\n", "<%= content_tag :td,\n  class: \"min-h-[3rem] px-3 leading-tight whitespace-nowrap h-full text-slate-800 text-base #{classes}\",\n  data: {\n    field_id: @field.id,\n    field_type: @field.type,\n    **stimulus_attributes\n  },\n  style: style do %>\n  <% if @field.value.blank? && @dash_if_blank %>\n    \u2014\n  <% else %>\n    <% if @center_content %>\n      <div class=\"flex items-center justify-center\">\n        <%= content %>\n      </div>\n    <% else %>\n      <%= content %>\n    <% end %>\n  <% end %>\n  <% if params[:avo_debug].present? %>\n    <!-- Raw value: -->\n    <!-- <%== @field.value.inspect %> -->\n  <% end %>\n<% end %>\n"], "fixing_code": ["<div data-controller=\"alert\"\n  data-alert-dismiss-after-value=\"5000\"\n  data-alert-remove-delay-value=\"0\"\n  class=\"<%= classes %>\"\n  >\n  <div class=\"px-2\">\n    <div class=\"flex h-full\">\n      <div class=\"flex items-center min-h-full\">\n        <%= helpers.svg icon, class: \"h-6\" %>\n      </div>\n      <div class=\"ml-3 w-0 flex-1 pt-0.5\">\n        <p class=\"text-sm leading-5 font-semibold\">\n          <%= sanitize message %>\n        </p>\n      </div>\n      <div class=\"ml-4 flex-shrink-0 flex items-center\">\n        <button data-action=\"alert#close\" class=\"inline-flex text-white focus:outline-none focus:text-gray-300 transition ease-in-out duration-150\">\n          <svg class=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\"/>\n          </svg>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n", "<%= content_tag :div,\n  class: classes,\n  style: style,\n  data: data do %>\n  <div class=\"h-full <% if stacked? %> md:pt-4 <% else %> md:pt-0 md:h-14 <% end %> pt-4 flex self-start items-center flex-shrink-0 <%= @field.get_html(:classes, view: view, element: :label) %> w-48 <% if compact? %> md:w-48 xl:w-64 <% else %> md:w-64 <% end %> px-6 uppercase font-semibold text-gray-500 text-sm\" data-slot=\"label\">\n    <% if form.present? %>\n      <%= form.label field.id, label %>\n    <% else %>\n      <%= field.name %>\n    <% end %>\n    <% if on_edit? && field.is_required? %> <span class=\"text-red-600 ml-1\">*</span> <% end %>\n  </div>\n  <div class=\"flex-1 flex flex-row md:min-h-inherit py-2 <% if stacked? %> pb-4 <% else %><% end %> px-6 <%= @field.get_html(:classes, view: view, element: :content) %>\" data-slot=\"value\">\n    <div class=\"self-center w-full <% unless full_width? || compact? || stacked? %> md:w-8/12 <% end %>\">\n      <% if on_show? %>\n        <% if field.value.blank? and dash_if_blank %>\n          \u2014\n        <% else %>\n          <%= content %>\n        <% end %>\n      <% elsif on_edit? %>\n        <%= content %>\n        <% if record.present? and record.errors.include? field.id %>\n          <div class=\"text-red-600 mt-2 text-sm\"><%= record.errors.full_messages_for(field.id).to_sentence %></div>\n        <% end %>\n        <% if help.present? %>\n          <div class=\"text-gray-600 mt-2 text-sm\"><%= sanitize help %></div>\n        <% end %>\n      <% end %>\n    </div>\n  </div>\n  <% if params[:avo_debug].present? %>\n    <!-- Raw value: -->\n    <!-- <%= sanitize field.value.inspect %> -->\n  <% end %>\n<% end %>\n", "<div class=\"flex items-start py-1 leading-tight bg-gray-100 text-gray-500 text-xs\">\n  <div class=\"py-2 px-6 h-full w-full\">\n    <% if empty %>\n    <% elsif value.present? %>\n      <% if as_html %>\n        <%= sanitize value %>\n      <% else %>\n        <div class=\"font-semibold uppercase\"><%= value %></div>\n      <% end %>\n    <% else %>\n      \u2014\n    <% end %>\n  </div>\n</div>\n", "<%= field_wrapper **field_wrapper_args, full_width: true do %>\n  <%= content_tag :div,\n    class: \"relative block overflow-x-auto max-w-full\",\n    data: {\n      controller: \"trix-field\",\n      trix_field_target: \"controller\",\n      resource_name: resource_name,\n      resource_id: resource_id,\n      attachments_disabled: @field.attachments_disabled,\n      attachment_key: @field.attachment_key,\n      hide_attachment_filename: @field.hide_attachment_filename,\n      hide_attachment_filesize: @field.hide_attachment_filesize,\n      hide_attachment_url: @field.hide_attachment_url,\n    } do %>\n    <%= content_tag 'trix-editor',\n      class: 'trix-content',\n      data: {\n        \"trix-field-target\": \"editor\",\n        **@field.get_html(:data, view: view, element: :input)\n      },\n      input: trix_id,\n      placeholder: @field.placeholder do %>\n      <%= sanitize @field.value %>\n    <% end %>\n    <%= @form.text_area @field.id,\n      class: classes(\"w-full hidden\"),\n      data: @field.get_html(:data, view: view, element: :input),\n      disabled: disabled?,\n      id: trix_id,\n      placeholder: @field.placeholder,\n      style: @field.get_html(:style, view: view, element: :input)\n    %>\n  <% end %>\n<% end %>\n", "<%= field_wrapper **field_wrapper_args do %>\n  <%\n    content_classes = 'trix-content py-2'\n    content_classes << ' hidden' unless @field.always_show\n  %>\n  <div data-controller=\"hidden-input\">\n    <% unless @field.always_show %>\n      <%= link_to t('avo.show_content'), 'javascript:void(0);', class: 'font-bold inline-block', data: { action: 'click->hidden-input#showContent' } %>\n    <% end %>\n    <div class=\"<%= content_classes %> \" data-hidden-input-target=\"content\">\n      <%= sanitize @field.value %>\n    </div>\n  </div>\n<% end %>\n", "<%= content_tag :td,\n  class: \"min-h-[3rem] px-3 leading-tight whitespace-nowrap h-full text-slate-800 text-base #{classes}\",\n  data: {\n    field_id: @field.id,\n    field_type: @field.type,\n    **stimulus_attributes\n  },\n  style: style do %>\n  <% if @field.value.blank? && @dash_if_blank %>\n    \u2014\n  <% else %>\n    <% if @center_content %>\n      <div class=\"flex items-center justify-center\">\n        <%= content %>\n      </div>\n    <% else %>\n      <%= content %>\n    <% end %>\n  <% end %>\n  <% if params[:avo_debug].present? %>\n    <!-- Raw value: -->\n    <!-- <%= sanitize @field.value.inspect %> -->\n  <% end %>\n<% end %>\n"], "filenames": ["app/components/avo/alert_component.html.erb", "app/components/avo/field_wrapper_component.html.erb", "app/components/avo/fields/common/heading_component.html.erb", "app/components/avo/fields/trix_field/edit_component.html.erb", "app/components/avo/fields/trix_field/show_component.html.erb", "app/components/avo/index/field_wrapper_component.html.erb"], "buggy_code_start_loc": [13, 27, 6, 23, 11, 22], "buggy_code_end_loc": [14, 35, 7, 24, 12, 23], "fixing_code_start_loc": [13, 27, 6, 23, 11, 22], "fixing_code_end_loc": [14, 35, 7, 24, 12, 23], "type": "CWE-79", "message": "Avo is an open source ruby on rails admin panel creation framework. In affected versions some avo fields are vulnerable to Cross Site Scripting (XSS) when rendering html based content. Attackers do need form edit privilege in order to successfully exploit this vulnerability, but the results are stored and no specific timing is required. This issue has been addressed in commit `7891c01e` which is expected to be included in the next release of avo. Users are advised to configure CSP headers for their application and to limit untrusted user access as a mitigation.", "other": {"cve": {"id": "CVE-2023-34103", "sourceIdentifier": "security-advisories@github.com", "published": "2023-06-05T23:15:12.627", "lastModified": "2023-06-12T17:01:22.817", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Avo is an open source ruby on rails admin panel creation framework. In affected versions some avo fields are vulnerable to Cross Site Scripting (XSS) when rendering html based content. Attackers do need form edit privilege in order to successfully exploit this vulnerability, but the results are stored and no specific timing is required. This issue has been addressed in commit `7891c01e` which is expected to be included in the next release of avo. Users are advised to configure CSP headers for their application and to limit untrusted user access as a mitigation."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:avohq:avo:*:*:*:*:*:ruby:*:*", "versionEndIncluding": "2.33.2", "matchCriteriaId": "27594A1A-CFFC-4741-9F4F-45532F8FFCFD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:avohq:avo:3.0.0:pre12:*:*:*:ruby:*:*", "matchCriteriaId": "33F74798-D928-4FA3-B890-81C43DAC8F91"}]}]}], "references": [{"url": "https://github.com/avo-hq/avo/commit/7891c01e1fba9ca5d7dbccc43d27f385e5d08563", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/avo-hq/avo/security/advisories/GHSA-5cr9-5jx3-2g39", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/avo-hq/avo/commit/7891c01e1fba9ca5d7dbccc43d27f385e5d08563"}}